{
  final InsertHandler handler=item.getInsertHandler() != null ? item.getInsertHandler() : new DefaultInsertHandler();
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    public void run(){
      PsiDocumentManager.getInstance(context.project).commitAllDocuments();
      context.prefix=data.prefix;
      final PsiElement position=context.file.findElementAt(context.startOffset - context.prefix.length() + item.getLookupString().length() - 1);
      analyseItem(item,position,context);
      handler.handleInsert(context,startOffset,data,item,signatureSelected,completionChar);
    }
  }
);
}
