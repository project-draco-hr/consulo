{
  if (!myInitListeners) {
    myInitListeners=true;
    final VisibilityListener visibilityListener=new VisibilityListener(myProject,IntroduceConstantHandler.REFACTORING_NAME,myEditor){
      @Override protected String getVisibility(){
        return getSelectedVisibility();
      }
    }
;
    myVisibilityCombo.addActionListener(new ActionListener(){
      @Override public void actionPerformed(      ActionEvent e){
        visibilityListener.stateChanged(null);
      }
    }
);
    myReplaceAllCb.addItemListener(new ItemListener(){
      @Override public void itemStateChanged(      ItemEvent e){
        Runnable restartTemplateRunnable=new Runnable(){
          public void run(){
            final TemplateState templateState=TemplateManagerImpl.getTemplateState(myEditor);
            if (templateState != null) {
              templateState.gotoEnd(true);
              myTypeSelectorManager=new TypeSelectorManagerImpl(myProject,myDefaultParameterTypePointer.getType(),null,myExpr,myOccurrences);
              startIntroduceTemplate(isReplaceAllOccurrences(),myFieldTypePointer.getType());
            }
          }
        }
;
        CommandProcessor.getInstance().executeCommand(myProject,restartTemplateRunnable,IntroduceConstantHandler.REFACTORING_NAME,IntroduceConstantHandler.REFACTORING_NAME);
      }
    }
);
    myAnnotateNonNls.addItemListener(new ItemListener(){
      @Override public void itemStateChanged(      ItemEvent e){
      }
    }
);
  }
  return myWholePanel;
}
