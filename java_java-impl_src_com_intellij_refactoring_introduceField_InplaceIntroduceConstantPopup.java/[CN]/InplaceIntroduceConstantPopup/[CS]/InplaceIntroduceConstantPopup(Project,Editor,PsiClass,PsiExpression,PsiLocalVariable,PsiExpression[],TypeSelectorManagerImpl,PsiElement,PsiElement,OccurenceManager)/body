{
  myProject=project;
  myEditor=editor;
  myParentClass=parentClass;
  myExpr=expr;
  myLocalVariable=localVariable;
  myOccurrences=occurrences;
  myTypeSelectorManager=typeSelectorManager;
  myAnchorElement=anchorElement;
  myAnchorElementIfAll=anchorElementIfAll;
  for (int i=0, occurrencesLength=occurrences.length; i < occurrencesLength; i++) {
    PsiExpression occurrence=occurrences[i];
    PsiElement parent=occurrence.getParent();
    if (parent == myAnchorElement) {
      myAnchorIdx=i;
    }
    if (parent == myAnchorElementIfAll) {
      myAnchorIdxIfAll=i;
    }
  }
  myOccurenceManager=occurenceManager;
  myExprMarker=expr != null && expr.isPhysical() ? myEditor.getDocument().createRangeMarker(expr.getTextRange()) : null;
  myExprText=getExprText(expr,localVariable);
  myLocalName=localVariable != null ? localVariable.getName() : null;
  myWholePanel=new JPanel(new GridBagLayout());
  GridBagConstraints gc=new GridBagConstraints(0,0,1,1,1,0,GridBagConstraints.NORTHWEST,GridBagConstraints.HORIZONTAL,new Insets(0,0,0,0),0,0);
  final TitlePanel titlePanel=new TitlePanel();
  titlePanel.setBorder(null);
  titlePanel.setText(IntroduceConstantHandler.REFACTORING_NAME);
  gc.gridwidth=2;
  myWholePanel.add(titlePanel,gc);
  gc.gridwidth=1;
  gc.gridy=1;
  myWholePanel.add(createLeftPanel(),gc);
  gc.gridx=1;
  gc.insets.left=6;
  myWholePanel.add(createRightPanel(),gc);
}
