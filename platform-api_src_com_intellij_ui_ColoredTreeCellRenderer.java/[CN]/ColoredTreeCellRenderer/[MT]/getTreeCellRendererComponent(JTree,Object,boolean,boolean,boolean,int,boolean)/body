{
  myTree=tree;
  clear();
  mySelected=selected;
  myFocused=tree.hasFocus();
  if (UIUtil.isUnderQuaquaLookAndFeel()) {
    if (selected) {
      setBackground(UIUtil.getTreeSelectionBackground());
    }
 else {
      setBackground(null);
    }
  }
 else {
    if (selected) {
      setPaintFocusBorder(true);
      if (myFocused) {
        setBackground(UIUtil.getTreeSelectionBackground());
      }
 else {
        setBackground(null);
      }
    }
 else {
      setBackground(null);
    }
  }
  if (value instanceof LoadingNode) {
    setForeground(Color.gray);
    setIcon(LOADING_NODE_ICON);
  }
 else {
    setForeground(tree.getForeground());
    setIcon(null);
  }
  customizeCellRenderer(tree,value,selected,expanded,leaf,row,hasFocus);
  if (getFont() == null) {
    setFont(tree.getFont());
  }
  return this;
}
