{
  final Element modulesManager=JDomConvertingUtil.findComponent(root,ModuleManagerImpl.COMPONENT_NAME);
  if (modulesManager == null)   return new File[0];
  final Element modules=modulesManager.getChild(ModuleManagerImpl.ELEMENT_MODULES);
  if (modules == null)   return new File[0];
  final ExpandMacroToPathMap macros=createExpandMacroMap();
  List<File> files=new ArrayList<File>();
  for (  Element module : JDomConvertingUtil.getChildren(modules,ModuleManagerImpl.ELEMENT_MODULE)) {
    String filePath=module.getAttributeValue(ModuleManagerImpl.ATTRIBUTE_FILEPATH);
    filePath=macros.substitute(filePath,true);
    files.add(new File(FileUtil.toSystemDependentName(filePath)));
  }
  return files.toArray(new File[files.size()]);
}
