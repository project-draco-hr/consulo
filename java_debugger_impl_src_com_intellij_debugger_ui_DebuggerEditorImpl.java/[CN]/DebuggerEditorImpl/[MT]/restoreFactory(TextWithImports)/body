{
  FileType fileType=text.getFileType();
  if (fileType == null)   return;
  for (  CodeFragmentFactory factory : getAllFactories()) {
    if (factory.getFileType().equals(fileType)) {
      setFactory(factory);
      return;
    }
  }
  setFactory(DefaultCodeFragmentFactory.getInstance());
}
