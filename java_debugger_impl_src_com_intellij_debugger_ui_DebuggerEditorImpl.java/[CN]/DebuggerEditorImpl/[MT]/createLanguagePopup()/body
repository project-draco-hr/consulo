{
  DefaultActionGroup actions=new DefaultActionGroup();
  for (  final CodeFragmentFactory fragmentFactory : DebuggerUtilsEx.getCodeFragmentFactories(myContext)) {
    actions.add(new AnAction(fragmentFactory.getFileType().getLanguage().getDisplayName(),null,fragmentFactory.getFileType().getIcon()){
      @Override public void actionPerformed(      AnActionEvent e){
        setFactory(fragmentFactory);
        setText(getText());
        IdeFocusManager.getInstance(getProject()).requestFocus(DebuggerEditorImpl.this,true);
      }
    }
);
  }
  DataContext dataContext=DataManager.getInstance().getDataContext(this);
  return JBPopupFactory.getInstance().createActionGroupPopup("Choose language",actions,dataContext,JBPopupFactory.ActionSelectionAid.SPEEDSEARCH,false);
}
