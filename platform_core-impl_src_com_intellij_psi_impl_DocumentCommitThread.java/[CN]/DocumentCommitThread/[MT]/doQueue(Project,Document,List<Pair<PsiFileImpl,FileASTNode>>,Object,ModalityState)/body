{
synchronized (lock) {
    CommitTask newTask=createNewTaskAndCancelSimilar(project,document,oldFileNodes,reason,currentModalityState);
    documentsToCommit.offer(newTask);
    log(project,"Queued",newTask,reason);
    wakeUpQueue();
    return newTask;
  }
}
