{
  final List<VirtualFile> unversionedFiles=getUnversionedFiles(e);
  if (unversionedFiles.isEmpty()) {
    return;
  }
  FileDocumentManager.getInstance().saveAllDocuments();
  final ChangeListManagerImpl changeListManager=ChangeListManagerImpl.getInstanceImpl(e.getData(CommonDataKeys.PROJECT));
  changeListManager.addUnversionedFiles(changeListManager.getDefaultChangeList(),unversionedFiles,new Condition<FileStatus>(){
    @Override public boolean value(    FileStatus status){
      return isStatusForAddition(status);
    }
  }
);
}
