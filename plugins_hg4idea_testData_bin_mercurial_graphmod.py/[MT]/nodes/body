def nodes(repo, nodes):
    'cset DAG generator yielding (id, CHANGESET, ctx, [parentids]) tuples\n\n    This generator function walks the given nodes. It only returns parents\n    that are in nodes, too.\n    '
    include = set(nodes)
    for node in nodes:
        ctx = repo[node]
        parents = [p.rev() for p in ctx.parents() if (p.node() in include)]
        yield (ctx.rev(), CHANGESET, ctx, sorted(parents))
