{
  if (myFlattenPackages) {
    return node;
  }
  final TreeDescriptor descriptor=getDescriptor(node);
  if (!(descriptor instanceof PackageDescriptor)) {
    return node;
  }
  final PackageDescriptor packageDescriptor=(PackageDescriptor)descriptor;
  final String parentPackageName=packageDescriptor.getParentPackageName();
  if (parentPackageName == null) {
    return node;
  }
  final CheckedTreeNode parentNode=attachNodeToParent(new PackageDescriptor(parentPackageName),node);
  if (parentNode == null) {
    return null;
  }
  return append(parentNode);
}
