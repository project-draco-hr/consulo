{
  if (text.charAt(1) != '#') {
    try {
      text=text.substring(1,text.length() - 1);
    }
 catch (    StringIndexOutOfBoundsException e) {
      LOG.error("Cannot parse ref: '" + text + "'",e);
    }
    return XmlTagUtil.getCharacterByEntityName(text);
  }
  text=text.substring(2,text.length() - 1);
  try {
    int code;
    if (StringUtil.startsWithChar(text,'x')) {
      text=text.substring(1);
      code=Integer.parseInt(text,16);
    }
 else {
      code=Integer.parseInt(text);
    }
    return (char)code;
  }
 catch (  NumberFormatException e) {
    return 0;
  }
}
