{
  while (!(element instanceof XmlFile) && element != null) {
    final PsiElement context=element.getContext();
    if (context == null) {
      final XmlExtension extension=XmlExtension.getExtensionByElement(element);
      if (extension != null) {
        element=extension.getContainingFile(element);
      }
    }
 else {
      if (element.getManager().areElementsEquivalent(element,context)) {
        LOG.error("Context==element: " + element.getClass());
        return null;
      }
      element=context;
    }
  }
  return (XmlFile)element;
}
