{
  final String uri=ExternalResourceManagerEx.getInstanceEx().getResourceLocation(namespace,tag.getProject());
  if (uri != null && !uri.equals(namespace))   return uri;
  while (true) {
    if (namespace.isEmpty()) {
      final String attributeValue=tag.getAttributeValue("noNamespaceSchemaLocation",XML_SCHEMA_INSTANCE_URI);
      if (attributeValue != null)       return attributeValue;
    }
 else {
      String schemaLocation=tag.getAttributeValue("schemaLocation",XML_SCHEMA_INSTANCE_URI);
      if (schemaLocation != null) {
        int start=schemaLocation.indexOf(namespace);
        if (start >= 0) {
          start+=namespace.length();
          final StringTokenizer tokenizer=new StringTokenizer(schemaLocation.substring(start + 1));
          if (tokenizer.hasMoreTokens()) {
            return tokenizer.nextToken();
          }
 else {
            return null;
          }
        }
      }
    }
    if (tag.getParent() instanceof XmlTag) {
      tag=(XmlTag)tag.getParent();
    }
 else {
      break;
    }
  }
  return null;
}
