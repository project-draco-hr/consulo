{
  super(owner);
  myDialogWrapper=new WeakReference<DialogWrapper>(dialogWrapper);
  myProject=project != null ? new WeakReference<Project>(project) : null;
  setFocusTraversalPolicy(new LayoutFocusTraversalPolicyExt(){
    @Override protected boolean accept(    Component aComponent){
      if (UIUtil.isFocusProxy(aComponent))       return false;
      return super.accept(aComponent);
    }
  }
);
  myFocusedCallback=focused;
  myTypeAheadDone=typeAheadDone;
  myTypeAheadCallback=typeAheadCallback;
  final long typeAhead=getDialogWrapper().getTypeAheadTimeoutMs();
  if (typeAhead <= 0) {
    myTypeAheadDone.setDone();
  }
  setDefaultCloseOperation(WindowConstants.DO_NOTHING_ON_CLOSE);
  myWindowListener=new MyWindowListener();
  addWindowListener(myWindowListener);
}
