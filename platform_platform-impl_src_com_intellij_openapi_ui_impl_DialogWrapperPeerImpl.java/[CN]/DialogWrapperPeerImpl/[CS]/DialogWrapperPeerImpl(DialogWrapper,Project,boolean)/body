{
  myWrapper=wrapper;
  myTypeAheadCallback=myWrapper.isTypeAheadEnabled() ? new ActionCallback() : null;
  myWindowManager=null;
  Application application=ApplicationManager.getApplication();
  if (application != null && application.hasComponent(WindowManager.class)) {
    myWindowManager=(WindowManagerEx)WindowManager.getInstance();
  }
  Window window=null;
  if (myWindowManager != null) {
    if (project == null) {
      project=PlatformDataKeys.PROJECT.getData(DataManager.getInstance().getDataContext());
    }
    myProject=project;
    window=myWindowManager.suggestParentWindow(project);
    if (window == null) {
      Window focusedWindow=myWindowManager.getMostRecentFocusedWindow();
      if (focusedWindow instanceof IdeFrameImpl) {
        window=focusedWindow;
      }
    }
    if (window == null) {
      IdeFrame[] frames=myWindowManager.getAllProjectFrames();
      for (      IdeFrame frame : frames) {
        if (frame instanceof IdeFrameImpl && ((IdeFrameImpl)frame).isActive()) {
          window=(IdeFrameImpl)frame;
          break;
        }
      }
    }
  }
  Window owner;
  if (window != null) {
    owner=window;
  }
 else {
    if (!isHeadless()) {
      owner=JOptionPane.getRootFrame();
    }
 else {
      owner=null;
    }
  }
  createDialog(owner,canBeParent);
}
