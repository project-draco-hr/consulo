{
  myWrapper=wrapper;
  myWindowManager=null;
  Application application=ApplicationManager.getApplication();
  if (application != null && application.hasComponent(WindowManager.class)) {
    myWindowManager=(WindowManagerEx)WindowManager.getInstance();
  }
  createDialog(owner,canBeParent);
  if (!isHeadless()) {
    Dialog.ModalityType modalityType=DialogWrapper.IdeModalityType.IDE.toAwtModality();
    if (Registry.is("ide.perProjectModality")) {
      modalityType=ideModalityType.toAwtModality();
    }
    myDialog.setModalityType(modalityType);
  }
}
