{
  List<FrameworkSupportSettings> list=getFrameworkWithLibraries();
  for (  FrameworkSupportSettings settings : list) {
    if (settings.isDownloadLibraries()) {
      RequiredLibrariesInfo requiredLibraries=new RequiredLibrariesInfo(settings.getConfigurable().getLibraries());
      RequiredLibrariesInfo.RequiredClassesNotFoundInfo info=requiredLibraries.checkLibraries(settings.getAddedJars().toArray(new VirtualFile[settings.getAddedJars().size()]));
      if (info != null) {
        LibraryDownloadInfo[] downloadingInfos=LibraryDownloader.getDownloadingInfos(info.getLibraryInfos());
        if (downloadingInfos.length > 0) {
          String libraryName=settings.getConfigurable().getLibraryName();
          if (FrameworkSupportConfigurable.DEFAULT_LIBRARY_NAME.equals(libraryName)) {
            libraryName=null;
          }
          LibraryDownloader downloader=new LibraryDownloader(downloadingInfos,null,myMainPanel,settings.getDirectoryForDownloadedLibrariesPath(),libraryName);
          VirtualFile[] files=downloader.download();
          if (files.length != downloadingInfos.length) {
            return false;
          }
          settings.myAddedJars.addAll(Arrays.asList(files));
        }
      }
    }
  }
  return true;
}
