def locate(ui, repo, *pats, **opts):
    'locate files matching specific patterns\n\n    Print files under Mercurial control in the working directory whose\n    names match the given patterns.\n\n    By default, this command searches all directories in the working\n    directory. To search just the current directory and its\n    subdirectories, use "--include .".\n\n    If no patterns are given to match, this command prints the names\n    of all files under Mercurial control in the working directory.\n\n    If you want to feed the output of this command into the "xargs"\n    command, use the -0 option to both this command and "xargs". This\n    will avoid the problem of "xargs" treating single filenames that\n    contain whitespace as multiple filenames.\n    '
    end = ((opts.get('print0') and '\x00') or '\n')
    rev = (opts.get('rev') or None)
    ret = 1
    m = cmdutil.match(repo, pats, opts, default='relglob')
    m.bad = (lambda x, y: False)
    for abs in repo[rev].walk(m):
        if ((not rev) and (abs not in repo.dirstate)):
            continue
        if opts.get('fullpath'):
            ui.write(repo.wjoin(abs), end)
        else:
            ui.write(((pats and m.rel(abs)) or abs), end)
        ret = 0
    return ret
