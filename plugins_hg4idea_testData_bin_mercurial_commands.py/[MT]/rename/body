def rename(ui, repo, *pats, **opts):
    'rename files; equivalent of copy + remove\n\n    Mark dest as copies of sources; mark sources for deletion. If dest\n    is a directory, copies are put in that directory. If dest is a\n    file, there can only be one source.\n\n    By default, this command copies the contents of files as they\n    exist in the working directory. If invoked with -A/--after, the\n    operation is recorded, but no copying is performed.\n\n    This command takes effect at the next commit. To undo a rename\n    before that, see hg revert.\n    '
    wlock = repo.wlock(False)
    try:
        return cmdutil.copy(ui, repo, pats, opts, rename=True)
    finally:
        wlock.release()
