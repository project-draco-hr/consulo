{
  if (psiMethod instanceof JspHolderMethod)   return null;
  if (IGNORE_DEPRECATED && (psiMethod.isDeprecated() || psiMethod.getContainingClass().isDeprecated())) {
    return null;
  }
  PsiDocComment docComment=psiMethod.getDocComment();
  final PsiMethod[] superMethods=psiMethod.findSuperMethods();
  if (docComment == null) {
    if (isJavaDocRequired(psiMethod)) {
      if (superMethods.length > 0)       return null;
      final Object[] addins=Extensions.getRootArea().getExtensionPoint(ExtensionPoints.JAVADOC_LOCAL).getExtensions();
      for (      Object addin : addins) {
        if (((Condition<PsiMember>)addin).value(psiMethod))         return null;
      }
      if (superMethods.length == 0) {
        final PsiIdentifier nameIdentifier=psiMethod.getNameIdentifier();
        return nameIdentifier != null ? new ProblemDescriptor[]{createDescriptor(nameIdentifier,JavaDocLocalInspection.REQUIRED_JAVADOC_IS_ABSENT,manager)} : null;
      }
 else {
        return null;
      }
    }
 else {
      return null;
    }
  }
  final PsiElement[] descriptionElements=docComment.getDescriptionElements();
  for (  PsiElement descriptionElement : descriptionElements) {
    if (descriptionElement instanceof PsiInlineDocTag) {
      if ("inheritDoc".equals(((PsiInlineDocTag)descriptionElement).getName()))       return null;
    }
  }
  final ArrayList<ProblemDescriptor> problems=new ArrayList<ProblemDescriptor>(2);
  final PsiDocTag tagByName=docComment.findTagByName("inheritDoc");
  if (tagByName != null) {
    final String tagName=tagByName.getName();
    final JavadocTagInfo tagInfo=tagByName.getManager().getJavadocManager().getTagInfo(tagName);
    if (tagInfo != null && tagInfo.isValidInContext(psiMethod)) {
      return null;
    }
  }
  PsiDocTag[] tags=docComment.getTags();
  boolean isReturnRequired=false;
  boolean isReturnAbsent=true;
  if (superMethods.length == 0 && !psiMethod.isConstructor() && PsiType.VOID != psiMethod.getReturnType() && isTagRequired(psiMethod,"return")) {
    isReturnRequired=true;
    for (    PsiDocTag tag : tags) {
      if ("return".equals(tag.getName())) {
        isReturnAbsent=false;
        break;
      }
    }
  }
  ArrayList<PsiParameter> absentParameters=null;
  if (superMethods.length == 0 && isTagRequired(psiMethod,"param")) {
    PsiParameter[] params=psiMethod.getParameterList().getParameters();
    for (    PsiParameter param : params) {
      boolean found=false;
      for (      PsiDocTag tag : tags) {
        if ("param".equals(tag.getName())) {
          PsiDocTagValue value=tag.getValueElement();
          if (value instanceof PsiDocParamRef) {
            PsiDocParamRef paramRef=(PsiDocParamRef)value;
            if (paramRef.getReference().isReferenceTo(param)) {
              found=true;
              break;
            }
          }
        }
      }
      if (!found) {
        if (absentParameters == null)         absentParameters=new ArrayList<PsiParameter>(2);
        absentParameters.add(param);
      }
    }
  }
  if (isReturnRequired && isReturnAbsent) {
    final PsiIdentifier psiIdentifier=psiMethod.getNameIdentifier();
    if (psiIdentifier != null) {
      problems.add(createMissingTagDescriptor(psiIdentifier,"return",manager));
    }
  }
  if (absentParameters != null) {
    for (    PsiParameter psiParameter : absentParameters) {
      final PsiIdentifier nameIdentifier=psiMethod.getNameIdentifier();
      if (nameIdentifier != null) {
        problems.add(createMissingParamTagDescriptor(nameIdentifier,psiParameter.getName(),manager));
      }
    }
  }
  for (  PsiDocTag tag : tags) {
    if ("param".equals(tag.getName())) {
      final PsiElement[] dataElements=tag.getDataElements();
      final PsiDocTagValue valueElement=tag.getValueElement();
      boolean hasProblemsWithTag=dataElements.length < 2;
      if (!hasProblemsWithTag) {
        final StringBuffer buf=new StringBuffer();
        for (        PsiElement element : dataElements) {
          if (element != valueElement) {
            buf.append(element.getText());
          }
        }
        hasProblemsWithTag=buf.toString().trim().length() == 0;
      }
      if (hasProblemsWithTag) {
        if (valueElement != null) {
          problems.add(createDescriptor(valueElement,InspectionsBundle.message("inspection.javadoc.method.problem.missing.tag.description","<code>@param " + valueElement.getText() + "</code>"),manager));
        }
      }
    }
  }
  if (superMethods.length == 0 && isTagRequired(psiMethod,"@throws") && psiMethod.getThrowsList().getReferencedTypes().length > 0) {
    final Map<PsiClassType,PsiClass> declaredExceptions=new HashMap<PsiClassType,PsiClass>();
    final PsiClassType[] classTypes=psiMethod.getThrowsList().getReferencedTypes();
    for (    PsiClassType classType : classTypes) {
      final PsiClass psiClass=classType.resolve();
      if (psiClass != null) {
        declaredExceptions.put(classType,psiClass);
      }
    }
    processThrowsTags(tags,declaredExceptions,manager,problems);
    if (!declaredExceptions.isEmpty()) {
      for (      PsiClassType declaredException : declaredExceptions.keySet()) {
        problems.add(createMissingThrowsTagDescriptor(psiMethod,manager,declaredException));
      }
    }
  }
  ArrayList<ProblemDescriptor> tagProblems=getTagValuesProblems(psiMethod,tags,manager);
  if (tagProblems != null) {
    problems.addAll(tagProblems);
  }
  checkForPeriodInDoc(docComment,problems,manager);
  for (  PsiDocTag tag : tags) {
    if ("param".equals(tag.getName())) {
      if (extractTagDescription(tag).length() == 0) {
        PsiDocTagValue value=tag.getValueElement();
        if (value instanceof PsiDocParamRef) {
          PsiDocParamRef paramRef=(PsiDocParamRef)value;
          PsiParameter[] params=psiMethod.getParameterList().getParameters();
          for (          PsiParameter param : params) {
            if (paramRef.getReference().isReferenceTo(param)) {
              problems.add(createDescriptor(value,InspectionsBundle.message("inspection.javadoc.method.problem.descriptor","<code>@param</code>","<code>" + param.getName() + "</code>"),manager));
            }
          }
        }
      }
    }
 else     if ("return".equals(tag.getName())) {
      if (extractTagDescription(tag).length() == 0) {
        String message=InspectionsBundle.message("inspection.javadoc.method.problem.missing.tag.description","<code>@return</code>");
        ProblemDescriptor descriptor=manager.createProblemDescriptor(tag.getNameElement(),message,null,ProblemHighlightType.GENERIC_ERROR_OR_WARNING,true);
        problems.add(descriptor);
      }
    }
  }
  checkDuplicateTags(tags,problems,manager);
  return problems.isEmpty() ? null : problems.toArray(new ProblemDescriptorImpl[problems.size()]);
}
