{
  if (psiClass instanceof PsiAnonymousClass)   return null;
  if (IGNORE_DEPRECATED && psiClass.isDeprecated()) {
    return null;
  }
  PsiDocComment docComment=psiClass.getDocComment();
  final PsiIdentifier nameIdentifier=psiClass.getNameIdentifier();
  final PsiElement elementToHighlight=nameIdentifier != null ? nameIdentifier : psiClass;
  if (docComment == null) {
    return isJavaDocRequired(psiClass) ? new ProblemDescriptor[]{createDescriptor(elementToHighlight,JavaDocLocalInspection.REQUIRED_JAVADOC_IS_ABSENT,manager)} : null;
  }
  PsiDocTag[] tags=docComment.getTags();
  @NonNls String[] tagsToCheck={"author","version","since"};
  @NonNls String[] absentDescriptionKeys={"inspection.javadoc.problem.missing.author.description","inspection.javadoc.problem.missing.version.description","inspection.javadoc.problem.missing.since.description"};
  boolean[] isTagRequired=new boolean[tagsToCheck.length];
  boolean[] isTagPresent=new boolean[tagsToCheck.length];
  boolean someTagsAreRequired=false;
  for (int i=0; i < tagsToCheck.length; i++) {
    final String tag=tagsToCheck[i];
    someTagsAreRequired|=isTagRequired[i]=isTagRequired(psiClass,tag);
  }
  if (someTagsAreRequired) {
    for (    PsiDocTag tag : tags) {
      String tagName=tag.getName();
      for (int i=0; i < tagsToCheck.length; i++) {
        final String tagToCheck=tagsToCheck[i];
        if (tagToCheck.equals(tagName)) {
          isTagPresent[i]=true;
        }
      }
    }
  }
  ArrayList<ProblemDescriptor> problems=null;
  for (int i=0; i < tagsToCheck.length; i++) {
    final String tagToCheck=tagsToCheck[i];
    if (isTagRequired[i] && !isTagPresent[i]) {
      if (problems == null)       problems=new ArrayList<ProblemDescriptor>(2);
      ProblemDescriptor descriptor=createMissingTagDescriptor(elementToHighlight,tagToCheck,manager);
      problems.add(descriptor);
    }
  }
  problems=checkForPeriodInDoc(docComment,problems,manager);
  for (  PsiDocTag tag : tags) {
    for (int i=0; i < tagsToCheck.length; i++) {
      final String tagToCheck=tagsToCheck[i];
      if (tagToCheck.equals(tag.getName()) && JavaDocLocalInspection.extractTagDescription(tag).length() == 0) {
        if (problems == null)         problems=new ArrayList<ProblemDescriptor>(2);
        problems.add(createDescriptor(elementToHighlight,InspectionsBundle.message(absentDescriptionKeys[i]),manager));
      }
    }
  }
  problems=checkDuplicateTags(tags,problems,manager);
  return problems == null ? null : problems.toArray(new ProblemDescriptorImpl[problems.size()]);
}
