{
  Project project=newCaretPosition.getProject();
  final PsiFile psiFile=newCaretPosition.getContainingFile();
  final Editor editor=FileEditorManager.getInstance(project).getSelectedTextEditor();
  if (editor != null && IJSwingUtilities.hasFocus(editor.getComponent())) {
    final PsiFile file=PsiDocumentManager.getInstance(project).getPsiFile(editor.getDocument());
    if (file == psiFile) {
      editor.getCaretModel().moveToOffset(newCaretPosition.getTextRange().getEndOffset());
      editor.getScrollingModel().scrollToCaret(ScrollType.RELATIVE);
    }
  }
}
