{
  if (config != null) {
    if (configuration instanceof PersistentStateComponent) {
      TypeVariable<Class<PersistentStateComponent>> variable=PersistentStateComponent.class.getTypeParameters()[0];
      Class<?> stateClass=ReflectionUtil.getRawType(ReflectionUtil.resolveVariableInHierarchy(variable,configuration.getClass()));
      ((PersistentStateComponent)configuration).loadState(XmlSerializer.deserialize(config,stateClass));
    }
 else {
      configuration.readExternal(config);
    }
  }
}
