{
  if (event.getID() != MouseEvent.MOUSE_PRESSED) {
    return false;
  }
  if (ourInstance.myStack.isEmpty()) {
    return false;
  }
  JBPopupImpl popup=ourInstance.myStack.peek();
  final MouseEvent mouseEvent=((MouseEvent)event);
  Point point=(Point)mouseEvent.getPoint().clone();
  SwingUtilities.convertPointToScreen(point,mouseEvent.getComponent());
  while (true) {
    final Component content=popup.getContent();
    if (!content.isShowing()) {
      popup.cancel();
      return false;
    }
    final Rectangle bounds=new Rectangle(content.getLocationOnScreen(),content.getSize());
    if (bounds.contains(point) || !popup.isCancelOnClickOutside()) {
      return false;
    }
    if (!popup.canClose()) {
      return false;
    }
    popup.cancel();
    if (ourInstance.myStack.isEmpty()) {
      return false;
    }
    popup=ourInstance.myStack.peek();
  }
}
