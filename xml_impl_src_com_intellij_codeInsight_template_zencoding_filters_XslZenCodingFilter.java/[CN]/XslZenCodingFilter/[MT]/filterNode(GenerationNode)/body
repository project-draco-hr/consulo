{
  TemplateToken token=node.getTemplateToken();
  if (token instanceof XmlTemplateToken) {
    XmlTemplateToken xmlToken=(XmlTemplateToken)token;
    XmlDocument document=xmlToken.getFile().getDocument();
    if (document != null) {
      final XmlTag tag=document.getRootTag();
      if (tag != null) {
        for (        Pair<String,String> pair : xmlToken.getAttribute2Value()) {
          if (SELECT_ATTR_NAME.equals(pair.first)) {
            return node;
          }
        }
        ApplicationManager.getApplication().runWriteAction(new Runnable(){
          @Override public void run(){
            if (isOurTag(tag,node.getChildren().size() > 0)) {
              XmlAttribute attribute=tag.getAttribute(SELECT_ATTR_NAME);
              if (attribute != null) {
                attribute.delete();
              }
            }
          }
        }
);
        return node;
      }
    }
  }
  return node;
}
