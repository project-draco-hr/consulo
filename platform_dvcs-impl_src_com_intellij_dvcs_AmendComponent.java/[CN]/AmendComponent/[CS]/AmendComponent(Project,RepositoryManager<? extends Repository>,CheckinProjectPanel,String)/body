{
  myRepoManager=repoManager;
  myCheckinPanel=panel;
  myAmend=new NonFocusableCheckBox(title);
  myAmend.setMnemonic('m');
  myAmend.setToolTipText(DvcsBundle.message("commit.amend.tooltip"));
  myPreviousMessage=myCheckinPanel.getCommitMessage();
  myAmend.addActionListener(new ActionListener(){
    @Override public void actionPerformed(    ActionEvent e){
      if (myAmend.isSelected()) {
        if (myPreviousMessage.equals(myCheckinPanel.getCommitMessage())) {
          if (myMessagesForRoots == null) {
            loadMessagesInModalTask(project);
          }
          String message=constructAmendedMessage();
          if (!StringUtil.isEmptyOrSpaces(message)) {
            myAmendedMessage=message;
            substituteCommitMessage(myAmendedMessage);
          }
        }
      }
 else {
        if (myCheckinPanel.getCommitMessage().equals(myAmendedMessage)) {
          myCheckinPanel.setCommitMessage(myPreviousMessage);
        }
      }
    }
  }
);
}
