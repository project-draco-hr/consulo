{
  final PsiForStatement forStatement=(PsiForStatement)element.getParent();
  if (forStatement == null) {
    return;
  }
  final PsiStatement initialization=forStatement.getInitialization();
  if (initialization != null) {
    final PsiElement parent=forStatement.getParent();
    parent.addBefore(initialization,forStatement);
  }
  final PsiStatement body=forStatement.getBody();
  @NonNls final StringBuilder whileStatementText=new StringBuilder("while(");
  final PsiExpression condition=forStatement.getCondition();
  if (condition != null) {
    whileStatementText.append(condition.getText());
  }
  whileStatementText.append(") {\n");
  if (body instanceof PsiBlockStatement) {
    final PsiBlockStatement blockStatement=(PsiBlockStatement)body;
    final PsiCodeBlock codeBlock=blockStatement.getCodeBlock();
    final PsiStatement[] statements=codeBlock.getStatements();
    for (    PsiStatement statement : statements) {
      whileStatementText.append(statement.getText());
      whileStatementText.append('\n');
    }
  }
 else   if (body != null) {
    whileStatementText.append(body.getText());
  }
  final PsiStatement update=forStatement.getUpdate();
  if (update != null) {
    whileStatementText.append(update.getText());
    whileStatementText.append(";\n");
  }
  whileStatementText.append('}');
  replaceStatement(whileStatementText.toString(),forStatement);
}
