{
  if (myMirror == null) {
    FileDocumentManager documentManager=FileDocumentManager.getInstance();
    Document document=documentManager.getDocument(getVirtualFile());
    String text=document.getText();
    String ext=StdFileTypes.JAVA.getDefaultExtension();
    PsiClass aClass=getClasses()[0];
    String fileName=aClass.getName() + "." + ext;
    PsiManager manager=getManager();
    PsiFile mirror=manager.getElementFactory().createFileFromText(fileName,text);
    ASTNode mirrorTreeElement=SourceTreeToPsiMap.psiElementToTree(mirror);
synchronized (PsiLock.LOCK) {
      if (myMirror == null) {
        setMirror((TreeElement)mirrorTreeElement);
        myMirror.putUserData(DOCUMENT_IN_MIRROR_KEY,document);
      }
    }
  }
}
