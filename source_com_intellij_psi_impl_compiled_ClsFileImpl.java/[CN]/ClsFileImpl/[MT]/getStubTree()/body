{
  WeakReference<StubTree> stub=myStub;
  StubTree stubHolder=stub == null ? null : stub.get();
  if (stubHolder == null) {
synchronized (lock) {
      stub=myStub;
      stubHolder=stub == null ? null : stub.get();
      if (stubHolder != null)       return stubHolder;
      stubHolder=StubTree.readFromVFile(getVirtualFile());
      if (stubHolder != null) {
        myStub=new WeakReference<StubTree>(stubHolder);
        ((PsiFileStubImpl)stubHolder.getRoot()).setPsi(this);
      }
    }
  }
  return stubHolder;
}
