{
  PsiDocumentManager.getInstance(getProject()).commitAllDocuments();
  Document document=getEditor().getDocument();
  GeneralHighlightingPass action1=new GeneralHighlightingPass(getProject(),getFile(),document,0,getFile().getTextLength(),false,true);
  action1.doCollectInformation(new MockProgressInidicator());
  HighlightInfo[] highlights1=action1.getHighlights();
  PostHighlightingPass action2=new PostHighlightingPass(getProject(),getFile(),getEditor(),0,getFile().getTextLength(),false);
  action2.doCollectInformation(new MockProgressInidicator());
  HighlightInfo[] highlights2=action2.getHighlights();
  return ArrayUtil.mergeArrays(highlights1,highlights2,HighlightInfo.class);
}
