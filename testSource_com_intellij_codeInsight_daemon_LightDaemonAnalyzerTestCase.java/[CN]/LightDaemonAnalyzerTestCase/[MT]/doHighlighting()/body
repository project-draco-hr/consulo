{
  PsiDocumentManager.getInstance(getProject()).commitAllDocuments();
  Document document=getEditor().getDocument();
  GeneralHighlightingPass action1=new GeneralHighlightingPass(getProject(),getFile(),document,0,getFile().getTextLength(),false,true);
  action1.doCollectInformation(new MockProgressInidicator());
  Collection<HighlightInfo> highlights1=action1.getHighlights();
  PostHighlightingPass action2=new PostHighlightingPass(getProject(),getFile(),getEditor(),0,getFile().getTextLength(),false);
  action2.doCollectInformation(new MockProgressInidicator());
  Collection<HighlightInfo> highlights2=action2.getHighlights();
  HashSet<HighlightInfo> result=new HashSet<HighlightInfo>(highlights1);
  result.addAll(highlights2);
  return result;
}
