{
  ((PsiManagerImpl)getPsiManager()).setAssertOnFileLoadingFilter(VirtualFileFilter.NONE);
  ExpectedHighlightingData expectedData=new ExpectedHighlightingData(getEditor().getDocument(),checkWarnings,checkInfos);
  PsiDocumentManager.getInstance(getProject()).commitAllDocuments();
  getFile().getText();
  VirtualFileFilter javaFilesFilter=new VirtualFileFilter(){
    public boolean accept(    VirtualFile file){
      FileType fileType=FileTypeManager.getInstance().getFileTypeByFile(file);
      return fileType == StdFileTypes.JAVA || fileType == StdFileTypes.CLASS;
    }
  }
;
  ((PsiManagerImpl)getPsiManager()).setAssertOnFileLoadingFilter(javaFilesFilter);
  Collection<HighlightInfo> infos=doHighlighting();
  ((PsiManagerImpl)getPsiManager()).setAssertOnFileLoadingFilter(VirtualFileFilter.NONE);
  expectedData.checkResult(infos,getEditor().getDocument().getText());
}
