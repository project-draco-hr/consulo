{
  assertIsDispatchThread();
  final boolean hadFocus=IJSwingUtilities.hasFocus2(myTabbedPaneHolder);
  final TabWrapper wrapper=getWrapperAt(index);
  try {
    myTabbedPane.removeTabAt(index);
    if (myTabbedPane.getTabCount() == 0) {
      myTabbedPane.revalidate();
    }
    if (hadFocus) {
      myTabbedPaneHolder.requestFocus();
    }
  }
  finally {
    wrapper.dispose();
  }
}
