{
  myDetailsCache=detailsCache;
  myTableModel=tableModel;
  myCheckSelection=checkSelection;
  mySpeedometer=new Speedometer();
  myRefreshMark=0;
  myTimer=UIUtil.createNamedTimer("Git table scroll timer",100,new ActionListener(){
    @Override public void actionPerformed(    ActionEvent e){
      if (fastListener != null) {
        fastListener.run();
      }
      final boolean shouldPing=(System.currentTimeMillis() - myRefreshMark) > 300;
      if (((mySpeedometer.getSpeed() < 0.1) && mySpeedometer.hasData()) || shouldPing) {
        myRefreshMark=System.currentTimeMillis();
        if (myCheckSelection != null) {
          myCheckSelection.run();
        }
        mySpeedometer.clear();
        Pair<Integer,Integer> visibleRows=TableScrollingUtil.getVisibleRows(table);
        if (visibleRows.getSecond() < 0) {
          if (visibleRows.getFirst() < 0)           return;
          visibleRows=new Pair<Integer,Integer>(visibleRows.getFirst(),myTableModel.getRowCount() - 1);
        }
        int difference=visibleRows.getSecond() - visibleRows.getFirst();
        int start=Math.max(0,visibleRows.getFirst() - difference);
        int end=Math.min(myTableModel.getRowCount() - 1,visibleRows.getSecond() + difference);
        final MultiMap<VirtualFile,AbstractHash> missing=myTableModel.getMissing(start,end);
        if (!missing.isEmpty()) {
          myDetailsCache.acceptQuestion(missing);
        }
      }
    }
  }
);
}
