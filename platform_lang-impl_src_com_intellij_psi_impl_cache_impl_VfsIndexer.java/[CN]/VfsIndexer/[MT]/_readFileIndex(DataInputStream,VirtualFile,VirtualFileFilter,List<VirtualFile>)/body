{
  ProgressManager.checkCanceled();
  result.add(file);
  int childrenCount=in.readInt();
  if (childrenCount == 0)   return;
  for (int i=0; i < childrenCount; i++) {
    String name=in.readUTF();
    VirtualFile child=file != null ? file.findChild(name) : null;
    if (child != null && !filter.accept(child)) {
      child=null;
    }
    _readFileIndex(in,child,filter,result);
  }
}
