{
  final Application app=ApplicationManager.getApplication();
  final boolean mac=Messages.canShowMacSheetPanel();
  String[] options=new String[3];
  options[0]=app.isRestartCapable() ? "Invalidate and Restart" : "Invalidate and Exit";
  options[1]=mac ? "Cancel" : "Invalidate";
  options[2]=mac ? "Invalidate" : "Cancel";
  int result=Messages.showYesNoCancelDialog(e.getData(PlatformDataKeys.PROJECT),"The caches will be invalidated and rebuilt on the next startup.\n" + "WARNING: Local History will be also cleared.\n\n" + "Would you like to continue?\n\n","Invalidate Caches",options[0],options[1],options[2],Messages.getWarningIcon());
  if (result == -1 || result == (mac ? 1 : 2)) {
    return;
  }
  FSRecords.invalidateCaches();
  if (result == 0)   app.restart();
}
