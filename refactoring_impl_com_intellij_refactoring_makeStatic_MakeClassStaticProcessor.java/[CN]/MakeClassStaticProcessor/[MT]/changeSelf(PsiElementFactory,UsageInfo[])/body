{
  PsiClass containingClass=myMember.getContainingClass();
  List<PsiType> addedTypes=new ArrayList<PsiType>();
  if (mySettings.isMakeClassParameter()) {
    PsiType type=factory.createType(containingClass,PsiSubstitutor.EMPTY);
    final String classParameterName=mySettings.getClassParameterName();
    final String fieldName=convertToFieldName(classParameterName);
    addedTypes.add(type);
    myMember.add(factory.createField(fieldName,type));
  }
  if (mySettings.isMakeFieldParameters()) {
    List<Settings.FieldParameter> parameters=mySettings.getParameterOrderList();
    for (    Settings.FieldParameter fieldParameter : parameters) {
      final PsiType type=fieldParameter.field.getType();
      addedTypes.add(type);
      final PsiField field=factory.createField(convertToFieldName(fieldParameter.name),type);
      myMember.add(field);
    }
  }
  PsiMethod[] constructors=myMember.getConstructors();
  if (constructors.length == 0) {
    final PsiMethod defConstructor=(PsiMethod)myMember.add(factory.createConstructor());
    constructors=new PsiMethod[]{defConstructor};
  }
  boolean generateFinalParams=CodeStyleSettingsManager.getSettings(myProject).GENERATE_FINAL_PARAMETERS;
  for (  PsiMethod constructor : constructors) {
    final MethodJavaDocHelper javaDocHelper=new MethodJavaDocHelper(constructor);
    PsiParameterList paramList=constructor.getParameterList();
    PsiElement addParameterAfter=null;
    PsiDocTag anchor=null;
    if (mySettings.isMakeClassParameter()) {
      PsiType parameterType=factory.createType(containingClass,PsiSubstitutor.EMPTY);
      final String classParameterName=mySettings.getClassParameterName();
      PsiParameter parameter=factory.createParameter(classParameterName,parameterType);
      parameter.getModifierList().setModifierProperty(PsiModifier.FINAL,makeClassParameterFinal(usages) || generateFinalParams);
      addParameterAfter=paramList.addAfter(parameter,null);
      anchor=javaDocHelper.addParameterAfter(classParameterName,anchor);
      addAssignmentToField(classParameterName,constructor);
    }
    if (mySettings.isMakeFieldParameters()) {
      List<Settings.FieldParameter> parameters=mySettings.getParameterOrderList();
      for (      Settings.FieldParameter fieldParameter : parameters) {
        final PsiType fieldParameterType=fieldParameter.field.getType();
        final PsiParameter parameter=factory.createParameter(fieldParameter.name,fieldParameterType);
        parameter.getModifierList().setModifierProperty(PsiModifier.FINAL,makeFieldParameterFinal(fieldParameter.field,usages) || generateFinalParams);
        addParameterAfter=paramList.addAfter(parameter,addParameterAfter);
        anchor=javaDocHelper.addParameterAfter(fieldParameter.name,anchor);
        addAssignmentToField(fieldParameter.name,constructor);
      }
    }
  }
  setupTypeParameterList(addedTypes);
  final PsiModifierList modifierList=myMember.getModifierList();
  modifierList.setModifierProperty(PsiModifier.STATIC,true);
  modifierList.setModifierProperty(PsiModifier.FINAL,false);
}
