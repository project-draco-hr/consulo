{
  final Project project=e.getProject();
  final Editor editor=e.getData(CommonDataKeys.EDITOR);
  if (Boolean.TRUE.equals(e.getData(PlatformDataKeys.IS_MODAL_CONTEXT))) {
    return;
  }
  if (project != null && editor != null) {
    if (DumbService.getInstance(project).isDumb()) {
      DumbService.getInstance(project).showDumbModeNotification(IdeBundle.message("goto.custom.region.message.dumb.mode"));
      return;
    }
    CommandProcessor processor=CommandProcessor.getInstance();
    processor.executeCommand(project,new Runnable(){
      @Override public void run(){
        Collection<FoldingDescriptor> foldingDescriptors=getCustomFoldingDescriptors(editor,project);
        if (foldingDescriptors.size() > 0) {
          CustomFoldingRegionsPopup regionsPopup=new CustomFoldingRegionsPopup(foldingDescriptors,editor,project);
          regionsPopup.show();
        }
 else {
          notifyCustomRegionsUnavailable(editor,project);
        }
      }
    }
,IdeBundle.message("goto.custom.region.command"),null);
  }
}
