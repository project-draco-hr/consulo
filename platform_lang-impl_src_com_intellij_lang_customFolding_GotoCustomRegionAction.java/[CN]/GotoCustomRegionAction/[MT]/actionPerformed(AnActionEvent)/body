{
  final Project project=e.getProject();
  final Editor editor=e.getData(CommonDataKeys.EDITOR);
  if (Boolean.TRUE.equals(e.getData(PlatformDataKeys.IS_MODAL_CONTEXT))) {
    return;
  }
  if (project != null && editor != null) {
    if (DumbService.getInstance(project).isDumb()) {
      DumbService.getInstance(project).showDumbModeNotification(IdeBundle.message("goto.custom.region.message.dumb.mode"));
      return;
    }
    CommandProcessor processor=CommandProcessor.getInstance();
    processor.executeCommand(project,new Runnable(){
      @Override public void run(){
        GotoCustomRegionDialog dialog=new GotoCustomRegionDialog(project,editor);
        dialog.show();
        if (dialog.isOK()) {
          PsiElement navigationElement=dialog.getNavigationElement();
          if (navigationElement != null) {
            navigateTo(editor,navigationElement);
            IdeDocumentHistory.getInstance(project).includeCurrentCommandAsNavigation();
          }
        }
      }
    }
,IdeBundle.message("goto.custom.region.command"),null);
  }
}
