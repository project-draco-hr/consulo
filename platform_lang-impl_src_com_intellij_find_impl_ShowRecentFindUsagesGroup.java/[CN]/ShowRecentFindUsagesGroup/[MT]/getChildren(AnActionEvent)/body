{
  if (e == null)   return EMPTY_ARRAY;
  Project project=e.getData(CommonDataKeys.PROJECT);
  if (project == null)   return EMPTY_ARRAY;
  final FindUsagesManager findUsagesManager=((FindManagerImpl)FindManager.getInstance(project)).getFindUsagesManager();
  List<ConfigurableUsageTarget> history=new ArrayList<ConfigurableUsageTarget>(findUsagesManager.getHistory().getAll());
  Collections.reverse(history);
  String description=ActionManager.getInstance().getAction(UsageViewImpl.SHOW_RECENT_FIND_USAGES_ACTION_ID).getTemplatePresentation().getDescription();
  List<AnAction> children=new ArrayList<AnAction>(history.size());
  for (  final ConfigurableUsageTarget usageTarget : history) {
    if (!usageTarget.isValid()) {
      continue;
    }
    String text=usageTarget.getLongDescriptiveName();
    AnAction action=new AnAction(text,description,null){
      @Override public void actionPerformed(      final AnActionEvent e){
        findUsagesManager.rerunAndRecallFromHistory(usageTarget);
      }
    }
;
    children.add(action);
  }
  return children.toArray(new AnAction[children.size()]);
}
