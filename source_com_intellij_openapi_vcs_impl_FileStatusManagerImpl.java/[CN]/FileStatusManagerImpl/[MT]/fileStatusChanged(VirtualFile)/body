{
  if (!ApplicationManager.getApplication().isDispatchThread()) {
    ApplicationManager.getApplication().invokeLater(new Runnable(){
      public void run(){
        fileStatusChanged(file);
      }
    }
);
    return;
  }
  if (!file.isValid())   return;
  FileStatus cachedStatus=getCachedStatus(file);
  if (cachedStatus == null)   return;
  FileStatus newStatus=calcStatus(file);
  if (cachedStatus == newStatus)   return;
  myCachedStatuses.put(file,newStatus);
  final FileStatusListener[] listeners=myListeners.toArray(new FileStatusListener[myListeners.size()]);
  for (int i=0; i < listeners.length; i++) {
    FileStatusListener listener=listeners[i];
    listener.fileStatusChanged(file);
  }
}
