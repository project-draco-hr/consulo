{
  if (!fileIsInContent(virtualFile))   return FileStatus.NOT_CHANGED;
  final AbstractVcs vcs=ProjectLevelVcsManager.getInstance(myProject).getVcsFor(virtualFile);
  if (vcs == null)   return FileStatus.NOT_CHANGED;
  FileStatusProvider vcsStatusProvider=vcs.getFileStatusProvider();
  if (vcsStatusProvider != null) {
    if (!ChangeListManager.getInstance(myProject).isFileAffected(virtualFile)) {
      return isDocumentModified(virtualFile) ? FileStatus.MODIFIED : FileStatus.NOT_CHANGED;
    }
    FileStatus status=vcsStatusProvider.getStatus(virtualFile);
    if (status.equals(FileStatus.NOT_CHANGED) && isDocumentModified(virtualFile)) {
      return FileStatus.MODIFIED;
    }
    return status;
  }
 else {
    return FileStatus.NOT_CHANGED;
  }
}
