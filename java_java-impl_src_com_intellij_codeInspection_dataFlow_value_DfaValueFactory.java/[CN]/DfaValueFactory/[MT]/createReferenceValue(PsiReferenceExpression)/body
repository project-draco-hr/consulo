{
  PsiElement psiSource=referenceExpression.resolve();
  if (!(psiSource instanceof PsiVariable)) {
    return null;
  }
  final PsiVariable variable=(PsiVariable)psiSource;
  if (variable.hasModifierProperty(PsiModifier.FINAL)) {
    DfaValue constValue=getConstFactory().create(variable);
    if (constValue != null)     return constValue;
    PsiExpression initializer=variable.getInitializer();
    PsiType type=initializer == null ? null : initializer.getType();
    if (initializer != null && type != null && isNotNullExpression(initializer,type)) {
      return getNotNullFactory().create(type);
    }
  }
  if (isEffectivelyUnqualified(referenceExpression)) {
    return getVarFactory().createVariableValue(variable,referenceExpression.getType(),false,null,false);
  }
  return null;
}
