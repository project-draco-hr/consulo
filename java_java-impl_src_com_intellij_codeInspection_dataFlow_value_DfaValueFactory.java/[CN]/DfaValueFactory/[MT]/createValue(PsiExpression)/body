{
  if (psiExpression instanceof PsiReferenceExpression) {
    return createReferenceValue((PsiReferenceExpression)psiExpression);
  }
  if (psiExpression instanceof PsiLiteralExpression) {
    return createLiteralValue((PsiLiteralExpression)psiExpression);
  }
  if (psiExpression instanceof PsiNewExpression) {
    return getNotNullFactory().create(psiExpression.getType());
  }
  final Object value=JavaConstantExpressionEvaluator.computeConstantExpression(psiExpression,false);
  PsiType type=psiExpression.getType();
  if (value != null && type != null) {
    if (value instanceof String) {
      return getNotNullFactory().create(type);
    }
    return getConstFactory().createFromValue(value,type);
  }
  return null;
}
