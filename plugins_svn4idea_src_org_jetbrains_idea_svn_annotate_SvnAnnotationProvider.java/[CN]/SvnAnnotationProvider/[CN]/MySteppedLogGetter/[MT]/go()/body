{
  final int maxAnnotateRevisions=SvnConfiguration.getInstance(myVcs.getProject()).getMaxAnnotateRevisions();
  boolean longHistory=true;
  if (maxAnnotateRevisions == -1) {
    longHistory=false;
  }
 else {
    if (myEndRevision.getNumber() < maxAnnotateRevisions) {
      longHistory=false;
    }
  }
  if (!longHistory) {
    doLog(mySupportsMergeinfo,null,0);
    putDefaultBounds();
  }
 else {
    doLog(false,null,0);
    final List<VcsFileRevision> fileRevisionList=myResult.getRevisions();
    if (fileRevisionList.size() < maxAnnotateRevisions) {
      putDefaultBounds();
      if (mySupportsMergeinfo) {
        doLog(true,null,0);
      }
      return;
    }
    myRevisionPoints.add(((SvnRevisionNumber)fileRevisionList.get(0).getRevisionNumber()).getRevision());
    final SVNRevision truncateTo=((SvnRevisionNumber)fileRevisionList.get(maxAnnotateRevisions - 1).getRevisionNumber()).getRevision();
    myRevisionPoints.add(truncateTo);
    myResult.clearRevisions();
    if (mySupportsMergeinfo) {
      doLog(true,truncateTo,maxAnnotateRevisions);
    }
  }
}
