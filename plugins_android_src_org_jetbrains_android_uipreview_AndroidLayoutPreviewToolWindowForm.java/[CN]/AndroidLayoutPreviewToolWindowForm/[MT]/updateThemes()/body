{
  if (myFile == null) {
    return;
  }
  final AndroidFacet facet=AndroidFacet.getInstance(myFile);
  if (facet == null) {
    return;
  }
  final List<ThemeData> themes=new ArrayList<ThemeData>();
  final HashSet<ThemeData> addedThemes=new HashSet<ThemeData>();
  collectThemesFromManifest(facet,themes,addedThemes);
  collectProjectThemes(facet,themes,addedThemes);
  final Module module=facet.getModule();
  final AndroidPlatform androidPlatform=AndroidPlatform.getInstance(module);
  if (androidPlatform != null) {
    IAndroidTarget target=getSelectedTarget();
    if (target == null) {
      target=androidPlatform.getTarget();
    }
    final AndroidTargetData targetData=androidPlatform.getSdk().getTargetData(target);
    if (targetData != null) {
      if (targetData.areThemesCached()) {
        collectFrameworkThemes(module,targetData,themes);
        doApplyThemes(themes);
      }
 else {
        ApplicationManager.getApplication().executeOnPooledThread(new Runnable(){
          @Override public void run(){
            collectFrameworkThemes(module,targetData,themes);
            ApplicationManager.getApplication().invokeLater(new Runnable(){
              @Override public void run(){
                doApplyThemes(themes);
                myToolWindowManager.render();
              }
            }
);
          }
        }
);
      }
    }
  }
}
