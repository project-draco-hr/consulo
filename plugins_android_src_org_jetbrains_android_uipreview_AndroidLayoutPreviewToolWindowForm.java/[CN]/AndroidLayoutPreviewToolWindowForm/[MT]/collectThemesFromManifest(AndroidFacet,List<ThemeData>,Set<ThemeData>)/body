{
  final Manifest manifest=facet.getManifest();
  if (manifest == null) {
    return;
  }
  final Application application=manifest.getApplication();
  if (application == null) {
    return;
  }
  final List<ThemeData> activityThemesList=new ArrayList<ThemeData>();
  final XmlTag applicationTag=application.getXmlTag();
  ThemeData applicationTheme=null;
  if (applicationTag != null) {
    final String applicationThemeRef=applicationTag.getAttributeValue("theme",SdkConstants.NS_RESOURCES);
    if (applicationThemeRef != null) {
      applicationTheme=getThemeByRef(applicationThemeRef);
    }
  }
  for (  Activity activity : application.getActivities()) {
    final XmlTag activityTag=activity.getXmlTag();
    if (activityTag != null) {
      final String activityThemeRef=activityTag.getAttributeValue("theme",SdkConstants.NS_RESOURCES);
      if (activityThemeRef != null) {
        final ThemeData activityTheme=getThemeByRef(activityThemeRef);
        if (addedThemes.add(activityTheme)) {
          activityThemesList.add(activityTheme);
        }
      }
    }
  }
  if (applicationTheme != null) {
    if (addedThemes.add(applicationTheme)) {
      resultList.add(applicationTheme);
    }
  }
  Collections.sort(activityThemesList);
  resultList.addAll(activityThemesList);
}
