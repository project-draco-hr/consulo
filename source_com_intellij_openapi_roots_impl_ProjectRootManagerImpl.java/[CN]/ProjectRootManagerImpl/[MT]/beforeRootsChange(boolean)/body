{
  ApplicationManager.getApplication().assertWriteAccessAllowed();
  if (myRootsChangeCounter == 0) {
    if (myIsRootsChangedOnDemandStartedButNotDemanded) {
      myIsRootsChangedOnDemandStartedButNotDemanded=false;
      myRootsChangeCounter++;
    }
    myModuleRootEventDispatcher.getMulticaster().beforeRootsChange(new ModuleRootEventImpl(myProject,filetypes));
  }
  LocalFileSystem.getInstance().removeWatchedRoots(myRootsToWatch);
  myRootsToWatch.clear();
  myRootsChangeCounter++;
}
