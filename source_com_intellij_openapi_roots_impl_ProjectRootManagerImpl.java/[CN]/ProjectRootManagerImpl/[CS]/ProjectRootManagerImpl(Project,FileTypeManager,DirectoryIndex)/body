{
  myProject=(ProjectEx)project;
  myFileTypeListener=new FileTypeListener(){
    public void beforeFileTypesChanged(    FileTypeEvent event){
      beforeRootsChange(true);
    }
    public void fileTypesChanged(    FileTypeEvent event){
      rootsChanged(true);
    }
  }
;
  fileTypeManager.addFileTypeListener(myFileTypeListener);
  myProjectFileIndex=new ProjectFileIndexImpl(myProject,directoryIndex,fileTypeManager);
}
