{
  final DataContext dataContext=e.getDataContext();
  final Editor editor=PlatformDataKeys.EDITOR.getData(dataContext);
  final Project project=CommonDataKeys.PROJECT.getData(dataContext);
  if (project == null || editor == null) {
    return null;
  }
  final VirtualFile file=PlatformDataKeys.VIRTUAL_FILE.getData(dataContext);
  if (file == null) {
    return null;
  }
  final PsiFile psiFile=PsiManager.getInstance(project).findFile(file);
  if (!(psiFile instanceof XmlFile)) {
    return null;
  }
  final XmlFile xmlFile=(XmlFile)psiFile;
  final AntBuildFileBase antFile=AntConfigurationBase.getInstance(project).getAntBuildFile(xmlFile);
  if (antFile == null) {
    return null;
  }
  final PsiElement element=xmlFile.findElementAt(editor.getCaretModel().getOffset());
  if (element == null) {
    return null;
  }
  final XmlTag xmlTag=PsiTreeUtil.getParentOfType(element,XmlTag.class);
  if (xmlTag == null) {
    return null;
  }
  DomElement dom=AntSupport.getAntDomElement(xmlTag);
  while (dom != null && !(dom instanceof AntDomTarget)) {
    dom=dom.getParent();
  }
  final AntDomTarget domTarget=(AntDomTarget)dom;
  if (domTarget == null) {
    return null;
  }
  return Pair.create(antFile,domTarget);
}
