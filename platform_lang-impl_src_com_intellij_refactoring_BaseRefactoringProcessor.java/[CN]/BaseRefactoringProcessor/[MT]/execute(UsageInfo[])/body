{
  CommandProcessor.getInstance().executeCommand(myProject,new Runnable(){
    public void run(){
      ApplicationManager.getApplication().runWriteAction(new Runnable(){
        public void run(){
          Collection<UsageInfo> usageInfos=new HashSet<UsageInfo>(Arrays.asList(usages));
          doRefactoring(usageInfos);
          if (isGlobalUndoAction())           CommandProcessor.getInstance().markCurrentCommandAsGlobal(myProject);
        }
      }
);
    }
  }
,getCommandName(),null,getUndoConfirmationPolicy());
}
