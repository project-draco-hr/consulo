{
  PsiExpression qualifier=expression.getQualifierExpression();
  if (qualifier != null && !(qualifier instanceof PsiThisExpression) && !(qualifier instanceof PsiSuperExpression)) {
    qualifier.accept(this);
    if (!(qualifier instanceof PsiReferenceExpression) || !(((PsiReferenceExpression)qualifier).resolve() instanceof PsiClass)) {
      return;
    }
  }
  PsiElement referencedElement=expression.resolve();
  if (referencedElement != null) {
    PsiClass containingClass=null;
    if (referencedElement instanceof PsiField) {
      containingClass=((PsiField)referencedElement).getContainingClass();
    }
 else     if (referencedElement instanceof PsiMethod) {
      containingClass=((PsiMethod)referencedElement).getContainingClass();
    }
 else     if (referencedElement instanceof PsiClass) {
      if (PsiTreeUtil.isAncestor(myClass,referencedElement,true)) {
        visitClassMemberReferenceExpression((PsiMember)referencedElement,expression);
        return;
      }
    }
    if (isPartOf(myClass,containingClass)) {
      visitClassMemberReferenceExpression((PsiMember)referencedElement,expression);
    }
  }
}
