{
  final ProjectFileIndex fileIndex=ProjectRootManager.getInstance(defaultProject).getFileIndex();
  final HashSet<Module> modules=new HashSet<Module>();
  if (myType == FILE) {
    final VirtualFile vFile=((PsiFileSystemItem)myElement).getVirtualFile();
    modules.addAll(getAllInterestingModules(fileIndex,vFile));
  }
 else   if (myType == DIRECTORY) {
    final VirtualFile vFile=((PsiFileSystemItem)myElement).getVirtualFile();
    modules.addAll(getAllInterestingModules(fileIndex,vFile));
  }
 else   if (myType == MODULE) {
    modules.add(myModule);
  }
 else   if (myType == MODULES) {
    modules.addAll(myModules);
  }
  return collectScopes(defaultProject,modules);
}
