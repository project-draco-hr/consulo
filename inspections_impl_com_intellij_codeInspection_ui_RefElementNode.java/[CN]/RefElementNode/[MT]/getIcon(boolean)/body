{
  final RefEntity refEntity=getElement();
  if (refEntity == null) {
    return null;
  }
  if (refEntity instanceof RefElement) {
    final RefElement refElement=(RefElement)refEntity;
    final PsiElement element=refElement.getElement();
    if (element != null) {
      final int flags=Iconable.ICON_FLAG_VISIBILITY | Iconable.ICON_FLAG_READ_STATUS;
      if (refElement.isSyntheticJSP()) {
        return IconUtil.getIcon(element.getContainingFile().getVirtualFile(),flags,element.getProject());
      }
      return element.getIcon(flags);
    }
 else {
      return null;
    }
  }
 else   if (refEntity instanceof RefPackage) {
    return expanded ? Icons.PACKAGE_OPEN_ICON : Icons.PACKAGE_ICON;
  }
 else   if (refEntity instanceof RefModule) {
    return ((RefModule)refEntity).getModule().getModuleType().getNodeIcon(expanded);
  }
  return null;
}
