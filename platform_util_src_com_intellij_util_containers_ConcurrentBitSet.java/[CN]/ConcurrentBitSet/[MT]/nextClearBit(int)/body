{
  if (fromIndex < 0) {
    throw new IndexOutOfBoundsException("fromIndex < 0: " + fromIndex);
  }
  int arrayIndex=arrayIndex(fromIndex);
  AtomicLongArray array=arrays.get(arrayIndex);
  int wordIndexInArray=wordIndexInArray(fromIndex);
  if (array == null) {
    return ((1 << arrayIndex) - 1 + wordIndexInArray) * BITS_PER_WORD + (fromIndex % BITS_PER_WORD);
  }
  long word=~array.get(wordIndexInArray) & (WORD_MASK << fromIndex);
  while (true) {
    if (word != 0) {
      return ((1 << arrayIndex) - 1 + wordIndexInArray) * BITS_PER_WORD + Long.numberOfTrailingZeros(word);
    }
    if (++wordIndexInArray == array.length()) {
      wordIndexInArray=0;
      if (++arrayIndex == arrays.length())       return -1;
      array=arrays.get(arrayIndex);
      if (array == null) {
        return ((1 << arrayIndex) - 1 + wordIndexInArray) * BITS_PER_WORD;
      }
    }
    word=~array.get(wordIndexInArray);
  }
}
