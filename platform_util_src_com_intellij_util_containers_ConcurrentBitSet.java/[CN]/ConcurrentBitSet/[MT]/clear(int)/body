{
  if (bitIndex < 0) {
    throw new IndexOutOfBoundsException("bitIndex < 0: " + bitIndex);
  }
  AtomicLongArray array=getOrCreateArray(bitIndex);
  int wordIndexInArray=wordIndexInArray(bitIndex);
  long word;
  long newWord;
  boolean previousBit;
  do {
    word=array.get(wordIndexInArray);
    previousBit=(word & (1L << bitIndex)) != 0;
    newWord=word & ~(1L << bitIndex);
  }
 while (!array.compareAndSet(wordIndexInArray,word,newWord));
  return previousBit;
}
