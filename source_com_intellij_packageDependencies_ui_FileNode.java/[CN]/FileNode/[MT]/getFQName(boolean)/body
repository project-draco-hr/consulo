{
  StringBuffer buf=new StringBuffer(20);
  if (myFile instanceof PsiJavaFile && !fileSeparator) {
    String packageName=((PsiJavaFile)myFile).getPackageName();
    buf.append(packageName);
    if (buf.length() > 0) {
      buf.append('.');
    }
    final VirtualFile virtualFile=myFile.getVirtualFile();
    LOG.assertTrue(virtualFile != null);
    buf.append(virtualFile.getNameWithoutExtension());
    return buf.toString();
  }
 else {
    final VirtualFile virtualFile=myFile.getVirtualFile();
    LOG.assertTrue(virtualFile != null);
    final VirtualFile contentRoot=ProjectRootManager.getInstance(myFile.getProject()).getFileIndex().getContentRootForFile(virtualFile);
    if (contentRoot == null)     return null;
    return VfsUtil.getRelativePath(virtualFile,contentRoot,'/');
  }
}
