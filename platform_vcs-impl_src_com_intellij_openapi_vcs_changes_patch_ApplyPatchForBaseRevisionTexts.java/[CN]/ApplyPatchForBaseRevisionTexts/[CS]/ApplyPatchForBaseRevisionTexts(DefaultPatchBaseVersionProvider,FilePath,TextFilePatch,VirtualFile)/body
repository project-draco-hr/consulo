{
  myWarnings=new ArrayList<String>();
  final FileDocumentManager fileDocumentManager=FileDocumentManager.getInstance();
  Document document=fileDocumentManager.getDocument(file);
  if (document != null) {
    fileDocumentManager.saveDocument(document);
  }
  myLocal=LoadTextUtil.loadText(file);
  final StringBuilder newText=new StringBuilder();
  provider.getBaseVersionContent(pathBeforeRename,new Processor<CharSequence>(){
    public boolean process(    final CharSequence text){
      newText.setLength(0);
      try {
        myStatus=ApplyFilePatchBase.applyModifications(patch,text,newText);
      }
 catch (      ApplyPatchException ex) {
        return true;
      }
      myBase=text;
      myBaseRevisionLoaded=true;
      return false;
    }
  }
,myWarnings);
  if ((!myBaseRevisionLoaded) || myStatus == null || ApplyPatchStatus.FAILURE.equals(myStatus)) {
    throw new VcsException(getCannotLoadBaseMessage(pathBeforeRename.getPath()));
  }
  myPatched=newText.toString();
}
