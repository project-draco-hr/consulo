{
  final List<PackagingSourceItem> items=mySourceItemsTree.getSelectedItems();
  boolean enabled=false;
  final Presentation presentation=e.getPresentation();
  if (!items.isEmpty()) {
    enabled=true;
    Set<String> paths=new HashSet<String>();
    for (    PackagingSourceItem item : items) {
      final String path=getDefaultPath(item);
      if (path == null) {
        enabled=false;
        break;
      }
      paths.add(StringUtil.trimStart(StringUtil.trimEnd(path,"/"),"/"));
    }
    String target;
    if (paths.size() == 1) {
      final String path=paths.iterator().next();
      if (path.length() > 0) {
        target="/" + path;
      }
 else {
        target="output root";
      }
    }
 else {
      target="default locations";
    }
    presentation.setText("Put into " + target);
  }
  presentation.setVisible(enabled);
  presentation.setEnabled(enabled);
}
