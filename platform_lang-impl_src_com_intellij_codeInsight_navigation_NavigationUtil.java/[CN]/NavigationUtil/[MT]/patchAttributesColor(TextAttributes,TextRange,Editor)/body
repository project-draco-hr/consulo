{
  MarkupModel model=DocumentMarkupModel.forDocument(editor.getDocument(),editor.getProject(),false);
  if (model != null) {
    if (!((MarkupModelEx)model).processRangeHighlightersOverlappingWith(range.getStartOffset(),range.getEndOffset(),new Processor<RangeHighlighterEx>(){
      @Override public boolean process(      RangeHighlighterEx highlighter){
        if (highlighter.isValid() && highlighter.getTargetArea() == HighlighterTargetArea.LINES_IN_RANGE) {
          TextAttributes textAttributes=highlighter.getTextAttributes();
          if (textAttributes != null) {
            Color color=textAttributes.getBackgroundColor();
            return !(color != null && color.getBlue() > 128 && color.getRed() < 128 && color.getGreen() < 128);
          }
        }
        return true;
      }
    }
)) {
      TextAttributes clone=attributes.clone();
      clone.setForegroundColor(Color.orange);
      clone.setEffectColor(Color.orange);
      return clone;
    }
  }
  return attributes;
}
