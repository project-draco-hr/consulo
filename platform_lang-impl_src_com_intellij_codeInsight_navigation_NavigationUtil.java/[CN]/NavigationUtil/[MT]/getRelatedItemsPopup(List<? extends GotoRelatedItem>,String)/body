{
  Object[] elements=new Object[items.size()];
  final Map<PsiElement,GotoRelatedItem> itemsMap=new HashMap<PsiElement,GotoRelatedItem>();
  for (int i=0; i < items.size(); i++) {
    GotoRelatedItem item=items.get(i);
    elements[i]=item.getElement() != null ? item.getElement() : item;
    itemsMap.put(item.getElement(),item);
  }
  return getPsiElementPopup(elements,itemsMap,title,new Processor<Object>(){
    @Override public boolean process(    Object element){
      if (element instanceof PsiElement) {
        itemsMap.get(element).navigate();
      }
 else {
        ((GotoRelatedItem)element).navigate();
      }
      return true;
    }
  }
);
}
