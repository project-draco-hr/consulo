{
  for (int i=0; i < myChildren.size(); i++) {
    CachingChildrenTreeNode newInstance=myChildren.get(i);
    if (newInstance instanceof TreeElementWrapper) {
      final StructureViewTreeElement newElement=(StructureViewTreeElement)newInstance.getValue();
      if (oldInstance instanceof TreeElementWrapper) {
        final StructureViewTreeElement oldElement=(StructureViewTreeElement)oldInstance.getValue();
        if (newElement.getValue() != null) {
          if (Comparing.equal(newElement.getValue(),oldElement.getValue()))           return i;
        }
      }
    }
 else {
      if (newInstance.equals(oldInstance))       return i;
    }
  }
  return -1;
}
