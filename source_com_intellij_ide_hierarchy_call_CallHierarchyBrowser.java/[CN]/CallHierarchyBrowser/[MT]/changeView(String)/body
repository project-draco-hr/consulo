{
  myCurrentViewType=typeName;
  final PsiElement element=mySmartPsiElementPointer.getElement();
  if (!(element instanceof PsiMethod)) {
    return;
  }
  final PsiMethod method=(PsiMethod)element;
  if (myContent != null) {
    myContent.setDisplayName(typeName + method.getName());
  }
  myCardLayout.show(myTreePanel,typeName);
  if (!myBuilders.containsKey(typeName)) {
    setWaitCursor();
    final JTree tree=myType2TreeMap.get(typeName);
    final DefaultTreeModel model=new DefaultTreeModel(new DefaultMutableTreeNode(""));
    tree.setModel(model);
    final HierarchyTreeStructure structure;
    PsiDocumentManager.getInstance(myProject).commitAllDocuments();
    if (CallerMethodsTreeStructure.TYPE.equals(typeName)) {
      structure=new CallerMethodsTreeStructure(myProject,method,getCurrentScopeType());
    }
 else     if (CalleeMethodsTreeStructure.TYPE.equals(typeName)) {
      structure=new CalleeMethodsTreeStructure(myProject,method,getCurrentScopeType());
    }
 else {
      LOG.error("unexpected type: " + typeName);
      return;
    }
    final Comparator<NodeDescriptor> comparator=HierarchyBrowserManager.getInstance(myProject).getComparator();
    final HierarchyTreeBuilder builder=new HierarchyTreeBuilder(myProject,tree,model,structure,comparator);
    myBuilders.put(typeName,builder);
    final HierarchyNodeDescriptor baseDescriptor=structure.getBaseDescriptor();
    builder.buildNodeForElement(baseDescriptor);
    final DefaultMutableTreeNode node=builder.getNodeForElement(baseDescriptor);
    if (node != null) {
      final TreePath path=new TreePath(node.getPath());
      tree.expandPath(path);
      TreeUtil.selectPath(tree,path);
    }
    restoreCursor();
  }
  getCurrentTree().requestFocus();
}
