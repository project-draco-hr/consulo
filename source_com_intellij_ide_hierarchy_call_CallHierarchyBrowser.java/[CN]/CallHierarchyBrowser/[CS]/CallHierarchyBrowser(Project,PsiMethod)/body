{
  myProject=project;
  myType2ScopeMap.put(CallerMethodsTreeStructure.TYPE,SCOPE_ALL);
  myType2ScopeMap.put(CalleeMethodsTreeStructure.TYPE,SCOPE_ALL);
  myAutoScrollToSourceHandler=new AutoScrollToSourceHandler(){
    protected boolean isAutoScrollMode(){
      return HierarchyBrowserManager.getInstance(myProject).IS_AUTOSCROLL_TO_SOURCE;
    }
    protected void setAutoScrollMode(    final boolean state){
      HierarchyBrowserManager.getInstance(myProject).IS_AUTOSCROLL_TO_SOURCE=state;
    }
  }
;
  setHierarchyBase(method);
  setLayout(new BorderLayout());
  final ActionToolbar toolbar=createToolbar();
  add(toolbar.getComponent(),BorderLayout.NORTH);
  myCardLayout=new CardLayout();
  myTreePanel=new JPanel(myCardLayout);
  myType2TreeMap.put(CalleeMethodsTreeStructure.TYPE,createTree());
  myType2TreeMap.put(CallerMethodsTreeStructure.TYPE,createTree());
  for (  String key : myType2TreeMap.keySet()) {
    final JTree tree=myType2TreeMap.get(key);
    myOccurenceNavigators.put(key,new OccurenceNavigatorSupport(tree){
      @Nullable protected Navigatable createDescriptorForNode(      DefaultMutableTreeNode node){
        final Object userObject=node.getUserObject();
        if (userObject instanceof String)         return null;
        CallHierarchyNodeDescriptor nodeDescriptor=(CallHierarchyNodeDescriptor)userObject;
        final PsiElement psiElement=nodeDescriptor.getTargetElement();
        if (psiElement == null || !psiElement.isValid())         return null;
        return new OpenFileDescriptor(psiElement.getProject(),psiElement.getContainingFile().getVirtualFile(),psiElement.getTextOffset());
      }
      public String getNextOccurenceActionName(){
        return IdeBundle.message("hierarchy.call.next.occurence.name");
      }
      public String getPreviousOccurenceActionName(){
        return IdeBundle.message("hierarchy.call.prev.occurence.name");
      }
    }
);
    myTreePanel.add(new JScrollPane(tree),key);
  }
  add(myTreePanel,BorderLayout.CENTER);
}
