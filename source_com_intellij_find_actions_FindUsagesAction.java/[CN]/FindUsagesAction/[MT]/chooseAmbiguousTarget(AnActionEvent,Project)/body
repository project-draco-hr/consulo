{
  Editor editor=e.getData(DataKeys.EDITOR);
  if (editor != null) {
    int offset=editor.getCaretModel().getOffset();
    if (GotoDeclarationAction.chooseAmbiguousTarget(project,editor,offset,new PsiElementProcessor<PsiElement>(){
      public boolean execute(      final PsiElement element){
        new PsiElement2UsageTargetAdapter(element).findUsages();
        return false;
      }
    }
,FindBundle.message("find.usages.ambiguous.title")))     return;
  }
  Messages.showMessageDialog(project,FindBundle.message("find.no.usages.at.cursor.error"),CommonBundle.getErrorTitle(),Messages.getErrorIcon());
}
