{
  final Runnable checkinAction=new Runnable(){
    public void run(){
      final List<VcsException> vcsExceptions=new ArrayList<VcsException>();
      final List<Change> changesFailedToCommit=new ArrayList<Change>();
      ProgressManager.getInstance().runProcessWithProgressSynchronously(checkinAction(vcsExceptions,changesFailedToCommit,myChangeList),myActionName,true,myProject);
    }
  }
;
  AbstractVcsHelper.getInstance(myProject).optimizeImportsAndReformatCode(collectVirtualFiles(),VcsConfiguration.getInstance(myProject),checkinAction,true);
}
