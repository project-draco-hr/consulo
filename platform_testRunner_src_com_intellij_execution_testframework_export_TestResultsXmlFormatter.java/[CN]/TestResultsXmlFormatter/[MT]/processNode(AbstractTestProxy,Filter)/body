{
  ProgressManager.checkCanceled();
  Map<String,String> attrs=new HashMap<String,String>();
  attrs.put(ATTR_NAME,node.getName());
  attrs.put(ATTR_STATUS,getStatusString(node));
  Long duration=node.getDuration();
  if (duration != null) {
    attrs.put(ATTR_DURATION,String.valueOf(duration));
  }
  String locationUrl=node.getLocationUrl();
  if (locationUrl != null) {
    attrs.put(ATTR_LOCATION,locationUrl);
  }
  if (node.isConfig()) {
    attrs.put(ATTR_CONFIG,"true");
  }
  boolean started=false;
  String elemName=node.isLeaf() ? ELEM_TEST : ELEM_SUITE;
  if (node.isLeaf()) {
    started=true;
    startElement(elemName,attrs);
    writeOutput(node,filter);
  }
 else {
    for (    AbstractTestProxy child : node.getChildren()) {
      if (myHidePassedConfig && child.isConfig() && child.isPassed()) {
        continue;
      }
      if (!started) {
        started=true;
        startElement(elemName,attrs);
      }
      processNode(child,filter);
    }
  }
  if (started) {
    endElement(elemName);
  }
}
