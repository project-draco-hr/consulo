{
  final StringBuilder buffer=new StringBuilder();
  final Ref<ConsoleViewContentType> lastType=new Ref<ConsoleViewContentType>();
  final Ref<SAXException> error=new Ref<SAXException>();
  final int bufferSize=ConsoleBuffer.useCycleBuffer() ? ConsoleBuffer.getCycleBufferSize() : -1;
  final Printer printer=new Printer(){
    @Override public void print(    String text,    ConsoleViewContentType contentType){
      ProgressManager.checkCanceled();
      if (contentType != lastType.get()) {
        if (buffer.length() > 0) {
          try {
            writeOutput(lastType.get(),buffer,filter);
          }
 catch (          SAXException e) {
            error.set(e);
          }
        }
        lastType.set(contentType);
      }
      if (bufferSize < 0 || buffer.length() < bufferSize) {
        buffer.append(text);
      }
    }
    @Override public void onNewAvailable(    @NotNull Printable printable){
    }
    @Override public void printHyperlink(    String text,    HyperlinkInfo info){
    }
    @Override public void mark(){
    }
  }
;
  node.printOwnPrintablesOn(printer);
  if (!error.isNull()) {
    throw error.get();
  }
  if (buffer.length() > 0) {
    writeOutput(lastType.get(),buffer,filter);
  }
}
