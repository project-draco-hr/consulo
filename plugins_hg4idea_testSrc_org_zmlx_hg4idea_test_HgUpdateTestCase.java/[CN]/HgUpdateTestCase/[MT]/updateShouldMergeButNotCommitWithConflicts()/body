{
  changeFile_A_AndCommitInRemoteRepository();
  VirtualFile commonFile=projectRepoVirtualFile.findChild("com").findChild("a.txt");
  assertNotNull(commonFile);
  editFileInCommand(myProject,commonFile,"conflicting content");
  runHg(projectRepo,"commit","-m","adding conflicting history to local repository");
  PreUpdateInformation preUpdateInformation=new PreUpdateInformation().getPreUpdateInformation();
  HgRevisionNumber incomingHead=preUpdateInformation.getIncomingHead();
  HgRevisionNumber headBeforeUpdate=preUpdateInformation.getHeadBeforeUpdate();
  List<VcsException> warnings=updateThroughPlugin();
  assertFalse(warnings.isEmpty());
  assertTrue(warnings.get(warnings.size() - 1).getMessage().contains("conflicts"));
  assertTrue(warnings.get(warnings.size() - 1).getMessage().contains("commit"));
  List<HgRevisionNumber> parents=new HgWorkingCopyRevisionsCommand(myProject).parents(projectRepoVirtualFile);
  assertEquals(parents.size(),2);
  assertTrue(parents.contains(incomingHead));
  assertTrue(parents.contains(headBeforeUpdate));
}
