{
  final Presentation presentation=e.getPresentation();
  CaptionSelection selection=CaptionSelection.DATA_KEY.getData(e.getDataContext());
  if (selection == null || selection.getContainer() == null) {
    presentation.setVisible(false);
    return;
  }
  presentation.setVisible(true);
  if (selection.getSelection().length > 1) {
    presentation.setText(!selection.isRow() ? UIDesignerBundle.message("action.delete.columns") : UIDesignerBundle.message("action.delete.rows"));
  }
 else {
    presentation.setText(!selection.isRow() ? UIDesignerBundle.message("action.delete.column") : UIDesignerBundle.message("action.delete.row"));
  }
  int minCellCount=selection.getContainer().getGridLayoutManager().getMinCellCount();
  if (selection.getContainer().getGridCellCount(selection.isRow()) - selection.getSelection().length < minCellCount) {
    presentation.setEnabled(false);
  }
 else   if (selection.getFocusedIndex() < 0) {
    presentation.setEnabled(false);
  }
 else {
    presentation.setEnabled(true);
  }
}
