{
  if (currentLine >= maxRowCount && maxRowCount != -1)   return currentLine;
  StringUtil.repeatSymbol(buffer,paddingChar,currentLevel);
  buffer.append(toString(node)).append("\n");
  currentLine++;
  Object[] children=structure.getChildElements(node);
  if (comparator != null) {
    ArrayList<?> list=new ArrayList<Object>(Arrays.asList(children));
    Collections.sort(list,comparator);
    children=ArrayUtil.toObjectArray(list);
  }
  for (  Object child : children) {
    currentLine=doPrint(buffer,currentLevel + 1,child,structure,comparator,maxRowCount,currentLine,paddingChar);
  }
  return currentLine;
}
