{
  final PsiReference reference=file.findReferenceAt(refOffset);
  if (reference instanceof PsiJavaCodeReferenceElement && ((PsiJavaCodeReferenceElement)reference).isQualified()) {
    return "";
  }
  final PsiClass containingClass=method.getContainingClass();
  if (containingClass == null) {
    return "";
  }
  if (method.hasModifierProperty(PsiModifier.STATIC)) {
    return containingClass.getQualifiedName() + ".";
  }
  if (containingClass.getManager().areElementsEquivalent(containingClass,PsiTreeUtil.findElementOfClassAtOffset(file,refOffset,PsiClass.class,false))) {
    return "this.";
  }
  return containingClass.getQualifiedName() + ".this.";
}
