def push_addchangegroup(self, remote, force, revs):
    lock = remote.lock()
    try:
        ret = self.prepush(remote, force, revs)
        if (ret[0] is not None):
            (cg, remote_heads) = ret
            return remote.addchangegroup(cg, 'push', self.url())
        return ret[1]
    finally:
        lock.release()
