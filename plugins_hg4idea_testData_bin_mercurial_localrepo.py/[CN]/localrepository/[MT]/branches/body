def branches(self, nodes):
    if (not nodes):
        nodes = [self.changelog.tip()]
    b = []
    for n in nodes:
        t = n
        while 1:
            p = self.changelog.parents(n)
            if ((p[1] != nullid) or (p[0] == nullid)):
                b.append((t, n, p[0], p[1]))
                break
            n = p[0]
    return b
