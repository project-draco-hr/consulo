@propertycache
def changelog(self):
    c = changelog.changelog(self.sopener)
    if ('HG_PENDING' in os.environ):
        p = os.environ['HG_PENDING']
        if p.startswith(self.root):
            c.readpending('00changelog.i.a')
    self.sopener.options['defversion'] = c.version
    return c
