def _writebranchcache(self, branches, tip, tiprev):
    try:
        f = self.opener('branchheads.cache', 'w', atomictemp=True)
        f.write(('%s %s\n' % (hex(tip), tiprev)))
        for (label, nodes) in branches.iteritems():
            for node in nodes:
                f.write(('%s %s\n' % (hex(node), label)))
        f.rename()
    except (IOError, OSError):
        pass
