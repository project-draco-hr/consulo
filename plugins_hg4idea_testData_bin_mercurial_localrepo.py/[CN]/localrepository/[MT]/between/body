def between(self, pairs):
    r = []
    for (top, bottom) in pairs:
        (n, l, i) = (top, [], 0)
        f = 1
        while ((n != bottom) and (n != nullid)):
            p = self.changelog.parents(n)[0]
            if (i == f):
                l.append(n)
                f = (f * 2)
            n = p
            i += 1
        r.append(l)
    return r
