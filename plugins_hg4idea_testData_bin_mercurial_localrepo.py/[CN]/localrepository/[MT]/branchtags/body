def branchtags(self):
    'return a dict where branch names map to the tipmost head of\n        the branch, open heads come before closed'
    bt = {}
    for (bn, heads) in self.branchmap().iteritems():
        tip = heads[(-1)]
        for h in reversed(heads):
            if ('close' not in self.changelog.read(h)[5]):
                tip = h
                break
        bt[bn] = tip
    return bt
