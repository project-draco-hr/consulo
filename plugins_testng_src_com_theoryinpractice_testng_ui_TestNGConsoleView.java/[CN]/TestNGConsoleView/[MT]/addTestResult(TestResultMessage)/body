{
  if (testNGResults != null) {
    if (!results.contains(result)) {
      mark();
      results.add(result);
    }
    int exceptionMark=0;
    final String stackTrace=result.getStackTrace();
    if (stackTrace != null && stackTrace.length() > 10) {
      String trimmed=trimStackTrace(stackTrace);
      List<Printable> printables=getPrintables(result,trimmed);
      for (      Printable printable : printables) {
        printable.print(console);
      }
synchronized (allOutput) {
        exceptionMark=allOutput.size() - mark;
        allOutput.addAll(printables);
      }
    }
    testNGResults.addTestResult(result,getPrintablesSinceMark(),exceptionMark);
  }
}
