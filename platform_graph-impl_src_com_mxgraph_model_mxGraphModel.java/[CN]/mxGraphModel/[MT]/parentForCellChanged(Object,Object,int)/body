{
  mxICell child=(mxICell)cell;
  mxICell previous=(mxICell)getParent(cell);
  if (parent != null) {
    if (parent != previous || previous.getIndex(child) != index) {
      ((mxICell)parent).insert(child,index);
    }
  }
 else   if (previous != null) {
    int oldIndex=previous.getIndex(child);
    previous.remove(oldIndex);
  }
  if (!contains(previous) && parent != null) {
    cellAdded(cell);
  }
 else   if (parent == null) {
    cellRemoved(cell);
  }
  return previous;
}
