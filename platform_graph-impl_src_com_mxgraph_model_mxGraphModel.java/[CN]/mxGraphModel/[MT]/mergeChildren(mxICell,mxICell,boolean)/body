{
  beginUpdate();
  try {
    Hashtable<Object,Object> mapping=new Hashtable<Object,Object>();
    mergeChildrenImpl(from,to,cloneAllEdges,mapping);
    Iterator<Object> it=mapping.keySet().iterator();
    while (it.hasNext()) {
      Object edge=it.next();
      Object cell=mapping.get(edge);
      Object terminal=getTerminal(edge,true);
      if (terminal != null) {
        terminal=mapping.get(terminal);
        setTerminal(cell,terminal,true);
      }
      terminal=getTerminal(edge,false);
      if (terminal != null) {
        terminal=mapping.get(terminal);
        setTerminal(cell,terminal,false);
      }
    }
  }
  finally {
    endUpdate();
  }
}
