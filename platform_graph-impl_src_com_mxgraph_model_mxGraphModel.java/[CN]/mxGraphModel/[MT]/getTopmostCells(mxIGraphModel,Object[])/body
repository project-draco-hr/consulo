{
  Set<Object> hash=new HashSet<Object>();
  hash.addAll(Arrays.asList(cells));
  List<Object> result=new ArrayList<Object>(cells.length);
  for (int i=0; i < cells.length; i++) {
    Object cell=cells[i];
    boolean topmost=true;
    Object parent=model.getParent(cell);
    while (parent != null) {
      if (hash.contains(parent)) {
        topmost=false;
        break;
      }
      parent=model.getParent(parent);
    }
    if (topmost) {
      result.add(cell);
    }
  }
  return result.toArray();
}
