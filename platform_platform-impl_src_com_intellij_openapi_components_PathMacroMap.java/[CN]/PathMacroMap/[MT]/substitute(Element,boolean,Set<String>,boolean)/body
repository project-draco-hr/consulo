{
  List content=e.getContent();
  for (  Object child : content) {
    if (child instanceof Element) {
      Element element=(Element)child;
      if (element.getName().equals("macro") && element.getAttributes().size() == 2 && element.getAttributeValue("name") != null && element.getAttributeValue("value") != null && element.getChildren().isEmpty())       continue;
      substitute(element,caseSensitive,usedMacros,recursively);
    }
 else     if (child instanceof Text) {
      Text t=(Text)child;
      t.setText(recursively ? substituteRecursively(t.getText(),caseSensitive,usedMacros) : substitute(t.getText(),caseSensitive,usedMacros));
    }
 else     if (child instanceof Comment) {
    }
 else {
      LOG.error("Wrong content: " + child.getClass());
    }
  }
  List attributes=e.getAttributes();
  for (  final Object attribute1 : attributes) {
    Attribute attribute=(Attribute)attribute1;
    attribute.setValue(recursively ? substituteRecursively(attribute.getValue(),caseSensitive,usedMacros) : substitute(attribute.getValue(),caseSensitive,usedMacros));
  }
}
