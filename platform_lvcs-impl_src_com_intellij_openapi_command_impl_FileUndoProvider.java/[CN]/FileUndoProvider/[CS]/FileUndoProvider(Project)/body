{
  myProject=project;
  if (myProject == null)   return;
  myLocalHistory=LocalHistoryImpl.getInstanceImpl().getFacade();
  myGateway=LocalHistoryImpl.getInstanceImpl().getGateway();
  if (myLocalHistory == null || myGateway == null)   return;
  getFileManager().addVirtualFileListener(this,project);
  myLocalHistory.addListener(new LocalHistoryFacade.Listener(){
    @Override public void changeAdded(    Change c){
      if (!(c instanceof StructuralChange) || c instanceof ContentChange)       return;
      myLastChangeId=c.getId();
    }
  }
,myProject);
}
