{
  final DocumentReference r=createDocumentReference(e);
  if (!getUndoManager().documentWasChanged(r))   return;
  getUndoManager().undoableActionPerformed(new NonUndoableAction(){
    public DocumentReference[] getAffectedDocuments(){
      return new DocumentReference[]{r};
    }
    public boolean shouldConfirmUndo(){
      return true;
    }
  }
);
}
