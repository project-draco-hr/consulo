{
  return caret.hasSelection() ? caret.getSelectionEnd() : caret.getOffset();
}
