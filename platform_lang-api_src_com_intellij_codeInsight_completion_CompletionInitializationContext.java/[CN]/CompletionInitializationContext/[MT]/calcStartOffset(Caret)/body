{
  return caret.hasSelection() ? caret.getSelectionStart() : caret.getOffset();
}
