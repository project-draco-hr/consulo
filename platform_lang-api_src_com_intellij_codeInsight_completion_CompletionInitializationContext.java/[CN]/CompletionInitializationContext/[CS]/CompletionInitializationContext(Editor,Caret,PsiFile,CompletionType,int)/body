{
  myEditor=editor;
  myCaret=caret;
  myFile=file;
  myCompletionType=completionType;
  myInvocationCount=invocationCount;
  myOffsetMap=new OffsetMap(editor.getDocument());
  myOffsetMap.addOffset(START_OFFSET,calcStartOffset(caret));
  myOffsetMap.addOffset(SELECTION_END_OFFSET,calcSelectionEnd(caret));
  myOffsetMap.addOffset(IDENTIFIER_END_OFFSET,calcDefaultIdentifierEnd(editor,calcSelectionEnd(caret)));
}
