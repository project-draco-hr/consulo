{
  final AnalysisScope scope=new AnalysisScope(project);
  final InspectionManagerEx managerEx=(InspectionManagerEx)InspectionManager.getInstance(project);
  final GlobalInspectionContextImpl context=managerEx.createNewGlobalContext(false);
  context.setExternalProfile(inspectionProfile);
  context.setCurrentScope(scope);
  context.initializeTools(new ArrayList<Tools>(),new ArrayList<Tools>(),new ArrayList<Tools>());
  final InspectionResultsView view=new InspectionResultsView(project,inspectionProfile,scope,context,new OfflineInspectionRVContentProvider(resMap,project));
  ((RefManagerImpl)context.getRefManager()).inspectionReadActionStarted();
  view.update();
  TreeUtil.selectFirstNode(view.getTree());
  context.addView(view,title);
  return view;
}
