{
  myExceptionalIOCancellationCallback=CreationTimeOptions.EXCEPTIONAL_IO_CANCELLATION.get();
  myReadOnly=CreationTimeOptions.READONLY.get() == Boolean.TRUE;
  myCompactChunksWithValueDeserialization=CreationTimeOptions.COMPACT_CHUNKS_WITH_VALUE_DESERIALIZATION.get() == Boolean.TRUE;
  myPath=path;
  myFile=new File(path);
  myCompressedAppendableFile=COMPRESSION_ENABLED ? new MyCompressedAppendableFile() : null;
  if (myCompressedAppendableFile != null) {
    mySize=myCompressedAppendableFile.length();
  }
 else {
    mySize=myFile.length();
  }
  if (mySize == 0 && !myReadOnly) {
    appendBytes(new ByteSequence("Header Record For PersistentHashMapValueStorage".getBytes()),0);
    FileAccessorCache.Handle<DataOutputStream> streamCacheValue=ourAppendersCache.getIfCached(myPath);
    if (streamCacheValue != null) {
      try {
        IOUtil.syncStream(streamCacheValue.get());
      }
 catch (      IOException e) {
        throw new RuntimeException(e);
      }
 finally {
        streamCacheValue.release();
      }
    }
    long currentLength=myFile.length();
    if (currentLength > mySize) {
      Logger.getInstance(getClass().getName()).info("Avoided PSHM corruption due to write failure");
      mySize=currentLength;
    }
  }
}
