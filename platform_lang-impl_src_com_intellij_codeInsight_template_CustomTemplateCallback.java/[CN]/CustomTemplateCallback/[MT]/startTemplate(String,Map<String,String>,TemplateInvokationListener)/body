{
  int caretOffset=myEditor.getCaretModel().getOffset();
  List<TemplateImpl> templates=getMatchingTemplates(key);
  templates=TemplateManagerImpl.filterApplicableCandidates(myFile,caretOffset,templates);
  if (templates.size() > 0) {
    TemplateImpl template=templates.get(0);
    return startTemplate(template,predefinedVarValues,listener);
  }
 else   if (listener != null) {
    listener.finished(false,false);
  }
  return true;
}
