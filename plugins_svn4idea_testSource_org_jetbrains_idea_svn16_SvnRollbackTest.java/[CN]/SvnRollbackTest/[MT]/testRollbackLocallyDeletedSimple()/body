{
  final SubTree tree=new SubTree(myWorkingCopyDir);
  checkin();
  disableSilentOperation(VcsConfiguration.StandardConfirmation.REMOVE);
  final File wasFile=new File(tree.myS1File.getPath());
  deleteFileInCommand(myProject,tree.myS1File);
  myDirtyScopeManager.markEverythingDirty();
  myChangeListManager.ensureUpToDate(false);
  final List<LocallyDeletedChange> deletedFiles=((ChangeListManagerImpl)myChangeListManager).getDeletedFiles();
  Assert.assertNotNull(deletedFiles);
  Assert.assertTrue(deletedFiles.size() == 1);
  Assert.assertEquals(wasFile,deletedFiles.get(0).getPath().getIOFile());
  rollbackLocallyDeleted(Collections.singletonList(deletedFiles.get(0).getPath()),Collections.<FilePath>emptyList());
}
