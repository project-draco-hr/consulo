{
  final SubTree tree=new SubTree(myWorkingCopyDir);
  checkin();
  final VirtualFile newDir=createDirInCommand(tree.mySourceDir,"newDir");
  final VirtualFile inNewDir=createFileInCommand(newDir,"f.txt","12345");
  final VirtualFile inSource=createFileInCommand(tree.myTargetDir,"newF.txt","54321");
  Assert.assertTrue(newDir != null && inNewDir != null && inSource != null);
  myDirtyScopeManager.markEverythingDirty();
  myChangeListManager.ensureUpToDate(false);
  final Change change=assertCreatedChange(newDir);
  final Change inNewDirChange=assertCreatedChange(inNewDir);
  final Change inSourceChange=assertCreatedChange(inSource);
  rollbackIMpl(Arrays.asList(change,inSourceChange),Collections.<Change>emptyList());
}
