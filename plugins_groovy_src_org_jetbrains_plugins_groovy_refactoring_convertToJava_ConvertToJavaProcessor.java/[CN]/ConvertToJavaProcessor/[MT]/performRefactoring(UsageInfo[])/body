{
  final GroovyToJavaGenerator generator=new GroovyToJavaGenerator(myProject,Collections.<VirtualFile>emptyList(),true);
  final PsiFileFactory fileFactory=PsiFileFactory.getInstance(myProject);
  PsiFile fileToOpen=null;
  for (  GroovyFile file : myFiles) {
    final PsiDirectory dir=file.getContainingDirectory();
    LOG.assertTrue(dir != null);
    final Map<String,String> fileMap=generator.generateStubs(file);
    for (    String fileName : fileMap.keySet()) {
      file.delete();
      final PsiFile[] files=dir.getFiles();
      Set<String> fileNames=new HashSet<String>();
      for (      PsiFile psiFile : files) {
        fileNames.add(psiFile.getName());
      }
      int index=0;
      String prefix=FileUtil.getNameWithoutExtension(fileName);
      while (fileNames.contains(fileName)) {
        fileName=prefix + index + ".java";
      }
      final PsiFile newFile=fileFactory.createFileFromText(fileName,fileMap.get(fileName));
      dir.add(newFile);
    }
  }
}
