{
  if (location == null) {
    return null;
  }
  final ReferenceType refType=location.declaringType();
  if (refType == null) {
    return null;
  }
  final String originalQName=refType.name();
  int dollar=originalQName.indexOf('$');
  final String qName=dollar >= 0 ? originalQName.substring(0,dollar) : originalQName;
  final GlobalSearchScope searchScope=myDebugProcess.getSearchScope();
  PsiClass psiClass=DebuggerUtils.findClass(qName,project,searchScope);
  if (psiClass == null && dollar >= 0) {
    psiClass=DebuggerUtils.findClass(originalQName,project,searchScope);
  }
  if (psiClass != null) {
    final PsiElement element=psiClass.getNavigationElement();
    return element.getContainingFile();
  }
  return null;
}
