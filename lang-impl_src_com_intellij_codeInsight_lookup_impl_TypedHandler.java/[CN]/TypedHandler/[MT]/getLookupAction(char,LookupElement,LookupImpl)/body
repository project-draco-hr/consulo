{
  if (currentItem != null && charTyped != ' ') {
    final PrefixMatcher matcher=currentItem.getPrefixMatcher();
    if (matcher.cloneWithPrefix(matcher.getPrefix() + charTyped).prefixMatches(currentItem)) {
      return CharFilter.Result.ADD_TO_PREFIX;
    }
  }
  final CharFilter[] filters=Extensions.getExtensions(CharFilter.EP_NAME);
  for (  final CharFilter extension : filters) {
    final CharFilter.Result result=extension.acceptChar(charTyped,lookup.getMinPrefixLength() + lookup.getAdditionalPrefix().length(),lookup);
    if (result != null) {
      return result;
    }
  }
  throw new AssertionError("c=" + charTyped + "; prefix="+ currentItem+ "; filters="+ Arrays.toString(filters));
}
