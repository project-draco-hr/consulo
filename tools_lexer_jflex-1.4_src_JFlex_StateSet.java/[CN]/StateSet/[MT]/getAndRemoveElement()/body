{
  int i=0;
  int o=0;
  long m=1;
  while (bits[i] == 0)   i++;
  while ((bits[i] & m) == 0) {
    m<<=1;
    o++;
  }
  bits[i]&=~m;
  return (i << BITS) + o;
}
