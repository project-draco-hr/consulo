{
  initTree();
  JPanel panel=new MavenProjectsNavigatorPanel(myProject,myTree);
  ToolWindowManagerEx manager=ToolWindowManagerEx.getInstanceEx(myProject);
  myToolWindow=manager.registerToolWindow(TOOL_WINDOW_ID,panel,ToolWindowAnchor.RIGHT,myProject,true);
  myToolWindow.setIcon(MavenIcons.MAVEN_ICON);
  manager.addToolWindowManagerListener(new ToolWindowManagerAdapter(){
    boolean wasVisible=false;
    @Override public void stateChanged(){
      if (myToolWindow.isDisposed())       return;
      boolean visible=myToolWindow.isVisible();
      if (!visible || visible == wasVisible)       return;
      scheduleStructureUpdate();
      wasVisible=visible;
    }
  }
);
}
