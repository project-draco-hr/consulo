{
  InjectedLanguage prevLanguage=host.getUserData(LanguageInjectionSupport.TEMPORARY_INJECTED_LANGUAGE);
  SmartPointerManager manager=SmartPointerManager.getInstance(myProject);
  SmartPsiElementPointer<PsiLanguageInjectionHost> pointer=manager.createSmartPsiElementPointer(host);
  TempPlace prevPlace=new TempPlace(prevLanguage,pointer);
  TempPlace place=new TempPlace(language,pointer);
  Configuration.replaceInjectionsWithUndo(myProject,place,prevPlace,Collections.<PsiElement>emptyList(),new PairProcessor<TempPlace,TempPlace>(){
    public boolean process(    TempPlace add,    final TempPlace remove){
      addInjectionPlace(add);
      return true;
    }
  }
);
}
