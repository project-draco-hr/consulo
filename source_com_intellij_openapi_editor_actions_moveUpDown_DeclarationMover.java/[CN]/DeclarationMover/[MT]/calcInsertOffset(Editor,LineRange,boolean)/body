{
  PsiElement sibling=isDown ? range.lastElement.getNextSibling() : range.firstElement.getPrevSibling();
  if (sibling == null)   return null;
  final boolean areWeMovingClass=range.firstElement instanceof PsiClass;
  sibling=firstNonWhiteElement(sibling,isDown);
  int offset=moveInsideOutsideClassOffset(editor,sibling,isDown,areWeMovingClass);
  if (offset == -1)   return InsertionInfo.ILLEGAL_INFO;
  if (offset != 0)   return new InsertionInfo(range,offset);
  if (isDown) {
    sibling=sibling.getNextSibling();
    if (sibling == null)     return null;
    sibling=firstNonWhiteElement(sibling,isDown);
    if (sibling == null)     return null;
  }
  return new InsertionInfo(range,sibling.getTextRange().getStartOffset());
}
