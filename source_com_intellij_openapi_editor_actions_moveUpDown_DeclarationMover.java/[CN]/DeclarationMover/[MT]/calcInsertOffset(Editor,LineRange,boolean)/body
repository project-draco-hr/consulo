{
  PsiElement sibling=isDown ? range.lastElement.getNextSibling() : range.firstElement.getPrevSibling();
  if (sibling == null)   return -1;
  final boolean areWeMovingClass=range.firstElement instanceof PsiClass;
  sibling=firstNonWhiteElement(sibling,isDown);
  int offset=moveInsideOutsideClassOffset(editor,sibling,isDown,areWeMovingClass);
  if (offset != 0)   return offset;
  if (isDown) {
    sibling=sibling.getNextSibling();
    if (sibling == null)     return -1;
    sibling=firstNonWhiteElement(sibling,isDown);
    if (sibling == null)     return -1;
  }
  return sibling.getTextRange().getStartOffset();
}
