{
  ChangeListManager.getInstance(myProject).addChangeListListener(myListener);
  Disposer.register(myProject,new Disposable(){
    public void dispose(){
      ChangeListManager.getInstance(myProject).removeChangeListListener(myListener);
    }
  }
);
  if (ApplicationManager.getApplication().isHeadlessEnvironment())   return;
  final Content content=ContentFactory.SERVICE.getInstance().createContent(createChangeViewComponent(),"Local",false);
  content.setCloseable(false);
  myContentManager.addContent(content);
  scheduleRefresh();
  final MessageBusConnection connection=myProject.getMessageBus().connect(myProject);
  connection.subscribe(RemoteRevisionsCache.REMOTE_VERSION_CHANGED,new Runnable(){
    public void run(){
      ApplicationManager.getApplication().invokeLater(new Runnable(){
        public void run(){
          refreshView();
        }
      }
,ModalityState.NON_MODAL,myProject.getDisposed());
    }
  }
);
}
