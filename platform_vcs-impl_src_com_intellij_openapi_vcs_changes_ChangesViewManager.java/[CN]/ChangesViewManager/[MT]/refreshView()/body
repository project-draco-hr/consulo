{
  if (myDisposed || !myProject.isInitialized() || ApplicationManager.getApplication().isUnitTestMode())   return;
  if (!ProjectLevelVcsManager.getInstance(myProject).hasActiveVcss())   return;
  ChangeListManagerImpl changeListManager=ChangeListManagerImpl.getInstanceImpl(myProject);
  TreeModelBuilder treeModelBuilder=new TreeModelBuilder(myProject,myView.isShowFlatten()).set(changeListManager.getChangeListsCopy(),changeListManager.getDeletedFiles(),changeListManager.getModifiedWithoutEditing(),changeListManager.getSwitchedFilesMap(),changeListManager.getSwitchedRoots(),changeListManager.getLockedFolders(),changeListManager.getLogicallyLockedFolders()).setUnversioned(changeListManager.getUnversionedFiles(),changeListManager.getUnversionedFilesSize());
  if (myState.myShowIgnored) {
    treeModelBuilder.setIgnored(changeListManager.getIgnoredFiles(),changeListManager.getIgnoredFilesSize(),changeListManager.isIgnoredInUpdateMode());
  }
  myView.updateModel(treeModelBuilder.build());
  changeDetails();
}
