{
  try {
    if (classMember instanceof FieldInfo) {
      final FieldInfo fieldInfo=(FieldInfo)classMember;
      if (memberId == UNKNOWN) {
synchronized (myViewPool.getFieldDeclarationsLock()) {
          memberId=myViewPool.getFieldDeclarationView(memberId).getRecordId();
        }
synchronized (myViewPool.getClassDeclarationsLock()) {
          myViewPool.getClassDeclarationView(classDeclarationId).addFieldId(memberId,fieldInfo.getName(),fieldInfo.getDescriptor());
        }
      }
synchronized (myViewPool.getFieldDeclarationsLock()) {
        final FieldDeclarationView view=myViewPool.getFieldDeclarationView(memberId);
        view.setName(fieldInfo.getName());
        view.setDescriptor(fieldInfo.getDescriptor());
        view.setGenericSignature(fieldInfo.getGenericSignature());
        view.setFlags(fieldInfo.getFlags());
        view.setConstantValue(fieldInfo.getConstantValue());
        view.setRuntimeVisibleAnnotations(fieldInfo.getRuntimeVisibleAnnotations());
        view.setRuntimeInvisibleAnnotations(fieldInfo.getRuntimeInvisibleAnnotations());
      }
    }
 else     if (classMember instanceof MethodInfo) {
      final MethodInfo methodInfo=(MethodInfo)classMember;
      if (memberId == UNKNOWN) {
synchronized (myViewPool.getMethodDeclarationsLock()) {
          memberId=myViewPool.getMethodDeclarationView(memberId).getRecordId();
        }
synchronized (myViewPool.getClassDeclarationsLock()) {
          myViewPool.getClassDeclarationView(classDeclarationId).addMethodId(memberId,methodInfo.getName(),methodInfo.getDescriptor());
        }
      }
synchronized (myViewPool.getMethodDeclarationsLock()) {
        final MethodDeclarationView view=myViewPool.getMethodDeclarationView(memberId);
        view.setName(methodInfo.getName());
        view.setDescriptor(methodInfo.getDescriptor());
        view.setGenericSignature(methodInfo.getGenericSignature());
        view.setFlags(methodInfo.getFlags());
        view.setIsConstructor(methodInfo.isConstructor());
        view.setThrownExceptions(methodInfo.getThrownExceptions());
        view.setRuntimeVisibleAnnotations(methodInfo.getRuntimeVisibleAnnotations());
        view.setRuntimeInvisibleAnnotations(methodInfo.getRuntimeInvisibleAnnotations());
        view.setRuntimeVisibleParamAnnotations(methodInfo.getRuntimeVisibleParameterAnnotations());
        view.setRuntimeInvisibleParamAnnotations(methodInfo.getRuntimeInvisibleParameterAnnotations());
        view.setAnnotationDefault(methodInfo.getAnnotationDefault());
      }
    }
 else {
      LOG.assertTrue(false,"Unknown member info: " + classMember.getClass().getName());
    }
  }
 catch (  Throwable e) {
    throw new CacheCorruptedException(e);
  }
  return memberId;
}
