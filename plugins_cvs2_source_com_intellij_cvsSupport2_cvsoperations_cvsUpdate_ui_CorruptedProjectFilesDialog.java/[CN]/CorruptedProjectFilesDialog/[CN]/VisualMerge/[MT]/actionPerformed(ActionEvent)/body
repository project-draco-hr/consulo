{
  try {
    VirtualFile currentVirtualFile=getCurrentVirtualFile();
    final Map<VirtualFile,List<String>> fileToRevisions=new com.intellij.util.containers.HashMap<VirtualFile,List<String>>();
    fileToRevisions.put(currentVirtualFile,CvsUtil.getAllRevisionsForFile(currentVirtualFile));
    CvsMergeAction internalMergeAction=new CvsMergeAction(currentVirtualFile,myProject,fileToRevisions,new AbstractMergeAction.FileValueHolder());
    Document conflictWasResolved=internalMergeAction.showMergeDialogForFile(null);
    if (conflictWasResolved != null) {
      saveExternally(currentVirtualFile,conflictWasResolved);
      onCurrentFileProcessed(false);
    }
  }
 catch (  VcsException e1) {
    AbstractVcsHelper.getInstance(myProject).showErrors(new ArrayList<VcsException>(Collections.singleton(e1)),"Merge errors");
  }
}
