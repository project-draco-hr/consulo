{
  try {
    try {
      VirtualFile currentVirtualFile=getCurrentVirtualFile();
      CvsMergeAction internalMergeAction=new CvsMergeAction(currentVirtualFile,myProject,null);
      Document conflictWasResolved=internalMergeAction.showMergeDialogForFile(new String(currentVirtualFile.contentsToCharArray()),null);
      if (conflictWasResolved != null) {
        saveExternally(currentVirtualFile,conflictWasResolved);
        onCurrentFileProcessed(false);
      }
    }
 catch (    IOException e1) {
      throw new VcsException(e1);
    }
  }
 catch (  VcsException e1) {
    AbstractVcsHelper.getInstance(myProject).showErrors(new ArrayList<VcsException>(Collections.singleton(e1)),"Merge errors");
  }
}
