{
  MavenWorkspaceSettings settings=project.getComponent(MavenWorkspaceSettingsComponent.class).getState();
  settings.generalSettings=getGeneralSettings();
  settings.importingSettings=getImportingSettings();
  MavenProjectsManager manager=MavenProjectsManager.getInstance(project);
  List<VirtualFile> files=getParameters().myMavenProjectTree.getRootProjectsFiles();
  manager.addManagedFilesWithProfiles(files,getSelectedProfiles());
  manager.waitForReadingCompletion();
  boolean isFromUI=model != null;
  return manager.importProjects(isFromUI ? new MavenUIModifiableModelsProvider(project,model,(ModulesConfigurator)modulesProvider,artifactModel) : new MavenDefaultModifiableModelsProvider(project));
}
