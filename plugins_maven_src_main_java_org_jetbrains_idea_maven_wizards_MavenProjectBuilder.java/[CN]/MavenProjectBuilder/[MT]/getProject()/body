{
  AccessToken accessToken=ApplicationManager.getApplication().acquireReadActionLock();
  try {
    Project result=isUpdate() ? getProjectToUpdate() : null;
    if (result == null || result.isDisposed())     result=ProjectManager.getInstance().getDefaultProject();
    return result;
  }
  finally {
    accessToken.finish();
  }
}
