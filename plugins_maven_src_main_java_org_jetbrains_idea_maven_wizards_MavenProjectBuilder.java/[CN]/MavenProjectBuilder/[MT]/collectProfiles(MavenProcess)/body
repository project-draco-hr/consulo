{
  getParameters().myProfiles=new ArrayList<String>();
  MavenEmbedderWrapper e=MavenEmbedderFactory.createEmbedderForRead(getGeneralSettings(),new SoutMavenConsole(),process);
  try {
    for (    VirtualFile f : getParameters().myFiles) {
      MavenProjectState state=MavenReader.readProject(e,f,new ArrayList<String>(),process).first;
      if (!state.isValid())       continue;
      Set<String> profiles=new LinkedHashSet<String>(state.getProfilesIds());
      if (!profiles.isEmpty())       getParameters().myProfiles.addAll(profiles);
    }
  }
 catch (  MavenProcessCanceledException ignore) {
  }
 finally {
    e.release();
  }
}
