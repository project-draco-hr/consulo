{
  Set<String> uniqueProfiles=new LinkedHashSet<String>();
  MavenEmbedderWrapper embedder=getEmbeddersManager().getEmbedder();
  try {
    for (    VirtualFile f : getParameters().myFiles) {
      MavenProject project=new MavenProject(f);
      project.read(embedder,Collections.EMPTY_LIST,process);
      uniqueProfiles.addAll(project.getProfilesIds());
    }
    getParameters().myProfiles=new ArrayList<String>(uniqueProfiles);
  }
 catch (  MavenProcessCanceledException ignore) {
  }
 finally {
    getEmbeddersManager().release(embedder);
  }
}
