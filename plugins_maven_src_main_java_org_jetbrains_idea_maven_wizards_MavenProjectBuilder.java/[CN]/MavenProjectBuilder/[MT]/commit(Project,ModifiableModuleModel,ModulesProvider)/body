{
  project.getComponent(MavenWorkspaceSettingsComponent.class).getState().myImporterSettings=getImporterPreferences();
  project.getComponent(MavenWorkspaceSettingsComponent.class).getState().myArtifactSettings=getArtifactPreferences();
  project.getComponent(MavenCore.class).loadState(myCoreSettings);
  MavenProjectsManager manager=MavenProjectsManager.getInstance(project);
  manager.setManagedFiles(myFiles);
  manager.setActiveProfiles(mySelectedProfiles);
  manager.setImportedMavenProjectModelManager(myMavenProjectTree);
  final List<Module> moduleList=manager.commit(model,modulesProvider);
  enusreRepositoryPathMacro();
  return moduleList;
}
