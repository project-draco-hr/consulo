{
  getParameters().myFiles=null;
  getParameters().myProfiles.clear();
  getParameters().myMavenProjectTree=null;
  getParameters().myProjectToUpdate=projectToUpdate;
  return runConfigurationProcess(ProjectBundle.message("maven.scanning.projects"),new MavenTask(){
    public void run(    MavenProgressIndicator indicator) throws MavenProcessCanceledException {
      indicator.setText(ProjectBundle.message("maven.locating.files"));
      getParameters().myImportRoot=LocalFileSystem.getInstance().refreshAndFindFileByPath(root);
      if (getParameters().myImportRoot == null)       throw new MavenProcessCanceledException();
      final VirtualFile file=getRootDirectory();
      if (file == null)       throw new MavenProcessCanceledException();
      getParameters().myFiles=FileFinder.findPomFiles(file.getChildren(),getImportingSettings().isLookForNested(),indicator,new ArrayList<VirtualFile>());
      collectProfiles(indicator);
      if (getParameters().myProfiles.isEmpty()) {
        readMavenProjectTree(indicator);
      }
      indicator.setText("");
      indicator.setText2("");
    }
  }
);
}
