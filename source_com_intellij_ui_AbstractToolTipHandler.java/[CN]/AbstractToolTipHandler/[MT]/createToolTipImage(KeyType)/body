{
  if (key == null) {
    throw new IllegalArgumentException("key cannot be null");
  }
  Component rComponent;
  rComponent=getRendererComponent(key);
  if (!(rComponent instanceof JComponent)) {
    return null;
  }
  Rectangle cellBounds=getCellBounds(key,rComponent);
  if (cellBounds == null)   return null;
  Point cellLocation=cellBounds.getLocation();
  Rectangle visibleRect=getVisibleRect(key);
  int height=cellBounds.height;
  if (visibleRect.contains(cellLocation.x + cellBounds.width,cellLocation.y + height))   return null;
  Point visibleRightTop=new Point(visibleRect.x + visibleRect.width,cellLocation.y);
  int rightLimit=cellLocation.x + cellBounds.width;
  int width=rightLimit - visibleRightTop.x;
  if (width <= 0 || height <= 0)   return null;
  myImage=new BufferedImage(width,height,BufferedImage.TYPE_INT_RGB);
  Graphics2D g=myImage.createGraphics();
  g.setClip(null);
  g.setColor(myComponent.getBackground());
  g.fillRect(0,0,width,height);
  g.translate(-(visibleRect.x + visibleRect.width - cellLocation.x),0);
  myRendererPane.paintComponent(g,rComponent,myComponent,0,0,cellBounds.width,height,true);
  g.translate((visibleRect.x + visibleRect.width - cellLocation.x),0);
  g.setColor(Color.black);
  int rightX=myImage.getWidth() - 1;
  g.drawLine(0,0,rightX,0);
  g.drawLine(rightX,0,rightX,height);
  g.drawLine(0,height - 1,rightX,height - 1);
  g.dispose();
  myComponent.remove(rComponent);
  return visibleRightTop;
}
