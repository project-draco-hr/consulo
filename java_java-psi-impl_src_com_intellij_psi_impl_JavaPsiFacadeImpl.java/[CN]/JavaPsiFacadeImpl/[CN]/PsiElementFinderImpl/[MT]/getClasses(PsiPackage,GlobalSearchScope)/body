{
  List<PsiClass> list=null;
  String packageName=psiPackage.getQualifiedName();
  for (  PsiDirectory dir : psiPackage.getDirectories(scope)) {
    PsiClass[] classes=JavaDirectoryService.getInstance().getClasses(dir);
    if (classes.length == 0)     continue;
    if (list == null)     list=new ArrayList<PsiClass>();
    for (    PsiClass aClass : classes) {
      String qualifiedName=aClass.getQualifiedName();
      if (qualifiedName != null)       qualifiedName=StringUtil.getPackageName(qualifiedName);
      if (Comparing.strEqual(qualifiedName,packageName)) {
        list.add(aClass);
      }
    }
  }
  if (list == null) {
    return PsiClass.EMPTY_ARRAY;
  }
  ContainerUtil.quickSort(list,new Comparator<PsiClass>(){
    @Override public int compare(    PsiClass o1,    PsiClass o2){
      return scope.compare(o2.getContainingFile().getVirtualFile(),o1.getContainingFile().getVirtualFile());
    }
  }
);
  return list.toArray(new PsiClass[list.size()]);
}
