{
  final Change[] first={null};
  final Change[] last={null};
  LocalHistoryFacade.Listener l=new LocalHistoryFacade.Listener(){
    public void changeAdded(    Change c){
      if (first[0] == null)       first[0]=c;
      last[0]=c;
    }
  }
;
  myVcs.addListener(l,null);
  try {
    myVcs.accept(new ChangeRevertingVisitor(myGateway,myToChange,myFromChange));
  }
 catch (  ChangeRevertingVisitor.RuntimeIOException e) {
    throw (IOException)e.getCause();
  }
 finally {
    myVcs.removeListener(l);
  }
  if (reverse != null) {
    if (first[0] == null)     first[0]=reverse.myFromChange;
    if (last[0] == null)     last[0]=reverse.myToChange;
  }
  return new ChangeRange(myGateway,myVcs,first[0],last[0]);
}
