def addfile(self, name, mode, islink, data):
    i = tarfile.TarInfo((self.prefix + name))
    i.mtime = self.mtime
    i.size = len(data)
    if islink:
        i.type = tarfile.SYMTYPE
        i.mode = 511
        i.linkname = data
        data = None
        i.size = 0
    else:
        i.mode = mode
        data = cStringIO.StringIO(data)
    self.z.addfile(i, data)
