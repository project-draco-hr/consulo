def addfile(self, name, mode, islink, data):
    i = zipfile.ZipInfo((self.prefix + name), self.date_time)
    i.compress_type = self.z.compression
    i.create_system = 3
    ftype = stat.S_IFREG
    if islink:
        mode = 511
        ftype = stat.S_IFLNK
    i.external_attr = ((mode | ftype) << 16L)
    self.z.writestr(i, data)
