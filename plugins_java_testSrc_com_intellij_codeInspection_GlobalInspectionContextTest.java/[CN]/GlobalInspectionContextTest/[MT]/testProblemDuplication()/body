{
  String shortName=new VisibilityInspection().getShortName();
  InspectionProfileImpl profile=new InspectionProfileImpl("Foo");
  profile.disableAllTools();
  profile.enableTool(shortName);
  GlobalInspectionContextImpl context=((InspectionManagerEx)InspectionManager.getInstance(getProject())).createNewGlobalContext(false);
  context.setExternalProfile(profile);
  configureByFile("Foo.java");
  AnalysisScope scope=new AnalysisScope(getFile());
  context.doInspections(scope,InspectionManager.getInstance(getProject()));
  Tools tools=context.getTools().get(shortName);
  GlobalInspectionToolWrapper tool=(GlobalInspectionToolWrapper)tools.getTool();
  assertEquals(1,tool.getProblemDescriptors().size());
  context.doInspections(scope,InspectionManager.getInstance(getProject()));
  tools=context.getTools().get(shortName);
  tool=(GlobalInspectionToolWrapper)tools.getTool();
  assertEquals(1,tool.getProblemDescriptors().size());
}
