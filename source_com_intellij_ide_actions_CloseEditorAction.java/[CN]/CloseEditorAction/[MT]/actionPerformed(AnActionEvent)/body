{
  final DataContext dataContext=e.getDataContext();
  final Project project=(Project)dataContext.getData(DataConstants.PROJECT);
  CommandProcessor.getInstance().executeCommand(project,new Runnable(){
    public void run(){
      EditorWindow window=(EditorWindow)dataContext.getData(DataConstantsEx.EDITOR_WINDOW);
      if (window != null) {
        final VirtualFile vFile=(VirtualFile)dataContext.getData(DataConstants.VIRTUAL_FILE);
        closeFileInWindow(vFile,window);
      }
 else {
        final FileEditorManagerEx fileEditorManager=((FileEditorManagerEx)FileEditorManager.getInstance(project));
        window=fileEditorManager.getCurrentWindow();
        if (window != null) {
          final VirtualFile vFile=window.getSelectedFile();
          closeFileInWindow(vFile,window);
        }
      }
    }
  }
,IdeBundle.message("command.close.active.editor"),null);
}
