{
  if (myIndices != null)   return;
  myIndexer=MavenFacadeManager.getInstance().createIndexer();
  myDownloadListener=new MavenFacadeDownloadListener(){
    public void artifactDownloaded(    File file,    String relativePath) throws RemoteException {
      addArtifact(file,relativePath);
    }
  }
;
  MavenFacadeManager.getInstance().addDownloadListener(myDownloadListener);
  myIndices=new MavenIndices(myIndexer,getIndicesDir(),new MavenIndex.IndexListener(){
    public void indexIsBroken(    MavenIndex index){
      scheduleUpdate(null,Collections.singletonList(index),false);
    }
  }
);
  Disposer.register(ApplicationManager.getApplication(),new Disposable(){
    public void dispose(){
      doShutdown();
    }
  }
);
  loadUserArchetypes();
}
