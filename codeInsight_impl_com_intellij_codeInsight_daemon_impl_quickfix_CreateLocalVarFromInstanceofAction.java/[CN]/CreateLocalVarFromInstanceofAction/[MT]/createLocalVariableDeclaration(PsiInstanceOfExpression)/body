{
  PsiElementFactory factory=JavaPsiFacade.getInstance(instanceOfExpression.getProject()).getElementFactory();
  PsiTypeCastExpression cast=(PsiTypeCastExpression)factory.createExpressionFromText("(a)b",instanceOfExpression);
  PsiType castType=instanceOfExpression.getCheckType().getType();
  cast.getCastType().replace(factory.createTypeElement(castType));
  cast.getOperand().replace(instanceOfExpression.getOperand());
  PsiDeclarationStatement decl=factory.createVariableDeclarationStatement("xxx",castType,cast);
  PsiDeclarationStatement element=insertAtAnchor(instanceOfExpression,decl);
  return CodeInsightUtil.forcePsiPostprocessAndRestoreElement(element);
}
