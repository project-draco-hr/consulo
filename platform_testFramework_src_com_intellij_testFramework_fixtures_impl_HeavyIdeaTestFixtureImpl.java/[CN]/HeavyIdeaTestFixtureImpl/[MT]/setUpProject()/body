{
  File projectFile=File.createTempFile(PROJECT_FILE_PREFIX,PROJECT_FILE_SUFFIX);
  myFilesToDelete.add(projectFile);
  LocalFileSystem.getInstance().refreshAndFindFileByIoFile(projectFile);
  ByteArrayOutputStream buffer=new ByteArrayOutputStream();
  new Throwable(projectFile.getPath()).printStackTrace(new PrintStream(buffer));
  myProject=PlatformTestCase.createProject(projectFile,buffer.toString());
  for (  ModuleFixtureBuilder moduleFixtureBuilder : myModuleFixtureBuilders) {
    moduleFixtureBuilder.getFixture().setUp();
  }
  StartupManagerImpl sm=(StartupManagerImpl)StartupManager.getInstance(myProject);
  sm.runStartupActivities();
  sm.runPostStartupActivities();
  ProjectManagerEx.getInstanceEx().setCurrentTestProject(myProject);
  ((PsiDocumentManagerImpl)PsiDocumentManager.getInstance(getProject())).clearUncommitedDocuments();
}
