{
  final Object object=element.getObject();
  if (!(object instanceof PsiMethod || object instanceof PsiVariable || object instanceof PsiExpression))   return Result.normal;
  if (myFilter != null && !myFilter.isAcceptable(object,myPosition)) {
    return Result.recursive;
  }
  if (isPassingObjectToItself(object)) {
    return Result.passingObjectToItself;
  }
  if (myExpression != null) {
    if (myExpectedInfos != null) {
      final PsiType itemType=JavaCompletionUtil.getLookupElementType(element);
      for (      final ExpectedTypeInfo expectedInfo : myExpectedInfos) {
        PsiMethod calledMethod=expectedInfo.getCalledMethod();
        if (calledMethod != null && itemType != null) {
          if (calledMethod.equals(myPositionMethod) && expectedInfo.getType().isAssignableFrom(itemType)) {
            return myDelegate ? Result.delegation : Result.recursive;
          }
          if (isGetterSetterAssignment(object,calledMethod)) {
            return myDelegate ? Result.delegation : Result.recursive;
          }
        }
      }
    }
    return Result.normal;
  }
  if (object instanceof PsiMethod && myPositionMethod != null) {
    final PsiMethod method=(PsiMethod)object;
    if (PsiTreeUtil.isAncestor(myReference,myPosition,false) && Comparing.equal(method.getName(),myPositionMethod.getName())) {
      if (!myDelegate && findDeepestSuper(method).equals(findDeepestSuper(myPositionMethod))) {
        return Result.recursive;
      }
      return Result.delegation;
    }
  }
  return Result.normal;
}
