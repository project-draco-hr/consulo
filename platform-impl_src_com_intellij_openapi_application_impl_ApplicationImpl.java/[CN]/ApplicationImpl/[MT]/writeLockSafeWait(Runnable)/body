{
  int locksHeld=0;
  while (myActionsLock.isWriteLockAcquired(Thread.currentThread())) {
    locksHeld++;
    myActionsLock.writeLock().release();
  }
  try {
    waitForImpl.run();
  }
  finally {
    while (locksHeld-- > 0) {
      try {
        myActionsLock.writeLock().acquire();
      }
 catch (      InterruptedException e) {
        LOG.error(e);
      }
    }
  }
}
