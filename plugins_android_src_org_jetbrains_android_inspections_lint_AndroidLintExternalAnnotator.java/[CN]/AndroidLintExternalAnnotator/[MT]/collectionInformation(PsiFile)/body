{
  final Module module=ModuleUtil.findModuleForPsiElement(file);
  if (module == null) {
    return null;
  }
  final AndroidFacet facet=AndroidFacet.getInstance(module);
  if (facet == null) {
    return null;
  }
  final VirtualFile vFile=file.getVirtualFile();
  if (vFile == null) {
    return null;
  }
  final FileType fileType=file.getFileType();
  if (fileType == StdFileTypes.XML) {
    if (facet.getLocalResourceManager().getFileResourceType(file) == null && AndroidRootUtil.getManifestFile(module) != vFile) {
      return null;
    }
  }
 else   if (fileType == FileTypes.PLAIN_TEXT) {
    if (!SdkConstants.FN_PROGUARD_CFG.equals(file.getName())) {
      return null;
    }
  }
 else   if (fileType != StdFileTypes.JAVA) {
    return null;
  }
  final List<Issue> issues=getIssuesFromInspections(file.getProject(),file);
  if (issues.size() == 0) {
    return null;
  }
  return new State(module,vFile,file.getText(),issues);
}
