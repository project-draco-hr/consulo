{
  if (state.isDirty()) {
    return;
  }
  for (  ProblemData problemData : state.getProblems()) {
    final Issue issue=problemData.getIssue();
    final String message=problemData.getMessage();
    final TextRange range=problemData.getTextRange();
    if (range.getStartOffset() == range.getEndOffset()) {
      continue;
    }
    final Pair<AndroidLintInspectionBase,HighlightDisplayLevel> pair=AndroidLintUtil.getHighlighLevelAndInspection(issue,file);
    if (pair == null) {
      continue;
    }
    final AndroidLintInspectionBase inspection=pair.getFirst();
    final HighlightDisplayLevel displayLevel=pair.getSecond();
    if (inspection != null) {
      final HighlightDisplayKey key=HighlightDisplayKey.find(inspection.getShortName());
      if (key != null) {
        final PsiElement startElement=file.findElementAt(range.getStartOffset());
        final PsiElement endElement=file.findElementAt(range.getEndOffset() - 1);
        if (startElement != null && endElement != null && !inspection.isSuppressedFor(startElement)) {
          final Annotation annotation=createAnnotation(holder,message,range,displayLevel);
          for (          AndroidLintQuickFix fix : inspection.getQuickFixes(message)) {
            if (fix.isApplicable(startElement,endElement,false)) {
              annotation.registerFix(new MyFixingIntention(fix,startElement,endElement));
            }
          }
          for (          IntentionAction intention : inspection.getIntentions(startElement,endElement)) {
            annotation.registerFix(intention);
          }
          annotation.registerFix(new MyDisableInspectionFix(key));
          annotation.registerFix(new MyEditInspectionToolsSettingsAction(key,inspection));
          final SuppressIntentionAction[] suppressActions=inspection.getSuppressActions(startElement);
          if (suppressActions != null) {
            for (            SuppressIntentionAction action : suppressActions) {
              annotation.registerFix(action);
            }
          }
        }
      }
    }
  }
}
