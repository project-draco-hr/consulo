{
  if (state.isDirty()) {
    return;
  }
  for (  ProblemData problemData : state.getProblems()) {
    final Issue issue=problemData.getIssue();
    final String message=problemData.getMessage();
    final TextRange range=problemData.getTextRange();
    if (range.getStartOffset() == range.getEndOffset()) {
      continue;
    }
    final Pair<AndroidLintInspectionBase,HighlightDisplayLevel> pair=getHighlighLevelAndInspection(issue,file);
    if (pair == null) {
      continue;
    }
    final AndroidLintInspectionBase inspection=pair.getFirst();
    final HighlightDisplayLevel displayLevel=pair.getSecond();
    final Annotation annotation=createAnnotation(holder,message,range,displayLevel);
    if (inspection != null) {
      final HighlightDisplayKey key=HighlightDisplayKey.find(inspection.getShortName());
      if (key != null) {
        annotation.registerFix(new MyDisableInspectionFix(key));
        annotation.registerFix(new CustomEditInspectionToolsSettingsAction(key,new Computable<String>(){
          @Override public String compute(){
            return "Edit '" + inspection.getDisplayName() + "' inspection settings";
          }
        }
));
      }
    }
  }
}
