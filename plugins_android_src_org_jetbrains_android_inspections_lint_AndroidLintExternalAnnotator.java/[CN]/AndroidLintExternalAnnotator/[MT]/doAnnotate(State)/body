{
  final IntellijLintClient client=new IntellijLintClient(state);
  try {
    final LintDriver lint=new LintDriver(new IssueRegistry(){
      @Override public List<Issue> getIssues(){
        return state.getIssues();
      }
    }
,client);
    lint.analyze(Collections.singletonList(new File(state.getMainFile().getPath())),null);
  }
  finally {
    Disposer.dispose(client);
  }
  return state;
}
