{
  r.lock();
  try {
    T value=getUpToDateOrNull(true);
    if (value != null) {
      return value == NULL ? null : value;
    }
  }
  finally {
    r.unlock();
  }
  CachedValueProvider.Result<T> result=doCompute(param);
  T computed=result == null ? null : result.getValue();
  w.lock();
  try {
    setValue(computed,result);
    return computed;
  }
  finally {
    w.unlock();
  }
}
