{
  if (ApplicationManager.getApplication().isUnitTestMode() || ApplicationManager.getApplication().isHeadlessEnvironment()) {
    doCheckRoots(rootsChanged);
    return;
  }
  ProgressManager.getInstance().run(new Task.Backgroundable(myProject,"Checking Git roots..."){
    public void run(    @NotNull ProgressIndicator indicator){
synchronized (myCheckRootsLock) {
        if (myProject.isDisposed())         return;
        doCheckRoots(rootsChanged);
      }
    }
  }
);
}
