{
  LOG.assertTrue(myInsideChange);
  HashMap<OrderRootType,VirtualFile[]> oldRoots=new HashMap<OrderRootType,VirtualFile[]>(myFiles);
  for (  OrderRootType orderRootType : OrderRootType.getAllTypes()) {
    final VirtualFile[] roots=myRoots.get(orderRootType).getVirtualFiles();
    final boolean same=Comparing.equal(roots,oldRoots.get(orderRootType));
    myFiles.put(orderRootType,myRoots.get(orderRootType).getVirtualFiles());
    if (!same) {
      fireRootsChanged();
    }
  }
  myInsideChange=false;
}
