{
  initNSDescriptorsMap();
  final PsiElement parent=getParent();
  if (myNSDescriptorsMap.isEmpty()) {
    return ((XmlTag)parent).getNSDescriptor(namespace,strict);
  }
  CachedValue<XmlNSDescriptor> descriptor=myNSDescriptorsMap.get(namespace);
  if (descriptor != null) {
    final XmlNSDescriptor value=descriptor.getValue();
    if (value != null)     return value;
  }
 else   if (parent instanceof XmlTag) {
    return ((XmlTag)parent).getNSDescriptor(namespace,strict);
  }
  if (!strict) {
    descriptor=myNSDescriptorsMap.get(XmlUtil.ALL_NAMESPACE);
  }
  return descriptor != null ? descriptor.getValue() : null;
}
