{
  if (myAttributes != null)   return myAttributes;
  myAttributeValueMap=new HashMap<String,String>();
  final List<XmlAttribute> result=new ArrayList<XmlAttribute>(10);
  processElements(new PsiBaseElementProcessor(){
    public boolean execute(    PsiElement element){
      if (element instanceof XmlAttribute) {
        XmlAttribute attribute=(XmlAttribute)element;
        result.add(attribute);
        cacheOneAttributeValue(attribute.getName(),attribute.getValue());
        myHaveNamespaceDeclarations=myHaveNamespaceDeclarations || attribute.isNamespaceDeclaration();
      }
 else       if (element instanceof XmlToken && ((XmlToken)element).getTokenType() == XmlTokenType.XML_TAG_END) {
        return false;
      }
      return true;
    }
  }
,this);
  if (result.isEmpty()) {
    myAttributeValueMap=Collections.EMPTY_MAP;
    myAttributes=XmlAttribute.EMPTY_ARRAY;
  }
 else {
    myAttributes=CollectionUtil.toArray(result,new XmlAttribute[result.size()]);
  }
  return myAttributes;
}
