{
  final List<XmlAttribute> result=new ArrayList<XmlAttribute>(10);
  processElements(new PsiElementProcessor(){
    public boolean execute(    PsiElement element){
      if (element instanceof XmlAttribute) {
        XmlAttribute attribute=(XmlAttribute)element;
        result.add(attribute);
        cacheOneAttributeValue(attribute.getName(),attribute.getValue());
        myHaveNamespaceDeclarations=myHaveNamespaceDeclarations || attribute.isNamespaceDeclaration();
      }
 else       if (element instanceof XmlToken && ((XmlToken)element).getTokenType() == XmlTokenType.XML_TAG_END) {
        return false;
      }
      return true;
    }
  }
,this);
  if (result.isEmpty()) {
    myAttributeValueMap=Collections.EMPTY_MAP;
    return XmlAttribute.EMPTY_ARRAY;
  }
 else {
    return CollectionUtil.toArray(result,new XmlAttribute[result.size()]);
  }
}
