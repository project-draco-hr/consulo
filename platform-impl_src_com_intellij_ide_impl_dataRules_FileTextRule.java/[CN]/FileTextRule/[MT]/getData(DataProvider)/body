{
  VirtualFile virtualFile=(VirtualFile)dataProvider.getData(DataConstants.VIRTUAL_FILE);
  if (virtualFile == null)   return null;
  final FileType fileType=virtualFile.getFileType();
  if (fileType.isBinary() || fileType.isReadOnly())   return null;
  Project project=(Project)dataProvider.getData(DataConstants.PROJECT);
  if (project == null)   return null;
  Document document=FileDocumentManager.getInstance().getDocument(virtualFile);
  if (document == null)   return null;
  return document.getText();
}
