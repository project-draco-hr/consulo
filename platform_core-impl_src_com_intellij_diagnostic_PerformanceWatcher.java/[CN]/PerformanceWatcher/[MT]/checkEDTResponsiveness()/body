{
  long intervalStart=System.currentTimeMillis();
  while (true) {
    long lastMillis=System.currentTimeMillis();
    try {
      if (myShutdownSemaphore.tryAcquire(SAMPLING_INTERVAL_MS,TimeUnit.MILLISECONDS)) {
        break;
      }
    }
 catch (    InterruptedException e) {
      break;
    }
    long millis=System.currentTimeMillis();
    long diff=millis - lastMillis - SAMPLING_INTERVAL_MS;
    while (diff >= 0) {
      myGeneralApdex=myGeneralApdex.withEvent(100,diff);
      diff-=SAMPLING_INTERVAL_MS;
    }
    if (millis - intervalStart >= UNRESPONSIVE_INTERVAL_SECONDS * 1000) {
      intervalStart=millis;
      if (mySwingThreadCounter != myLoopCounter) {
        edtFrozen();
      }
 else {
        edtResponds();
      }
    }
    myLoopCounter++;
    SwingUtilities.invokeLater(new SwingThreadRunnable(myLoopCounter));
  }
}
