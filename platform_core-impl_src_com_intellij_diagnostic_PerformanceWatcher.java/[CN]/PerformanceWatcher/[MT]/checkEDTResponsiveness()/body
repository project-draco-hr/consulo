{
  while (true) {
    try {
      if (myShutdownSemaphore.tryAcquire(UNRESPONSIVE_INTERVAL,TimeUnit.SECONDS)) {
        break;
      }
    }
 catch (    InterruptedException e) {
      break;
    }
    if (mySwingThreadCounter != myLoopCounter) {
      myUnresponsiveDuration+=UNRESPONSIVE_INTERVAL;
      if (myUnresponsiveDuration >= UNRESPONSIVE_THRESHOLD) {
        if (myCurHangLogDir == mySessionLogDir) {
          myCurHangLogDir=new File(mySessionLogDir,myDateFormat.format(new Date()));
        }
        dumpThreads(false);
      }
    }
 else {
      if (myUnresponsiveDuration >= UNRESPONSIVE_THRESHOLD) {
        if (myCurHangLogDir != mySessionLogDir && myCurHangLogDir.exists()) {
          myCurHangLogDir.renameTo(new File(mySessionLogDir,getLogDirForHang()));
        }
        myUnresponsiveDuration=0;
        myCurHangLogDir=mySessionLogDir;
        myStacktraceCommonPart=null;
      }
      myUnresponsiveDuration=0;
    }
    myLoopCounter++;
    SwingUtilities.invokeLater(new SwingThreadRunnable(myLoopCounter));
  }
}
