{
  final Project project=e.getData(PlatformDataKeys.PROJECT);
  final ShelvedChangeList[] changeLists=e.getData(ShelvedChangesViewManager.SHELVED_CHANGELIST_KEY);
  if (project == null || changeLists == null || changeLists.length != 1)   return;
  FileDocumentManager.getInstance().saveAllDocuments();
  final VirtualFile virtualFile=LocalFileSystem.getInstance().refreshAndFindFileByIoFile(new File(changeLists[0].PATH));
  if (virtualFile == null) {
    VcsBalloonProblemNotifier.showOverChangesView(project,"Can not find path file",MessageType.ERROR);
    return;
  }
  if (!changeLists[0].getBinaryFiles().isEmpty()) {
    VcsBalloonProblemNotifier.showOverChangesView(project,"Binary file(s) would be skipped.",MessageType.WARNING);
  }
  final ApplyPatchDifferentiatedDialog dialog=new ApplyPatchDifferentiatedDialog(project,new ApplyPatchDefaultExecutor(project),Collections.<ApplyPatchExecutor>emptyList(),ApplyPatchMode.UNSHELVE,virtualFile);
  dialog.show();
}
