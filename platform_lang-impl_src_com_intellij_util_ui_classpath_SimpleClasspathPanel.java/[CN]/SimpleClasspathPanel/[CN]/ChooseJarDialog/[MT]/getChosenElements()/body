{
  if (myLastChosen == null) {
    return Collections.emptyList();
  }
  final VirtualFile[] files=myLastChosen;
  if (files.length == 0) {
    return Collections.emptyList();
  }
  final List<Library> addedLibraries=new ArrayList<Library>(files.length);
  for (  VirtualFile file : files) {
    final Library library=LibraryTableImplUtil.createModuleLevelLibrary(null,null);
    Disposer.register(myParentDisposable,library);
    final Library.ModifiableModel libModel=library.getModifiableModel();
    libModel.addRoot(file,OrderRootType.CLASSES);
    libModel.commit();
    addedLibraries.add(library);
  }
  return addedLibraries;
}
