{
  UndoManagerImpl undoManager=getUndoManager();
  final DocumentReference ref=DocumentReferenceByDocument.createDocumentReference(document);
  if (!undoManager.documentWasChanged(ref))   return;
  undoManager.undoableActionPerformed(new NonUndoableAction(){
    public DocumentReference[] getAffectedDocuments(){
      return new DocumentReference[]{ref};
    }
    public boolean isComplex(){
      return false;
    }
  }
);
}
