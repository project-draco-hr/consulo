{
  CompositeElement clone=(CompositeElement)super.clone();
synchronized (PsiLock.LOCK) {
    clone.clearCaches();
    clone.parent=null;
    clone.prev=null;
    clone.firstChild=null;
    clone.lastChild=null;
    clone.myModificationsCount=0;
    clone.myParentModifications=-1;
    clone.myWrapper=null;
    for (ASTNode child=getFirstChildNode(); child != null; child=child.getTreeNext()) {
      TreeUtil.addChildren(clone,(TreeElement)child.clone());
    }
  }
  return clone;
}
