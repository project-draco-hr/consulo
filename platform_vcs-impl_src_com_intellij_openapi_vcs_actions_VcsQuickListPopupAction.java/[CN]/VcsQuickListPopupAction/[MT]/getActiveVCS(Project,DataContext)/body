{
  final AbstractVcs[] activeVcss=getActiveVCSs(project);
  if (activeVcss.length == 0) {
    return new Pair<SupportedVCS,AbstractVcs>(SupportedVCS.NOT_IN_VCS,null);
  }
 else   if (activeVcss.length == 1) {
    return new Pair<SupportedVCS,AbstractVcs>(SupportedVCS.VCS,activeVcss[0]);
  }
  final VirtualFile file=dataContext != null ? LangDataKeys.VIRTUAL_FILE.getData(dataContext) : null;
  if (file != null) {
    final AbstractVcs vscForFile=ProjectLevelVcsManager.getInstance(project).getVcsFor(file);
    if (vscForFile != null) {
      return new Pair<SupportedVCS,AbstractVcs>(SupportedVCS.VCS,vscForFile);
    }
  }
  return new Pair<SupportedVCS,AbstractVcs>(SupportedVCS.VCS,null);
}
