{
  final EditorHighlighter highlighter=((EditorEx)editor).getHighlighter();
  HighlighterIterator iteratorLeft=highlighter.createIterator(caret - 1);
  HighlighterIterator iteratorRight=highlighter.createIterator(caret);
  if (iteratorLeft != null && !(ALL_STRINGS.contains(iteratorLeft.getTokenType()))) {
    return false;
  }
  if (iteratorLeft != null && BEFORE_DOLLAR.contains(iteratorLeft.getTokenType()) && iteratorRight != null && !AFTER_DOLLAR.contains(iteratorRight.getTokenType())) {
    return false;
  }
  if (iteratorLeft != null && EXPR_END.contains(iteratorLeft.getTokenType()) && iteratorRight != null && !AFTER_EXPR_END.contains(iteratorRight.getTokenType())) {
    return false;
  }
  if (iteratorLeft != null && STRING_END.contains(iteratorLeft.getTokenType()) && iteratorRight != null && !STRING_END.contains(iteratorRight.getTokenType())) {
    return false;
  }
  return true;
}
