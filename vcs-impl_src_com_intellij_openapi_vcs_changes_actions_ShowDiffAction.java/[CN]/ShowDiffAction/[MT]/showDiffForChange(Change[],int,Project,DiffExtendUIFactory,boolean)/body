{
  Change selectedChange=changes[index];
  changes=filterDirectoryAndBinaryChanges(changes);
  if (changes.length == 0) {
    return;
  }
  index=0;
  for (int i=0; i < changes.length; i++) {
    if (changes[i] == selectedChange) {
      index=i;
      break;
    }
  }
  final DiffTool tool=DiffManager.getInstance().getDiffTool();
  final ChangeDiffRequest request=new ChangeDiffRequest(project,changes,actionsFactory);
  final SimpleDiffRequest simpleRequest=request.init(index);
  if (simpleRequest != null) {
    simpleRequest.passForDataContext(VcsDataKeys.DIFF_REQUEST_CHAIN,request);
    if (showFrame) {
      simpleRequest.addHint(DiffTool.HINT_SHOW_FRAME);
    }
 else {
      simpleRequest.addHint(DiffTool.HINT_SHOW_MODAL_DIALOG);
    }
    if (changes.length > 1) {
      simpleRequest.addHint(DiffTool.HINT_ALLOW_NO_DIFFERENCES);
    }
    tool.show(simpleRequest);
  }
}
