{
  if (!processor.process(root))   return;
  if (root.isDirectory() && directoryFilter.convert(root)) {
    final LinkedList<VirtualFile[]> queue=new LinkedList<VirtualFile[]>();
    queue.add(root.getChildren());
    do {
      final VirtualFile[] files=queue.removeFirst();
      for (      VirtualFile file : files) {
        if (!processor.process(file))         return;
        if (file.isDirectory() && directoryFilter.convert(file)) {
          queue.add(file.getChildren());
        }
      }
    }
 while (!queue.isEmpty());
  }
}
