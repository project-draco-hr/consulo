{
  if (file instanceof AbstractVcsVirtualFile) {
    return getGitRootOrNull(VcsUtil.getFilePath(file.getPath()));
  }
  VirtualFile root=file;
  while (root != null) {
    if (root.findFileByRelativePath(DOT_GIT) != null) {
      return root;
    }
    root=root.getParent();
  }
  return root;
}
