{
  VirtualFile root=file;
  while (root != null) {
    if (root.findFileByRelativePath(".git") != null) {
      return root;
    }
    root=root.getParent();
  }
  throw new IllegalArgumentException("The file " + file.getPath() + " is not under git.");
}
