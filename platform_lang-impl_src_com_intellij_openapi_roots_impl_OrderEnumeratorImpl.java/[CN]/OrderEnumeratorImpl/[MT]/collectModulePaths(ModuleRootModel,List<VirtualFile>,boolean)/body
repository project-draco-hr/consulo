{
  if (collectSources) {
    if (myProductionOnly) {
      ContentEntry[] contentEntries=rootModel.getContentEntries();
      for (      ContentEntry contentEntry : contentEntries) {
        for (        SourceFolder folder : contentEntry.getSourceFolders()) {
          VirtualFile root=folder.getFile();
          if (root != null && !folder.isTestSource()) {
            list.add(root);
          }
        }
      }
    }
 else {
      Collections.addAll(list,rootModel.getSourceRoots());
    }
  }
 else {
    final CompilerModuleExtension extension=rootModel.getModuleExtension(CompilerModuleExtension.class);
    if (extension != null) {
      VirtualFile testOutput=extension.getCompilerOutputPathForTests();
      if (myProductionOnly) {
        testOutput=null;
      }
      if (testOutput != null) {
        list.add(testOutput);
      }
      VirtualFile output=extension.getCompilerOutputPath();
      if (output != null && !output.equals(testOutput)) {
        list.add(output);
      }
    }
  }
}
