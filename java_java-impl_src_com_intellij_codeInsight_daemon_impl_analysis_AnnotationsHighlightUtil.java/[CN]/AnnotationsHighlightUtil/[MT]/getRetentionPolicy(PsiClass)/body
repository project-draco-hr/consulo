{
  PsiModifierList modifierList=annotation.getModifierList();
  if (modifierList != null) {
    PsiAnnotation retentionAnno=modifierList.findAnnotation(CommonClassNames.JAVA_LANG_ANNOTATION_RETENTION);
    if (retentionAnno == null)     return RetentionPolicy.CLASS;
    PsiAnnotationMemberValue policyRef=PsiImplUtil.findAttributeValue(retentionAnno,null);
    if (policyRef instanceof PsiReference) {
      PsiElement field=((PsiReference)policyRef).resolve();
      if (field instanceof PsiEnumConstant) {
        String name=((PsiEnumConstant)field).getName();
        try {
          return RetentionPolicy.valueOf(name);
        }
 catch (        Exception e) {
          LOG.warn("Unknown policy: " + name);
        }
      }
    }
  }
  return null;
}
