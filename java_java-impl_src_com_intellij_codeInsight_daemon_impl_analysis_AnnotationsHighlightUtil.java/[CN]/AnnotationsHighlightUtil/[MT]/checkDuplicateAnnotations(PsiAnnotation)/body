{
  PsiAnnotationOwner owner=annotationToCheck.getOwner();
  if (owner == null) {
    return null;
  }
  PsiJavaCodeReferenceElement element=annotationToCheck.getNameReferenceElement();
  if (element == null)   return null;
  PsiElement resolved=element.resolve();
  if (!(resolved instanceof PsiClass))   return null;
  PsiAnnotation[] annotations=owner.getApplicableAnnotations();
  for (  PsiAnnotation annotation : annotations) {
    if (annotation == annotationToCheck)     continue;
    PsiJavaCodeReferenceElement nameRef=annotation.getNameReferenceElement();
    if (nameRef == null)     continue;
    PsiElement aClass=nameRef.resolve();
    if (resolved.equals(aClass)) {
      return HighlightInfo.createHighlightInfo(HighlightInfoType.ERROR,element,JavaErrorMessages.message("annotation.duplicate.annotation"));
    }
  }
  return null;
}
