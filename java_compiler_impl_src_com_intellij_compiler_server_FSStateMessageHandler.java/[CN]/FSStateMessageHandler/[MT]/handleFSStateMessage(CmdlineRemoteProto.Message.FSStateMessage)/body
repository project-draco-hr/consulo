{
  try {
    myDelegate.handleFSStateMessage(message);
  }
  finally {
    final String moduleName=message.getModuleName();
    final List<String> deleteProduction=message.getDeletedProductionList();
    final List<String> deletedTests=message.getDeletedTestsList();
    final Map<File,Set<File>> recompileProduction=new HashMap<File,Set<File>>();
    final Map<File,Set<File>> recompileTests=new HashMap<File,Set<File>>();
    for (    CmdlineRemoteProto.Message.FSStateMessage.RootDelta delta : message.getRecompileDeltaList()) {
      final File root=new File(delta.getRoot());
      final Map<File,Set<File>> map=delta.getTestSources() ? recompileTests : recompileProduction;
      Set<File> files=map.get(root);
      if (files == null) {
        files=new HashSet<File>();
        map.put(root,files);
      }
      for (      String path : delta.getPathList()) {
        files.add(new File(path));
      }
    }
    myFsState.init(moduleName,deleteProduction,deletedTests,recompileProduction,recompileTests);
  }
}
