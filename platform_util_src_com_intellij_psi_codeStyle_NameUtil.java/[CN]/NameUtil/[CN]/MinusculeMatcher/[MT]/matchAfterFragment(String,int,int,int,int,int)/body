{
  int star=patternIndex + matchLen < myPattern.length && myPattern[patternIndex + matchLen] == '*' ? matchLen : -1;
  if (lastUpper >= 0) {
    FList<TextRange> ranges=matchName(name,patternIndex + lastUpper + 1,lastUpper == star ? nameIndex + lastUpper : nextStart);
    if (ranges != null) {
      return prependRange(ranges,nameIndex,lastUpper + 1);
    }
  }
  int startMatchLen=matchLen;
  while (matchLen > 0) {
    if (matchLen != lastUpper) {
      FList<TextRange> ranges=matchName(name,patternIndex + matchLen,matchLen == star ? matchLen + lastUpper : nextStart);
      if (ranges != null) {
        return prependRange(ranges,nameIndex,matchLen);
      }
    }
    matchLen--;
  }
  FList<TextRange> ranges=matchName(name,patternIndex + startMatchLen,nameIndex + startMatchLen);
  if (ranges != null) {
    return prependRange(ranges,nameIndex,startMatchLen);
  }
  return null;
}
