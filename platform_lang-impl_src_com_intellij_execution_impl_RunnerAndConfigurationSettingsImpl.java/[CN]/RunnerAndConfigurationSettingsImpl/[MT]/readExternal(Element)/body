{
  myIsTemplate=Boolean.valueOf(element.getAttributeValue(TEMPLATE_FLAG_ATTRIBUTE)).booleanValue();
  myTemporary=Boolean.valueOf(element.getAttributeValue(TEMPORARY_ATTRIBUTE)).booleanValue() || TEMP_CONFIGURATION.equals(element.getName());
  myEditBeforeRun=Boolean.valueOf(element.getAttributeValue(EDIT_BEFORE_RUN)).booleanValue();
  myFolderName=element.getAttributeValue(FOLDER_NAME);
  final ConfigurationFactory factory=getFactory(element);
  if (factory == null)   return;
  myWasSingletonSpecifiedExplicitly=false;
  if (myIsTemplate) {
    mySingleton=factory.isConfigurationSingletonByDefault();
  }
 else {
    String singletonStr=element.getAttributeValue(SINGLETON);
    if (StringUtil.isEmpty(singletonStr)) {
      mySingleton=factory.isConfigurationSingletonByDefault();
    }
 else {
      myWasSingletonSpecifiedExplicitly=true;
      mySingleton=Boolean.parseBoolean(singletonStr);
    }
  }
  if (myIsTemplate) {
    myConfiguration=myManager.getConfigurationTemplate(factory).getConfiguration();
  }
 else {
    myConfiguration=myManager.doCreateConfiguration(element.getAttributeValue(NAME_ATTR),factory,false);
  }
  myConfiguration.readExternal(element);
  if (myUnloadedRunnerSettings != null) {
    myUnloadedRunnerSettings.clear();
  }
  myLoadedRunnerSettings.clear();
  for (  Element runnerElement : element.getChildren(RUNNER_ELEMENT)) {
    String id=runnerElement.getAttributeValue(RUNNER_ID);
    ProgramRunner runner=RunnerRegistry.getInstance().findRunnerById(id);
    if (runner != null) {
      myLoadedRunnerSettings.add(id);
      RunnerSettings settings=createRunnerSettings(runner);
      if (settings != null) {
        settings.readExternal(runnerElement);
      }
      myRunnerSettings.put(runner,settings);
    }
 else {
      if (myUnloadedRunnerSettings == null) {
        myUnloadedRunnerSettings=new SmartList<Element>();
      }
      myUnloadedRunnerSettings.add(runnerElement);
    }
  }
  myUnloadedConfigurationPerRunnerSettings=null;
  for (Iterator<Element> iterator=element.getChildren(CONFIGURATION_ELEMENT).iterator(); iterator.hasNext(); ) {
    Element configurationElement=iterator.next();
    ProgramRunner runner=RunnerRegistry.getInstance().findRunnerById(configurationElement.getAttributeValue(RUNNER_ID));
    if (runner != null) {
      ConfigurationPerRunnerSettings settings=myConfiguration.createRunnerSettings(new InfoProvider(runner));
      if (settings != null) {
        settings.readExternal(configurationElement);
      }
      myConfigurationPerRunnerSettings.put(runner,settings);
    }
 else {
      if (myUnloadedConfigurationPerRunnerSettings == null) {
        myUnloadedConfigurationPerRunnerSettings=new SmartList<Element>();
      }
      iterator.remove();
      myUnloadedConfigurationPerRunnerSettings.add(configurationElement);
    }
  }
}
