{
  boolean indentChanged=false;
  IndentType currentIndentType=getIndentToUse();
  boolean useCustomIndent=currentIndentType == IndentType.CUSTOM;
  int currentCustomIndent=myEditor.getSettings().getCustomSoftWrapIndent();
  if (useCustomIndent ^ myCustomIndentUsedLastTime || (useCustomIndent && myCustomIndentValueUsedLastTime != currentCustomIndent)) {
    indentChanged=true;
  }
  myCustomIndentUsedLastTime=useCustomIndent;
  myCustomIndentValueUsedLastTime=currentCustomIndent;
  int currentVisibleAreaWidth=myEditor.getScrollingModel().getVisibleArea().width;
  if (!indentChanged && myVisibleAreaWidth == currentVisibleAreaWidth) {
    return;
  }
  myDirtyRanges.clear();
  myDirtyRanges.add(new TextRange(0,myEditor.getDocument().getTextLength()));
  myStorage.removeAll();
  myVisibleAreaWidth=currentVisibleAreaWidth;
}
