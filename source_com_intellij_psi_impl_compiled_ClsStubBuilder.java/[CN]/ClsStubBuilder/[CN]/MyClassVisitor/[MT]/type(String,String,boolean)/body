{
  if (signature != null) {
    try {
      return TypeInfo.fromString(SignatureParsing.parseTypeString(new StringCharacterIterator(signature,0)));
    }
 catch (    ClsFormatException e) {
      throw new RuntimeException(e);
    }
  }
 else {
    Type type=Type.getType(desc);
    final int dim=type.getSort() == Type.ARRAY ? type.getDimensions() : 0;
    if (dim > 0) {
      type=type.getElementType();
    }
    final TypeInfo info=new TypeInfo();
    info.arrayCount=(byte)dim;
    info.text=type.getClassName();
    info.isEllipsis=isVararg;
    return info;
  }
}
