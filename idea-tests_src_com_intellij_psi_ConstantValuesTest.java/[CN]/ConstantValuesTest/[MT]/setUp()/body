{
  super.setUp();
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    public void run(){
      try {
        String rootPath=PathManagerEx.getTestDataPath() + "/psi/constantValues";
        VirtualFile root=PsiTestUtil.createTestProjectStructure(myProject,myModule,rootPath,myFilesToDelete,true);
        ModuleRootManager rootManager=ModuleRootManager.getInstance(myModule);
        ModifiableRootModel rootModel=rootManager.getModifiableModel();
        Library lib=rootModel.getModuleLibraryTable().createLibrary("test");
        Library.ModifiableModel libModel=lib.getModifiableModel();
        libModel.addRoot(root,OrderRootType.CLASSES);
        libModel.commit();
        rootModel.commit();
      }
 catch (      Exception e) {
        LOG.error(e);
      }
    }
  }
);
  myClass=myJavaFacade.findClass("ClassWithConstants",GlobalSearchScope.allScope(getProject()));
  assertNotNull(myClass);
  assertEquals(StdFileTypes.JAVA,myClass.getContainingFile().getVirtualFile().getFileType());
}
