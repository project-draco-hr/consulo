{
  final VirtualFile file=getVirtualFile();
  if (file != null && !(file instanceof LightVirtualFile)) {
    final FileIndexFacade index=ServiceManager.getService(getProject(),FileIndexFacade.class);
    if (!index.isInSource(file) && !index.isInLibraryClasses(file)) {
      return GlobalSearchScopes.fileScope(this);
    }
  }
  return super.getResolveScope();
}
