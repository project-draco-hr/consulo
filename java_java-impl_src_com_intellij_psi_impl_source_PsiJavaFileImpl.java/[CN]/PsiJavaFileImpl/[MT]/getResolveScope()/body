{
  final VirtualFile file=getVirtualFile();
  if (file != null && !(file instanceof LightVirtualFile)) {
    final ProjectFileIndex index=ProjectRootManager.getInstance(getProject()).getFileIndex();
    if (!index.isInSource(file) && !index.isInLibraryClasses(file)) {
      return GlobalSearchScope.fileScope(this);
    }
  }
  return super.getResolveScope();
}
