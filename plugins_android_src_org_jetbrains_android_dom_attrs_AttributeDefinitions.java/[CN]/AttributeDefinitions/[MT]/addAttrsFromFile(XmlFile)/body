{
  Map<StyleableDefinition,String[]> parentMap=new HashMap<StyleableDefinition,String[]>();
  final XmlDocument document=file.getDocument();
  if (document == null)   return;
  final XmlTag rootTag=document.getRootTag();
  if (rootTag == null || !"resources".equals(rootTag.getName()))   return;
  for (  XmlTag tag : rootTag.getSubTags()) {
    String tagName=tag.getName();
    if (tagName.equals("attr")) {
      parseAttrTag(tag);
    }
 else     if (tagName.equals("declare-styleable")) {
      parseDeclareStyleableTag(tag,parentMap);
    }
  }
  for (  Map.Entry<StyleableDefinition,String[]> entry : parentMap.entrySet()) {
    StyleableDefinition definition=entry.getKey();
    String[] parentNames=entry.getValue();
    for (    String parentName : parentNames) {
      StyleableDefinition parent=getStyleableByName(parentName);
      if (parent != null) {
        definition.addParent(parent);
        parent.addChild(definition);
      }
 else {
        LOG.info("Found tag with unknown parent: " + parentName);
      }
    }
  }
}
