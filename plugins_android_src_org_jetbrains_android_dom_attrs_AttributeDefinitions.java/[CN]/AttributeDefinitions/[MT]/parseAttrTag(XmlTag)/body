{
  String name=tag.getAttributeValue("name");
  if (name == null) {
    LOG.info("Found attr tag with no name: " + tag.getText());
    return null;
  }
  List<AttributeFormat> parsedFormats;
  List<AttributeFormat> formats=new ArrayList<AttributeFormat>();
  String format=tag.getAttributeValue("format");
  if (format != null) {
    parsedFormats=parseAttrFormat(format);
    if (parsedFormats != null)     formats.addAll(parsedFormats);
  }
  XmlTag[] values=tag.findSubTags("enum");
  if (values.length > 0) {
    formats.add(AttributeFormat.Enum);
  }
 else {
    values=tag.findSubTags("flag");
    if (values.length > 0) {
      formats.add(AttributeFormat.Flag);
    }
  }
  AttributeDefinition def=myAttrs.get(name);
  if (def == null) {
    def=new AttributeDefinition(name);
    myAttrs.put(def.getName(),def);
  }
  def.addFormats(formats);
  parseDocComment(tag,def);
  parseAndAddValues(def,values);
  return def;
}
