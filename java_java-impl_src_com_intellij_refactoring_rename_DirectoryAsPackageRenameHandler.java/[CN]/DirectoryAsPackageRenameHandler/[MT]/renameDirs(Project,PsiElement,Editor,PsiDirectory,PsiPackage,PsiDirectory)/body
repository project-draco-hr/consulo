{
  final RenameDialog dialog=new RenameDialog(project,contextDirectory,nameSuggestionContext,editor){
    @Override protected void doAction(){
      final String newName=StringUtil.getQualifiedName(StringUtil.getPackageName(aPackage.getQualifiedName()),getNewName());
      final MoveDirectoryWithClassesProcessor moveProcessor=new MoveDirectoryWithClassesProcessor(project,dirsToRename,null,isSearchInComments(),isSearchInNonJavaFiles(),false,null){
        @Override public TargetDirectoryWrapper getTargetDirectory(        final PsiDirectory dir){
          return new TargetDirectoryWrapper(dir.getParentDirectory(),getNewName());
        }
        @Override protected String getTargetName(){
          return newName;
        }
        @Override protected String getCommandName(){
          return dirsToRename.length == 1 ? "Rename directory" : "Rename directories";
        }
      }
;
      invokeRefactoring(moveProcessor);
    }
  }
;
  dialog.show();
}
