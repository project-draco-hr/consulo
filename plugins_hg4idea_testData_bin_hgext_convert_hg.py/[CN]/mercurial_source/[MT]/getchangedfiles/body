def getchangedfiles(self, rev, i):
    ctx = self.changectx(rev)
    parents = self.parents(ctx)
    if ((not parents) and (i is None)):
        i = 0
        changes = ([], ctx.manifest().keys(), [])
    else:
        i = (i or 0)
        changes = self.repo.status(parents[i].node(), ctx.node())[:3]
    changes = [[f for f in l if (f not in self.ignored)] for l in changes]
    if (i == 0):
        self._changescache = (rev, changes)
    return ((changes[0] + changes[1]) + changes[2])
