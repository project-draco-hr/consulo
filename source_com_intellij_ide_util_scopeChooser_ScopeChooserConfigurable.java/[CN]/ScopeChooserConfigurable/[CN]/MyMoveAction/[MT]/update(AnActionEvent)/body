{
  final Presentation presentation=e.getPresentation();
  presentation.setEnabled(false);
  final TreePath selectionPath=myTree.getSelectionPath();
  if (selectionPath != null) {
    final DefaultMutableTreeNode treeNode=(DefaultMutableTreeNode)selectionPath.getLastPathComponent();
    if (treeNode.getUserObject() instanceof ScopeConfigurable) {
      if (myDirection < 0) {
        presentation.setEnabled(treeNode.getPreviousSibling() != null);
      }
 else {
        presentation.setEnabled(treeNode.getNextSibling() != null);
      }
    }
  }
}
