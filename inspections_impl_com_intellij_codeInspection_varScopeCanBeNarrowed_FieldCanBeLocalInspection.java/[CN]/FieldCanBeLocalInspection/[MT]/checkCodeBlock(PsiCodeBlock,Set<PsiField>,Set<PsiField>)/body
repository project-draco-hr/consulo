{
  try {
    final ControlFlow controlFlow=ControlFlowFactory.getInstance(body.getProject()).getControlFlow(body,AllVariablesControlFlowPolicy.getInstance());
    final List<PsiVariable> usedVars=ControlFlowUtil.getUsedVariables(controlFlow,0,controlFlow.getSize());
    for (    PsiVariable usedVariable : usedVars) {
      if (usedVariable instanceof PsiField) {
        final PsiField usedField=(PsiField)usedVariable;
        if (!usedFields.add(usedField)) {
          candidates.remove(usedField);
        }
      }
    }
    final List<PsiReferenceExpression> readBeforeWrites=ControlFlowUtil.getReadBeforeWrite(controlFlow);
    for (    final PsiReferenceExpression readBeforeWrite : readBeforeWrites) {
      final PsiElement resolved=readBeforeWrite.resolve();
      if (resolved instanceof PsiField) {
        final PsiField field=(PsiField)resolved;
        PsiElement parent=body.getParent();
        if (!(parent instanceof PsiMethod) || !((PsiMethod)parent).isConstructor() || field.getInitializer() == null || field.hasModifierProperty(PsiModifier.STATIC)) {
          candidates.remove(field);
        }
      }
    }
  }
 catch (  AnalysisCanceledException e) {
    candidates.clear();
  }
}
