{
  SortedSet<String> profiles=new TreeSet<String>();
  try {
    MavenEmbedder e=MavenFactory.createEmbedderForRead(getCoreState());
    MavenProjectReader r=new MavenProjectReader(e);
    for (    VirtualFile f : files) {
      ProjectUtil.collectProfileIds(r.readModel(f.getPath()),profiles);
    }
    MavenFactory.releaseEmbedder(e);
  }
 catch (  MavenException ignore) {
  }
  return new ArrayList<String>(profiles);
}
