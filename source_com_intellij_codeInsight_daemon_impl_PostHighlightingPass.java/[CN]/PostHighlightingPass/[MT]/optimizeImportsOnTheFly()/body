{
  if (myHasRedundantImports || myHasMissortedImports) {
    ApplicationManager.getApplication().invokeLater(new Runnable(){
      public void run(){
        CommandProcessor.getInstance().runUndoTransparentAction(new Runnable(){
          public void run(){
            ApplicationManager.getApplication().runWriteAction(new Runnable(){
              public void run(){
                OptimizeImportsFix optimizeImportsFix=new OptimizeImportsFix();
                if (optimizeImportsFix.isAvailable(myProject,myEditor,myFile) && myFile.isWritable()) {
                  PsiDocumentManager.getInstance(myProject).commitAllDocuments();
                  optimizeImportsFix.invoke(myProject,myEditor,myFile);
                }
              }
            }
);
          }
        }
);
      }
    }
);
  }
}
