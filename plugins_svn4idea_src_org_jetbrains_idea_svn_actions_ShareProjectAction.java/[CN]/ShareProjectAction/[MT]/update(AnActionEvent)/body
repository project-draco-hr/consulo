{
  Presentation presentation=e.getPresentation();
  final DataContext dataContext=e.getDataContext();
  Project project=DataKeys.PROJECT.getData(dataContext);
  if (project == null) {
    presentation.setEnabled(false);
    presentation.setVisible(false);
    return;
  }
  VirtualFile[] files=DataKeys.VIRTUAL_FILE_ARRAY.getData(dataContext);
  if (files == null || files.length == 0) {
    presentation.setEnabled(false);
    presentation.setVisible(false);
    return;
  }
  boolean enabled=false;
  boolean visible=false;
  if (files.length == 1) {
    VirtualFile file=files[0];
    VirtualFile[] roots=ProjectRootManager.getInstance(project).getContentRoots();
    VirtualFile root=null;
    for (    VirtualFile root1 : roots) {
      if (root1.equals(file)) {
        root=file;
        break;
      }
    }
    if (root != null && root.isDirectory()) {
      visible=true;
      if (!SVNWCUtil.isVersionedDirectory(new File(root.getPath()))) {
        enabled=true;
      }
    }
  }
  presentation.setEnabled(enabled);
  presentation.setVisible(visible);
}
