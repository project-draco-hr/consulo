{
  ShareDialog shareDialog=new ShareDialog(project);
  shareDialog.show();
  final String parent=shareDialog.getSelectedURL();
  if (shareDialog.isOK() && parent != null) {
    final SVNException[] error=new SVNException[1];
    ProgressManager.getInstance().runProcessWithProgressSynchronously(new Runnable(){
      public void run(){
        try {
          SVNURL url=SVNURL.parseURIEncoded(parent).appendPath(file.getName(),false);
          SVNCommitInfo info=activeVcs.createCommitClient().doMkDir(new SVNURL[]{url},"Directory '" + file.getName() + "' created by IntelliJ IDEA");
          SVNRevision revision=SVNRevision.create(info.getNewRevision());
          activeVcs.createUpdateClient().doCheckout(url,new File(file.getPath()),SVNRevision.UNDEFINED,revision,true);
          activeVcs.createWCClient().doAdd(new File(file.getPath()),true,false,false,true);
        }
 catch (        SVNException e) {
          error[0]=e;
        }
      }
    }
,"Share Directory",false,project);
    if (error[0] != null) {
      throw new VcsException(error[0].getMessage());
    }
    Messages.showInfoMessage(project,"To complete share operation commit '" + file.getName() + "'.","Share Directory");
  }
}
