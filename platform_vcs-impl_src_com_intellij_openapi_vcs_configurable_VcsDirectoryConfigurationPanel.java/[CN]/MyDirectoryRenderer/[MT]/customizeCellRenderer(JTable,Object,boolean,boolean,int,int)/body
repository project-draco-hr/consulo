{
  if (value instanceof MapInfo) {
    MapInfo info=(MapInfo)value;
    if (!selected && (info == MapInfo.SEPARATOR || info.type == MapInfo.Type.UNREGISTERED)) {
      setBackground(getUnregisteredRootBackground());
    }
    if (info == MapInfo.SEPARATOR) {
      append("Unregistered roots:",getAttributes(info));
      return;
    }
    if (info.mapping.isDefaultMapping()) {
      append(VcsDirectoryMapping.PROJECT_CONSTANT,getAttributes(info));
      return;
    }
    String directory=info.mapping.getDirectory();
    VirtualFile baseDir=myProject.getBaseDir();
    if (baseDir != null) {
      final File directoryFile=new File(StringUtil.trimEnd(UriUtil.trimTrailingSlashes(directory),"\\") + "/");
      File ioBase=new File(baseDir.getPath());
      if (directoryFile.isAbsolute() && !FileUtil.isAncestor(ioBase,directoryFile,false)) {
        append(new File(directory).getPath(),getAttributes(info));
        return;
      }
      String relativePath=FileUtil.getRelativePath(ioBase,directoryFile);
      if (".".equals(relativePath) || relativePath == null) {
        append(ioBase.getPath(),getAttributes(info));
      }
 else {
        append(relativePath,getAttributes(info));
        append(" (" + ioBase + ")",SimpleTextAttributes.GRAYED_ATTRIBUTES);
      }
    }
  }
}
