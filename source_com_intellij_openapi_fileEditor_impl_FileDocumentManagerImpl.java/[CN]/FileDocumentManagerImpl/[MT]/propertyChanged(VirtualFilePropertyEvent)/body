{
  if (VirtualFile.PROP_WRITABLE.equals(event.getPropertyName())) {
    final VirtualFile file=event.getFile();
    final Document document=getCachedDocument(file);
    if (document == null)     return;
    ApplicationManager.getApplication().runWriteAction(new PsiExternalChangeAction(){
      public void run(){
        document.setReadOnly(!event.getFile().isWritable());
      }
    }
);
  }
}
