{
  final Project project=getProject();
  final TextConsoleBuilder consoleBuilder=TextConsoleBuilderFactory.getInstance().createBuilder(project);
  List<Filter> filters=ExceptionFilters.getFilters(myDebuggerSession.getSearchScope());
  for (  Filter filter : filters) {
    consoleBuilder.addFilter(filter);
  }
  final ConsoleView consoleView=consoleBuilder.getConsole();
  final DefaultActionGroup toolbarActions=new DefaultActionGroup();
  consoleView.allowHeavyFilters();
  final ThreadDumpPanel panel=new ThreadDumpPanel(project,consoleView,toolbarActions,threads);
  final Icon icon=null;
  final String id=createThreadDumpContentId();
  final Content content=myUi.createContent(id,panel,id,icon,null);
  content.setCloseable(true);
  content.setDescription("Thread Dump");
  myUi.addContent(content);
  myUi.selectAndFocus(content,true,true);
  myThreadDumpsCount+=1;
  myCurrentThreadDumpId+=1;
  Disposer.register(this,new Disposable(){
    public void dispose(){
      myUi.removeContent(content,true);
    }
  }
);
  Disposer.register(content,new Disposable(){
    public void dispose(){
      myThreadDumpsCount-=1;
      if (myThreadDumpsCount == 0) {
        myCurrentThreadDumpId=1;
      }
    }
  }
);
  myUi.selectAndFocus(content,true,false);
  if (threads.size() > 0) {
    panel.selectStackFrame(0);
  }
}
