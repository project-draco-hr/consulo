{
  final Project project=getProject();
  final TextConsoleBuilder consoleBuilder=TextConsoleBuilderFactory.getInstance().createBuilder(project);
  consoleBuilder.addFilter(new ExceptionFilter(myDebuggerSession.getSearchScope()));
  final ConsoleView consoleView=consoleBuilder.getConsole();
  final DefaultActionGroup toolbarActions=new DefaultActionGroup();
  final ThreadDumpPanel panel=new ThreadDumpPanel(project,consoleView,toolbarActions,threads);
  final Icon icon=null;
  final String id=createThreadDumpContentId();
  final Content content=myUi.createContent(id,panel,id,icon,null);
  content.setCloseable(true);
  content.setDescription("Thread Dump");
  myUi.addListener(new ContentManagerAdapter(){
    public void contentRemoved(    ContentManagerEvent event){
      if (event.getContent() == content) {
        myThreadDumpsCount-=1;
        if (myThreadDumpsCount == 0) {
          myCurrentThreadDumpId=1;
        }
        myUi.removeListener(this);
      }
    }
  }
,content);
  myUi.addContent(content);
  myThreadDumpsCount+=1;
  myCurrentThreadDumpId+=1;
  Disposer.register(this,new Disposable(){
    public void dispose(){
      myUi.removeContent(content,true);
    }
  }
);
  myUi.selectAndFocus(content,false);
  if (threads.size() > 0) {
    panel.selectStackFrame(0);
  }
}
