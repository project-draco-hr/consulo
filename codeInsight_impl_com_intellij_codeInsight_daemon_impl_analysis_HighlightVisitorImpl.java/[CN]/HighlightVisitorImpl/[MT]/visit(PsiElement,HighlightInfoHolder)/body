{
  myHolder=holder;
  if (LOG.isDebugEnabled()) {
    LOG.assertTrue(element.isValid());
  }
  element.accept(this);
  PsiFile containingFile=element.getContainingFile();
  if (!(containingFile instanceof PsiCodeFragment) && containingFile instanceof PsiAspectFile) {
    element.accept(myAspectHighlightVisitor);
    myHolder.add(myAspectHighlightVisitor.getResults());
    myAspectHighlightVisitor.clearResults();
  }
  if (!myHolder.hasErrorResults()) {
    if (runEjbHighlighting == null) {
      runEjbHighlighting=Boolean.valueOf(EjbUtil.getEjbModuleProperties(element) != null);
    }
    if (runEjbHighlighting.booleanValue()) {
      if (myEjbHighlightVisitor == null) {
        myEjbHighlightVisitor=new EjbHighlightVisitor(myAnnotationHolder);
      }
      element.accept(myEjbHighlightVisitor);
      convertAnnotationsToHighlightInfos();
      myEjbHighlightVisitor.clearResults();
    }
  }
}
