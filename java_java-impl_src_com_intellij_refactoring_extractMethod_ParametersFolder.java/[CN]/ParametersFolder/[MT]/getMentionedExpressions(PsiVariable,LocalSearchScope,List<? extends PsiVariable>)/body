{
  if (myMentionedInExpressions.containsKey(var))   return myMentionedInExpressions.get(var);
  final PsiElement[] scopeElements=scope.getScope();
  List<PsiExpression> expressions=null;
  for (  PsiReference reference : ReferencesSearch.search(var,scope)) {
    PsiElement expression=reference.getElement();
    if (expressions == null) {
      expressions=new ArrayList<PsiExpression>();
      while (expression != null) {
        if (isAccessedForWriting((PsiExpression)expression))         return null;
        for (        PsiElement scopeElement : scopeElements) {
          if (PsiTreeUtil.isAncestor(expression,scopeElement,true)) {
            expression=null;
            break;
          }
        }
        if (expression == null)         break;
        final PsiType expressionType=((PsiExpression)expression).getType();
        if (expressionType != null && expressionType != PsiType.VOID && !(expression.getParent() instanceof PsiExpressionStatement)) {
          if (dependsOnLocals(expression,inputVariables)) {
            break;
          }
          expressions.add((PsiExpression)expression);
        }
        expression=PsiTreeUtil.getParentOfType(expression,PsiExpression.class);
      }
    }
 else {
      for (Iterator<PsiExpression> iterator=expressions.iterator(); iterator.hasNext(); ) {
        if (findEquivalent(iterator.next(),expression) == null) {
          iterator.remove();
        }
      }
    }
  }
  myMentionedInExpressions.put(var,expressions);
  return expressions;
}
