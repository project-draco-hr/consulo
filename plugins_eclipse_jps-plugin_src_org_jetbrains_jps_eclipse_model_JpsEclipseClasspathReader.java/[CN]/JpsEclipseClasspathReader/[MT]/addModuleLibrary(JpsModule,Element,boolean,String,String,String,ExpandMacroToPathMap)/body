{
  final JpsLibrary jpsLibrary=rootModel.addModuleLibrary(libName,JpsJavaLibraryType.INSTANCE);
  final JpsDependenciesList dependenciesList=rootModel.getDependenciesList();
  final JpsLibraryDependency dependency=dependenciesList.addLibraryDependency(jpsLibrary);
  url=StringUtil.trimStart(url,"file://");
  final String linked=expandLinkedResourcesPath(url,macroMap);
  if (linked != null) {
    url=pathToUrl(linked);
  }
 else {
    url=expandEclipsePath2Url(rootModel,url);
  }
  LOG.debug("loading " + rootModel.getName() + ": adding module library "+ libName+ ": "+ url);
  jpsLibrary.addRoot(url,JpsOrderRootType.COMPILED);
  setLibraryEntryExported(dependency,exported);
}
