{
  final JpsLibrary jpsLibrary=rootModel.addModuleLibrary(libName,JpsJavaLibraryType.INSTANCE);
  final JpsDependenciesList dependenciesList=rootModel.getDependenciesList();
  final JpsLibraryDependency dependency=dependenciesList.addLibraryDependency(jpsLibrary);
  final String linked=expandLinkedResourcesPath(url,macroMap);
  if (linked != null) {
    url=pathToUrl(linked);
  }
 else {
    url=expandEclipsePath2Url(rootModel,url);
  }
  jpsLibrary.addRoot(url,JpsOrderRootType.COMPILED);
  setLibraryEntryExported(exported,dependency);
}
