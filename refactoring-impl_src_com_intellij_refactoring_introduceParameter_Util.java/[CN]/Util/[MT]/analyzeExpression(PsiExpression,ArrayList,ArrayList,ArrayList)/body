{
  if (expr instanceof PsiThisExpression || expr instanceof PsiSuperExpression) {
    classMemberRefs.add(new ClassMemberInExprUsageInfo(expr));
  }
 else   if (expr instanceof PsiReferenceExpression) {
    final PsiReferenceExpression refExpr=(PsiReferenceExpression)expr;
    PsiElement subj=refExpr.resolve();
    if (subj instanceof PsiParameter) {
      params.add(new ParameterInExprUsageInfo(refExpr));
    }
 else     if (subj instanceof PsiLocalVariable) {
      localVars.add(new LocalVariableInExprUsageInfo(refExpr));
    }
 else     if (subj instanceof PsiField || subj instanceof PsiMethod) {
      classMemberRefs.add(new ClassMemberInExprUsageInfo(refExpr));
    }
  }
  PsiElement[] children=expr.getChildren();
  for (int i=0; i < children.length; i++) {
    PsiElement child=children[i];
    if (child instanceof PsiExpression) {
      analyzeExpression((PsiExpression)child,localVars,classMemberRefs,params);
    }
  }
}
