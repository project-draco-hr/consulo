{
  if ((bc instanceof NullCipher) == false) {
    useRandomPadding=true;
  }
  cos.changeCipher(bc);
  send_mac=mac;
  send_mac_buffer=(mac != null) ? new byte[mac.size()] : null;
  send_padd_blocksize=bc.getBlockSize();
  if (send_padd_blocksize < 8)   send_padd_blocksize=8;
}
