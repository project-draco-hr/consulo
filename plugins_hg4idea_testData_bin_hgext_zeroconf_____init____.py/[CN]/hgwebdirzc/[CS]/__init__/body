def __init__(self, conf, baseui=None):
    super(hgwebdirzc, self).__init__(conf, baseui)
    prefix = (self.ui.config('web', 'prefix', '').strip('/') + '/')
    for (repo, path) in self.repos:
        u = self.ui.copy()
        u.readconfig(os.path.join(path, '.hg', 'hgrc'))
        name = os.path.basename(repo)
        path = (prefix + repo).strip('/')
        desc = u.config('web', 'description', name)
        publish(name, desc, path, int(u.config('web', 'port', 8000)))
