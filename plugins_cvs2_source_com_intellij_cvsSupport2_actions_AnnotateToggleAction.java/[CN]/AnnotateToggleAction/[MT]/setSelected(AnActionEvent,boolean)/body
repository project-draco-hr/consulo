{
  VcsContext context=CvsContextWrapper.on(e);
  Editor editor=context.getEditor();
  if (!state) {
    if (editor == null) {
      return;
    }
 else {
      editor.getGutter().closeAllAnnotations();
    }
  }
 else {
    if (editor == null) {
      VirtualFile selectedFile=context.getSelectedFile();
      FileEditor[] fileEditors=FileEditorManager.getInstance(context.getProject()).openFile(selectedFile,false);
      for (int i=0; i < fileEditors.length; i++) {
        FileEditor fileEditor=fileEditors[i];
        if (fileEditor instanceof TextEditor) {
          editor=((TextEditor)fileEditor).getEditor();
        }
      }
    }
    LOG.assertTrue(editor != null);
    new AnnotateAction(editor).actionPerformed(e);
  }
}
