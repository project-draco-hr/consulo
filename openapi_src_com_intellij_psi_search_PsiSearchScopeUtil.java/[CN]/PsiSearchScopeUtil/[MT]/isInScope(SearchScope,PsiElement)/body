{
  if (scope instanceof LocalSearchScope) {
    PsiElement[] scopeElements=((LocalSearchScope)scope).getScope();
    for (int i=0; i < scopeElements.length; i++) {
      final PsiElement scopeElement=scopeElements[i];
      if (PsiTreeUtil.isAncestor(scopeElement,element,false))       return true;
    }
    return false;
  }
 else {
    GlobalSearchScope _scope=(GlobalSearchScope)scope;
    PsiFile file=element.getContainingFile();
    if (file != null) {
      if (file.getVirtualFile() == null)       return true;
      if (!_scope.contains(file.getVirtualFile()))       return false;
      return true;
    }
 else {
      return true;
    }
  }
}
