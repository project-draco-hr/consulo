{
  if (ApplicationManager.getApplication().isUnitTestMode())   return new Point();
  final int offset=editor.getCaretModel().getOffset();
  final LogicalPosition pos=editor.offsetToLogicalPosition(offset);
  int line=pos.line;
  final Point position=editor.logicalPositionToXY(new LogicalPosition(line,0));
  final int yShift=(ourIntentionIcon.getIconHeight() - editor.getLineHeight() - 1) / 2 - 1;
  final int xShift=ourIntentionIcon.getIconWidth();
  LOG.assertTrue(editor.getComponent().isDisplayable());
  Rectangle visibleArea=editor.getScrollingModel().getVisibleArea();
  Point realPoint=new Point(Math.max(0,visibleArea.x - xShift),position.y + yShift - 20);
  Point location=SwingUtilities.convertPoint(editor.getContentComponent(),realPoint,editor.getComponent().getRootPane().getLayeredPane());
  return new Point(location.x,location.y);
}
