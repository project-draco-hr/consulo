{
  final boolean[] needToRefresh=new boolean[]{true};
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    public void run(){
      PsiDocumentManager.getInstance(project).commitAllDocuments();
      try {
        action.invoke(project,null,element.getContainingFile());
        final Set<GlobalInspectionContextImpl> globalInspectionContexts=((InspectionManagerEx)InspectionManagerEx.getInstance(project)).getRunningContexts();
        for (        GlobalInspectionContextImpl context : globalInspectionContexts) {
          context.ignoreElement(tool,element);
        }
      }
 catch (      ProcessCanceledException e1) {
        needToRefresh[0]=false;
      }
catch (      IncorrectOperationException e1) {
        LOG.error(e1);
      }
    }
  }
);
  return needToRefresh[0];
}
