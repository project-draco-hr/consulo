{
  if (virtualFile == null)   return null;
  return ApplicationManager.getApplication().runReadAction(new Computable<PsiDirectory>(){
    @Override public PsiDirectory compute(){
      VirtualFile child=restoreVFile(virtualFile);
      if (child == null || !child.isValid())       return null;
      PsiDirectory file=PsiManager.getInstance(project).findDirectory(child);
      if (file == null || !file.isValid())       return null;
      return file;
    }
  }
);
}
