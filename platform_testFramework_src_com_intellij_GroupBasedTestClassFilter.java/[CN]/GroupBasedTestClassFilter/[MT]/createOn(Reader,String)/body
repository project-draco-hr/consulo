{
  Map<String,List<String>> groupNameToPatternsMap=new HashMap<String,List<String>>();
  String currentGroupName="";
  @SuppressWarnings({"IOResourceOpenedButNotSafelyClosed"}) BufferedReader bufferedReader=new BufferedReader(reader);
  String line;
  while ((line=bufferedReader.readLine()) != null) {
    if (line.startsWith("#"))     continue;
    if (line.startsWith("[") && line.endsWith("]")) {
      currentGroupName=line.substring(1,line.length() - 1);
    }
 else {
      if (!groupNameToPatternsMap.containsKey(currentGroupName)) {
        groupNameToPatternsMap.put(currentGroupName,new ArrayList<String>());
      }
      groupNameToPatternsMap.get(currentGroupName).add(line);
    }
  }
  return new GroupBasedTestClassFilter(groupNameToPatternsMap,testGroupName);
}
