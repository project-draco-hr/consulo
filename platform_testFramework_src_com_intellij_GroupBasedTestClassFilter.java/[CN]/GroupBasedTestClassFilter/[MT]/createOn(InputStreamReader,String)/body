{
  try {
    Map<String,List<String>> groupNameToPatternsMap=new HashMap<String,List<String>>();
    String currentGroupName="";
    LineNumberReader lineNumberReader=new LineNumberReader(inputStreamReader);
    String line;
    while ((line=lineNumberReader.readLine()) != null) {
      if (line.startsWith("#"))       continue;
      if (line.startsWith("[") && line.endsWith("]")) {
        currentGroupName=line.substring(1,line.length() - 1);
      }
 else {
        if (!groupNameToPatternsMap.containsKey(currentGroupName)) {
          groupNameToPatternsMap.put(currentGroupName,new ArrayList<String>());
        }
        groupNameToPatternsMap.get(currentGroupName).add(line);
      }
    }
    return new GroupBasedTestClassFilter(groupNameToPatternsMap,testGroupName);
  }
 catch (  IOException e) {
    return ALL_CLASSES;
  }
}
