{
  vcs.createFile("file",cf("old"),123L,false);
  Clock.setCurrentTimestamp(456);
  gateway.addUnsavedDocument("file","new");
  d.startAction();
  assertEquals(c("new"),vcs.getEntry("file").getContent());
  assertEquals(456L,vcs.getEntry("file").getTimestamp());
  assertEquals(2,vcs.getRevisionsFor("file").size());
}
