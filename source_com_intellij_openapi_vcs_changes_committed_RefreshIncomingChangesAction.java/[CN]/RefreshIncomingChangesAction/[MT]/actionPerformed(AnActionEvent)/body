{
  Project project=e.getData(DataKeys.PROJECT);
  if (project != null) {
    final CommittedChangesCache cache=CommittedChangesCache.getInstance(project);
    if (!cache.hasCachesForAllRoots() && !CacheSettingsDialog.showSettingsDialog(project)) {
      return;
    }
    cache.refreshAllCachesAsync(true);
    cache.refreshIncomingChangesAsync();
  }
}
