{
  if (!actionChoice.isEnabled())   return FINAL_CHOICE;
  final AnAction action=actionChoice.getAction();
  DataManager mgr=DataManager.getInstance();
  final DataContext dataContext=myContext != null ? mgr.getDataContext(myContext) : mgr.getDataContext();
  if (action instanceof ActionGroup && (!finalChoice || !((ActionGroup)action).canBePerformed(dataContext))) {
    return createActionsStep((ActionGroup)action,dataContext,myEnableMnemonics,true,myShowDisabledActions,null,myContext,false,myPreselectActionCondition,false);
  }
 else {
    myFinalRunnable=new Runnable(){
      @Override public void run(){
        final AnActionEvent event=new AnActionEvent(null,dataContext,ActionPlaces.UNKNOWN,action.getTemplatePresentation().clone(),ActionManager.getInstance(),eventModifiers);
        event.setInjectedContext(action.isInInjectedContext());
        action.actionPerformed(event);
      }
    }
;
    return FINAL_CHOICE;
  }
}
