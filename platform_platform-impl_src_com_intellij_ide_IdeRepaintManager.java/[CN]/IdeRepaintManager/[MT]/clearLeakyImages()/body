{
  if (myImagesMap == null) {
    try {
      Field volMapField=RepaintManager.class.getDeclaredField(FAULTY_FIELD_NAME);
      volMapField.setAccessible(true);
      myImagesMap=new WeakHashMap<GraphicsConfiguration,VolatileImage>();
      @SuppressWarnings("unchecked") Map<GraphicsConfiguration,VolatileImage> map=(Map<GraphicsConfiguration,VolatileImage>)volMapField.get(this);
      if (map != null) {
        myImagesMap.putAll(map);
      }
    }
 catch (    Exception e) {
      LOG.error(e);
    }
  }
  if (myImagesMap.size() > 3) {
    for (    VolatileImage image : myImagesMap.values()) {
      if (image != null) {
        image.flush();
      }
    }
    myImagesMap.clear();
  }
}
