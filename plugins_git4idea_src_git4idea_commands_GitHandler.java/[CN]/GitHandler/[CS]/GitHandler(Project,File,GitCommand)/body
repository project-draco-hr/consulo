{
  myProject=project;
  myCommand=command;
  mySettings=GitVcsSettings.getInstance(project);
  myEnv=new HashMap<String,String>(System.getenv());
  if (!myEnv.containsKey("HOME")) {
    String home=System.getProperty("user.home");
    if (home != null) {
      myEnv.put("HOME",home);
    }
  }
  myVcs=GitVcs.getInstance(project);
  if (myVcs != null) {
    myVcs.checkVersion();
  }
  myWorkingDirectory=directory;
  myCommandLine=new GeneralCommandLine();
  if (mySettings != null) {
    myCommandLine.setExePath(mySettings.getGitExecutable());
  }
  myCommandLine.setWorkingDirectory(myWorkingDirectory);
  if (command.name().length() > 0) {
    myCommandLine.addParameter(command.name());
  }
}
