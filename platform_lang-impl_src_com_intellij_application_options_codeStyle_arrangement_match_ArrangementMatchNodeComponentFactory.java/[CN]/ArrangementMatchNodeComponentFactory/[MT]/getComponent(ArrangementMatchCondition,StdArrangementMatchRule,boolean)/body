{
  final Ref<ArrangementMatchConditionComponent> ref=new Ref<ArrangementMatchConditionComponent>();
  rendererTarget.invite(new ArrangementMatchConditionVisitor(){
    @Override public void visit(    @NotNull ArrangementAtomMatchCondition condition){
      RemoveAtomConditionCallback callback=allowModification ? new RemoveAtomConditionCallback(rule) : null;
      ArrangementMatchConditionComponent component=new ArrangementAtomMatchConditionComponent(myDisplayManager,myColorsProvider,condition,callback);
      ref.set(component);
    }
    @Override public void visit(    @NotNull ArrangementCompositeMatchCondition condition){
      ref.set(new ArrangementAndMatchConditionComponent(rule,condition,ArrangementMatchNodeComponentFactory.this,myDisplayManager));
    }
  }
);
  return ref.get();
}
