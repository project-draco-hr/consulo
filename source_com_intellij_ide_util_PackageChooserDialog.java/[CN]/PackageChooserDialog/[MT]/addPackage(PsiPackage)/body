{
  final String qualifiedPackageName=aPackage.getQualifiedName();
  final PsiPackage parentPackage=aPackage.getParentPackage();
  if (parentPackage == null) {
    final DefaultMutableTreeNode rootNode=(DefaultMutableTreeNode)myModel.getRoot();
    if (qualifiedPackageName.length() == 0) {
      rootNode.setUserObject(aPackage);
      return rootNode;
    }
 else {
      DefaultMutableTreeNode packageNode=findPackageNode(rootNode,qualifiedPackageName);
      if (packageNode != null)       return packageNode;
      packageNode=new DefaultMutableTreeNode(aPackage);
      rootNode.add(packageNode);
      return packageNode;
    }
  }
 else {
    final DefaultMutableTreeNode parentNode=addPackage(parentPackage);
    DefaultMutableTreeNode packageNode=findPackageNode(parentNode,qualifiedPackageName);
    if (packageNode != null) {
      return packageNode;
    }
    packageNode=new DefaultMutableTreeNode(aPackage);
    parentNode.add(packageNode);
    return packageNode;
  }
}
