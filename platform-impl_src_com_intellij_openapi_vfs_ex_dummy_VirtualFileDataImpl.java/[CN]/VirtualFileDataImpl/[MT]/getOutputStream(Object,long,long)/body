{
  final ByteArrayOutputStream out=new ByteArrayOutputStream();
  return new OutputStream(){
    public void write(    int b) throws IOException {
      out.write(b);
    }
    public void write(    byte[] b) throws IOException {
      out.write(b);
    }
    public void write(    byte[] b,    int off,    int len) throws IOException {
      out.write(b,off,len);
    }
    public void flush() throws IOException {
      out.flush();
    }
    public void close() throws IOException {
      out.close();
      final DummyFileSystem fs=(DummyFileSystem)getFileSystem();
      fs.fireBeforeContentsChange(requestor,VirtualFileDataImpl.this);
      final long oldModStamp=myModificationStamp;
      myContents=out.toByteArray();
      myModificationStamp=newModificationStamp >= 0 ? newModificationStamp : LocalTimeCounter.currentTime();
      fs.fireContentsChanged(requestor,VirtualFileDataImpl.this,oldModStamp);
    }
  }
;
}
