{
  super.visitReferenceExpression(expression);
  final PsiType type=expression.getType();
  if (!(type instanceof PsiArrayType)) {
    return;
  }
  final PsiElement parent=expression.getParent();
  if (parent instanceof PsiBinaryExpression) {
    final PsiBinaryExpression binaryExpression=(PsiBinaryExpression)parent;
    final IElementType tokenType=binaryExpression.getOperationTokenType();
    if (!JavaTokenType.PLUS.equals(tokenType)) {
      return;
    }
    final PsiExpression lhs=binaryExpression.getLOperand();
    if (lhs != expression) {
      final PsiType lhsType=lhs.getType();
      if (lhsType == null || !lhsType.equalsToText("java.lang.String")) {
        return;
      }
      registerError(expression);
    }
    final PsiExpression rhs=binaryExpression.getROperand();
    if (rhs != null && rhs != expression) {
      final PsiType rhsType=rhs.getType();
      if (rhsType == null || !rhsType.equalsToText("java.lang.String")) {
        return;
      }
      registerError(expression);
    }
  }
 else   if (parent instanceof PsiExpressionList) {
    final PsiExpressionList expressionList=(PsiExpressionList)parent;
    final PsiElement grandParent=expressionList.getParent();
    if (!(grandParent instanceof PsiMethodCallExpression)) {
      return;
    }
    final PsiMethodCallExpression methodCallExpression=(PsiMethodCallExpression)grandParent;
    final PsiReferenceExpression methodExpression=methodCallExpression.getMethodExpression();
    final String methodName=methodExpression.getReferenceName();
    if (!"print".equals(methodName) && !"println".equals(methodName)) {
      return;
    }
    final PsiExpression qualifier=methodExpression.getQualifierExpression();
    if (!TypeUtils.expressionHasTypeOrSubtype("java.io.PrintStream",qualifier)) {
      return;
    }
    registerError(expression);
  }
}
