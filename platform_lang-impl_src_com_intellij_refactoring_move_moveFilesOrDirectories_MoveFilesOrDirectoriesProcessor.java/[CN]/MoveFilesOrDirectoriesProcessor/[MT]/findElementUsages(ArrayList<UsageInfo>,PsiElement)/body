{
  if (!mySearchForReferences) {
    return;
  }
  if (element instanceof PsiFile) {
    final List<UsageInfo> usages=MoveFileHandler.forElement((PsiFile)element).findUsages(((PsiFile)element),myNewParent,mySearchInComments,mySearchInNonJavaFiles);
    if (usages != null) {
      result.addAll(usages);
      myFoundUsages.put((PsiFile)element,usages);
    }
  }
 else   if (element instanceof PsiDirectory) {
    for (    PsiElement childElement : element.getChildren()) {
      findElementUsages(result,childElement);
    }
  }
}
