{
  GlobalInspectionContextImpl.FIND_EXTERNAL_USAGES.setTotalAmount(getRequestCount() * 2);
  do {
    processSearchRequests(context);
    InspectionProfileEntry[] requestors=needRepeatSearchRequest.toArray(new InspectionProfileEntry[needRepeatSearchRequest.size()]);
    for (    InspectionProfileEntry requestor : requestors) {
      if (requestor instanceof InspectionTool && !((InspectionTool)requestor).queryExternalUsagesRequests(InspectionManagerEx.getInstance(context.getProject()))) {
        needRepeatSearchRequest.remove(requestor);
      }
    }
    int oldSearchRequestCount=GlobalInspectionContextImpl.FIND_EXTERNAL_USAGES.getTotalAmount();
    float proportion=GlobalInspectionContextImpl.FIND_EXTERNAL_USAGES.getProgress();
    int totalAmount=oldSearchRequestCount + getRequestCount() * 2;
    GlobalInspectionContextImpl.FIND_EXTERNAL_USAGES.setTotalAmount(totalAmount);
    GlobalInspectionContextImpl.FIND_EXTERNAL_USAGES.setDoneAmount((int)(totalAmount * proportion));
  }
 while (!needRepeatSearchRequest.isEmpty());
}
