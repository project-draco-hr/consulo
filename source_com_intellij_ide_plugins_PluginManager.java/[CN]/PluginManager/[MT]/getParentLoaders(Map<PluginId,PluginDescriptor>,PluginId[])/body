{
  if (ApplicationManager.getApplication().isUnitTestMode())   return new ClassLoader[0];
  final List<ClassLoader> classLoaders=new ArrayList<ClassLoader>();
  for (  final PluginId id : pluginIds) {
    PluginDescriptor pluginDescriptor=idToDescriptorMap.get(id);
    if (pluginDescriptor == null) {
      getLogger().assertTrue(false,"Plugin not found: " + id);
    }
    final ClassLoader loader=pluginDescriptor.getLoader();
    if (loader == null) {
      getLogger().assertTrue(false,"Plugin class loader should be initialized for plugin " + id);
    }
    classLoaders.add(loader);
  }
  return classLoaders.toArray(new ClassLoader[classLoaders.size()]);
}
