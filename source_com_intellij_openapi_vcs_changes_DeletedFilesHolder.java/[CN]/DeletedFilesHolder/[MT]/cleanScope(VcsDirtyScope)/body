{
  ApplicationManager.getApplication().runReadAction(new Runnable(){
    public void run(){
      final List<File> currentFiles=new ArrayList<File>(myFiles);
      VcsContextFactory vcsContextFactory=PeerFactory.getInstance().getVcsContextFactory();
      for (      File file : currentFiles) {
        FilePath path;
        File parentFile=file.getParentFile();
        VirtualFile vFile=LocalFileSystem.getInstance().findFileByIoFile(parentFile);
        if (vFile == null) {
          path=vcsContextFactory.createFilePathOn(file);
        }
 else {
          path=vcsContextFactory.createFilePathOn(vFile,file.getName());
        }
        if (scope.belongsTo(path)) {
          myFiles.remove(file);
        }
      }
    }
  }
);
}
