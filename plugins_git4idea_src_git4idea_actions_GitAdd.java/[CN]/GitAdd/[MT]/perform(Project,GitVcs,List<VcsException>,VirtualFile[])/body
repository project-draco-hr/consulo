{
  saveAll();
  if (!ProjectLevelVcsManager.getInstance(project).checkAllFilesAreUnder(GitVcs.getInstance(project),affectedFiles))   return false;
  return toBackground(project,vcs,affectedFiles,exceptions,new Consumer<ProgressIndicator>(){
    public void consume(    ProgressIndicator indicator){
      try {
        addFiles(project,affectedFiles,indicator);
      }
 catch (      VcsException e) {
        exceptions.add(e);
      }
    }
  }
);
}
