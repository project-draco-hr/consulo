{
  final Map<VirtualFile,List<VirtualFile>> roots=GitUtil.sortFilesByGitRoot(Arrays.asList(files));
  for (  Map.Entry<VirtualFile,List<VirtualFile>> entry : roots.entrySet()) {
    GitFileUtils.addFiles(project,entry.getKey(),entry.getValue());
  }
  VcsDirtyScopeManager mgr=VcsDirtyScopeManager.getInstance(project);
  for (  VirtualFile file : files) {
    mgr.fileDirty(file);
    file.refresh(true,true);
  }
}
