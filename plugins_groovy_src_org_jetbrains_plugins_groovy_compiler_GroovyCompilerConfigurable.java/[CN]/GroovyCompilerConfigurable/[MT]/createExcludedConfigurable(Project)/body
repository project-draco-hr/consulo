{
  final ExcludedEntriesConfiguration configuration=myConfig.getExcludeFromStubGeneration();
  final ProjectFileIndex index=ProjectRootManager.getInstance(project).getFileIndex();
  final FileChooserDescriptor descriptor=new FileChooserDescriptor(true,true,false,false,false,true){
    public boolean isFileVisible(    VirtualFile file,    boolean showHiddenFiles){
      return super.isFileVisible(file,showHiddenFiles) && !index.isIgnored(file);
    }
  }
;
  for (  final Module module : ModuleManager.getInstance(project).getModules()) {
    for (    VirtualFile file : ModuleRootManager.getInstance(module).getSourceRoots()) {
      descriptor.addRoot(file);
    }
  }
  return new ExcludedEntriesConfigurable(project,descriptor,configuration);
}
