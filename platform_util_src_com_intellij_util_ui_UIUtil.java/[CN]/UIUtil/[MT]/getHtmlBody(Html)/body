{
  String text=html.getText();
  String result;
  if (!text.startsWith("<html>")) {
    result=text.replaceAll("\n","<br>");
  }
 else {
    final int bodyIdx=text.indexOf("<body>");
    final int closedBodyIdx=text.indexOf("</body>");
    if (bodyIdx != -1 && closedBodyIdx != -1) {
      result=text.substring(bodyIdx + "<body>".length(),closedBodyIdx);
    }
 else {
      text=StringUtil.trimStart(text,"<html>").trim();
      text=StringUtil.trimEnd(text,"</html>").trim();
      text=StringUtil.trimStart(text,"<body>").trim();
      text=StringUtil.trimEnd(text,"</body>").trim();
      result=text;
    }
  }
  return html.isKeepFont() ? result : result.replaceAll("<font(.*?)>","").replaceAll("</font>","");
}
