{
  Set<String> conflictDescriptions=new HashSet<String>();
  UsageInfo[] usagesIn=refUsages.get();
  conflictDescriptions.addAll(Arrays.asList(RenameUtil.getConflictDescriptions(usagesIn)));
  Set<UsageInfo> usagesSet=new HashSet<UsageInfo>(Arrays.asList(usagesIn));
  RenameUtil.removeConflictUsages(usagesSet);
  if (myChangeInfo.isVisibilityChanged) {
    try {
      addInaccessibilityDescriptions(usagesSet,conflictDescriptions);
    }
 catch (    IncorrectOperationException e) {
      LOG.error(e);
    }
  }
  if (myPrepareSuccessfulSwingThreadCallback != null && conflictDescriptions.size() > 0) {
    ConflictsDialog dialog=new ConflictsDialog(conflictDescriptions.toArray(new String[conflictDescriptions.size()]),myProject);
    dialog.show();
    if (!dialog.isOK())     return false;
  }
  if (myChangeInfo.isReturnTypeChanged) {
    askToRemoveCovariantOverriders(usagesSet);
  }
  refUsages.set(usagesSet.toArray(new UsageInfo[usagesSet.size()]));
  prepareSuccessful();
  return true;
}
