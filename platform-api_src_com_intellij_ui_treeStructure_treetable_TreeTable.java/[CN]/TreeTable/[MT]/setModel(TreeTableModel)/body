{
  if (myTree != null) {
    myTree.removePropertyChangeListener(JTree.ROW_HEIGHT_PROPERTY,myTreeRowHeightPropertyListener);
  }
  myTree=new TreeTableTree(treeTableModel,this);
  if (myTree.getRowHeight() != getRowHeight()) {
    setRowHeight(myTree.getRowHeight());
  }
  myTreeRowHeightPropertyListener=new PropertyChangeListener(){
    public void propertyChange(    PropertyChangeEvent evt){
      int treeRowHeight=myTree.getRowHeight();
      if (treeRowHeight == getRowHeight() - 3)       return;
      setRowHeight(treeRowHeight);
    }
  }
;
  myTree.addPropertyChangeListener(JTree.ROW_HEIGHT_PROPERTY,myTreeRowHeightPropertyListener);
  setTableModel(treeTableModel);
  ListToTreeSelectionModelWrapper selectionWrapper=new ListToTreeSelectionModelWrapper();
  myTree.setSelectionModel(selectionWrapper);
  setSelectionModel(selectionWrapper.getListSelectionModel());
  TreeTableCellRenderer treeTableCellRenderer=createTableRenderer(treeTableModel);
  setDefaultRenderer(TreeTableModel.class,treeTableCellRenderer);
  setDefaultEditor(TreeTableModel.class,new TreeTableCellEditor(treeTableCellRenderer));
  setShowGrid(false);
  setIntercellSpacing(new Dimension(0,0));
  if (myTree.getRowHeight() < 1) {
    setRowHeight(18);
  }
  setRowHeight(getRowHeight());
}
