{
  if (myDragCancelled)   return;
  if (!isDraggingNow()) {
    if (myPressedPoint == null)     return;
    if (isWithinDeadZone(e))     return;
    myDragPane=findLayeredPane(e);
    if (myDragPane == null)     return;
    final BufferedImage image=new BufferedImage(getWidth(),getHeight(),BufferedImage.TYPE_INT_ARGB);
    paint(image.getGraphics());
    myDragButtonImage=new JLabel(new ImageIcon(image)){
      public String toString(){
        return "Image for: " + StripeButton.this.toString();
      }
    }
;
    myDragPane.add(myDragButtonImage,JLayeredPane.POPUP_LAYER);
    myDragButtonImage.setSize(myDragButtonImage.getPreferredSize());
    setVisible(false);
    myPane.startDrag();
    myDragKeyEventDispatcher=new DragKeyEventDispatcher();
    KeyboardFocusManager.getCurrentKeyboardFocusManager().addKeyEventDispatcher(myDragKeyEventDispatcher);
  }
  if (!isDraggingNow())   return;
  Point xy=SwingUtilities.convertPoint(e.getComponent(),e.getPoint(),myDragPane);
  if (myPressedPoint != null) {
    xy.x-=myPressedPoint.x;
    xy.y-=myPressedPoint.y;
  }
  myDragButtonImage.setLocation(xy);
  SwingUtilities.convertPointToScreen(xy,myDragPane);
  final Stripe stripe=myPane.getStripeFor(new Rectangle(xy,myDragButtonImage.getSize()),(Stripe)getParent());
  if (stripe == null) {
    if (myLastStripe != null) {
      myLastStripe.resetDrop();
    }
  }
 else {
    if (myLastStripe != null && myLastStripe != stripe) {
      myLastStripe.resetDrop();
    }
    stripe.processDropButton(this,myDragButtonImage,xy);
  }
  myLastStripe=stripe;
}
