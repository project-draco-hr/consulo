{
  if (!checkReadonlyUsages())   return;
  PsiDocumentManager.getInstance(myProject).commitAllDocuments();
  if (myCannotMakeString != null && myChangesDetected) {
    if (canPerformReRun() && allTargetsAreValid()) {
      int answer=Messages.showYesNoDialog(myProject,myCannotMakeString + "\n" + UsageViewBundle.message("dialog.rerun.search"),UsageViewBundle.message("error.common.title"),Messages.getErrorIcon());
      if (answer == 0) {
        refreshUsages();
      }
    }
 else {
      Messages.showMessageDialog(myProject,myCannotMakeString,UsageViewBundle.message("error.common.title"),Messages.getErrorIcon());
    }
    return;
  }
  close();
  CommandProcessor.getInstance().executeCommand(myProject,new Runnable(){
    public void run(){
      myProcessRunnable.run();
    }
  }
,myCommandName,null);
}
