{
  if (!checkReadonlyUsages())   return;
  PsiDocumentManager.getInstance(myProject).commitAllDocuments();
  if (myCannotMakeString != null && myChangesDetected) {
    String title=UsageViewBundle.message("changes.detected.error.title");
    if (canPerformReRun() && allTargetsAreValid()) {
      String[] options={UsageViewBundle.message("action.description.rerun"),UsageViewBundle.message("usage.view.cancel.button")};
      String message=myCannotMakeString + "\n\n" + UsageViewBundle.message("dialog.rerun.search");
      int answer=Messages.showOkCancelDialog(myProject,message,title,options[0],options[1],Messages.getErrorIcon());
      if (answer == 0) {
        refreshUsages();
      }
    }
 else {
      Messages.showMessageDialog(myProject,myCannotMakeString,title,Messages.getErrorIcon());
    }
    return;
  }
  close();
  CommandProcessor.getInstance().executeCommand(myProject,new Runnable(){
    @Override public void run(){
      myProcessRunnable.run();
    }
  }
,myCommandName,null);
}
