{
  if (node instanceof Node && node != getModelRoot()) {
    ((Node)node).update(this);
  }
  if (myTree.isCollapsed(path)) {
    if (node instanceof Node) {
      ((Node)node).markNeedUpdate();
    }
    return;
  }
  for (int i=0; i < node.getChildCount(); i++) {
    TreeNode child=node.getChildAt(i);
    checkNodeValidity(child,path.pathByAddingChild(child));
  }
}
