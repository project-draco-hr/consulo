{
  if (!(o instanceof GroovyResolveResult)) {
    LOG.error(o);
    return;
  }
  GroovyResolveResult result=(GroovyResolveResult)o;
  if (!result.isStaticsOK())   return;
  if (!result.isAccessible() && myParameters.getInvocationCount() < 2)   return;
  if (mySkipPackages && result.getElement() instanceof PsiJavaPackage)   return;
  PsiElement element=result.getElement();
  if (element instanceof PsiVariable && !myMatcher.prefixMatches(((PsiVariable)element).getName())) {
    return;
  }
  if (element instanceof GrReflectedMethod) {
    element=((GrReflectedMethod)element).getBaseMethod();
    if (!myProcessedMethodWithOptionalParams.add((GrMethod)element))     return;
    result=new GroovyResolveResultImpl(element,result.getCurrentFileResolveContext(),result.getSpreadState(),result.getSubstitutor(),result.isAccessible(),result.isStaticsOK(),result.isInvokedOnProperty());
  }
  if (myFieldPointerOperator && !(element instanceof PsiVariable)) {
    return;
  }
  if (myMethodPointerOperator && !(element instanceof PsiMethod)) {
    return;
  }
  addCandidate(result);
  if (!myFieldPointerOperator && !myMethodPointerOperator) {
    if (element instanceof PsiMethod) {
      processProperty((PsiMethod)element,result);
    }
 else     if (element instanceof GrField) {
      if (((GrField)element).isProperty()) {
        processPropertyFromField((GrField)element,result);
      }
    }
  }
  if (element instanceof GrVariable && !(element instanceof GrField)) {
    myLocalVars.add(((GrVariable)element).getName());
  }
}
