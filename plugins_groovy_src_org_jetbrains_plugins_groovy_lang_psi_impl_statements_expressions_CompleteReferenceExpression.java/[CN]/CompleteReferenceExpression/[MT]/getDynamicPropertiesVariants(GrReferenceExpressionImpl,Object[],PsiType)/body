{
  final PsiFile containingFile=refExpr.getContainingFile();
  final PsiFile originalFile=containingFile.getOriginalFile();
  if (originalFile == null) {
    return propertyVariants;
  }
  final VirtualFile virtualFile=originalFile.getVirtualFile();
  if (virtualFile == null) {
    return propertyVariants;
  }
  Module module=ProjectRootManager.getInstance(refExpr.getProject()).getFileIndex().getModuleForFile(virtualFile);
  if (module == null) {
    return propertyVariants;
  }
  if (type == null) {
    return propertyVariants;
  }
  if (type instanceof PsiClassType) {
    final PsiClass psiClass=((PsiClassType)type).resolve();
    if (psiClass == null) {
      return propertyVariants;
    }
    for (    PsiClass aSuper : PsiUtil.iterateSupers(psiClass,true)) {
      String[] dynamicPropertiesOfClass=DynamicManager.getInstance(refExpr.getProject()).getPropertiesNamesOfClass(aSuper.getQualifiedName());
      propertyVariants=ArrayUtil.mergeArrays(propertyVariants,dynamicPropertiesOfClass,Object.class);
    }
  }
  return propertyVariants;
}
