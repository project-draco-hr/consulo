{
  GrExpression qualifier=refExpr.getQualifierExpression();
  if (qualifier == null) {
    ResolveUtil.treeWalkUp(refExpr,processor);
    qualifier=PsiImplUtil.getRuntimeQualifier(refExpr);
    if (qualifier != null)     getVariantsFromQualifier(refExpr,processor,qualifier);
  }
 else {
    if (refExpr.getDotTokenType() != GroovyTokenTypes.mSPREAD_DOT) {
      getVariantsFromQualifier(refExpr,processor,qualifier);
    }
 else {
      getVariantsFromQualifierForSpreadOperator(refExpr,processor,qualifier);
    }
  }
  GroovyResolveResult[] candidates=processor.getCandidates();
  if (candidates.length == 0)   return PsiNamedElement.EMPTY_ARRAY;
  PsiElement[] elements=ResolveUtil.mapToElements(candidates);
  String[] properties=addPretendedProperties(elements);
  final Object[] variants=GroovyCompletionUtil.getCompletionVariants(candidates);
  return ArrayUtil.mergeArrays(variants,properties,Object.class);
}
