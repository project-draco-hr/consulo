{
  PsiElement scope=DfaUtil.getTopmostBlockInSameClass(forPlace);
  if (scope == null) {
    return Collections.emptyMap();
  }
  DataFlowRunner runner=new DataFlowRunner(){
    protected DfaMemoryState createMemoryState(){
      return new ExpressionTypeMemoryState(getFactory());
    }
  }
;
  final ExpressionTypeInstructionVisitor visitor=new ExpressionTypeInstructionVisitor(forPlace);
  if (runner.analyzeMethod(scope,visitor) == RunnerResult.OK) {
    final Map<PsiExpression,PsiType> map=visitor.getResult();
    if (map != null) {
      return map;
    }
  }
  return Collections.emptyMap();
}
