{
  if (SwingUtilities.isEventDispatchThread()) {
    LookupManager.getInstance(getProject()).hideActiveLookup();
    UIUtil.dispatchAllInvocationEvents();
  }
 else {
    ApplicationManager.getApplication().invokeAndWait(new Runnable(){
      @Override public void run(){
        LookupManager.getInstance(getProject()).hideActiveLookup();
      }
    }
,ModalityState.NON_MODAL);
    UIUtil.pump();
  }
  ((StatisticsManagerImpl)StatisticsManager.getInstance()).clearStatistics();
  FileEditorManager editorManager=FileEditorManager.getInstance(getProject());
  VirtualFile[] openFiles=editorManager.getOpenFiles();
  for (  VirtualFile openFile : openFiles) {
    editorManager.closeFile(openFile);
  }
  if (toInitializeDaemon) {
    ((DaemonCodeAnalyzerImpl)DaemonCodeAnalyzer.getInstance(getProject())).cleanupAfterTest(!LightPlatformTestCase.isLight(getProject()));
  }
  myEditor=null;
  myFile=null;
  myPsiManager=null;
  myInspections=null;
  myAvailableLocalTools.clear();
  myAvailableTools.clear();
  myProjectFixture.tearDown();
  myTempDirFixture.tearDown();
  super.tearDown();
}
