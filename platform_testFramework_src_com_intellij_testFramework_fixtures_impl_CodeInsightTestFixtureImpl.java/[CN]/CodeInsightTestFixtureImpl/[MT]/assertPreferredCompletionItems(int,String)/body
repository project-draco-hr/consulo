{
  final LookupImpl lookup=getLookup();
  assertNotNull(lookup);
  final LinkedHashMap<LookupElement,StringBuilder> relevanceStrings=lookup.getRelevanceStrings();
  final JList list=lookup.getList();
  final List<LookupElement> model=lookup.getItems();
  final List<String> actual=new ArrayList<String>();
  final int count=lookup.getPreferredItemsCount();
  for (int i=0; i < count; i++) {
    actual.add(model.get(i).getLookupString());
  }
  if (!actual.equals(Arrays.asList(expected))) {
    final List<String> strings=new ArrayList<String>();
    for (int i=0; i < model.size(); i++) {
      final LookupElement item=model.get(i);
      strings.add(item.getLookupString() + " " + relevanceStrings.get(item));
      if (i == count - 1) {
        strings.add("---");
      }
    }
    assertOrderedEquals(strings,expected);
  }
  assertEquals(selected,list.getSelectedIndex());
}
