{
  if (!(aClass.getParent() instanceof PsiJavaFile) || ((PsiJavaFile)aClass.getParent()).getClasses().length > 1) {
    addToFold(list,aClass,document,true);
  }
  PsiDocComment docComment;
  if (foldJavaDocs) {
    docComment=aClass.getDocComment();
    if (docComment != null) {
      addToFold(list,docComment,document,true);
    }
  }
  addAnnotationsToFold(aClass.getModifierList(),list,document);
  PsiElement[] children=aClass.getChildren();
  for (  PsiElement child : children) {
    ProgressManager.getInstance().checkCanceled();
    if (child instanceof PsiMethod) {
      PsiMethod method=(PsiMethod)child;
      addToFold(list,method,document,true);
      addAnnotationsToFold(method.getModifierList(),list,document);
      if (foldJavaDocs) {
        docComment=method.getDocComment();
        if (docComment != null) {
          addToFold(list,docComment,document,true);
        }
      }
      PsiCodeBlock body=method.getBody();
      if (body != null) {
        findClasses(body,list,document);
      }
    }
 else     if (child instanceof PsiField) {
      PsiField field=(PsiField)child;
      if (foldJavaDocs) {
        docComment=field.getDocComment();
        if (docComment != null) {
          addToFold(list,docComment,document,true);
        }
      }
      addAnnotationsToFold(field.getModifierList(),list,document);
      PsiExpression initializer=field.getInitializer();
      if (initializer != null) {
        findClasses(initializer,list,document);
      }
 else       if (field instanceof PsiEnumConstant) {
        findClasses(field,list,document);
      }
    }
 else     if (child instanceof PsiClassInitializer) {
      PsiClassInitializer initializer=(PsiClassInitializer)child;
      addToFold(list,initializer,document,true);
      findClasses(initializer,list,document);
    }
 else     if (child instanceof PsiClass) {
      addElementsToFold(list,(PsiClass)child,document,true);
    }
  }
}
