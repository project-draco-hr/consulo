{
  final PsiElement element=SourceTreeToPsiMap.treeElementToPsi(node);
  if (!(element instanceof PsiJavaFile)) {
    return FoldingDescriptor.EMPTY;
  }
  PsiJavaFile file=(PsiJavaFile)element;
  List<FoldingDescriptor> result=new ArrayList<FoldingDescriptor>();
  PsiImportList importList=file.getImportList();
  if (importList != null) {
    PsiImportStatementBase[] statements=importList.getAllImportStatements();
    if (statements.length > 1) {
      final TextRange rangeToFold=getRangeToFold(importList);
      if (rangeToFold != null) {
        result.add(new FoldingDescriptor(importList.getNode(),rangeToFold));
      }
    }
  }
  PsiClass[] classes=file.getClasses();
  for (  PsiClass aClass : classes) {
    ProgressManager.getInstance().checkCanceled();
    addElementsToFold(result,aClass,document,true);
  }
  TextRange range=getFileHeader(file);
  if (range != null && document.getLineNumber(range.getEndOffset()) > document.getLineNumber(range.getStartOffset())) {
    result.add(new FoldingDescriptor(file.getNode(),range));
  }
  return result.toArray(new FoldingDescriptor[result.size()]);
}
