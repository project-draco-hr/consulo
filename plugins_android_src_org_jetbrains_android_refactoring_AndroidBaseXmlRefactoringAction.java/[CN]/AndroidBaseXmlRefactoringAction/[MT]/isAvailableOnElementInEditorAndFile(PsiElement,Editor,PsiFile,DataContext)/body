{
  final XmlTag[] tags=getXmlTagsFromExternalContext(context);
  if (tags.length > 0) {
    return AndroidFacet.getInstance(tags[0]) != null && isEnabledForTags(tags);
  }
  final TextRange range=getNonEmptySelectionRange(editor);
  if (range != null) {
    final Pair<PsiElement,PsiElement> psiRange=getExtractableRange(file,range.getStartOffset(),range.getEndOffset());
    return psiRange != null && isEnabledForPsiRange(psiRange.getFirst(),psiRange.getSecond());
  }
  if (element == null || AndroidFacet.getInstance(element) == null || PsiTreeUtil.getParentOfType(element,XmlText.class) != null) {
    return false;
  }
  final XmlTag tag=PsiTreeUtil.getParentOfType(element,XmlTag.class);
  return tag != null && isEnabledForTags(new XmlTag[]{tag});
}
