{
  final DataContext context=e.getDataContext();
  final DataContext patchedContext=new DataContext(){
    @Override public Object getData(    @NonNls String dataId){
      final Object data=context.getData(dataId);
      if (data != null) {
        return data;
      }
      if (LangDataKeys.PSI_ELEMENT.is(dataId)) {
        final XmlTag[] tags=getXmlTagsFromExternalContext(context);
        return tags.length == 1 ? tags[0] : null;
      }
 else       if (LangDataKeys.PSI_ELEMENT_ARRAY.is(dataId)) {
        return getXmlTagsFromExternalContext(context);
      }
      return null;
    }
  }
;
  super.update(new AnActionEvent(e.getInputEvent(),patchedContext,e.getPlace(),e.getPresentation(),e.getActionManager(),e.getModifiers()));
}
