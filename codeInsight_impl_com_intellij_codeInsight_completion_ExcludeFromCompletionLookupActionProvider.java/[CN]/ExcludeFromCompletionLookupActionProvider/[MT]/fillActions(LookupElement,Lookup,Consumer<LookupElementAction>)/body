{
  final Object o=element.getObject();
  PsiClass clazz=null;
  if (o instanceof PsiType) {
    clazz=PsiUtil.resolveClassInType((PsiType)o);
  }
 else   if (o instanceof PsiClass) {
    clazz=(PsiClass)o;
  }
  if (clazz != null && clazz.isValid()) {
    final String qname=clazz.getQualifiedName();
    if (qname != null) {
      final Project project=clazz.getProject();
      for (      final String s : AddImportAction.getAllExcludableStrings(qname)) {
        consumer.consume(new ExcludeFromCompletionAction(project,s));
      }
    }
  }
}
