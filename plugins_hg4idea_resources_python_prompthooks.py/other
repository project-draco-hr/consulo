from mercurial import filemerge, ui, util, dispatch
from mercurial.node import short
import sys, struct, socket
if getattr(ui.ui, 'promptchoice', None):

    @monkeypatch_method(ui.ui)
    def promptchoice(self, msg, choices=None, default=0):
        return sendchangestoidea(self, msg, choices, default)
else:

    @monkeypatch_method(ui.ui)
    def prompt(self, msg, choices=None, default='y'):
        resps = [s[(s.index('&') + 1)].lower() for s in choices]
        defaultIndex = resps.index(default)
        responseIndex = sendchangestoidea(self, msg, choices, defaultIndex)
        return resps[responseIndex]
original_warn = ui.ui.warn
