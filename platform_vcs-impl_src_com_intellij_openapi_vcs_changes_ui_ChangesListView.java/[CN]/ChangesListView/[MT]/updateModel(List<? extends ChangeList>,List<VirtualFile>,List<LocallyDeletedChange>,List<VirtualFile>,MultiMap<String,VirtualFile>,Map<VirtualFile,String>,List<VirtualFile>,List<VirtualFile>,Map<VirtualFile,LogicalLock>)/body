{
  storeState();
  TreeModelBuilder builder=new TreeModelBuilder(myProject,isShowFlatten());
  final DefaultTreeModel model=builder.buildModel(changeLists,unversionedFiles,locallyDeletedFiles,modifiedWithoutEditing,switchedFiles,switchedRoots,ignoredFiles,lockedFolders,logicallyLockedFiles);
  setModel(model);
  setCellRenderer(new ChangesBrowserNodeRenderer(myProject,isShowFlatten(),true));
  expandPath(new TreePath(((ChangesBrowserNode)model.getRoot()).getPath()));
  restoreState();
}
