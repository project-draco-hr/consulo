{
  if (exprText == null)   return null;
  if (psiVariable == null || !psiVariable.isValid())   return null;
  final PsiElement refVariableElement=containingFile.findElementAt(marker.getStartOffset());
  PsiExpression expression=PsiTreeUtil.getParentOfType(refVariableElement,PsiReferenceExpression.class);
  if (expression instanceof PsiReferenceExpression && (((PsiReferenceExpression)expression).resolve() == psiVariable || Comparing.strEqual(psiVariable.getName(),((PsiReferenceExpression)expression).getReferenceName()))) {
    return (PsiExpression)expression.replace(elementFactory.createExpressionFromText(exprText,psiVariable));
  }
  if (expression == null) {
    expression=PsiTreeUtil.getParentOfType(refVariableElement,PsiExpression.class);
  }
  if (expression instanceof PsiReferenceExpression && expression.getParent() instanceof PsiMethodCallExpression) {
    expression=(PsiExpression)expression.getParent();
  }
  return expression != null && expression.isValid() && expression.getText().equals(exprText) ? expression : null;
}
