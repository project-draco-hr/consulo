{
  super(project,editor,expr,localVariable,occurrences,title);
  myTypeSelectorManager=typeSelectorManager;
  myTypeSelector=myTypeSelectorManager.getTypeSelector();
  JComponent component=myTypeSelector.getComponent();
  if (component instanceof JComboBox) {
    ((JComboBox)component).addActionListener(new ActionListener(){
      @Override public void actionPerformed(      ActionEvent e){
        final PsiVariable variable=getVariable();
        if (variable != null) {
          new WriteCommandAction(project,getCommandName(),getCommandName()){
            @Override protected void run(            com.intellij.openapi.application.Result result) throws Throwable {
              variable.getTypeElement().replace(JavaPsiFacade.getElementFactory(myProject).createTypeElement(myTypeSelector.getSelectedType()));
            }
          }
.execute();
          updateTitle(variable);
        }
      }
    }
);
  }
}
