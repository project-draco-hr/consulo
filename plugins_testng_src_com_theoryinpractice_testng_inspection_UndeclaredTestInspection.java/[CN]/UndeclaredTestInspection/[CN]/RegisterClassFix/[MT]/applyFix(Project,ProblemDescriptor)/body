{
  final PsiClass psiClass=PsiTreeUtil.getParentOfType(descriptor.getPsiElement(),PsiClass.class);
  LOG.assertTrue(psiClass != null);
  SwingUtilities.invokeLater(new Runnable(){
    public void run(){
      final String testngXmlPath=new SuiteBrowser(project).showDialog();
      if (testngXmlPath == null)       return;
      final VirtualFile virtualFile=LocalFileSystem.getInstance().findFileByPath(testngXmlPath);
      LOG.assertTrue(virtualFile != null);
      final PsiFile psiFile=PsiManager.getInstance(project).findFile(virtualFile);
      LOG.assertTrue(psiFile instanceof XmlFile);
      final XmlFile testngXML=(XmlFile)psiFile;
      new WriteCommandAction(project,getName(),testngXML){
        protected void run(        final Result result) throws Throwable {
          patchTestngXml(testngXML,psiClass);
        }
      }
.execute();
    }
  }
);
}
