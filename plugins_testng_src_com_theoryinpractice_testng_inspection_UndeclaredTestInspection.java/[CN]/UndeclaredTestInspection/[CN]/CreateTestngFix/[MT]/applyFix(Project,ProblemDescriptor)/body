{
  final PsiClass psiClass=PsiTreeUtil.getParentOfType(descriptor.getPsiElement(),PsiClass.class);
  SwingUtilities.invokeLater(new Runnable(){
    public void run(){
      final VirtualFile[] files=FileChooser.chooseFiles(project,new FileChooserDescriptor(false,true,false,false,false,false));
      if (files.length == 1) {
        final PsiManager psiManager=PsiManager.getInstance(project);
        final PsiDirectory directory=psiManager.findDirectory(files[0]);
        LOG.assertTrue(directory != null);
        new WriteCommandAction(project,getName(),null){
          protected void run(          final Result result) throws Throwable {
            XmlFile testngXml=(XmlFile)psiManager.getElementFactory().createFileFromText("testng.xml","<!DOCTYPE suite SYSTEM \"http://testng.org/testng-1.0.dtd\">\n<suite></suite>");
            try {
              testngXml=(XmlFile)directory.add(testngXml);
            }
 catch (            IncorrectOperationException e) {
              return;
            }
            patchTestngXml(testngXml,psiClass);
          }
        }
.execute();
      }
    }
  }
);
}
