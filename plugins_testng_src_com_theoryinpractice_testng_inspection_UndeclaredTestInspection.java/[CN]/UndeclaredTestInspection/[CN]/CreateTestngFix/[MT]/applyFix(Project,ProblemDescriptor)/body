{
  final PsiClass psiClass=PsiTreeUtil.getParentOfType(descriptor.getPsiElement(),PsiClass.class);
  SwingUtilities.invokeLater(new Runnable(){
    public void run(){
      final VirtualFile file=FileChooser.chooseFile(project,FileChooserDescriptorFactory.createSingleFolderDescriptor());
      if (file != null) {
        final PsiManager psiManager=PsiManager.getInstance(project);
        final PsiDirectory directory=psiManager.findDirectory(file);
        LOG.assertTrue(directory != null);
        new WriteCommandAction(project,getName(),null){
          protected void run(          final Result result) throws Throwable {
            XmlFile testngXml=(XmlFile)PsiFileFactory.getInstance(psiManager.getProject()).createFileFromText("testng.xml","<!DOCTYPE suite SYSTEM \"http://testng.org/testng-1.0.dtd\">\n<suite></suite>");
            try {
              testngXml=(XmlFile)directory.add(testngXml);
            }
 catch (            IncorrectOperationException e) {
              return;
            }
            patchTestngXml(testngXml,psiClass);
          }
        }
.execute();
      }
    }
  }
);
}
