{
  final ASTNode firstEncodedElement=policy.encodeXmlTextContents(s,this);
  if (firstEncodedElement == null) {
    delete();
    return;
  }
  final PomModel model=PomManager.getModel(getProject());
  final XmlAspect aspect=model.getModelAspect(XmlAspect.class);
  model.runTransaction(new PomTransactionBase(this,aspect){
    public PomModelEvent runInner(){
      final String oldText=getText();
      replaceAllChildrenToChildrenOf(firstEncodedElement.getTreeParent());
      clearCaches();
      return XmlTextChangedImpl.createXmlTextChanged(model,XmlTextImpl.this,oldText);
    }
  }
);
}
