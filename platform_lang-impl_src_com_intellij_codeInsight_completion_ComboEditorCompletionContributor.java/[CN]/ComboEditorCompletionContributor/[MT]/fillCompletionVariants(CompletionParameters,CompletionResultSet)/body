{
  final PsiFile file=parameters.getOriginalFile();
  final Document document=PsiDocumentManager.getInstance(file.getProject()).getDocument(file);
  if (document != null) {
    final JComboBox comboBox=document.getUserData(StringComboboxEditor.COMBO_BOX_KEY);
    if (comboBox != null) {
      final CompletionResultSet resultSet=result.withPrefixMatcher(document.getText().substring(0,parameters.getOffset()));
      final int count=comboBox.getItemCount();
      for (int i=0; i < count; i++) {
        final Object o=comboBox.getItemAt(i);
        if (o instanceof String) {
          resultSet.addElement(LookupElementFactoryImpl.getInstance().createLookupElement((String)o).setPriority(count - i).setInsertHandler(new InsertHandler<LookupElement>(){
            public void handleInsert(            final InsertionContext context,            final LookupElement item){
              final Document document=context.getEditor().getDocument();
              document.deleteString(context.getEditor().getCaretModel().getOffset(),document.getTextLength());
            }
          }
));
        }
      }
      result.stopHere();
    }
  }
}
