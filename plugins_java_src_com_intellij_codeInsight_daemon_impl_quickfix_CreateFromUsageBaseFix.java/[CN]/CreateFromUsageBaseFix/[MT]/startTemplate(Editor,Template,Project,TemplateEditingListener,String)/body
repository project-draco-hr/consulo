{
  Runnable runnable=new Runnable(){
    @Override public void run(){
      if (project.isDisposed() || editor.isDisposed())       return;
      CommandProcessor.getInstance().executeCommand(project,new Runnable(){
        @Override public void run(){
          TemplateManager.getInstance(project).startTemplate(editor,template,listener);
        }
      }
,commandName,commandName);
    }
  }
;
  if (ApplicationManager.getApplication().isUnitTestMode()) {
    runnable.run();
  }
 else {
    ApplicationManager.getApplication().invokeLater(runnable);
  }
}
