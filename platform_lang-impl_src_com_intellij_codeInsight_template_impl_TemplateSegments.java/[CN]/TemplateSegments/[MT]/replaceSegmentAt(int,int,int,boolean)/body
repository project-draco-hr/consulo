{
  RangeMarker rangeMarker=mySegments.get(index);
  boolean greedyToLeft=rangeMarker.isGreedyToLeft();
  boolean greedyToRight=rangeMarker.isGreedyToRight();
  rangeMarker.dispose();
  Document doc=myEditor.getDocument();
  rangeMarker=doc.createRangeMarker(start,end);
  rangeMarker.setGreedyToLeft(greedyToLeft || !preserveGreediness);
  rangeMarker.setGreedyToRight(greedyToRight || !preserveGreediness);
  mySegments.set(index,rangeMarker);
}
