{
  RangeMarker rangeMarker=mySegments.get(index);
  ((DocumentEx)rangeMarker.getDocument()).removeRangeMarker((RangeMarkerEx)rangeMarker);
  Document doc=myEditor.getDocument();
  rangeMarker=doc.createRangeMarker(start,end);
  rangeMarker.setGreedyToLeft(true);
  rangeMarker.setGreedyToRight(true);
  mySegments.set(index,rangeMarker);
}
