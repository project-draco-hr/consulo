{
  final boolean shouldPaintSelected=(getTreeStep().isSelectable(value,extractUserObject(value)) && selected) || (getTreeStep().isSelectable(value,extractUserObject(value)) && hasFocus);
  final boolean shouldPaintFocus=!getTreeStep().isSelectable(value,extractUserObject(value)) && selected || shouldPaintSelected || hasFocus;
  super.customizeCellRenderer(tree,value,shouldPaintSelected,expanded,leaf,row,shouldPaintFocus);
}
