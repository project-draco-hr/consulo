{
  myFrozenProfilesCombo=true;
  Object oldSelection=getSelectedItem();
  final DefaultComboBoxModel model=(DefaultComboBoxModel)getModel();
  model.removeAllElements();
  if (noneItemAppearance && profileManager instanceof ProjectProfileManager) {
    model.addElement(USE_GLOBAL_PROFILE);
  }
  for (  Profile profile : availableProfiles) {
    model.addElement(profile);
  }
  if (selectedProfile != null && ((selectedProfile.isLocal() && profileManager instanceof ApplicationProfileManager) || (!selectedProfile.isLocal() && profileManager instanceof ProjectProfileManager))) {
    setSelectedItem(selectedProfile);
  }
 else {
    final int index=model.getIndexOf(oldSelection);
    if (index != -1) {
      setSelectedIndex(index);
    }
 else     if (model.getSize() > 0) {
      setSelectedIndex(0);
    }
  }
  myFrozenProfilesCombo=false;
}
