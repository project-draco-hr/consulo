{
  PsiType type=null;
  if (element instanceof TemplateImpl) {
    final TemplateImpl template=(TemplateImpl)element;
    String text=template.getTemplateText();
    StringBuilder resultingText=new StringBuilder(text);
    int segmentsCount=template.getSegmentsCount();
    for (int j=segmentsCount - 1; j >= 0; j--) {
      if (template.getSegmentName(j).equals(TemplateImpl.END)) {
        continue;
      }
      int segmentOffset=template.getSegmentOffset(j);
      resultingText.insert(segmentOffset,PLACEHOLDER);
    }
    try {
      final PsiExpression templateExpression=context.getManager().getElementFactory().createExpressionFromText(resultingText.toString(),context);
      type=templateExpression.getType();
    }
 catch (    IncorrectOperationException e) {
    }
    if (type == null)     return false;
  }
  if (type != null) {
    return myFilter.isAcceptable(type,context);
  }
  return myFilter.isAcceptable(element,context);
}
