{
  final Map<Integer,SerializedStubTree> result=new THashMap<Integer,SerializedStubTree>();
  IndexStorage<Integer,SerializedStubTree> indexStorage=myStorage;
  if (indexStorage instanceof MemoryIndexStorage) {
    final MemoryIndexStorage<Integer,SerializedStubTree> memIndexStorage=(MemoryIndexStorage<Integer,SerializedStubTree>)indexStorage;
    if (!memIndexStorage.isBufferingEnabled()) {
      indexStorage=memIndexStorage.getBackendStorage();
    }
  }
  try {
    final ValueContainer<SerializedStubTree> valueContainer=indexStorage.read(key);
    if (valueContainer.size() != 1) {
      LOG.assertTrue(valueContainer.size() == 0);
      return result;
    }
    result.put(key,valueContainer.getValueIterator().next());
    return result;
  }
 catch (  RuntimeException e) {
    final Throwable cause=e.getCause();
    if (cause instanceof IOException) {
      throw new StorageException(cause);
    }
    throw e;
  }
}
