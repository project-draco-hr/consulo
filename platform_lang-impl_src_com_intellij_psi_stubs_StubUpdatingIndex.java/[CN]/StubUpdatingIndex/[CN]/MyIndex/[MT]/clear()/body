{
  final StubIndexImpl stubIndex=StubIndexImpl.getInstanceOrInvalidate();
  try {
    if (stubIndex != null) {
      for (      StubIndexKey key : stubIndex.getAllStubIndexKeys()) {
        stubIndex.getWriteLock(key).lock();
      }
    }
    getWriteLock().lock();
    if (stubIndex != null) {
      stubIndex.clearAllIndices();
    }
    super.clear();
  }
  finally {
    getWriteLock().unlock();
    if (stubIndex != null) {
      for (      StubIndexKey key : stubIndex.getAllStubIndexKeys()) {
        stubIndex.getWriteLock(key).unlock();
      }
    }
  }
}
