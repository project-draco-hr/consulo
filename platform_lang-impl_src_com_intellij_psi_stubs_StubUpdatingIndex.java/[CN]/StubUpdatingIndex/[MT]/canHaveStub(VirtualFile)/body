{
  final FileType fileType=file.getFileType();
  if (fileType instanceof LanguageFileType) {
    Language l=((LanguageFileType)fileType).getLanguage();
    ParserDefinition parserDefinition=LanguageParserDefinitions.INSTANCE.forLanguage(l);
    if (parserDefinition == null)     return false;
    final IFileElementType elementType=parserDefinition.getFileNodeType();
    boolean b=elementType instanceof IStubFileElementType && (((IStubFileElementType)elementType).shouldBuildStubFor(file) || IndexingStamp.isFileIndexed(file,INDEX_ID,IndexInfrastructure.getIndexCreationStamp(INDEX_ID)));
    if (b) {
      String extension=file.getExtension();
      LOG.assertTrue(!"xml".equalsIgnoreCase(extension) && !"tld".equalsIgnoreCase(extension),"File: " + file + " language: "+ l+ " file type: "+ fileType+ " element type: "+ elementType);
    }
    return b;
  }
 else   if (fileType.isBinary()) {
    final BinaryFileStubBuilder builder=BinaryFileStubBuilders.INSTANCE.forFileType(fileType);
    return builder != null && builder.acceptsFile(file);
  }
  return false;
}
