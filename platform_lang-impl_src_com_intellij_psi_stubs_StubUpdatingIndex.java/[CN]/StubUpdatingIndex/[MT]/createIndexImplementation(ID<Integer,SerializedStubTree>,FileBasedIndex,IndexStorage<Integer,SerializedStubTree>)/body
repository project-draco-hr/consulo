{
  if (storage instanceof MemoryIndexStorage) {
    final MemoryIndexStorage<Integer,SerializedStubTree> memStorage=(MemoryIndexStorage<Integer,SerializedStubTree>)storage;
    memStorage.addBufferingStateListsner(new MemoryIndexStorage.BufferingStateListener(){
      public void bufferingStateChanged(      final boolean newState){
        ((StubIndexImpl)StubIndexImpl.getInstance()).setDataBufferingEnabled(newState);
      }
      public void memoryStorageCleared(){
        ((StubIndexImpl)StubIndexImpl.getInstance()).cleanupMemoryStorage();
      }
    }
);
  }
  return new MyIndex(indexId,owner,storage,getIndexer());
}
