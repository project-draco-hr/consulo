{
  Map<FileType,Integer> map=new HashMap<FileType,Integer>();
  for (  final FileType fileType : FileTypeManager.getInstance().getRegisteredFileTypes()) {
    if (fileType instanceof LanguageFileType) {
      Language l=((LanguageFileType)fileType).getLanguage();
      ParserDefinition parserDefinition=LanguageParserDefinitions.INSTANCE.forLanguage(l);
      if (parserDefinition != null) {
        final IFileElementType type=parserDefinition.getFileNodeType();
        if (type instanceof IStubFileElementType) {
          map.put(fileType,((IStubFileElementType)type).getStubVersion());
        }
      }
    }
    BinaryFileStubBuilder builder=BinaryFileStubBuilders.INSTANCE.forFileType(fileType);
    if (builder != null) {
      Integer integer=map.get(fileType);
      int value=integer != null ? integer : 0;
      value=value * 31 + builder.getStubVersion() + builder.getClass().getName().hashCode();
      map.put(fileType,value);
    }
  }
  return map;
}
