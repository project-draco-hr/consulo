{
  final EclipseResolver eclipseResolver=new EclipseResolver(){
    final Map<String,String> existingModuleRoots=ClasspathStorage.getStorageRootMap(dstProject,null);
    @Nullable public String getProjectNameByPluginId(    final String id){
      return Util.getProjectNameByPluginId(parameters.projectsToConvert,id);
    }
    @Nullable public String getRootByName(    final String name){
      String root=Util.getRootByName(parameters.projectsToConvert,name);
      return root != null ? root : existingModuleRoots.get(name);
    }
  }
;
  final Ref<Exception> refEx=new Ref<Exception>();
  ProgressManager.getInstance().runProcessWithProgressSynchronously(new Runnable(){
    public void run(){
      try {
        ideaProjectModel=EclipseToIdeaConverter.convert(parameters.projectsToConvert,eclipseResolver,EclipseClasspathStorageProvider.createLibraryResolver(dstProject),parameters.converterOptions);
      }
 catch (      ConversionException e) {
        refEx.set(e);
      }
catch (      IOException e) {
        refEx.set(e);
      }
    }
  }
,EclipseBundle.message("eclipse.import.converting"),false,currentProject);
  if (!refEx.isNull()) {
    Messages.showErrorDialog(dstProject,refEx.get().getMessage(),getTitle());
    return false;
  }
  Set<String> undefinedMacros=getUndefinedMacros(ideaProjectModel);
  if (undefinedMacros.size() != 0 && !ProjectManagerImpl.showMacrosConfigurationDialog(dstProject,undefinedMacros)) {
    return false;
  }
  return true;
}
