{
  try {
    HTMLExporter.writeFileImpl(folder,fileName,buf);
  }
 catch (  IOException e) {
    Runnable showError=new Runnable(){
      @Override public void run(){
        final String fullPath=folder + File.separator + fileName;
        Messages.showMessageDialog(project,InspectionsBundle.message("inspection.export.error.writing.to",fullPath),InspectionsBundle.message("inspection.export.results.error.title"),Messages.getErrorIcon());
      }
    }
;
    ApplicationManager.getApplication().invokeLater(showError,ModalityState.NON_MODAL);
    throw new ProcessCanceledException();
  }
}
