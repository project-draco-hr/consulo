{
  final LookupImpl lookup=getLookup();
  lookup.setCurrentItem(item);
  if (LookupEvent.isSpecialCompletionChar(completionChar)) {
    new WriteCommandAction.Simple(getProject()){
      @Override protected void run() throws Throwable {
        lookup.finishLookup(completionChar);
      }
    }
.execute().throwException();
  }
 else {
    type(completionChar);
  }
}
