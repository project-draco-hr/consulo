def __init__(self, ui, repo):
    self.ui = ui
    self.repo = repo
    self.ciaurl = self.ui.config('cia', 'url', 'http://cia.vc')
    self.user = self.ui.config('cia', 'user')
    self.project = self.ui.config('cia', 'project')
    self.module = self.ui.config('cia', 'module')
    self.diffstat = self.ui.configbool('cia', 'diffstat')
    self.emailfrom = self.ui.config('email', 'from')
    self.dryrun = self.ui.configbool('cia', 'test')
    self.url = self.ui.config('web', 'baseurl')
    style = self.ui.config('cia', 'style')
    template = self.ui.config('cia', 'template')
    if (not template):
        template = ((self.diffstat and self.dstemplate) or self.deftemplate)
    template = templater.parsestring(template, quoted=False)
    t = cmdutil.changeset_templater(self.ui, self.repo, False, None, style, False)
    t.use_template(template)
    self.templater = t
