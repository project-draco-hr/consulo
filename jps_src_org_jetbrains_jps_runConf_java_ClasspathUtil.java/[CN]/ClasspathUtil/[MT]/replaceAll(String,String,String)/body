{
  if (pattern.length() == 0 || text.length() < pattern.length()) {
    return text;
  }
  final StringBuilder buf=new StringBuilder(text.length());
  int currentTextIndex=0;
  while (currentTextIndex < text.length()) {
    final int startOfPattern=text.indexOf(pattern,currentTextIndex);
    if (startOfPattern < 0) {
      if (currentTextIndex == 0) {
        return text;
      }
      buf.append(text.substring(currentTextIndex));
      return buf.toString();
    }
    buf.append(text.substring(currentTextIndex,startOfPattern));
    buf.append(replacement);
    currentTextIndex=startOfPattern + pattern.length();
  }
  return buf.toString();
}
