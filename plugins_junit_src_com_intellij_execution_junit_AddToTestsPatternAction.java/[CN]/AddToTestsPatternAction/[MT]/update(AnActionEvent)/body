{
  final Presentation presentation=e.getPresentation();
  presentation.setVisible(false);
  final DataContext dataContext=e.getDataContext();
  final PsiElement[] psiElements=LangDataKeys.PSI_ELEMENT_ARRAY.getData(dataContext);
  if (psiElements != null) {
    final Set<PsiMember> foundMembers=PatternConfigurationProducer.collectTestMembers(psiElements);
    if (foundMembers.isEmpty())     return;
    final Project project=PlatformDataKeys.PROJECT.getData(dataContext);
    if (project != null) {
      final List<JUnitConfiguration> foundConfigurations=collectPatternConfigurations(foundMembers,project);
      if (!foundConfigurations.isEmpty()) {
        presentation.setVisible(true);
        if (foundConfigurations.size() == 1) {
          presentation.setText("Add to temp suite: " + foundConfigurations.get(0).getName());
        }
      }
    }
  }
}
