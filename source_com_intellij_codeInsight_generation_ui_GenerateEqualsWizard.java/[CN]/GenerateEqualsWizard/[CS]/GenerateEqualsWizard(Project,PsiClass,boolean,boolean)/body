{
  super("Generate equals() and hashCode()",project);
  LOG.assertTrue(needEquals || needHashCode);
  myClass=aClass;
  myClassFields=MemberInfo.extractClassMembers(myClass,MEMBER_INFO_FILTER,false);
  for (int i=0; i < myClassFields.length; i++) {
    myClassFields[i].setChecked(true);
  }
  myTestBoxedStep=0;
  if (needEquals) {
    myEqualsPanel=new MemberSelectionPanel("Choose fields to be included in equals()",myClassFields,null);
    myEqualsPanel.getTable().setMemberInfoModel(new EqualsMemberInfoModel());
    myTestBoxedStep++;
  }
 else {
    myEqualsPanel=null;
  }
  if (needHashCode) {
    final MemberInfo[] hashCodeMemberInfos;
    if (needEquals) {
      myFieldsToHashCode=createFieldToMemberInfoMap(true);
      hashCodeMemberInfos=new MemberInfo[0];
    }
 else {
      hashCodeMemberInfos=myClassFields;
      myFieldsToHashCode=null;
    }
    myHashCodePanel=new MemberSelectionPanel("Choose fields to be included in hashCode()",hashCodeMemberInfos,null);
    myHashCodePanel.getTable().setMemberInfoModel(new HashCodeMemberInfoModel());
    if (needEquals) {
      updateHashCodeMemberInfos(myClassFields);
    }
    myTestBoxedStep++;
  }
 else {
    myHashCodePanel=null;
    myFieldsToHashCode=null;
  }
  myNonNullPanel=new MemberSelectionPanel("Select all non-null fields",new MemberInfo[0],null);
  myFieldsToNonNull=createFieldToMemberInfoMap(false);
  final MyTableModelListener listener=new MyTableModelListener();
  if (myEqualsPanel != null) {
    myEqualsPanel.getTable().getModel().addTableModelListener(listener);
    addStep(new MyStep(myEqualsPanel));
  }
  if (myHashCodePanel != null) {
    myHashCodePanel.getTable().getModel().addTableModelListener(listener);
    addStep(new MyStep(myHashCodePanel));
  }
  addStep(new MyStep(myNonNullPanel));
  init();
  updateStatus();
}
