{
  myLexer.start(text,0,text.length(),myInitialState);
  mySegments.removeAll();
  int i=0;
  while (myLexer.getTokenType() != null) {
    int data=packData(myLexer.getTokenType(),myLexer.getState());
    mySegments.setElementAt(i,myLexer.getTokenStart(),myLexer.getTokenEnd(),data);
    i++;
    myLexer.advance();
  }
  if (myEditor != null) {
    Runnable repaint=new Runnable(){
      public void run(){
        myEditor.repaint(0,text.length());
      }
    }
;
    if (ApplicationManager.getApplication().isDispatchThread())     repaint.run();
 else     ApplicationManager.getApplication().invokeLater(repaint);
  }
}
