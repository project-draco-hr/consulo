{
  if (!Registry.is("actionSystem.mouseGesturesEnabled"))   return;
  if (SystemInfo.isMacOSSnowLeopard) {
    try {
      if (myListeners.containsKey(frame)) {
        remove(frame);
      }
      Class<?> gestureListenerClass=Class.forName("com.apple.eawt.event.GestureListener");
      Class<?> swipeListenerClass=Class.forName("com.apple.eawt.event.SwipeListener");
      Object listener=Proxy.newProxyInstance(getClass().getClassLoader(),new Class[]{swipeListenerClass},new InvocationHandler(){
        @Override public Object invoke(        Object proxy,        Method method,        Object[] args) throws Throwable {
          if ("swipedRight".equals(method.getName())) {
            processRightSwipe(frame);
          }
 else           if ("swipedLeft".equals(method.getName())) {
            processLeftSwipe(frame);
          }
          return null;
        }
      }
);
      Class<?> utilsClass=Class.forName("com.apple.eawt.event.GestureUtilities");
      Method addMethod=utilsClass.getDeclaredMethod("addGestureListenerTo",JComponent.class,gestureListenerClass);
      addMethod.invoke(null,frame.getComponent(),listener);
      myListeners.put(frame,listener);
    }
 catch (    Exception e) {
      LOG.error(e);
    }
  }
}
