{
  try {
    while (true) {
      int len=is.read(buffer);
      if (len <= 0)       break;
      os.write(buffer,0,len);
      os.flush();
    }
  }
 catch (  IOException ignore) {
    try {
      c.cm.closeChannel(c,"Closed due to exception in StreamForwarder (" + mode + "): "+ ignore.getMessage(),true);
    }
 catch (    IOException e) {
    }
  }
 finally {
    try {
      os.close();
    }
 catch (    IOException e1) {
    }
    try {
      is.close();
    }
 catch (    IOException e2) {
    }
    if (sibling != null) {
      while (sibling.isAlive()) {
        try {
          sibling.join();
        }
 catch (        InterruptedException e) {
        }
      }
      try {
        c.cm.closeChannel(c,"StreamForwarder (" + mode + ") is cleaning up the connection",true);
      }
 catch (      IOException e3) {
      }
      try {
        if (s != null)         s.close();
      }
 catch (      IOException e1) {
      }
    }
  }
}
