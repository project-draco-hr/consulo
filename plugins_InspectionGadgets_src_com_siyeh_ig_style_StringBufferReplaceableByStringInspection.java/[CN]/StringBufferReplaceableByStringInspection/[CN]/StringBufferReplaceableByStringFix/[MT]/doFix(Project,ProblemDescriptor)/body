{
  final PsiElement element=descriptor.getPsiElement();
  final PsiElement parent=element.getParent();
  if (!(parent instanceof PsiVariable)) {
    if (parent instanceof PsiNewExpression) {
      final PsiNewExpression newExpression=(PsiNewExpression)parent;
      final PsiExpression stringBuilderExpression=getCompleteExpression(newExpression);
      final StringBuilder stringExpression=buildStringExpression(stringBuilderExpression,new StringBuilder());
      replaceExpression(stringBuilderExpression,stringExpression.toString());
      return;
    }
    return;
  }
  final PsiVariable variable=(PsiVariable)parent;
  final PsiTypeElement originalTypeElement=variable.getTypeElement();
  if (originalTypeElement == null) {
    return;
  }
  final PsiExpression initializer=variable.getInitializer();
  if (initializer == null) {
    return;
  }
  final StringBuilder stringExpression=buildStringExpression(initializer,new StringBuilder());
  if (stringExpression == null) {
    return;
  }
  final PsiElementFactory factory=JavaPsiFacade.getElementFactory(project);
  final PsiClassType javaLangString=factory.createTypeByFQClassName(CommonClassNames.JAVA_LANG_STRING,variable.getResolveScope());
  final PsiTypeElement typeElement=factory.createTypeElement(javaLangString);
  replaceExpression(initializer,stringExpression.toString());
  originalTypeElement.replace(typeElement);
}
