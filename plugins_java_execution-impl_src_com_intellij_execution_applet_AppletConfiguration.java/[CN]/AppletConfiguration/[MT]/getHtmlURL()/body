{
  if (HTML_USED) {
    if (HTML_FILE_NAME == null || HTML_FILE_NAME.length() == 0) {
      throw new CantRunException(ExecutionBundle.message("html.file.not.specified.error.message"));
    }
    return new AppletHtmlFile(HTML_FILE_NAME,null);
  }
 else {
    if (MAIN_CLASS_NAME == null || MAIN_CLASS_NAME.length() == 0) {
      throw new CantRunException(ExecutionBundle.message("class.not.specified.error.message"));
    }
    try {
      return generateAppletTempPage();
    }
 catch (    IOException e) {
      throw new CantRunException(ExecutionBundle.message("failed.to.generate.wrapper.error.message"));
    }
  }
}
