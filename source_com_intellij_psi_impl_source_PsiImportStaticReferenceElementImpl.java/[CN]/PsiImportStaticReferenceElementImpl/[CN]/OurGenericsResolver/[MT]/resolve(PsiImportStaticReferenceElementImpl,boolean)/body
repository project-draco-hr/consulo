{
  final PsiElement qualifier=referenceElement.getQualifier();
  if (!(qualifier instanceof PsiJavaCodeReferenceElement))   return JavaResolveResult.EMPTY_ARRAY;
  final PsiElement target=((PsiJavaCodeReferenceElement)qualifier).resolve();
  if (!(target instanceof PsiClass))   return JavaResolveResult.EMPTY_ARRAY;
  final ArrayList<JavaResolveResult> results=new ArrayList<JavaResolveResult>();
  target.processDeclarations(referenceElement.new MyScopeProcessor(results),PsiSubstitutor.EMPTY,referenceElement,referenceElement);
  if (results.size() <= 1) {
    return results.toArray(new JavaResolveResult[results.size()]);
  }
  for (int i=results.size() - 1; i >= 0; i--) {
    final JavaResolveResult resolveResult=results.get(i);
    if (!resolveResult.isValidResult()) {
      results.remove(i);
    }
  }
  return results.toArray(new JavaResolveResult[results.size()]);
}
