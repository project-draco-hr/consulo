{
  final DfaValueFactory factory=runner.getFactory();
  DfaValue dfaExpr=factory.createValue(instruction.getCasted());
  if (dfaExpr != null) {
    DfaTypeValue dfaType=(DfaTypeValue)factory.createTypeValue(instruction.getCastTo(),Nullness.UNKNOWN);
    DfaRelationValue dfaInstanceof=factory.getRelationFactory().createRelation(dfaExpr,dfaType,JavaTokenType.INSTANCEOF_KEYWORD,false);
    if (dfaInstanceof != null && !memState.applyInstanceofOrNull(dfaInstanceof)) {
      onInstructionProducesCCE(instruction);
    }
  }
  if (instruction.getCastTo() instanceof PsiPrimitiveType) {
    memState.push(runner.getFactory().getBoxedFactory().createUnboxed(memState.pop()));
  }
  return nextInstruction(instruction,runner,memState);
}
