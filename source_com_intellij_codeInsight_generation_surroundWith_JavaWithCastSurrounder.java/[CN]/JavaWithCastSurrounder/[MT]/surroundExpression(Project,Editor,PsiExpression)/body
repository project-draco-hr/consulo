{
  PsiType[] types=GuessManager.getInstance(project).guessTypeToCast(expr);
  final Template template=generateTemplate(project,expr.getText(),types);
  TextRange range=expr.getTextRange();
  editor.getDocument().deleteString(range.getStartOffset(),range.getEndOffset());
  int offset=range.getStartOffset();
  editor.getCaretModel().moveToOffset(offset);
  editor.getScrollingModel().scrollToCaret(ScrollType.RELATIVE);
  TemplateManager.getInstance(project).startTemplate(editor,template);
  return new TextRange(editor.getSelectionModel().getSelectionStart(),editor.getSelectionModel().getSelectionEnd());
}
