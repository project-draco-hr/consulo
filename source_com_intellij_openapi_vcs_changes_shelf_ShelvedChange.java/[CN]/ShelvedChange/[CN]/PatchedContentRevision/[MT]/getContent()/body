{
  final Document doc=FileDocumentManager.getInstance().getDocument(myFilePath.getVirtualFile());
  String baseContent=doc.getText();
  try {
    List<FilePatch> filePatches=ShelveChangesManager.loadPatches(myPatchPath);
    for (    FilePatch patch : filePatches) {
      if (myPatchedFilePath.equals(patch.getBeforeName())) {
        StringBuilder newText=new StringBuilder();
        patch.applyModifications(baseContent,newText);
        return newText.toString();
      }
    }
  }
 catch (  Exception e) {
    return null;
  }
  return null;
}
