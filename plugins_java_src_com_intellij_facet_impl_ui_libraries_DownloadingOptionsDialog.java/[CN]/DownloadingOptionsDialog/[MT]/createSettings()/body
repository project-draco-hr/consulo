{
  final FrameworkLibraryVersion version=getSelectedVersion();
  LOG.assertTrue(version != null);
  String libraryName;
  LibrariesContainer.LibraryLevel libraryLevel;
  if (myNameAndLevelPanel != null) {
    libraryName=myNameAndLevelPanel.getLibraryName();
    libraryLevel=myNameAndLevelPanel.getLibraryLevel();
  }
 else {
    libraryName=version.getDefaultLibraryName();
    libraryLevel=LibrariesContainer.LibraryLevel.PROJECT;
  }
  final String path=FileUtil.toSystemIndependentName(myDirectoryField.getText());
  List<DownloadableLibraryFileDescription> selected=getSelectedDownloads(version);
  return new LibraryDownloadSettings(version,myLibraryType,path,libraryName,libraryLevel,selected,myDownloadSourcesCheckBox.isSelected(),myDownloadJavadocsCheckBox.isSelected());
}
