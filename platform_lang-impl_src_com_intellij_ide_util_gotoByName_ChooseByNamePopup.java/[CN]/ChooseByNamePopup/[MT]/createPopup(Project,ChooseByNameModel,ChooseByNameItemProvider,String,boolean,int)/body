{
  final ChooseByNamePopup oldPopup=project == null ? null : project.getUserData(CHOOSE_BY_NAME_POPUP_IN_PROJECT_KEY);
  if (oldPopup != null) {
    oldPopup.close(false);
  }
  ChooseByNamePopup newPopup=new ChooseByNamePopup(project,model,provider,oldPopup,predefinedText,mayRequestOpenInCurrentWindow,initialIndex){
    @NotNull @Override protected Set<Object> filter(    @NotNull Set<Object> elements){
      return model instanceof EdtSortingModel ? super.filter(((EdtSortingModel)model).sort(elements)) : super.filter(elements);
    }
  }
;
  if (project != null) {
    project.putUserData(CHOOSE_BY_NAME_POPUP_IN_PROJECT_KEY,newPopup);
  }
  return newPopup;
}
