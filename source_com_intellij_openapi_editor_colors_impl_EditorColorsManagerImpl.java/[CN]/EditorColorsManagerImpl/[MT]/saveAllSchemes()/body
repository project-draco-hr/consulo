{
  File dir=getColorsDir(true);
  if (dir == null)   return;
  File[] oldFiles=getSchemeFiles();
  int size=mySchemesMap.values().size();
  ArrayList<String> filePaths=new ArrayList<String>();
  ArrayList<Document> documents=new ArrayList<Document>();
  UniqueFileNamesProvider namesProvider=new UniqueFileNamesProvider();
  Iterator<EditorColorsScheme> itr=mySchemesMap.values().iterator();
  for (int i=0; i < size; i++) {
    AbstractColorsScheme scheme=(AbstractColorsScheme)itr.next();
    if (scheme instanceof DefaultColorsScheme)     continue;
    Element root=new Element(SCHEME_NODE_NAME);
    try {
      scheme.writeExternal(root);
    }
 catch (    WriteExternalException e) {
      LOG.error(e);
      return;
    }
    @NonNls String filePath=dir.getAbsolutePath() + File.separator + namesProvider.suggestName(scheme.getName())+ XML_EXT;
    documents.add(new Document(root));
    filePaths.add(filePath);
  }
  JDOMUtil.updateFileSet(oldFiles,filePaths.toArray(new String[filePaths.size()]),documents.toArray(new Document[documents.size()]),CodeStyleSettingsManager.getSettings(null).getLineSeparator());
}
