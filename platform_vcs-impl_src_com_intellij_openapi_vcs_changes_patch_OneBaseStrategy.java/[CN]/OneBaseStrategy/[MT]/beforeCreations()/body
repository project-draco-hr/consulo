{
  if (!mySucceeded)   return;
  if (myVariants.size() > 1) {
    Pair<VirtualFile,Collection<FilePatchInProgress>> privilegedSurvivor=null;
    for (    VirtualFile file : myVariants.keySet()) {
      final Collection<FilePatchInProgress> patches=myVariants.get(file);
      int numStrip=-1;
      boolean sameStrip=true;
      for (      FilePatchInProgress patch : patches) {
        if (numStrip == -1) {
          numStrip=patch.getCurrentStrip();
        }
 else {
          if (numStrip != patch.getCurrentStrip()) {
            sameStrip=false;
            break;
          }
        }
      }
      if (sameStrip) {
        privilegedSurvivor=new Pair<VirtualFile,Collection<FilePatchInProgress>>(file,patches);
        break;
      }
    }
    if (privilegedSurvivor == null) {
      final VirtualFile first=myVariants.keySet().iterator().next();
      privilegedSurvivor=new Pair<VirtualFile,Collection<FilePatchInProgress>>(first,myVariants.get(first));
    }
    myVariants.clear();
    myVariants.put(privilegedSurvivor.getFirst(),privilegedSurvivor.getSecond());
  }
  myResult.addAll(myVariants.values());
}
