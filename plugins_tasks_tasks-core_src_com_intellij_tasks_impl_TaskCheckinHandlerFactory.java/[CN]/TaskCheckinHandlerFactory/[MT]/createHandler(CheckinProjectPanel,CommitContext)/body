{
  return new CheckinHandler(){
    @Override public void checkinSuccessful(){
      final String message=panel.getCommitMessage();
      if (message != null) {
        final Project project=panel.getProject();
        TaskManagerImpl manager=(TaskManagerImpl)TaskManager.getManager(project);
        if (manager.getState().saveContextOnCommit) {
          SwingUtilities.invokeLater(new Runnable(){
            @Override public void run(){
              WorkingContextManager.getInstance(project).saveContext(null,message);
            }
          }
);
        }
      }
    }
  }
;
}
