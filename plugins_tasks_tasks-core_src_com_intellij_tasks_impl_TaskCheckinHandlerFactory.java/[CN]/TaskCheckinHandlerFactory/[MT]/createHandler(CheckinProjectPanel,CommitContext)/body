{
  return new CheckinHandler(){
    @Override public void checkinSuccessful(){
      final String message=panel.getCommitMessage();
      if (message != null) {
        final Project project=panel.getProject();
        final TaskManagerImpl manager=(TaskManagerImpl)TaskManager.getManager(project);
        if (manager.getState().saveContextOnCommit) {
          Task task=findTaskInRepositories(message,manager);
          if (task == null) {
            task=manager.createLocalTask(message);
          }
          final LocalTask localTask=manager.addTask(task);
          localTask.setUpdated(new Date());
          SwingUtilities.invokeLater(new Runnable(){
            @Override public void run(){
              if (!project.isDisposed()) {
                WorkingContextManager.getInstance(project).saveContext(localTask);
              }
            }
          }
);
        }
      }
    }
  }
;
}
