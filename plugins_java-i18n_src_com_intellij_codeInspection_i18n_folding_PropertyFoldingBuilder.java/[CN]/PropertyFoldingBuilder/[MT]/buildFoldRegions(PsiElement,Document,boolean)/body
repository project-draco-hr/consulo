{
  if (!(element instanceof PsiJavaFile) || quick || !isFoldingsOn()) {
    return FoldingDescriptor.EMPTY;
  }
  final PsiJavaFile file=(PsiJavaFile)element;
  final Project project=file.getProject();
  final List<FoldingDescriptor> result=new ArrayList<FoldingDescriptor>();
  boolean hasJsp=ContainerUtil.intersects(Arrays.asList(StdLanguages.JSP,StdLanguages.JSPX),file.getViewProvider().getLanguages());
  file.accept(hasJsp ? new JavaRecursiveElementVisitor(){
    @Override public void visitLiteralExpression(    PsiLiteralExpression expression){
      checkLiteral(project,expression,result);
    }
  }
 : new JavaRecursiveElementWalkingVisitor(){
    @Override public void visitLiteralExpression(    PsiLiteralExpression expression){
      checkLiteral(project,expression,result);
    }
  }
);
  return result.toArray(new FoldingDescriptor[result.size()]);
}
