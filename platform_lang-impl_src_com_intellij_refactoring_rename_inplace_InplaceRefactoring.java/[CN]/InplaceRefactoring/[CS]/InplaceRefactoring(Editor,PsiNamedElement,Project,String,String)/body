{
  myEditor=editor;
  myElementToRename=elementToRename;
  myProject=project;
  myOldName=oldName;
  if (myElementToRename != null) {
    myInitialName=initialName;
    final PsiFile containingFile=myElementToRename.getContainingFile();
    if (!notSameFile(getTopLevelVirtualFile(containingFile.getViewProvider()),containingFile) && myElementToRename != null && myElementToRename.getTextRange() != null) {
      myRenameOffset=myEditor.getDocument().createRangeMarker(myElementToRename.getTextRange());
      myRenameOffset.setGreedyToRight(true);
      myRenameOffset.setGreedyToLeft(true);
    }
  }
}
