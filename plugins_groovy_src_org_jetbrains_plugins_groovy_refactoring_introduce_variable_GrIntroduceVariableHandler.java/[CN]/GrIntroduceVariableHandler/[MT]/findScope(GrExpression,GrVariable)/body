{
  final PsiElement scope=GroovyRefactoringUtil.getEnclosingContainer(selectedExpr);
  if (scope == null || !(scope instanceof GroovyPsiElement)) {
    throw new GrIntroduceRefactoringError(GroovyRefactoringBundle.message("refactoring.is.not.supported.in.the.current.context",REFACTORING_NAME));
  }
  if (!GroovyRefactoringUtil.isAppropriateContainerForIntroduceVariable(scope)) {
    throw new GrIntroduceRefactoringError(GroovyRefactoringBundle.message("refactoring.is.not.supported.in.the.current.context",REFACTORING_NAME));
  }
  return scope;
}
