{
  if (lookup.isSelectionTouched() || !lookup.isCompletion())   return false;
  CompletionProcess process=CompletionService.getCompletionService().getCurrentCompletion();
  if (process == null || !process.isAutopopupCompletion())   return false;
  LookupElement item=lookup.getCurrentItem();
  if (item == null)   return false;
  PsiFile file=lookup.getPsiFile();
  if (file == null)   return false;
  Object o=item.getObject();
  if (o instanceof PsiClass && ((PsiClass)o).getName().length() > lookup.itemPattern(item).length()) {
    if (PsiShortNamesCache.getInstance(file.getProject()).getClassesByName(lookup.itemPattern(item),file.getResolveScope()).length > 0) {
      return true;
    }
  }
  return false;
}
