{
  if (myCachedNormalizedRequests != null)   return myCachedNormalizedRequests;
  List<WatchRequest> result=new ArrayList<WatchRequest>();
synchronized (LOCK) {
    NextRoot:     for (    WatchRequest request : myRootsToWatch) {
      VirtualFile root=request.getRoot();
      boolean recursively=request.isToWatchRecursively();
      for (Iterator<WatchRequest> iterator1=result.iterator(); iterator1.hasNext(); ) {
        final WatchRequest otherRequest=iterator1.next();
        final VirtualFile otherRoot=otherRequest.getRoot();
        final boolean otherRecursively=otherRequest.isToWatchRecursively();
        if ((root.equals(otherRoot) && (!recursively || otherRecursively)) || (VfsUtil.isAncestor(otherRoot,root,true) && otherRecursively)) {
          continue NextRoot;
        }
 else         if (VfsUtil.isAncestor(root,otherRoot,true) && (recursively || !otherRecursively)) {
          iterator1.remove();
        }
      }
      result.add(request);
    }
  }
  myCachedNormalizedRequests=result.toArray(new WatchRequest[result.size()]);
  return myCachedNormalizedRequests;
}
