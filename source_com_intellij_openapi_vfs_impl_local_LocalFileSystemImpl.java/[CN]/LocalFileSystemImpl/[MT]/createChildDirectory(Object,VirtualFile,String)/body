{
  final VirtualFileImpl dir=(VirtualFileImpl)vDir;
  VirtualFile existingFile=dir.findChild(dirName);
  final boolean auxCommand=auxCreateDirectory(vDir,dirName);
  PhysicalFile physicalFile=dir.getPhysicalFile().createChild(dirName);
  if (!auxCommand) {
    if (existingFile != null || physicalFile.exists()) {
      throw new IOException(VfsBundle.message("file.already.exists.error",physicalFile.getPath()));
    }
    if (!physicalFile.mkdir()) {
      throw new IOException(VfsBundle.message("file.create.error",physicalFile.getPath()));
    }
  }
 else {
    if (existingFile != null)     return existingFile;
  }
  VirtualFileImpl child=new VirtualFileImpl(dir,physicalFile,true);
  dir.addChild(child);
  fireFileCreated(requestor,child);
  return child;
}
