{
  if (myRootsToPaths == null) {
    initRoots();
  }
 else {
    final File[] files=File.listRoots();
    Set<String> newRootPaths=new HashSet<String>();
    for (    File file : files) {
      String path=getCanonicalPath(file);
      if (path != null) {
        path=path.replace(File.separatorChar,'/');
        final List<VirtualFile> roots=myRootsToPaths.getKeysByValue(path);
        if (roots == null) {
          final VirtualFileImpl root=new VirtualFileImpl(path);
          myRootsToPaths.put(root,path);
        }
        newRootPaths.add(path);
      }
    }
    for (Iterator<Map.Entry<VirtualFile,String>> iterator=myRootsToPaths.entrySet().iterator(); iterator.hasNext(); ) {
      Map.Entry<VirtualFile,String> entry=iterator.next();
      if (!newRootPaths.contains(entry.getValue())) {
        iterator.remove();
      }
    }
  }
}
