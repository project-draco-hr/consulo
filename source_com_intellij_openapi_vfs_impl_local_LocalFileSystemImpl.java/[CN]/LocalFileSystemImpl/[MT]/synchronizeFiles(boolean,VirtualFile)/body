{
  for (  final VirtualFile file : files) {
    ((VirtualFileImpl)file).refresh(true,recursively,true,null);
    if (!recursively) {
      if (((VirtualFileImpl)file).areChildrenCached()) {
        for (        final VirtualFile child : file.getChildren()) {
          ((VirtualFileImpl)child).refresh(true,false,true,null);
        }
      }
 else {
        for (        final VirtualFileImpl unaccounted : myUnaccountedFiles.values()) {
          if (unaccounted != null && file.equals(unaccounted.getParent())) {
            unaccounted.refresh(true,false,true,null);
          }
        }
      }
    }
  }
}
