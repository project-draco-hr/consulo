{
  if (myFSRootsToPaths == null) {
    initRoots();
  }
 else {
    final File[] files=File.listRoots();
synchronized (LOCK) {
      Set<String> newRootPaths=new HashSet<String>();
      for (      File file : files) {
        String path=getCanonicalPath(file);
        if (path != null) {
          path=path.replace(File.separatorChar,'/');
          final List<VirtualFile> roots=myFSRootsToPaths.getKeysByValue(path);
          if (roots == null) {
            final VirtualFileImpl root=new VirtualFileImpl(path);
            myFSRootsToPaths.put(root,path);
          }
          newRootPaths.add(path);
        }
      }
      for (Iterator<Map.Entry<VirtualFile,String>> iterator=myFSRootsToPaths.entrySet().iterator(); iterator.hasNext(); ) {
        Map.Entry<VirtualFile,String> entry=iterator.next();
        if (!newRootPaths.contains(entry.getValue())) {
          iterator.remove();
        }
      }
    }
  }
}
