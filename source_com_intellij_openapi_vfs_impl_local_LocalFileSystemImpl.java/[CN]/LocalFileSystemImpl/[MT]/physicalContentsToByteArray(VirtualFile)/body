{
  if (!(virtualFile instanceof VirtualFileImpl))   return virtualFile.contentsToByteArray();
  VirtualFileImpl virtualFileImpl=(VirtualFileImpl)virtualFile;
  InputStream inputStream=virtualFileImpl.getPhysicalFileInputStream();
  try {
    int physicalFileLength=virtualFileImpl.getPhysicalFileLength();
    LOG.assertTrue(physicalFileLength >= 0);
    return FileUtil.loadBytes(inputStream,physicalFileLength);
  }
  finally {
    inputStream.close();
  }
}
