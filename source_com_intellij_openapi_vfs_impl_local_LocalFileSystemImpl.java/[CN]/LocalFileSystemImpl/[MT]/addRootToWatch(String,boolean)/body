{
  LOG.assertTrue(rootPath != null);
  Set<String> oldPaths=new HashSet<String>();
  for (  WatchRequest request : myRootsToWatch) {
    oldPaths.add(request.getRootPath());
  }
synchronized (LOCK) {
    final WatchRequestImpl result=new WatchRequestImpl(rootPath,toWatchRecursively);
    myRootsToWatch.add(result);
    if (!oldPaths.contains(result.getRootPath())) {
      final VirtualFile existingFile=findFileByPath(result.getRootPath(),false,false);
      if (existingFile != null)       synchronizeFiles(existingFile);
    }
    setUpFileWatcher();
    return result;
  }
}
