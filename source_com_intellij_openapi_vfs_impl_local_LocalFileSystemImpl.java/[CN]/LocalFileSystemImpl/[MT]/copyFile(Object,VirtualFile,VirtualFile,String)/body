{
  final VirtualFileImpl file=(VirtualFileImpl)vFile;
  File physicalCopy=auxCopy(vFile,newParent,copyName);
  if (physicalCopy == null) {
    File physicalFile=file.getPhysicalFile();
    File newPhysicalParent=((VirtualFileImpl)newParent).getPhysicalFile();
    physicalCopy=new File(newPhysicalParent,copyName);
    try {
      if (physicalFile.isDirectory()) {
        FileUtil.copyDir(physicalFile,physicalCopy);
      }
 else {
        physicalCopy.createNewFile();
        FileUtil.copy(physicalFile,physicalCopy);
      }
    }
 catch (    IOException e) {
      FileUtil.delete(physicalCopy);
      throw e;
    }
  }
  final VirtualFileImpl created=new VirtualFileImpl((VirtualFileImpl)newParent,physicalCopy,physicalCopy.isDirectory());
  ((VirtualFileImpl)newParent).addChild(created);
  fireFileCopied(requestor,vFile,created);
  return created;
}
