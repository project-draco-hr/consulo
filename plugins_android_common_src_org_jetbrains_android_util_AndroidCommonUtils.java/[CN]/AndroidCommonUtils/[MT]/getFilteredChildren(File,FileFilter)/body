{
  final File[] children=dir.listFiles();
  if (children == null || children.length == 0 || filter == null) {
    return children;
  }
  final List<File> result=new ArrayList<File>();
  for (  File child : children) {
    if (child.isDirectory() || filter.accept(child)) {
      result.add(child);
    }
  }
  return result.toArray(new File[result.size()]);
}
