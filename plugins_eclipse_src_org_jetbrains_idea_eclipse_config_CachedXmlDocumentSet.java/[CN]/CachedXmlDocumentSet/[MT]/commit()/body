{
  for (  String key : modifiedContent.keySet()) {
    if (hasChanged(key)) {
      final Document logical=modifiedContent.get(key);
      if (logical != null) {
        final Document physical=logical;
        OutputStream os=null;
        try {
          os=getOrCreateVFile(key).getOutputStream(this);
          Writer writer=new OutputStreamWriter(os,"UTF-8");
          try {
            EclipseJDOMUtil.output(physical,writer);
          }
  finally {
            writer.close();
          }
        }
  finally {
          if (os != null) {
            os.close();
          }
        }
        savedContent.put(key,physical);
      }
    }
  }
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    public void run(){
      for (      String deleted : deletedContent) {
        VirtualFile file=getVFile(deleted);
        if (file != null) {
          try {
            file.delete(this);
          }
 catch (          IOException ignore) {
          }
        }
      }
      deletedContent.clear();
    }
  }
);
}
