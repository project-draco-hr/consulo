{
  if (state == null) {
    throw new IllegalArgumentException("state cannot be null");
  }
  if (level == null) {
    throw new IllegalArgumentException("level cannot be null");
  }
  state.LINE=editor.getCaretModel().getLogicalPosition().line;
  state.COLUMN=editor.getCaretModel().getLogicalPosition().column;
  state.SELECTION_START=editor.getSelectionModel().getSelectionStart();
  state.SELECTION_END=editor.getSelectionModel().getSelectionEnd();
  if (FileEditorStateLevel.FULL == level) {
    if (project != null) {
      PsiDocumentManager.getInstance(project).commitDocument(editor.getDocument());
      state.FOLDING_STATE=CodeFoldingManager.getInstance(project).saveFoldingState(editor);
    }
 else {
      state.FOLDING_STATE=null;
    }
    state.VERTICAL_SCROLL_PROPORTION=EditorUtil.calcVerticalScrollProportion(editor);
  }
 else {
    state.VERTICAL_SCROLL_PROPORTION=-1;
  }
}
