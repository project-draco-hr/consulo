{
  boolean haveClearedRefs=false;
  while (true) {
    PatchedWeakReference ref=(PatchedWeakReference)ourQueue.poll();
    if (ref != null) {
      haveClearedRefs=true;
    }
 else {
      break;
    }
  }
  if (!haveClearedRefs)   return;
synchronized (ourQueue) {
    ArrayList<PatchedWeakReference<?>> newList=new ArrayList<PatchedWeakReference<?>>(ourRefsList.size() / 2 + 1);
    for (int i=0; i < ourRefsList.size(); i++) {
      PatchedWeakReference<?> ref=ourRefsList.get(i);
      if (ref.get() != null) {
        newList.add(ref);
      }
    }
    if (LOG.isDebugEnabled()) {
      LOG.info("old size:" + ourRefsList.size());
      LOG.info("new size:" + newList.size());
    }
    ourRefsList=newList;
  }
}
