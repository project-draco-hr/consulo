{
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    @Override public void run(){
      boolean b=Registry.get(KEY).asBoolean();
      try {
        Registry.get(KEY).setValue(false);
        final VirtualFile dir=LocalFileSystem.getInstance().refreshAndFindFileByPath("C:/Documents and Settings");
        Win32LocalFileSystem system=Win32LocalFileSystem.getWin32Instance();
        system.exists(dir);
        String[] strings=system.list(dir);
        System.out.println(Arrays.asList(strings));
      }
 catch (      Exception e) {
        fail(e.getMessage());
      }
 finally {
        Registry.get(KEY).setValue(b);
      }
    }
  }
);
}
