{
  DebuggerManagerThreadImpl.assertIsManagerThread();
  final List<File> outputRoots=new ArrayList<File>();
  ApplicationManager.getApplication().runReadAction(new Runnable(){
    public void run(){
      final List<VirtualFile> allClasses=OrderEnumerator.orderEntries(myProject).withoutSdk().withoutLibraries().getPathsList().getRootDirs();
      for (      VirtualFile dir : VfsUtil.toVirtualFileArray(allClasses)) {
        outputRoots.add(new File(dir.getPath()));
      }
    }
  }
);
  final long timeStamp=getTimeStamp(session);
  final Map<String,HotSwapFile> modifiedClasses=new HashMap<String,HotSwapFile>();
  for (  File root : outputRoots) {
    final String rootPath=FileUtil.toCanonicalPath(root.getPath());
    collectModifiedClasses(root,rootPath,rootPath + "/",modifiedClasses,progress,timeStamp);
  }
  return modifiedClasses;
}
