{
  final long start=System.currentTimeMillis();
  try {
    final Project project=new Project();
    final File projectFile=new File(projectPath);
    final String loadPath=isDirectoryBased(projectFile) ? new File(projectFile,IDEA_PROJECT_DIRNAME).getPath() : projectPath;
    IdeaProjectLoader.loadFromPath(project,loadPath,myPathVars,null,new SystemOutErrorReporter(false));
    final String globalEncoding=myGlobalEncoding;
    if (!StringUtil.isEmpty(globalEncoding) && project.getProjectCharset() == null) {
      project.setProjectCharset(globalEncoding);
    }
    project.getIgnoredFilePatterns().loadFromString(myIgnorePatterns);
    return project;
  }
  finally {
    final long loadTime=System.currentTimeMillis() - start;
    LOG.info("Project " + projectPath + " loaded in "+ loadTime+ " ms");
  }
}
