{
  boolean shouldApplyEvent=false;
  final File file=new File(dataStorageRoot,FS_STATE_FILE);
  try {
    final InputStream fs=new FileInputStream(file);
    byte[] bytes;
    try {
      bytes=FileUtil.loadBytes(fs,(int)file.length());
    }
  finally {
      fs.close();
    }
    final DataInputStream in=new DataInputStream(new ByteArrayInputStream(bytes));
    try {
      final long savedOrdinal=in.readLong();
      if (initialEvent != null && (savedOrdinal + 1L == initialEvent.getOrdinal())) {
        fsState.load(in);
        myLastEventOrdinal=savedOrdinal;
        shouldApplyEvent=true;
      }
 else {
        fsState.clearAll();
        myLastEventOrdinal=initialEvent != null ? initialEvent.getOrdinal() : 0L;
      }
    }
  finally {
      in.close();
    }
    return shouldApplyEvent;
  }
 catch (  FileNotFoundException ignored) {
  }
catch (  Throwable e) {
    LOG.error(e);
  }
  myLastEventOrdinal=initialEvent != null ? initialEvent.getOrdinal() : 0L;
  fsState.clearAll();
  return shouldApplyEvent;
}
