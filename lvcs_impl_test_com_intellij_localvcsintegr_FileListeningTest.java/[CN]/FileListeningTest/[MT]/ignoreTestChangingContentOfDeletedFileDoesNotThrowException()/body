{
  final VirtualFile f=root.createChildData(null,"f.java");
  VirtualFileListener l=new VirtualFileAdapter(){
    @Override public void beforeContentsChange(    VirtualFileEvent e){
      new File(e.getFile().getPath()).delete();
    }
  }
;
  addFileListenerDuring(l,new Callable(){
    public Object call() throws Exception {
      f.setBinaryContent(new byte[]{1});
      return null;
    }
  }
);
  assertFalse(getVcs().getEntry(f.getPath()).getContent().isAvailable());
}
