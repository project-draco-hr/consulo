{
  if (stepThread == null || stepThread.isCollected()) {
    return;
  }
  if (LOG.isDebugEnabled()) {
    LOG.debug("DO_STEP: creating step request for " + stepThread.getThreadReference());
  }
  deleteStepRequests(stepThread);
  EventRequestManager requestManager=getVirtualMachineProxy().eventRequestManager();
  StepRequest stepRequest=requestManager.createStepRequest(stepThread.getThreadReference(),StepRequest.STEP_LINE,depth);
  DebuggerSettings settings=DebuggerSettings.getInstance();
  if (!(hint != null && hint.isIgnoreFilters())) {
    if (settings.TRACING_FILTERS_ENABLED) {
      String currentClassName=getCurrentClassName(stepThread);
      if (currentClassName == null || !settings.isNameFiltered(currentClassName)) {
        ClassFilter[] filters=settings.getSteppingFilters();
        for (        ClassFilter filter : filters) {
          if (filter.isEnabled()) {
            stepRequest.addClassExclusionFilter(filter.getPattern());
          }
        }
      }
    }
  }
  stepRequest.setSuspendPolicy(suspendContext.getSuspendPolicy() == EventRequest.SUSPEND_EVENT_THREAD ? EventRequest.SUSPEND_EVENT_THREAD : EventRequest.SUSPEND_ALL);
  if (hint != null) {
    stepRequest.putProperty("hint",hint);
  }
  stepRequest.enable();
}
