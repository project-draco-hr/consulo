{
  MyState state=new MyState();
  myEditorSource=source;
  myLineMarker.attach(myEditorSource);
  Editor editor=myEditorSource.getEditor();
  final FileEditor fileEditor=myEditorSource.getFileEditor();
  if (editor == null) {
    insertComponent(fileEditor == null ? MOCK_COMPONENT : fileEditor.getComponent());
    DataManager.registerDataProvider(myPanel,new DataProvider(){
      @Override public Object getData(      @NonNls String dataId){
        if (CommonDataKeys.PROJECT.is(dataId)) {
          return project;
        }
        if (PlatformDataKeys.FILE_EDITOR.is(dataId)) {
          return fileEditor;
        }
        return null;
      }
    }
);
    if (fileEditor != null) {
      ScrollUtil.scrollVertically(fileEditor.getComponent(),0);
      ScrollUtil.scrollHorizontally(fileEditor.getComponent(),0);
    }
  }
 else {
    DataManager.removeDataProvider(myPanel);
    editor.getScrollingModel().scrollHorizontally(0);
    insertComponent(editor.getComponent());
    applyHighlighter();
    setMouseListeners(source);
    MyEditorFocusListener.install(this);
    state.restore();
  }
}
