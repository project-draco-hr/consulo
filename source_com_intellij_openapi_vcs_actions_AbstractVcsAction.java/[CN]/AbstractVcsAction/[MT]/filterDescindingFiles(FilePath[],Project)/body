{
  ProjectFileIndex fileIndex=ProjectRootManager.getInstance(project).getFileIndex();
  List<FilePath> result=new ArrayList<FilePath>(Arrays.asList(roots));
  for (int i=0; i < roots.length; i++) {
    FilePath first=roots[i];
    for (int j=0; j < roots.length; j++) {
      FilePath second=roots[j];
      Module firstModule=getModuleForPath(fileIndex,first);
      Module secondModule=getModuleForPath(fileIndex,second);
      if ((first != second) && (firstModule == secondModule) && VfsUtil.isAncestor(first.getIOFile(),second.getIOFile(),false)) {
        result.remove(second);
      }
    }
  }
  return result.toArray(new FilePath[result.size()]);
}
