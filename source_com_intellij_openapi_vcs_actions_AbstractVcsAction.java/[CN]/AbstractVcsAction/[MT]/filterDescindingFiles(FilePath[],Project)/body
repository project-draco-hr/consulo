{
  ProjectFileIndex fileIndex=ProjectRootManager.getInstance(project).getFileIndex();
  List<FilePath> result=new ArrayList<FilePath>(Arrays.asList(roots));
  for (  FilePath first : roots) {
    for (    FilePath second : roots) {
      Module firstModule=getModuleForPath(fileIndex,first);
      Module secondModule=getModuleForPath(fileIndex,second);
      if ((first != second) && (firstModule == secondModule) && VfsUtil.isAncestor(first.getIOFile(),second.getIOFile(),false)) {
        result.remove(second);
      }
    }
  }
  return result.toArray(new FilePath[result.size()]);
}
