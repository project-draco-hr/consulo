{
  return new Consumer<MouseEvent>(){
    public void consume(    MouseEvent mouseEvent){
      final Project project=getProject();
      if (project == null) {
        return;
      }
      final FileEditorManager editorManager=FileEditorManager.getInstance(project);
      final VirtualFile[] files=editorManager.getSelectedFiles();
      if (!isReadOnlyApplicableForFiles(files)) {
        return;
      }
      FileDocumentManager.getInstance().saveAllDocuments();
      ApplicationManager.getApplication().runWriteAction(new Runnable(){
        public void run(){
          try {
            ReadOnlyAttributeUtil.setReadOnlyAttribute(files[0],files[0].isWritable());
            myStatusBar.updateWidget(ID());
          }
 catch (          IOException e) {
            Messages.showMessageDialog(project,e.getMessage(),UIBundle.message("error.dialog.title"),Messages.getErrorIcon());
          }
        }
      }
);
    }
  }
;
}
