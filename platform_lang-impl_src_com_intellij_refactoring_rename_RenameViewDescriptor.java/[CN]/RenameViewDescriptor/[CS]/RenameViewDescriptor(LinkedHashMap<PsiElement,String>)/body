{
  myElements=renamesMap.keySet().toArray(new PsiElement[0]);
  Set<String> processedElementsHeaders=new THashSet<String>();
  Set<String> codeReferences=new THashSet<String>();
  for (  final PsiElement element : myElements) {
    LOG.assertTrue(element.isValid(),"Invalid element: " + element.toString());
    String newName=renamesMap.get(element);
    String prefix="";
    if (element instanceof PsiDirectory) {
      String fullName=UsageViewUtil.getLongName(element);
      int lastDot=fullName.lastIndexOf('.');
      if (lastDot >= 0) {
        prefix=fullName.substring(0,lastDot + 1);
      }
    }
    processedElementsHeaders.add(StringUtil.capitalize(RefactoringBundle.message("0.to.be.renamed.to.1.2",UsageViewUtil.getType(element),prefix,newName)));
    codeReferences.add(UsageViewUtil.getType(element) + " " + UsageViewUtil.getLongName(element));
  }
  myProcessedElementsHeader=StringUtil.join(ArrayUtil.toStringArray(processedElementsHeaders),", ");
  myCodeReferencesText=RefactoringBundle.message("references.in.code.to.0",StringUtil.join(ArrayUtil.toStringArray(codeReferences),", "));
}
