{
  if (expression instanceof GrConstructorInvocation)   return null;
  PsiType type=expression.getType();
  if (type instanceof PsiClassType) {
    return ((PsiClassType)type).resolveGenerics().getElement();
  }
  if (type == null && expression instanceof PsiReferenceExpression) {
    JavaResolveResult resolveResult=((PsiReferenceExpression)expression).advancedResolve(false);
    if (resolveResult.getElement() instanceof PsiClass) {
      return (PsiClass)resolveResult.getElement();
    }
  }
  return null;
}
