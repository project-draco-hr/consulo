{
synchronized (TOP_DIRS_LOCK) {
    if (ourTopDirs != null) {
      return ourTopDirs;
    }
    Set<VirtualFile> dirList=new THashSet<VirtualFile>();
    appendDefaultTemplatesFromClassloader(FileTemplateManagerImpl.class.getClassLoader(),dirList);
    PluginDescriptor[] plugins=ApplicationManager.getApplication().getPlugins();
    for (    PluginDescriptor plugin : plugins) {
      appendDefaultTemplatesFromClassloader(plugin.getPluginClassLoader(),dirList);
    }
    ourTopDirs=dirList.toArray(new VirtualFile[dirList.size()]);
    return ourTopDirs;
  }
}
