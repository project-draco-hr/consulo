{
  Object obj=node.getUserObject();
  if ((obj instanceof ToDoRootNode) || (obj instanceof SummaryNode) || (obj instanceof TodoDirNode)|| (obj instanceof TodoPackageNode)|| (obj instanceof ModuleToDoNode)) {
    HashSet<PsiFile> files=new HashSet<PsiFile>();
    NodeDescriptor descriptor=(NodeDescriptor)obj;
    collectFilesForElement(descriptor.getElement(),files);
    return files.toArray(new PsiFile[files.size()]);
  }
 else   if (obj instanceof TodoFileNode) {
    PsiFile psiFile=((TodoFileNode)obj).getValue();
    return new PsiFile[]{psiFile};
  }
 else   if (obj instanceof TodoItemNode) {
    SmartTodoItemPointer pointer=(((TodoItemNode)obj).getValue());
    return new PsiFile[]{pointer.getTodoItem().getFile()};
  }
 else {
    throw new IllegalArgumentException(String.valueOf(obj));
  }
}
