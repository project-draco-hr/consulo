{
  final PsiManager psiManager=PsiManager.getInstance(myProject);
  final ProjectFileIndex fileIndex=ProjectRootManager.getInstance(myProject).getFileIndex();
  ArrayList<PsiFile> psiFileList=new ArrayList<PsiFile>();
  final PsiDirectory[] directories=packageElement.getPackage().getDirectories();
  for (  PsiDirectory directory : directories) {
    final VirtualFile directoryFile=directory.getVirtualFile();
    final Module module=fileIndex.getModuleForFile(directoryFile);
    if (packageElement.getModule() != null && module != null && !packageElement.getModule().equals(module)) {
      continue;
    }
    ArrayList<VirtualFile> files=myFileTree.getFiles(directoryFile);
    for (    VirtualFile file : files) {
      if (file.isValid()) {
        PsiFile psiFile=psiManager.findFile(file);
        if (psiFile != null) {
          psiFileList.add(psiFile);
        }
      }
    }
  }
  return psiFileList.iterator();
}
