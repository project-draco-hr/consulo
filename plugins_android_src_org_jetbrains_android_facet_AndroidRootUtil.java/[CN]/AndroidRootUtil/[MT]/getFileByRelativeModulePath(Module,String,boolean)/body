{
  VirtualFile[] contentRoots=ModuleRootManager.getInstance(module).getContentRoots();
  if (contentRoots.length == 1) {
    String absPath=FileUtil.toSystemIndependentName(contentRoots[0].getPath() + relativePath);
    return LocalFileSystem.getInstance().findFileByPath(absPath);
  }
  String moduleDirPath=new File(module.getModuleFilePath()).getParent();
  if (moduleDirPath != null) {
    String absPath=FileUtil.toSystemIndependentName(moduleDirPath + relativePath);
    VirtualFile file=LocalFileSystem.getInstance().findFileByPath(absPath);
    if (file != null) {
      return file;
    }
  }
  if (lookInContentRoot) {
    for (    VirtualFile contentRoot : contentRoots) {
      String absPath=FileUtil.toSystemIndependentName(contentRoot.getPath() + relativePath);
      VirtualFile file=LocalFileSystem.getInstance().findFileByPath(absPath);
      if (file != null) {
        return file;
      }
    }
  }
  return null;
}
