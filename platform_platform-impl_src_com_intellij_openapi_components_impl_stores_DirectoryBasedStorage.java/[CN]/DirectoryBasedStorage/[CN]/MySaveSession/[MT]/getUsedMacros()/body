{
  if (myUsedMacros == null) {
    if (myPathMacroSubstitutor != null) {
      myPathMacroSubstitutor.reset();
      final Map<String,Map<IFile,Element>> states=myStorageData.myStates;
      for (      Map<IFile,Element> map : states.values()) {
        for (        Element e : map.values()) {
          myPathMacroSubstitutor.collapsePaths((Element)e.clone());
        }
      }
      myUsedMacros=new HashSet<String>(myPathMacroSubstitutor.getUsedMacros());
    }
 else {
      myUsedMacros=new HashSet<String>();
    }
  }
  return myUsedMacros;
}
