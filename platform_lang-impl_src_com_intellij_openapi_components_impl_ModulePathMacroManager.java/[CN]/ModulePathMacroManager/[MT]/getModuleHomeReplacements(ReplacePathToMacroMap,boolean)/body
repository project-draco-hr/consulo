{
  String moduleDir=getModuleDir(myModule.getModuleFilePath());
  if (moduleDir == null)   return;
  File f=new File(moduleDir.replace('/',File.separatorChar));
  final VirtualFile baseDir=myModule.getProject().getBaseDir();
  final String projectParent=baseDir != null && baseDir.getParent() != null ? PathMacroMap.quotePath(baseDir.getParent().getPath()) : null;
  String macro="$" + PathMacrosImpl.MODULE_DIR_MACRO_NAME + "$";
  boolean check=false;
  while (f != null) {
    @NonNls String path=PathMacroMap.quotePath(f.getAbsolutePath());
    String s=macro;
    if (projectParent != null && path.equals(projectParent)) {
      break;
    }
    if (StringUtil.endsWithChar(path,'/'))     s+="/";
    if (path.equals("/"))     break;
    putIfAbsent(result,"file://" + path,"file://" + s,check);
    putIfAbsent(result,"file:/" + path,"file:/" + s,check);
    putIfAbsent(result,"file:" + path,"file:" + s,check);
    putIfAbsent(result,"jar://" + path,"jar://" + s,check);
    putIfAbsent(result,"jar:/" + path,"jar:/" + s,check);
    putIfAbsent(result,"jar:" + path,"jar:" + s,check);
    if (!path.equalsIgnoreCase("e:/") && !path.equalsIgnoreCase("r:/") && !path.equalsIgnoreCase("p:/")) {
      putIfAbsent(result,path,s,check);
    }
    if (!addRelativePathMacros)     break;
    macro+="/..";
    check=true;
    f=f.getParentFile();
  }
}
