{
  final ReplacePathToMacroMap result=super.getReplacePathMap();
  if (!myModule.isDisposed()) {
    final String modulePath=getModuleDir(myModule.getModuleFilePath());
    addFileHierarchyReplacements(result,PathMacrosImpl.MODULE_DIR_MACRO_NAME,modulePath,PathMacrosImpl.getUserHome());
    final VirtualFile moduleFile=myModule.getModuleFile();
    if (moduleFile != null) {
      final String moduleDir=getModuleDir(moduleFile.getPath());
      if (!pathsEqual(moduleDir,modulePath)) {
        addFileHierarchyReplacements(result,PathMacrosImpl.MODULE_DIR_MACRO_NAME,moduleDir,PathMacrosImpl.getUserHome());
      }
    }
  }
  return result;
}
