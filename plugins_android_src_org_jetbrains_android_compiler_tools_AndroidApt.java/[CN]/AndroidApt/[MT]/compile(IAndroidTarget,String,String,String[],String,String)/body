{
  List<String> args=new ArrayList<String>();
  Collections.addAll(args,target.getPath(IAndroidTarget.AAPT),"package","-m","-J",outDir,"-M",manifestPath);
  if (resourceDirs.length > 1) {
    args.add("--auto-add-overlay");
  }
  for (  String resourceDir : resourceDirs) {
    args.add("-S");
    args.add(resourceDir);
  }
  if (customPackage != null) {
    args.add("--custom-package");
    args.add(customPackage);
  }
  if (assertsDir != null) {
    Collections.addAll(args,"-A",assertsDir);
  }
  Collections.addAll(args,"-I",target.getPath(IAndroidTarget.ANDROID_JAR));
  LOG.info(AndroidUtils.command2string(args));
  return ExecutionUtil.execute(ArrayUtil.toStringArray(args));
}
