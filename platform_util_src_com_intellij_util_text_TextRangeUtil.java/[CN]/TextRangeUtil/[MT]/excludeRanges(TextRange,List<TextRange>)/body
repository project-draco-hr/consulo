{
  if (!excludedRanges.isEmpty()) {
    List<TextRange> enabledRanges=new ArrayList<TextRange>();
    if (excludedRanges.size() > 1) {
      Collections.sort(excludedRanges,RANGE_COMPARATOR);
    }
    int enabledRangeStart=original.getStartOffset();
    for (    TextRange excludedRange : excludedRanges) {
      if (excludedRange.getEndOffset() < enabledRangeStart)       continue;
      int excludedRangeStart=excludedRange.getStartOffset();
      if (excludedRangeStart > original.getEndOffset())       break;
      if (excludedRangeStart > enabledRangeStart) {
        enabledRanges.add(new TextRange(enabledRangeStart,excludedRangeStart));
      }
      enabledRangeStart=excludedRange.getEndOffset();
    }
    if (enabledRangeStart < original.getEndOffset()) {
      enabledRanges.add(new TextRange(enabledRangeStart,original.getEndOffset()));
    }
    return enabledRanges;
  }
  return Arrays.asList(original);
}
