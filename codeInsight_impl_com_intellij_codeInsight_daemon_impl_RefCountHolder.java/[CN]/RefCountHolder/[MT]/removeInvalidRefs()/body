{
  assertIsAnalyzing();
  for (Iterator<PsiReference> iterator=myLocalRefsMap.keySet().iterator(); iterator.hasNext(); ) {
    PsiReference ref=iterator.next();
    if (!ref.getElement().isValid()) {
      PsiElement value=myLocalRefsMap.get(ref);
      iterator.remove();
      List<PsiReference> array=myLocalRefsMap.getKeysByValue(value);
      LOG.assertTrue(array != null);
      array.remove(ref);
    }
  }
  for (Iterator<PsiReference> iterator=myImportStatements.keySet().iterator(); iterator.hasNext(); ) {
    PsiReference ref=iterator.next();
    if (!ref.getElement().isValid()) {
      iterator.remove();
    }
  }
  for (Iterator<PsiNamedElement> iterator=myDclsUsedMap.keySet().iterator(); iterator.hasNext(); ) {
    PsiNamedElement element=iterator.next();
    if (!element.isValid())     iterator.remove();
  }
  for (Iterator<PsiNamedElement> iterator=myUsedElements.iterator(); iterator.hasNext(); ) {
    PsiNamedElement element=iterator.next();
    if (!element.isValid())     iterator.remove();
  }
}
