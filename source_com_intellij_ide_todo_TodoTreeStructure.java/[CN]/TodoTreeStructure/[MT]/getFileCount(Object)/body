{
  LOG.assertTrue(element != null);
  int count=0;
  if (element instanceof PsiFile) {
    count=1;
  }
 else   if (element instanceof PsiDirectory) {
    Iterator<PsiFile> iterator=myBuilder.getFiles((PsiDirectory)element);
    while (iterator.hasNext()) {
      PsiFile psiFile=iterator.next();
      if (accept(psiFile)) {
        count++;
      }
    }
  }
 else   if (element instanceof ToDoSummary) {
    for (Iterator i=myBuilder.getAllFiles(); i.hasNext(); ) {
      PsiFile psiFile=(PsiFile)i.next();
      if (psiFile == null) {
        continue;
      }
      if (accept(psiFile)) {
        count++;
      }
    }
  }
 else {
    throw new IllegalArgumentException("unknown element: " + element);
  }
  return count;
}
