{
  if (!line.endsWith(RIGHT)) {
    return false;
  }
  if (!myStateStack.isEmpty() && myStateStack.peek() == State.LEFT) {
    if (myStateStack.size() > 1) {
      appendToMainOrCurrent(line);
    }
 else {
      final String fragment=line.substring(0,line.length() - LENGTH);
      if (!fragment.isEmpty()) {
        appendToMainOrCurrent(fragment);
      }
    }
    myStateStack.pop();
    myStateStack.push(State.RIGHT);
  }
 else {
    appendToMainOrCurrent(line);
  }
  return true;
}
