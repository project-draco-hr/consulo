{
  final List<FilePath> changedPaths=ObjectsConvertor.vf2fp(Arrays.asList(changedFiles));
  VcsDirtyScopeManagerImpl.getInstance(myProject).markEverythingDirty();
  myDirtyScope.addDirtyDirRecursively(new FilePathImpl(myRepo.getDir()));
  MockChangelistBuilder builder=new MockChangelistBuilder();
  myChangeProvider.getChanges(myDirtyScope,builder,new EmptyProgressIndicator(),new MockChangeListManagerGate(ChangeListManager.getInstance(myProject)));
  List<Change> changes=builder.getChanges();
  final Map<FilePath,Change> result=new HashMap<FilePath,Change>();
  for (  Change change : changes) {
    VirtualFile file=change.getVirtualFile();
    FilePath filePath=null;
    if (file == null) {
      String path=change.getBeforeRevision().getFile().getPath();
      for (      FilePath fp : changedPaths) {
        if (fp.getPath().equals(path)) {
          filePath=fp;
          break;
        }
      }
    }
 else {
      filePath=new FilePathImpl(file);
    }
    result.put(filePath,change);
  }
  return result;
}
