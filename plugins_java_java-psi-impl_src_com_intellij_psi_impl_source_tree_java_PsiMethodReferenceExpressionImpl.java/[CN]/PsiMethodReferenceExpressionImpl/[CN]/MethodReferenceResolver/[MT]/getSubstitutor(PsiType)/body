{
  final PsiClassType.ClassResolveResult resolveResult=PsiUtil.resolveGenericsClassInType(GenericsUtil.eliminateWildcards(type));
  PsiSubstitutor psiSubstitutor=resolveResult.getSubstitutor();
  if (type instanceof PsiClassType) {
    final PsiClass psiClass=resolveResult.getElement();
    if (psiClass instanceof PsiTypeParameter) {
      for (      PsiClass aClass : psiClass.getSupers()) {
        psiSubstitutor=psiSubstitutor.putAll(TypeConversionUtil.getSuperClassSubstitutor(aClass,(PsiClassType)type));
      }
    }
  }
  return psiSubstitutor;
}
