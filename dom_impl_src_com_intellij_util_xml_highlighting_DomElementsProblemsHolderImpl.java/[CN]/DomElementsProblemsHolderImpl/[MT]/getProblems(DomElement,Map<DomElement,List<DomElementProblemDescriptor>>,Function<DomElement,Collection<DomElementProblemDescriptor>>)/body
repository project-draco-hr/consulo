{
  final Collection<DomElementProblemDescriptor> list=map.get(domElement);
  if (list != null) {
    return new ArrayList<DomElementProblemDescriptor>(list);
  }
  final List<DomElementProblemDescriptor> problems=new ArrayList<DomElementProblemDescriptor>(function.fun(domElement));
  domElement.acceptChildren(new DomElementVisitor(){
    public void visitDomElement(    DomElement element){
      problems.addAll(getProblems(element,map,function));
    }
  }
);
  map.put(domElement,problems);
  return problems;
}
