{
  if (!element.isValid())   return true;
  final Project project=element.getProject();
  ProjectFileIndex projectFileIndex=ProjectRootManager.getInstance(project).getFileIndex();
  final PsiFile file=element.getContainingFile();
  if (file == null)   return true;
  VirtualFile vFile=file.getVirtualFile();
  final Module module=vFile == null ? null : projectFileIndex.getModuleForFile(vFile);
  return module == null ? !projectFileIndex.isInLibraryClasses(vFile) : module.isDisposed();
}
