{
  EditorEx editor=myConsoleView.getConsoleEditor();
  boolean enabled=!editor.isRendererMode() && isEnabled() && (myExecuteActionHandler.isEmptyCommandExecutionAllowed() || !StringUtil.isEmptyOrSpaces(editor.getDocument().getCharsSequence()));
  if (enabled) {
    Lookup lookup=LookupManager.getActiveLookup(editor);
    enabled=lookup == null || !lookup.isCompletion() || lookup.getCurrentItem() == null || (lookup instanceof LookupImpl && ((LookupImpl)lookup).getFocusDegree() == LookupImpl.FocusDegree.UNFOCUSED);
  }
  e.getPresentation().setEnabled(enabled);
}
