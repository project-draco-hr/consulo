{
  LookupElementPresentation presentation=LookupElementPresentation.renderElement(item);
  String text=presentation.getItemText();
  if (text == null) {
    text=item.getLookupString();
  }
  String tailText=presentation.getTailText();
  if (tailText != null && tailText.startsWith("(") && tailText.contains(")")) {
    Editor editor=lookup.getEditor();
    CharSequence seq=editor.getDocument().getCharsSequence();
    int caret=editor.getCaretModel().getOffset();
    if (caret >= seq.length() || seq.charAt(caret) != '(') {
      return text + "()";
    }
  }
  return text;
}
