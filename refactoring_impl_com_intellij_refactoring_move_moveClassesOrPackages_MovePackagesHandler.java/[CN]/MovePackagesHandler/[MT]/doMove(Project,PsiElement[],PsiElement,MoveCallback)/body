{
  if (targetContainer == null && canMoveOrRearrangePackages(elements)) {
    PsiDirectory[] directories=new PsiDirectory[elements.length];
    System.arraycopy(elements,0,directories,0,directories.length);
    SelectMoveOrRearrangePackageDialog dialog=new SelectMoveOrRearrangePackageDialog(project,directories);
    dialog.show();
    if (!dialog.isOK())     return;
    if (dialog.isPackageRearrageSelected()) {
      MoveClassesOrPackagesImpl.doRearrangePackage(project,directories);
      return;
    }
    if (dialog.isMoveDirectory()) {
      MoveFilesOrDirectoriesUtil.doMove(project,elements,targetContainer,null);
      return;
    }
  }
  super.doMove(project,elements,targetContainer,callback);
}
