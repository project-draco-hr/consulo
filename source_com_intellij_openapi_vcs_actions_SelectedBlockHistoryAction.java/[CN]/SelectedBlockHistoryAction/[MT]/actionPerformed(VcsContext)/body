{
  try {
    VcsSelection selection=VcsSelectionUtil.getSelection(context);
    VirtualFile file=FileDocumentManager.getInstance().getFile(selection.getDocument());
    Project project=context.getProject();
    AbstractVcs activeVcs=ProjectLevelVcsManager.getInstance(project).getVcsFor(file);
    if (activeVcs == null)     return;
    VcsHistoryProvider provider=activeVcs.getVcsBlockHistoryProvider();
    int selectionStart=selection.getSelectionStartLineNumber();
    int selectionEnd=selection.getSelectionEndLineNumber();
    VcsHistorySession session=provider.createSessionFor(new FilePathImpl(file));
    if (session == null)     return;
    VcsBlockHistoryDialog vcsHistoryDialog=new VcsBlockHistoryDialog(project,context.getSelectedFiles()[0],activeVcs,provider,session,Math.min(selectionStart,selectionEnd),Math.max(selectionStart,selectionEnd));
    vcsHistoryDialog.show();
  }
 catch (  Exception exception) {
    reportError(exception);
  }
}
