{
  int startOffset=myEditor.getSelectionModel().getSelectionStart();
  int endOffset=myEditor.getSelectionModel().getSelectionEnd();
  PsiExpression expr=CodeInsightUtil.findExpressionInRange(myFile,startOffset,endOffset);
  if (expr == null)   return false;
  PsiMethod method=Util.getContainingMethod(expr);
  if (method == null)   return false;
  final PsiMethod methodToSearchFor;
  if (searchForSuper) {
    methodToSearchFor=method.findDeepestSuperMethod();
  }
 else {
    methodToSearchFor=method;
  }
  TIntArrayList parametersToRemove=removeUnusedParameters ? Util.findParametersToRemove(method,expr) : new TIntArrayList();
  new IntroduceParameterProcessor(myProject,method,methodToSearchFor,expr,expr,null,true,parameterName,replaceAllOccurences,replaceFieldsWithGetters,declareFinal,generateDelegate,null,parametersToRemove).run();
  myEditor.getSelectionModel().removeSelection();
  return true;
}
