{
  final FileContent oldFC=oldContent != null ? new FileContent(file,oldContent) : null;
  final boolean isValidFile=file.isValid();
  FileContent currentFC=null;
  boolean fileContentLoaded=false;
  for (  String indexKey : myIndices.keySet()) {
    if (!isValidFile || getInputFilter(indexKey).acceptInput(file)) {
      if (!fileContentLoaded) {
        fileContentLoaded=true;
        currentFC=isValidFile ? new FileContent(file,loadContent(file)) : null;
      }
      try {
        updateSingleIndex(indexKey,file,currentFC,oldFC);
      }
 catch (      StorageException e) {
        LOG.error(e);
      }
    }
  }
}
