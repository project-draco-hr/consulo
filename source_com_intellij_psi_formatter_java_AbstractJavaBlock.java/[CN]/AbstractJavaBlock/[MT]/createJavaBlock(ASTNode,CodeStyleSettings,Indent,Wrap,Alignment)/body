{
  Indent actualIndent=indent == null ? getDefaultSubtreeIndent(child) : indent;
  final IElementType elementType=child.getElementType();
  if (child.getPsi() instanceof PsiClass) {
    return new CodeBlockBlock(child,wrap,alignment,actualIndent,settings);
  }
  if (isBlockType(elementType)) {
    return new BlockContainingJavaBlock(child,wrap,alignment,actualIndent,settings);
  }
  if (isStatement(child,child.getTreeParent())) {
    return new CodeBlockBlock(child,wrap,alignment,actualIndent,settings);
  }
  if (child instanceof LeafElement) {
    return new LeafBlock(child,wrap,alignment,actualIndent);
  }
 else   if (isLikeExtendsList(elementType)) {
    return new ExtendsListBlock(child,wrap,alignment,settings);
  }
 else   if (elementType == ElementType.CODE_BLOCK) {
    return new CodeBlockBlock(child,wrap,alignment,actualIndent,settings);
  }
 else   if (elementType == ElementType.LABELED_STATEMENT) {
    return new LabeledJavaBlock(child,wrap,alignment,actualIndent,settings);
  }
 else   if (elementType == JavaDocElementType.DOC_COMMENT) {
    return new DocCommentBlock(child,wrap,alignment,actualIndent,settings);
  }
 else {
    return new SimpleJavaBlock(child,wrap,alignment,actualIndent,settings);
  }
}
