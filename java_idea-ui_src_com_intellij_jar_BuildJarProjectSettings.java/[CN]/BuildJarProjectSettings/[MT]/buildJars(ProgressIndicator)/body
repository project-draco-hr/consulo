{
  Module[] modules=ModuleManager.getInstance(myProject).getModules();
  try {
    for (    Module module : modules) {
      BuildJarSettings buildJarSettings=BuildJarSettings.getInstance(module);
      if (buildJarSettings == null || !buildJarSettings.isBuildJar())       continue;
      String presentableJarPath="'" + FileUtil.toSystemDependentName(VfsUtil.urlToPath(buildJarSettings.getJarUrl() + "'"));
      if (progressIndicator != null) {
        progressIndicator.setText(IdeBundle.message("jar.build.progress",presentableJarPath));
      }
      buildJar(module,buildJarSettings,progressIndicator,null);
      WindowManager.getInstance().getStatusBar(myProject).setInfo(IdeBundle.message("jar.build.success.message",presentableJarPath));
    }
  }
 catch (  ProcessCanceledException e) {
    WindowManager.getInstance().getStatusBar(myProject).setInfo(IdeBundle.message("jar.build.cancelled"));
  }
catch (  final IOException e) {
    ApplicationManager.getApplication().invokeLater(new Runnable(){
      public void run(){
        Messages.showErrorDialog(myProject,e.toString(),IdeBundle.message("jar.build.error.title"));
      }
    }
);
  }
}
