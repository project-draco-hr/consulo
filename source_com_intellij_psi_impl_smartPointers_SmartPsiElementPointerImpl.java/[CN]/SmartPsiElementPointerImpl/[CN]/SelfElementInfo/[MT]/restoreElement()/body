{
  if (!mySyncMarkerIsValid)   return null;
  if (!myFile.isValid())   return null;
  PsiElement anchor=myFile.findElementAt(mySyncStartOffset);
  if (anchor == null)   return null;
  TextRange range=anchor.getTextRange();
  if (range.getStartOffset() != mySyncStartOffset)   return null;
  while (range.getEndOffset() < mySyncEndOffset) {
    anchor=anchor.getParent();
    if (anchor == null || anchor.getTextRange() == null)     break;
    range=anchor.getTextRange();
  }
  while (range.getEndOffset() == mySyncEndOffset && anchor != null && !myType.equals(anchor.getClass())) {
    anchor=anchor.getParent();
    if (anchor == null || anchor.getTextRange() == null)     break;
    range=anchor.getTextRange();
  }
  if (range.getEndOffset() == mySyncEndOffset)   return anchor;
  return null;
}
