{
  final GroovyPsiElementFactory factory=GroovyPsiElementFactory.getInstance(context.project);
  final GrMethod method=factory.createMethodFromText("def doCall(){}");
  method.setReturnType(block.getReturnType());
  final PsiElement first;
  if (block.hasParametersSection()) {
    method.getParameterList().replace(block.getParameterList());
    final PsiElement arrow=block.getArrow();
    LOG.assertTrue(arrow != null);
    first=arrow.getNextSibling();
  }
 else {
    final GrParameter[] allParameters=block.getAllParameters();
    LOG.assertTrue(allParameters.length == 1);
    final GrParameter itParameter=allParameters[0];
    final GrParameter parameter=factory.createParameter("it",itParameter.getType().getCanonicalText(),"null",block);
    method.getParameterList().addParameterToEnd(parameter);
    final PsiElement lBrace=block.getLBrace();
    LOG.assertTrue(lBrace != null);
    first=lBrace.getNextSibling();
  }
  final PsiElement rBrace=block.getRBrace();
  final PsiElement last=rBrace != null ? rBrace.getPrevSibling() : block.getLastChild();
  final GrOpenBlock methodBlock=method.getBlock();
  methodBlock.addRange(first,last);
  return method;
}
