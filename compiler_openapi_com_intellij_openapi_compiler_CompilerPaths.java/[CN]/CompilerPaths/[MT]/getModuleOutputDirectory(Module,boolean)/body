{
  final CompilerModuleExtension compilerModuleExtension=CompilerModuleExtension.getInstance(module);
  VirtualFile outPath;
  if (forTestClasses) {
    final VirtualFile path=compilerModuleExtension.getCompilerOutputPathForTests();
    if (path != null) {
      outPath=path;
    }
 else {
      outPath=compilerModuleExtension.getCompilerOutputPath();
    }
  }
 else {
    outPath=compilerModuleExtension.getCompilerOutputPath();
  }
  if (outPath == null) {
    return null;
  }
  if (!outPath.isValid()) {
    LOG.info("Requested output path for module " + module.getName() + " is not valid");
    return null;
  }
  return outPath;
}
