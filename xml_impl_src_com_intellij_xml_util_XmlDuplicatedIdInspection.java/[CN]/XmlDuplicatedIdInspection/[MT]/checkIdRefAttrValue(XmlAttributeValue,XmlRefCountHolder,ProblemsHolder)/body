{
  if (!(value.getParent() instanceof XmlAttribute))   return;
  XmlAttribute attribute=(XmlAttribute)value.getParent();
  XmlTag tag=attribute.getParent();
  XmlElementDescriptor elementDescriptor=tag.getDescriptor();
  if (elementDescriptor == null)   return;
  XmlAttributeDescriptor attributeDescriptor=elementDescriptor.getAttributeDescriptor(attribute);
  if (attributeDescriptor == null)   return;
  if (attributeDescriptor.hasIdRefType() && tag.getParent().getUserData(XmlHighlightVisitor.DO_NOT_VALIDATE_KEY) == null) {
    String unquotedValue=XmlHighlightVisitor.getUnquotedValue(value,tag);
    if (XmlUtil.isSimpleXmlAttributeValue(unquotedValue,value)) {
      XmlAttribute xmlAttribute=holder.getAttributeById(unquotedValue);
      if (xmlAttribute == null && tag instanceof HtmlTag) {
        xmlAttribute=holder.getAttributeById(StringUtil.stripQuotesAroundValue(value.getText()));
      }
      if (xmlAttribute == null || !xmlAttribute.isValid()) {
        problemsHolder.registerProblem(value,XmlErrorMessages.message("invalid.id.reference"),ProblemHighlightType.LIKE_UNKNOWN_SYMBOL);
      }
    }
  }
}
