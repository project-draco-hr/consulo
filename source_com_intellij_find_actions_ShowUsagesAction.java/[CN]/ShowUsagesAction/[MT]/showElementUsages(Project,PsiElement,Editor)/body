{
  ArrayList<Usage> usages=new ArrayList<Usage>();
  CommonProcessors.CollectProcessor<Usage> collect=new CommonProcessors.CollectProcessor<Usage>(usages);
  UsageViewPresentation presentation=((FindManagerImpl)FindManager.getInstance(project)).getFindUsagesManager().processUsages(element,collect);
  if (presentation == null)   return;
  if (usages.isEmpty()) {
    HintManager.getInstance().showInformationHint(editor,FindBundle.message("find.usage.view.no.usages.text"));
  }
 else   if (usages.size() == 1) {
    Usage usage=usages.iterator().next();
    usage.navigate(true);
    FileEditorLocation location=usage.getLocation();
    FileEditor newFileEditor=location == null ? null : location.getEditor();
    final Editor newEditor=newFileEditor instanceof TextEditor ? ((TextEditor)newFileEditor).getEditor() : null;
    if (newEditor != null) {
      SwingUtilities.invokeLater(new Runnable(){
        public void run(){
          newEditor.getScrollingModel().runActionOnScrollingFinished(new Runnable(){
            public void run(){
              SwingUtilities.invokeLater(new Runnable(){
                public void run(){
                  HintManager.getInstance().showInformationHint(newEditor,FindBundle.message("show.usages.only.usage"));
                }
              }
);
            }
          }
);
        }
      }
);
    }
  }
 else {
    Processor<Usage> doNavigate=new Processor<Usage>(){
      public boolean process(      final Usage usage){
        usage.navigate(true);
        return false;
      }
    }
;
    final String title=presentation.getTabText();
    getUsagePopup(usages,title,doNavigate,project).showInBestPositionFor(editor);
  }
}
