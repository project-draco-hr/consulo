{
synchronized (LOCK) {
    final Project project=module.getProject();
    module.putUserData(WAIT_FOR_IMPORTING_DEPENDENCIES_KEY,Boolean.TRUE);
    if (project.getUserData(WAIT_FOR_IMPORTING_DEPENDENCIES_KEY) != Boolean.TRUE) {
      project.putUserData(WAIT_FOR_IMPORTING_DEPENDENCIES_KEY,Boolean.TRUE);
      StartupManager.getInstance(project).runWhenProjectIsInitialized(new Runnable(){
        @Override public void run(){
          ApplicationManager.getApplication().invokeLater(new Runnable(){
            @Override public void run(){
              importDependenciesForMarkedModules(project,updateBackwardDependencies);
            }
          }
);
        }
      }
);
    }
  }
}
