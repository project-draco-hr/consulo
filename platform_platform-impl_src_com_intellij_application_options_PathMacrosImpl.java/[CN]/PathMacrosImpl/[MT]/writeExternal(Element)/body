{
  final Set<Map.Entry<String,String>> entries=myMacros.entrySet();
  for (  Map.Entry<String,String> entry : entries) {
    final String value=entry.getValue();
    if (value != null && value.trim().length() > 0) {
      final Element macro=new Element(MACRO_ELEMENT);
      macro.setAttribute(NAME_ATTR,entry.getKey());
      macro.setAttribute(VALUE_ATTR,value);
      element.addContent(macro);
    }
  }
  for (  final String macro : myIgnoredMacros) {
    final Element macroElement=new Element(IGNORED_MACRO_ELEMENT);
    macroElement.setAttribute(NAME_ATTR,macro);
    element.addContent(macroElement);
  }
}
