{
  for (  final String name : getUserMacroNames()) {
    final String value=getValue(name);
    if (value != null && value.trim().length() > 0)     result.addMacroExpand(name,value);
  }
  myLock.readLock().lock();
  try {
    for (    Map.Entry<String,String> entry : myLegacyMacros.entrySet()) {
      result.addMacroExpand(entry.getKey(),entry.getValue());
    }
  }
  finally {
    myLock.readLock().unlock();
  }
}
