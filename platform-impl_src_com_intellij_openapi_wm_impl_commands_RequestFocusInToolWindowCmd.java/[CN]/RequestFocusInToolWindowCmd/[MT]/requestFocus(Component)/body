{
  final Component owner=KeyboardFocusManager.getCurrentKeyboardFocusManager().getPermanentFocusOwner();
  if (owner != null && owner == c) {
    myManager.getFocusManager().requestFocus(new FocusCommand(){
      public ActionCallback run(){
        if (c.isFocusOwner()) {
          myFocusWatcher.setFocusedComponentImpl(c);
        }
        return new ActionCallback.Done();
      }
    }
,myForced).doWhenDone(new Runnable(){
      public void run(){
        updateFocusedComponentForWatcher(c);
        if (myToolWindow.isAvailable() && !myToolWindow.isActive()) {
          myToolWindow.activate(null);
        }
      }
    }
);
  }
 else {
    myManager.getFocusManager().requestFocus(new FocusCommand.ByComponent(c,myToolWindow.getComponent()),myForced).doWhenDone(new Runnable(){
      public void run(){
        updateFocusedComponentForWatcher(c);
        if (myToolWindow.isAvailable() && !myToolWindow.isActive()) {
          myToolWindow.activate(null);
        }
      }
    }
);
  }
}
