{
  final Component owner=KeyboardFocusManager.getCurrentKeyboardFocusManager().getPermanentFocusOwner();
  if (owner != null && owner == c) {
    myManager.getFocusManager().requestFocus(new ActionCallback.Runnable(){
      public ActionCallback run(){
        myFocusWatcher.setFocusedComponentImpl(c);
        return new ActionCallback.Done();
      }
    }
,myForced).doWhenDone(new Runnable(){
      public void run(){
        updateFocusedComponentForWatcher(c);
        if (myToolWindow.isAvailable() && !myToolWindow.isActive()) {
          myToolWindow.activate(null);
        }
      }
    }
);
  }
 else {
    myManager.getFocusManager().requestFocus(c,myForced).doWhenDone(new Runnable(){
      public void run(){
        updateFocusedComponentForWatcher(c);
        if (myToolWindow.isAvailable() && !myToolWindow.isActive()) {
          myToolWindow.activate(null);
        }
      }
    }
);
  }
}
