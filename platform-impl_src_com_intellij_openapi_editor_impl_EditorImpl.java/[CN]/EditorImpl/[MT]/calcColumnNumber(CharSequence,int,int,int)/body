{
  IterationState state=new IterationState(this,start,false);
  int fontType=state.getMergedAttributes().getFontType();
  int column=0;
  int x=0;
  int spaceSize=getSpaceWidth(fontType);
  for (int i=start; i < offset; i++) {
    if (i >= state.getEndOffset()) {
      state.advance();
      fontType=state.getMergedAttributes().getFontType();
    }
    char c=text.charAt(i);
    if (c == '\t') {
      int prevX=x;
      x=nextTabStop(x);
      column+=((x - prevX) / spaceSize);
    }
 else {
      x+=charWidth(c,fontType);
      column++;
    }
  }
  return column;
}
