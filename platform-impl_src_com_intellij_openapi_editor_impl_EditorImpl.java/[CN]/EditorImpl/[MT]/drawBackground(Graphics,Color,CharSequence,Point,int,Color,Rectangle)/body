{
  int w=getTextSegmentWidth(text,position.x,fontType,clip);
  if (backColor != null && !backColor.equals(defaultBackground) && clip.intersects(position.x,position.y,w,getLineHeight())) {
    if (backColor.equals(myLastBackgroundColor) && myLastBackgroundPosition.y == position.y && myLastBackgroundPosition.x + myLastBackgroundWidth == position.x) {
      myLastBackgroundWidth+=w;
    }
 else {
      flushBackground(g,clip);
      myLastBackgroundColor=backColor;
      myLastBackgroundPosition=new Point(position);
      myLastBackgroundWidth=w;
    }
  }
  return position.x + w;
}
