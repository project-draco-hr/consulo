{
  assertIsDispatchThread();
  final Document document=getDocument();
  if (myHighlighter != null) {
    document.removeDocumentListener(myHighlighter);
  }
  document.addDocumentListener(highlighter);
  highlighter.setEditor(this);
  highlighter.setText(document.getCharsSequence());
  myHighlighter=highlighter;
  if (document instanceof DocumentImpl) {
    ((DocumentImpl)document).rememberEditorHighlighterForCachesOptimization(highlighter);
  }
  if (myPanel != null) {
    reinitSettings();
  }
}
