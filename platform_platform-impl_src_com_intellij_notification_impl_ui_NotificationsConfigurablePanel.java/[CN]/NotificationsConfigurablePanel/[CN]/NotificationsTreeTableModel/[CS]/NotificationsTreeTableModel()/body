{
  super(null);
  List<DefaultMutableTreeNode> rootChildren=new ArrayList<DefaultMutableTreeNode>();
  if (NotificationsManagerImpl.newEnabled()) {
    Map<NotificationParentGroupBean,List<DefaultMutableTreeNode>> parentChildrenTable=new HashMap<NotificationParentGroupBean,List<DefaultMutableTreeNode>>();
    for (    NotificationSettings setting : NotificationsConfigurationImpl.getInstanceImpl().getAllSettings()) {
      SettingsWrapper wrapper=new SettingsWrapper(setting);
      mySettings.add(wrapper);
      NotificationParentGroupBean parentGroup=NotificationParentGroup.findParent(setting);
      DefaultMutableTreeNode treeNode=new DefaultMutableTreeNode(wrapper,false);
      if (parentGroup == null) {
        rootChildren.add(treeNode);
      }
 else {
        wrapper.myTitle=NotificationParentGroup.getReplaceTitle(wrapper.getGroupId());
        if (wrapper.myTitle == null && parentGroup.titlePrefix != null) {
          wrapper.myTitle=StringUtil.substringAfter(wrapper.getGroupId(),parentGroup.titlePrefix);
        }
        List<DefaultMutableTreeNode> children=parentChildrenTable.get(parentGroup);
        if (children == null) {
          parentChildrenTable.put(parentGroup,children=new ArrayList<DefaultMutableTreeNode>());
        }
        children.add(treeNode);
      }
    }
    for (    NotificationParentGroupBean parentGroup : NotificationParentGroup.getParents()) {
      if (parentGroup.parentId == null) {
        DefaultMutableTreeNode node=new DefaultMutableTreeNode(parentGroup);
        addParentGroup(parentGroup,node,parentChildrenTable);
        rootChildren.add(node);
      }
    }
  }
 else {
    for (    NotificationSettings setting : NotificationsConfigurationImpl.getInstanceImpl().getAllSettings()) {
      SettingsWrapper wrapper=new SettingsWrapper(setting);
      mySettings.add(wrapper);
      rootChildren.add(new DefaultMutableTreeNode(wrapper,false));
    }
  }
  Collections.sort(rootChildren,new Comparator<DefaultMutableTreeNode>(){
    @Override public int compare(    DefaultMutableTreeNode node1,    DefaultMutableTreeNode node2){
      Object object1=node1.getUserObject();
      Object object2=node2.getUserObject();
      if (object1 instanceof NotificationParentGroupBean) {
        if (object2 instanceof NotificationParentGroupBean) {
          return object1.toString().compareTo(object2.toString());
        }
        return -1;
      }
      if (object2 instanceof SettingsWrapper) {
        return ((SettingsWrapper)object1).getGroupId().compareTo(((SettingsWrapper)object2).getGroupId());
      }
      return 1;
    }
  }
);
  DefaultMutableTreeNode root=new DefaultMutableTreeNode();
  for (  DefaultMutableTreeNode child : rootChildren) {
    root.add(child);
  }
  setRoot(root);
}
