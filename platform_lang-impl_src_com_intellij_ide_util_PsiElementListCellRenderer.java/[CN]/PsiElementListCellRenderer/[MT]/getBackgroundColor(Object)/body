{
  if (value instanceof PsiElement) {
    final PsiElement psiElement=(PsiElement)value;
    final FileColorManager colorManager=FileColorManager.getInstance(psiElement.getProject());
    if (colorManager.isEnabled()) {
      VirtualFile file=null;
      PsiFile psiFile=psiElement.getContainingFile();
      if (psiFile != null) {
        file=psiFile.getVirtualFile();
      }
 else       if (psiElement instanceof PsiDirectory) {
        file=((PsiDirectory)psiElement).getVirtualFile();
      }
      final Color fileBgColor=file != null ? colorManager.getRendererBackground(file) : null;
      if (fileBgColor != null) {
        return fileBgColor;
      }
    }
  }
  return UIUtil.getListBackground();
}
