{
  if (!newEntryPoint.isValid())   return;
  if (newEntryPoint instanceof RefClass) {
    RefClass refClass=(RefClass)newEntryPoint;
    if (refClass.isAnonymous()) {
      return;
    }
    ArrayList<RefMethod> refConstructors=refClass.getConstructors();
    if (refConstructors.size() == 1) {
      addEntryPoint(refConstructors.get(0),isPersistent);
      return;
    }
 else     if (refConstructors.size() > 1) {
      ArrayList pickedConstructors=ConstructorPicker.pickConstructorsFrom(refClass,refConstructors);
      for (int i=0; i < pickedConstructors.size(); i++) {
        addEntryPoint((RefMethod)pickedConstructors.get(i),isPersistent);
      }
      return;
    }
  }
  if (myFQNameToSmartEntryPointRef.get(newEntryPoint.getExternalName()) == null) {
    final SmartRefElementPointerImpl entry=new SmartRefElementPointerImpl(newEntryPoint,isPersistent);
    myFQNameToSmartEntryPointRef.put(entry.getFQName(),entry);
    ((RefElementImpl)newEntryPoint).setEntry(true);
    ((RefElementImpl)newEntryPoint).setPermanentEntry(entry.isPersistent());
    if (entry.isPersistent()) {
      final EntryPointsManagerImpl entryPointsManager=EntryPointsManagerImpl.getInstance(newEntryPoint.getElement().getProject());
      if (this != entryPointsManager) {
        entryPointsManager.addEntryPoint(newEntryPoint,true);
      }
    }
  }
}
