{
  if (myAllThreadsDirty) {
    myAllThreadsDirty=false;
    List<ThreadReference> threads=myVirtualMachine.allThreads();
    Map<ThreadReference,ThreadReferenceProxyImpl> result=new HashMap<ThreadReference,ThreadReferenceProxyImpl>();
    for (    final ThreadReference threadReference : threads) {
      ThreadReferenceProxyImpl threadReferenceProxy=getThreadReferenceProxy(threadReference);
      LOG.assertTrue(threadReferenceProxy != null);
      result.put(threadReference,threadReferenceProxy);
    }
    myAllThreads=result;
  }
  return myAllThreads.values();
}
