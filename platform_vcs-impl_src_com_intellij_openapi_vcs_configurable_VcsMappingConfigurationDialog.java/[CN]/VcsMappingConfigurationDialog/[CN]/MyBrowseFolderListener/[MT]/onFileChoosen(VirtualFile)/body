{
  String oldText=myDirectoryTextField.getText();
  super.onFileChoosen(chosenFile);
  final VcsDescriptor wrapper=(VcsDescriptor)myVCSComboBox.getSelectedItem();
  if (oldText.length() == 0 && (wrapper == null || wrapper.isNone())) {
    final ModalityIgnorantBackgroundableTask task=new ModalityIgnorantBackgroundableTask(myProject,"Looking for VCS administrative area",false){
      VcsDescriptor probableVcs=null;
      @Override @RequiredDispatchThread protected void doInAwtIfFail(      Exception e){
      }
      @Override @RequiredDispatchThread protected void doInAwtIfCancel(){
      }
      @Override @RequiredDispatchThread protected void doInAwtIfSuccess(){
        if (probableVcs != null) {
          myVCSComboBox.setSelectedItem(probableVcs);
        }
      }
      @Override protected void runImpl(      @NotNull ProgressIndicator indicator){
        for (        VcsDescriptor vcs : myVcses.values()) {
          if (vcs.probablyUnderVcs(chosenFile)) {
            if (probableVcs != null) {
              probableVcs=null;
              break;
            }
            probableVcs=vcs;
          }
        }
      }
    }
;
    ProgressManager.getInstance().run(task);
  }
}
