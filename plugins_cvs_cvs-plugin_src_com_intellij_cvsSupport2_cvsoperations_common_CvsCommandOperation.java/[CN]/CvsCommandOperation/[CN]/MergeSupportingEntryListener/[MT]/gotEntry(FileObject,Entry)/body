{
  final IFileSystem localFileSystem=myClientEnvironment.getCvsFileSystem().getLocalFileSystem();
  final File file=localFileSystem.getFile(fileObject);
  if (myUpdatedFilesManager.fileIsNotUpdated(file)) {
    return;
  }
  final File parent=file.getParentFile();
  final VirtualFile virtualParent=CvsVfsUtil.findFileByIoFile(parent);
  if (entry != null) {
    final Entry previousEntry=myFileToPreviousEntryMap.containsKey(file) ? myFileToPreviousEntryMap.get(file) : CvsEntriesManager.getInstance().getCachedEntry(virtualParent,entry.getFileName());
    if (previousEntry != null) {
      myFileToPreviousEntryMap.put(file,previousEntry);
      if (entry.isResultOfMerge()) {
        final UpdatedFilesManager.CurrentMergedFileInfo info=myUpdatedFilesManager.getInfo(file);
        info.registerNewRevision(previousEntry);
        CvsUtil.saveRevisionForMergedFile(virtualParent,info.getOriginalEntry(),info.getRevisions());
      }
    }
  }
 else {
    myCvsEntriesManager.removeEntryForFile(parent,fileObject.getName());
  }
  if (entry != null) {
    myCvsEntriesManager.setEntryForFile(virtualParent,entry);
  }
  if (entry == null || !entry.isResultOfMerge()) {
    CvsUtil.removeConflict(file);
  }
}
