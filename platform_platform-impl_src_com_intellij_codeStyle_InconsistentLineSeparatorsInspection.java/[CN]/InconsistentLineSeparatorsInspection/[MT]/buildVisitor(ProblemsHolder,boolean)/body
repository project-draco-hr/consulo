{
  return new PsiElementVisitor(){
    @Override public void visitFile(    PsiFile file){
      final Project project=holder.getProject();
      final String projectLineSeparator=CodeStyleFacade.getInstance(project).getLineSeparator();
      if (projectLineSeparator == null) {
        return;
      }
      final VirtualFile virtualFile=file.getVirtualFile();
      if (virtualFile == null || !AbstractConvertLineSeparatorsAction.shouldProcess(virtualFile,project)) {
        return;
      }
      final String curLineSeparator=LoadTextUtil.detectLineSeparator(virtualFile,true);
      if (curLineSeparator != null && !curLineSeparator.equals(projectLineSeparator)) {
        holder.registerProblem(file,"Line separators in the current file (" + StringUtil.escapeStringCharacters(curLineSeparator) + ") "+ "differ from the project defaults ("+ StringUtil.escapeStringCharacters(projectLineSeparator)+ ")",SET_PROJECT_LINE_SEPARATORS);
      }
    }
  }
;
}
