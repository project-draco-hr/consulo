def changedlines(ui, repo, ctx1, ctx2, fns):
    (added, removed) = (0, 0)
    fmatch = cmdutil.matchfiles(repo, fns)
    diff = ''.join(patch.diff(repo, ctx1.node(), ctx2.node(), fmatch))
    for l in diff.split('\n'):
        if (l.startswith('+') and (not l.startswith('+++ '))):
            added += 1
        elif (l.startswith('-') and (not l.startswith('--- '))):
            removed += 1
    return (added, removed)
