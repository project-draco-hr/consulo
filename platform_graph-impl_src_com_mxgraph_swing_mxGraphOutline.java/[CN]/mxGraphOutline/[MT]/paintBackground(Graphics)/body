{
  if (graphComponent != null) {
    Graphics2D g2=(Graphics2D)g;
    AffineTransform tx=g2.getTransform();
    try {
      g.setColor(graphComponent.getPageBackgroundColor());
      mxUtils.fillClippedRect(g,0,0,getWidth(),getHeight());
      g2.translate(translate.x,translate.y);
      g2.scale(scale,scale);
      if (!graphComponent.isPageVisible()) {
        Color bg=graphComponent.getBackground();
        if (graphComponent.getViewport().isOpaque()) {
          bg=graphComponent.getViewport().getBackground();
        }
        g.setColor(bg);
        Dimension size=graphComponent.getGraphControl().getSize();
        mxUtils.fillClippedRect(g,0,0,size.width,size.height);
        g.setColor(g.getColor().darker().darker());
        g.drawRect(0,0,size.width,size.height);
      }
 else {
        graphComponent.paintBackgroundPage(g);
      }
    }
  finally {
      g2.setTransform(tx);
    }
  }
 else {
    g.setColor(getBackground());
    mxUtils.fillClippedRect(g,0,0,getWidth(),getHeight());
  }
}
