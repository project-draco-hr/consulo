{
  Application app=ApplicationManager.getApplication();
  app.runWriteAction(new Runnable(){
    public void run(){
      Document doc=FileDocumentManager.getInstance().getDocument(getRoot());
      PsiDocumentManager.getInstance(file.getProject()).doPostponedOperationsAndUnblockDocument(doc);
      for (      CommentAction action : actions) {
        int start=action.getStart();
        int end=action.getEnd();
switch (action.getType()) {
case CommentAction.ACTION_INSERT:
          String comment=getCommentText(action.getPrefix(),action.getSuffix());
        if (comment.length() > 0) {
          doc.insertString(start,comment);
        }
      break;
case CommentAction.ACTION_REPLACE:
    doc.replaceString(start,end,getCommentText("",""));
  break;
case CommentAction.ACTION_DELETE:
doc.deleteString(start,end);
break;
}
}
}
}
);
}
