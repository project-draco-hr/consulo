{
  String[] names=myCheckboxState ? myNames[1] : myNames[0];
  String namePattern=getNamePattern(pattern);
  List<String> namesList=getNamesByPattern(namePattern,names);
  Collections.sort(namesList,new MatchesComparator(namePattern));
  for (  String name : namesList) {
    Set<Object> elems=myMatcher.getElementsByPattern(pattern,name,myCheckboxState,new Computable<Boolean>(){
      public Boolean compute(){
        return myCancelled;
      }
    }
);
    if (elementsArray.size() + elems.size() <= myMaximumListSizeLimit) {
      elementsArray.addAll(elems);
    }
 else {
      Iterator<Object> iter=elems.iterator();
      while (elementsArray.size() < myMaximumListSizeLimit) {
        elementsArray.add(iter.next());
      }
      elementsArray.add(EXTRA_ELEM);
      break;
    }
  }
}
