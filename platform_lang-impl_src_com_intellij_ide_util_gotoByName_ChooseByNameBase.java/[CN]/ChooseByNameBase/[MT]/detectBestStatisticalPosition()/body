{
  int best=0;
  int bestPosition=0;
  int bestMatch=Integer.MIN_VALUE;
  final int count=myListModel.getSize();
  Matcher matcher=buildPatternMatcher(transformPattern(myTextField.getText()));
  final String statContext=statisticsContext();
  for (int i=0; i < count; i++) {
    final Object modelElement=myListModel.getElementAt(i);
    String text=EXTRA_ELEM.equals(modelElement) ? null : myModel.getFullName(modelElement);
    if (text != null) {
      String shortName=myModel.getElementName(modelElement);
      int match=shortName != null && matcher instanceof NameUtil.MinusculeMatcher ? ((NameUtil.MinusculeMatcher)matcher).matchingDegree(shortName) : Integer.MIN_VALUE;
      int stats=StatisticsManager.getInstance().getUseCount(new StatisticsInfo(statContext,text));
      if (stats > best || stats == best && match > bestMatch) {
        best=stats;
        bestPosition=i;
        bestMatch=match;
      }
    }
  }
  return bestPosition;
}
