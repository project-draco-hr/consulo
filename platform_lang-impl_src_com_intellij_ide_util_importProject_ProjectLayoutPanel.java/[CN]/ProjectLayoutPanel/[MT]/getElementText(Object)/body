{
  if (element instanceof LibraryDescriptor) {
    final StringBuilder builder=StringBuilderSpinAllocator.alloc();
    try {
      builder.append(((LibraryDescriptor)element).getName());
      final Collection<File> jars=((LibraryDescriptor)element).getJars();
      if (jars.size() == 1) {
        final File parentFile=jars.iterator().next().getParentFile();
        if (parentFile != null) {
          builder.append(" (");
          builder.append(parentFile.getPath());
          builder.append(")");
        }
      }
      return builder.toString();
    }
  finally {
      StringBuilderSpinAllocator.dispose(builder);
    }
  }
  if (element instanceof File) {
    final StringBuilder builder=StringBuilderSpinAllocator.alloc();
    try {
      builder.append(((File)element).getName());
      final File parentFile=((File)element).getParentFile();
      if (parentFile != null) {
        builder.append(" (");
        builder.append(parentFile.getPath());
        builder.append(")");
      }
      return builder.toString();
    }
  finally {
      StringBuilderSpinAllocator.dispose(builder);
    }
  }
  if (element instanceof ModuleDescriptor) {
    final ModuleDescriptor moduleDescriptor=(ModuleDescriptor)element;
    final StringBuilder builder=StringBuilderSpinAllocator.alloc();
    try {
      builder.append(moduleDescriptor.getName());
      final Set<File> contents=moduleDescriptor.getContentRoots();
      final int rootCount=contents.size();
      if (rootCount > 0) {
        builder.append(" (");
        builder.append(contents.iterator().next().getPath());
        if (rootCount > 1) {
          builder.append("...");
        }
        builder.append(")");
      }
      final Collection<? extends DetectedProjectRoot> sourceRoots=moduleDescriptor.getSourceRoots();
      if (sourceRoots.size() > 0) {
        builder.append(" [");
        for (Iterator<? extends DetectedProjectRoot> it=sourceRoots.iterator(); it.hasNext(); ) {
          DetectedProjectRoot root=it.next();
          builder.append(root.getDirectory().getName());
          if (it.hasNext()) {
            builder.append(",");
          }
        }
        builder.append("]");
      }
      return builder.toString();
    }
  finally {
      StringBuilderSpinAllocator.dispose(builder);
    }
  }
  return "";
}
