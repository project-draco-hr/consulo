def netlocsplit(netloc):
    'split [user[:passwd]@]host[:port] into 4-tuple.'
    a = netloc.find('@')
    if (a == (-1)):
        (user, passwd) = (None, None)
    else:
        (userpass, netloc) = (netloc[:a], netloc[(a + 1):])
        c = userpass.find(':')
        if (c == (-1)):
            (user, passwd) = (urllib.unquote(userpass), None)
        else:
            user = urllib.unquote(userpass[:c])
            passwd = urllib.unquote(userpass[(c + 1):])
    c = netloc.find(':')
    if (c == (-1)):
        (host, port) = (netloc, None)
    else:
        (host, port) = (netloc[:c], netloc[(c + 1):])
    return (host, port, user, passwd)
