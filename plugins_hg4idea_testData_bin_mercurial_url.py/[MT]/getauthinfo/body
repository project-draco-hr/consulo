def getauthinfo(path):
    (scheme, netloc, urlpath, query, frag) = urlparse.urlsplit(path)
    if (not urlpath):
        urlpath = '/'
    if (scheme != 'file'):
        urlpath = quotepath(urlpath)
    (host, port, user, passwd) = netlocsplit(netloc)
    url = urlparse.urlunsplit((scheme, netlocunsplit(host, port), urlpath, query, frag))
    if user:
        netloc = host
        if port:
            netloc += (':' + port)
        authinfo = (None, (url, netloc), user, (passwd or ''))
    else:
        authinfo = None
    return (url, authinfo)
