{
  if (isEditorTabs()) {
    g2d.setColor(UIUtil.getPanelBackground());
    g2d.fill(clip);
    g2d.setColor(new Color(0,0,0,80));
    g2d.fill(clip);
    List<TabInfo> visibleInfos=getVisibleInfos();
    final boolean vertical=getTabsPosition() == JBTabsPosition.left || getTabsPosition() == JBTabsPosition.right;
    Insets insets=getTabsBorder().getEffectiveBorder();
    int maxOffset=0;
    int maxLength=0;
    for (int i=visibleInfos.size() - 1; i >= 0; i--) {
      TabInfo visibleInfo=visibleInfos.get(i);
      TabLabel tabLabel=myInfo2Label.get(visibleInfo);
      Rectangle r=tabLabel.getBounds();
      if (r.width == 0 || r.height == 0)       continue;
      maxOffset=vertical ? r.y + r.height : r.x + r.width;
      maxLength=vertical ? r.width : r.height;
      break;
    }
    maxOffset++;
    Rectangle r2=getBounds();
    Rectangle rectangle;
    if (vertical) {
      rectangle=new Rectangle(insets.left,maxOffset,getWidth(),r2.height - maxOffset - insets.top- insets.bottom);
    }
 else {
      int y=r2.y + insets.top;
      int height=maxLength - insets.top - insets.bottom;
      if (getTabsPosition() == JBTabsPosition.bottom) {
        y=r2.height - height - insets.top + TabsUtil.ACTIVE_TAB_UNDERLINE_HEIGHT;
      }
 else {
        height-=TabsUtil.ACTIVE_TAB_UNDERLINE_HEIGHT;
      }
      rectangle=new Rectangle(maxOffset,y,r2.width - maxOffset - insets.left- insets.right,height);
    }
    g2d.setPaint(new GradientPaint(rectangle.x,rectangle.y,new Color(255,255,255,160),rectangle.x,rectangle.y + rectangle.height,new Color(255,255,255,120)));
    g2d.fillRect(rectangle.x,rectangle.y,rectangle.width,rectangle.height + (vertical ? 1 : 0));
    if (!vertical) {
      g2d.setColor(new SameColor(210));
      g2d.drawLine(rectangle.x,rectangle.y,rectangle.x + rectangle.width,rectangle.y);
    }
  }
 else {
    super.doPaintBackground(g2d,clip);
  }
}
