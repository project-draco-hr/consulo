{
  XmlElementFactory elementFactory=XmlElementFactory.getInstance(getProject());
  final XmlTag xmlTag=XmlElementFactory.getInstance(getProject()).createTagFromText("<tag1/>");
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    public void run(){
      xmlTag.add(xmlTag.createChildTag("tag2",XmlUtil.EMPTY_URI,null,false));
    }
  }
);
  assertEquals("<tag1><tag2/></tag1>",xmlTag.getText());
  XmlTag createdFromText=elementFactory.createTagFromText(xmlTag.getText());
  assertEquals("tag1",createdFromText.getName());
  assertEquals(1,createdFromText.getSubTags().length);
  assertEquals("tag2",createdFromText.getSubTags()[0].getName());
}
