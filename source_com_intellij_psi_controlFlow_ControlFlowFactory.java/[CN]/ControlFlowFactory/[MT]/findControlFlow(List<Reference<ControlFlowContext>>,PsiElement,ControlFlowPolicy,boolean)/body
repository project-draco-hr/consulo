{
  if (refs != null) {
    final long modificationCount=element.getManager().getModificationTracker().getModificationCount();
    for (int i=refs.size() - 1; i >= 0; i--) {
      Reference<ControlFlowContext> ref=refs.get(i);
      ControlFlowContext currentFlow=ref == null ? null : ref.get();
      if (currentFlow == null) {
        refs.set(i,null);
        continue;
      }
      if (modificationCount != currentFlow.myModificationCount) {
        refs.clear();
        return null;
      }
      if (currentFlow.policy != policy) {
        continue;
      }
      if (currentFlow.evaluateConstantIfCondition == evaluateConstantIfCondition || currentFlow.evaluateConstantIfCondition && !currentFlow.flow.isConstantConditionOccurred()) {
        if (currentFlow.evaluateConstantIfCondition != evaluateConstantIfCondition && LOG.isDebugEnabled()) {
          LOG.debug("CF constant cond optimization works for " + element + "("+ (element.getText().length() > 40 ? element.getText().substring(0,40) : element.getText())+ ")");
        }
        return new Pair<Integer,ControlFlow>(i,currentFlow.flow);
      }
    }
  }
  return null;
}
