{
  final StringWriter targetText=new StringWriter();
  final PrintWriter dataOutput=new PrintWriter(targetText);
  new BuildJarTarget(chunk,BuildTargetsFactory.getInstance().getDefaultOptions(getProject()),new PluginBuildConfiguration(getModule())).generate(dataOutput);
  dataOutput.flush();
  final String lowercased=StringUtil.toLowerCase(myModule.getName());
  final String expected="<target name=\"plugin.build.jar." + lowercased + "\" depends=\"compile.module."+ lowercased+ "\" description=\"Build plugin archive for module &apos;"+ myModule.getName()+ "&apos;\">\n"+ "  <jar destfile=\"${"+ lowercased+ ".plugin.path.jar}\" duplicate=\"preserve\">\n"+ "    <zipfileset dir=\"${module."+ lowercased+ ".basedir}/classes\"/>\n"+ "    <zipfileset file=\"${module."+ lowercased+ ".basedir}/META-INF/plugin.xml\" prefix=\"META-INF\"/>\n"+ "    <manifest>\n"+ "      <attribute name=\"Created-By\" value=\"IntelliJ IDEA\"/>\n"+ "      <attribute name=\"Manifest-Version\" value=\"1.0\"/>\n"+ "    </manifest>\n"+ "  </jar>\n"+ "</target>";
  checkBuildsEqual(targetText.toString(),expected);
}
