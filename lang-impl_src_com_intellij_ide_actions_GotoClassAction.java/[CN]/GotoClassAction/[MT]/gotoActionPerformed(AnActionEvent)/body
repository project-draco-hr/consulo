{
  final Project project=e.getData(PlatformDataKeys.PROJECT);
  if (DumbService.getInstance().isDumb()) {
    project.getMessageBus().syncPublisher(Notifications.TOPIC).notify("dumb","Goto Class action is not available until indices are built, using Goto File instead","",NotificationType.INFORMATION,NotificationListener.REMOVE);
    myInAction=null;
    new GotoFileAction().gotoActionPerformed(e);
    return;
  }
  FeatureUsageTracker.getInstance().triggerFeatureUsed("navigation.popup.class");
  PsiDocumentManager.getInstance(project).commitAllDocuments();
  final ChooseByNamePopup popup=ChooseByNamePopup.createPopup(project,new GotoClassModel2(project),getPsiContext(e));
  popup.invoke(new ChooseByNamePopupComponent.Callback(){
    public void onClose(){
      if (GotoClassAction.class.equals(myInAction))       myInAction=null;
    }
    public void elementChosen(    Object element){
      ((NavigationItem)element).navigate(true);
    }
  }
,ModalityState.current(),true);
}
