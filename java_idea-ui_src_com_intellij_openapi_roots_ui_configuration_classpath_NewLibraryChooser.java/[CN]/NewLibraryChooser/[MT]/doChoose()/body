{
  final NewLibraryEditor libraryEditor;
  if (myLibraryType == null) {
    libraryEditor=new NewLibraryEditor();
  }
 else {
    libraryEditor=new NewLibraryEditor(myLibraryType,myLibraryType.createDefaultProperties());
  }
  final LibraryTablesRegistrar registrar=LibraryTablesRegistrar.getInstance();
  List<LibraryTable> tables=Arrays.asList(myRootModel.getModuleLibraryTable(),registrar.getLibraryTable(myProject),registrar.getLibraryTable());
  CreateNewLibraryDialog dialog=new CreateNewLibraryDialog(myParentComponent,myContext,libraryEditor,tables,1);
  final Module contextModule=DataKeys.MODULE_CONTEXT.getData(DataManager.getInstance().getDataContext(myParentComponent));
  dialog.setContextModule(contextModule);
  dialog.show();
  myIsOk=dialog.isOK();
  if (myIsOk) {
    myChosenLibrary=dialog.createLibrary();
  }
 else {
    myChosenLibrary=null;
  }
}
