{
  if (baseDir != null) {
    final String relativepath=FileUtil.getRelativePath(baseDir,new File(path));
    if (relativepath != null) {
      if (!useAbsolutePathsForOuterPaths || relativepath.indexOf("..") < 0) {
        final String _relativePath=relativepath.replace(File.separatorChar,'/');
        final String root=BuildProperties.propertyRef(baseDirPropertyName);
        return ".".equals(_relativePath) ? root : root + "/" + _relativePath;
      }
    }
  }
  return genOptions.subsitutePathWithMacros(path);
}
