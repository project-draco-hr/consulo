{
  ApplicationManager.getApplication().assertIsDispatchThread();
  while (true) {
    final MyInitializeDdmlibTask task=new MyInitializeDdmlibTask(project);
    Thread t=new Thread(new Runnable(){
      @Override public void run(){
        doInitializeDdmlib();
        task.finish();
      }
    }
);
    t.start();
    boolean retryWas=false;
    while (!task.isFinished()) {
      ProgressManager.getInstance().run(task);
      boolean finished=task.isFinished();
      myAdbCrashed=!finished;
      if (task.isCanceled()) {
        forceInterrupt(t);
        return false;
      }
      if (!finished) {
        int result=Messages.showOkCancelDialog(project,"ADB not responding. Please, kill \"" + SdkConstants.FN_ADB + "\" process manually and click 'Retry'",CommonBundle.getErrorTitle(),"&Retry","&Cancel",Messages.getErrorIcon());
        if (result == 1) {
          forceInterrupt(t);
          return false;
        }
        retryWas=true;
      }
    }
    if (!retryWas) {
      break;
    }
  }
  return true;
}
