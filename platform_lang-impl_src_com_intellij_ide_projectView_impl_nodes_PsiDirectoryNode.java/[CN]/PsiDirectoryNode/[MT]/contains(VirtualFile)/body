{
  final PsiDirectory value=getValue();
  if (value == null) {
    return false;
  }
  VirtualFile directory=value.getVirtualFile();
  if (directory.getFileSystem() instanceof LocalFileSystem) {
    file=PathUtil.getLocalFile(file);
  }
  if (!VfsUtil.isAncestor(directory,file,false)) {
    return false;
  }
  final Project project=value.getProject();
  final ProjectFileIndex fileIndex=ProjectRootManager.getInstance(project).getFileIndex();
  return !fileIndex.isIgnored(file);
}
