{
  super(project);
  myProject=project;
  myTargetClass=targetClass;
  myReturnType=returnType;
  myTypeParameterList=typeParameterList;
  myExceptions=exceptions;
  myStaticFlag=isStatic;
  myCanBeStatic=canBeStatic;
  myElementsToExtract=elementsToExtract;
  final List<ParameterTablePanel.VariableData> variableData=new ArrayList<ParameterTablePanel.VariableData>(inputVariables.length);
  boolean canBeVarargs=false;
  for (  PsiVariable var : inputVariables) {
    String name=var.getName();
    if (!(var instanceof PsiParameter)) {
      JavaCodeStyleManager codeStyleManager=JavaCodeStyleManager.getInstance(myProject);
      VariableKind kind=codeStyleManager.getVariableKind(var);
      name=codeStyleManager.variableNameToPropertyName(name,kind);
      name=codeStyleManager.propertyNameToVariableName(name,VariableKind.PARAMETER);
    }
    PsiType type=var.getType();
    if (type instanceof PsiEllipsisType) {
      if (var == inputVariables[inputVariables.length - 1]) {
        myWasStatic=true;
      }
      type=((PsiEllipsisType)type).toArrayType();
    }
    canBeVarargs|=type instanceof PsiArrayType;
    ParameterTablePanel.VariableData data=new ParameterTablePanel.VariableData(var,type);
    data.name=name;
    data.passAsParameter=true;
    variableData.add(data);
  }
  myVariableData=variableData.toArray(new ParameterTablePanel.VariableData[variableData.size()]);
  setTitle(ExtractMethodObjectProcessor.REFACTORING_NAME);
  int height=myVariableData.length + 2;
  if (myExceptions.length > 0) {
    height+=myExceptions.length + 1;
  }
  myCbMakeVarargs.setVisible(canBeVarargs);
  myCbMakeVarargsAnonymous.setVisible(canBeVarargs);
  init();
}
