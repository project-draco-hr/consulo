{
  if (myCurrentBranch.toString().equals(url)) {
    Messages.showErrorDialog(SvnBundle.message("action.Subversion.integrate.changes.error.source.and.target.same.text"),SvnBundle.message("action.Subversion.integrate.changes.messages.title"));
    return;
  }
  final IntegratedSelectedOptionsDialog dialog=new IntegratedSelectedOptionsDialog(project,myCurrentBranch,url);
  dialog.show();
  if (dialog.isOK()) {
    ApplicationManager.getApplication().saveAll();
    dialog.saveOptions();
    final WorkingCopyInfo info=dialog.getSelectedWc();
    final File file=new File(info.getLocalPath());
    if ((!file.exists()) || (!file.isDirectory())) {
      Messages.showErrorDialog(SvnBundle.message("action.Subversion.integrate.changes.error.target.not.dir.text"),SvnBundle.message("action.Subversion.integrate.changes.messages.title"));
      return;
    }
    final SVNURL sourceUrl=correctSourceUrl(info,url);
    if (sourceUrl == null) {
      Messages.showErrorDialog(SvnBundle.message("action.Subversion.integrate.changes.error.not.versioned.text"),SvnBundle.message("action.Subversion.integrate.changes.messages.title"));
      return;
    }
    final SvnIntegrateChangesTask task=new SvnIntegrateChangesTask(myProject,myVcs,dialog.getSelectedWc(),myMergerFactory,sourceUrl);
    ProgressManager.getInstance().run(task);
  }
}
