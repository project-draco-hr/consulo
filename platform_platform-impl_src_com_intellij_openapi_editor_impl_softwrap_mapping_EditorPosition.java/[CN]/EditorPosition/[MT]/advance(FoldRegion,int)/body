{
  String placeholder=foldRegion.getPlaceholderText();
  visualColumn+=placeholder.length();
  offset=foldRegion.getEndOffset();
  Document document=myEditor.getDocument();
  int endOffsetLogicalLine=document.getLineNumber(foldRegion.getEndOffset());
  if (logicalLine == endOffsetLogicalLine) {
    if (collapsedSymbolsWidthInColumns < 0) {
      collapsedSymbolsWidthInColumns=SoftWrapModelImpl.getEditorTextRepresentationHelper(myEditor).toVisualColumnSymbolsNumber(document.getCharsSequence(),foldRegion.getStartOffset(),foldRegion.getEndOffset(),x);
    }
    logicalColumn+=collapsedSymbolsWidthInColumns;
    foldingColumnDiff+=placeholder.length() - collapsedSymbolsWidthInColumns;
  }
 else {
    if (collapsedSymbolsWidthInColumns < 0) {
      collapsedSymbolsWidthInColumns=SoftWrapModelImpl.getEditorTextRepresentationHelper(myEditor).toVisualColumnSymbolsNumber(document.getCharsSequence(),foldRegion.getStartOffset(),foldRegion.getEndOffset(),0);
    }
    int linesDiff=endOffsetLogicalLine - logicalLine;
    logicalLine+=linesDiff;
    foldedLines+=linesDiff;
    logicalColumn=collapsedSymbolsWidthInColumns;
    foldingColumnDiff=visualColumn - logicalColumn - softWrapColumnDiff;
  }
}
