{
  res.add(0,atCaret);
  if (doNotStepInto(atCaret)) {
    if (!recurse)     return;
    recurse=false;
  }
  final PsiElement[] children=atCaret.getChildren();
  for (int i=0; i < children.length; i++) {
    collectAllElements(children[i],res,recurse);
  }
}
