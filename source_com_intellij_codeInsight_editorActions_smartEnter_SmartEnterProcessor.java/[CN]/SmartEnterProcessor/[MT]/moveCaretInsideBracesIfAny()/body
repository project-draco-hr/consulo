{
  int caretOffset=myEditor.getCaretModel().getOffset();
  final CharSequence chars=myEditor.getDocument().getCharsSequence();
  caretOffset=CharArrayUtil.shiftBackward(chars,caretOffset - 1," \t") + 1;
  if (CharArrayUtil.regionMatches(chars,caretOffset - "{}".length(),"{}")) {
    commit();
    PsiElement elt=PsiTreeUtil.getParentOfType(myPsiFile.findElementAt(caretOffset - 1),PsiCodeBlock.class);
    reformat(elt);
    myEditor.getCaretModel().moveToOffset(caretOffset - 1);
  }
}
