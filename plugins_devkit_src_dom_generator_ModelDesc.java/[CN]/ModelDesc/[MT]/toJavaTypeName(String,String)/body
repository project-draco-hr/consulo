{
  final int lastIndex=tname.lastIndexOf('.');
  String xmlName=lastIndex > -1 ? tname.substring(lastIndex + 1) : tname;
  NamespaceDesc nsd=getNSD(ns);
  if (ns == null || !ns.endsWith(".dtd")) {
    if (xmlName.endsWith(Util.ANONYMOUS_ELEM_TYPE_SUFFIX))     xmlName=xmlName.substring(0,xmlName.length() - Util.ANONYMOUS_ELEM_TYPE_SUFFIX.length());
 else     if (xmlName.endsWith(Util.ANONYMOUS_ATTR_TYPE_SUFFIX))     xmlName=xmlName.substring(0,xmlName.length() - Util.ANONYMOUS_ATTR_TYPE_SUFFIX.length());
 else     if (xmlName.endsWith(Util.TYPE_SUFFIX))     xmlName=xmlName.substring(0,xmlName.length() - Util.TYPE_SUFFIX.length());
  }
  String rc=Util.capitalize(Util.toJavaName(xmlName));
  if (nsd.prefix != null && nsd.prefix.length() > 0 && !rc.startsWith(nsd.prefix)) {
    rc=nsd.prefix + rc;
  }
  if (Util.RESERVED_NAMES_MAP.containsKey(rc)) {
    rc=Util.RESERVED_NAMES_MAP.get(rc);
  }
  if (name2replaceMap.containsKey(rc)) {
    rc=Util.expandProperties(name2replaceMap.get(rc),nsd.props);
  }
  return rc;
}
