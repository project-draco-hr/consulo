{
  AbstractLayoutCodeProcessor processor=new ReformatCodeProcessor(project,dir,options.isIncludeSubdirectories(),options.getTextRangeType() == TextRangeType.VCS_CHANGED_TEXT);
  registerScopeFilter(processor,options.getSearchScope());
  registerFileMaskFilter(processor,options.getFileTypeMask());
  if (options.isOptimizeImports()) {
    processor=new OptimizeImportsProcessor(processor);
  }
  if (options.isRearrangeCode()) {
    processor=new RearrangeCodeProcessor(processor);
  }
  processor.run();
}
