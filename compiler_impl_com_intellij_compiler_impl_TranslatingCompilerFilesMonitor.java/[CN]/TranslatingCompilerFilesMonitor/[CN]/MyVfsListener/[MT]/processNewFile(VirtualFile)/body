{
  for (  final Project project : myProjectManager.getOpenProjects()) {
    final ProjectRootManager rootManager=ProjectRootManager.getInstance(project);
    if (rootManager.getFileIndex().isInSourceContent(file)) {
      final String projectId=getProjectId(project);
      final TranslatingCompiler[] translators=CompilerManager.getInstance(project).getCompilers(TranslatingCompiler.class);
      processRecursively(file,new FileProcessor(){
        public void execute(        final VirtualFile file){
          if (isCompilable(file)) {
            addSourceForRecompilation(Collections.singletonList(projectId),file,null);
          }
        }
        boolean isCompilable(        VirtualFile file){
          for (          TranslatingCompiler translator : translators) {
            if (translator.isCompilableFile(file,DummyCompileContext.getInstance())) {
              return true;
            }
          }
          return false;
        }
      }
);
    }
 else {
      if (belongsToIntermediateSources(file,project)) {
        processRecursively(file,new FileProcessor(){
          public void execute(          final VirtualFile file){
            addSourceForRecompilation(Collections.singletonList(getProjectId(project)),file,null);
          }
        }
);
      }
    }
  }
}
