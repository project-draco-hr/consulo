{
  if (file.isDirectory()) {
    new Object(){
      void traverse(      final VirtualFile dir){
        for (        VirtualFile child : dir.getChildren()) {
          if (child.isDirectory()) {
            traverse(child);
          }
 else {
            processor.execute(child);
          }
        }
      }
    }
.traverse(file);
  }
 else {
    processor.execute(file);
  }
}
