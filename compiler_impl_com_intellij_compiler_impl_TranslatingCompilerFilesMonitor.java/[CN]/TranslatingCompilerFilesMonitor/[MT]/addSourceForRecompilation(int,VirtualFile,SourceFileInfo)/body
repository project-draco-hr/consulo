{
  final SourceFileInfo srcInfo=preloadedInfo != null ? preloadedInfo : loadSourceInfo(srcFile);
  final boolean alreadyMarked;
synchronized (mySourcesToRecompile) {
    TIntHashSet set=mySourcesToRecompile.get(projectId);
    if (set == null) {
      set=new TIntHashSet();
      mySourcesToRecompile.put(projectId,set);
    }
    alreadyMarked=!set.add(Math.abs(getFileId(srcFile)));
    if (!alreadyMarked && LOG.isDebugEnabled()) {
      LOG.debug("Scheduled recompilation " + srcFile.getPresentableUrl());
    }
  }
  if (!alreadyMarked && srcInfo != null) {
    srcInfo.updateTimestamp(projectId,-1L);
    srcInfo.processOutputPaths(projectId,new ScheduleOutputsForDeletionProc(srcFile.getUrl()));
    saveSourceInfo(srcFile,srcInfo);
  }
}
