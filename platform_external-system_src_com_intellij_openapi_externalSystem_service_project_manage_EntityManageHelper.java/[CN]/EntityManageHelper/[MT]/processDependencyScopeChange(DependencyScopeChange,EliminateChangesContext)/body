{
  ExportableOrderEntry dependency=findDependency(change,context);
  if (dependency == null) {
    return;
  }
  AbstractExternalDependencyId id=change.getEntityId();
  UserProjectChange<?> userChange;
  if (dependency instanceof LibraryOrderEntry) {
    userChange=new LibraryDependencyScopeUserChange(id.getOwnerModuleName(),id.getDependencyName(),change.getIdeValue());
  }
 else {
    userChange=new ModuleDependencyScopeUserChange(id.getOwnerModuleName(),id.getDependencyName(),change.getIdeValue());
  }
  if (context.changesToPreserve.contains(userChange)) {
    context.nonProcessedChanges.add(change);
  }
 else {
    context.dependencyManager.setScope(change.getExternalValue(),dependency,context.synchronous);
  }
}
