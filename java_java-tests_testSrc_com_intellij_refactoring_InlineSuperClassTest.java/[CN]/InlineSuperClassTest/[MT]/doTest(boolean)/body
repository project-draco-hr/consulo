{
  try {
    doTest(new PerformAction(){
      public void performAction(      final VirtualFile rootDir,      final VirtualFile rootAfter) throws Exception {
        PsiClass aClass=myJavaFacade.findClass("Test",GlobalSearchScope.allScope(myProject));
        if (aClass == null)         aClass=myJavaFacade.findClass("p.Test",GlobalSearchScope.allScope(myProject));
        assertNotNull("Class Test not found",aClass);
        PsiClass superClass=myJavaFacade.findClass("Super",GlobalSearchScope.allScope(myProject));
        if (superClass == null)         superClass=myJavaFacade.findClass("p1.Super",GlobalSearchScope.allScope(myProject));
        assertNotNull("Class Super not found",superClass);
        new InlineSuperClassRefactoringProcessor(getProject(),superClass,aClass).run();
      }
    }
);
  }
 catch (  BaseRefactoringProcessor.ConflictsInTestsException e) {
    if (fail) {
      return;
    }
 else {
      throw e;
    }
  }
  if (fail) {
    fail("Conflict was not detected");
  }
}
