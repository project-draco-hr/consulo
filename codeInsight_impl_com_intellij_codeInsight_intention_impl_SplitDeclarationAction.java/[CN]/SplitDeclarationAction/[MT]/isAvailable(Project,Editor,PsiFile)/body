{
  int offset=editor.getCaretModel().getOffset();
  PsiElement element=file.findElementAt(offset);
  if (element == null)   return false;
  if (!(element instanceof PsiJavaToken))   return false;
  if (element instanceof PsiCompiledElement)   return false;
  if (!file.getManager().isInProject(file))   return false;
  final PsiElement context=PsiTreeUtil.getParentOfType(element,PsiDeclarationStatement.class,PsiClass.class);
  if (context instanceof PsiDeclarationStatement) {
    return isAvaliableOnDeclarationStatement((PsiDeclarationStatement)context,element);
  }
  PsiField field=PsiTreeUtil.getParentOfType(element,PsiField.class);
  if (field != null && PsiTreeUtil.getParentOfType(element,PsiDocComment.class) == null && isAvaliableOnField(field)) {
    setText(CodeInsightBundle.message("intention.split.declaration.text"));
    return true;
  }
  return false;
}
