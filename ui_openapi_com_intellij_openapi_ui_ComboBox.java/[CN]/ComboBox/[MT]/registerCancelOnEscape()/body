{
  registerKeyboardAction(new ActionListener(){
    public void actionPerformed(    final ActionEvent e){
      final DialogWrapperDialog dialogWrapperDialog=getParentDialog(ComboBox.this);
      final DialogWrapper dialogWrapper=dialogWrapperDialog == null ? null : dialogWrapperDialog.getDialogWrapper();
      if (isPopupVisible()) {
        setPopupVisible(false);
      }
 else {
        final Object clientProperty=getClientProperty("tableCellEditor");
        if (clientProperty instanceof CellEditor) {
          ((CellEditor)clientProperty).cancelCellEditing();
        }
 else         if (dialogWrapper != null) {
          dialogWrapper.doCancelAction();
        }
      }
    }
  }
,KeyStroke.getKeyStroke(KeyEvent.VK_ESCAPE,0),JComponent.WHEN_ANCESTOR_OF_FOCUSED_COMPONENT);
}
