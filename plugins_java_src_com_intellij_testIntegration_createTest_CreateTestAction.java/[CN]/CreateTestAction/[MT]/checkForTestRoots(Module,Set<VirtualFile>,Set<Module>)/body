{
  final boolean isFirst=processed.isEmpty();
  if (!processed.add(srcModule))   return;
  final ContentEntry[] entries=ModuleRootManager.getInstance(srcModule).getContentEntries();
  for (  ContentEntry entry : entries) {
    for (    ContentFolder sourceFolder : entry.getFolders(ContentFolder.ContentFolderType.TEST)) {
      final VirtualFile sourceFolderFile=sourceFolder.getFile();
      if (sourceFolderFile != null) {
        testFolders.add(sourceFolderFile);
      }
    }
  }
  if (isFirst && !testFolders.isEmpty())   return;
  final HashSet<Module> modules=new HashSet<Module>();
  ModuleUtilCore.collectModulesDependsOn(srcModule,modules);
  for (  Module module : modules) {
    checkForTestRoots(module,testFolders,processed);
  }
}
