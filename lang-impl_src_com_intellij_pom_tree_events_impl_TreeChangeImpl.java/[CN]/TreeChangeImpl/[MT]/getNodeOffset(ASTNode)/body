{
  LOG.assertTrue(child.getTreeParent() == myParent);
  int oldOffsetInParent=0;
  ASTNode lastChangedElementBeforeChild=null;
  ASTNode current=myParent.getFirstChildNode();
  while (current != child) {
    if (!myChanges.containsKey(current)) {
      oldOffsetInParent+=current.getTextLength();
    }
    if (myChanges.containsKey(child)) {
      lastChangedElementBeforeChild=current;
    }
    current=current.getTreeNext();
  }
  for (  Pair<ASTNode,Integer> offset : myOffsets) {
    if (offset.getSecond() > oldOffsetInParent)     break;
    final ASTNode changedNode=offset.getFirst();
    if (changedNode == lastChangedElementBeforeChild)     break;
    final ChangeInfo change=getChangeByChild(changedNode);
    oldOffsetInParent+=change.getOldLength();
  }
  return oldOffsetInParent;
}
