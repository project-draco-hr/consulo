{
  int foldEndLine=myEditor.getDocument().getLineNumber(foldRegion.getEndOffset());
  if (myTargetLogical.line > foldEndLine) {
    return null;
  }
  if (myTargetLogical.line < foldEndLine) {
    return context.buildVisualPosition();
  }
  FoldingData data=getFoldRegionData(foldRegion);
  int foldEndColumn;
  if (data == null) {
    int xStart=myEditor.getDocument().getLineNumber(foldRegion.getStartOffset()) == foldEndLine ? context.x : 0;
    foldEndColumn=SoftWrapModelImpl.getEditorTextRepresentationHelper(myEditor).toVisualColumnSymbolsNumber(myEditor.getDocument().getCharsSequence(),foldRegion.getStartOffset(),foldRegion.getEndOffset(),xStart);
  }
 else {
    foldEndColumn=data.getCollapsedSymbolsWidthInColumns();
  }
  if (foldEndLine == context.logicalLine) {
    foldEndColumn+=context.logicalColumn;
  }
  if (foldEndColumn <= myTargetLogical.column) {
    return null;
  }
  return context.buildVisualPosition();
}
