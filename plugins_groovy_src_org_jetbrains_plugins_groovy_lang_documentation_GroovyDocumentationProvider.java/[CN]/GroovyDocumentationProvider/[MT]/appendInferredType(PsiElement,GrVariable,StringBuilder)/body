{
  PsiType inferredType=null;
  if (TokenSets.WHITE_SPACES_SET.contains(originalElement.getNode().getElementType())) {
    originalElement=PsiTreeUtil.prevLeaf(originalElement);
  }
  if (originalElement != null && originalElement.getNode().getElementType() == GroovyTokenTypes.mIDENT) {
    originalElement=originalElement.getParent();
  }
  if (originalElement instanceof GrReferenceExpression) {
    inferredType=((GrReferenceExpression)originalElement).getType();
  }
 else   if (originalElement instanceof GrVariableDeclaration) {
    inferredType=variable.getTypeGroovy();
  }
 else   if (originalElement instanceof GrVariable) {
    inferredType=((GrVariable)originalElement).getTypeGroovy();
  }
  if (inferredType != null) {
    buffer.append("[inferred type] ");
    appendTypeString(buffer,inferredType,originalElement);
  }
 else {
    buffer.append("[cannot infer type]");
  }
}
