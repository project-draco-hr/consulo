{
  final DataContext dataContext=e.getDataContext();
  final Project project=PlatformDataKeys.PROJECT.getData(dataContext);
  if (project == null)   return;
  PsiDocumentManager.getInstance(project).commitAllDocuments();
  final PsiMethod method=getMethod(dataContext);
  if (method == null)   return;
  final CallHierarchyBrowser hierarchyBrowser=new CallHierarchyBrowser(project,method);
  final Content content;
  final HierarchyBrowserManager hierarchyBrowserManager=HierarchyBrowserManager.getInstance(project);
  final ContentManager contentManager=hierarchyBrowserManager.getContentManager();
  final Content selectedContent=contentManager.getSelectedContent();
  if (selectedContent != null && !selectedContent.isPinned()) {
    content=selectedContent;
    final Component component=content.getComponent();
    if (component instanceof Disposable) {
      Disposer.dispose((Disposable)component);
    }
    content.setComponent(hierarchyBrowser);
  }
 else {
    content=ContentFactory.SERVICE.getInstance().createContent(hierarchyBrowser,null,true);
    contentManager.addContent(content);
  }
  contentManager.setSelectedContent(content);
  hierarchyBrowser.setContent(content);
  final String name=method.getName();
  content.setDisplayName(name);
  final Runnable runnable=new Runnable(){
    public void run(){
      hierarchyBrowser.changeView(CallerMethodsTreeStructure.TYPE);
    }
  }
;
  ToolWindowManager.getInstance(project).getToolWindow(ToolWindowId.HIERARCHY).activate(runnable);
}
