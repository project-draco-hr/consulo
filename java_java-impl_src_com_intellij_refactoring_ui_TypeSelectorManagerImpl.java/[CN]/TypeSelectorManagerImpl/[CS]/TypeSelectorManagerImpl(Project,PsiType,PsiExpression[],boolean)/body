{
  myFactory=JavaPsiFacade.getInstance(project).getElementFactory();
  mySmartTypePointerManager=SmartTypePointerManager.getInstance(project);
  setDefaultType(type);
  myMainOccurrence=null;
  myOccurrences=occurrences;
  myExpectedTypesProvider=ExpectedTypesProvider.getInstance(project);
  myOccurrenceClassProvider=createOccurrenceClassProvider();
  myTypesForAll=getTypesForAll(areTypesDirected);
  myTypesForMain=PsiType.EMPTY_ARRAY;
  myIsOneSuggestion=myTypesForAll.length == 1;
  if (myIsOneSuggestion) {
    myTypeSelector=new TypeSelector(myTypesForAll[0]);
  }
 else {
    myTypeSelector=new TypeSelector();
    setTypesAndPreselect(myTypesForAll);
  }
}
