{
  final Project project=editor.getProject();
  try {
    final XPathSupport support=XPathSupport.getInstance();
    final XPath xpath=support.createXPath((XmlFile)contextNode.getContainingFile(),context.input.expression,context.input.namespaces);
    xpath.setVariableContext(new CachedVariableContext(context.input.variables,xpath,contextNode));
    final Object result=xpath.evaluate(contextNode);
    LOG.debug("result = " + result);
    LOG.assertTrue(result != null,"null result?");
    if (result instanceof List<?>) {
      final List<?> list=(List<?>)result;
      if (list.size() > 0) {
        if (cfg.HIGHLIGHT_RESULTS) {
          highlightResult(contextNode,editor,list);
        }
        if (cfg.SHOW_USAGE_VIEW) {
          showUsageView(editor,xpath,contextNode,list);
        }
        if (!cfg.SHOW_USAGE_VIEW && !cfg.HIGHLIGHT_RESULTS) {
          final String s=StringUtil.pluralize("match",list.size());
          Messages.showInfoMessage(project,"Expression produced " + list.size() + " "+ s,"XPath Result");
        }
      }
 else {
        return Messages.showDialog(project,"Sorry, your expression did not return any result","XPath Result",new String[]{"OK","Edit Expression"},0,Messages.getInformationIcon()) == 1;
      }
    }
 else     if (result instanceof String) {
      Messages.showMessageDialog("'" + result.toString() + "'","XPath result (String)",Messages.getInformationIcon());
    }
 else     if (result instanceof Number) {
      Messages.showMessageDialog(result.toString(),"XPath result (Number)",Messages.getInformationIcon());
    }
 else     if (result instanceof Boolean) {
      Messages.showMessageDialog(result.toString(),"XPath result (Boolean)",Messages.getInformationIcon());
    }
 else {
      LOG.error("Unknown XPath result: " + result);
    }
  }
 catch (  XPathSyntaxException e) {
    LOG.debug(e);
    return Messages.showDialog(project,e.getMultilineMessage(),"XPath syntax error",new String[]{"OK","Edit Expression"},1,Messages.getErrorIcon()) == 1;
  }
catch (  SAXPathException e) {
    LOG.debug(e);
    Messages.showMessageDialog(project,e.getMessage(),"XPath error",Messages.getErrorIcon());
  }
  return false;
}
