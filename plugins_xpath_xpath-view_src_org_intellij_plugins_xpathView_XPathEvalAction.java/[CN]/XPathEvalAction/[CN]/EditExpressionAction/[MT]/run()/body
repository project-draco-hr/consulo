{
  Runnable runnable=new Runnable(){
    @Override public void run(){
      final Object o=saveState();
      try {
        execute();
      }
  finally {
        restoreState(o);
      }
    }
  }
;
  SwingUtilities.invokeLater(runnable);
}
