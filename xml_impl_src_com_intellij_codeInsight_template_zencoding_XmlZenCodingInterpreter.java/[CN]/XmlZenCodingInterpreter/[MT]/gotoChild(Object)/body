{
  int startOfTemplate=myCallback.getStartOfTemplate(templateBoundsKey);
  int endOfTemplate=myCallback.getEndOfTemplate(templateBoundsKey);
  int offset=myCallback.getOffset();
  PsiFile file=myCallback.getFile();
  PsiElement element=file.findElementAt(offset);
  if (element instanceof XmlToken && ((XmlToken)element).getTokenType() == XmlTokenType.XML_END_TAG_START) {
    return;
  }
  int newOffset=-1;
  XmlTag tag=PsiTreeUtil.findElementOfClassAtRange(file,startOfTemplate,endOfTemplate,XmlTag.class);
  if (tag != null) {
    for (    PsiElement child : tag.getChildren()) {
      if (child instanceof XmlToken && ((XmlToken)child).getTokenType() == XmlTokenType.XML_END_TAG_START) {
        newOffset=child.getTextOffset();
      }
    }
  }
  if (newOffset >= 0) {
    myCallback.fixEndOffset();
    myCallback.moveToOffset(newOffset);
  }
}
