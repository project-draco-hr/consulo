{
  for (  T scheme : schemes) {
    if (isExternalizable(scheme)) {
      E eScheme=(E)scheme;
      eScheme.getExternalInfo().setPreviouslySavedName(eScheme.getName());
      if (myProcessor.shouldBeSaved(eScheme)) {
        final String fileName=getFileNameForScheme(fileNameProvider,eScheme);
        try {
          final Document document=writeSchemeToDocument(eScheme);
          long newHash=computeHashValue(document);
          Long oldHash=eScheme.getExternalInfo().getHash();
          saveIfNeeded(eScheme,fileName,document,newHash,oldHash);
        }
 catch (        IOException e) {
          LOG.error("Cannot write scheme " + fileName + " in '"+ myFileSpec+ "': "+ e.getLocalizedMessage(),e);
        }
      }
    }
  }
}
