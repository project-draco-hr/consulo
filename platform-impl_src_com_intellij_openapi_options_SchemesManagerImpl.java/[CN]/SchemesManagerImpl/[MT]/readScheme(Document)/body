{
  Element rootElement=subDocument.getRootElement();
  if (rootElement.getName().equals(SHARED_SCHEME)) {
    String schemeName=rootElement.getAttributeValue(NAME);
    String schemePath=rootElement.getAttributeValue(ORIGINAL_SCHEME_PATH);
    Document sharedDocument=loadGlobalScheme(schemePath);
    if (sharedDocument != null) {
      T result=readScheme(sharedDocument);
      if (result != null) {
        myProcessor.renameScheme(schemeName,result);
        mySharedSchemeToOriginalPath.put(schemeName,schemePath);
      }
      return result;
    }
 else {
      Element localCopyElement=subDocument.getRootElement().getChild(SCHEME_LOCAL_COPY);
      if (localCopyElement != null) {
        Element firstChild=(Element)localCopyElement.getChildren().get(0);
        return myProcessor.readScheme(new Document((Element)firstChild.clone()));
      }
 else {
        return null;
      }
    }
  }
 else {
    return myProcessor.readScheme(subDocument);
  }
}
