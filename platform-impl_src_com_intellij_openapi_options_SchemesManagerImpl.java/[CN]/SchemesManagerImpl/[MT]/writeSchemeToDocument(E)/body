{
  if (!isShared(scheme)) {
    return myProcessor.writeScheme(scheme);
  }
 else {
    String originalPath=scheme.getExternalInfo().getOriginalPath();
    if (originalPath != null) {
      Element root=new Element(SHARED_SCHEME);
      root.setAttribute(NAME,scheme.getName());
      root.setAttribute(ORIGINAL_SCHEME_PATH,originalPath);
      Element localCopy=new Element(SCHEME_LOCAL_COPY);
      localCopy.addContent((Element)myProcessor.writeScheme(scheme).getRootElement().clone());
      root.addContent(localCopy);
      return new Document(root);
    }
 else {
      return null;
    }
  }
}
