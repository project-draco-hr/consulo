{
  final StreamProvider[] providers=((ApplicationImpl)ApplicationManager.getApplication()).getStateStore().getStateStorageManager().getStreamProviders(RoamingType.GLOBAL);
  if (providers != null) {
    Document document=myProcessor.writeScheme(scheme);
    if (document != null) {
      Document wrapped=wrap(document,name,description);
      for (      StreamProvider provider : providers) {
        if (provider instanceof CurrentUserHolder) {
          wrapped=(Document)wrapped.clone();
          String userName=((CurrentUserHolder)provider).getCurrentUserName();
          if (userName != null) {
            wrapped.getRootElement().setAttribute(USER,userName);
          }
        }
        StorageUtil.sendContent(provider,getFileFullPath(UniqueFileNamesProvider.convertName(scheme.getName())) + EXT,wrapped,RoamingType.GLOBAL,false);
      }
    }
  }
}
