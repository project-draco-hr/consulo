{
  try {
    myIsUpdating=true;
    Collection<T> schemes=getAllSchemes();
    myBaseDir.mkdirs();
    UniqueFileNamesProvider fileNameProvider=new UniqueFileNamesProvider();
    reserveUsingFileNames(schemes,fileNameProvider);
    deleteFilesFromDeletedSchemes();
    saveSchemes(schemes,fileNameProvider);
    if (myDeletedNames.size() > 0) {
      for (      StreamProvider provider : getEnabledProviders()) {
        try {
          provider.saveContent(getFileFullPath(DELETED_XML),createDeletedDocument(),myRoamingType);
        }
 catch (        IOException e) {
          LOG.debug(e);
        }
      }
    }
 else {
      for (      StreamProvider provider : getEnabledProviders()) {
        provider.deleteFile(getFileFullPath(DELETED_XML),myRoamingType);
      }
    }
  }
  finally {
    myIsUpdating=false;
  }
}
