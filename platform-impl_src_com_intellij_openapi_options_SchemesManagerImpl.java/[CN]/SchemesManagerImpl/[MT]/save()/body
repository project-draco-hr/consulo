{
  Collection<T> schemes=getAllSchemes();
  myBaseDir.mkdirs();
  final StreamProvider[] providers=getProviders();
  UniqueFileNamesProvider fileNameProvider=new UniqueFileNamesProvider();
  reserveUsingFileNames(schemes,fileNameProvider);
  deleteFilesFromDeletedSchemes();
  saveSchemes(schemes,providers,fileNameProvider);
  if (myDeletedNames.size() > 0) {
    for (    StreamProvider provider : providers) {
      try {
        provider.saveContent(getFileFullPath(DELETED_XML),createDeletedDocument(),myRoamingType);
      }
 catch (      IOException e) {
        LOG.debug(e);
      }
    }
  }
 else {
    for (    StreamProvider provider : providers) {
      provider.deleteFile(getFileFullPath(DELETED_XML),myRoamingType);
    }
  }
}
