{
  if (ApplicationManager.getApplication() == null || myListenerAdded)   return;
  LocalFileSystem system=LocalFileSystem.getInstance();
  final VirtualFile baseDirFile=new WriteAction<VirtualFile>(){
    protected void run(    final Result<VirtualFile> result){
      result.setResult(LocalFileSystem.getInstance().refreshAndFindFileByIoFile(myBaseDir));
    }
  }
.execute().getResultObject();
  baseDirFile.getChildren();
  system.addVirtualFileListener(new VirtualFileAdapter(){
    @Override public void contentsChanged(    final VirtualFileEvent event){
      onFileContentChanged(event,baseDirFile);
    }
    @Override public void fileCreated(    final VirtualFileEvent event){
      VirtualFile file=event.getFile();
      if (!myIsUpdating && event.getRequestor() == null && isFileUnder(file,baseDirFile)) {
        File ioFile=new File(file.getPath());
        ArrayList<E> read=new ArrayList<E>();
        readSchemeFromFile(read,ioFile,true);
        if (!read.isEmpty()) {
          E readScheme=read.get(0);
          myProcessor.initScheme(readScheme);
          myProcessor.onSchemeAdded(readScheme);
        }
      }
    }
    @Override public void fileDeleted(    final VirtualFileEvent event){
      VirtualFile parent=event.getParent();
      if (!myIsUpdating && event.getRequestor() == null && parent != null && parent.equals(baseDirFile)) {
        File ioFile=new File(event.getFileName());
        E scheme=findSchemeFor(ioFile.getName());
        T oldCurrentScheme=null;
        if (scheme != null) {
          oldCurrentScheme=getCurrentScheme();
          removeScheme((T)scheme);
          myProcessor.onSchemeDeleted(scheme);
        }
        T newCurrentScheme=getCurrentScheme();
        if (oldCurrentScheme != null && newCurrentScheme == null) {
          if (!mySchemes.isEmpty()) {
            setCurrentSchemeName(mySchemes.get(0).getName());
            newCurrentScheme=getCurrentScheme();
          }
        }
        if (oldCurrentScheme != newCurrentScheme) {
          myProcessor.onCurrentSchemeChanged(oldCurrentScheme);
        }
      }
    }
  }
);
  myListenerAdded=true;
}
