{
  final String name=file.getName();
  if (file.isFile() && StringUtil.endsWithIgnoreCase(name,EXT)) {
    try {
      final Document document;
      try {
        document=JDOMUtil.loadDocument(file);
      }
 catch (      JDOMException e) {
        LOG.info("Error reading file " + file.getPath() + ": "+ e.getLocalizedMessage());
        throw e;
      }
      final E scheme=readScheme(document);
      if (scheme != null) {
        loadScheme(file,scheme,forceAdd);
        result.add(scheme);
      }
    }
 catch (    final Exception e) {
      ApplicationManager.getApplication().invokeLater(new Runnable(){
        public void run(){
          String msg="Cannot read scheme " + file.getName() + "  from '"+ myFileSpec+ "': "+ e.getLocalizedMessage();
          LOG.warn(msg,e);
          Messages.showErrorDialog(msg,"Load Settings");
        }
      }
);
    }
  }
}
