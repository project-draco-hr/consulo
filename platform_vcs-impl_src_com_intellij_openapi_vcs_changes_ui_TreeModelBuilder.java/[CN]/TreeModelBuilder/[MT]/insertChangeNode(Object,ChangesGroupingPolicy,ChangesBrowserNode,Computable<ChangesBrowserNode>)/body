{
  final String pathKey=getKey(change);
  ChangesBrowserNode oldNode=(pathKey == null) ? null : myFoldersCache.get(pathKey);
  final ChangesBrowserNode node=nodeCreator.compute();
  if (oldNode != null) {
    for (int i=oldNode.getChildCount() - 1; i >= 0; i--) {
      MutableTreeNode child=(MutableTreeNode)model.getChild(oldNode,i);
      model.removeNodeFromParent(child);
      model.insertNodeInto(child,node,model.getChildCount(node));
    }
    final MutableTreeNode parent=(MutableTreeNode)oldNode.getParent();
    int index=model.getIndexOfChild(parent,oldNode);
    model.removeNodeFromParent(oldNode);
    model.insertNodeInto(node,parent,index);
  }
 else {
    ChangesBrowserNode parentNode=getParentNodeFor(node,policy,listNode);
    model.insertNodeInto(node,parentNode,model.getChildCount(parentNode));
  }
  if (pathKey != null) {
    myFoldersCache.put(pathKey,node);
  }
}
