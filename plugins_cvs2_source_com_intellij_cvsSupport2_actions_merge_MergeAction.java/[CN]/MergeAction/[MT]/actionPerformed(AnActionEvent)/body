{
  try {
    final VcsContext context=CvsContextWrapper.createCachedInstance(e);
    final VirtualFile[] files=context.getSelectedFiles();
    if (files == null || files.length == 0)     return;
    final ReadonlyStatusHandler.OperationStatus operationStatus=ReadonlyStatusHandler.getInstance(context.getProject()).ensureFilesWritable(files);
    if (operationStatus.hasReadonlyFiles()) {
      return;
    }
    final Map<VirtualFile,List<String>> fileToRevisions=new HashMap<VirtualFile,List<String>>();
    for (    VirtualFile file : files) {
      fileToRevisions.put(file,CvsUtil.getAllRevisionsForFile(file));
    }
    final Project project=context.getProject();
    AbstractVcsHelper.getInstance(project).showMergeDialog(new ArrayList<VirtualFile>(fileToRevisions.keySet()),new CvsMergeProvider(fileToRevisions,project));
  }
 catch (  Exception e1) {
    LOG.error(e1);
  }
}
