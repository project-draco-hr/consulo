{
  final String outPathUrl;
  final Application application=ApplicationManager.getApplication();
  final CompilerModuleExtension extension=CompilerModuleExtension.getInstance(module);
  if (forTestClasses) {
    if (application.isDispatchThread()) {
      final String url=extension.getCompilerOutputUrlForTests();
      outPathUrl=url != null ? url : extension.getCompilerOutputUrl();
    }
 else {
      outPathUrl=application.runReadAction(new Computable<String>(){
        public String compute(){
          final String url=extension.getCompilerOutputUrlForTests();
          return url != null ? url : extension.getCompilerOutputUrl();
        }
      }
);
    }
  }
 else {
    if (application.isDispatchThread()) {
      outPathUrl=extension.getCompilerOutputUrl();
    }
 else {
      outPathUrl=application.runReadAction(new Computable<String>(){
        public String compute(){
          return extension.getCompilerOutputUrl();
        }
      }
);
    }
  }
  return outPathUrl != null ? VirtualFileManager.extractPath(outPathUrl) : null;
}
