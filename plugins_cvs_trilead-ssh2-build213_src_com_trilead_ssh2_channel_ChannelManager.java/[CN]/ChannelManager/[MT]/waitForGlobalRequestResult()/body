{
synchronized (channels) {
    while ((globalSuccessCounter == 0) && (globalFailedCounter == 0)) {
      if (shutdown) {
        throw new IOException("The connection is being shutdown");
      }
      try {
        channels.wait();
      }
 catch (      InterruptedException ignore) {
      }
    }
    if ((globalFailedCounter == 0) && (globalSuccessCounter == 1))     return true;
    if ((globalFailedCounter == 1) && (globalSuccessCounter == 0))     return false;
    throw new IOException("Illegal state. The server sent " + globalSuccessCounter + " SSH_MSG_REQUEST_SUCCESS and "+ globalFailedCounter+ " SSH_MSG_REQUEST_FAILURE messages.");
  }
}
