{
  final VirtualFile vcsRoot=VcsUtil.getVcsRootFor(project,filePath);
  if (vcsRoot == null) {
    return null;
  }
  HgFile hgFile=new HgFile(vcsRoot,filePath);
  HgLogCommand logCommand=new HgLogCommand(project);
  logCommand.setFollowCopies(true);
  List<HgFileRevision> revisions=logCommand.execute(hgFile,DEFAULT_LIMIT);
  final List<VcsFileRevision> result=new LinkedList<VcsFileRevision>();
  result.addAll(revisions);
  return new VcsHistorySession(){
    public VcsRevisionNumber getCurrentRevisionNumber(){
      return new HgWorkingCopyRevisionsCommand(project).identify(vcsRoot);
    }
    public List<VcsFileRevision> getRevisionList(){
      return result;
    }
    public boolean isCurrentRevision(    VcsRevisionNumber vcsRevisionNumber){
      return getCurrentRevisionNumber().equals(vcsRevisionNumber);
    }
    public boolean shouldBeRefreshed(){
      return false;
    }
    public boolean allowAsyncRefresh(){
      return false;
    }
    public boolean isContentAvailable(    VcsFileRevision vcsFileRevision){
      return false;
    }
    public HistoryAsTreeProvider getHistoryAsTreeProvider(){
      return null;
    }
  }
;
}
