{
  VcsConfiguration vcsConfiguration=VcsConfiguration.getInstance(project);
  int limit=vcsConfiguration.LIMIT_HISTORY ? vcsConfiguration.MAXIMUM_HISTORY_ROWS : -1;
  final HgLogCommand logCommand=new HgLogCommand(project);
  logCommand.setFollowCopies(!filePath.isDirectory() && HgUtil.getConfig(project,vcsRoot,"extensions","largefiles") == null);
  logCommand.setIncludeRemoved(true);
  try {
    return logCommand.execute(new HgFile(vcsRoot,filePath),limit,false);
  }
 catch (  HgCommandException e) {
    new HgCommandResultNotifier(project).notifyError(null,HgVcsMessages.message("hg4idea.error.log.command.execution"),e.getMessage());
    return Collections.emptyList();
  }
}
