{
  final Project project=getManager().getProject();
  getRefManager().iterate(new RefManager.RefIterator(){
    public void accept(    final RefElement refElement){
      if (myProblemElements.containsKey(refElement)) {
        ProblemDescriptor[] descriptions=getDescriptions(refElement);
        for (int i=0; i < descriptions.length; i++) {
          ProblemDescriptor description=descriptions[i];
          int line=description.getLineNumber();
          final String template=description.getDescriptionTemplate();
          final PsiElement psiElement=description.getPsiElement();
          final String text=psiElement.getText();
          String problemText=template.replaceAll("#ref",text.replaceAll("\\$","\\\\\\$"));
          problemText=problemText.replaceAll(" #loc "," ");
          Element element=XMLExportUtl.createElement(refElement,parentNode,line);
          Element problemClassElement=new Element("problem_class");
          problemClassElement.addContent(getDisplayName());
          element.addContent(problemClassElement);
          Element descriptionElement=new Element("description");
          descriptionElement.addContent(problemText);
          element.addContent(descriptionElement);
        }
      }
    }
  }
);
}
