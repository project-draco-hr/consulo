{
  PsiType type=null;
  if (element instanceof GrVariable) {
    if (position != null && GroovyRefactoringUtil.isLocalVariable(element)) {
      type=TypeInferenceHelper.getInferredType(position,((GrVariable)element).getName());
    }
 else {
      type=((GrVariable)element).getTypeGroovy();
    }
  }
 else   if (element instanceof PsiVariable) {
    type=((PsiVariable)element).getType();
  }
 else   if (element instanceof PsiMethod) {
    type=substitutor.substitute(((PsiMethod)element).getReturnType());
  }
  return type != null ? builder.withTypeText(type.getPresentableText()) : builder;
}
