{
  final Project project=MavenActionUtil.getProject(e);
  final List<File> files=getFiles(e);
  final List<VirtualFile> virtualFiles=collectVirtualFiles(files);
  if (files.size() == 1 && virtualFiles.isEmpty()) {
    new WriteCommandAction(project,e.getPresentation().getText()){
      @Override protected void run(      Result result) throws Throwable {
        File file=files.get(0);
        try {
          VirtualFile newFile=VfsUtil.createDirectoryIfMissing(file.getParent()).createChildData(this,file.getName());
          virtualFiles.add(newFile);
          MavenUtil.runFileTemplate(project,newFile,getFileTemplate());
        }
 catch (        IOException ex) {
          MavenUtil.showError(project,"Cannot create " + file.getName(),ex);
        }
      }
    }
.execute();
    return;
  }
  for (  VirtualFile each : virtualFiles) {
    new OpenFileDescriptor(project,each).navigate(true);
  }
}
