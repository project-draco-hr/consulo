{
  if (debug) {
    System.err.println("WriteRecord: recIdx = " + currRecIdx + " blkIdx = "+ currBlkIdx);
  }
  if (outStream == null) {
    throw new IOException("writing to an input buffer");
  }
  if (record.length != recordSize) {
    throw new IOException("record to write has length '" + record.length + "' which is not the record size of '"+ recordSize+ "'");
  }
  if (currRecIdx >= recsPerBlock) {
    writeBlock();
  }
  System.arraycopy(record,0,blockBuffer,(currRecIdx * recordSize),recordSize);
  currRecIdx++;
}
