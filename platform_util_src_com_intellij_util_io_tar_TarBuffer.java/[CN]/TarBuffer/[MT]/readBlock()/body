{
  if (debug) {
    System.err.println("ReadBlock: blkIdx = " + currBlkIdx);
  }
  if (inStream == null) {
    throw new IOException("reading from an output buffer");
  }
  currRecIdx=0;
  int offset=0;
  int bytesNeeded=blockSize;
  while (bytesNeeded > 0) {
    long numBytes=inStream.read(blockBuffer,offset,bytesNeeded);
    if (numBytes == -1) {
      if (offset == 0) {
        return false;
      }
      Arrays.fill(blockBuffer,offset,offset + bytesNeeded,(byte)0);
      break;
    }
    offset+=numBytes;
    bytesNeeded-=numBytes;
    if (numBytes != blockSize) {
      if (debug) {
        System.err.println("ReadBlock: INCOMPLETE READ " + numBytes + " of "+ blockSize+ " bytes read.");
      }
    }
  }
  currBlkIdx++;
  return true;
}
