{
  final ProjectFileIndex index=ProjectRootManager.getInstance(myManager.getProject()).getFileIndex();
  final MultiMap<VirtualFile,PsiSearchRequest> result=new MultiMap<VirtualFile,PsiSearchRequest>();
  for (  Set<IdIndexEntry> key : singles.keySet()) {
    final Collection<PsiSearchRequest> data=singles.get(key);
    GlobalSearchScope commonScope=uniteScopes(data);
    MultiMap<VirtualFile,PsiSearchRequest> intersection=null;
    boolean first=true;
    for (    IdIndexEntry entry : key) {
      final MultiMap<VirtualFile,PsiSearchRequest> local=findFilesWithIndexEntry(entry,index,data,commonScope);
      if (first) {
        intersection=local;
        first=false;
      }
 else {
        for (        VirtualFile file : local.keySet()) {
          if (intersection.containsKey(file)) {
            intersection.putValues(file,local.get(file));
          }
        }
      }
    }
    result.putAllValues(intersection);
  }
  return result;
}
