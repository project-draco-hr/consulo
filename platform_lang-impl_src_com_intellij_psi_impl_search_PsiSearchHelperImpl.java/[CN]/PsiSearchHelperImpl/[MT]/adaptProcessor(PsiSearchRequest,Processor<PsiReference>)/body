{
  final SearchScope searchScope=singleRequest.searchScope;
  final boolean ignoreInjectedPsi=searchScope instanceof LocalSearchScope && ((LocalSearchScope)searchScope).isIgnoreInjectedPsi();
  return new TextOccurenceProcessor(){
    public boolean execute(    PsiElement element,    int offsetInElement){
      if (ignoreInjectedPsi && element instanceof PsiLanguageInjectionHost)       return true;
      return singleRequest.processor.execute(element,offsetInElement,consumer);
    }
  }
;
}
