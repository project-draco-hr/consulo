{
  final MultiMap<VirtualFile,PsiSearchRequest> local=new MultiMap<VirtualFile,PsiSearchRequest>();
  ApplicationManager.getApplication().runReadAction(new Runnable(){
    public void run(){
      FileBasedIndex.getInstance().processValues(IdIndex.NAME,entry,null,new FileBasedIndex.ValueProcessor<Integer>(){
        public boolean process(        VirtualFile file,        Integer value){
          if (!IndexCacheManagerImpl.shouldBeFound(file,index)) {
            return true;
          }
          int mask=value.intValue();
          for (          PsiSearchRequest single : data) {
            if ((mask & single.searchContext) != 0 && ((GlobalSearchScope)single.searchScope).contains(file)) {
              local.putValue(file,single);
            }
          }
          return true;
        }
      }
,commonScope);
    }
  }
);
  return local;
}
