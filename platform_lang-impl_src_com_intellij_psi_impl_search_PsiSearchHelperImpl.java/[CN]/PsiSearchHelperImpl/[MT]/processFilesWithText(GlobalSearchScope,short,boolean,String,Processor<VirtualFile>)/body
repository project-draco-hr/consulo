{
  final ArrayList<IdIndexEntry> entries=getWordEntries(text,caseSensitively);
  if (entries.isEmpty())   return true;
  final Collection<VirtualFile> fileSet=ApplicationManager.getApplication().runReadAction(new Computable<Collection<VirtualFile>>(){
    @Override public Collection<VirtualFile> compute(){
      final CommonProcessors.CollectProcessor<VirtualFile> collectProcessor=new CommonProcessors.CollectProcessor<VirtualFile>();
      FileBasedIndex.getInstance().processFilesContainingAllKeys(IdIndex.NAME,entries,scope,new Condition<Integer>(){
        @Override public boolean value(        Integer integer){
          return (integer.intValue() & searchContext) != 0;
        }
      }
,collectProcessor);
      return collectProcessor.getResults();
    }
  }
);
  final FileIndexFacade index=FileIndexFacade.getInstance(myManager.getProject());
  return ContainerUtil.process(fileSet,new ReadActionProcessor<VirtualFile>(){
    @Override public boolean processInReadAction(    VirtualFile virtualFile){
      return !IndexCacheManagerImpl.shouldBeFound(scope,virtualFile,index) || processor.process(virtualFile);
    }
  }
);
}
