{
  List<TodoItem> items=new ArrayList<TodoItem>(occurrences.size());
  TextRange textRange=new TextRange(startOffset,endOffset);
  final TodoItemsCreator todoItemsCreator=new TodoItemsCreator();
  for (  IndexPatternOccurrence occurrence : occurrences) {
    TextRange occurrenceRange=occurrence.getTextRange();
    if (textRange.contains(occurrenceRange)) {
      items.add(todoItemsCreator.createTodo(occurrence));
    }
  }
  return items.toArray(new TodoItem[items.size()]);
}
