{
  ConfigImportSettings settings=getConfigImportSettings();
  File oldConfigDir=findOldConfigDir(newConfigPath,settings.getCustomPathsSelector());
  do {
    ImportOldConfigsPanel dlg;
    if (UIUtil.hasJdk6Dialogs()) {
      dlg=new ImportOldConfigsPanel(oldConfigDir,settings);
    }
 else {
      dlg=new ImportOldConfigsPanel(oldConfigDir,JOptionPane.getRootFrame(),settings);
    }
    UIUtil.setToolkitModal(dlg);
    AppUIUtil.updateDialogIcon(dlg);
    dlg.setVisible(true);
    if (dlg.isImportEnabled()) {
      File instHome=dlg.getSelectedFile();
      oldConfigDir=getOldConfigDir(instHome,settings);
      if (!validateOldConfigDir(instHome,oldConfigDir,settings))       continue;
      doImport(newConfigPath,oldConfigDir);
      settings.importFinished(newConfigPath);
      System.setProperty(CONFIG_IMPORTED_IN_CURRENT_SESSION_KEY,Boolean.TRUE.toString());
    }
    break;
  }
 while (true);
}
