{
  super(true);
  setTitle(title);
  myValidator=validator;
  myNameField.setText(macroName);
  myDocumentListener=new DocumentAdapter(){
    public void textChanged(    DocumentEvent event){
      updateControls();
    }
  }
;
  myNameField.getDocument().addDocumentListener(myDocumentListener);
  myValueField.setText(value);
  myValueField.addBrowseFolderListener(null,null,null,new FileChooserDescriptor(false,true,true,false,true,false),new TextComponentAccessor<JTextField>(){
    public String getText(    JTextField component){
      return component.getText();
    }
    public void setText(    JTextField component,    String text){
      final int len=text.length();
      if (len > 0 && text.charAt(len - 1) == File.separatorChar) {
        text=text.substring(0,len - 1);
      }
      component.setText(text);
    }
  }
);
  myValueField.getTextField().getDocument().addDocumentListener(myDocumentListener);
  init();
  updateControls();
}
