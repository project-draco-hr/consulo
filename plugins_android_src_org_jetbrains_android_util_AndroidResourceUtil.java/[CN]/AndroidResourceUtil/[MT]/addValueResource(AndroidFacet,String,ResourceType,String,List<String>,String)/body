{
  if (dirNames.size() == 0) {
    return false;
  }
  final VirtualFile[] resFiles=new VirtualFile[dirNames.size()];
  for (int i=0, n=dirNames.size(); i < n; i++) {
    final VirtualFile resFile=findOrCreateResourceFile(facet,fileName,dirNames.get(i));
    if (resFile == null) {
      return false;
    }
    resFiles[i]=resFile;
  }
  if (!ReadonlyStatusHandler.ensureFilesWritable(facet.getModule().getProject(),resFiles)) {
    return false;
  }
  final Resources[] resourcesElements=new Resources[resFiles.length];
  for (int i=0; i < resFiles.length; i++) {
    final Resources resources=AndroidUtils.loadDomElement(facet.getModule(),resFiles[i],Resources.class);
    if (resources == null) {
      reportError(facet.getModule().getProject(),AndroidBundle.message("not.resource.file.error",fileName));
      return false;
    }
    resourcesElements[i]=resources;
  }
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    @Override public void run(){
      for (      Resources resources : resourcesElements) {
        final ResourceElement element=addValueResource(resourceType,resources);
        element.getName().setValue(resourceName);
        if (value.length() > 0) {
          element.setStringValue(value);
        }
 else         if (resourceType == ResourceType.STYLEABLE || resourceType == ResourceType.STYLE) {
          element.setStringValue("value");
          element.getXmlTag().getValue().setText("");
        }
      }
    }
  }
);
  return true;
}
