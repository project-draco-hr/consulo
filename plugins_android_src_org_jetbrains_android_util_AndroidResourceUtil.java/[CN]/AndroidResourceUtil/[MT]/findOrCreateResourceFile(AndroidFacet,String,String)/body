{
  final Module module=facet.getModule();
  final Project project=module.getProject();
  final VirtualFile resDir=facet.getLocalResourceManager().getResourceDir();
  if (resDir == null) {
    reportError(project,AndroidBundle.message("check.resource.dir.error",module.getName()));
    return null;
  }
  final VirtualFile dir=AndroidUtils.createChildDirectoryIfNotExist(project,resDir,dirName);
  final String dirPath=FileUtil.toSystemDependentName(resDir.getPath() + '/' + dirName);
  if (dir == null) {
    reportError(project,AndroidBundle.message("android.cannot.create.dir.error",dirPath));
    return null;
  }
  final VirtualFile file=dir.findChild(fileName);
  if (file != null) {
    return file;
  }
  AndroidFileTemplateProvider.createFromTemplate(project,dir,AndroidFileTemplateProvider.VALUE_RESOURCE_FILE_TEMPLATE,fileName);
  final VirtualFile result=dir.findChild(fileName);
  if (result == null) {
    reportError(project,AndroidBundle.message("android.cannot.create.file.error",dirPath + File.separatorChar + fileName));
  }
  return result;
}
