{
  final Set<Module> processedModules=new HashSet<Module>();
  processedModules.add(module);
  ModuleRootManager.getInstance(module).processOrder(new JavaRootPolicy<LinkedHashSet<VirtualFile>>(){
    private boolean myJDKProcessed=false;
    public LinkedHashSet<VirtualFile> visitModuleSourceOrderEntry(    final ModuleSourceOrderEntry moduleSourceOrderEntry,    final LinkedHashSet<VirtualFile> value){
      value.addAll(Arrays.asList(moduleSourceOrderEntry.getFiles(OrderRootType.SOURCES)));
      return value;
    }
    public LinkedHashSet<VirtualFile> visitLibraryOrderEntry(    final LibraryOrderEntry libraryOrderEntry,    final LinkedHashSet<VirtualFile> value){
      value.addAll(Arrays.asList(libraryOrderEntry.getFiles(OrderRootType.CLASSES)));
      return value;
    }
    public LinkedHashSet<VirtualFile> visitModuleOrderEntry(    final ModuleOrderEntry moduleOrderEntry,    final LinkedHashSet<VirtualFile> value){
      final Module depModule=moduleOrderEntry.getModule();
      if (depModule != null && !processedModules.contains(depModule)) {
        processedModules.add(depModule);
        ModuleRootManager.getInstance(depModule).processOrder(this,value);
      }
      return value;
    }
    public LinkedHashSet<VirtualFile> visitJdkOrderEntry(    final JdkOrderEntry jdkOrderEntry,    final LinkedHashSet<VirtualFile> value){
      if (myJDKProcessed)       return value;
      myJDKProcessed=true;
      value.addAll(Arrays.asList(jdkOrderEntry.getFiles(OrderRootType.CLASSES)));
      return value;
    }
  }
,myEntries);
}
