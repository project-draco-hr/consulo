{
  myOriginalConfiguration=originalConfiguration;
  myModifiedConfiguration=modifiedConfiguration;
  myModulesProvider=modulesProvider;
  myFacetsProvider=facetsProvider;
  myPolicy=policy;
  myBuilder=builder;
  myProject=myPolicy.getModule().getProject();
  setTreeParameters(myBuilder.getDefaultParameters());
  myAddButton.addActionListener(new ActionListener(){
    public void actionPerformed(    final ActionEvent e){
      JBPopupFactory.getInstance().createListPopup(new AddPackagingElementPopupStep(PackagingEditorImpl.this,myPolicy.getAddActions())).showUnderneathOf(myAddButton);
    }
  }
);
  myEditButton.addActionListener(new ActionListener(){
    public void actionPerformed(    final ActionEvent e){
      PackagingElementsToEditInfo elementsToEdit=getSelectedElements().getElementsToEdit(myPolicy);
      if (elementsToEdit != null) {
        editElement(elementsToEdit);
      }
    }
  }
);
  myRemoveButton.addActionListener(new ActionListener(){
    public void actionPerformed(    final ActionEvent e){
      removeSelectedElements();
    }
  }
);
  ActionListener actionListener=new ActionListener(){
    public void actionPerformed(    final ActionEvent e){
      myTreeParameters=new PackagingTreeParameters(myShowIncludedCheckBox.isSelected(),myShowLibraryFilesCheckBox.isSelected());
      myBuilder.updateParameters(myTreeParameters);
      rebuildTree();
    }
  }
;
  myShowIncludedCheckBox.addActionListener(actionListener);
  myShowLibraryFilesCheckBox.addActionListener(actionListener);
  myShowIncludedCheckBox.setVisible(showIncludedCheckboxVisible);
}
