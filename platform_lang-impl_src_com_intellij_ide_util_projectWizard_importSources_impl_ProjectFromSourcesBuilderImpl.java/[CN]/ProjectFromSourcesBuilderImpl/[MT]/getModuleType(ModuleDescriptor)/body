{
  if (moduleDescriptor.isReuseExistingElement()) {
    final File file=new File(moduleDescriptor.computeModuleFilePath());
    if (file.exists()) {
      final Element rootElement=JDOMUtil.loadDocument(file).getRootElement();
      final String type=rootElement.getAttributeValue("type");
      if (type != null) {
        return ModuleTypeManager.getInstance().findByID(type);
      }
    }
    return null;
  }
 else {
    return moduleDescriptor.getModuleType();
  }
}
