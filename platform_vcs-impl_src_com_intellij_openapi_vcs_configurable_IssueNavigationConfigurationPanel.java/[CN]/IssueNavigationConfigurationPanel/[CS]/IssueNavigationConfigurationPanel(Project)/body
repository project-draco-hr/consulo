{
  super(new BorderLayout());
  myProject=project;
  add(myPanel,BorderLayout.CENTER);
  myDescriptionLabel.setText("<html>" + ApplicationNamesInfo.getInstance().getFullProductName() + " will search for the specified patterns in "+ "checkin comments and link them to issues in your issue tracker:</html>");
  reset();
  myAddButton.addActionListener(new ActionListener(){
    public void actionPerformed(    ActionEvent e){
      IssueLinkConfigurationDialog dlg=new IssueLinkConfigurationDialog(myProject);
      dlg.setTitle(VcsBundle.message("issue.link.add.title"));
      dlg.show();
      if (dlg.isOK()) {
        myLinks.add(dlg.getLink());
        myModel.fireTableDataChanged();
      }
    }
  }
);
  myAddJiraPatternButton.addActionListener(new ActionListener(){
    public void actionPerformed(    ActionEvent e){
      String s=Messages.showInputDialog(IssueNavigationConfigurationPanel.this,"Enter JIRA installation URL:","Add JIRA Issue Navigation Pattern",Messages.getQuestionIcon());
      if (s == null) {
        return;
      }
      if (!s.endsWith("/")) {
        s+="/";
      }
      myLinks.add(new IssueNavigationLink("[A-Z]+\\-\\d+",s + "browse/$0"));
      myModel.fireTableDataChanged();
    }
  }
);
  myAddYouTrackPatternButton.addActionListener(new ActionListener(){
    public void actionPerformed(    ActionEvent e){
      String s=Messages.showInputDialog(IssueNavigationConfigurationPanel.this,"Enter YouTrack installation URL:","Add YouTrack Issue Navigation Pattern",Messages.getQuestionIcon());
      if (s == null) {
        return;
      }
      if (!s.endsWith("/")) {
        s+="/";
      }
      myLinks.add(new IssueNavigationLink("[A-Z]+\\-\\d+",s + "issue/$0"));
      myModel.fireTableDataChanged();
    }
  }
);
  myEditButton.addActionListener(new ActionListener(){
    public void actionPerformed(    ActionEvent e){
      IssueNavigationLink link=(IssueNavigationLink)myModel.getItem(myLinkTable.getSelectedRow());
      IssueLinkConfigurationDialog dlg=new IssueLinkConfigurationDialog(myProject);
      dlg.setTitle(VcsBundle.message("issue.link.edit.title"));
      dlg.setLink(link);
      dlg.show();
      if (dlg.isOK()) {
        final IssueNavigationLink editedLink=dlg.getLink();
        link.setIssueRegexp(editedLink.getIssueRegexp());
        link.setLinkRegexp(editedLink.getLinkRegexp());
        myModel.fireTableDataChanged();
      }
    }
  }
);
  myDeleteButton.addActionListener(new ActionListener(){
    public void actionPerformed(    ActionEvent e){
      if (Messages.showOkCancelDialog(myProject,VcsBundle.message("issue.link.delete.prompt"),VcsBundle.message("issue.link.delete.title"),Messages.getQuestionIcon()) == 0) {
        int selRow=myLinkTable.getSelectedRow();
        myLinks.remove(selRow);
        myModel.fireTableDataChanged();
        if (myLinkTable.getRowCount() > 0) {
          if (selRow >= myLinkTable.getRowCount()) {
            selRow--;
          }
          myLinkTable.getSelectionModel().setSelectionInterval(selRow,selRow);
        }
      }
    }
  }
);
  myLinkTable.getSelectionModel().addListSelectionListener(new ListSelectionListener(){
    public void valueChanged(    final ListSelectionEvent e){
      updateButtons();
    }
  }
);
  myLinkTable.getEmptyText().setText(VcsBundle.message("issue.link.no.patterns"));
  updateButtons();
}
