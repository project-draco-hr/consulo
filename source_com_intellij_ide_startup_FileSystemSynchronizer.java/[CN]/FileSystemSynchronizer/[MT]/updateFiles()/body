{
  ProgressIndicator indicator=ProgressManager.getInstance().getProgressIndicator();
  if (indicator != null) {
    indicator.pushState();
    indicator.setText("Parsing files. Please wait...");
  }
  int totalFiles=myFilesToUpdate.size();
  int count=0;
  for (Iterator<VirtualFile> iterator=myFilesToUpdate.iterator(); iterator.hasNext(); ) {
    VirtualFile file=iterator.next();
    if (indicator != null) {
      indicator.setFraction(((double)++count) / totalFiles);
      indicator.setText2(file.getPresentableUrl());
    }
    FileContent content=new FileContent(file);
    for (int i=0; i < myUpdaters.size(); i++) {
      CacheUpdater updater=myUpdaters.get(i);
      if (myUpdateSets[i].remove(file)) {
        try {
          updater.processFile(content);
        }
 catch (        ProcessCanceledException e) {
          throw e;
        }
catch (        Exception e) {
          LOG.error(e);
        }
        if (myUpdateSets[i].isEmpty()) {
          try {
            updater.updatingDone();
          }
 catch (          ProcessCanceledException e) {
            throw e;
          }
catch (          Exception e) {
            LOG.error(e);
          }
          myUpdaters.set(i,null);
        }
      }
    }
  }
  updatingDone();
  if (indicator != null) {
    indicator.popState();
  }
}
