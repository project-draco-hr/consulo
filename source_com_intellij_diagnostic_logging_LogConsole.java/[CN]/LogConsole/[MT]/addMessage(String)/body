{
  final String key=LogConsolePreferences.getType(text);
  if (LogConsolePreferences.getInstanceEx(myProject).isApplicable(text,myPrevType)) {
    myProcessHandler.notifyTextAvailable(text + "\n",key != null ? LogConsolePreferences.getProcessOutputTypes(key) : (myPrevType == LogConsolePreferences.ERROR ? ProcessOutputTypes.STDERR : ProcessOutputTypes.STDOUT));
  }
  if (key != null) {
    myPrevType=key;
  }
  myOriginalDocument=getOriginalDocument();
  if (myOriginalDocument != null) {
    ApplicationManager.getApplication().invokeLater(new Runnable(){
      public void run(){
        ApplicationManager.getApplication().runWriteAction(new Runnable(){
          public void run(){
            myOriginalDocument.insertString(myOriginalDocument.getTextLength(),text + "\n");
          }
        }
);
      }
    }
,ModalityState.NON_MODAL);
  }
}
