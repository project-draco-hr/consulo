{
  myTree=tree;
  clear();
  mySelected=selected;
  myFocused=isFocused();
  if (UIUtil.isFullRowSelectionLAF()) {
    setBackground(selected ? UIUtil.getTreeSelectionBackground() : null);
  }
 else   if (tree.getUI() instanceof WideSelectionTreeUI && ((WideSelectionTreeUI)tree.getUI()).isWideSelection()) {
    setPaintFocusBorder(false);
    if (selected) {
      setBackground(hasFocus ? UIUtil.getTreeSelectionBackground() : UIUtil.getTreeUnfocusedSelectionBackground());
    }
  }
 else {
    if (selected) {
      setPaintFocusBorder(true);
      if (myFocused) {
        setBackground(UIUtil.getTreeSelectionBackground());
      }
 else {
        setBackground(null);
      }
    }
 else {
      setBackground(null);
    }
  }
  if (value instanceof LoadingNode) {
    setForeground(Color.gray);
    setIcon(LOADING_NODE_ICON);
  }
 else {
    setForeground(tree.getForeground());
    setIcon(null);
  }
  if (UIUtil.isUnderGTKLookAndFeel()) {
    super.setOpaque(false);
    super.setIconOpaque(false);
  }
 else   if (UIUtil.isUnderNimbusLookAndFeel() && selected && hasFocus) {
    super.setOpaque(false);
    super.setIconOpaque(false);
  }
 else   if (tree.getUI() instanceof WideSelectionTreeUI && ((WideSelectionTreeUI)tree.getUI()).isWideSelection()) {
    super.setOpaque(false);
    super.setIconOpaque(false);
  }
 else {
    super.setOpaque(myOpaque || selected && hasFocus || selected && isFocused());
  }
  if (tree.getUI() instanceof WideSelectionTreeUI && UIUtil.isUnderAquaBasedLookAndFeel()) {
    setMyBorder(null);
    setIpad(new Insets(0,2,0,2));
  }
  if (getFont() == null) {
    setFont(tree.getFont());
  }
  customizeCellRenderer(tree,value,selected,expanded,leaf,row,hasFocus);
  return this;
}
