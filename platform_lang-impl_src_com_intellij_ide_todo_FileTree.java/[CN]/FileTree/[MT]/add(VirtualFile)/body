{
  if (myFiles.contains(file)) {
    return;
  }
  VirtualFile dir=file.getParent();
  if (dir == null) {
    LOG.error(file);
    return;
  }
  myFiles.add(file);
  List<VirtualFile> children=myStrictDirectory2Children.get(dir);
  if (children != null) {
    LOG.assertTrue(!children.contains(file));
    children.add(file);
  }
 else {
    children=new ArrayList<VirtualFile>(2);
    children.add(file);
    myStrictDirectory2Children.put(dir,children);
  }
  children=myDirectory2Children.get(dir);
  if (children != null) {
    LOG.assertTrue(!children.contains(file));
    children.add(file);
    return;
  }
 else {
    children=new ArrayList<VirtualFile>(2);
    children.add(file);
    myDirectory2Children.put(dir,children);
  }
  VirtualFile parent=dir.getParent();
  while (parent != null) {
    children=myDirectory2Children.get(parent);
    if (children != null) {
      if ((!children.contains(dir))) {
        children.add(dir);
      }
      return;
    }
 else {
      children=new ArrayList<VirtualFile>(2);
      children.add(dir);
      myDirectory2Children.put(parent,children);
    }
    dir=parent;
    parent=parent.getParent();
  }
}
