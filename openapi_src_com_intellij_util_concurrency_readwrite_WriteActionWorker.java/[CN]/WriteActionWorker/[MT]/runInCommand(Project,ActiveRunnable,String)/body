{
  final CommandWrapper commandWrapper=new CommandWrapper(aActiveRunnable);
  CommandWaiter commandWaiter=new CommandWaiter(commandWrapper);
  if (EventQueue.isDispatchThread()) {
    CommandProcessor.getInstance().executeCommand(project,commandWrapper,aCommandName,null);
  }
 else {
    SwingUtilities.invokeLater(new Runnable(){
      public void run(){
        CommandProcessor.getInstance().executeCommand(project,commandWrapper,aCommandName,null);
      }
    }
);
  }
  commandWaiter.waitForCompletion();
  commandWrapper.throwException();
  return commandWrapper.getResult();
}
