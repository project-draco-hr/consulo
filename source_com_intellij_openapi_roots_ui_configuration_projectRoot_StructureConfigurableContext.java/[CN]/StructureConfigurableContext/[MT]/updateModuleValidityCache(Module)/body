{
  if (myValidityCache.containsKey(module))   return;
  if (myDisposed)   return;
  Map<String,Set<String>> problems=null;
  final ModifiableModuleModel moduleModel=myModulesConfigurator.getModuleModel();
  final Module[] all=moduleModel.getModules();
  for (  Module each : all) {
    if (each != module && getRealName(each).equals(getRealName(module))) {
      problems=new HashMap<String,Set<String>>();
      problems.put(DUPLICATE_MODULE_NAME,null);
      break;
    }
  }
  final ModuleRootModel rootModel=myModulesConfigurator.getRootModel(module);
  if (rootModel == null)   return;
  final OrderEntry[] entries=rootModel.getOrderEntries();
  for (  OrderEntry entry : entries) {
    if (myDisposed)     return;
    if (!entry.isValid()) {
      if (problems == null) {
        problems=new HashMap<String,Set<String>>();
      }
      if (entry instanceof JdkOrderEntry && ((JdkOrderEntry)entry).getJdkName() == null) {
        problems.put(NO_JDK,null);
      }
 else {
        Set<String> deletedLibraries=problems.get(DELETED_LIBRARIES);
        if (deletedLibraries == null) {
          deletedLibraries=new HashSet<String>();
          problems.put(DELETED_LIBRARIES,deletedLibraries);
        }
        deletedLibraries.add(entry.getPresentableName());
      }
    }
  }
  final Map<String,Set<String>> finalProblems=problems;
  SwingUtilities.invokeLater(new Runnable(){
    public void run(){
      if (!myDisposed) {
        myValidityCache.put(module,finalProblems);
        fireOnCacheChanged();
      }
    }
  }
);
}
