{
  for (  final GrTopLevelDefintion definition : getTopLevelDefinitions()) {
    if (!ResolveUtil.processElement(processor,definition))     return false;
  }
  PsiManager manager=getManager();
  if (!(lastParent instanceof GrTypeDefinition)) {
    if (!ResolveUtil.processElement(processor,getSyntheticArgsParameter()))     return false;
    PsiClass scriptClass=getScriptClass();
    if (scriptClass != null && !scriptClass.processDeclarations(processor,substitutor,lastParent,place))     return false;
  }
  if (!processChildrenScopes(this,processor,substitutor,lastParent,place))   return false;
  final GrImportStatement[] imports=getImportStatements();
  for (  GrImportStatement importStatement : imports) {
    if (!importStatement.isOnDemand() && !importStatement.processDeclarations(processor,substitutor,lastParent,place)) {
      return false;
    }
  }
  String currentPackageName=getPackageName();
  PsiPackage currentPackage=manager.findPackage(currentPackageName);
  if (currentPackage != null && !currentPackage.processDeclarations(processor,substitutor,lastParent,place))   return false;
  for (  GrImportStatement importStatement : imports) {
    if (importStatement.isOnDemand() && !importStatement.processDeclarations(processor,substitutor,lastParent,place))     return false;
  }
  for (  final String implicitlyImported : IMPLICITLY_IMPORTED_PACKAGES) {
    PsiPackage aPackage=manager.findPackage(implicitlyImported);
    if (aPackage != null && !aPackage.processDeclarations(processor,substitutor,lastParent,place))     return false;
  }
  for (  String implicitlyImportedClass : IMPLICITLY_IMPORTED_CLASSES) {
    PsiClass clazz=manager.findClass(implicitlyImportedClass,getResolveScope());
    if (clazz != null && !ResolveUtil.processElement(processor,clazz))     return false;
  }
  if (currentPackageName.length() > 0) {
    PsiPackage defaultPackage=manager.findPackage("");
    if (defaultPackage != null) {
      for (      PsiPackage subpackage : defaultPackage.getSubPackages(getResolveScope())) {
        if (!ResolveUtil.processElement(processor,subpackage))         return false;
      }
    }
  }
  return true;
}
