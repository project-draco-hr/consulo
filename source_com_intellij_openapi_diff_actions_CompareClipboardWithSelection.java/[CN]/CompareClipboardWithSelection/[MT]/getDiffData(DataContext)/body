{
  Project project=(Project)dataContext.getData(DataConstants.PROJECT);
  if (project == null)   return null;
  Object editorData=dataContext.getData(DataConstants.EDITOR);
  Editor editor=editorData != null ? (Editor)editorData : FileEditorManager.getInstance(project).getSelectedTextEditor();
  if (editor == null)   return null;
  if (!editor.getSelectionModel().hasSelection())   return null;
  return new ClipboardSelectionContents(editor,project);
}
