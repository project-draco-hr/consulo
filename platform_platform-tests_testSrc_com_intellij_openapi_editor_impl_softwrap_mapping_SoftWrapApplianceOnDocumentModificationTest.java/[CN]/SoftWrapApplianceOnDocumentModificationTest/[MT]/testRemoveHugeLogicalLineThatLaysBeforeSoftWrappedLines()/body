{
  String text="short line\n" + "this is a long line that is expected to be soft wrapped into more than one or even two visual lines\n" + "1. just a line that is long enough to be soft wrapped\n"+ "2. just a line that is long enough to be soft wrapped\n"+ "3. just a line that is long enough to be soft wrapped\n"+ "4. just a line that is long enough to be soft wrapped";
  init(15,text);
  Document document=myEditor.getDocument();
  int start=document.getLineStartOffset(1);
  int end=document.getLineEndOffset(1) + 1;
  int visualLinesToRemove=getSoftWrapModel().getSoftWrapsForLine(1).size() + 1;
  List<VisualPosition> positionsBefore=new ArrayList<VisualPosition>();
  for (int i=end; i < text.length(); i++) {
    positionsBefore.add(myEditor.offsetToVisualPosition(i));
  }
  Collections.reverse(positionsBefore);
  myEditor.getSelectionModel().setSelection(start,end);
  delete();
  for (int i=start; i < document.getTextLength(); i++) {
    VisualPosition position=positionsBefore.remove(positionsBefore.size() - 1);
    assertEquals(new VisualPosition(position.line - visualLinesToRemove,position.column),myEditor.offsetToVisualPosition(i));
  }
}
