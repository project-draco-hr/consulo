{
  String text="class Test {\n" + "    public void foo() {\n" + "        System.out.println(\"test\");\n"+ "    }\n"+ "}";
  init(40,text);
  final FoldingModel foldingModel=myEditor.getFoldingModel();
  assertEmpty(foldingModel.getAllFoldRegions());
  final int startOffset=text.indexOf('{');
  final int endOffset=text.indexOf('}') + 1;
  VisualPosition foldStartPosition=myEditor.offsetToVisualPosition(startOffset);
  addFoldRegion(startOffset,endOffset,"...");
  final FoldRegion foldRegion=getFoldRegion(startOffset);
  assertNotNull(foldRegion);
  assertTrue(foldRegion.isExpanded());
  toggleFoldRegionState(foldRegion,false);
  assertEquals(foldStartPosition,myEditor.offsetToVisualPosition(startOffset + 5));
}
