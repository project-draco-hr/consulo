{
  String text="\n" + "fold line1\n" + "fold line2\n"+ "fold line3\n"+ "fold line4\n"+ "normal line1";
  init(20,text);
  int afterFoldOffset=text.indexOf("normal line1");
  addCollapsedFoldRegion(text.indexOf("fold line1") + 2,afterFoldOffset - 1,"...");
  VisualPosition beforeModification=myEditor.offsetToVisualPosition(afterFoldOffset);
  myEditor.getCaretModel().moveToOffset(0);
  type('a');
  assertEquals(beforeModification,myEditor.offsetToVisualPosition(afterFoldOffset + 1));
}
