{
  String text="/**\n" + " * This is a test comment\n" + " */\n"+ "public class Test {\n"+ "}";
  init(100,text);
  addCollapsedFoldRegion(0,text.indexOf("public") - 1,"/**...*/");
  int offset=text.indexOf("class");
  CaretModel caretModel=myEditor.getCaretModel();
  caretModel.moveToOffset(offset);
  assertEquals(offset,caretModel.getOffset());
  assertEquals(1,caretModel.getVisualPosition().line);
  toggleFoldRegionState(getFoldRegion(0),true);
  assertEquals(3,caretModel.getVisualPosition().line);
  assertEquals(offset,caretModel.getOffset());
}
