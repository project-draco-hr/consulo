{
  final Set<VirtualFile> roots=new HashSet<VirtualFile>();
  final ProjectRootManager projectRootManager=ProjectRootManager.getInstance(myProject);
  final ProjectFileIndex projectFileIndex=projectRootManager.getFileIndex();
  for (  VirtualFile root : projectRootManager.getContentRoots()) {
    VirtualFile parent=root.getParent();
    if (parent == null || !projectFileIndex.isInContent(parent)) {
      roots.add(root);
    }
  }
  for (  final NavBarModelExtension modelExtension : Extensions.getExtensions(NavBarModelExtension.EP_NAME)) {
    for (    VirtualFile root : modelExtension.additionalRoots(psiElement.getProject())) {
      VirtualFile parent=root.getParent();
      if (parent == null || !projectFileIndex.isInContent(parent)) {
        roots.add(root);
      }
    }
  }
  final List<Object> updatedModel=new ArrayList<Object>();
  ApplicationManager.getApplication().runReadAction(new Runnable(){
    @Override public void run(){
      traverseToRoot(psiElement,roots,updatedModel);
    }
  }
);
  setModel(updatedModel);
}
