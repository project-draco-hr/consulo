{
  SelectionModel selectionModel=editor.getSelectionModel();
  Document document=editor.getDocument();
  if (EditorUtil.isPasswordEditor(editor)) {
    selectionModel.setSelection(0,document.getTextLength());
    return;
  }
  int lineNumber=editor.getCaretModel().getLogicalPosition().line;
  int caretOffset=editor.getCaretModel().getOffset();
  if (lineNumber >= document.getLineCount()) {
    return;
  }
  boolean camel=editor.getSettings().isCamelWords();
  List<TextRange> ranges=new ArrayList<TextRange>();
  int textLength=document.getTextLength();
  if (caretOffset == textLength)   caretOffset--;
  if (caretOffset < 0)   return;
  SelectWordUtil.addWordOrLexemeSelection(camel,editor,caretOffset,ranges);
  if (ranges.isEmpty())   return;
  final TextRange selectionRange=new TextRange(selectionModel.getSelectionStart(),selectionModel.getSelectionEnd());
  TextRange minimumRange=new TextRange(0,document.getTextLength());
  for (  TextRange range : ranges) {
    if (range.contains(selectionRange) && !range.equals(selectionRange)) {
      if (minimumRange.contains(range)) {
        minimumRange=range;
      }
    }
  }
  selectionModel.setSelection(minimumRange.getStartOffset(),minimumRange.getEndOffset());
}
