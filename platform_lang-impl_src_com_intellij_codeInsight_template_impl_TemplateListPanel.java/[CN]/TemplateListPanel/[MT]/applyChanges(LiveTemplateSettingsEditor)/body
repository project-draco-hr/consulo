{
  TemplateImpl template=dialog.getTemplate();
  if (template == MOCK_TEMPLATE) {
    return;
  }
  String oldGroupName=template.getGroupName();
  TemplateGroup group=getTemplateGroup(oldGroupName);
  LOG.assertTrue(group != null,oldGroupName);
  dialog.apply();
  updateTemplateTextArea();
  List<TreePath> expandedPaths=TreeUtil.collectExpandedPaths(myTree);
  TreePath[] selectedPaths=myTree.getSelectionPaths();
  fireStructureChange();
  TreeUtil.restoreExpandedPaths(myTree,expandedPaths);
  if (selectedPaths != null) {
    myTree.setSelectionPaths(selectedPaths);
  }
  myTree.validate();
  myTree.repaint();
}
