{
  JPanel tablePanel=new JPanel();
  tablePanel.setBorder(BorderFactory.createLineBorder(Color.gray));
  tablePanel.setLayout(new BorderLayout());
  tablePanel.add(createTable(),BorderLayout.CENTER);
  JPanel tableButtonsPanel=new JPanel();
  tableButtonsPanel.setBorder(BorderFactory.createEmptyBorder(10,10,10,10));
  tableButtonsPanel.setLayout(new GridBagLayout());
  GridBagConstraints gbConstraints=new GridBagConstraints();
  gbConstraints.gridwidth=GridBagConstraints.REMAINDER;
  gbConstraints.fill=GridBagConstraints.HORIZONTAL;
  gbConstraints.insets=new Insets(0,0,4,0);
  final JButton addButton=createButton(tableButtonsPanel,gbConstraints,CodeInsightBundle.message("templates.dialog.table.action.add"));
  addButton.setEnabled(true);
  myCopyButton=createButton(tableButtonsPanel,gbConstraints,CodeInsightBundle.message("templates.dialog.table.action.copy"));
  myEditButton=createButton(tableButtonsPanel,gbConstraints,CodeInsightBundle.message("templates.dialog.table.action.edit"));
  myRemoveButton=createButton(tableButtonsPanel,gbConstraints,CodeInsightBundle.message("templates.dialog.table.action.remove"));
  if (getSchemesManager().isExportAvailable()) {
    myExportButton=createButton(tableButtonsPanel,gbConstraints,"Share...");
    myEditButton.setMnemonic('S');
    myExportButton.addActionListener(new ActionListener(){
      public void actionPerformed(      final ActionEvent e){
        exportCurrentGroup();
      }
    }
);
  }
  if (getSchemesManager().isImportAvailable()) {
    myImportButton=createButton(tableButtonsPanel,gbConstraints,"Import Shared...");
    myImportButton.setMnemonic('I');
    myImportButton.setEnabled(true);
    myImportButton.addActionListener(new ActionListener(){
      public void actionPerformed(      final ActionEvent e){
        new SchemesToImportPopup<TemplateGroup,TemplateGroup>(TemplateListPanel.this){
          protected void onSchemeSelected(          final TemplateGroup scheme){
            for (            TemplateImpl newTemplate : scheme.getElements()) {
              for (              TemplateImpl existingTemplate : collectAllTemplates()) {
                if (existingTemplate.getKey().equals(newTemplate.getKey())) {
                  Messages.showMessageDialog(TemplateListPanel.this,CodeInsightBundle.message("dialog.edit.template.error.already.exists",existingTemplate.getKey(),existingTemplate.getGroupName()),CodeInsightBundle.message("dialog.edit.template.error.title"),Messages.getErrorIcon());
                  return;
                }
              }
            }
            insertNewGroup(scheme);
            for (            TemplateImpl template : scheme.getElements()) {
              addTemplate(template);
            }
          }
        }
.show(getSchemesManager(),myTemplateGroups);
      }
    }
);
  }
  gbConstraints.weighty=1;
  tableButtonsPanel.add(new JPanel(),gbConstraints);
  tablePanel.add(tableButtonsPanel,BorderLayout.EAST);
  optionsPanel.add(tablePanel,BorderLayout.CENTER);
  JPanel textPanel=new JPanel(new BorderLayout());
  textPanel.setBorder(BorderFactory.createEmptyBorder(10,0,0,0));
  myEditor=TemplateEditorUtil.createEditor(true,"");
  textPanel.add(myEditor.getComponent(),BorderLayout.CENTER);
  textPanel.add(createExpandByPanel(),BorderLayout.SOUTH);
  textPanel.setPreferredSize(new Dimension(100,myEditor.getLineHeight() * 12));
  optionsPanel.add(textPanel,BorderLayout.SOUTH);
  addButton.addActionListener(new ActionListener(){
    public void actionPerformed(    ActionEvent event){
      addRow();
    }
  }
);
  myCopyButton.addActionListener(new ActionListener(){
    public void actionPerformed(    ActionEvent event){
      copyRow();
    }
  }
);
  myEditButton.addActionListener(new ActionListener(){
    public void actionPerformed(    ActionEvent event){
      edit();
    }
  }
);
  myRemoveButton.addActionListener(new ActionListener(){
    public void actionPerformed(    ActionEvent event){
      removeRow();
    }
  }
);
}
