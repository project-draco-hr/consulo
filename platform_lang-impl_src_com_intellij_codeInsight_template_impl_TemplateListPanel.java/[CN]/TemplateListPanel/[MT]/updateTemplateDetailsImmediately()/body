{
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    public void run(){
      int selected=getSelectedIndex();
      CardLayout layout=(CardLayout)myDetailsPanel.getLayout();
      if (selected < 0 || getTemplate(selected) == null) {
        layout.show(myDetailsPanel,NO_SELECTION);
      }
 else {
        TemplateImpl newTemplate=getTemplate(selected);
        if (myCurrentTemplateEditor == null || !myCurrentTemplateEditor.getTemplate().equals(newTemplate)) {
          if (myCurrentTemplateEditor != null) {
            applyChanges(myCurrentTemplateEditor);
            myCurrentTemplateEditor.dispose();
          }
          updateTemplateDetails(newTemplate,(String)myExpandByCombo.getSelectedItem(),getOptions(newTemplate),getContext(newTemplate));
        }
        layout.show(myDetailsPanel,TEMPLATE_SETTINGS);
      }
    }
  }
);
}
