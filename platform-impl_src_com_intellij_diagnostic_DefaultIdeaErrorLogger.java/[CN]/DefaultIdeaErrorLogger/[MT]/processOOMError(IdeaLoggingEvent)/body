{
  final String message=event.getThrowable().getMessage();
  final String option=message != null && message.indexOf(PARAM_PERMGEN) >= 0 ? PARAM_MAXPERMSIZE : PARAM_XMX;
  ourOomOccured=true;
  event.getThrowable().printStackTrace();
  SwingUtilities.invokeAndWait(new Runnable(){
    public void run(){
      String message=DiagnosticBundle.message("diagnostic.out.of.memory.error",ApplicationNamesInfo.getInstance().getProductName(),option,getSettingsFilePath());
      if (JOptionPane.showOptionDialog(JOptionPane.getRootFrame(),message,DiagnosticBundle.message("diagnostic.out.of.memory.title"),JOptionPane.DEFAULT_OPTION,JOptionPane.ERROR_MESSAGE,null,new Object[]{DiagnosticBundle.message("diagnostic.out.of.memory.shutdown"),DiagnosticBundle.message("diagnostic.out.of.memory.ignore")},DiagnosticBundle.message("diagnostic.out.of.memory.shutdown")) == 0) {
        try {
          ApplicationManager.getApplication().exit();
        }
 catch (        Throwable e) {
          System.exit(0);
        }
      }
    }
  }
);
}
