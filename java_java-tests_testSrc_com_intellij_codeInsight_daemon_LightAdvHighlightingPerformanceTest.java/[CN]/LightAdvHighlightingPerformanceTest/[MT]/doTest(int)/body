{
  @NonNls String filePath=LightAdvHighlightingTest.BASE_PATH + "/" + getTestName(false)+ ".java";
  configureByFile(filePath);
  PsiDocumentManager.getInstance(getProject()).commitAllDocuments();
  getFile().getText();
  CodeInsightTestFixtureImpl.ensureIndexesUpToDate(getProject());
  final List<HighlightInfo> infos=new ArrayList<HighlightInfo>();
  PlatformTestUtil.startPerformanceTest(maxMillis,new ThrowableRunnable(){
    @Override public void run() throws Exception {
      infos.clear();
      DaemonCodeAnalyzer.getInstance(getProject()).restart();
      List<HighlightInfo> h=doHighlighting();
      infos.addAll(h);
    }
  }
).cpuBound().usesAllCPUCores().assertTiming();
  return DaemonAnalyzerTestCase.filter(infos,HighlightSeverity.ERROR);
}
