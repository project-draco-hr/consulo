{
  final Collection<VirtualFile> files=FileBasedIndex.getInstance().getContainingFiles(NAME,name,VirtualFileFilter.ALL);
  if (files.isEmpty())   return PsiFile.EMPTY_ARRAY;
  List<PsiFile> result=new ArrayList<PsiFile>();
  for (  VirtualFile file : files) {
    if (!file.isValid() || !scope.contains(file))     continue;
    PsiFile psiFile=PsiManager.getInstance(project).findFile(file);
    if (psiFile != null) {
      result.add(psiFile);
    }
  }
  return result.toArray(new PsiFile[result.size()]);
}
