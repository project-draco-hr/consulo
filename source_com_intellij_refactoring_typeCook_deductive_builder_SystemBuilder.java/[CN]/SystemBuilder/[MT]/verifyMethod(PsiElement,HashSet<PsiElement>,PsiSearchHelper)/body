{
  PsiMethod method=null;
  PsiParameter parameter=null;
  int index=0;
  if (element instanceof PsiMethod) {
    method=(PsiMethod)element;
  }
 else   if (element instanceof PsiParameter) {
    parameter=(PsiParameter)element;
    method=(PsiMethod)parameter.getDeclarationScope();
    index=method.getParameterList().getParameterIndex(parameter);
  }
 else {
    LOG.error("Parameter or method expected, but found " + (element == null ? "null" : element.getClass().getName()));
    return false;
  }
  final PsiMethod superMethod=PsiSuperMethodUtil.findDeepestSuperMethod(method);
  PsiMethod keyMethod;
  PsiParameter keyParameter=null;
  if (superMethod != null) {
    Boolean good=myMethodCache.get(superMethod);
    if (good != null && !good.booleanValue()) {
      return false;
    }
    final PsiElement e=parameter == null ? (PsiElement)superMethod : superMethod.getParameterList().getParameters()[index];
    if (!victims.contains(e)) {
      myMethodCache.put(superMethod,new Boolean(false));
      return false;
    }
    keyMethod=superMethod;
    myMethods.put(method,keyMethod);
    if (parameter != null) {
      keyParameter=(PsiParameter)e;
    }
  }
 else {
    Boolean good=myMethodCache.get(method);
    if (good != null && good.booleanValue()) {
      if (myMethods.get(method) == null) {
        myMethods.put(method,method);
      }
      if (parameter != null && myParameters.get(parameter) == null) {
        myParameters.put(parameter,parameter);
      }
      return true;
    }
    keyMethod=method;
    keyParameter=parameter;
  }
  final PsiMethod[] overriders=helper.findOverridingMethods(keyMethod,keyMethod.getUseScope(),true);
  for (int i=0; i < overriders.length; i++) {
    final PsiMethod overrider=overriders[i];
    final PsiElement e=parameter == null ? (PsiElement)overrider : overrider.getParameterList().getParameters()[index];
    if (!victims.contains(e)) {
      myMethodCache.put(keyMethod,new Boolean(false));
      return false;
    }
  }
  for (int i=0; i < overriders.length; i++) {
    final PsiMethod overrider=overriders[i];
    final PsiElement e=parameter == null ? (PsiElement)overrider : overrider.getParameterList().getParameters()[index];
    mySuper.put(overrider,keyMethod);
    myMethods.put(overrider,keyMethod);
    if (parameter != null) {
      myParameters.put((PsiParameter)e,keyParameter);
    }
  }
  myMethods.put(method,keyMethod);
  if (parameter != null) {
    myParameters.put(parameter,keyParameter);
  }
  myMethodCache.put(keyMethod,new Boolean(true));
  return true;
}
