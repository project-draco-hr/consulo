{
  PsiType t=myTypes.get(e);
  if (t != null) {
    return t;
  }
  if (e instanceof PsiVariable) {
    t=((PsiVariable)e).getType();
  }
 else   if (e instanceof PsiTypeCastExpression) {
    t=((PsiTypeCastExpression)e).getCastType().getType();
  }
 else   if (e instanceof PsiNewExpression) {
    t=((PsiNewExpression)e).getType();
  }
 else   if (e instanceof PsiMethod) {
    t=((PsiMethod)e).getReturnType();
  }
 else {
    LOG.error("Variable, method, new or cast expected but found " + (e == null ? " null" : e.getClass().getName()));
  }
  final PsiType parameterizedType=Util.createParameterizedType(t,myTypeVariableFactory);
  myTypes.put(e,parameterizedType);
  return parameterizedType;
}
