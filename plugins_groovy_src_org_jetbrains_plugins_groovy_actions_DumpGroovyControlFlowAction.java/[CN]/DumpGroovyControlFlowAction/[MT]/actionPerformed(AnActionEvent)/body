{
  final Editor editor=PlatformDataKeys.EDITOR.getData(e.getDataContext());
  if (editor == null)   return;
  final PsiFile psiFile=HandlerUtils.getPsiFile(editor,e.getDataContext());
  if (!(psiFile instanceof GroovyFile))   return;
  int offset=editor.getCaretModel().getOffset();
  final List<GrControlFlowOwner> controlFlowOwners=collectControlFlowOwners(psiFile,editor,offset);
  if (controlFlowOwners.size() == 0)   return;
  if (controlFlowOwners.size() == 1) {
    passInner(controlFlowOwners.get(0));
  }
 else {
    IntroduceTargetChooser.showChooser(editor,controlFlowOwners,new Pass<GrControlFlowOwner>(){
      @Override public void pass(      GrControlFlowOwner grExpression){
        passInner(grExpression);
      }
    }
,new Function<GrControlFlowOwner,String>(){
      @Override public String fun(      GrControlFlowOwner flowOwner){
        return flowOwner.getText();
      }
    }
);
  }
}
