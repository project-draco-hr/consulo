{
  final boolean[] invoked=new boolean[]{false};
  final Alarm alarm=new Alarm(Alarm.ThreadToUse.SWING_THREAD);
  alarm.addRequest(new Runnable(){
    public void run(){
      ApplicationManager.getApplication().invokeLater(new Runnable(){
        public void run(){
          alarm.addRequest(new Runnable(){
            public void run(){
              invoked[0]=true;
            }
          }
,delay);
        }
      }
);
    }
  }
,delay);
  UIUtil.dispatchAllInvocationEvents();
  while (!invoked[0]) {
    UIUtil.dispatchAllInvocationEvents();
    Thread.sleep(delay);
  }
}
