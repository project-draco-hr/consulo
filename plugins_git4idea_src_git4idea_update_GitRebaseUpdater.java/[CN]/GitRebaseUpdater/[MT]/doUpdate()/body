{
  LOG.info("doUpdate ");
  GitBranchPair gitBranchPair=myUpdateProcess.getTrackedBranches().get(myRoot);
  String remoteBranch=gitBranchPair.getTracked().getName();
  final GitLineHandler rebaseHandler=new GitLineHandler(myProject,myRoot,GitCommand.REBASE);
  rebaseHandler.addParameters(remoteBranch);
  final GitRebaseProblemDetector rebaseConflictDetector=new GitRebaseProblemDetector();
  rebaseHandler.addLineListener(rebaseConflictDetector);
  GitTask pullTask=new GitTask(myProject,rebaseHandler,"git rebase");
  pullTask.setExecuteResultInAwt(false);
  pullTask.setProgressAnalyzer(new GitStandardProgressAnalyzer());
  final AtomicReference<GitUpdateResult> updateResult=new AtomicReference<GitUpdateResult>();
  final AtomicBoolean failure=new AtomicBoolean();
  pullTask.executeInBackground(true,new GitTaskResultHandlerAdapter(){
    @Override protected void onSuccess(){
      updateResult.set(GitUpdateResult.SUCCESS);
    }
    @Override protected void onCancel(){
      cancel();
      updateResult.set(GitUpdateResult.CANCEL);
    }
    @Override protected void onFailure(){
      failure.set(true);
    }
  }
);
  if (failure.get()) {
    updateResult.set(handleRebaseFailure(rebaseConflictDetector,rebaseHandler));
  }
  return updateResult.get();
}
