{
  super.update(event);
  if (event.getPresentation().isEnabled()) {
    TaskManager manager=getTaskManager(event);
    Presentation presentation=event.getPresentation();
    if (manager == null || !manager.isVcsEnabled()) {
      presentation.setText(getTemplatePresentation().getText());
      presentation.setEnabled(false);
    }
 else {
      presentation.setEnabled(true);
      if (manager.getActiveTask().getChangeLists().size() == 0) {
        presentation.setText("Create changelist for '" + TaskUtil.getTrimmedSummary(manager.getActiveTask()) + "'");
      }
 else {
        presentation.setText("Add changelist for '" + TaskUtil.getTrimmedSummary(manager.getActiveTask()) + "'");
      }
    }
  }
}
