{
  final StringBuilder builder=new StringBuilder();
  if (owner instanceof PsiClass) {
    ClassUtil.formatClassName((PsiClass)owner,builder);
    return builder.toString();
  }
  final PsiClass psiClass=PsiTreeUtil.getParentOfType(owner,PsiClass.class,false);
  if (psiClass == null)   return null;
  ClassUtil.formatClassName(psiClass,builder);
  if (owner instanceof PsiMethod) {
    builder.append(" ");
    formatMethod((PsiMethod)owner,PsiSubstitutor.EMPTY,SHOW_NAME | SHOW_FQ_NAME | SHOW_TYPE| SHOW_PARAMETERS| SHOW_FQ_CLASS_NAMES,showParamName ? SHOW_NAME | SHOW_TYPE | SHOW_FQ_CLASS_NAMES : SHOW_TYPE | SHOW_FQ_CLASS_NAMES,maxParamsToShow,builder);
  }
 else   if (owner instanceof PsiField) {
    builder.append(" ").append(((PsiField)owner).getName());
  }
 else   if (owner instanceof PsiParameter) {
    final PsiElement declarationScope=((PsiParameter)owner).getDeclarationScope();
    if (!(declarationScope instanceof PsiMethod)) {
      return null;
    }
    final PsiMethod psiMethod=(PsiMethod)declarationScope;
    builder.append(" ");
    formatMethod(psiMethod,PsiSubstitutor.EMPTY,SHOW_NAME | SHOW_FQ_NAME | SHOW_TYPE| SHOW_PARAMETERS| SHOW_FQ_CLASS_NAMES,showParamName ? SHOW_NAME | SHOW_TYPE | SHOW_FQ_CLASS_NAMES : SHOW_TYPE | SHOW_FQ_CLASS_NAMES,maxParamsToShow,builder);
    builder.append(" ");
    if (showParamName) {
      formatVariable((PsiVariable)owner,SHOW_NAME,PsiSubstitutor.EMPTY,builder);
    }
 else {
      builder.append(psiMethod.getParameterList().getParameterIndex((PsiParameter)owner));
    }
  }
 else {
    return null;
  }
  return builder.toString();
}
