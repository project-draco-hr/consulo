{
  TreePath[] paths=getSelectedNodes(e.getDataContext());
  if (paths == null) {
    return;
  }
  ValueCollector valueCollector=new ValueCollector();
  for (  TreePath path : paths) {
    Object node=path.getLastPathComponent();
    if (node instanceof XValueNodeImpl) {
      XValueNodeImpl valueNode=(XValueNodeImpl)node;
      XFullValueEvaluator fullValueEvaluator=valueNode.getFullValueEvaluator();
      if (fullValueEvaluator == null) {
        String rawValue;
        if (valueNode.getValueContainer() instanceof XValueTextProvider) {
          rawValue=((XValueTextProvider)valueNode.getValueContainer()).getValueText();
        }
 else {
          rawValue=valueNode.getRawValue();
        }
        valueCollector.add(StringUtil.notNullize(rawValue));
      }
 else {
        new CopyValueEvaluationCallback(valueNode,valueCollector).startFetchingValue(fullValueEvaluator);
      }
    }
 else     if (node instanceof WatchMessageNode) {
      valueCollector.add(((WatchMessageNode)node).getExpression().getExpression());
    }
  }
  valueCollector.processed=true;
  valueCollector.finish(e.getProject());
}
