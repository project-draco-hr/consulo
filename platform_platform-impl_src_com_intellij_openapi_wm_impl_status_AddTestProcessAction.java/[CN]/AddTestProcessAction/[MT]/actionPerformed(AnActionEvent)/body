{
  final Project p=PlatformDataKeys.PROJECT.getData(e.getDataContext());
  if (p != null) {
    ToolWindowManager.getInstance(p).notifyByBalloon("TODO",MessageType.INFO,"Started. <a href=\"#a\">Click me!</a>",null,new HyperlinkListener(){
      public void hyperlinkUpdate(      final HyperlinkEvent e){
        System.out.println(e);
      }
    }
);
  }
  final Project project=e.getData(PlatformDataKeys.PROJECT);
  new Task.Backgroundable(project,"Test Process",true,PerformInBackgroundOption.DEAF){
    public void run(    @NotNull final ProgressIndicator indicator){
      try {
        indicator.setText("welcome!");
        Thread.currentThread().sleep(6000);
        countTo(1000,new Count(){
          public void onCount(          int each){
            indicator.setText("Found: " + each / 20 + 1);
            if (each / 10.0 == Math.round(each / 10.0)) {
              indicator.setText(null);
            }
            indicator.setFraction(each / 1000.0);
            try {
              Thread.currentThread().sleep(100);
            }
 catch (            InterruptedException e1) {
              e1.printStackTrace();
            }
            indicator.checkCanceled();
            indicator.setText2("bla bla bla");
          }
        }
);
        indicator.stop();
      }
 catch (      ProcessCanceledException e1) {
        try {
          Thread.currentThread().sleep(2000);
          indicator.stop();
        }
 catch (        InterruptedException e2) {
          e2.printStackTrace();
        }
        return;
      }
catch (      InterruptedException e1) {
        e1.printStackTrace();
      }
    }
  }
.queue();
}
