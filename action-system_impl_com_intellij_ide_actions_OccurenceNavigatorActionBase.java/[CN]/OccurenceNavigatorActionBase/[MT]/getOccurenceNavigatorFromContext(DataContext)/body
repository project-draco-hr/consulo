{
  Window window=WindowManagerEx.getInstanceEx().getMostRecentFocusedWindow();
  if (window != null) {
    Component component=window.getFocusOwner();
    for (Component c=component; c != null; c=c.getParent()) {
      if (c instanceof OccurenceNavigator) {
        return c;
      }
    }
  }
  Project project=DataKeys.PROJECT.getData(dataContext);
  if (project == null) {
    return null;
  }
  ToolWindowManagerEx mgr=ToolWindowManagerEx.getInstanceEx(project);
  String id=mgr.getLastActiveToolWindowId(new Condition<JComponent>(){
    public boolean value(    final JComponent component){
      return findNavigator(component) != null;
    }
  }
);
  if (id == null) {
    return null;
  }
  return (Component)findNavigator(mgr.getToolWindow(id).getComponent());
}
