{
  myProject=project;
  myManager=new LogFilesManager(project,this);
  myContentPanel=new JPanel(new BorderLayout());
  if (!ApplicationManager.getApplication().isUnitTestMode()) {
    getContextManager().addListener(new DebuggerContextListener(){
      public void changeEvent(      DebuggerContextImpl newContext,      int event){
switch (event) {
case DebuggerSession.EVENT_DETACHED:
          DebuggerSettings settings=DebuggerSettings.getInstance();
        myFirstToolbar.updateActionsImmediately();
      mySecondToolbar.updateActionsImmediately();
    if (settings.HIDE_DEBUGGER_ON_PROCESS_TERMINATION) {
      try {
        ExecutionManager.getInstance(getProject()).getContentManager().hideRunContent(myRunner,myRunContentDescriptor);
      }
 catch (      NullPointerException e) {
        LOG.debug(e);
      }
    }
  break;
case DebuggerSession.EVENT_PAUSE:
if (myIsJustStarted) {
  final Content frameView=findContent(FRAME_CONTENT);
  final Content watchView=findContent(WATCHES_CONTENT);
  if (frameView != null) {
    Content content=myViewsContentManager.getSelectedContent();
    if ((content == null || content.equals(frameView) || content.equals(watchView))) {
      return;
    }
    showFramePanel();
  }
  myIsJustStarted=false;
}
}
}
}
);
}
myWatchPanel=new MainWatchPanel(getProject(),getContextManager()){
protected boolean shouldRebuildNow(){
return myViewsContentManager.getSelectedContent().getComponent() == this;
}
}
;
updateWatchTreeTab();
myFramePanel=new FramePanel(getProject(),getContextManager()){
protected boolean shouldRebuildNow(){
return myViewsContentManager.getSelectedContent().getComponent() == this;
}
}
;
myThreadsPanel=new ThreadsPanel(getProject(),getContextManager()){
protected boolean shouldRebuildNow(){
return myViewsContentManager.getSelectedContent().getComponent() == this;
}
}
;
TabbedPaneContentUI ui=new TabbedPaneContentUI(JTabbedPane.TOP);
myViewsContentManager=PeerFactory.getInstance().getContentFactory().createContentManager(ui,false,getProject());
Content content;
content=PeerFactory.getInstance().getContentFactory().createContent(myThreadsPanel,DebuggerBundle.message("debugger.session.tab.threads.title"),false);
content.setIcon(THREADS_ICON);
content.putUserData(CONTENT_KIND,THREADS_CONTENT);
myViewsContentManager.addContent(content);
content=PeerFactory.getInstance().getContentFactory().createContent(myFramePanel,DebuggerBundle.message("debugger.session.tab.frames.title"),false);
content.setIcon(FRAME_ICON);
content.putUserData(CONTENT_KIND,FRAME_CONTENT);
myViewsContentManager.addContent(content);
content=PeerFactory.getInstance().getContentFactory().createContent(myWatchPanel,DebuggerBundle.message("debugger.session.tab.watches.title"),false);
content.setIcon(WATCHES_ICON);
content.putUserData(CONTENT_KIND,WATCHES_CONTENT);
myViewsContentManager.addContent(content);
myViewsContentManager.addContentManagerListener(new ContentManagerAdapter(){
public void selectionChanged(ContentManagerEvent event){
Content selectedContent=myViewsContentManager.getSelectedContent();
if (selectedContent != null) {
JComponent component=selectedContent.getComponent();
if (component instanceof DebuggerPanel) {
DebuggerPanel panel=((DebuggerPanel)component);
if (panel.isNeedsRefresh()) {
panel.rebuildWhenVisible();
}
}
}
}
}
);
myContentPanel.add(myViewsContentManager.getComponent(),BorderLayout.CENTER);
}
