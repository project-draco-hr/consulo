{
  myConsole=executionResult.getExecutionConsole();
  myRunContentDescriptor=new RunContentDescriptor(myConsole,executionResult.getProcessHandler(),myContentPanel,getSessionName());
  if (ApplicationManager.getApplication().isUnitTestMode()) {
    return myRunContentDescriptor;
  }
  Content content=findContent(DebuggerContentInfo.CONSOLE_CONTENT);
  if (content != null) {
    myViewsContentManager.removeContent(content,true);
  }
  content=createContent(myConsole.getComponent(),DebuggerBundle.message("debugger.session.tab.console.content.name"),IconLoader.getIcon("/debugger/console.png"),DebuggerContentInfo.CONSOLE_CONTENT,myConsole.getPreferredFocusableComponent());
  attachNotificationTo(content);
  final DefaultActionGroup consoleActions=new DefaultActionGroup();
  if (myConsole instanceof ConsoleView) {
    AnAction[] actions=((ConsoleView)myConsole).createUpDownStacktraceActions();
    for (    AnAction goaction : actions) {
      consoleActions.add(goaction);
    }
  }
  content.setActions(consoleActions,ActionPlaces.DEBUGGER_TOOLBAR,myConsole.getPreferredFocusableComponent());
  Content[] contents=myViewsContentManager.getContents();
  final Content[] selected=myViewsContentManager.getSelectedContents();
  myViewsContentManager.removeAllContents(false);
  myViewsContentManager.addContent(content);
  for (  Content each : contents) {
    myViewsContentManager.addContent(each);
  }
  for (  Content each : selected) {
    myViewsContentManager.addSelectedContent(each);
  }
  if (myConfiguration instanceof RunConfigurationBase && ((RunConfigurationBase)myConfiguration).needAdditionalConsole()) {
    myManager.initLogConsoles((RunConfigurationBase)myConfiguration,myRunContentDescriptor.getProcessHandler());
  }
  DefaultActionGroup group=new DefaultActionGroup();
  RestartAction restarAction=new RestartAction(myRunner,myConfiguration,myRunContentDescriptor.getProcessHandler(),DEBUG_AGAIN_ICON,myRunContentDescriptor,myRunnerSettings,myConfigurationSettings);
  group.add(restarAction);
  restarAction.registerShortcut(myContentPanel);
  addActionToGroup(group,DebuggerActions.RESUME);
  addActionToGroup(group,DebuggerActions.PAUSE);
  addActionToGroup(group,IdeActions.ACTION_STOP_PROGRAM);
  group.addSeparator();
  addActionToGroup(group,XDebuggerActions.VIEW_BREAKPOINTS);
  addActionToGroup(group,DebuggerActions.MUTE_BREAKPOINTS);
  group.addSeparator();
  addAction(group,DebuggerActions.EXPORT_THREADS);
  group.addSeparator();
  group.add(myContentUI.getLayoutActions());
  group.addSeparator();
  group.add(new CloseAction(myRunner.getInfo(),myRunContentDescriptor,getProject()));
  group.add(new ContextHelpAction(myRunner.getInfo().getHelpId()));
  myContentUI.setLeftToolbar(group,ActionPlaces.DEBUGGER_TOOLBAR);
  return myRunContentDescriptor;
}
