{
  final HashSet<File> currentFiles=new HashSet<File>();
  markDirtyFiles(module,myTsStorage,false,isCompilingTests() ? DirtyMarkScope.TESTS : DirtyMarkScope.PRODUCTION,currentFiles);
  final String moduleName=module.getName().toLowerCase(Locale.US);
  final SourceToOutputMapping sourceToOutputMap=getDataManager().getSourceToOutputMap(moduleName,isCompilingTests());
  for (final Iterator<String> it=sourceToOutputMap.getKeysIterator(); it.hasNext(); ) {
    final String path=it.next();
    final File file=new File(path);
    if (!currentFiles.contains(file)) {
      myProjectDescriptor.fsState.registerDeleted(module,file,isCompilingTests(),myTsStorage);
    }
  }
}
