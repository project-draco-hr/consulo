{
  final List<VirtualFile> dirs=ObjectsConvertor.fp2vf(scope.getRecursivelyDirtyDirectories());
  final Collection<VirtualFile> roots=new ArrayList<VirtualFile>(scope.getAffectedContentRoots());
  for (Iterator<VirtualFile> iterator=roots.iterator(); iterator.hasNext(); ) {
    final VirtualFile root=iterator.next();
    if (!dirs.contains(root))     iterator.remove();
  }
  if (roots.isEmpty())   return;
  for (  VirtualFile root : roots) {
    checkTopLevelForBeingSwitched(root,builder);
  }
}
