{
  final VirtualFile parent=f.getParent();
  final String name=f.getName();
  final Entry entry=myEntriesManager.getEntryFor(parent,name);
  if (entry != null && entry.isResultOfMerge()) {
    final byte[] content=CvsUtil.getStoredContentForFile(f,entry.getRevision());
    if (content != null) {
      return content;
    }
    return CvsUtil.getCachedStoredContent(parent,name,entry.getRevision());
  }
  final long upToDateTimestamp=getUpToDateTimeForFile(f);
  final FileRevisionTimestampComparator c=new FileRevisionTimestampComparator(){
    @Override public boolean isSuitable(    long revisionTimestamp){
      return CvsStatusProvider.timeStampsAreEqual(upToDateTimestamp,revisionTimestamp);
    }
  }
;
  final byte[] localHistoryContent=LocalHistory.getInstance().getByteContent(f,c);
  if (localHistoryContent == null) {
    if (entry != null && CvsUtil.haveCachedContent(f,entry.getRevision())) {
      return CvsUtil.getCachedStoredContent(parent,name,entry.getRevision());
    }
  }
  return localHistoryContent;
}
