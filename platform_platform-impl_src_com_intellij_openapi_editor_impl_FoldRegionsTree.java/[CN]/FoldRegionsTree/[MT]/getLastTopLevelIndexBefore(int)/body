{
  if (!isFoldingEnabledAndUpToDate())   return -1;
  int start=0;
  int end=myCachedEndOffsets.length - 1;
  while (start <= end) {
    int i=(start + end) / 2;
    if (offset < myCachedEndOffsets[i]) {
      end=i - 1;
    }
 else     if (offset > myCachedEndOffsets[i]) {
      start=i + 1;
    }
 else {
      return i;
    }
  }
  return end;
}
