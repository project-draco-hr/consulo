{
  if (LibraryEditingUtil.hasSuitableTypes(classpathPanel)) {
    final ListPopup popup=JBPopupFactory.getInstance().createListPopup(LibraryEditingUtil.createChooseTypeStep(classpathPanel,new ParameterizedRunnable<LibraryType>(){
      @Override public void run(      LibraryType libraryType){
        doCreateLibrary(classpathPanel,context,callback,contextButton,libraryType);
      }
    }
));
    popup.showUnderneathOf(contextButton);
  }
 else {
    doCreateLibrary(classpathPanel,context,callback,contextButton,null);
  }
}
