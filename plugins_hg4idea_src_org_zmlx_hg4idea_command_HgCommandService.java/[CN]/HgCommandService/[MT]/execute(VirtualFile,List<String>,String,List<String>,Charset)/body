{
  if (hgVcs == null) {
    hgVcs=(HgVcs)ProjectLevelVcsManager.getInstance(project).findVcsByName(HgVcs.VCS_NAME);
  }
  if (hgVcs == null || !hgVcs.isStarted()) {
    return HgCommandResult.EMPTY;
  }
  List<String> cmdLine=new LinkedList<String>();
  cmdLine.add(settings.getHgExecutable());
  if (config != null && !config.isEmpty()) {
    cmdLine.add("--config");
    cmdLine.addAll(config);
  }
  cmdLine.add("--repository");
  cmdLine.add(repo.getPath());
  cmdLine.add(operation);
  if (arguments != null && arguments.size() != 0) {
    cmdLine.addAll(arguments);
  }
  ShellCommand shellCommand=new ShellCommand();
  try {
    LOG.info(cmdLine.toString());
    return shellCommand.execute(cmdLine,repo.getPath(),charset);
  }
 catch (  ShellCommandException e) {
    showError(e);
    LOG.error(e.getMessage(),e);
  }
  return HgCommandResult.EMPTY;
}
