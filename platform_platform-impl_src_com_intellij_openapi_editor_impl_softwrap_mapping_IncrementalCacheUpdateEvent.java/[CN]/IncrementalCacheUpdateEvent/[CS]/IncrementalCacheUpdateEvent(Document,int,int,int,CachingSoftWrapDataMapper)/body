{
  myStartOffset=mapper.getPreviousVisualLineStartOffset(startOffset);
  myMandatoryEndOffset=newEndOffset;
  myLengthDiff=newEndOffset - oldEndOffset;
  myStartLogicalPosition=mapper.offsetToLogicalPosition(myStartOffset);
  LOG.assertTrue(myStartLogicalPosition.visualPositionAware);
  myOldEndLogicalLine=document.getLineNumber(oldEndOffset);
}
