{
  final VcsRevisionNumber revisionNumber=getRevisionNumber();
  try {
    if (revisionNumber == null) {
      return;
    }
    final DiffContent remote=createRemote(revisionNumber);
    if (remote == null) {
      return;
    }
    final SimpleDiffRequest request=new SimpleDiffRequest(myProject,mySelectedFile.getPresentableUrl());
    final Document document=FileDocumentManager.getInstance().getDocument(mySelectedFile);
    if (document == null)     return;
    final DocumentContent content2=new DocumentContent(myProject,document);
    final VcsRevisionNumber currentRevision=myDiffProvider.getCurrentRevision(mySelectedFile);
    if (revisionNumber.compareTo(currentRevision) > 0) {
      request.setContents(content2,remote);
      request.setContentTitles(VcsBundle.message("diff.title.local"),revisionNumber.asString());
    }
 else {
      request.setContents(remote,content2);
      request.setContentTitles(revisionNumber.asString(),VcsBundle.message("diff.title.local"));
    }
    request.addHint(DiffTool.HINT_SHOW_FRAME);
    DiffManager.getInstance().getDiffTool().show(request);
  }
 catch (  ProcessCanceledException e) {
  }
catch (  VcsException e) {
    AbstractVcsHelper.getInstance(myProject).showError(e,VcsBundle.message("message.title.diff"));
  }
catch (  IOException e) {
    AbstractVcsHelper.getInstance(myProject).showError(new VcsException(e),VcsBundle.message("message.title.diff"));
  }
}
