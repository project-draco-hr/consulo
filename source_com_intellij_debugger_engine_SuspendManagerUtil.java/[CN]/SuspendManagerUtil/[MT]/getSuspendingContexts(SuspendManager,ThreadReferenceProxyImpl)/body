{
  DebuggerManagerThreadImpl.assertIsManagerThread();
  Set<ThreadReferenceProxyImpl> contextThreads=new HashSet<ThreadReferenceProxyImpl>();
  Set<SuspendContextImpl> result=new HashSet<SuspendContextImpl>();
  for (Iterator<SuspendContextImpl> iterator=((SuspendManagerImpl)suspendManager).getEventContexts().iterator(); iterator.hasNext(); ) {
    SuspendContextImpl suspendContext=iterator.next();
    if (suspendContext.suspends(thread)) {
      ThreadReferenceProxyImpl contextThread=suspendContext.getThread();
      LOG.assertTrue(!contextThreads.contains(contextThread));
      contextThreads.add(contextThread);
      result.add(suspendContext);
    }
  }
  return result;
}
