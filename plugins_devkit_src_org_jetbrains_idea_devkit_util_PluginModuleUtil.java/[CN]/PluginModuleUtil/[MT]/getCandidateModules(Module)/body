{
  final ModuleRootManager manager=ModuleRootManager.getInstance(module);
  final Module[] modules=ModuleManager.getInstance(module.getProject()).getModules();
  final List<Module> candidates=new ArrayList<Module>(modules.length);
  final Set<Module> deps=new HashSet<Module>(modules.length);
  for (  Module m : modules) {
    if (ModuleUtil.getExtension(module,PluginModuleExtension.class) != null) {
      deps.clear();
      PluginBuildUtil.getDependencies(m,deps);
      if (deps.contains(module) && getPluginXml(m) != null) {
        candidates.add(m);
      }
    }
  }
  return candidates;
}
