{
  final HashSet<Module> modules=new HashSet<Module>();
  if (fileIndex.isInLibrarySource(vFile) || fileIndex.isInLibraryClasses(vFile)) {
    final OrderEntry[] orderEntries=fileIndex.getOrderEntriesForFile(vFile);
    for (int j=0; j < orderEntries.length; j++) {
      modules.add(orderEntries[j].getOwnerModule());
    }
  }
 else {
    modules.add(fileIndex.getModuleForFile(vFile));
  }
  return modules;
}
