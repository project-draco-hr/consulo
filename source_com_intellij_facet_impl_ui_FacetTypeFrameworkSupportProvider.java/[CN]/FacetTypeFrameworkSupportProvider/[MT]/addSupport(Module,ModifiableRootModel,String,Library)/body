{
  ModifiableFacetModel model=FacetManager.getInstance(module).createModifiableModel();
  Facet underlyingFacet=null;
  FacetTypeId<?> underlyingFacetType=myFacetType.getUnderlyingFacetType();
  if (underlyingFacetType != null) {
    underlyingFacet=model.getFacetByType(underlyingFacetType);
    LOG.assertTrue(underlyingFacet != null,underlyingFacetType);
  }
  F facet=FacetUtil.createFacet(myFacetType,module,underlyingFacet);
  setupConfiguration(facet,rootModel,version);
  if (library != null) {
    onLibraryAdded(facet,library);
  }
  model.addFacet(facet);
  model.commit();
}
