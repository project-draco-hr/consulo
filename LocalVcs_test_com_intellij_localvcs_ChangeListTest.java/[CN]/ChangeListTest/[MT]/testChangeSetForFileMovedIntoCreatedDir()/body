{
  ChangeSet cs1=cs(new CreateFileChange(1,"file",null,null));
  ChangeSet cs2=cs(new CreateDirectoryChange(2,"dir",null));
  ChangeSet cs3=cs(new MoveChange("file","dir"));
  applyAndAddChangeSet(cs1);
  applyAndAddChangeSet(cs2);
  applyAndAddChangeSet(cs3);
  assertEquals(2,getChangeSetsFor("dir/file").size());
  assertEquals(cs1,getChangeSetsFor("dir/file").get(0));
  assertEquals(cs3,getChangeSetsFor("dir/file").get(1));
  assertEquals(2,getChangeSetsFor("dir").size());
  assertEquals(cs2,getChangeSetsFor("dir").get(0));
  assertEquals(cs3,getChangeSetsFor("dir").get(1));
}
