{
  cl.applyChangeSetTo(r,cs(new CreateDirectoryChange(1,"d1",null),new CreateFileChange(2,"d1/file",null,null),new CreateDirectoryChange(3,"d1/d11",null),new CreateDirectoryChange(4,"d1/d12",null),new CreateDirectoryChange(5,"d2",null)));
  cl.applyChangeSetTo(r,cs(new MoveChange("d1/file","d1/d11")));
  cl.applyChangeSetTo(r,cs(new MoveChange("d1/d11/file","d1/d12")));
  assertEquals(3,getChangeSetsFor("d1").size());
  assertEquals(3,getChangeSetsFor("d1/d12/file").size());
  assertEquals(3,getChangeSetsFor("d1/d11").size());
  assertEquals(2,getChangeSetsFor("d1/d12").size());
  assertEquals(1,getChangeSetsFor("d2").size());
  cl.applyChangeSetTo(r,cs(new MoveChange("d1/d12","d2")));
  assertEquals(4,getChangeSetsFor("d1").size());
  assertEquals(3,getChangeSetsFor("d2/d12/file").size());
  assertEquals(2,getChangeSetsFor("d2").size());
  assertEquals(3,getChangeSetsFor("d2/d12").size());
}
