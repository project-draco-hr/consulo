{
  Set<DynamicVirtualProperty> result=new HashSet<DynamicVirtualProperty>();
  Document document=loadModuleDynXML(moduleName);
  final List definedContainingClasses=document.getRootElement().getContent(DynamicFiltersFactory.createContainingClassTagFilter());
  for (  Object definedContainingClass : definedContainingClasses) {
    final Element containingClass=(Element)definedContainingClass;
    final String qualifiedName=containingClass.getAttributeValue(CONTAINIG_CLASS_TYPE_ATTRIBUTE);
    final List propertyTags=containingClass.getContent(DynamicFiltersFactory.createPropertyTagFilter());
    for (    Object propertyTag : propertyTags) {
      final String propertyName=((Element)propertyTag).getAttributeValue(NAME_ATTRIBUTE);
      final String propertyType=findDynamicPropertyType(moduleName,qualifiedName,propertyName);
      result.add(new DynamicVirtualProperty(propertyName,qualifiedName,moduleName,propertyType));
    }
  }
  return result.toArray(DynamicVirtualProperty.EMPTY_ARRAY);
}
