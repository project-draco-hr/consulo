{
  validateContext(false);
  RangeMarker marker=mySelectionMarker;
  return marker != null && marker.isValid() && (marker.getEndOffset() > marker.getStartOffset() || isVirtualSelectionEnabled() && myEndVirtualOffset > myStartVirtualOffset);
}
