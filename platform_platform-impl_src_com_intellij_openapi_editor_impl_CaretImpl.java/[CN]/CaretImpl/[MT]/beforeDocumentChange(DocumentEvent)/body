{
  int startOffset=e.getOffset();
  boolean insideChangedRegion=myOffset >= startOffset && myOffset <= startOffset + e.getOldLength();
  myAfterInlayOnDocumentUpdate=insideChangedRegion && e.getNewLength() == 0 && myEditor.getInlayModel().hasInlineElementAt(startOffset) || !insideChangedRegion && myLogicalCaret.leansForward && myEditor.getInlayModel().hasInlineElementAt(myOffset);
  saveSelectionBeforeDocumentChange();
}
