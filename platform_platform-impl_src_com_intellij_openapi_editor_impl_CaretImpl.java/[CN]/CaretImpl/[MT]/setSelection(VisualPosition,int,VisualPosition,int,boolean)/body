{
  VisualPosition startPositionToUse=startPosition == null ? myEditor.offsetToVisualPosition(startOffset,true,false) : startPosition;
  VisualPosition endPositionToUse=endPosition == null ? myEditor.offsetToVisualPosition(endOffset,false,true) : endPosition;
  doSetSelection(startPositionToUse,startOffset,endPositionToUse,endOffset,true,updateSystemSelection);
}
