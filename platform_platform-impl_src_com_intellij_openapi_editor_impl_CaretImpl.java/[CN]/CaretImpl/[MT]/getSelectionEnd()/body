{
  validateContext(false);
  if (hasSelection()) {
    RangeMarker marker=mySelectionMarker;
    if (marker != null) {
      return marker.getEndOffset();
    }
  }
  return getOffset();
}
