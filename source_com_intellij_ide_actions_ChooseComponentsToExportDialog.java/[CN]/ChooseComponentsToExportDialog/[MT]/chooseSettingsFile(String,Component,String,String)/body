{
  FileChooserDescriptor chooserDescriptor;
  chooserDescriptor=new FileChooserDescriptor(true,true,true,true,false,false);
  chooserDescriptor.setDescription(description);
  chooserDescriptor.setHideIgnored(false);
  chooserDescriptor.setTitle(title);
  VirtualFile initialDir;
  if (oldPath != null) {
    final File oldFile=new File(oldPath);
    initialDir=LocalFileSystem.getInstance().findFileByIoFile(oldFile);
    if (initialDir == null && oldFile.getParentFile() != null) {
      initialDir=LocalFileSystem.getInstance().findFileByIoFile(oldFile.getParentFile());
    }
  }
 else {
    initialDir=null;
  }
  final VirtualFile[] files=FileChooser.chooseFiles(parent,chooserDescriptor,initialDir);
  if (files.length == 0) {
    return null;
  }
  VirtualFile file=files[0];
  String path;
  if (file.isDirectory()) {
    String defaultName=new File(DEFAULT_PATH).getName();
    path=file.getPath() + "/" + defaultName;
  }
 else {
    path=file.getPath();
  }
  return path;
}
