{
  Graphics2D g=(Graphics2D)graphics;
  final JTextComponent c=getComponent();
  final Container parent=c.getParent();
  final Rectangle r=getDrawingRect();
  if (c.isOpaque() && parent != null) {
    g.setColor(parent.getBackground());
    g.fillRect(0,0,c.getWidth(),c.getHeight());
  }
  final GraphicsConfig config=new GraphicsConfig(g);
  g.setRenderingHint(RenderingHints.KEY_ANTIALIASING,RenderingHints.VALUE_ANTIALIAS_ON);
  g.setRenderingHint(RenderingHints.KEY_STROKE_CONTROL,RenderingHints.VALUE_STROKE_NORMALIZE);
  final Border border=c.getBorder();
  if (isSearchField(c)) {
    g.setColor(c.getBackground());
    g.fillRect(r.x,r.y,r.width,r.height - JBUI.scale(1));
    g.setColor(c.isEnabled() ? Gray._100 : new Color(0x535353));
    if (c.hasFocus() && c.getClientProperty("JTextField.Search.noFocusRing") != Boolean.TRUE) {
      g.setColor(ModernUIUtil.getSelectionBackground());
    }
    g.drawRect(r.x,r.y,r.width,r.height - JBUI.scale(1));
    Point p=getSearchIconCoord();
    Icon searchIcon=getComponent().getClientProperty("JTextField.Search.FindPopup") instanceof JPopupMenu ? SEARCH_WITH_HISTORY_ICON : SEARCH_ICON;
    searchIcon.paintIcon(null,g,p.x,p.y);
    if (getComponent().hasFocus() && getComponent().getText().length() > 0) {
      p=getClearIconCoord();
      CLEAR_ICON.paintIcon(null,g,p.x,p.y);
    }
  }
 else   if (border instanceof ModernTextBorder) {
    if (c.isEnabled() && c.isEditable()) {
      g.setColor(c.getBackground());
    }
    final int width=c.getWidth();
    final int height=c.getHeight();
    final Insets i=border.getBorderInsets(c);
    if (myMouseEnterHandler.isMouseEntered()) {
      g.fillRoundRect(i.left - JBUI.scale(5),i.top - 2,width - i.right - i.left + 10,height - i.top - i.bottom + 6,5,5);
    }
 else {
      g.fillRect(i.left - JBUI.scale(5),i.top - 2,width - i.right - i.left + 12,height - i.top - i.bottom + 6);
    }
  }
 else {
    super.paintBackground(g);
  }
  config.restore();
}
