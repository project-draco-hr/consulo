{
  DomCollectionChildDescription[] descriptions=getDomCollectionChildDescriptions(e);
  final List<AnAction> actions=new ArrayList<AnAction>();
  for (  DomCollectionChildDescription description : descriptions) {
    final ClassChooser chooser=ClassChooserManager.getClassChooser(DomReflectionUtil.getRawType(description.getType()));
    for (    Class clazz : chooser.getChooserClasses()) {
      String name=ElementPresentationManager.getTypeName(clazz);
      Icon icon=null;
      if (!showAsPopup() || descriptions.length == 1) {
        if (descriptions.length > 1) {
          icon=ElementPresentationManager.getIconForClass(clazz);
        }
      }
      AnAction action=createAddingAction(e,ApplicationBundle.message("action.add") + " " + name,icon,clazz,description);
      actions.add(action);
    }
  }
  if (actions.size() > 1 && showAsPopup()) {
    ActionGroup group=new ActionGroup(){
      public AnAction[] getChildren(      @Nullable AnActionEvent e){
        return actions.toArray(AnAction.EMPTY_ARRAY);
      }
    }
;
    return new AnAction[]{new ShowPopupAction(group)};
  }
 else {
    if (actions.size() > 1) {
      actions.add(Separator.getInstance());
    }
 else     if (actions.size() == 1) {
    }
  }
  return actions.toArray(AnAction.EMPTY_ARRAY);
}
