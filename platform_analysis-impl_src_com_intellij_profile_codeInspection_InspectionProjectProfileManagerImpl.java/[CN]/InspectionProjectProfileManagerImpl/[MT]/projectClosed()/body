{
  final Application app=ApplicationManager.getApplication();
  Runnable cleanupInspectionProfilesRunnable=new Runnable(){
    @Override public void run(){
      for (      InspectionProfileWrapper wrapper : myName2Profile.values()) {
        wrapper.cleanup(myProject);
      }
      fireProfilesShutdown();
    }
  }
;
  if (app.isUnitTestMode() || app.isHeadlessEnvironment()) {
    cleanupInspectionProfilesRunnable.run();
  }
 else {
    app.executeOnPooledThread(cleanupInspectionProfilesRunnable);
  }
}
