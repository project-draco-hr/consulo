{
  DiffTool[] standardTools;
  if (!ENABLE_FILES.value(myProperties) || !ENABLE_FOLDERS.value(myProperties) || !ENABLE_MERGE.value(myProperties)) {
    DiffTool[] embeddableTools={INTERNAL_DIFF,new MergeTool(),BinaryDiffTool.INSTANCE};
    standardTools=new DiffTool[]{ExtCompareFolders.INSTANCE,ExtCompareFiles.INSTANCE,ExtMergeFiles.INSTANCE,new MultiLevelDiffTool(Arrays.asList(embeddableTools)),INTERNAL_DIFF,new MergeTool(),BinaryDiffTool.INSTANCE};
  }
 else {
    standardTools=new DiffTool[]{ExtCompareFolders.INSTANCE,ExtCompareFiles.INSTANCE,ExtMergeFiles.INSTANCE,INTERNAL_DIFF,new MergeTool(),BinaryDiffTool.INSTANCE};
  }
  if (myAdditionTools.isEmpty()) {
    return new CompositeDiffTool(standardTools);
  }
 else {
    List<DiffTool> allTools=new ArrayList<DiffTool>(myAdditionTools);
    ContainerUtil.addAll(allTools,standardTools);
    return new CompositeDiffTool(allTools);
  }
}
