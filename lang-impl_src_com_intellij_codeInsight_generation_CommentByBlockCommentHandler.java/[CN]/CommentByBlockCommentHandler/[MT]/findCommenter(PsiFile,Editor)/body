{
  final FileType fileType=file.getFileType();
  if (fileType instanceof AbstractFileType) {
    return ((AbstractFileType)fileType).getCommenter();
  }
  Language lang=PsiUtilBase.getLanguageInEditor(editor,file.getProject());
  if (lang == null || LanguageCommenters.INSTANCE.forLanguage(lang) == null) {
    lang=file.getLanguage();
  }
  final FileViewProvider viewProvider=file.getViewProvider();
  if (viewProvider instanceof TemplateLanguageFileViewProvider && lang == ((TemplateLanguageFileViewProvider)viewProvider).getTemplateDataLanguage()) {
    lang=viewProvider.getBaseLanguage();
  }
  return LanguageCommenters.INSTANCE.forLanguage(lang);
}
