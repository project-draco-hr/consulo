{
  if (commented == null && (offset == selection.getStartOffset() || offset + (skipBrace ? skipLength : 0) == selection.getEndOffset())) {
    return 0;
  }
  if (commented == null) {
    myDocument.insertString(offset + (skipBrace ? skipLength : 0),toInsert);
    return toInsert.length();
  }
 else {
    myDocument.replaceString(offset,offset + skipLength,commented);
    return commented.length() - skipLength;
  }
}
