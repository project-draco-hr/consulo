{
  if (file == null)   return false;
  final Project project=file.getProject();
  final Document document=PsiDocumentManager.getInstance(project).getDocument(file);
  if (!ReadonlyStatusHandler.getInstance(project).isWriteAccessAllowed(file.getVirtualFile())) {
    final Editor editor=FileEditorManager.getInstance(project).openTextEditor(new OpenFileDescriptor(project,file.getVirtualFile()),true);
    if (!FileDocumentManager.getInstance().requestWriting(document,project)) {
      ApplicationManager.getApplication().invokeLater(new Runnable(){
        public void run(){
          if (editor != null && editor.getComponent().isDisplayable()) {
            HintManager.getInstance().showErrorHint(editor,CodeInsightBundle.message("error.hint.file.is.readonly",file.getVirtualFile().getPresentableUrl()));
          }
        }
      }
);
      return false;
    }
  }
  return true;
}
