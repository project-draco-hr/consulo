{
  final GlobalSearchScope scope=GlobalSearchScope.allScope(project);
  final ArrayList<IProperty> properties=new ArrayList<IProperty>(PropertyKeyIndex.getInstance().get(key,project,scope));
  final Set<VirtualFile> files=new HashSet<VirtualFile>();
  FileBasedIndex.getInstance().processValues(XmlPropertiesIndex.NAME,new XmlPropertiesIndex.Key(key),null,new FileBasedIndex.ValueProcessor<String>(){
    @Override public boolean process(    VirtualFile file,    String value){
      if (files.add(file)) {
        PsiFile psiFile=PsiManager.getInstance(project).findFile(file);
        if (psiFile instanceof XmlFile) {
          properties.addAll(new XmlPropertiesFile((XmlFile)psiFile).findPropertiesByKey(key));
        }
      }
      return false;
    }
  }
,scope);
  return properties;
}
