{
  if (context != null) {
    final RunnerAndConfigurationSettings template=((RunManagerImpl)context.getRunManager()).getConfigurationTemplate(getConfigurationFactory());
    final Module contextModule=context.getModule();
    final Module predefinedModule=((ModuleBasedConfiguration)template.getConfiguration()).getConfigurationModule().getModule();
    if (predefinedModule != null) {
      configuration.setModule(predefinedModule);
      return true;
    }
 else     if (configuration.getConfigurationModule().getModule() == null && contextModule != null) {
      configuration.setModule(contextModule);
      return true;
    }
  }
  return false;
}
