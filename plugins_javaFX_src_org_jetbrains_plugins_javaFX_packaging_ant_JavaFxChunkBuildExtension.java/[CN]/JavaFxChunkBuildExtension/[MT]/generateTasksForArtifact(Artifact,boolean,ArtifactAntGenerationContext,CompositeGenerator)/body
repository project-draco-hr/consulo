{
  if (preprocessing)   return;
  final CompositePackagingElement<?> rootElement=artifact.getRootElement();
  final String artifactName=FileUtil.getNameWithoutExtension(rootElement.getName());
  final String tempDirPath=BuildProperties.propertyRef(context.getArtifactOutputProperty(artifact));
  final List<PackagingElement<?>> children=rootElement.getChildren();
  final PackagingElementResolvingContext resolvingContext=ArtifactManager.getInstance(context.getProject()).getResolvingContext();
  for (  Generator childGenerator : computeChildrenGenerators(resolvingContext,new DirectoryAntCopyInstructionCreator(tempDirPath),context,artifact.getArtifactType(),children)) {
    generator.add(childGenerator);
  }
  final String artifactFileName=rootElement.getName();
  final JavaFxArtifactProperties properties=(JavaFxArtifactProperties)artifact.getProperties(JavaFxArtifactPropertiesProvider.getInstance());
  final String appId=artifactName + "_id";
  final Tag applicationTag=new Tag("fx:application",new Pair<String,String>("id",appId),new Pair<String,String>("name",artifactName),new Pair<String,String>("mainClass",properties.getAppClass()));
  generator.add(applicationTag);
  final Tag createJarTag=new Tag("fx:jar",new Pair<String,String>("destfile",tempDirPath + "/" + artifactFileName));
  createJarTag.add(new Tag("fx:application",new Pair<String,String>("refid",appId)));
  createJarTag.add(new Tag("fileset",new Pair<String,String>("dir",tempDirPath)));
  generator.add(createJarTag);
  final Tag deployTag=new Tag("fx:deploy",new Pair<String,String>("width",properties.getWidth()),new Pair<String,String>("height",properties.getHeight()),new Pair<String,String>("updatemode",properties.getUpdateMode()),new Pair<String,String>("outdir",tempDirPath + "/deploy"),new Pair<String,String>("outfile",artifactName));
  deployTag.add(new Tag("fx:application",new Pair<String,String>("refid",appId)));
  deployTag.add(new Tag("fx:info",new Pair<String,String>("title",properties.getTitle()),new Pair<String,String>("vendor",properties.getVendor()),new Pair<String,String>("description",properties.getDescription())));
  final Tag deployResourcesTag=new Tag("fx:resources");
  deployResourcesTag.add(new Tag("fx:fileset",new Pair<String,String>("dir",tempDirPath),new Pair<String,String>("includes",artifactFileName)));
  deployTag.add(deployResourcesTag);
  generator.add(deployTag);
  final DirectoryAntCopyInstructionCreator creator=new DirectoryAntCopyInstructionCreator(BuildProperties.propertyRef(context.getConfiguredArtifactOutputProperty(artifact)));
  generator.add(creator.createDirectoryContentCopyInstruction(tempDirPath + "/deploy"));
  final Tag deleteTag=new Tag("delete",new Pair<String,String>("includeemptydirs","true"));
  deleteTag.add(new Tag("fileset",new Pair<String,String>("dir",tempDirPath)));
  generator.add(deleteTag);
}
