{
  final JPopupMenu result=new JBPopupMenu();
  if (under && myOptions.length > 0) {
    final JMenuItem mainAction=new JBMenuItem(getAction());
    configureItem(getMenuInfo(getAction()),mainAction);
    result.add(mainAction);
    result.addSeparator();
  }
  for (  Action each : myOptions) {
    if (getAction() == each)     continue;
    final OptionInfo info=getMenuInfo(each);
    final JMenuItem eachItem=new JBMenuItem(each);
    configureItem(info,eachItem);
    result.add(eachItem);
  }
  if (!under && myOptions.length > 0) {
    result.addSeparator();
    final JMenuItem mainAction=new JBMenuItem(getAction());
    configureItem(getMenuInfo(getAction()),mainAction);
    result.add(mainAction);
  }
  return result;
}
