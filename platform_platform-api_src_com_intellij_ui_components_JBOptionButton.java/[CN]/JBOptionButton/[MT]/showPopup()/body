{
  if (myPopup != null)   return;
  myPopup=new JPopupMenu();
  final JMenuItem first=fillMenu();
  final Ref<PopupMenuListener> listener=new Ref<PopupMenuListener>();
  listener.set(new PopupMenuListener(){
    @Override public void popupMenuWillBecomeVisible(    PopupMenuEvent e){
    }
    @Override public void popupMenuWillBecomeInvisible(    PopupMenuEvent e){
      if (myPopup != null && listener.get() != null) {
        myPopup.removePopupMenuListener(listener.get());
      }
      SwingUtilities.invokeLater(new Runnable(){
        @Override public void run(){
          myPopup=null;
        }
      }
);
    }
    @Override public void popupMenuCanceled(    PopupMenuEvent e){
    }
  }
);
  myPopup.addPopupMenuListener(listener.get());
  myPopup.show(this,myMoreRec.x,getY() + getHeight() - getInsets().bottom);
  SwingUtilities.invokeLater(new Runnable(){
    @Override public void run(){
      if (first != null) {
        myPopup.setSelected(first);
      }
    }
  }
);
}
