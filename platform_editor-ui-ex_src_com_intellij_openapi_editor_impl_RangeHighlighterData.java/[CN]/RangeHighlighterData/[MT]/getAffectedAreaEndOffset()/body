{
  int endOffset=getRangeHighlighter().getEndOffset();
  if (getTargetArea() == HighlighterTargetArea.EXACT_RANGE)   return endOffset;
  Document document=myModel.getDocument();
  int textLength=document.getTextLength();
  if (endOffset >= textLength)   return endOffset;
  return Math.min(textLength,document.getLineEndOffset(document.getLineNumber(endOffset)) + 1);
}
