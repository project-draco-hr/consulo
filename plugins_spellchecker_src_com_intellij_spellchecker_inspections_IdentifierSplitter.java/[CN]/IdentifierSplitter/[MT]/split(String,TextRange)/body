{
  if (text == null || range.getLength() < 1 || range.getStartOffset() < 0) {
    return null;
  }
  List<TextRange> extracted=excludeByPattern(text,range,WORD_IN_QUOTES,1);
  if (extracted == null) {
    return null;
  }
  List<CheckArea> results=new ArrayList<CheckArea>();
  for (  TextRange textRange : extracted) {
    List<TextRange> words=splitByCase(text,textRange);
    if (words == null || words.size() == 0) {
      continue;
    }
    if (words.size() == 1) {
      addWord(text,results,false,words.get(0));
      continue;
    }
    boolean isCapitalized=Strings.isCapitalized(text,words.get(0));
    boolean containsShortWord=containsShortWord(words);
    if (isCapitalized && containsShortWord) {
      continue;
    }
    boolean isAllWordsAreUpperCased=isAllWordsAreUpperCased(text,words);
    for (    TextRange word : words) {
      boolean uc=Strings.isUpperCased(text,word);
      boolean flag=(uc && !isAllWordsAreUpperCased);
      Matcher matcher=WORD.matcher(text.substring(word.getStartOffset(),word.getEndOffset()));
      if (matcher.find()) {
        TextRange found=matcherRange(word,matcher);
        addWord(text,results,flag,found);
      }
    }
  }
  return results;
}
