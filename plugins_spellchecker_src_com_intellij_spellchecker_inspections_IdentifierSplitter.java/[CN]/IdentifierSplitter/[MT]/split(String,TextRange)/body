{
  if (text == null || range.getLength() < 1) {
    return null;
  }
  List<TextRange> words=splitByCase(text,range);
  if (words == null || words.size() == 0) {
    return null;
  }
  List<CheckArea> results=new ArrayList<CheckArea>();
  if (words.size() == 1) {
    addWord(text,results,false,words.get(0));
    return results;
  }
  boolean isCapitalized=Strings.isCapitalized(text,words.get(0));
  boolean containsShortWord=containsShortWord(words);
  if (isCapitalized && containsShortWord) {
    return results;
  }
  boolean isAllWordsAreUpperCased=isAllWordsAreUpperCased(text,words);
  for (  TextRange word : words) {
    boolean uc=Strings.isUpperCased(text,word);
    boolean flag=(uc && !isAllWordsAreUpperCased);
    Matcher matcher=WORD.matcher(text.substring(word.getStartOffset(),word.getEndOffset()));
    if (matcher.find()) {
      TextRange found=matcherRange(word,matcher);
      addWord(text,results,flag,found);
    }
  }
  return results;
}
