{
  treeElement.acceptTree(new RecursiveTreeElementWalkingVisitor(false){
    @Override protected void visitNode(    TreeElement element){
      List<Pair<Object,Processor<PsiElement>>> callbacks=element.getUserData(TRACK_INVALIDATION_KEY);
      if (callbacks != null) {
        for (        Pair<Object,Processor<PsiElement>> pair : callbacks) {
          Processor<PsiElement> callback=pair.second;
          PsiElement psi=element.getPsi();
          if (psi != null)           callback.process(psi);
        }
      }
      super.visitNode(element);
    }
  }
);
}
