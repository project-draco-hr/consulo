{
  prepareLocalChangesAndBranchWithSameModifiedFilesWithoutConflicts(myUltimate);
  branch(myCommunity,"feature");
  branch(myContrib,"feature");
  myDialogManager.registerDialogHandler(GitSmartOperationDialog.class,new TestDialogHandler<GitSmartOperationDialog>(){
    @Override public int handleDialog(    GitSmartOperationDialog dialog){
      return DialogWrapper.CANCEL_EXIT_CODE;
    }
  }
);
  doCheckoutOrMerge(checkout,"feature");
  String operation=checkout ? "checkout" : "merge";
  assertNotify(NotificationType.ERROR,"Couldn't " + operation + " feature",stripHtmlAndBreaks("Local changes would be overwritten by " + operation + "."+ "You should stash or commit them."));
  assertBranch("master");
}
