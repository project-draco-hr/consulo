{
  final PsiFile file=place.getContainingFile().getOriginalFile();
  final BaseInjection injection=file.getUserData(BaseInjection.INJECTION_KEY);
  final CachedValueProvider<List<PsiElement>> provider;
  if (injection == null) {
    provider=createDevProvider(file);
  }
 else {
    provider=createPatternProvider(injection,file);
  }
  if (provider == null)   return;
  final List<PsiElement> roots=((UserDataHolderEx)file).putUserDataIfAbsent(INJECTION_PARSED_CONTEXT,CachedValuesManager.getManager(file.getProject()).createCachedValue(provider,false)).getValue();
  for (  PsiElement root : roots) {
    for (PsiElement cur=root.getFirstChild(); cur != null; cur=cur.getNextSibling()) {
      if (cur instanceof PsiNamedElement && !ResolveUtil.processElement(processor,(PsiNamedElement)cur))       return;
    }
  }
}
