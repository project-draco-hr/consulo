{
  final PsiFile file=place.getContainingFile().getOriginalFile();
  CachedValue<List<PsiElement>> value=file.getUserData(INJECTION_PARSED_CONTEXT);
  if (value == null) {
    final BaseInjection injection=file.getUserData(BaseInjection.INJECTION_KEY);
    final CachedValueProvider<List<PsiElement>> provider;
    if (injection == null) {
      provider=createDevProvider(file);
    }
 else {
      provider=createPatternProvider(injection,file);
    }
    if (provider == null)     return;
    file.putUserData(INJECTION_PARSED_CONTEXT,value=CachedValuesManager.getManager(file.getProject()).createCachedValue(provider,false));
  }
  final List<PsiElement> roots=value.getValue();
  for (  PsiElement root : roots) {
    if (!root.processDeclarations(processor,state,null,place))     return;
  }
}
