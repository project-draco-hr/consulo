{
  final File[] ch1=d1.listFiles();
  final VirtualFile[] ch2=d2.getChildren();
  Arrays.sort(ch1,new Comparator<File>(){
    public int compare(    File o1,    File o2){
      return o1.getName().compareTo(o2.getName());
    }
  }
);
  Arrays.sort(ch2,new Comparator<VirtualFile>(){
    public int compare(    VirtualFile o1,    VirtualFile o2){
      return o1.getName().compareTo(o2.getName());
    }
  }
);
  assertEquals(ch1.length,ch2.length);
  for (int i=1; i < ch1.length; i++) {
    assertEquals(ch1[i].isDirectory(),ch2[i].isDirectory());
    if (ch1[i].isDirectory() && !".svn".equals(ch1[i].getName())) {
      assertDirsEquals(ch1[i],ch2[i]);
    }
 else {
      assertEquals(ch1[i].getName(),ch2[i].getName());
      try {
        assertFilesEqual(ch1[i],ch2[i]);
      }
 catch (      IOException e) {
        assertTrue(false);
      }
    }
  }
}
