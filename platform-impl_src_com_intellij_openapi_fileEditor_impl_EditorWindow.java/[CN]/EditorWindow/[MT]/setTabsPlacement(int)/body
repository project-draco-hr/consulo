{
  try {
    ++myInsideTabChange;
    if (tabPlacement != UISettings.TABS_NONE) {
      if (myTabbedPane == null) {
        final EditorWithProviderComposite editor=getSelectedEditor();
        myPanel.removeAll();
        createTabs(tabPlacement);
        setEditor(editor,true);
      }
 else {
        myTabbedPane.setTabPlacement(tabPlacement);
      }
    }
 else     if (myTabbedPane != null) {
      final boolean focusEditor=ToolWindowManager.getInstance(getManager().myProject).isEditorComponentActive();
      final VirtualFile currentFile=getSelectedFile();
      final VirtualFile[] files=getFiles();
      for (      VirtualFile file : files) {
        closeFile(file,false);
      }
      disposeTabs();
      if (currentFile != null) {
        getManager().openFileImpl2(this,currentFile,focusEditor && myOwner.getCurrentWindow() == this,null);
      }
 else {
        myPanel.repaint();
      }
    }
  }
  finally {
    --myInsideTabChange;
  }
}
