{
  if (editor != null) {
    if (myTabbedPane == null) {
      myPanel.removeAll();
      myPanel.add(new TCompForTablessMode(this,editor),BorderLayout.CENTER);
      myPanel.revalidate();
      return;
    }
    final int index=findEditorIndex(editor);
    try {
      ++myInsideTabChange;
      if (index != -1) {
        setSelectedEditor(editor,focusEditor);
      }
 else {
        final int indexToInsert=myTabbedPane.getSelectedIndex() + 1;
        final VirtualFile file=editor.getFile();
        final Icon template=IconLoader.getIcon("/fileTypes/text.png");
        myTabbedPane.insertTab(file,new EmptyIcon(template.getIconWidth(),template.getIconHeight()),new TComp(editor),null,indexToInsert);
        trimToSize(UISettings.getInstance().EDITOR_TAB_LIMIT,file);
        setSelectedEditor(editor,focusEditor);
        myOwner.updateFileIcon(file);
        myOwner.updateFileColor(file);
      }
      myOwner.setCurrentWindow(this,false);
    }
  finally {
      --myInsideTabChange;
    }
  }
  myPanel.revalidate();
}
