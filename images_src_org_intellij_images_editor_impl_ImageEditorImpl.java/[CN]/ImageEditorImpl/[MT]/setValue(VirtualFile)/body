{
  ImageDocument document=editorUI.getImageComponent().getDocument();
  try {
    BufferedImage previousImage=document.getValue();
    BufferedImage image=IfsUtil.getImage(file);
    document.setValue(image);
    document.setFormat(IfsUtil.getFormat(file));
    ImageZoomModel zoomModel=getZoomModel();
    if (image != null && (previousImage == null || !zoomModel.isZoomLevelChanged())) {
      Options options=OptionsManager.getInstance().getOptions();
      ZoomOptions zoomOptions=options.getEditorOptions().getZoomOptions();
      zoomModel.setZoomFactor(1.0d);
      if (zoomOptions.isSmartZooming()) {
        Dimension prefferedSize=zoomOptions.getPrefferedSize();
        if (prefferedSize.width > image.getWidth() && prefferedSize.height > image.getHeight()) {
          double factor=(prefferedSize.getWidth() / (double)image.getWidth() + prefferedSize.getHeight() / (double)image.getHeight()) / 2.0d;
          zoomModel.setZoomFactor(Math.ceil(factor));
        }
      }
    }
  }
 catch (  Exception e) {
    document.setValue(null);
  }
}
