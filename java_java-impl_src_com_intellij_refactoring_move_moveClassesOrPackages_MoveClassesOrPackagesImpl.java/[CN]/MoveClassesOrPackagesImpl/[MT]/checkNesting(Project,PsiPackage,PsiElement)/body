{
  final PsiPackage targetPackage=targetElement instanceof PsiPackage ? (PsiPackage)targetElement : targetElement instanceof PsiDirectory ? JavaDirectoryService.getInstance().getPackage((PsiDirectory)targetElement) : null;
  for (PsiPackage curPackage=targetPackage; curPackage != null; curPackage=curPackage.getParentPackage()) {
    if (curPackage.equals(srcPackage)) {
      CommonRefactoringUtil.showErrorMessage(RefactoringBundle.message("move.title"),RefactoringBundle.message("cannot.move.package.into.itself"),HelpID.getMoveHelpID(srcPackage),project);
      return false;
    }
  }
  return true;
}
