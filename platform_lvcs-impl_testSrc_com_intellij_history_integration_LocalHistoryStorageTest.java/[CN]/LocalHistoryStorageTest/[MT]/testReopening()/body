{
  int r1=createRecord();
  int r2=createRecord();
  int r3=createRecord();
  myStorage.deleteRecord(r2);
  myStorage.dispose();
  myStorage=new LocalHistoryStorage(myRoot.getPath() + "/storage");
  assertFirstAndLast(r1,r3);
  assertRecord(r3,r1,0);
  assertRecord(r1,0,r3);
  myStorage.deleteRecord(r1);
  myStorage.dispose();
  myStorage=new LocalHistoryStorage(myRoot.getPath() + "/storage");
  assertFirstAndLast(r3,r3);
  assertRecord(r3,0,0);
  int r4=createRecord();
  myStorage.dispose();
  myStorage=new LocalHistoryStorage(myRoot.getPath() + "/storage");
  assertFirstAndLast(r3,r4);
  assertRecord(r4,r3,0);
  assertRecord(r3,0,r4);
}
