{
  final PsiElement refElement=p.getElementToSearch();
  if (refElement instanceof PsiAnnotationMethod) {
    PsiMethod method=(PsiMethod)refElement;
    if (PsiAnnotation.DEFAULT_REFERENCED_METHOD_NAME.equals(method.getName()) && method.getParameterList().getParametersCount() == 0) {
      final Query<PsiReference> query=ReferencesSearch.search(method.getContainingClass(),p.getScope(),p.isIgnoreAccessScope());
      return query.forEach(new ReadActionProcessor<PsiReference>(){
        public boolean processInReadAction(        final PsiReference reference){
          if (reference instanceof PsiJavaCodeReferenceElement) {
            PsiJavaCodeReferenceElement javaReference=(PsiJavaCodeReferenceElement)reference;
            if (javaReference.getParent() instanceof PsiAnnotation) {
              PsiNameValuePair[] members=((PsiAnnotation)javaReference.getParent()).getParameterList().getAttributes();
              if (members.length == 1 && members[0].getNameIdentifier() == null) {
                if (!consumer.process(members[0].getReference()))                 return false;
              }
            }
          }
          return true;
        }
      }
);
    }
  }
  return true;
}
