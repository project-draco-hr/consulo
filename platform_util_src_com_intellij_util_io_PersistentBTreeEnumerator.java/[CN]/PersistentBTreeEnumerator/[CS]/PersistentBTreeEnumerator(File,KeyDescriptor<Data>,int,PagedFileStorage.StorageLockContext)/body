{
  super(file,new ResizeableMappedFile(file,initialSize,lockContext,VALUE_PAGE_SIZE,true,IOUtil.ourByteBuffersUseNativeByteOrder),dataDescriptor,initialSize,ourVersion,new RecordBufferHandler(),false);
  myInlineKeysNoMapping=myDataDescriptor instanceof InlineKeyDescriptor && !wantKeyMapping();
  myExternalKeysNoMapping=!(myDataDescriptor instanceof InlineKeyDescriptor) && !wantKeyMapping();
  if (myBTree == null) {
    try {
      lockStorage();
      storeVars(false);
      initBtree(false);
      storeBTreeVars(false);
    }
 catch (    IOException e) {
      try {
        close();
      }
 catch (      Throwable ignored) {
      }
      throw e;
    }
catch (    Throwable e) {
      LOG.info(e);
      try {
        close();
      }
 catch (      Throwable ignored) {
      }
      throw new CorruptedException(file);
    }
 finally {
      unlockStorage();
    }
  }
}
