{
  super(file,new ResizeableMappedFile(file,initialSize,lockContext != null ? lockContext : ourLock.myDefaultStorageLockContext,VALUE_PAGE_SIZE,true),dataDescriptor,initialSize,ourVersion,new RecordBufferHandler(),false);
  myInlineKeysNoMapping=myDataDescriptor instanceof InlineKeyDescriptor && !wantKeyMapping();
  myExternalKeysNoMapping=!(myDataDescriptor instanceof InlineKeyDescriptor) && !wantKeyMapping();
  if (btree == null) {
    try {
      lockStorage();
      storeVars(false);
      initBtree(false);
      storeBTreeVars(false);
    }
  finally {
      unlockStorage();
    }
  }
}
