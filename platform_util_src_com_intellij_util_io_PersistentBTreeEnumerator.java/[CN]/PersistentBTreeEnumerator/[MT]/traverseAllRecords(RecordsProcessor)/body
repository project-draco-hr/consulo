{
synchronized (ourLock) {
    if (myInlineKeysNoMapping) {
      List<IntToIntBtree.BtreeIndexNodeView> leafPages=new ArrayList<IntToIntBtree.BtreeIndexNodeView>();
      collectLeafPages(btree.root,leafPages);
      out:       for (      IntToIntBtree.BtreeIndexNodeView value : leafPages) {
        for (int i=0; i < value.getChildrenCount(); ++i) {
          if (!p.process(value.keyAt(i)))           break out;
        }
      }
      return true;
    }
    int current=myFirstPageStart;
    int currentPage=current;
    int end=myDataPageStart + myDataPageOffset;
    byte[] recordBuffer=getRecordBuffer();
    int last=PAGE_SIZE - 4;
    while (current != end) {
      if (current - currentPage >= last) {
        currentPage=current=myStorage.getInt(currentPage + last);
      }
      if (!p.process(current))       break;
      current+=recordBuffer.length;
    }
    return true;
  }
}
