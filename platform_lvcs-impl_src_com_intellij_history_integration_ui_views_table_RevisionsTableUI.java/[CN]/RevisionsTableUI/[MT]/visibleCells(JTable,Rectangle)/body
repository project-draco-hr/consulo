{
  int maxRowIndex=table.getRowCount() - 2;
  int firstRow=correctRange(visibleArea.y / table.getRowHeight() - 1,0,maxRowIndex);
  Point corner=new Point(visibleArea.x + visibleArea.width,visibleArea.y + visibleArea.height);
  int lastRow=correctRange(corner.y / table.getRowHeight(),0,maxRowIndex);
  int firstColumn=table.columnAtPoint(visibleArea.getLocation());
  int lastColumn=table.columnAtPoint(corner);
  if (lastColumn == -1)   lastColumn=table.getColumnCount() - 1;
  return new VisibleCells(table,firstRow,firstColumn,lastRow,lastColumn);
}
