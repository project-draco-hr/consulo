{
  Collection<VirtualFile> dirtyRoots=ContainerUtil.newHashSet();
  final StorageScheme storageScheme=((ProjectEx)myProject).getStateStore().getStorageScheme();
  if (StorageScheme.DIRECTORY_BASED.equals(storageScheme) && (myBaseDir != null)) {
    final VirtualFile ideaDir=myBaseDir.findChild(Project.DIRECTORY_STORE_FOLDER);
    if (ideaDir != null && ideaDir.isValid() && ideaDir.isDirectory()) {
      dirtyRoots.add(ideaDir);
    }
  }
  ContainerUtil.addAll(dirtyRoots,getContentRoots());
  String defaultMapping=((ProjectLevelVcsManagerEx)ProjectLevelVcsManager.getInstance(myProject)).haveDefaultMapping();
  boolean haveDefaultMapping=!StringUtil.isEmpty(defaultMapping);
  if (haveDefaultMapping && myBaseDir != null) {
    dirtyRoots.add(myBaseDir);
  }
  return dirtyRoots;
}
