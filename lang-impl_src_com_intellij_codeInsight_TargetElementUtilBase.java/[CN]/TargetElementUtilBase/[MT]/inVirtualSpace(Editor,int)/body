{
  if (offset == editor.getCaretModel().getOffset()) {
    return inVirtualSpace(editor,editor.getCaretModel().getLogicalPosition());
  }
  return inVirtualSpace(editor,editor.offsetToLogicalPosition(offset));
}
