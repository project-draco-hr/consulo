{
  try {
    return ApplicationManager.getApplication().runReadAction(new ThrowableComputable<Boolean,FileNotFoundException>(){
      @Override public Boolean compute() throws FileNotFoundException {
        ExportToHTMLSettings exportToHTMLSettings=ExportToHTMLSettings.getInstance(project);
        if (psiFile instanceof PsiBinaryFile) {
          return true;
        }
        TreeMap<Integer,PsiReference> refMap=null;
        for (        PrintOption printOption : Extensions.getExtensions(PrintOption.EP_NAME)) {
          final TreeMap<Integer,PsiReference> map=printOption.collectReferences(psiFile,filesMap);
          if (map != null) {
            refMap=new TreeMap<Integer,PsiReference>();
            refMap.putAll(map);
          }
        }
        String dirName=constructOutputDirectory(psiFile,outputDirectoryName);
        HTMLTextPainter textPainter=new HTMLTextPainter(psiFile,project,dirName,exportToHTMLSettings.PRINT_LINE_NUMBERS);
        textPainter.paint(refMap,psiFile.getFileType());
        return true;
      }
    }
);
  }
 catch (  FileNotFoundException throwable) {
    myLastException=throwable;
    return true;
  }
}
