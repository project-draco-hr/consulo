{
  Pattern compiledPattern=getPattern(pattern);
  Presentation presentation=anAction.getTemplatePresentation();
  String text=presentation.getText();
  String description=presentation.getDescription();
  String groupName=myActionGroups.get(anAction);
  PatternMatcher matcher=getMatcher();
  if (text != null && matcher.matches(text,compiledPattern)) {
    return MatchMode.NAME;
  }
 else   if (description != null && !description.equals(text) && matcher.matches(description,compiledPattern)) {
    return MatchMode.DESCRIPTION;
  }
  if (text == null) {
    return MatchMode.NONE;
  }
  if (groupName == null) {
    return matches(pattern,compiledPattern,matcher,text) ? MatchMode.NON_MENU : MatchMode.NONE;
  }
  if (matches(pattern,compiledPattern,matcher,groupName + " " + text)) {
    return anAction instanceof ToggleAction ? MatchMode.NAME : MatchMode.GROUP;
  }
  return matches(pattern,compiledPattern,matcher,text + " " + groupName) ? MatchMode.GROUP : MatchMode.NONE;
}
