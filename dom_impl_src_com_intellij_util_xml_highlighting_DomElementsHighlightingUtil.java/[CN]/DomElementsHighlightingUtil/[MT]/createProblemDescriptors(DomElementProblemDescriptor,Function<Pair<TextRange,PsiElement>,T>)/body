{
  final List<T> descritors=new SmartList<T>();
  if (problemDescriptor instanceof DomElementResolveProblemDescriptor) {
    final PsiReference reference=((DomElementResolveProblemDescriptor)problemDescriptor).getPsiReference();
    final PsiElement element=reference.getElement();
    final int startOffset=element.getTextRange().getStartOffset();
    descritors.add(creator.fun(Pair.create(reference.getRangeInElement().shiftRight(startOffset),element)));
    return descritors;
  }
  final DomElement domElement=problemDescriptor.getDomElement();
  final PsiElement psiElement=getPsiElement(domElement);
  if (psiElement != null && StringUtil.isNotEmpty(psiElement.getText())) {
    final XmlTag tag=PsiTreeUtil.getParentOfType(psiElement,XmlTag.class,false);
    if (tag != null && tag.getSubTags().length > 0) {
      addDescriptionsToTagEnds(tag,descritors,creator);
    }
 else {
      descritors.add(creator.fun(Pair.create(psiElement.getTextRange(),psiElement)));
    }
  }
 else {
    final XmlTag tag=getParentXmlTag(domElement);
    if (tag != null) {
      addDescriptionsToTagEnds(tag,descritors,creator);
    }
  }
  return descritors;
}
