{
  LanguageLevel languageLevel;
  if (project != null && virtualFile != null) {
    final Module module=ProjectRootManager.getInstance(project).getFileIndex().getModuleForFile(virtualFile);
    if (module != null) {
      languageLevel=module.getEffectiveLanguageLevel();
    }
 else {
      languageLevel=LanguageLevel.HIGHEST;
    }
  }
 else {
    languageLevel=LanguageLevel.HIGHEST;
  }
  return new JavaFileHighlighter(languageLevel);
}
