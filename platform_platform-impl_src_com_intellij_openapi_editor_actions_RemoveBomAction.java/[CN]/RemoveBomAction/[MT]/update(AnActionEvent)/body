{
  VirtualFile[] files=PlatformDataKeys.VIRTUAL_FILE_ARRAY.getData(e.getDataContext());
  if (files == null) {
    e.getPresentation().setEnabled(false);
    return;
  }
  boolean enabled=false;
  for (  VirtualFile file : files) {
    if (file.isDirectory()) {
      enabled=true;
      break;
    }
 else     if (file.getBOM() != null) {
      enabled=true;
      break;
    }
  }
  e.getPresentation().setEnabled(enabled);
}
