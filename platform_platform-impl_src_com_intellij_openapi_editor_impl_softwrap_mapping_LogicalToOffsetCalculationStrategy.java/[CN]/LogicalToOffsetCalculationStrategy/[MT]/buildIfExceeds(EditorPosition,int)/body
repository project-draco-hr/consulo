{
  if (position.logicalLine != targetPosition.line) {
    return null;
  }
  int result=position.offset + targetPosition.column - position.logicalColumn;
  return result > offset ? null : result;
}
