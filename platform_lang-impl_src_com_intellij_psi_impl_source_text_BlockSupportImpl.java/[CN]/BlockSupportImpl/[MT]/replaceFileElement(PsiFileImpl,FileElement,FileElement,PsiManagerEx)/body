{
  final int oldLength=fileElement.getTextLength();
  sendPsiBeforeEvent(fileImpl);
  if (fileElement.getFirstChildNode() != null)   fileElement.rawRemoveAllChildren();
  final ASTNode firstChildNode=newFileElement.getFirstChildNode();
  if (firstChildNode != null)   fileElement.rawAddChildren((TreeElement)firstChildNode);
  fileImpl.getTreeElement().setCharTable(newFileElement.getCharTable());
  manager.invalidateFile(fileImpl);
  fileElement.subtreeChanged();
  sendPsiAfterEvent(fileImpl,oldLength);
}
