{
  if (text.getText().length() != 0) {
    Component editorComponent=myComboBox.getEditor().getEditorComponent();
    final boolean focusOwner=editorComponent.isFocusOwner();
    int offset=-1;
    if (editorComponent instanceof EditorTextField) {
      final EditorTextField textField=(EditorTextField)editorComponent;
      if (textField.getEditor() != null) {
        offset=textField.getCaretModel().getOffset();
      }
    }
    super.addRecent(text);
    myComboBox.insertItemAt(text,0);
    myComboBox.setSelectedIndex(0);
    editorComponent=myComboBox.getEditor().getEditorComponent();
    if (offset != -1 && editorComponent instanceof EditorTextField) {
      final EditorTextField textField=(EditorTextField)editorComponent;
      final Editor editor=textField.getEditor();
      if (editor != null) {
        textField.getCaretModel().moveToOffset(offset);
        editor.getSelectionModel().setSelection(offset,offset);
      }
    }
    if (focusOwner) {
      editorComponent.requestFocus();
    }
  }
}
