{
  Matcher matcher=PATTERN.matcher(text);
  StringBuffer buff=new StringBuffer();
  while (matcher.find()) {
    String propText=matcher.group();
    String propName=matcher.group(1);
    String resolved=doResolveProperty(propName,project,additionalProperties);
    if (resolved == null)     resolved=propText;
    if (!resolved.equals(propText) && !resolutionStack.contains(propName)) {
      resolutionStack.push(propName);
      resolved=doResolve(resolved,project,additionalProperties,resolutionStack);
      resolutionStack.pop();
    }
    matcher.appendReplacement(buff,Matcher.quoteReplacement(resolved));
  }
  matcher.appendTail(buff);
  return buff.toString();
}
