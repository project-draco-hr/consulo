{
  PsiDirectory psiDirectory=null;
  if (!"".equals(packageName)) {
    PsiPackage rootPackage=findLongestExistingPackage(module.getProject(),packageName);
    if (rootPackage != null) {
      final PsiDirectory[] psiDirectories=getPackageDirectoriesInModule(rootPackage,module);
      if (psiDirectories.length > 0) {
        psiDirectory=psiDirectories[0];
      }
    }
  }
  if (psiDirectory == null) {
    if (checkSourceRootsConfigured(module)) {
      final VirtualFile[] sourceRoots=ModuleRootManager.getInstance(module).getSourceRoots();
      for (      VirtualFile sourceRoot : sourceRoots) {
        final PsiDirectory directory=PsiManager.getInstance(module.getProject()).findDirectory(sourceRoot);
        if (directory != null) {
          psiDirectory=directory;
          break;
        }
      }
    }
  }
  return psiDirectory;
}
