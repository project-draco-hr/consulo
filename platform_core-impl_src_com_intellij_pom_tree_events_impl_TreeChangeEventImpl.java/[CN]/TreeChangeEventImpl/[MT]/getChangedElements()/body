{
  if (myChangedInOrder == null) {
    myChangedInOrder=new ArrayList<ASTNode>(myChangedElements.keySet());
    Collections.sort(myChangedInOrder,new Comparator<ASTNode>(){
      final Map<ASTNode,int[]> routeMap=new THashMap<ASTNode,int[]>(myChangedElements.size());
      final TObjectIntHashMap<ASTNode> nodeIndex=new TObjectIntHashMap<ASTNode>(myChangedElements.size());
      @Override public int compare(      ASTNode o1,      ASTNode o2){
        int[] route=routeMap.get(o1);
        if (route == null)         routeMap.put(o1,route=getRoute(o1,nodeIndex));
        int[] route2=routeMap.get(o2);
        if (route2 == null)         routeMap.put(o2,route2=getRoute(o2,nodeIndex));
        return compareRoutes(route,route2);
      }
    }
);
  }
  return myChangedInOrder.toArray(new ASTNode[myChangedInOrder.size()]);
}
