{
  SourcePosition place=getPlace(event);
  boolean toEnable=place != null;
  Presentation presentation=event.getPresentation();
  if (ActionPlaces.PROJECT_VIEW_POPUP.equals(event.getPlace()) || ActionPlaces.STRUCTURE_VIEW_POPUP.equals(event.getPlace()) || ActionPlaces.FAVORITES_VIEW_POPUP.equals(event.getPlace())) {
    presentation.setVisible(toEnable);
  }
 else   if (DebuggerAction.isContextView(event)) {
    presentation.setText(DebuggerBundle.message("action.add.field.watchpoint.text"));
    Project project=event.getData(PlatformDataKeys.PROJECT);
    if (project != null && place != null) {
      Document document=PsiDocumentManager.getInstance(project).getDocument(place.getFile());
      if (document != null) {
        final int offset=place.getOffset();
        final BreakpointManager breakpointManager=(DebuggerManagerEx.getInstanceEx(project)).getBreakpointManager();
        final Breakpoint fieldBreakpoint=offset >= 0 ? breakpointManager.findBreakpoint(document,offset,FieldBreakpoint.CATEGORY) : null;
        if (fieldBreakpoint != null) {
          presentation.setEnabled(false);
          return;
        }
      }
    }
  }
  presentation.setVisible(toEnable);
}
