{
  if (!isValid(element))   return false;
  final DefaultMutableTreeNode parent=(DefaultMutableTreeNode)node.getParent();
  final Object parentElement=getElementFor(parent);
  if (!isInStructure(parentElement))   return false;
  if (parent instanceof ElementNode) {
    return ((ElementNode)parent).isValidChild(element);
  }
 else {
    for (int i=0; i < parent.getChildCount(); i++) {
      final TreeNode child=parent.getChildAt(i);
      final Object eachElement=getElementFor(child);
      if (isValid(eachElement) && element.equals(eachElement))       return true;
    }
  }
  return false;
}
