{
  final Ref<Transferable> result=new Ref<Transferable>();
  Foundation.executeOnMainThread(new Runnable(){
    @Override public void run(){
      String plainText="public.utf8-plain-text";
      String jvmObject="application/x-java-jvm";
      ID pasteboard=Foundation.invoke("NSPasteboard","generalPasteboard");
      ID types=Foundation.invoke(pasteboard,"types");
      IntegerType count=Foundation.invoke(types,"count");
      ID plainTextType=null;
      ID vmObjectType=null;
      for (int i=0; i < count.intValue(); i++) {
        ID each=Foundation.invoke(types,"objectAtIndex:",i);
        String eachType=Foundation.toStringViaUTF8(each);
        if (plainText.equals(eachType)) {
          plainTextType=each;
        }
        if (eachType.contains(jvmObject)) {
          vmObjectType=each;
        }
      }
      if (vmObjectType != null && plainTextType != null) {
        ID text=Foundation.invoke(pasteboard,"stringForType:",plainTextType);
        result.set(new StringSelection(Foundation.toStringViaUTF8(text)));
      }
    }
  }
,true,true);
  return result.get();
}
