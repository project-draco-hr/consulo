{
  if (Registry.is("ide.mac.useNativeClipboard.async")) {
    JRootPane pane=getRootPane();
    if (pane != null) {
      ID synchronizer_=Foundation.getClass("ClipboardSynchronizer_");
      final ID synchronizer=Foundation.invoke(Foundation.invoke(synchronizer_,"alloc"),"init");
      Foundation.invoke(synchronizer,"performSelectorOnMainThread:withObject:waitUntilDone:",Foundation.createSelector("run:"),null,false);
      MacUtil.startModal(pane);
      Foundation.cfRelease(synchronizer);
      Object contents=pane.getClientProperty(CLIPBOARD_CONTENTS);
      pane.putClientProperty(CLIPBOARD_CONTENTS,null);
      if (contents != null) {
        return (Transferable)contents;
      }
      return null;
    }
  }
  final Ref<Transferable> result=new Ref<Transferable>();
  Foundation.executeOnMainThread(new Runnable(){
    @Override public void run(){
      Transferable transferable=getClipboardContentNatively();
      if (transferable != null) {
        result.set(transferable);
      }
    }
  }
,true,true);
  return result.get();
}
