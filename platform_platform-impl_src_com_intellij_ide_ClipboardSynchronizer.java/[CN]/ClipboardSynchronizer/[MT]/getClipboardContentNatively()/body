{
  String plainText="public.utf8-plain-text";
  String jvmObject="application/x-java-jvm";
  ID pasteboard=Foundation.invoke("NSPasteboard","generalPasteboard");
  ID types=Foundation.invoke(pasteboard,"types");
  IntegerType count=Foundation.invoke(types,"count");
  ID plainTextType=null;
  for (int i=0; i < count.intValue(); i++) {
    ID each=Foundation.invoke(types,"objectAtIndex:",i);
    String eachType=Foundation.toStringViaUTF8(each);
    if (plainText.equals(eachType)) {
      plainTextType=each;
      break;
    }
  }
  Transferable result=null;
  if (plainTextType != null) {
    ID text=Foundation.invoke(pasteboard,"stringForType:",plainTextType);
    String value=Foundation.toStringViaUTF8(text);
    if (value == null) {
      LOG.info(String.format("[Clipboard] Strange string value (null?) for type: %s",plainTextType));
    }
 else {
      result=new StringSelection(value);
    }
  }
  return result;
}
