{
  final ID autoReleasePool=Foundation.invoke("NSAutoreleasePool","new");
  try {
    String plainText="public.utf8-plain-text";
    String jvmObject="application/x-java-jvm";
    ID pasteboard=Foundation.invoke("NSPasteboard","generalPasteboard");
    ID types=Foundation.invoke(pasteboard,"types");
    IntegerType count=Foundation.invoke(types,"count");
    ID plainTextType=null;
    ID vmObjectType=null;
    for (int i=0; i < count.intValue(); i++) {
      ID each=Foundation.invoke(types,"objectAtIndex:",i);
      String eachType=Foundation.toStringViaUTF8(each);
      if (plainText.equals(eachType)) {
        plainTextType=each;
      }
      if (eachType.contains(jvmObject)) {
        vmObjectType=each;
      }
    }
    if (vmObjectType != null && plainTextType != null) {
      ID text=Foundation.invoke(pasteboard,"stringForType:",plainTextType);
      return new StringSelection(Foundation.toStringViaUTF8(text));
    }
  }
  finally {
    Foundation.invoke(autoReleasePool,Foundation.createSelector("release"));
  }
  return null;
}
