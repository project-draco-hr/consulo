{
  PsiFile file=element.getContainingFile();
  if (file == null)   return null;
  TextAttributes result=null;
  final DaemonCodeAnalyzerImpl daemonCodeAnalyzer=(DaemonCodeAnalyzerImpl)DaemonCodeAnalyzer.getInstance(file.getProject());
  List<Pair<NamedScope,NamedScopesHolder>> scopes=daemonCodeAnalyzer.getScopeBasedHighlightingCachedScopes();
  for (  Pair<NamedScope,NamedScopesHolder> scope : scopes) {
    NamedScope namedScope=scope.getFirst();
    NamedScopesHolder scopesHolder=scope.getSecond();
    PackageSet packageSet=namedScope.getValue();
    if (packageSet != null && packageSet.contains(file,scopesHolder)) {
      TextAttributesKey scopeKey=ColorAndFontOptions.getScopeTextAttributeKey(namedScope.getName());
      TextAttributes attributes=colorsScheme.getAttributes(scopeKey);
      if (attributes == null || attributes.isEmpty()) {
        continue;
      }
      result=TextAttributes.merge(attributes,result);
    }
  }
  return result;
}
