{
  CommitFilesOperation operation=new CommitFilesOperation(commitMessage,makeNewFilesReadOnly);
  if (selectedFiles != null) {
    for (    FilePath selectedFile : selectedFiles) {
      operation.addFile(selectedFile.getIOFile());
    }
  }
  if (locallyDeletedFiles != null) {
    for (    File locallyDeletedFile : locallyDeletedFiles) {
      operation.addFile(locallyDeletedFile);
    }
  }
  final CommandCvsHandler result=new CommandCvsHandler(title,operation,FileSetToBeUpdated.selectedFiles(selectedFiles));
  if (tagFilesAfterCommit) {
    RTagOperation[] rtagOperations=RTagOperation.createOn(selectedFiles,tagName,CvsConfiguration.getInstance(project).OVERRIDE_EXISTING_TAG_FOR_PROJECT);
    for (    RTagOperation rtagOperation : rtagOperations) {
      result.addOperation(rtagOperation);
    }
  }
  return result;
}
