{
  final VirtualFile virtualFile=myFile.getVirtualFile();
  if (virtualFile == null)   return;
  VirtualFile sourceRoot=ProjectRootManager.getInstance(project).getFileIndex().getSourceRootForFile(virtualFile);
  final VirtualFile projectRoot=project.getBaseDir();
  if (sourceRoot == null) {
    final String path=VfsUtilCore.getRelativePath(virtualFile,projectRoot,'/');
    ResourceCompilerConfiguration.getInstance(project).addResourceFilePattern(path);
  }
 else {
    final String path=VfsUtilCore.getRelativePath(virtualFile,sourceRoot,'/');
    final String sourceRootPath=VfsUtilCore.getRelativePath(sourceRoot,projectRoot,'/');
    CompilerConfigurationOld.getInstance(project).addResourceFilePattern(sourceRootPath + ':' + path);
  }
  DaemonCodeAnalyzer.getInstance(project).restart(myFile);
}
