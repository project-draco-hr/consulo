{
  final DataContext dataContext=e.getDataContext();
  final Project project=PlatformDataKeys.PROJECT.getData(dataContext);
  final Module module=LangDataKeys.MODULE.getData(dataContext);
  if (module == null)   return;
  GroovyDocConfiguration configuration=new GroovyDocConfiguration();
  final VirtualFile[] files=ModuleRootManager.getInstance(module).getContentRoots();
  if (files.length == 1) {
    configuration.INPUT_DIRECTORY=files[0].getPath();
  }
  final GenerateGroovyDocDialog dialog=new GenerateGroovyDocDialog(project,configuration);
  dialog.show();
  if (!dialog.isOK()) {
    return;
  }
  generateGroovydoc(configuration,project);
}
