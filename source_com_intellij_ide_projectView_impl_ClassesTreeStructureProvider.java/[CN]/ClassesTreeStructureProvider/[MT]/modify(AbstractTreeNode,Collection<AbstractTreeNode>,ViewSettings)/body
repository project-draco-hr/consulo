{
  ArrayList<AbstractTreeNode> result=new ArrayList<AbstractTreeNode>();
  for (  final AbstractTreeNode aChildren : children) {
    ProjectViewNode treeNode=(ProjectViewNode)aChildren;
    Object o=treeNode.getValue();
    if (o instanceof PsiJavaFile) {
      PsiJavaFile psiJavaFile=(PsiJavaFile)o;
      PsiClass[] classes=psiJavaFile.getClasses();
      final VirtualFile virtualFile=psiJavaFile.getVirtualFile();
      if (classes.length != 0 && (virtualFile.getFileType() == StdFileTypes.JAVA || virtualFile.getFileType() == StdFileTypes.CLASS)) {
        for (        PsiClass aClass : classes) {
          if (aClass.isValid()) {
            result.add(new ClassTreeNode(myProject,aClass,((ProjectViewNode)parent).getSettings()));
          }
        }
      }
 else {
        result.add(treeNode);
      }
    }
 else {
      result.add(treeNode);
    }
  }
  return result;
}
