{
  long prevTimestamp=0;
  long length=0;
  int last=myStorage.getLastRecord();
  while (last != 0) {
    long t=myStorage.getTimestamp(last);
    if (prevTimestamp == 0)     prevTimestamp=t;
    long delta=prevTimestamp - t;
    prevTimestamp=t;
    length+=delta < intervalBetweenActivities ? delta : 1;
    if (length >= period)     return last;
    last=doReadPrevSafely(last,recursionGuard);
  }
  return 0;
}
