{
  if (isCompletelyBroken)   return;
  TIntHashSet recursionGuard=new TIntHashSet(1000);
  try {
    int eachBlockId=findFirstObsoleteBlock(period,intervalBetweenActivities,recursionGuard);
    while (eachBlockId != 0) {
      processor.consume(doReadBlock(eachBlockId).changeSet);
      int toDelete=eachBlockId;
      eachBlockId=doReadPrevSafely(eachBlockId,recursionGuard);
      myStorage.deleteRecord(toDelete);
    }
    myStorage.force();
  }
 catch (  IOException e) {
    handleError(e);
  }
}
