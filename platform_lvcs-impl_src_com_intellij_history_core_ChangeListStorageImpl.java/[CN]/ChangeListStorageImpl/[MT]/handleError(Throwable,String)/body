{
  long storageTimestamp=-1;
  long vfsTimestamp=getVFSTimestamp();
  long timestamp=System.currentTimeMillis();
  try {
    storageTimestamp=myStorage.getFSTimestamp();
  }
 catch (  Exception ex) {
    LocalHistoryLog.LOG.warn("cannot read storage timestamp",ex);
  }
  LocalHistoryLog.LOG.error("Local history is broken" + "(version:" + VERSION + ",current timestamp:"+ DateFormat.getDateTimeInstance().format(timestamp)+ ",storage timestamp:"+ DateFormat.getDateTimeInstance().format(storageTimestamp)+ ",vfs timestamp:"+ DateFormat.getDateTimeInstance().format(vfsTimestamp)+ ")\n"+ message,e);
  myStorage.dispose();
  try {
    FileUtil.delete(myStorageDir);
    initStorage(myStorageDir);
  }
 catch (  Throwable ex) {
    LocalHistoryLog.LOG.error("cannot recreate storage",ex);
    isCompletelyBroken=true;
  }
  notifyUser("Local History storage file has become corrupted and will be rebuilt.");
}
