{
  final Map<VirtualFile,GitUpdater> updaters=new HashMap<VirtualFile,GitUpdater>();
  LOG.info("updateImpl: defining updaters...");
  for (  GitRepository repository : myRepositories) {
    VirtualFile root=repository.getRoot();
    final GitUpdater updater;
    if (updateMethod == UpdateMethod.MERGE) {
      updater=new GitMergeUpdater(myProject,myGit,root,myTrackedBranches,myProgressIndicator,myUpdatedFiles);
    }
 else     if (updateMethod == UpdateMethod.REBASE) {
      updater=new GitRebaseUpdater(myProject,myGit,root,myTrackedBranches,myProgressIndicator,myUpdatedFiles);
    }
 else {
      updater=GitUpdater.getUpdater(myProject,myGit,myTrackedBranches,root,myProgressIndicator,myUpdatedFiles);
    }
    if (updater.isUpdateNeeded()) {
      updaters.put(root,updater);
    }
    LOG.info("update| root=" + root + " ,updater="+ updater);
  }
  return updaters;
}
