{
  if (myOnlyUndoTransparents && myHasUndoTransparents || nextCommandToMerge.myOnlyUndoTransparents && nextCommandToMerge.myHasUndoTransparents) {
    return myAffectedDocuments.equals(nextCommandToMerge.myAffectedDocuments);
  }
  if (myIsComplex || nextCommandToMerge.isComplex())   return false;
  return (groupId != null && Comparing.equal(myLastGroupId,groupId));
}
