{
  if (myOnlyUndoTransparents && myHasUndoTransparents || nextCommandToMerge.myOnlyUndoTransparents && nextCommandToMerge.myHasUndoTransparents) {
    return myAffectedDocuments.equals(nextCommandToMerge.myAffectedDocuments);
  }
  return !myIsComplex && !nextCommandToMerge.isComplex() && groupId != null && Comparing.equal(myLastGroupId,groupId);
}
