{
  final PsiElement nameSuggestionContext=file.findElementAt(editor.getCaretModel().getOffset());
  if (element == null && LookupManager.getActiveLookup(editor) != null) {
    element=PsiTreeUtil.getParentOfType(nameSuggestionContext,PsiNamedElement.class);
  }
  final RefactoringSupportProvider supportProvider=element != null ? LanguageRefactoringSupport.INSTANCE.forLanguage(element.getLanguage()) : null;
  return editor.getSettings().isVariableInplaceRenameEnabled() && supportProvider != null && supportProvider.isMemberInplaceRenameAvailable(element,nameSuggestionContext);
}
