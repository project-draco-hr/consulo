{
  final Object[] elements=getSelectedNodeElements();
  if (elements == null) {
    return null;
  }
  ArrayList<Module> result=new ArrayList<Module>();
  for (  Object element : elements) {
    if (element instanceof Module) {
      result.add((Module)element);
    }
 else     if (element instanceof ModuleGroup) {
      result.addAll(Arrays.asList(((ModuleGroup)element).modulesInGroup(myProject,true)));
    }
  }
  return result.isEmpty() ? null : result.toArray(new Module[result.size()]);
}
