{
  Module module=ModuleUtil.findModuleForPsiElement(element);
  AnalysisUIOptions analysisUIOptions=new AnalysisUIOptions();
  analysisUIOptions.save(myStoredSettings.analysisUIOptions);
  AnalysisScope analysisScope=new AnalysisScope(element.getContainingFile());
  String name=module == null ? null : module.getName();
  String dialogTitle=getElementDescription((dataFlowToThis ? BACK_TOOLWINDOW_ID : FORTH_TOOLWINDOW_ID) + " ",element,null);
  dialogTitle=Pattern.compile("<[^<>]*>").matcher(dialogTitle).replaceAll("");
  BaseAnalysisActionDialog dialog=new BaseAnalysisActionDialog(dialogTitle,"Analyze scope",myProject,analysisScope,name,true,analysisUIOptions,element);
  dialog.show();
  if (!dialog.isOK())   return;
  AnalysisScope scope=dialog.getScope(analysisUIOptions,analysisScope,myProject,module);
  myStoredSettings.analysisUIOptions.save(analysisUIOptions);
  SliceRootNode rootNode=new SliceRootNode(myProject,new DuplicateMap(),scope,createRootUsage(element,scope),dataFlowToThis);
  createToolWindow(dataFlowToThis,rootNode,false,getElementDescription(null,element,null));
}
