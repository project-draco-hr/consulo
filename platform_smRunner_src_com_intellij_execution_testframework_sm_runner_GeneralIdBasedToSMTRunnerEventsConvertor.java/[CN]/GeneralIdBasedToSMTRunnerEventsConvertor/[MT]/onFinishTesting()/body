{
  SMRunnerUtil.addToInvokeLater(new Runnable(){
    public void run(){
      if (myIsTestingFinished) {
        return;
      }
      myIsTestingFinished=true;
      if (myRunningNodes.size() == 1 && myRunningNodes.contains(myTestsRootNode)) {
        myTestsRootProxy.setFinished();
      }
 else {
        logProblem("Unexpected running nodes: " + myRunningNodes);
        myTestsRootProxy.setTerminated();
      }
      myNodeByIdMap.clear();
      myRunningNodes.clear();
      fireOnTestingFinished();
    }
  }
);
}
