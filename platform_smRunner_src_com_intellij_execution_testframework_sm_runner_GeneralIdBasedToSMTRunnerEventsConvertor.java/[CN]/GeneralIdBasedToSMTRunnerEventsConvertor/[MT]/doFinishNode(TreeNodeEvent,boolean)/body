{
  Node finishedNode=findNode(treeNodeEvent);
  if (finishedNode == null) {
    String nodeType=suite ? "Suite" : "Test";
    logProblem("Trying to finish not started " + nodeType + ": "+ treeNodeEvent);
    return;
  }
  stopRunningNode(finishedNode,State.FINISHED,treeNodeEvent);
  finishedNode.getProxy().setFinished();
  if (suite) {
    fireOnSuiteFinished(finishedNode.getProxy());
  }
 else {
    fireOnTestFinished(finishedNode.getProxy());
  }
}
