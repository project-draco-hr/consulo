{
  Presentation presentation=event.getPresentation();
  DataContext dataContext=event.getDataContext();
  FileEditor editor=PlatformDataKeys.FILE_EDITOR.getData(dataContext);
  if (editor == null) {
    final Boolean isModalContext=PlatformDataKeys.IS_MODAL_CONTEXT.getData(dataContext);
    if (isModalContext != null && isModalContext) {
      presentation.setEnabled(false);
      return;
    }
  }
  UndoManager undoManager=getUndoManager(editor,dataContext);
  presentation.setEnabled(undoManager != null && isAvailable(editor,undoManager));
  Pair<String,String> pair=getActionNameAndDescription(editor,undoManager);
  presentation.setText(pair.first);
  presentation.setDescription(pair.second);
}
