{
  if (tag == null || (visited != null && visited.contains(tag)))   return true;
  if (visited == null)   visited=new THashSet<XmlTag>();
  visited.add(tag);
  for (  XmlTag t : tag.getSubTags()) {
    TagSchemaProcessor.ProcessingStrategy strategy=null;
    final String name=t.getLocalName();
    if ("element".equals(name) && XmlNSDescriptorImpl.checkSchemaNamespace(t)) {
      if ((strategy=processor.visitElement(t)) == TagSchemaProcessor.ProcessingStrategy.Stop)       return false;
    }
 else {
      if ((strategy=processor.visitTag(t)) == TagSchemaProcessor.ProcessingStrategy.Stop)       return false;
    }
    if (strategy == TagSchemaProcessor.ProcessingStrategy.ProcessChildren) {
      processSchemaTags(t,visited,processor);
    }
  }
  return true;
}
