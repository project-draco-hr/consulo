{
  if (module == null)   return null;
  return new ModuleSourceScope(module.getProject()){
    public GlobalSearchScope getGlobalSearchScope(){
      return GlobalSearchScope.moduleWithDependenciesScope(module);
    }
    public GlobalSearchScope getLibrariesScope(){
      return new ModuleWithDependenciesAndLibsDependencies(module);
    }
    public Module[] getModulesToCompile(){
      return new Module[]{module};
    }
  }
;
}
