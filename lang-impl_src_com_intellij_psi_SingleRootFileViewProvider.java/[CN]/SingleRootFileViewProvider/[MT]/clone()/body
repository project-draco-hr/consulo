{
  final VirtualFile origFile=getVirtualFile();
  LightVirtualFile copy=new LightVirtualFile(origFile.getName(),origFile.getFileType(),getContents(),origFile.getCharset(),getModificationStamp());
  copy.putUserData(UndoManager.DONT_RECORD_UNDO,Boolean.TRUE);
  copy.setCharset(origFile.getCharset());
  return createCopy(copy);
}
