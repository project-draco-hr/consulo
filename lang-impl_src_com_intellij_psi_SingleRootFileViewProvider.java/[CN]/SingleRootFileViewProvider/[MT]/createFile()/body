{
  final VirtualFile vFile=getVirtualFile();
  try {
    if (vFile.isDirectory())     return null;
    final FileTypeManager fileTypeManager=FileTypeManager.getInstance();
    final String name=vFile.getName();
    if (fileTypeManager.isFileIgnored(name))     return null;
    final Project project=myManager.getProject();
    if (isPhysical()) {
      final VirtualFile parent=vFile.getParent();
      if (parent == null)       return null;
      final PsiDirectory psiDir=getManager().findDirectory(parent);
      if (psiDir == null)       return null;
    }
    return creatFile(project,vFile,vFile.getFileType());
  }
 catch (  ProcessCanceledException e) {
    throw e;
  }
catch (  Throwable e) {
    LOG.error(e);
    return null;
  }
}
