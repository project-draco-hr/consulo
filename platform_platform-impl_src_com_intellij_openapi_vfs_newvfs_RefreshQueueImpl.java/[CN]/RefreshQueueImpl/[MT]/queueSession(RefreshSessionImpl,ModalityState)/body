{
  myQueue.submit(new Runnable(){
    @Override public void run(){
      try {
        myRefreshIndicator.start();
        HeavyProcessLatch.INSTANCE.processStarted();
        try {
          doScan(session);
        }
  finally {
          HeavyProcessLatch.INSTANCE.processFinished();
          myRefreshIndicator.stop();
        }
      }
  finally {
        final Application app=ApplicationManager.getApplication();
        app.invokeLater(new DumbAwareRunnable(){
          @Override public void run(){
            if (app.isDisposed())             return;
            session.fireEvents(false);
          }
        }
,modality);
      }
    }
  }
);
}
