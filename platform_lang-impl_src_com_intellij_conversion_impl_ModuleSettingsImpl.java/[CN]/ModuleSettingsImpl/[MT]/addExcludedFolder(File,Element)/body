{
  for (  Element excludedFolder : contentRoot.getChildren(ContentFolderImpl.ELEMENT_NAME)) {
    ContentFolderType contentFolderType=ContentFolderType.valueOf(excludedFolder.getAttributeValue(ContentFolderImpl.TYPE_ATTRIBUTE));
    if (contentFolderType != ContentFolderType.EXCLUDED) {
      continue;
    }
    final File excludedDir=getFile(excludedFolder.getAttributeValue(ContentFolderImpl.URL_ATTRIBUTE));
    if (FileUtil.isAncestor(excludedDir,directory,false)) {
      return;
    }
  }
  String path=myContext.collapsePath(FileUtil.toSystemIndependentName(directory.getAbsolutePath()),this);
  contentRoot.addContent(new Element(ContentFolderImpl.ELEMENT_NAME).setAttribute(ContentFolderImpl.URL_ATTRIBUTE,VfsUtil.pathToUrl(path)).setAttribute(ContentFolderImpl.TYPE_ATTRIBUTE,ContentFolderType.EXCLUDED.name()));
}
