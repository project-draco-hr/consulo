{
  VirtualFile toSelect=getFileToSelect();
  List<OrderRoot> roots=selectRoots(toSelect);
  if (roots.isEmpty())   return;
  final List<OrderRoot> attachedRoots=attachFiles(roots);
  final OrderRoot first=ContainerUtil.getFirstItem(attachedRoots);
  if (first != null) {
    myLastChosen=first.getFile();
  }
  fireLibraryChanged();
  myTree.requestFocus();
}
