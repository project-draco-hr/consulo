{
  EditorFoldingInfo info=EditorFoldingInfo.get(myEditor);
  FoldingModelEx foldingModel=(FoldingModelEx)myEditor.getFoldingModel();
  Map<TextRange,Boolean> rangeToExpandStatusMap=troveMap();
  removeInvalidRegions(info,foldingModel,rangeToExpandStatusMap);
  Map<FoldRegion,Boolean> shouldExpand=troveMap();
  Map<FoldingGroup,Boolean> groupExpand=troveMap();
  List<FoldRegion> newRegions=addNewRegions(info,foldingModel,rangeToExpandStatusMap,shouldExpand,groupExpand);
  applyExpandStatus(newRegions,shouldExpand,groupExpand);
}
