{
  CheckUtil.checkWritable(this);
  if (element instanceof PsiDirectory) {
    String name=((PsiDirectory)element).getName();
    PsiDirectory[] subpackages=getSubdirectories();
    for (    PsiDirectory dir : subpackages) {
      if (Comparing.strEqual(dir.getName(),name)) {
        throw new IncorrectOperationException(VfsBundle.message("dir.already.exists.error",dir.getVirtualFile().getPresentableUrl()));
      }
    }
  }
 else   if (element instanceof PsiFile) {
    String name=((PsiFile)element).getName();
    PsiFile[] files=getFiles();
    for (    PsiFile file : files) {
      if (Comparing.strEqual(file.getName(),name)) {
        throw new IncorrectOperationException(VfsBundle.message("file.already.exists.error",file.getVirtualFile().getPresentableUrl()));
      }
    }
  }
 else   if (element instanceof PsiClass) {
    if (element.getParent() instanceof PsiFile) {
      JavaDirectoryServiceImpl.checkCreateClassOrInterface(this,((PsiClass)element).getName());
    }
 else {
      LOG.error("not implemented");
    }
  }
 else {
    throw new IncorrectOperationException();
  }
}
