{
  checkCreateClassOrInterface(name);
  FileTemplate template=FileTemplateManager.getInstance().getInternalTemplate(templateName);
  Properties defaultProperties=FileTemplateManager.getInstance().getDefaultProperties();
  Properties properties=new Properties(defaultProperties);
  properties.setProperty(FileTemplate.ATTRIBUTE_NAME,name);
  String ext=StdFileTypes.JAVA.getDefaultExtension();
  String fileName=name + "." + ext;
  PsiElement element;
  try {
    element=FileTemplateUtil.createFromTemplate(template,fileName,properties,this);
  }
 catch (  IncorrectOperationException e) {
    throw e;
  }
catch (  Exception e) {
    LOG.error(e);
    return null;
  }
  final PsiJavaFile file=(PsiJavaFile)element.getContainingFile();
  PsiClass[] classes=file.getClasses();
  if (classes.length != 1 || !name.equals(classes[0].getName())) {
    throw new IncorrectOperationException(getIncorrectTemplateMessage(templateName));
  }
  return file.getClasses()[0];
}
