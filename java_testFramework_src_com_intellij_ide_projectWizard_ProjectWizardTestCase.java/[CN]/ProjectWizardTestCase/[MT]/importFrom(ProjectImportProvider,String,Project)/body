{
  VirtualFile file=LocalFileSystem.getInstance().refreshAndFindFileByPath(path);
  assertNotNull("Can't find " + path,file);
  assertTrue(provider.canImport(file,project));
  myWizard=new TestWizard(project,path,provider);
  runWizard(null);
  if (project == null) {
    myCreatedProject=NewProjectUtil.createFromWizard(myWizard,null);
    return myCreatedProject == null ? null : ModuleManager.getInstance(myCreatedProject).getModules()[0];
  }
 else {
    return createModuleFromWizard();
  }
}
