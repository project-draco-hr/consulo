{
  final Editor editor=(Editor)e.getDataContext().getData(DataConstants.EDITOR);
  final Project project=(Project)e.getDataContext().getData(DataConstants.PROJECT);
  if (editor == null)   return;
  String commandName=getTemplatePresentation().getText();
  if (commandName == null)   commandName="";
  CommandProcessor.getInstance().executeCommand(project,new Runnable(){
    public void run(){
      final Runnable action=new Runnable(){
        public void run(){
          PsiFile psiFile=PsiDocumentManager.getInstance(project).getPsiFile(editor.getDocument());
          new HighlightUsagesHandler().invoke(project,editor,psiFile);
        }
      }
;
      if (new HighlightUsagesHandler().startInWriteAction()) {
        ApplicationManager.getApplication().runWriteAction(action);
      }
 else {
        action.run();
      }
    }
  }
,commandName,null);
}
