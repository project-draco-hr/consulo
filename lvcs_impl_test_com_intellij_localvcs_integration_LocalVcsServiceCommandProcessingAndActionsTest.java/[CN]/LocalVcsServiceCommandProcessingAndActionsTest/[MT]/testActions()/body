{
  TestVirtualFile dir=new TestVirtualFile("dir");
  fileManager.fireFileCreated(dir);
  TestVirtualFile one=new TestVirtualFile("one",null,-1);
  TestVirtualFile two=new TestVirtualFile("two",null,-1);
  dir.addChild(one);
  dir.addChild(two);
  LocalVcsAction a=service.startAction("name");
  fileManager.fireFileCreated(one);
  fileManager.fireFileCreated(two);
  a.finish();
  assertTrue(vcs.hasEntry("dir/one"));
  assertTrue(vcs.hasEntry("dir/two"));
  List<Revision> rr=vcs.getRevisionsFor("dir");
  assertEquals(2,rr.size());
  assertEquals("name",rr.get(0).getCauseAction());
}
