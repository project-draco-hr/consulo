{
  super.visitReferenceExpression(refExpr);
  GroovyResolveResult resolveResult=refExpr.advancedResolve();
  PsiElement resolved=resolveResult.getElement();
  if (resolved != null) {
    if (isAssignmentLHS(refExpr) || resolved instanceof PsiPackage)     return;
  }
 else {
    GrExpression qualifier=refExpr.getQualifierExpression();
    if (qualifier == null && isAssignmentLHS(refExpr))     return;
  }
  final PsiType refExprType=refExpr.getType();
  if (refExprType == null && resolved == null) {
    PsiElement refNameElement=refExpr.getReferenceNameElement();
    PsiElement element=refNameElement == null ? refExpr : refNameElement;
    registerError(element);
  }
}
