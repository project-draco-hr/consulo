{
  MultiMap<PsiElement,String> conflicts=new MultiMap<PsiElement,String>();
  if (myUseExistingClass) {
    if (existingClass == null) {
      conflicts.putValue(null,RefactorJBundle.message("cannot.perform.the.refactoring") + "Could not find the selected class");
    }
    if (myExistingClassCompatibleConstructor == null) {
      conflicts.putValue(existingClass,RefactorJBundle.message("cannot.perform.the.refactoring") + "Selected class has no compatible constructors");
    }
  }
 else   if (existingClass != null) {
    conflicts.putValue(existingClass,RefactorJBundle.message("cannot.perform.the.refactoring") + RefactorJBundle.message("there.already.exists.a.class.with.the.chosen.name"));
  }
  for (  UsageInfo usageInfo : refUsages.get()) {
    if (usageInfo instanceof FixableUsageInfo) {
      final String conflictMessage=((FixableUsageInfo)usageInfo).getConflictMessage();
      if (conflictMessage != null) {
        conflicts.putValue(usageInfo.getElement(),conflictMessage);
      }
    }
  }
  return showConflicts(conflicts,refUsages.get());
}
