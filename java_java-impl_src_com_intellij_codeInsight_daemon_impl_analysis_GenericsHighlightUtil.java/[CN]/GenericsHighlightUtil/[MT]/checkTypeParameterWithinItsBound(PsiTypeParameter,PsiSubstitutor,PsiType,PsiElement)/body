{
  final PsiClass referenceClass;
  if (type instanceof PsiClassType) {
    referenceClass=((PsiClassType)type).resolve();
  }
 else {
    referenceClass=null;
  }
  final PsiType psiType=substitutor.substitute(classParameter);
  if (psiType instanceof PsiClassType && !(PsiUtil.resolveClassInType(psiType) instanceof PsiTypeParameter)) {
    if (checkNotInBounds(type,psiType)) {
      final String description="Actual type argument and inferred type contradict each other";
      return HighlightInfo.createHighlightInfo(HighlightInfoType.ERROR,typeElement2Highlight,description);
    }
  }
  final PsiClassType[] bounds=classParameter.getSuperTypes();
  for (  PsiClassType type1 : bounds) {
    PsiType bound=substitutor.substitute(type1);
    if (checkNotInBounds(type,bound)) {
      PsiClass boundClass=bound instanceof PsiClassType ? ((PsiClassType)bound).resolve() : null;
      @NonNls final String messageKey=boundClass == null || referenceClass == null || referenceClass.isInterface() == boundClass.isInterface() ? "generics.type.parameter.is.not.within.its.bound.extend" : "generics.type.parameter.is.not.within.its.bound.implement";
      String description=JavaErrorMessages.message(messageKey,referenceClass != null ? HighlightUtil.formatClass(referenceClass) : type.getPresentableText(),HighlightUtil.formatType(bound));
      final HighlightInfo highlightInfo=HighlightInfo.createHighlightInfo(HighlightInfoType.ERROR,typeElement2Highlight,description);
      if (bound instanceof PsiClassType && referenceClass != null) {
        QuickFixAction.registerQuickFixAction(highlightInfo,QUICK_FIX_FACTORY.createExtendsListFix(referenceClass,(PsiClassType)bound,true),null);
      }
      return highlightInfo;
    }
  }
  return null;
}
