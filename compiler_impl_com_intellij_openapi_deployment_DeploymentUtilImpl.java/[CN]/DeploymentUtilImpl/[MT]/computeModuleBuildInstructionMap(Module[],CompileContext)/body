{
  final Map<Module,BuildRecipe> moduleItemsMap=new LinkedHashMap<Module,BuildRecipe>();
  ApplicationManager.getApplication().runReadAction(new Runnable(){
    public void run(){
      for (      Module module : affectedModules) {
        ModuleBuildProperties moduleBuildProperties=ModuleBuildProperties.getInstance(module);
        if (moduleBuildProperties == null)         continue;
        final BuildRecipe buildRecipe=ModuleBuilder.getInstance(module).getModuleBuildInstructions(context);
        moduleItemsMap.put(module,buildRecipe);
      }
    }
  }
);
  return moduleItemsMap;
}
