{
  if (classpathElements != null && classpathElements.size() > 0) {
    StringBuilder builder;
    Set<String> existingPaths=new HashSet<String>();
    String oldClassPath=mainAttributes.getValue(Attributes.Name.CLASS_PATH);
    if (oldClassPath != null) {
      StringTokenizer tokenizer=new StringTokenizer(oldClassPath);
      while (tokenizer.hasMoreTokens()) {
        existingPaths.add(tokenizer.nextToken());
      }
      builder=new StringBuilder(oldClassPath);
    }
 else {
      builder=new StringBuilder();
    }
    for (    String path : classpathElements) {
      if (!existingPaths.contains(path)) {
        if (builder.length() > 0) {
          builder.append(' ');
        }
        builder.append(path);
      }
    }
    mainAttributes.put(Attributes.Name.CLASS_PATH,builder.toString());
  }
  ManifestBuilder.setGlobalAttributes(mainAttributes);
}
