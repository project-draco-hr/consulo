{
  HistoryDialogModel dirHistoryModel=f.isDirectory() ? new DirectoryHistoryDialogModel(project,myGateway,myVcs,f) : new EntireFileHistoryDialogModel(project,myGateway,myVcs,f);
  int leftRev=findRevisionIndexToRevert(dirHistoryModel,impl);
  if (leftRev < 0) {
    throw new LocalHistoryException("Couldn't find label revision");
  }
  if (leftRev == 0)   return;
  try {
    dirHistoryModel.selectRevisions(-1,leftRev - 1);
    dirHistoryModel.createReverter().revert();
  }
 catch (  IOException e) {
    throw new LocalHistoryException(String.format("Couldn't revert %s to local history label.",f.getName()),e);
  }
}
