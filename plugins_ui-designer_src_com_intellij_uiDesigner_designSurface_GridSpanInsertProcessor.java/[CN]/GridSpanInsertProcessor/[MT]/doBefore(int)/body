{
  if (myMode == GridInsertMode.RowBefore) {
    int oldRow=myInsertCellComponent.getConstraints().getRow();
    int columns=myLayoutManager.getGridColumnCount(myContainer);
    for (int i=0; i < columns; i++) {
      if (i != myColumn) {
        RadComponent component=RadAbstractGridLayoutManager.getComponentAtGrid(myContainer,oldRow,i);
        if (component != null) {
          GridConstraints constraints=component.getConstraints();
          if (constraints.getRow() == oldRow) {
            GridConstraints oldConstraints=(GridConstraints)constraints.clone();
            constraints.setRow(newCell);
            constraints.setRowSpan(constraints.getRowSpan() + oldRow - newCell);
            component.fireConstraintsChanged(oldConstraints);
          }
          i=constraints.getColumn() + constraints.getColSpan() - 1;
        }
      }
    }
  }
 else   if (myMode == GridInsertMode.ColumnBefore) {
    int oldColumn=myInsertCellComponent.getConstraints().getColumn();
    int rows=myLayoutManager.getGridRowCount(myContainer);
    for (int i=0; i < rows; i++) {
      if (i != myRow) {
        RadComponent component=RadAbstractGridLayoutManager.getComponentAtGrid(myContainer,i,oldColumn);
        if (component != null) {
          GridConstraints constraints=component.getConstraints();
          if (constraints.getColumn() == oldColumn) {
            GridConstraints oldConstraints=(GridConstraints)constraints.clone();
            constraints.setColumn(newCell);
            constraints.setColSpan(constraints.getColSpan() + oldColumn - newCell);
            component.fireConstraintsChanged(oldConstraints);
          }
          i=constraints.getRow() + constraints.getRowSpan() - 1;
        }
      }
    }
  }
}
