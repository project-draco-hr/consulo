{
  if (roots.length == 0)   return null;
  AbstractVcs firstVcs=VcsUtil.getVcsFor(project,roots[0]);
  if (firstVcs == null)   return null;
  CheckinEnvironment firstEnv=firstVcs.getCheckinEnvironment();
  if (firstEnv == null)   return null;
  for (int i=0; i < roots.length; i++) {
    FilePath file=roots[i];
    AbstractVcs vcs=VcsUtil.getVcsFor(project,file);
    if (vcs == null)     return null;
    CheckinEnvironment env=vcs.getCheckinEnvironment();
    if (firstEnv != env) {
      return null;
    }
  }
  return firstEnv;
}
