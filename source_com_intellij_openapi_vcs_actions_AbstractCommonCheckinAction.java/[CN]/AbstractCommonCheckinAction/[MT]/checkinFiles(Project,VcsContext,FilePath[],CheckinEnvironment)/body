{
  final boolean showDialog=ProjectLevelVcsManagerEx.getInstanceEx(project).getOptions(VcsConfiguration.StandardOption.CHECKIN).getValue() || OptionsDialog.shiftIsPressed(context.getModifiers());
  if (showDialog) {
    CheckinFileDialog dialog=new CheckinFileDialog(project,getActionName(context),checkinEnvironment,roots);
    dialog.show();
    if (!dialog.isOK())     return;
    checkinFiles(checkinEnvironment,roots,project,dialog.getPreparedComment(checkinEnvironment),context);
  }
 else {
    checkinFiles(checkinEnvironment,roots,project,checkinEnvironment.prepareCheckinMessage(CheckinDialog.getInitialMessage(roots,project)),context);
  }
}
