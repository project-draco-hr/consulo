{
  final CaretModel caretModel=editor.getCaretModel();
  final int position=caretModel.getOffset();
  PsiElement element=file.findElementAt(position);
  while (element != null) {
    if (predicate.satisfiedBy(element)) {
      return element;
    }
 else {
      element=element.getParent();
      if (element instanceof PsiFile) {
        break;
      }
    }
  }
  return null;
}
