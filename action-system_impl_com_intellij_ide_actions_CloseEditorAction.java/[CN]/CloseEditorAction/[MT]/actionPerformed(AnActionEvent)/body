{
  final DataContext dataContext=e.getDataContext();
  final Project project=DataKeys.PROJECT.getData(dataContext);
  final FileEditorManagerEx editorManager=((FileEditorManagerEx)FileEditorManager.getInstance(project));
  EditorWindow window=(EditorWindow)dataContext.getData(DataConstantsEx.EDITOR_WINDOW);
  VirtualFile file;
  if (window == null) {
    window=editorManager.getCurrentWindow();
    file=window.getSelectedFile();
  }
 else {
    file=DataKeys.VIRTUAL_FILE.getData(dataContext);
  }
  if (file != null) {
    editorManager.closeFile(file,window);
  }
}
