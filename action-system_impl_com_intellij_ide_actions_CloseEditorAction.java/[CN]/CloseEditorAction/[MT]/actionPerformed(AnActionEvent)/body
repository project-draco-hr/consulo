{
  final DataContext dataContext=e.getDataContext();
  final Project project=(Project)dataContext.getData(DataConstants.PROJECT);
  final FileEditorManagerEx editorManager=((FileEditorManagerEx)FileEditorManager.getInstance(project));
  EditorWindow window=(EditorWindow)dataContext.getData(DataConstantsEx.EDITOR_WINDOW);
  VirtualFile file;
  if (window == null) {
    window=editorManager.getCurrentWindow();
    file=window.getSelectedFile();
  }
 else {
    file=(VirtualFile)dataContext.getData(DataConstants.VIRTUAL_FILE);
  }
  if (window != null && file != null) {
    editorManager.closeFile(file,window);
  }
}
