{
  final Element rootElement=getRootElement();
  if (rootElement == null)   return;
  if (myPathMacroManager != null) {
    myPathMacroManager.collapsePaths(element);
  }
  final Document document=rootElement.getOwnerDocument();
  Element newComponentElement=document.createElement(COMPONENT);
  newComponentElement.setAttribute(NAME,componentName);
  final NodeList childNodes=element.getChildNodes();
  while (childNodes.getLength() > 0) {
    newComponentElement.appendChild(document.adoptNode(childNodes.item(0)));
  }
  final NamedNodeMap attributes=element.getAttributes();
  for (int i=0; i < attributes.getLength(); i++) {
    Attr attr=(Attr)attributes.item(i);
    newComponentElement.setAttribute(attr.getName(),attr.getValue());
  }
  final Element[] elements=DOMUtil.getChildElements(rootElement);
  for (  Element e : elements) {
    if (e.getNodeName().equals(COMPONENT) && e.hasAttribute(NAME) && e.getAttribute(NAME).equals(componentName)) {
      e.getParentNode().removeChild(e);
    }
  }
  rootElement.appendChild(newComponentElement);
}
