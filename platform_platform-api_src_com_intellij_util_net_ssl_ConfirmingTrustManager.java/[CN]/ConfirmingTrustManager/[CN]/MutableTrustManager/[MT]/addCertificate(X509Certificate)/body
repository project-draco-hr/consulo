{
  myWriteLock.lock();
  try {
    if (isBroken()) {
      return false;
    }
    myKeyStore.setCertificateEntry(createAlias(certificate),certificate);
    flushKeyStore();
    myTrustManager=initFactoryAndGetManager();
    myDispatcher.getMulticaster().certificateAdded(certificate);
    return true;
  }
 catch (  Exception e) {
    LOG.error("Can't add certificate",e);
    return false;
  }
 finally {
    myWriteLock.unlock();
  }
}
