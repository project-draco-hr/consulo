{
  KeyStore keyStore;
  try {
    keyStore=KeyStore.getInstance(KeyStore.getDefaultType());
    File cacertsFile=new File(path);
    if (cacertsFile.exists()) {
      FileInputStream stream=null;
      try {
        stream=new FileInputStream(path);
        keyStore.load(stream,password.toCharArray());
      }
  finally {
        StreamUtil.closeStream(stream);
      }
    }
 else {
      if (!FileUtil.createParentDirs(cacertsFile)) {
        LOG.error("Cannot create directories: " + cacertsFile.getParent());
        return null;
      }
      keyStore.load(null,password.toCharArray());
    }
  }
 catch (  Exception e) {
    LOG.error(e);
    return null;
  }
  return keyStore;
}
