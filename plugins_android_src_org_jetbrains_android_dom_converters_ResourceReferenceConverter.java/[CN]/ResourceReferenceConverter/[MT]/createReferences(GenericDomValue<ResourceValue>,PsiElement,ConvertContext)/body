{
  Module module=context.getModule();
  if (module != null) {
    AndroidFacet facet=AndroidFacet.getInstance(module);
    if (facet != null) {
      ResourceValue resValue=value.getValue();
      if (resValue != null && resValue.isReference()) {
        String resType=resValue.getResourceType();
        if (resType == null)         return PsiReference.EMPTY_ARRAY;
        if (resValue.getPackage() == null && "+id".equals(resValue.getResourceType())) {
          return PsiReference.EMPTY_ARRAY;
        }
        List<PsiElement> elements=new ArrayList<PsiElement>();
        List<PsiFile> files=new ArrayList<PsiFile>();
        collectTargetsWithDependencies(facet,resValue,elements,files);
        if (files.size() > 0) {
          return new PsiReference[]{new FileResourceReference(value,files)};
        }
        return new PsiReference[]{new ValueResourceReference(value,elements)};
      }
    }
  }
  return PsiReference.EMPTY_ARRAY;
}
