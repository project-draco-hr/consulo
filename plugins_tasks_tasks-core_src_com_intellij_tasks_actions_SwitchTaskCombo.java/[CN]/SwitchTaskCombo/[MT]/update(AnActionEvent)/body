{
  Project project=e.getData(PlatformDataKeys.PROJECT);
  Presentation presentation=e.getPresentation();
  if (project == null || project.isDisposed() || (ActionPlaces.MAIN_MENU.equals(e.getPlace()) && findFrame(e) == null)) {
    presentation.setEnabled(false);
    presentation.setText("");
    presentation.setIcon(null);
  }
 else {
    LocalTask activeTask=TaskManager.getManager(project).getActiveTask();
    presentation.setVisible(true);
    presentation.setEnabled(true);
    if (isImplicit(activeTask) && !TaskSettings.getInstance().ALWAYS_DISPLAY_COMBO) {
      presentation.setText("");
      presentation.setIcon(null);
      presentation.setDescription("Switch Tasks");
      presentation.setVisible(false);
    }
 else {
      String s=getText(activeTask);
      presentation.setText(s);
      presentation.setIcon(activeTask.getIcon());
      presentation.setDescription(activeTask.getSummary());
    }
  }
}
