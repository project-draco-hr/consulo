{
  int startOffset=myEditor.getSelectionModel().getSelectionStart();
  int endOffset=myEditor.getSelectionModel().getSelectionEnd();
  PsiExpression expr=CodeInsightUtil.findExpressionInRange(myFile,startOffset,endOffset);
  if (expr == null)   return false;
  PsiMethod method=Util.getContainingMethod(expr);
  if (method == null)   return false;
  final PsiMethod methodToSearchFor;
  if (searchForSuper) {
    methodToSearchFor=PsiSuperMethodUtil.findDeepestSuperMethod(method);
  }
 else {
    methodToSearchFor=method;
  }
  new IntroduceParameterProcessor(myProject,method,methodToSearchFor,expr,expr,null,true,parameterName,replaceAllOccurences,replaceFieldsWithGetters,declareFinal,null,null).testRun();
  myEditor.getSelectionModel().removeSelection();
  return true;
}
