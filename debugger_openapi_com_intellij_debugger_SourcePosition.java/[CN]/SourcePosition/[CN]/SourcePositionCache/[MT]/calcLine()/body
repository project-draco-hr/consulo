{
  final PsiFile file=getFile();
  final Document document=PsiDocumentManager.getInstance(file.getProject()).getDocument(file);
  if (document != null) {
    try {
      return document.getLineNumber(calcOffset());
    }
 catch (    IndexOutOfBoundsException e) {
    }
  }
  return -1;
}
