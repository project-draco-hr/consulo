{
  if (PsiUtil.isRawSubstitutor(owner,substitutor)) {
    return TypeConversionUtil.erasure(type);
  }
  final PsiType psiType=substitutor.substitute(type);
  if (psiType != null) {
    final PsiType deepComponentType=psiType.getDeepComponentType();
    if (!(deepComponentType instanceof PsiCapturedWildcardType || deepComponentType instanceof PsiWildcardType)) {
      return psiType;
    }
  }
  return TypeConversionUtil.erasure(type);
}
