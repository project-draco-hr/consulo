{
  RunnerAndConfigurationSettingsImpl configuration=new RunnerAndConfigurationSettingsImpl(this);
  configuration.readExternal(element);
  ConfigurationFactory factory=configuration.getFactory();
  if (factory == null) {
    return null;
  }
  final Element methodsElement=element.getChild(METHOD);
  if (configuration.isTemplate()) {
    myTemplateConfigurationsMap.put(factory.getType().getId() + "." + factory.getName(),configuration);
    final Map<String,Boolean> map=updateStepsBeforeRun(methodsElement);
    setCompileMethodBeforeRun(configuration.getConfiguration(),map);
  }
 else {
    if (Boolean.valueOf(element.getAttributeValue(SELECTED_ATTR)).booleanValue()) {
      mySelectedConfiguration=configuration;
    }
    if (TEMP_CONFIGURATION.equals(element.getName())) {
      myTempConfiguration=configuration;
    }
    final Map<String,Boolean> map=updateStepsBeforeRun(methodsElement);
    addConfiguration(configuration,isShared,map);
  }
  return configuration;
}
