{
  if (items != null && items.length > 0) {
    context.getProgressIndicator().setText(AndroidBundle.message("android.compile.messages.generating.r.java"));
    Computable<GenerationItem[]> computation=new Computable<GenerationItem[]>(){
      public GenerationItem[] compute(){
        if (context.getProject().isDisposed()) {
          return EMPTY_GENERATION_ITEM_ARRAY;
        }
        return doGenerate(context,items);
      }
    }
;
    GenerationItem[] generationItems=computation.compute();
    List<VirtualFile> generatedVFiles=new ArrayList<VirtualFile>();
    for (    GenerationItem item : generationItems) {
      final File[] generatedFiles=((AptGenerationItem)item).myGeneratedFiles;
      for (      File generatedFile : generatedFiles) {
        CompilerUtil.refreshIOFile(generatedFile);
        CompilerUtil.refreshIOFile(generatedFile.getParentFile());
        VirtualFile generatedVFile=LocalFileSystem.getInstance().findFileByIoFile(generatedFile);
        if (generatedVFile != null) {
          generatedVFiles.add(generatedVFile);
        }
      }
    }
    if (context instanceof CompileContextEx) {
      ((CompileContextEx)context).markGenerated(generatedVFiles);
    }
    return generationItems;
  }
  return EMPTY_GENERATION_ITEM_ARRAY;
}
