{
  super(new FlowLayout(FlowLayout.LEFT,0,0));
  myProject=project;
  myModel=createModel();
  myIdeView=new NavBarIdeView(this);
  myPresentation=new NavBarPresentation(myProject);
  myUpdateQueue=new NavBarUpdateQueue(this);
  PopupHandler.installPopupHandler(this,IdeActions.GROUP_NAVBAR_POPUP,ActionPlaces.NAVIGATION_BAR);
  setOpaque(false);
  if (!docked && UIUtil.isUnderDarcula()) {
    setBorder(new LineBorder(Gray._120,1));
  }
  myCopyPasteDelegator=new CopyPasteDelegator(myProject,NavBarPanel.this){
    @Override @NotNull protected PsiElement[] getSelectedElements(){
      final PsiElement element=getSelectedElement(PsiElement.class);
      return element == null ? PsiElement.EMPTY_ARRAY : new PsiElement[]{element};
    }
  }
;
  myUpdateQueue.queueModelUpdateFromFocus();
  myUpdateQueue.queueRebuildUi();
  if (!docked) {
    final ActionCallback typeAheadDone=new ActionCallback();
    IdeFocusManager.getInstance(project).typeAheadUntil(typeAheadDone);
    myUpdateQueue.queueTypeAheadDone(typeAheadDone);
  }
  Disposer.register(project,this);
}
