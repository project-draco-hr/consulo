{
  if (!isShowing()) {
    return;
  }
  IdeFocusManager.getInstance(myProject).doWhenFocusSettlesDown(new Runnable(){
    @Override public void run(){
      Window wnd=SwingUtilities.windowForComponent(NavBarPanel.this);
      if (wnd == null || !wnd.isActive())       return;
      final Window window=KeyboardFocusManager.getCurrentKeyboardFocusManager().getFocusedWindow();
      if (window instanceof Dialog) {
        final Dialog dialog=(Dialog)window;
        if (dialog.isModal() && !SwingUtilities.isDescendingFrom(NavBarPanel.this,dialog)) {
          return;
        }
      }
      queueModelUpdateFromFocus();
    }
  }
);
}
