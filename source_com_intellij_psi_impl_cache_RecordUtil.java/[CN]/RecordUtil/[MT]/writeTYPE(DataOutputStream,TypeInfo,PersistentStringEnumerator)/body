{
  if (typeInfo == null) {
    dataStream.writeByte(0x02);
    return;
  }
  boolean isEllipsis=typeInfo.isEllipsis;
  String text=typeInfo.text;
  byte arrayCount=typeInfo.arrayCount;
  int frequentIndex=ourFrequentTypeIndex.get(text);
  LOG.assertTrue(frequentIndex == 0 || frequentIndex < 16);
  int flags=arrayCount == 0 ? 0 : 1;
  if (isEllipsis)   flags|=2;
  if (frequentIndex != 0) {
    dataStream.writeByte((flags << 6) | 0x01 | (frequentIndex << 2));
    if (arrayCount != 0) {
      dataStream.writeByte(arrayCount);
    }
  }
 else {
    dataStream.writeByte((flags << 6) | 0x00);
    if (arrayCount != 0) {
      dataStream.writeByte(arrayCount);
    }
    DataInputOutputUtil.writeNAME(dataStream,text,nameStorage);
  }
}
