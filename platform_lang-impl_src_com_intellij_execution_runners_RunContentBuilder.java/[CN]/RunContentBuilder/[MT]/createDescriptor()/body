{
  final RunProfile profile=myEnvironment.getRunProfile();
  if (ApplicationManager.getApplication().isUnitTestMode()) {
    return new RunContentDescriptor(profile,myExecutionResult,myUi);
  }
  final ExecutionConsole console=myExecutionResult.getExecutionConsole();
  RunContentDescriptor contentDescriptor=new RunContentDescriptor(profile,myExecutionResult,myUi);
  if (console != null) {
    if (console instanceof ExecutionConsoleEx) {
      ((ExecutionConsoleEx)console).buildUi(myUi);
    }
 else {
      buildConsoleUiDefault(myUi,console);
    }
    initLogConsoles(profile,contentDescriptor,console);
  }
  myUi.getOptions().setLeftToolbar(createActionToolbar(contentDescriptor),ActionPlaces.UNKNOWN);
  if (profile instanceof RunConfigurationBase) {
    if (console instanceof ObservableConsoleView && !ApplicationManager.getApplication().isUnitTestMode()) {
      ((ObservableConsoleView)console).addChangeListener(new ConsoleToFrontListener((RunConfigurationBase)profile,myProject,myEnvironment.getExecutor(),contentDescriptor,myUi),this);
    }
  }
  return contentDescriptor;
}
