{
  if (configurable == null) {
    mySelectedConfigurable=null;
    myKeySelectedConfigurableIndex=0;
    updateTitle();
    myOptionsPanel.removeAll();
    validate();
    repaint();
    return;
  }
  Dimension currentOptionsSize=myOptionsPanel.getSize();
  if (mySelectedConfigurable != null && mySelectedConfigurable.isModified()) {
    int exitCode=Messages.showYesNoDialog(OptionsBundle.message("options.page.modified.save.message.text"),OptionsBundle.message("options.save.changes.message.title"),Messages.getQuestionIcon());
    if (exitCode == 0) {
      try {
        mySelectedConfigurable.apply();
      }
 catch (      ConfigurationException exc) {
        if (exc.getMessage() != null) {
          Messages.showMessageDialog(exc.getMessage(),exc.getTitle(),Messages.getErrorIcon());
        }
        return;
      }
    }
  }
  if (mySelectedConfigurable != null) {
    Dimension savedPrefferedSize=myConfigurable2PrefSize.get(mySelectedConfigurable);
    if (savedPrefferedSize != null) {
      myConfigurable2PrefSize.put(mySelectedConfigurable,new Dimension(currentOptionsSize));
    }
  }
  myComponentPanel.setCursor(Cursor.getPredefinedCursor(Cursor.WAIT_CURSOR));
  myOptionsPanel.removeAll();
  mySelectedConfigurable=configurable;
  myKeySelectedConfigurableIndex=index;
  if (configurable instanceof SearchableConfigurable) {
    configurable=new DefaultSearchableConfigurable((SearchableConfigurable)configurable);
  }
  JComponent component=myInitializedConfigurables2Component.get(configurable);
  if (component == null) {
    component=configurable.createComponent();
    myInitializedConfigurables2Component.put(configurable,component);
  }
  Dimension compPrefSize;
  if (myConfigurable2PrefSize.containsKey(configurable)) {
    compPrefSize=myConfigurable2PrefSize.get(configurable);
  }
 else {
    compPrefSize=component.getPreferredSize();
    myConfigurable2PrefSize.put(configurable,compPrefSize);
  }
  int widthDelta=Math.max(compPrefSize.width - currentOptionsSize.width,0);
  int heightDelta=Math.max(compPrefSize.height - currentOptionsSize.height,0);
  myOptionsPanel.add(component,BorderLayout.CENTER);
  if (widthDelta > 0 || heightDelta > 0) {
    setSize(getSize().width + widthDelta,getSize().height + heightDelta);
  }
  configurable.reset();
  updateTitle();
  validate();
  repaint();
  requestFocusForMainPanel();
  myComponentPanel.setCursor(Cursor.getPredefinedCursor(Cursor.DEFAULT_CURSOR));
  if (configurable instanceof DefaultSearchableConfigurable) {
    selectOption((DefaultSearchableConfigurable)configurable);
  }
}
