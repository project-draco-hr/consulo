{
  if (referenceParameterList != null && PsiUtil.getLanguageLevel(referenceParameterList).compareTo(LanguageLevel.JDK_1_5) < 0) {
    if (referenceParameterList.getTypeParameterElements().length > 0) {
      HighlightInfo info=HighlightInfo.createHighlightInfo(HighlightInfoType.ERROR,referenceParameterList,GENERICS_ARE_NOT_SUPPORTED);
      QuickFixAction.registerQuickFixAction(info,new ShowModulePropertiesFix(referenceParameterList));
      QuickFixAction.registerQuickFixAction(info,new IncreaseLanguageLevelFix(LanguageLevel.JDK_1_5));
      return info;
    }
  }
  final PsiTypeParameter[] typeParameters=typeParameterListOwner.getTypeParameters();
  final int targetParametersNum=typeParameters.length;
  final int refParametersNum=referenceParameterList == null ? 0 : referenceParameterList.getTypeParameterElements().length;
  if (targetParametersNum != refParametersNum && refParametersNum != 0) {
    final String description;
    if (targetParametersNum == 0) {
      description=JavaErrorMessages.message("generics.type.or.method.does.not.have.type.parameters",typeParameterListOwnerCategoryDescription(typeParameterListOwner),typeParameterListOwnerDescription(typeParameterListOwner));
    }
 else {
      description=JavaErrorMessages.message("generics.wrong.number.of.type.arguments",refParametersNum,targetParametersNum);
    }
    final HighlightInfo highlightInfo=HighlightInfo.createHighlightInfo(HighlightInfoType.ERROR,referenceParameterList,description);
    if (registerIntentions) {
      PsiElement pparent=referenceParameterList.getParent().getParent();
      if (pparent instanceof PsiTypeElement) {
        PsiElement variable=pparent.getParent();
        if (variable instanceof PsiVariable) {
          VariableParameterizedTypeFix.registerIntentions(highlightInfo,(PsiVariable)variable,referenceParameterList);
        }
      }
    }
    return highlightInfo;
  }
  if (targetParametersNum > 0 && refParametersNum != 0) {
    final PsiTypeElement[] referenceElements=referenceParameterList.getTypeParameterElements();
    for (int i=0; i < typeParameters.length; i++) {
      PsiTypeParameter classParameter=typeParameters[i];
      final PsiTypeElement typeElement=referenceElements[i];
      final PsiType type=typeElement.getType();
      if (!(type instanceof PsiClassType))       continue;
      final PsiClass referenceClass=((PsiClassType)type).resolve();
      if (referenceClass == null)       continue;
      final PsiClassType[] bounds=classParameter.getSuperTypes();
      for (      PsiClassType type1 : bounds) {
        PsiType bound=substitutor.substitute(type1);
        if (!TypeConversionUtil.isAssignable(bound,type,false)) {
          PsiClass boundClass=bound instanceof PsiClassType ? ((PsiClassType)bound).resolve() : null;
          @NonNls final String messageKey=boundClass == null || referenceClass.isInterface() == boundClass.isInterface() ? "generics.type.parameter.is.not.within.its.bound.extend" : "generics.type.parameter.is.not.within.its.bound.implement";
          String description=JavaErrorMessages.message(messageKey,HighlightUtil.formatClass(referenceClass),HighlightUtil.formatType(bound));
          final HighlightInfo highlightInfo=HighlightInfo.createHighlightInfo(HighlightInfoType.ERROR,typeElement,description);
          if (bound instanceof PsiClassType) {
            QuickFixAction.registerQuickFixAction(highlightInfo,QUICK_FIX_FACTORY.createExtendsListFix(referenceClass,(PsiClassType)bound,true),(HighlightDisplayKey)null,null);
          }
          return highlightInfo;
        }
      }
    }
  }
  return null;
}
