{
  if (myProject == null && project != null)   myProject=project;
  init();
  final VirtualFile lastOpenedFile=FileChooserUtil.getLastOpenedFile(myProject);
  final VirtualFile file=FileChooserUtil.getFileToSelect(myChooserDescriptor,project,toSelect,lastOpenedFile);
  if (file != null && file.isValid()) {
    myFileSystemTree.select(file,new Runnable(){
      public void run(){
        if (!file.equals(myFileSystemTree.getSelectedFile())) {
          VirtualFile parent=file.getParent();
          if (parent != null) {
            myFileSystemTree.select(parent,null);
          }
        }
 else         if (file.isDirectory()) {
          myFileSystemTree.expand(file,null);
        }
      }
    }
);
  }
  show();
}
