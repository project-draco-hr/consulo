{
  if (!isOKActionEnabled()) {
    return;
  }
  if (isTextFieldActive()) {
    final String text=myPathTextField.getTextFieldText();
    final LookupFile file=myPathTextField.getFile();
    if (text == null || file == null || !file.exists()) {
      setErrorText("Specified path cannot be found");
      return;
    }
  }
  final VirtualFile[] files=getSelectedFilesInt();
  if (files.length == 0) {
    myChosenFiles=VirtualFile.EMPTY_ARRAY;
    close(CANCEL_EXIT_CODE);
    return;
  }
  try {
    myChooserDescriptor.validateSelectedFiles(files);
  }
 catch (  Exception e) {
    Messages.showErrorDialog(getContentPane(),e.getMessage(),getTitle());
    return;
  }
  myChosenFiles=files;
  storeSelection(files[files.length - 1]);
  super.doOKAction();
}
