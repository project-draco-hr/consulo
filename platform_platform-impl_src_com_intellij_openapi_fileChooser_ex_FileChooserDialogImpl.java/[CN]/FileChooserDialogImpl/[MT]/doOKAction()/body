{
  if (!isOKActionEnabled()) {
    return;
  }
  if (isTextFieldActive()) {
    final String text=myPathTextField.getTextFieldText();
    final LookupFile file=myPathTextField.getFile();
    if (text == null || file == null || !file.exists()) {
      setErrorText("Specified path cannot be found");
      return;
    }
  }
  final VirtualFile[] selectedFiles=getSelectedFiles();
  if (selectedFiles.length == 0) {
    myChosenFiles=VirtualFile.EMPTY_ARRAY;
    close(CANCEL_EXIT_CODE);
    return;
  }
  try {
    myChooserDescriptor.validateSelectedFiles(selectedFiles);
  }
 catch (  Exception e) {
    Messages.showErrorDialog(getContentPane(),e.getMessage(),getTitle());
    return;
  }
  myChosenFiles=selectedFiles;
  setLastSelectedPath(FileChooserUtil.getSelectionPath(selectedFiles[selectedFiles.length - 1]));
  super.doOKAction();
}
