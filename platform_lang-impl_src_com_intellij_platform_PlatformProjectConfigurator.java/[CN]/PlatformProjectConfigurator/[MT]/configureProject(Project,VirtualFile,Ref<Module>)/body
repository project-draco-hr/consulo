{
  final ModuleManager moduleManager=ModuleManager.getInstance(project);
  final Module[] modules=moduleManager.getModules();
  if (modules.length == 0) {
    ApplicationManager.getApplication().runWriteAction(new Runnable(){
      public void run(){
        String moduleName=baseDir.getName().replace(":","");
        String imlName=baseDir.getPath() + "/.idea/" + moduleName+ ModuleFileType.DOT_DEFAULT_EXTENSION;
        final Module module=moduleManager.newModule(imlName,ModuleTypeManager.getInstance().getDefaultModuleType());
        ModifiableRootModel rootModel=ModuleRootManager.getInstance(module).getModifiableModel();
        rootModel.addContentEntry(baseDir);
        rootModel.inheritSdk();
        rootModel.commit();
        moduleRef.set(module);
      }
    }
);
  }
}
