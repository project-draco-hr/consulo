{
  String qName=aClass.getQualifiedName();
  if (qName == null)   return aClass.getName();
  String packageName=((PsiJavaFile)aClass.getContainingFile()).getPackageName();
  if (packageName.length() == 0)   return qName;
  String shortName=packageName.length() < qName.length() ? qName.substring(packageName.length() + 1) : qName;
  final PsiManager manager=aClass.getManager();
  return manager.areElementsEquivalent(aClass,manager.getResolveHelper().resolveReferencedClass(shortName,context)) ? shortName : qName;
}
