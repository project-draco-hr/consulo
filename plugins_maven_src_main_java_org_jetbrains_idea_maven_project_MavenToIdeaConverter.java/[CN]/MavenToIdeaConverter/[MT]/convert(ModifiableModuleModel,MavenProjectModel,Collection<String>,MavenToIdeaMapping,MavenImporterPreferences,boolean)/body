{
  final MavenToIdeaConverter mavenToIdeaConverter=new MavenToIdeaConverter(modifiableModel,mapping,preferences,markSynthetic);
  projectModel.visit(new MavenProjectModel.MavenProjectVisitorRoot(){
    public void visit(    final MavenProjectModel.Node node){
      mavenToIdeaConverter.convert(node,profiles);
      for (      MavenProjectModel.Node subnode : node.mavenModulesTopoSorted) {
        mavenToIdeaConverter.convert(subnode,profiles);
      }
    }
  }
);
  createModuleGroups(modifiableModel,projectModel,mapping,preferences.isCreateModuleGroups());
  for (  Module module : mapping.getExistingModules()) {
    new RootModelAdapter(module).resolveModuleDependencies(mapping.getLibraryNameToModuleName());
  }
  try {
    modifiableModel.commit();
  }
 catch (  ModuleCircularDependencyException ignore) {
  }
}
