{
  if (!CodeInsightUtilBase.prepareEditorForWrite(editor))   return;
  if (!FileDocumentManager.getInstance().requestWriting(editor.getDocument(),project)) {
    return;
  }
  final PsiClass aClass=OverrideImplementUtil.getContextClass(project,editor,file,false);
  if (aClass == null || aClass.isInterface())   return;
  LOG.assertTrue(aClass.isValid());
  LOG.assertTrue(aClass.getContainingFile() != null);
  try {
    final ClassMember[] members=chooseOriginalMembers(aClass,project,editor);
    if (members == null)     return;
    ApplicationManager.getApplication().runWriteAction(new Runnable(){
      @Override public void run(){
        doGenerate(project,editor,aClass,members);
      }
    }
);
  }
  finally {
    cleanup();
  }
}
