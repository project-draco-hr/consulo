{
  if (!matches(name,pair.first)) {
    return false;
  }
  final Pattern dirPattern=pair.second;
  if (dirPattern == null || parent == null) {
    return true;
  }
  String parentPath=parentRef.get();
  if (parentPath == null) {
    VirtualFile srcRoot=ProjectRootManager.getInstance(myProject).getFileIndex().getSourceRootForFile(parent);
    parentRef.set(parentPath=srcRoot == null ? parent.getPath() : VfsUtilCore.getRelativePath(parent,srcRoot,'/'));
  }
  return parentPath != null && matches("/" + parentPath,dirPattern);
}
