{
  List<PsiElement> cachedPackages=myDefaultPackageContent.get();
  if (cachedPackages == null) {
    final List<PsiElement> psiPackages=new ArrayList<PsiElement>();
    final PsiManager manager=position.getManager();
    final PsiPackage rootPackage=manager.findPackage("");
    if (rootPackage != null) {
      rootPackage.processDeclarations(new BaseScopeProcessor(){
        public boolean execute(        PsiElement element,        PsiSubstitutor substitutor){
          psiPackages.add(element);
          return true;
        }
      }
,PsiSubstitutor.EMPTY,position,position);
    }
    if (myPackagesEraser == null) {
      myPackagesEraser=new Runnable(){
        public void run(){
          myDefaultPackageContent=NULL_REFERENCE;
        }
      }
;
    }
    cachedPackages=psiPackages;
    ((PsiManagerEx)manager).registerWeakRunnableToRunOnChange(myPackagesEraser);
    myDefaultPackageContent=new SoftReference<List<PsiElement>>(cachedPackages);
  }
  return cachedPackages;
}
