{
  final JavaResolveResult[] result=_resolve(incompleteCode,(PsiReferenceExpressionImpl)ref);
  if (result.length > 0 && result[0].getElement() instanceof PsiClass) {
    final PsiType[] parameters=((PsiJavaCodeReferenceElement)ref).getTypeParameters();
    final JavaResolveResult[] newResult=new JavaResolveResult[result.length];
    for (int i=0; i < result.length; i++) {
      final CandidateInfo resolveResult=(CandidateInfo)result[i];
      newResult[i]=new CandidateInfo(resolveResult,resolveResult.getSubstitutor().putAll((PsiClass)resolveResult.getElement(),parameters));
    }
    return newResult;
  }
  return result;
}
