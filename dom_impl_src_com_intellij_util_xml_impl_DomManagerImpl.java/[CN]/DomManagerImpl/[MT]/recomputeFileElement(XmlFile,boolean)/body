{
  final DomFileElementImpl oldElement=getCachedFileElement(file);
  final DomFileElementImpl<DomElement> newElement=getFileElement(file);
  if (newElement == null) {
    return oldElement == null ? DomEvent.EMPTY_ARRAY : new DomEvent[]{new ElementUndefinedEvent(oldElement)};
  }
  if (oldElement == null)   return new DomEvent[]{new ElementDefinedEvent(newElement)};
  if (oldElement.equals(newElement))   return new DomEvent[]{new ElementChangedEvent(newElement)};
  return new DomEvent[]{new ElementUndefinedEvent(oldElement),new ElementDefinedEvent(newElement)};
}
