{
  final String normalizedPath=vfs.normalize(path);
  if (normalizedPath == null)   return null;
  final String basePath=vfs.extractRootPath(normalizedPath);
  NewVirtualFile file=ManagingFS.getInstance().findRoot(basePath,vfs);
  if (file == null || !file.exists())   return null;
  LOG.assertTrue(basePath.length() <= normalizedPath.length(),vfs + " failed to extract root path: " + basePath+ " from "+ normalizedPath);
  for (  String pathElement : StringUtil.tokenize(normalizedPath.substring(basePath.length()),FILE_SEPARATORS)) {
    if (pathElement.length() == 0 || ".".equals(pathElement))     continue;
    if ("..".equals(pathElement)) {
      file=file.getParent();
    }
 else {
      file=file.refreshAndFindChild(pathElement);
    }
    if (file == null)     return null;
  }
  return file;
}
