{
  final Set<VFilePropertyChangeEvent> list=new THashSet<VFilePropertyChangeEvent>();
  for (  VirtualFile file : files) {
    saveOrReload(file,list);
  }
  if (includeOpenFiles) {
    for (    VirtualFile open : FileEditorManager.getInstance(project).getOpenFiles()) {
      if (!files.contains(open)) {
        saveOrReload(open,list);
      }
    }
  }
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    public void run(){
      ApplicationManager.getApplication().getMessageBus().syncPublisher(VirtualFileManager.VFS_CHANGES).before(new ArrayList<VFileEvent>(list));
      ApplicationManager.getApplication().getMessageBus().syncPublisher(VirtualFileManager.VFS_CHANGES).after(new ArrayList<VFileEvent>(list));
    }
  }
);
}
