{
  final PsiExpression condition=statement.getCondition();
  final List possibleCaseExpressions=determinePossibleCaseExpressions(condition);
  if (possibleCaseExpressions == null) {
    return null;
  }
  for (Iterator iterator=possibleCaseExpressions.iterator(); iterator.hasNext(); ) {
    final PsiExpression caseExp=(PsiExpression)iterator.next();
    if (!SideEffectChecker.mayHaveSideEffects(caseExp)) {
      PsiIfStatement statementToCheck=statement;
      while (true) {
        final PsiExpression caseCondition=statementToCheck.getCondition();
        if (canBeMadeIntoCase(caseCondition,caseExp)) {
          final PsiStatement elseBranch=statementToCheck.getElseBranch();
          if (elseBranch == null || !(elseBranch instanceof PsiIfStatement)) {
            return caseExp;
          }
          statementToCheck=(PsiIfStatement)elseBranch;
        }
 else {
          break;
        }
      }
    }
  }
  return null;
}
