{
  String id=DEFAULT_STORAGE;
  final Module module=moduleRootManager.getModule();
  if (module.getOptionValue("test_storage") != null) {
    if (operation == Operation.WRITE || getTestStorageFile(module).exists())     id=TEST_STORAGE;
  }
  for (  Storage storage : storages) {
    if (storage.id().equals(id))     return storage;
  }
  throw new IllegalArgumentException();
}
