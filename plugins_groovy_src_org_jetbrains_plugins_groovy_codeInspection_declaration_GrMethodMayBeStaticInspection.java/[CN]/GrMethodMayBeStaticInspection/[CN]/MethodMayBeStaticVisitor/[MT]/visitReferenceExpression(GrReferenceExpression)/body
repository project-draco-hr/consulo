{
  GrExpression qualifier=referenceExpression.getQualifierExpression();
  if (qualifier == null || qualifier instanceof GrThisSuperReferenceExpression) {
    GroovyResolveResult result=referenceExpression.advancedResolve();
    PsiElement element=result.getElement();
    if (isPrintOrPrintln(element))     return;
    GroovyPsiElement resolveContext=result.getCurrentFileResolveContext();
    if (qualifier == null && resolveContext != null)     return;
    if (element instanceof PsiClass && ((PsiClass)element).getContainingClass() == null)     return;
    if (element instanceof PsiMember && !((PsiMember)element).hasModifierProperty(PsiModifier.STATIC)) {
      registerInstanceRefs();
    }
  }
 else {
    super.visitReferenceExpression(referenceExpression);
  }
}
