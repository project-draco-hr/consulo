{
  ApplicationManager.getApplication().assertIsDispatchThread();
  if (project != null && project.isDisposed())   return;
  if (CommandLog.LOG.isDebugEnabled()) {
    CommandLog.LOG.debug("executeCommand: " + command + ", name = "+ name+ ", groupId = "+ groupId);
  }
  if (myCurrentCommand != null) {
    command.run();
    return;
  }
  Throwable throwable=null;
  try {
    myCurrentCommand=new CommandDescriptor(command,project,name,groupId,undoConfirmationPolicy,document);
    fireCommandStarted();
    command.run();
  }
 catch (  Throwable th) {
    throwable=th;
  }
 finally {
    finishCommand(project,myCurrentCommand,throwable);
  }
}
