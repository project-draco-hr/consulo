{
  ApplicationManager.getApplication().assertIsDispatchThread();
  CommandDescriptor currentCommand=myCurrentCommand;
  CommandEvent event=new CommandEvent(this,currentCommand.myCommand,currentCommand.myName,currentCommand.myGroupId,currentCommand.myProject,currentCommand.myUndoConfirmationPolicy,currentCommand.myDocument);
  try {
    for (    CommandListener listener : myListeners) {
      try {
        listener.beforeCommandFinished(event);
      }
 catch (      Throwable e) {
        CommandLog.LOG.error(e);
      }
    }
  }
  finally {
    myCurrentCommand=null;
    for (    CommandListener listener : myListeners) {
      try {
        listener.commandFinished(event);
      }
 catch (      Throwable e) {
        CommandLog.LOG.error(e);
      }
    }
  }
}
