{
  CommandEvent event=new CommandEvent(this,myCurrentCommand.myCommand,myCurrentCommand.myName,myCurrentCommand.myGroupId,myCurrentCommand.myProject,myCurrentCommand.myUndoConfirmationPolicy,myCurrentCommand.myDocument);
  try {
    for (    CommandListener listener : myListeners) {
      try {
        listener.beforeCommandFinished(event);
      }
 catch (      Throwable e) {
        CommandLog.LOG.error(e);
      }
    }
  }
  finally {
    myCurrentCommand=null;
    for (    CommandListener listener : myListeners) {
      try {
        listener.commandFinished(event);
      }
 catch (      Throwable e) {
        CommandLog.LOG.error(e);
      }
    }
  }
}
