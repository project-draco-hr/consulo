{
  final Icon icon=p.getIcon();
  if (icon != null && (icon.getIconWidth() > myEmptyIcon.getIconWidth() || icon.getIconHeight() > myEmptyIcon.getIconHeight())) {
    myEmptyIcon=new EmptyIcon(Math.max(icon.getIconWidth(),myEmptyIcon.getIconWidth()),Math.max(icon.getIconHeight(),myEmptyIcon.getIconHeight()));
  }
  int maxWidth=Math.min(RealLookupElementPresentation.calculateWidth(p,myNormalMetrics,myBoldMetrics),myMaxWidth);
  return maxWidth + getCommonGapsWidth();
}
