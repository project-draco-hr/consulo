{
  if (myHighlightSettings.isEmpty())   throw new WriteExternalException();
  for (  Map.Entry<VirtualFile,FileHighlighingSetting[]> entry : myHighlightSettings.entrySet()) {
    final Element child=new Element("setting");
    final VirtualFile vFile=entry.getKey();
    if (!vFile.isValid())     continue;
    child.setAttribute("file",vFile.getUrl());
    for (int i=0; i < entry.getValue().length; i++) {
      final FileHighlighingSetting fileHighlighingSetting=entry.getValue()[i];
      child.setAttribute("root" + i,fileHighlighingSetting.toString());
    }
    element.addContent(child);
  }
  for (  Map.Entry<VirtualFile,Pair<String,Boolean>> entry : myProfileSettings.entrySet()) {
    final Pair<String,Boolean> value=entry.getValue();
    if (value != null) {
      final String name=value.first;
      final Element child=new Element("profiles");
      final VirtualFile vFile=entry.getKey();
      if (vFile == null || !vFile.isValid())       continue;
      child.setAttribute("file",vFile.getUrl());
      child.setAttribute("profile_name",name);
      child.setAttribute("is_active",value.second.toString());
      element.addContent(child);
    }
  }
}
