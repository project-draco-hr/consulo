{
  if (!initialState.equals(ModalityState.current())) {
    return;
  }
  final String edtTrace=ThreadDumper.dumpEdtStackTrace();
  if (edtTrace.contains("java.lang.ClassLoader.loadClass")) {
    return;
  }
  final boolean isInDumbMode=project != null && !project.isDisposed() && DumbService.isDumb(project);
  final String dumps=ThreadDumper.dumpThreadsToString();
  final String msg="Typing freeze report, (DumbMode=" + isInDumbMode + ") thread dumps attached. EDT stacktrace:\n"+ edtTrace+ "\n\n\n";
  LOG.error(msg,dumps);
}
