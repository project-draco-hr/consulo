{
  Object[] kids=(Object[])structure.getChildElements(node);
  for (int i=0; i < kids.length; i++) {
    ProjectViewNode kid=(ProjectViewNode)kids[i];
    final VirtualFile[] files=getFiles(kid);
    for (int j=0; j < files.length; j++) {
      VirtualFile vFile=files[j];
      map.put(vFile,kid);
      ProjectViewNode eachParent=(ProjectViewNode)kid.getParent();
      while (eachParent != null) {
        map.put(vFile,eachParent);
        eachParent=(ProjectViewNode)eachParent.getParent();
      }
    }
    collect(kid,map,structure);
  }
}
