{
  super(project,false);
  myProject=project;
  mySelector=selector;
  setTitle(title);
  myTree=new SimpleTree();
  myTree.getSelectionModel().setSelectionMode(TreeSelectionModel.SINGLE_TREE_SELECTION);
  MavenProjectsStructure treeStructure=new MavenProjectsStructure(myProject,MavenProjectsManager.getInstance(myProject),MavenTasksManager.getInstance(myProject),MavenProjectsNavigator.getInstance(myProject),myTree){
    @Override protected Class<? extends CustomNode>[] getVisibleNodesClasses(){
      return new Class[]{nodeClass};
    }
  }
;
  SimpleTreeBuilder treeBuilder=new SimpleTreeBuilder(myTree,(DefaultTreeModel)myTree.getModel(),treeStructure,null);
  treeBuilder.initRoot();
  Disposer.register(myProject,treeBuilder);
  treeStructure.buildTree();
  final SimpleNode[] selection=new SimpleNode[]{null};
  treeStructure.getRootElement().accept(new SimpleNodeVisitor(){
    public boolean accept(    SimpleNode each){
      if (!mySelector.shouldSelect(each))       return true;
      selection[0]=each;
      return false;
    }
  }
);
  treeBuilder.updateFromRoot(true);
  myTree.expandPath(new TreePath(myTree.getModel().getRoot()));
  if (selection[0] != null) {
    treeStructure.select(selection[0]);
  }
  init();
}
