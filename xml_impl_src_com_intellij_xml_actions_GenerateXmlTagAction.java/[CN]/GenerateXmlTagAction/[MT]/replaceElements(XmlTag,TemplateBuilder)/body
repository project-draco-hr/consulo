{
  for (  XmlTag tag : newTag.getSubTags()) {
    if ("<".equals(tag.getText())) {
      builder.replaceElement(tag,TextRange.from(1,0),new MacroCallNode(new CompleteSmartMacro()));
    }
 else     if (tag.getSubTags().length > 0) {
      replaceElements(tag,builder);
    }
 else {
      for (      XmlAttribute attribute : tag.getAttributes()) {
        builder.replaceElement(attribute.getValueElement(),new MacroCallNode(new CompleteMacro()));
      }
      int i=tag.getText().indexOf("></");
      if (i > 0) {
        builder.replaceElement(tag,TextRange.from(i + 1,0),new MacroCallNode(new CompleteMacro()));
      }
    }
  }
}
