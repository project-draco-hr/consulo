{
  File dir=createTempDirectory();
  File projectFile=new File(dir,"project.ipr");
  Project p=ProjectManagerEx.getInstanceEx().newProject(projectFile.getPath(),false,false);
  ((StartupManagerImpl)StartupManager.getInstance(p)).runStartupActivities();
  ModifiableModuleModel model=ModuleManager.getInstance(p).getModifiableModel();
  Module m=model.newModule(new File(dir,"module.iml").getPath(),ModuleType.JAVA);
  model.commit();
  VirtualFile root=addContentRoot(m);
  p.save();
  Disposer.dispose(p);
  VirtualFile f=root.createChildData(null,"file.java");
  p=ProjectManagerEx.getInstanceEx().loadAndOpenProject(projectFile.getPath());
  ((StartupManagerImpl)StartupManager.getInstance(p)).runStartupActivities();
  ILocalVcs vcs=LocalVcsComponent.getLocalVcsFor(p);
  boolean result=vcs.hasEntry(f.getPath());
  Disposer.dispose(p);
  assertTrue(result);
}
