{
  if (offset < getTextRange().getStartOffset())   return 0;
  if (offset >= getTextRange().getEndOffset())   return getTextRange().getEndOffset() - getTextRange().getStartOffset();
  return offset - getTextRange().getStartOffset() + getPrefix().length();
}
