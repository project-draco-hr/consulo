{
  if (offset < getTextRange().getStartOffset())   return getPrefix().length();
  if (offset >= getTextRange().getEndOffset())   return getTextRange().getEndOffset() - getTextRange().getStartOffset() + getPrefix().length();
  return offset - getTextRange().getStartOffset() + getPrefix().length();
}
