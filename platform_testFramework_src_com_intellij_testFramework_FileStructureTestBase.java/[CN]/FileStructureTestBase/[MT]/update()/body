{
  myPopup.getTreeBuilder().refilter().doWhenProcessed(new Runnable(){
    @Override public void run(){
      getStructure().rebuild();
      updateTree();
      TreeUtil.expandAll(getTree());
      final FilteringTreeStructure.FilteringNode node=myPopup.selectPsiElement(myPopup.getCurrentElement(getFile()));
      getTree().getSelectionModel().setSelectionPath(getTree().getPath(node));
    }
  }
);
}
