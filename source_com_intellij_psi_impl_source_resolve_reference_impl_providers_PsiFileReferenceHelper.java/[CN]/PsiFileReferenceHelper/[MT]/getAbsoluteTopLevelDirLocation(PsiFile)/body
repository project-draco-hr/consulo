{
  final VirtualFile virtualFile=file.getVirtualFile();
  if (virtualFile != null) {
    final ProjectFileIndex index=ProjectRootManager.getInstance(file.getProject()).getFileIndex();
    VirtualFile contentRootForFile=index.getSourceRootForFile(virtualFile);
    if (contentRootForFile == null)     contentRootForFile=index.getContentRootForFile(virtualFile);
    if (contentRootForFile != null) {
      return file.getManager().findDirectory(contentRootForFile);
    }
  }
  return null;
}
