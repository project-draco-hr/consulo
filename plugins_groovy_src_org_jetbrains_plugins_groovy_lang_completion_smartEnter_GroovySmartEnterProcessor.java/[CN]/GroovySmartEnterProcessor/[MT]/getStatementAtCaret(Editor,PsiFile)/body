{
  final PsiElement atCaret=super.getStatementAtCaret(editor,psiFile);
  if (atCaret instanceof PsiWhiteSpace)   return null;
  if (atCaret == null)   return null;
  PsiElement statementAtCaret=PsiTreeUtil.getParentOfType(atCaret,GrStatement.class,GrCodeBlock.class,PsiMember.class,GrDocComment.class);
  if (statementAtCaret instanceof GrBlockStatement)   return null;
  if (statementAtCaret == null)   return null;
  GrIfStatement ifStatement=PsiTreeUtil.getParentOfType(statementAtCaret,GrIfStatement.class);
  GrForStatement forStatement=PsiTreeUtil.getParentOfType(statementAtCaret,GrForStatement.class);
  GrWhileStatement whileStatement=PsiTreeUtil.getParentOfType(statementAtCaret,GrWhileStatement.class);
  if (ifStatement != null && !PsiTreeUtil.hasErrorElements(statementAtCaret)) {
    return ifStatement;
  }
  if (forStatement != null && !PsiTreeUtil.hasErrorElements(statementAtCaret)) {
    return forStatement;
  }
  if (whileStatement != null && !PsiTreeUtil.hasErrorElements(statementAtCaret)) {
    return whileStatement;
  }
  return statementAtCaret instanceof GrStatement || statementAtCaret instanceof GrMember ? statementAtCaret : null;
}
