{
  PsiElement parent=atCaret.getParent();
  if (parent instanceof GrCodeBlock) {
    final GrCodeBlock block=(GrCodeBlock)parent;
    if (block.getStatements().length > 0 && block.getStatements()[0] == atCaret) {
      atCaret=block;
    }
  }
 else   if (parent instanceof GrForStatement || parent instanceof GrSwitchStatement) {
    atCaret=parent;
  }
  super.reformat(atCaret);
}
