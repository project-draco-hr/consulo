{
  res.add(0,atCaret);
  if (doNotStepInto(atCaret)) {
    if (!recurse)     return;
    recurse=false;
  }
  PsiElement parent=atCaret.getParent();
  if (atCaret instanceof GrClosableBlock && parent instanceof GrString) {
    res.add(parent);
  }
  if (parent instanceof GrArgumentList) {
    res.add(parent.getParent());
  }
  final PsiElement[] children=getChildren(atCaret);
  for (  PsiElement child : children) {
    if (atCaret instanceof GrStatement && child instanceof GrStatement)     continue;
    collectAllElements(child,res,recurse);
  }
}
