{
  if (element == myRoot) {
    final List<Object> children=new ArrayList<Object>();
    for (    final ErrorTreeElementKind kind : ourMessagesOrder) {
      if (ErrorTreeElementKind.WARNING.equals(kind) || ErrorTreeElementKind.NOTE.equals(kind)) {
        if (myCanHideWarnings && ErrorTreeViewConfiguration.getInstance(myProject).isHideWarnings()) {
          continue;
        }
      }
      final List<ErrorTreeElement> elems=mySimpleMessages.get(kind);
      if (elems != null) {
        children.addAll(elems);
      }
    }
    for (    final String myGroupName : myGroupNames) {
      final GroupingElement groupingElement=myGroupNameToElementMap.get(myGroupName);
      if (shouldShowFileElement(groupingElement)) {
        children.add(groupingElement);
      }
    }
    return ArrayUtil.toObjectArray(children);
  }
 else   if (element instanceof GroupingElement) {
synchronized (myGroupNameToMessagesMap) {
      final List<NavigatableMessageElement> children=myGroupNameToMessagesMap.get(((GroupingElement)element).getName());
      if (children != null && children.size() > 0) {
        if (myCanHideWarnings && ErrorTreeViewConfiguration.getInstance(myProject).isHideWarnings()) {
          final List<NavigatableMessageElement> filtered=new ArrayList<NavigatableMessageElement>(children.size());
          for (          final NavigatableMessageElement navigatableMessageElement : children) {
            ErrorTreeElementKind kind=navigatableMessageElement.getKind();
            if (ErrorTreeElementKind.WARNING.equals(kind) || ErrorTreeElementKind.NOTE.equals(kind)) {
              continue;
            }
            filtered.add(navigatableMessageElement);
          }
          return filtered.toArray();
        }
        return children.toArray();
      }
    }
  }
  return ArrayUtil.EMPTY_OBJECT_ARRAY;
}
