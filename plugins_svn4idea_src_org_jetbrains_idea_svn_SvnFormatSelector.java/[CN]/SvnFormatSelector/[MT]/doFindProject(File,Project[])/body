{
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    public void run(){
      Project[] projects=ProjectManager.getInstance().getOpenProjects();
      String filePath=path.getAbsoluteFile().getAbsolutePath().replace(File.separatorChar,'/');
      for (      Project project : projects) {
        VirtualFile[] roots=ProjectRootManager.getInstance(project).getContentRoots();
        for (        VirtualFile root : roots) {
          String rootPath=root.getPath();
          if (rootPath != null && (filePath.equals(rootPath) || filePath.startsWith(rootPath + '/'))) {
            p[0]=project;
            return;
          }
        }
      }
      p[0]=ProjectManager.getInstance().getDefaultProject();
    }
  }
);
}
