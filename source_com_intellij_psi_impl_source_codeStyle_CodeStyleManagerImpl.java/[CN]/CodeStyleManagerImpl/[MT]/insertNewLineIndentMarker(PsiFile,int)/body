{
  CheckUtil.checkWritable(file);
  final CharTable charTable=((FileElement)SourceTreeToPsiMap.psiElementToTree(file)).getCharTable();
  PsiElement elementAt=file.findElementAt(offset);
  if (elementAt == null)   return null;
  TreeElement element=SourceTreeToPsiMap.psiElementToTree(elementAt);
  ASTNode parent=element.getTreeParent();
  int elementStart=element.getTextRange().getStartOffset();
  if (element.getElementType() != ElementType.WHITE_SPACE) {
    return null;
  }
  ASTNode space1=Helper.splitSpaceElement(element,offset - elementStart,charTable);
  TreeElement marker=Factory.createSingleLeafElement(ElementType.NEW_LINE_INDENT,"###".toCharArray(),0,"###".length(),charTable,null);
  parent.addChild(marker,(TreeElement)space1.getTreeNext());
  return SourceTreeToPsiMap.treeElementToPsi(marker);
}
