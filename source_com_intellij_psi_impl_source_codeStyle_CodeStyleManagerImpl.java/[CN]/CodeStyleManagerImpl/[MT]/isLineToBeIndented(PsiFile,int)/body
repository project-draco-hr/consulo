{
  if (!SourceTreeToPsiMap.hasTreeElement(file))   return false;
  Helper helper=new Helper(file.getFileType(),myProject);
  char[] chars=file.textToCharArray();
  int start=CharArrayUtil.shiftBackward(chars,offset - 1," \t");
  if (start > 0 && chars[start] != '\n' && chars[start] != '\r')   return false;
  int end=CharArrayUtil.shiftForward(chars,offset," \t");
  if (end >= chars.length)   return false;
  ASTNode element=SourceTreeToPsiMap.psiElementToTree(file.findElementAt(end));
  if (element == null)   return false;
  if (element.getElementType() == ElementType.WHITE_SPACE)   return false;
  if (element.getElementType() == ElementType.PLAIN_TEXT)   return false;
  if (element.getElementType() instanceof IJspElementType)   return false;
  if (getSettings().KEEP_FIRST_COLUMN_COMMENT && (element.getElementType() == ElementType.END_OF_LINE_COMMENT || element.getElementType() == ElementType.C_STYLE_COMMENT)) {
    if (helper.getIndent(element,true) == 0)     return false;
  }
  return true;
}
