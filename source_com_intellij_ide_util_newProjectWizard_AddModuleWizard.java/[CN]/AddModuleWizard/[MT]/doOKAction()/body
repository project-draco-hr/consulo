{
  int idx=getCurrentStep();
  try {
    do {
      final ModuleWizardStep step=mySteps.get(idx);
      step.updateStep();
      if (!step.validate()) {
        return;
      }
      if (!commitStepData(step)) {
        return;
      }
      step.onStepLeaving();
      try {
        step._commit(true);
      }
 catch (      CommitStepException e) {
        Messages.showErrorDialog(getCurrentStepComponent(),e.getMessage());
        return;
      }
      if (!validateDataOnClose()) {
        return;
      }
      if (!isLastStep(idx)) {
        idx=getNextStep(idx);
      }
 else {
        break;
      }
    }
 while (true);
  }
 catch (  ConfigurationException e) {
    Messages.showErrorDialog(myCurrentProject,e.getMessage(),e.getTitle());
  }
 finally {
    myCurrentStep=idx;
    updateStep();
  }
  super.doOKAction();
}
