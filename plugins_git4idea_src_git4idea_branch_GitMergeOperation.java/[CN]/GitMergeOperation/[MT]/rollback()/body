{
  Collection<GitRepository> repositoriesForSmartRollback=new ArrayList<GitRepository>();
  Collection<GitRepository> repositoriesForSimpleRollback=new ArrayList<GitRepository>();
  for (  GitRepository repository : getSuccessfulRepositories()) {
    if (thereAreLocalChangesIn(repository)) {
      repositoriesForSmartRollback.add(repository);
    }
 else {
      repositoriesForSimpleRollback.add(repository);
    }
  }
  GitCompoundResult result=smartRollback(repositoriesForSmartRollback);
  for (  GitRepository repository : repositoriesForSimpleRollback) {
    result.append(repository,rollback(repository));
  }
  if (!result.totalSuccess()) {
    NotificationManager.getInstance(myProject).notifyError("Error during rollback",result.getErrorOutputWithReposIndication());
  }
}
