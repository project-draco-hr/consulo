{
  boolean flattenPackages=true;
  TestProxy classNode;
  if (flattenPackages) {
    classNode=getPackageClassNodeFor(result);
  }
 else {
    classNode=getClassNodeFor(result);
  }
  TestProxy proxy=new TestProxy();
  proxy.setParent(classNode);
  proxy.setResultMessage(result);
  started.put(result,proxy);
  animator.setCurrentTestCase(proxy);
  treeBuilder.addItem(classNode,proxy);
  treeBuilder.repaintWithParents(proxy);
  count++;
  if (count > total)   total=count;
  if (TestNGConsoleProperties.TRACK_RUNNING_TEST.value(myProperties)) {
    selectTest(proxy);
  }
  return proxy;
}
