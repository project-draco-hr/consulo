{
  final GradleProjectStructureHelper projectStructureHelper=ServiceManager.getService(ideProject,GradleProjectStructureHelper.class);
  for (  GradleModule gradleModule : gradleProject.getModules()) {
    final Module ideModule=projectStructureHelper.findIdeModule(gradleModule);
    if (ideModule == null) {
      continue;
    }
    GradleEntityVisitor visitor=new GradleEntityVisitorAdapter(){
      @Override public void visit(      @NotNull GradleLibraryDependency gradleDependency){
        GradleLibraryDependencyId id=GradleEntityIdMapper.mapEntityToId(gradleDependency);
        LibraryOrderEntry ideDependency=projectStructureHelper.findIdeModuleLocalLibraryDependency(id.getOwnerModuleName(),id.getDependencyName());
        if (ideDependency == null) {
          return;
        }
        myDependencyManager.removeDependency(ideDependency,true);
        ideDependency=projectStructureHelper.findIdeLibraryDependency(id);
        if (ideDependency == null) {
          myDependencyManager.importDependency(gradleDependency,ideModule,true);
        }
        GradleLibrary gradleLibrary=gradleDependency.getTarget();
        Library ideLibrary=projectStructureHelper.findIdeLibrary(gradleLibrary);
        if (ideLibrary == null) {
          myLibraryManager.importLibrary(gradleLibrary,ideProject,true);
        }
 else {
          myLibraryManager.syncPaths(gradleLibrary,ideLibrary,ideProject,true);
        }
      }
    }
;
    for (    GradleDependency dependency : gradleModule.getDependencies()) {
      dependency.invite(visitor);
    }
  }
  return gradleProject;
}
