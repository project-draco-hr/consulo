{
  final VirtualFile file=getSelectedFile();
  final Project project=getProject();
  if (file == null || project == null || isDisposed() || !project.isOpen() || project.isDisposed() || myStatusBar == null) {
    return;
  }
  String currentBranchName=null;
  final AbstractVcs vcs=myVcsManager.getVcsFor(file);
  if (vcs != null && vcs instanceof GitVcs) {
    final VirtualFile root=myVcsManager.getVcsRootFor(file);
    if (root != null) {
      final GitBranch currentBranch=myCurrentBranches.get(root);
      if (currentBranch != null) {
        currentBranchName=currentBranch.getName();
      }
    }
  }
  if (currentBranchName == null) {
    currentBranchName="";
  }
  myCurrentBranchName.set(currentBranchName);
  myStatusBar.updateWidget(ID());
}
