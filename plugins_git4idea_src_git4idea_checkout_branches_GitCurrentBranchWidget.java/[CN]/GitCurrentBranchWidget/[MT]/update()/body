{
  String currentBranchName=null;
  final VirtualFile file=getSelectedFile();
  if (file != null) {
    AbstractVcs vcs=myVcsManager.getVcsFor(file);
    if (vcs != null && vcs instanceof GitVcs) {
      VirtualFile root=myVcsManager.getVcsRootFor(file);
      if (root != null) {
        GitBranch currentBranch=null;
        try {
          currentBranch=GitBranch.current(getProject(),root);
        }
 catch (        VcsException e) {
          LOG.info("Exception while trying to get current branch for file " + file + " under root "+ root,e);
        }
        currentBranchName=currentBranch != null ? currentBranch.getName() : null;
      }
    }
  }
  if (currentBranchName == null) {
    currentBranchName="";
  }
  myCurrentBranchName.set(currentBranchName);
  myStatusBar.updateWidget(ID());
}
