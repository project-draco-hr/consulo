{
  LOG.assertTrue(myTargetParameter.getDeclarationScope() == myMethod);
  final PsiManager manager=myMethod.getManager();
  final Project project=manager.getProject();
  PsiSearchHelper searchHelper=manager.getSearchHelper();
  final PsiReference[] methodReferences=searchHelper.findReferences(myMethod,GlobalSearchScope.projectScope(project),false);
  List<UsageInfo> result=new ArrayList<UsageInfo>();
  for (int i=0; i < methodReferences.length; i++) {
    final PsiReference ref=methodReferences[i];
    if (ref.getElement() instanceof PsiReferenceExpression) {
      if (ref.getElement().getParent() instanceof PsiMethodCallExpression) {
        result.add(new MethodCallUsageInfo((PsiMethodCallExpression)ref.getElement().getParent()));
      }
    }
 else     if (ref.getElement() instanceof PsiDocTagValue) {
      result.add(new JavaDocUsageInfo(ref));
    }
  }
  PsiReference[] parameterReferences=searchHelper.findReferences(myTargetParameter,new LocalSearchScope(myMethod),false);
  for (int i=0; i < parameterReferences.length; i++) {
    final PsiReference ref=parameterReferences[i];
    if (ref.getElement() instanceof PsiReferenceExpression) {
      result.add(new ParameterUsageInfo((PsiReferenceExpression)ref));
    }
  }
  if (myTargetClass.isInterface()) {
    PsiClass[] implementingClasses=RefactoringHierarchyUtil.findImplementingClasses(myTargetClass);
    for (int i=0; i < implementingClasses.length; i++) {
      final PsiClass implementingClass=implementingClasses[i];
      result.add(new ImplementingClassUsageInfo(implementingClass));
    }
  }
  return result.toArray(new UsageInfo[result.size()]);
}
