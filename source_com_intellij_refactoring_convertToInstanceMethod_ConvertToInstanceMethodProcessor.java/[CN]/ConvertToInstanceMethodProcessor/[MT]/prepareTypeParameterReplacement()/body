{
  if (myTypeParameterReplacements == null)   return;
  final Collection<PsiTypeParameter> typeParameters=myTypeParameterReplacements.keySet();
  for (Iterator<PsiTypeParameter> iterator=typeParameters.iterator(); iterator.hasNext(); ) {
    final PsiTypeParameter parameter=iterator.next();
    final PsiReference[] references=myMethod.getManager().getSearchHelper().findReferences(parameter,new LocalSearchScope(myMethod),false);
    for (int i=0; i < references.length; i++) {
      final PsiReference reference=references[i];
      if (reference.getElement() instanceof PsiJavaCodeReferenceElement) {
        reference.getElement().putCopyableUserData(BIND_TO_TYPE_PARAMETER,myTypeParameterReplacements.get(parameter));
      }
    }
  }
  final Set<PsiTypeParameter> methodTypeParameters=myTypeParameterReplacements.keySet();
  for (Iterator<PsiTypeParameter> iterator=methodTypeParameters.iterator(); iterator.hasNext(); ) {
    final PsiTypeParameter methodTypeParameter=iterator.next();
    methodTypeParameter.delete();
  }
}
