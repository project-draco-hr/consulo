{
  CaretModel caretModel=editor.getCaretModel();
  int line=currentVisual.line;
  int column=0;
  if (currentVisual.column == 0) {
    line--;
    int nonSpaceColumn=findFirstNonSpaceColumnOnTheLine(editor,line);
    column=nonSpaceColumn >= 0 ? nonSpaceColumn : 0;
  }
 else {
    int nonSpaceColumn=findFirstNonSpaceColumnOnTheLine(editor,currentVisual.line);
    if (nonSpaceColumn > 0 && nonSpaceColumn != currentVisual.column) {
      column=nonSpaceColumn;
    }
  }
  caretModel.moveToVisualPosition(new VisualPosition(line,column));
}
