{
  GrVariable var=null;
  if (element instanceof GrVariable) {
    var=(GrVariable)element;
  }
 else   if (element instanceof GrReferenceExpression) {
    final PsiElement resolved=((GrReferenceExpression)element).resolve();
    if (resolved instanceof GrVariable)     var=(GrVariable)resolved;
  }
  if (var != null) {
    final GroovyPsiElement scope=ControlFlowUtils.findControlFlowOwner(var);
    if (scope == null) {
      PsiFile file=var.getContainingFile();
      LOG.error(file == null ? "no file??? var of type" + var.getClass().getCanonicalName() : DebugUtil.psiToString(file,true,false));
    }
    return ReferencesSearch.search(var,new LocalSearchScope(scope)).forEach(new Processor<PsiReference>(){
      public boolean process(      PsiReference ref){
        return ControlFlowUtils.findControlFlowOwner(ref.getElement()) == scope;
      }
    }
);
  }
  return true;
}
