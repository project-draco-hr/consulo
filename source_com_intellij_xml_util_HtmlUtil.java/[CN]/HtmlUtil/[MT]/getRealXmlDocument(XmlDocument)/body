{
  if (doc == null)   return null;
  final PsiFile containingFile=doc.getContainingFile();
  if (PsiUtil.isInJspFile(containingFile)) {
    final JspFile jspFile=PsiUtil.getJspFile(containingFile);
    if (jspFile != null) {
      final PsiFile baseLanguageRoot=jspFile.getBaseLanguageRoot();
      final PsiElement[] children=baseLanguageRoot.getChildren();
      for (      PsiElement child : children) {
        if (child instanceof XmlDocument) {
          doc=(XmlDocument)child;
          break;
        }
      }
    }
  }
  return doc;
}
