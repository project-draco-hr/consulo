{
  final PsiFile containingFile=doc.getContainingFile();
  if (PsiUtil.isInJspFile(containingFile)) {
    final PsiFile baseLanguageRoot=(PsiUtil.getJspFile(containingFile)).getBaseLanguageRoot();
    final PsiElement[] children=baseLanguageRoot.getChildren();
    for (int i=0; i < children.length; i++) {
      PsiElement child=children[i];
      if (child instanceof XmlDocument) {
        doc=(XmlDocument)child;
        break;
      }
    }
  }
  return doc;
}
