{
synchronized (myLock) {
    final HashSet<String> keys=new HashSet<String>(myData.keySet());
    for (    String key : keys) {
      final Pair<VcsRoot,VcsRevisionNumber> value=myData.get(key);
      final VcsRoot storedVcsRoot=value.getFirst();
      final VirtualFile vf=myLfs.refreshAndFindFileByIoFile(new File(key));
      final AbstractVcs newVcs=(vf == null) ? null : myVcsManager.getVcsFor(vf);
      if (newVcs == null) {
        myData.remove(key);
        getQueue(storedVcsRoot).forceRemove(key);
      }
 else {
        final VirtualFile newRoot=myVcsManager.getVcsRootFor(vf);
        final VcsRoot newVcsRoot=new VcsRoot(newVcs,newRoot);
        if (!storedVcsRoot.equals(newVcsRoot)) {
          switchVcs(storedVcsRoot,newVcsRoot,key);
        }
      }
    }
  }
}
