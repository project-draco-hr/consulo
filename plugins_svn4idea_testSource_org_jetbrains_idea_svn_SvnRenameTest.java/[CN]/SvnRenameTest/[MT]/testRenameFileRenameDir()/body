{
  final VirtualFile child=prepareDirectoriesForRename();
  final VirtualFile f=child.findChild("a.txt");
  renameFileInCommand(f,"anew.txt");
  renameFileInCommand(child,"newchild");
  verifySorted(runSvn("status"),"A + newchild","A + newchild\\anew.txt","D + newchild\\a.txt","D child","D child\\a.txt");
  final ChangeListManager changeListManager=ChangeListManager.getInstance(myProject);
  LocalFileSystem.getInstance().refresh(false);
  changeListManager.ensureUpToDate(false);
  final List<Change> changes=new ArrayList<Change>(changeListManager.getDefaultChangeList().getChanges());
  final List<VcsException> list=SvnVcs.getInstance(myProject).getCheckinEnvironment().commit(changes,"test");
  Assert.assertEquals(0,list.size());
}
