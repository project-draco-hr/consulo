{
  final TestDialog oldTestDialog=Messages.setTestDialog(TestDialog.OK);
  try {
    enableSilentOperation(VcsConfiguration.StandardConfirmation.ADD);
    final VirtualFile file=createFileInCommand(myWorkingCopyDir,"a.txt","A");
    checkin();
    renameFileInCommand(file,"b.txt");
    undo();
    Assert.assertTrue(new File(myWorkingCopyDir.getPath(),"a.txt").exists());
    Assert.assertFalse(new File(myWorkingCopyDir.getPath(),"b.txt").exists());
  }
  finally {
    Messages.setTestDialog(oldTestDialog);
  }
}
