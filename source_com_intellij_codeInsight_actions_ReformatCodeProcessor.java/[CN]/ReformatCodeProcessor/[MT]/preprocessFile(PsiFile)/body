{
  return new Runnable(){
    public void run(){
      try {
        PsiFile copy=(PsiFile)file.copy();
        Document doc=PsiDocumentManager.getInstance(myProject).getDocument(file);
        if (myRange == null) {
          CodeStyleManager.getInstance(myProject).reformat(copy);
        }
 else {
          CodeStyleManager.getInstance(myProject).reformatRange(copy,myRange.getStartOffset(),myRange.getEndOffset());
        }
        doc.replaceString(0,doc.getTextLength(),copy.getText());
      }
 catch (      IncorrectOperationException e) {
        LOG.error(e);
      }
    }
  }
;
}
