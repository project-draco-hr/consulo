def respond(self, status, type=None, filename=None, length=0):
    if (self._start_response is not None):
        self.httphdr(type, filename, length)
        if (not self.headers):
            raise RuntimeError('request.write called before headers sent')
        for (k, v) in self.headers:
            if (not isinstance(v, str)):
                raise TypeError(('header value must be string: %r' % v))
        if isinstance(status, ErrorResponse):
            self.header(status.headers)
            status = statusmessage(status.code, status.message)
        elif (status == 200):
            status = '200 Script output follows'
        elif isinstance(status, int):
            status = statusmessage(status)
        self.server_write = self._start_response(status, self.headers)
        self._start_response = None
        self.headers = []
