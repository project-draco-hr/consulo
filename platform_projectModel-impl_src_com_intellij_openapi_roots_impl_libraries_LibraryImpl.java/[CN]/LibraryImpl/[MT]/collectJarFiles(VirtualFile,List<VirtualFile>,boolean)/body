{
  VfsUtilCore.visitChildrenRecursively(dir,new VirtualFileVisitor(SKIP_ROOT,(recursively ? null : ONE_LEVEL_DEEP)){
    @Override public boolean visitFile(    @NotNull VirtualFile file){
      if (file.getFileType() instanceof ArchiveFileType) {
        final VirtualFile jarRoot=((ArchiveFileType)file.getFileType()).getFileSystem().findByPathWithSeparator(file);
        if (jarRoot != null) {
          container.add(jarRoot);
          return false;
        }
      }
      return true;
    }
  }
);
}
