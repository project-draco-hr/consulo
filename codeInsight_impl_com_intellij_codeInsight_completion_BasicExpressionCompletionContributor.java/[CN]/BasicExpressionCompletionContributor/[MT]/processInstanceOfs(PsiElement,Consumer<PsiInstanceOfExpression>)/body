{
  PsiElement scope=position.getParent();
  PsiElement lastParent=position;
  while (scope != null && !(scope instanceof PsiFile)) {
    if (scope instanceof PsiIfStatement) {
      final PsiIfStatement statement=(PsiIfStatement)scope;
      final PsiExpression condition=statement.getCondition();
      if (lastParent != condition && condition instanceof PsiInstanceOfExpression) {
        instanceofConsumer.consume((PsiInstanceOfExpression)condition);
      }
    }
 else     if (scope instanceof PsiConditionalExpression) {
      final PsiConditionalExpression expression=(PsiConditionalExpression)scope;
      final PsiExpression condition=expression.getCondition();
      if (lastParent != condition && condition instanceof PsiInstanceOfExpression) {
        instanceofConsumer.consume((PsiInstanceOfExpression)condition);
      }
    }
    lastParent=scope;
    scope=scope.getContext();
  }
}
