{
  super.visitErrorElement(element);
  for (  final HighlightErrorFilter errorFilter : errorFilters) {
    if (!errorFilter.shouldHighlightErrorElement(element))     return;
  }
  CommonProblemDescriptor descriptor;
  final TextRange textRange=element.getTextRange();
  if (textRange.getLength() > 0) {
    descriptor=manager.createProblemDescriptor(element,element.getErrorDescription(),ProblemHighlightType.ERROR,null);
  }
 else {
    PsiElement parent=element;
    while (true) {
      parent=parent.getParent();
      if (parent == null)       break;
      TextRange r=parent.getTextRange();
      if (r == null)       return;
      if (r.getLength() > 0) {
        break;
      }
    }
    if (parent == null)     return;
    int offset=element.getTextRange().getStartOffset() - parent.getTextRange().getStartOffset();
    descriptor=manager.createProblemDescriptor(parent,new TextRange(offset,offset + 1),element.getErrorDescription() + " #loc",ProblemHighlightType.ERROR);
  }
  PsiFile elementFile=element.getContainingFile();
  RefElement refElement=globalContext.getRefManager().getReference(elementFile);
  if (refElement == null) {
    PsiElement context=elementFile.getContext();
    if (context != null)     refElement=globalContext.getRefManager().getReference(context.getContainingFile());
  }
  problemDescriptionsProcessor.addProblemElement(refElement,descriptor);
}
