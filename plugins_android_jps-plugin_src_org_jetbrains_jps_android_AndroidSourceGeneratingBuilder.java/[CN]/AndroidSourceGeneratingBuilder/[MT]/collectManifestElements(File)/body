{
  final InputStream inputStream=new BufferedInputStream(new FileInputStream(manifestFile));
  try {
    final Set<ResourceEntry> result=new HashSet<ResourceEntry>();
    FormsParsing.parse(inputStream,new FormsParsing.IXMLBuilderAdapter(){
      String myLastName;
      @Override public void startElement(      String name,      String nsPrefix,      String nsURI,      String systemID,      int lineNr) throws Exception {
        myLastName=null;
      }
      @Override public void addAttribute(      String key,      String nsPrefix,      String nsURI,      String value,      String type) throws Exception {
        if (value != null && NAME_ATTRIBUTE.equals(key)) {
          myLastName=value;
        }
      }
      @Override public void elementAttributesProcessed(      String name,      String nsPrefix,      String nsURI) throws Exception {
        if (myLastName != null && PERMISSION_TAG.equals(name) || PERMISSION_GROUP_TAG.equals(name)) {
          result.add(new ResourceEntry(name,myLastName));
        }
      }
    }
);
    return result;
  }
  finally {
    inputStream.close();
  }
}
