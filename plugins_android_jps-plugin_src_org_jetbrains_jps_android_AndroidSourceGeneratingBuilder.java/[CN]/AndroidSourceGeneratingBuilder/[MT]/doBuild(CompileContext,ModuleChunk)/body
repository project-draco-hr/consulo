{
  final Map<File,AndroidFacet> idlFilesToCompile=new HashMap<File,AndroidFacet>();
  final Map<File,AndroidFacet> rsFilesToCompile=new HashMap<File,AndroidFacet>();
  final Set<Module> modules=new HashSet<Module>();
  context.processFilesToRecompile(chunk,new FileProcessor(){
    @Override public boolean apply(    Module module,    File file,    String sourceRoot) throws IOException {
      final AndroidFacet facet=getFacet(module);
      if (facet == null) {
        return true;
      }
      final String ext=FileUtil.getExtension(file.getName());
      if (AIDL_EXTENSION.equals(ext)) {
        idlFilesToCompile.put(file,facet);
        modules.add(facet.getModule());
      }
 else       if (RENDERSCRIPT_EXTENSION.equals(ext)) {
        rsFilesToCompile.put(file,facet);
        modules.add(facet.getModule());
      }
      return true;
    }
  }
);
  final Map<Module,MyModuleData> moduleDataMap=computeModuleDatas(modules,context);
  if (moduleDataMap == null) {
    return ExitCode.OK;
  }
  if (!runAidlCompiler(context,idlFilesToCompile,moduleDataMap)) {
    return ExitCode.OK;
  }
  if (!runRenderscriptCompiler(context,rsFilesToCompile,moduleDataMap)) {
    return ExitCode.OK;
  }
  return ExitCode.OK;
}
