{
  final String aPackage=packages.get(facet.getModule());
  if (aPackage == null || aPackage.length() == 0) {
    return false;
  }
  final List<AndroidFacet> dependencies=AndroidJpsUtil.getAllAndroidDependencies(facet.getModule(),false);
  for (  AndroidFacet depFacet : dependencies) {
    final List<AndroidFacet> depDependencies=AndroidJpsUtil.getAllAndroidDependencies(depFacet.getModule(),true);
    if (depDependencies.contains(facet) && dependencies.contains(depFacet) && (depFacet.getModule().getName().compareTo(facet.getModule().getName()) < 0 || !depFacet.isLibrary())) {
      return true;
    }
  }
  return false;
}
