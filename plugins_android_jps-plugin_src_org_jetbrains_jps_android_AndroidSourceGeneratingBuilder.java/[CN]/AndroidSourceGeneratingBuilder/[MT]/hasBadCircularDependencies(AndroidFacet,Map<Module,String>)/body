{
  final String aPackage=packages.get(facet.getModule());
  if (aPackage == null || aPackage.length() == 0) {
    return false;
  }
  final List<AndroidFacet> dependencies=AndroidJpsUtil.getAllDependentAndroidLibraries(facet.getModule());
  for (  AndroidFacet depFacet : dependencies) {
    final String depPackage=packages.get(depFacet.getModule());
    if (!aPackage.equals(depPackage)) {
      continue;
    }
    final List<AndroidFacet> depDependencies=AndroidJpsUtil.getAllDependentAndroidLibraries(depFacet.getModule());
    if (depDependencies.contains(facet) && dependencies.contains(depFacet) && depFacet.getModule().getName().compareTo(facet.getModule().getName()) < 0) {
      return true;
    }
  }
  return false;
}
