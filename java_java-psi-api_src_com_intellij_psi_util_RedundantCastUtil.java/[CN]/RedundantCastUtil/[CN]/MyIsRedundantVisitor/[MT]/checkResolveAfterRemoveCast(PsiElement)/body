{
  PsiElement grandPa=parent.getParent();
  if (grandPa instanceof PsiExpressionList) {
    PsiExpression[] expressions=((PsiExpressionList)grandPa).getExpressions();
    int idx=ArrayUtil.find(expressions,parent);
    PsiElement grandGrandPa=grandPa.getParent();
    if (grandGrandPa instanceof PsiCall) {
      PsiElement resolve=((PsiCall)grandGrandPa).resolveMethod();
      if (resolve instanceof PsiMethod) {
        PsiCall expression=(PsiCall)grandGrandPa.copy();
        PsiExpressionList argumentList=expression.getArgumentList();
        LOG.assertTrue(argumentList != null);
        PsiExpression toReplace=argumentList.getExpressions()[idx];
        if (toReplace instanceof PsiConditionalExpression) {
          PsiExpression thenExpression=((PsiConditionalExpression)toReplace).getThenExpression();
          PsiExpression elseExpression=((PsiConditionalExpression)toReplace).getElseExpression();
          if (thenExpression instanceof PsiTypeCastExpression) {
            final PsiExpression thenOperand=((PsiTypeCastExpression)thenExpression).getOperand();
            if (thenOperand != null) {
              thenExpression.replace(thenOperand);
            }
          }
 else           if (elseExpression instanceof PsiTypeCastExpression) {
            final PsiExpression elseOperand=((PsiTypeCastExpression)elseExpression).getOperand();
            if (elseOperand != null) {
              elseExpression.replace(elseOperand);
            }
          }
        }
        if (expression.resolveMethod() != resolve) {
          return false;
        }
      }
    }
  }
  return true;
}
