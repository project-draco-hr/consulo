{
  Document document=editor.getDocument();
  if (line >= document.getLineCount()) {
    int y=lineToY(editor,document.getLineCount() - 1);
    return y + editor.getLineHeight() * (line - document.getLineCount() + 1);
  }
  return editor.logicalPositionToXY(editor.offsetToLogicalPosition(document.getLineStartOffset(line))).y;
}
