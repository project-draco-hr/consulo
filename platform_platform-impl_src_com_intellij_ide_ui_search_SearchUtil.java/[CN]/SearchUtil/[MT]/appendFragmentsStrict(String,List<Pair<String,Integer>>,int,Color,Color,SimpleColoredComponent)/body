{
  if (text == null)   return;
  final SimpleTextAttributes plainAttributes=new SimpleTextAttributes(style,foreground);
  final int[] lastOffset={0};
  ContainerUtil.process(toHighlight,new Processor<Pair<String,Integer>>(){
    @Override public boolean process(    Pair<String,Integer> pair){
      if (pair.second > lastOffset[0]) {
        c.append(text.substring(lastOffset[0],pair.second),new SimpleTextAttributes(style,foreground));
      }
      c.append(text.substring(pair.second,pair.second + pair.first.length()),new SimpleTextAttributes(background,foreground,null,style | SimpleTextAttributes.STYLE_SEARCH_MATCH));
      lastOffset[0]=pair.second + pair.first.length();
      return true;
    }
  }
);
  if (lastOffset[0] < text.length()) {
    c.append(text.substring(lastOffset[0]),plainAttributes);
  }
}
