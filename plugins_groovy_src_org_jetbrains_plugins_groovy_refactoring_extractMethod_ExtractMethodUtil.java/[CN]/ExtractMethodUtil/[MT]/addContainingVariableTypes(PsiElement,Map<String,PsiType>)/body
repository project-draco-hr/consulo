{
  if (statement instanceof GrVariable) {
    GrVariable variable=(GrVariable)statement;
    String name=variable.getName();
    if (name != null) {
      PsiType type=variable.getTypeGroovy();
      if (type != null) {
        type=TypeConversionUtil.erasure(type);
      }
      map.put(name,type);
    }
  }
  if (statement instanceof GrReferenceExpression) {
    GrReferenceExpression expr=(GrReferenceExpression)statement;
    String name=expr.getName();
    PsiReference ref=expr.getReference();
    if (name != null && (ref == null || !(ref.resolve() instanceof GrField))) {
      PsiType type=expr.getType();
      if (type != null) {
        type=TypeConversionUtil.erasure(type);
      }
      map.put(name,type);
    }
  }
  for (  PsiElement element : statement.getChildren()) {
    addContainingVariableTypes(element,map);
  }
}
