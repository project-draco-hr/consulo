{
  PsiElement[] elements;
  GrExpression expr=GroovyRefactoringUtil.findElementInRange(((GroovyFileBase)file),startOffset,endOffset,GrExpression.class);
  if (expr != null) {
    PsiElement parent=expr.getParent();
    if (expr.getParent() instanceof GrMethodCallExpression || parent instanceof GrIndexProperty) {
      expr=((GrExpression)expr.getParent());
    }
    elements=new PsiElement[]{expr};
  }
 else {
    elements=GroovyRefactoringUtil.findStatementsInRange(file,startOffset,endOffset);
  }
  return elements;
}
