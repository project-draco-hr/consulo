{
  final Project project=new Project(new GantBinding());
  final MethodClosure fakeClosure=new MethodClosure(new Object(),"hashCode");
  for (  GlobalLibrary library : myGlobalLibraries) {
    if (library instanceof SdkLibrary) {
      final SdkLibrary sdk=(SdkLibrary)library;
      final JavaSdk jdk=project.createJavaSdk(sdk.getName(),sdk.getHomePath(),fakeClosure);
      jdk.setClasspath(sdk.getPaths());
    }
 else {
      final Library lib=project.createGlobalLibrary(library.getName(),fakeClosure);
      lib.setClasspath(library.getPaths());
    }
  }
  final File projectFile=new File(projectPath);
  final String loadPath=isDirectoryBased(projectFile) ? new File(projectFile,IDEA_PROJECT_DIRNAME).getPath() : projectPath;
  IdeaProjectLoader.loadFromPath(project,loadPath,myPathVariables,getStartupScript());
  return project;
}
