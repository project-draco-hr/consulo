{
  Project project=(Project)dataProvider.getData(DataConstants.PROJECT_CONTEXT);
  if (project != null && !project.isDisposed()) {
    return ProjectRootManager.getInstance(project).getContentRoots();
  }
  Module[] selectedModules=(Module[])dataProvider.getData(DataConstants.MODULE_CONTEXT_ARRAY);
  if (selectedModules != null && selectedModules.length > 0) {
    return getFilesFromModules(selectedModules);
  }
  Module selectedModule=(Module)dataProvider.getData(DataConstants.MODULE_CONTEXT);
  if (selectedModule != null && !selectedModule.isDisposed()) {
    return ModuleRootManager.getInstance(selectedModule).getContentRoots();
  }
  PsiElement[] psiElements=(PsiElement[])dataProvider.getData(DataConstants.PSI_ELEMENT_ARRAY);
  if (psiElements != null && psiElements.length != 0) {
    return getFilesFromPsiElements(psiElements);
  }
  VirtualFile vFile=(VirtualFile)dataProvider.getData(DataConstants.VIRTUAL_FILE);
  if (vFile != null) {
    return new VirtualFile[]{vFile};
  }
  PsiFile psiFile=(PsiFile)dataProvider.getData(DataConstants.PSI_FILE);
  if (psiFile != null && psiFile.getVirtualFile() != null) {
    return new VirtualFile[]{psiFile.getVirtualFile()};
  }
  PsiElement elem=(PsiElement)dataProvider.getData(DataConstants.PSI_ELEMENT);
  if (elem != null) {
    return getFilesFromPsiElement(elem);
  }
  Usage[] usages=(Usage[])dataProvider.getData(UsageView.USAGES);
  UsageTarget[] usageTargets=(UsageTarget[])dataProvider.getData(UsageView.USAGE_TARGETS);
  if (usages != null || usageTargets != null) {
    return getFilesFromUsages(usages,usageTargets);
  }
  return null;
}
