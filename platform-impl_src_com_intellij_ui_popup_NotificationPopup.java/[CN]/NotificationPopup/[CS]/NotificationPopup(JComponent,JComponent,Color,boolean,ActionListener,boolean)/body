{
  final IdeFrameImpl frame=findFrame(owner);
  if (frame == null) {
    if (clickHandler != null) {
      throw new UnsupportedOperationException("Click handler is not supported in frameless mode");
    }
    new FramelessNotificationPopup(owner,content,backgroud,useDefaultPreferredSize);
  }
 else {
    final Wrapper wrapper=new NonOpaquePanel(content){
      @Override public Dimension getPreferredSize(){
        final Dimension size=super.getPreferredSize();
        if (useDefaultPreferredSize) {
          if (size.width > 400 || size.height > 200) {
            size.width=400;
            size.height=200;
          }
        }
        return size;
      }
    }
;
    final Balloon balloon=JBPopupFactory.getInstance().createBalloonBuilder(wrapper).setFadeoutTime(5000).setHideOnClickOutside(false).setHideOnFrameResize(false).setHideOnKeyOutside(false).setCloseButtonEnabled(true).setFillColor(backgroud).setShowCallout(false).setClickHandler(clickHandler,closeOnClick).createBalloon();
    frame.getBalloonLayout().add(frame.getLayeredPane(),balloon);
  }
}
