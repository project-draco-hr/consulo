{
  final BaseListPopupStep<VirtualFile> step=new BaseListPopupStep<VirtualFile>("File Path",files,icons){
    @NotNull @Override public String getTextFor(    final VirtualFile value){
      return value.getPresentableName();
    }
    @Override public PopupStep onChosen(    final VirtualFile selectedValue,    final boolean finalChoice){
      final File selectedFile=new File(getPresentableUrl(selectedValue));
      if (selectedFile.exists()) {
        ApplicationManager.getApplication().executeOnPooledThread(new Runnable(){
          public void run(){
            openFile(selectedFile);
          }
        }
);
      }
      return FINAL_CHOICE;
    }
  }
;
  return JBPopupFactory.getInstance().createListPopup(step);
}
