{
  try {
    if (SystemInfo.isWindows || SystemInfo.isMac) {
      final String path=toSelect == null ? ioFile.getCanonicalPath() : toSelect.exists() ? toSelect.getCanonicalPath() : ioFile.getCanonicalPath();
      final Runtime runtime=Runtime.getRuntime();
      String[] args;
      if (SystemInfo.isMac) {
        final String script=String.format("tell application \"Finder\"\n" + "\treveal {\"%s\"} as POSIX file\n" + "\tactivate\n"+ "end tell",path);
        args=new String[]{"osascript","-e",script};
      }
 else {
        if (path.indexOf(' ') >= 0) {
          args=new String[]{"explorer",String.format("/select,\"%s\"",path.substring(0,path.indexOf(' '))),String.format("\"%s\"",path.substring(path.indexOf(' ') + 1))};
        }
 else {
          args=new String[]{"explorer",String.format("/select,\"%s\"",path)};
        }
      }
      runtime.exec(args);
    }
 else     if (Desktop.isDesktopSupported() && Desktop.getDesktop().isSupported(Desktop.Action.OPEN)) {
      Desktop.getDesktop().open(ioFile);
    }
 else     if (SystemInfo.isGnome) {
      Runtime.getRuntime().exec(new String[]{"gnome-open",ioFile.getCanonicalPath()});
    }
 else     if (SystemInfo.isKDE) {
      Runtime.getRuntime().exec(new String[]{"kfmclient","exec",ioFile.getCanonicalPath()});
    }
 else {
      Messages.showErrorDialog("This action isn't supported on the current platform","Cannot Open File");
    }
  }
 catch (  IOException e) {
    LOG.warn(e);
  }
}
