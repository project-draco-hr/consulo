{
  if (thisElement == null)   return null;
  PsiElement element=thisElement.findElementAt(offset);
  if (element == null)   return null;
  offset=thisElement.getTextRange().getStartOffset() + offset - element.getTextRange().getStartOffset();
  while (element != null) {
    final PsiReference[] ref=extractReference(offset,element);
    if (ref.length == 1)     return ref[0];
 else     if (ref.length > 1)     return new PsiMultiReference(ref,element);
    offset=element.getStartOffsetInParent() + offset;
    element=element.getParent();
  }
  return null;
}
