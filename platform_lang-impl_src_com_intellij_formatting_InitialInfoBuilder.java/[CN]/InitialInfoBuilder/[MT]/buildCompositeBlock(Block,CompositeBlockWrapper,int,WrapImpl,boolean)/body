{
  final CompositeBlockWrapper wrappedRootBlock=new CompositeBlockWrapper(rootBlock,myCurrentWhiteSpace,parent);
  if (index == 0) {
    wrappedRootBlock.arrangeParentTextRange();
  }
  if (myRootBlockWrapper == null)   myRootBlockWrapper=wrappedRootBlock;
  boolean blocksMayBeOfInterest=false;
  if (myPositionOfInterest != -1) {
    myResult.put(wrappedRootBlock,rootBlock);
    blocksMayBeOfInterest=true;
  }
  final boolean blocksAreReadOnly=rootBlock instanceof ReadOnlyBlockContainer || blocksMayBeOfInterest;
  State state=new State(rootBlock,wrappedRootBlock,currentWrapParent,blocksAreReadOnly,rootBlockIsRightBlock);
  myStates.push(state);
  return wrappedRootBlock;
}
