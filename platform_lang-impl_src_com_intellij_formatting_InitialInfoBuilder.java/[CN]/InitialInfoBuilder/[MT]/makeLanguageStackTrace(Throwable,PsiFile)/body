{
  Throwable langThrowable=new Throwable();
  FormattingModelBuilder builder=LanguageFormatting.INSTANCE.forContext(file);
  if (builder == null)   return currentThrowable;
  Class builderClass=builder.getClass();
  Class declaringClass=builderClass.getDeclaringClass();
  String guessedFileName=(declaringClass == null ? builderClass.getSimpleName() : declaringClass.getSimpleName()) + ".java";
  StackTraceElement ste=new StackTraceElement(builder.getClass().getName(),"createModel",guessedFileName,1);
  StackTraceElement[] originalStackTrace=currentThrowable.getStackTrace();
  StackTraceElement[] modifiedStackTrace=new StackTraceElement[originalStackTrace.length + 1];
  System.arraycopy(originalStackTrace,0,modifiedStackTrace,1,originalStackTrace.length);
  modifiedStackTrace[0]=ste;
  langThrowable.setStackTrace(modifiedStackTrace);
  return langThrowable;
}
