{
  SliceTreeStructure treeStructure=configureTree("DupSlice");
  SliceNode root=(SliceNode)treeStructure.getRootElement();
  List<SliceNode> nodes=new ArrayList<SliceNode>();
  expandNodesTo(root,nodes);
  for (int i=0; i < nodes.size() - 1; i++) {
    SliceNode node=nodes.get(i);
    assertNull(node.getDuplicate());
  }
  SliceNode last=nodes.get(nodes.size() - 1);
  assertNotNull(last.getDuplicate());
  type("   xx");
  PsiDocumentManager.getInstance(getProject()).commitAllDocuments();
  backspace();
  backspace();
  PsiDocumentManager.getInstance(getProject()).commitAllDocuments();
  nodes.clear();
  expandNodesTo(root,nodes);
  for (int i=0; i < nodes.size() - 1; i++) {
    SliceNode node=nodes.get(i);
    assertNull(node.getDuplicate());
  }
  assertNotNull(last.getDuplicate());
}
