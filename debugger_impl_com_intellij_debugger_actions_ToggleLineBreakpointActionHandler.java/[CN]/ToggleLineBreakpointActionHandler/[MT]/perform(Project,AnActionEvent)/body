{
  PlaceInDocument place=getPlace(project,event);
  if (place == null) {
    return;
  }
  ExpandRegionHandler.expandRegionAtCaret(project,event.getData(PlatformDataKeys.EDITOR));
  Document document=place.getDocument();
  int line=document.getLineNumber(place.getOffset());
  DebuggerManagerEx debugManager=DebuggerManagerEx.getInstanceEx(project);
  if (debugManager == null) {
    return;
  }
  BreakpointManager manager=debugManager.getBreakpointManager();
  final Breakpoint breakpoint=manager.findBreakpoint(document,place.getOffset(),LineBreakpoint.CATEGORY);
  if (breakpoint == null) {
    LineBreakpoint lineBreakpoint=manager.addLineBreakpoint(document,line);
    if (lineBreakpoint != null) {
      RequestManagerImpl.createRequests(lineBreakpoint);
    }
  }
 else {
    manager.removeBreakpoint(breakpoint);
  }
}
