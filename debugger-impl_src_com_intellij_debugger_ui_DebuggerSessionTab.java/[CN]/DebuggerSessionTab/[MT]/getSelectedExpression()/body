{
  if (myDebuggerSession.getState() != DebuggerSession.STATE_PAUSED) {
    return null;
  }
  JTree tree=myFramePanel.getFrameTree();
  if (tree == null || !tree.hasFocus()) {
    tree=myWatchPanel.getWatchTree();
    if (tree == null || !tree.hasFocus()) {
      return null;
    }
  }
  TreePath path=tree.getSelectionPath();
  if (path == null) {
    return null;
  }
  DebuggerTreeNodeImpl node=(DebuggerTreeNodeImpl)path.getLastPathComponent();
  if (node == null) {
    return null;
  }
  NodeDescriptorImpl descriptor=node.getDescriptor();
  if (!(descriptor instanceof ValueDescriptorImpl)) {
    return null;
  }
  if (descriptor instanceof WatchItemDescriptor) {
    return ((WatchItemDescriptor)descriptor).getEvaluationText();
  }
  return DebuggerTreeNodeExpression.createEvaluationText(node,getContextManager().getContext());
}
