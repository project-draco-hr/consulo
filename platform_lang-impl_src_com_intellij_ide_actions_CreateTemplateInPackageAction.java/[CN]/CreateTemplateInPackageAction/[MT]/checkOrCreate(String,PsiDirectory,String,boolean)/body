{
  PsiDirectory dir=directory;
  String className=newName;
  if (newName.contains(".")) {
    String[] names=newName.split("\\.");
    for (int i=0; i < names.length - 1; i++) {
      String name=names[i];
      PsiDirectory subDir=dir.findSubdirectory(name);
      if (subDir == null) {
        if (check) {
          dir.checkCreateSubdirectory(name);
          return null;
        }
        subDir=dir.createSubdirectory(name);
      }
      dir=subDir;
    }
    className=names[names.length - 1];
  }
  if (check) {
    doCheckCreate(dir,className,templateName);
    return null;
  }
  return doCreate(dir,className,templateName);
}
