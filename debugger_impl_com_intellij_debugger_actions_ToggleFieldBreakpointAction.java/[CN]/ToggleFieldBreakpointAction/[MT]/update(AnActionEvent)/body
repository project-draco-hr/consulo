{
  SourcePosition place=getPlace(event);
  boolean toEnable=place != null;
  Presentation presentation=event.getPresentation();
  if (ActionPlaces.PROJECT_VIEW_POPUP.equals(event.getPlace()) || ActionPlaces.STRUCTURE_VIEW_POPUP.equals(event.getPlace()) || ActionPlaces.FAVORITES_VIEW_POPUP.equals(event.getPlace())) {
    presentation.setVisible(toEnable);
  }
 else   if (DebuggerAction.isContextView(event)) {
    presentation.setText(DebuggerBundle.message("action.add.field.watchpoint.text"));
    Project project=(Project)event.getDataContext().getData(DataConstants.PROJECT);
    if (place != null) {
      Document document=PsiDocumentManager.getInstance(project).getDocument(place.getFile());
      if (document != null) {
        final int offset=place.getOffset();
        final Breakpoint fieldBreakpoint=offset >= 0 ? (DebuggerManagerEx.getInstanceEx(project)).getBreakpointManager().findFieldBreakpoint(document,offset) : null;
        if (fieldBreakpoint != null) {
          presentation.setEnabled(false);
          return;
        }
      }
    }
  }
  presentation.setVisible(toEnable);
}
