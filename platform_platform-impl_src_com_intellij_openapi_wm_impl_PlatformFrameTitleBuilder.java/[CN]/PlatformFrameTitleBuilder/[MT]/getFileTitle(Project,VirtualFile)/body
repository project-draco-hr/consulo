{
  if (SystemInfo.isMac)   return file.getName();
  if (file instanceof VirtualFilePathWrapper) {
    return ((VirtualFilePathWrapper)file).getPresentablePath();
  }
  String url=ProjectUtil.getLocationRelativeToUserHome(file.getPresentableUrl());
  VirtualFile baseDir=ProjectBaseDirectory.getInstance(project).getBaseDir();
  if (baseDir == null)   baseDir=project.getBaseDir();
  if (baseDir != null) {
    final String projectHomeUrl=ProjectUtil.getLocationRelativeToUserHome(baseDir.getPresentableUrl());
    if (url.startsWith(projectHomeUrl)) {
      url="..." + url.substring(projectHomeUrl.length());
    }
  }
  return url;
}
