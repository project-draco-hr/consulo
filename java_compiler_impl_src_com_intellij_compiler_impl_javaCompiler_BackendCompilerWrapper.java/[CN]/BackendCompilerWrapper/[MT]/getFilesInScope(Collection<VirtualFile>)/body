{
  final List<VirtualFile> filesInScope=new ArrayList<VirtualFile>(files.size());
  ApplicationManager.getApplication().runReadAction(new Runnable(){
    public void run(){
      final CompileScope compileScope=myCompileContext.getCompileScope();
      for (      VirtualFile file : files) {
        if (compileScope.belongs(file.getUrl())) {
          filesInScope.add(file);
        }
      }
    }
  }
);
  return filesInScope;
}
