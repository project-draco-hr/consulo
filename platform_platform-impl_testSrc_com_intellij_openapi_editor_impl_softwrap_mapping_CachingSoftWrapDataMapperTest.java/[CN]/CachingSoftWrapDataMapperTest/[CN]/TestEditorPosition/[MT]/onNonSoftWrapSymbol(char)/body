{
  document.append(c);
  if (c == '\n') {
    myLineRanges.add(new TextRange(logicalLineStartOffset,offset));
    if (!insideFolding) {
      myMapper.onVisualLineEnd(this);
      visualColumn++;
      logicalColumn++;
      addData(true);
      visualColumn++;
      logicalColumn++;
      addData(true);
    }
    logicalLineStartOffset=offset + 1;
    logicalLine++;
    logicalColumn=0;
  }
}
