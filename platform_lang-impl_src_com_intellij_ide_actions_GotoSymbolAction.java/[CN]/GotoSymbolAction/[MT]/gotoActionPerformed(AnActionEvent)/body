{
  FeatureUsageTracker.getInstance().triggerFeatureUsed("navigation.popup.symbol");
  final Project project=e.getData(PlatformDataKeys.PROJECT);
  PsiDocumentManager.getInstance(project).commitAllDocuments();
  final GotoSymbolModel2 model=new GotoSymbolModel2(project);
  final ChooseByNamePopup popup=ChooseByNamePopup.createPopup(project,model,getPsiContext(e),getInitialText(e.getData(PlatformDataKeys.EDITOR)));
  final ChooseByNameFilter filterUI=new ChooseByNameLanguageFilter(popup,model,GotoClassSymbolConfiguration.getInstance(project),project);
  popup.invoke(new ChooseByNamePopupComponent.Callback(){
    public void onClose(){
      if (GotoSymbolAction.class.equals(myInAction)) {
        myInAction=null;
      }
      filterUI.close();
    }
    public void elementChosen(    Object element){
      ((NavigationItem)element).navigate(true);
    }
  }
,ModalityState.current(),true);
}
