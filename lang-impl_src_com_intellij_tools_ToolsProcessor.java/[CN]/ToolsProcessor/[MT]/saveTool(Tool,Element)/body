{
  Element element=new Element(TOOL);
  if (tool.getName() != null) {
    element.setAttribute(NAME,tool.getName());
  }
  if (tool.getDescription() != null) {
    element.setAttribute(DESCRIPTION,tool.getDescription());
  }
  element.setAttribute(SHOW_IN_MAIN_MENU,Boolean.toString(tool.isShownInMainMenu()));
  element.setAttribute(SHOW_IN_EDITOR,Boolean.toString(tool.isShownInEditor()));
  element.setAttribute(SHOW_IN_PROJECT,Boolean.toString(tool.isShownInProjectViews()));
  element.setAttribute(SHOW_IN_SEARCH_POPUP,Boolean.toString(tool.isShownInSearchResultsPopup()));
  element.setAttribute(DISABLED,Boolean.toString(!tool.isEnabled()));
  element.setAttribute(USE_CONSOLE,Boolean.toString(tool.isUseConsole()));
  element.setAttribute(SYNCHRONIZE_AFTER_EXECUTION,Boolean.toString(tool.synchronizeAfterExecution()));
  Element taskElement=new Element(EXEC);
  Element option=new Element(ELEMENT_OPTION);
  taskElement.addContent(option);
  option.setAttribute(ATTRIBUTE_NAME,COMMAND);
  if (tool.getProgram() != null) {
    option.setAttribute(ATTRIBUTE_VALUE,tool.getProgram());
  }
  option=new Element(ELEMENT_OPTION);
  taskElement.addContent(option);
  option.setAttribute(ATTRIBUTE_NAME,PARAMETERS);
  if (tool.getParameters() != null) {
    option.setAttribute(ATTRIBUTE_VALUE,tool.getParameters());
  }
  option=new Element(ELEMENT_OPTION);
  taskElement.addContent(option);
  option.setAttribute(ATTRIBUTE_NAME,WORKING_DIRECTORY);
  if (tool.getWorkingDirectory() != null) {
    String appHome=PathManager.getHomePath().replace(File.separatorChar,'/');
    option.setAttribute(ATTRIBUTE_VALUE,StringUtil.replace(tool.getWorkingDirectory(),appHome,APPLICATION_HOME_MACRO));
  }
  element.addContent(taskElement);
  FilterInfo[] filters=tool.getOutputFilters();
  for (  FilterInfo filter : filters) {
    Element filterElement=new Element(FILTER);
    filter.writeExternal(filterElement);
    element.addContent(filterElement);
  }
  groupElement.addContent(element);
}
