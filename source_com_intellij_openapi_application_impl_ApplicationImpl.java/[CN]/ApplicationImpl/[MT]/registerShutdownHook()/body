{
  ShutDownTracker.getInstance();
  ShutDownTracker.getInstance().registerShutdownThread(new Thread(new Runnable(){
    public void run(){
      try {
        SwingUtilities.invokeAndWait(new Runnable(){
          public void run(){
            if (!myDoNotSave && !isUnitTestMode() && !isHeadlessEnvironment()) {
              saveAll();
            }
            dispose();
          }
        }
);
      }
 catch (      InterruptedException e) {
        LOG.error(e);
      }
catch (      InvocationTargetException e) {
        LOG.error(e);
      }
    }
  }
));
}
