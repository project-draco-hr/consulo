{
  if (myDoNotSave)   return;
  ShutDownTracker.getInstance().registerStopperThread(Thread.currentThread());
  try {
    if (!ourSaveSettingsInProgress) {
      ourSaveSettingsInProgress=true;
      final String optionsPath=PathManager.getOptionsPath();
      File file=new File(optionsPath);
      if (!file.exists()) {
        file.mkdirs();
      }
      try {
        save(optionsPath);
      }
 catch (      final Throwable ex) {
        ex.printStackTrace();
        invokeLater(new Runnable(){
          public void run(){
            Messages.showMessageDialog("Could not save application settings: " + ex.getLocalizedMessage(),"Error",Messages.getErrorIcon());
          }
        }
);
      }
 finally {
        ourSaveSettingsInProgress=false;
      }
    }
    saveSettingsSavingComponents();
  }
  finally {
    ShutDownTracker.getInstance().unregisterStopperThread(Thread.currentThread());
  }
}
