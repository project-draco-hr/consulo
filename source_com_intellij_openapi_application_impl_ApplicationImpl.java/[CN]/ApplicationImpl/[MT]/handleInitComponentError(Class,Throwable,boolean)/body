{
  if (PluginManager.isPluginClass(componentClass.getName())) {
    LOG.error(ex);
    PluginId pluginId=PluginManager.getPluginByClassName(componentClass.getName());
    @NonNls final String errorMessage="Plugin " + pluginId.getIdString() + " failed to initialize:\n"+ ex.getMessage()+ "\nPlease remove the plugin and restart "+ ApplicationNamesInfo.getInstance().getFullProductName()+ ".";
    if (!myHeadlessMode) {
      JOptionPane.showMessageDialog(null,errorMessage);
    }
 else {
      System.out.println(errorMessage);
    }
    System.exit(1);
  }
 else   if (fatal) {
    LOG.error(ex);
    @NonNls final String errorMessage="Fatal error initializing class " + componentClass.getName() + ":\n"+ ex.toString()+ "\nComplete error stacktrace was written to idea.log";
    if (!myHeadlessMode) {
      JOptionPane.showMessageDialog(null,errorMessage);
    }
 else {
      System.out.println(errorMessage);
    }
  }
  super.handleInitComponentError(componentClass,ex,fatal);
}
