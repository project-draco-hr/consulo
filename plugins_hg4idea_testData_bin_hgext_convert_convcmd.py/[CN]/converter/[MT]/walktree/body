def walktree(self, heads):
    'Return a mapping that identifies the uncommitted parents of every\n        uncommitted changeset.'
    visit = heads
    known = set()
    parents = {}
    while visit:
        n = visit.pop(0)
        if ((n in known) or (n in self.map)):
            continue
        known.add(n)
        commit = self.cachecommit(n)
        parents[n] = []
        for p in commit.parents:
            parents[n].append(p)
            visit.append(p)
    return parents
