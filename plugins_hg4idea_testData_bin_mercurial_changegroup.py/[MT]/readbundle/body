def readbundle(fh, fname):
    header = fh.read(6)
    if (not header.startswith('HG')):
        raise util.Abort((_('%s: not a Mercurial bundle file') % fname))
    if (not header.startswith('HG10')):
        raise util.Abort((_('%s: unknown bundle version') % fname))
    elif (header not in bundletypes):
        raise util.Abort((_('%s: unknown bundle compression type') % fname))
    return unbundle(header, fh)
