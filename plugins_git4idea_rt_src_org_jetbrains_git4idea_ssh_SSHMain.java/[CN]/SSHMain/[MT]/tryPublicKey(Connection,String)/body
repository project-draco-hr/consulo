{
  try {
    final File file=new File(keyPath);
    if (file.exists()) {
      String passphrase=null;
      char[] text=FileUtilRt.loadFileText(file);
      if (isEncryptedKey(text)) {
        int i;
        for (i=0; i < myHost.getNumberOfPasswordPrompts(); i++) {
          passphrase=myXmlRpcClient.askPassphrase(myHandlerNo,getUserHostString(),keyPath,i != 0,myLastError);
          if (passphrase == null) {
            return false;
          }
 else {
            try {
              PEMDecoder.decode(text,passphrase);
              myLastError="";
            }
 catch (            IOException e) {
              myLastError=SSHMainBundle.message("sshmain.invalidpassphrase",keyPath);
              myErrorCause=e;
              continue;
            }
            break;
          }
        }
        if (i == myHost.getNumberOfPasswordPrompts()) {
          myLastError=SSHMainBundle.message("sshmain.too.mush.passphrase.guesses",keyPath,myHost.getNumberOfPasswordPrompts());
          return false;
        }
      }
      if (c.authenticateWithPublicKey(myHost.getUser(),text,passphrase)) {
        myLastError="";
        myXmlRpcClient.setLastSuccessful(myHandlerNo,getUserHostString(),PUBLIC_KEY_METHOD,"");
        return true;
      }
 else {
        if (passphrase != null) {
          myLastError=SSHMainBundle.message("sshmain.pk.authenitication.failed",keyPath);
        }
 else {
          myLastError="";
        }
      }
    }
    return false;
  }
 catch (  Exception e) {
    myErrorCause=e;
    return false;
  }
}
