{
  boolean somethingDirty=false;
  if (filesDirty != null) {
    for (    VirtualFile file : filesDirty) {
      final AbstractVcs vcs=getVcsForDirty(file);
      if (vcs != null) {
        somethingDirty=true;
        getScope(vcs).addDirtyFile(new FilePathImpl(file));
      }
    }
  }
  if (dirsRecursivelyDirty != null) {
    for (    VirtualFile dir : dirsRecursivelyDirty) {
      AbstractVcs vcs=getVcsForDirty(dir);
      if (vcs != null) {
        somethingDirty=true;
        getScope(vcs).addDirtyDirRecursively(new FilePathImpl(dir));
      }
    }
  }
  if (somethingDirty) {
    myChangeListManager.scheduleUpdate();
  }
}
