{
  if (!isVisible() || !width && !height || isBusy())   return;
  Dimension size=getSize();
  Dimension prefSize=myContent.computePreferredSize();
  Point location=!myLocateWithinScreen ? null : getLocationOnScreen();
  Rectangle screen=location == null ? null : ScreenUtil.getScreenRectangle(location);
  if (width) {
    size.width=prefSize.width;
    if (screen != null) {
      int delta=screen.width + screen.x - location.x;
      if (size.width > delta) {
        size.width=delta;
        JScrollPane scrollPane=ScrollUtil.findScrollPane(myContent);
        if (scrollPane != null && scrollPane.getHorizontalScrollBarPolicy() != ScrollPaneConstants.HORIZONTAL_SCROLLBAR_NEVER) {
          JScrollBar scrollBar=scrollPane.getHorizontalScrollBar();
          if (scrollBar != null) {
            prefSize.height+=scrollBar.getPreferredSize().height;
          }
        }
      }
    }
  }
  if (height) {
    size.height=prefSize.height;
    if (screen != null) {
      int delta=screen.height + screen.y - location.y;
      if (size.height > delta) {
        size.height=delta;
      }
    }
  }
  size=computeWindowSize(size);
  final Window window=getContentWindow(myContent);
  if (window != null) {
    window.setSize(size);
  }
}
