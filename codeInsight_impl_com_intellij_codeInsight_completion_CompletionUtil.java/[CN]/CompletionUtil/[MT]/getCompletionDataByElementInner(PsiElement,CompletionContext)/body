{
  final PsiFile file=context.file;
  if (context.file.getUserData(ENFORCE_COMPLETION_DATA_KEY) != null) {
    return context.file.getUserData(ENFORCE_COMPLETION_DATA_KEY);
  }
  final CompletionData completionDataByFileType=getCompletionDataByFileType(file.getFileType());
  if (completionDataByFileType != null)   return completionDataByFileType;
  if ((file instanceof PsiJavaFile || file instanceof PsiCodeFragment) && !(PsiUtil.isInJspFile(file))) {
    if (element != null && new SuperParentFilter(new ClassFilter(PsiDocComment.class)).isAcceptable(element,element.getParent())) {
      return ourJavaDocCompletionData;
    }
 else {
      return element != null && element.getManager().getEffectiveLanguageLevel() == LanguageLevel.JDK_1_5 ? ourJava15CompletionData : ourJavaCompletionData;
    }
  }
 else   if (file.getViewProvider().getBaseLanguage() == StdLanguages.JSP) {
    return ourJSPCompletionData;
  }
 else   if (file.getViewProvider().getBaseLanguage() == StdLanguages.XML) {
    return ourXmlCompletionData;
  }
  return ourGenericCompletionData;
}
