{
  DataContext dataContext=event.getDataContext();
  SelectInContext result=createEditorContext(dataContext);
  if (result != null) {
    return result;
  }
  JComponent sourceComponent=getEventComponent(event);
  if (sourceComponent == null) {
    return null;
  }
  SelectInContext selectInContext=(SelectInContext)dataContext.getData(SelectInContext.DATA_CONTEXT_ID);
  if (selectInContext == null) {
    selectInContext=createPsiContext(event);
  }
  if (selectInContext == null) {
    Navigatable descriptor=(Navigatable)dataContext.getData(DataConstants.NAVIGATABLE);
    if (descriptor instanceof OpenFileDescriptor) {
      final VirtualFile file=((OpenFileDescriptor)descriptor).getFile();
      if (file.isValid()) {
        Project project=(Project)dataContext.getData(DataConstants.PROJECT);
        selectInContext=OpenFileDescriptorContext.create(project,file);
      }
    }
  }
  if (selectInContext == null) {
    VirtualFile virtualFile=DataKeys.VIRTUAL_FILE.getData(dataContext);
    Project project=DataKeys.PROJECT.getData(dataContext);
    if (virtualFile != null && project != null) {
      return new VirtualFileSelectInContext(project,virtualFile);
    }
  }
  return selectInContext;
}
