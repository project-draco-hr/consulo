{
  Map<VirtualFile,Module> fileToModule=new HashMap<VirtualFile,Module>();
  for (  Map.Entry<VirtualFile,Module> entry : filesToRefresh.entrySet()) {
    fileToModule.put(entry.getKey(),entry.getValue());
  }
  for (  VirtualFile file : importRoots) {
    fileToModule.put(file,null);
  }
  ProgressIndicator indicator=ProgressManager.getInstance().getProgressIndicator();
  while (fileToModule.size() != 0) {
    if (indicator != null && indicator.isCanceled()) {
      break;
    }
    final MavenProjectModel.Node node=createMavenTree(projectReader,fileToModule.keySet().iterator().next(),fileToModule,false);
    if (node != null) {
      rootProjects.add(node);
    }
  }
}
