{
  mavenEmbedder=embedder;
  if (mavenEmbedder == null) {
    return;
  }
  Map<VirtualFile,Module> fileToModule=new HashMap<VirtualFile,Module>();
  for (  Map.Entry<VirtualFile,Module> entry : filesToRefresh.entrySet()) {
    fileToModule.put(entry.getKey(),entry.getValue());
  }
  for (  VirtualFile file : importRoots) {
    fileToModule.put(file,null);
  }
  ProgressIndicator indicator=ProgressManager.getInstance().getProgressIndicator();
  if (indicator != null) {
    indicator.setText(ProjectBundle.message("maven.reading.pom"));
  }
  while (fileToModule.size() != 0) {
    final MavenProjectModel.Node node=createMavenTree(fileToModule.keySet().iterator().next(),fileToModule,false);
    if (node != null) {
      rootProjects.add(node);
    }
  }
}
