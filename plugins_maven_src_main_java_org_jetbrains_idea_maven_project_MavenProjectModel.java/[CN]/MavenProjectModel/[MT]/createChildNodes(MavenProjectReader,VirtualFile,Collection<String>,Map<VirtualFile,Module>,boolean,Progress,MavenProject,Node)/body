{
  for (  String modulePath : ProjectUtil.collectRelativeModulePaths(mavenProject,profiles,new HashSet<String>())) {
    p.check();
    VirtualFile childFile=getMavenModuleFile(pomFile,modulePath);
    if (childFile == null) {
      LOG.info("Cannot find maven module " + modulePath);
      continue;
    }
    Node existingRoot=findExistingRoot(childFile);
    if (existingRoot != null) {
      rootProjects.remove(existingRoot);
      node.mavenModules.add(existingRoot);
    }
 else     if (!isExistingModuleTree || unprocessedFiles.containsKey(childFile)) {
      Node module=createMavenTree(projectReader,childFile,profiles,unprocessedFiles,isExistingModuleTree,p);
      node.mavenModules.add(module);
    }
  }
}
