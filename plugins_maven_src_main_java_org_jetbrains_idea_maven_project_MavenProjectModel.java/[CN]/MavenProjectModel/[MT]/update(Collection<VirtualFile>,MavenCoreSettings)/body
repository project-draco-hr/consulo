{
  MavenEmbedder e=EmbedderFactory.createEmbedderForRead(mavenSettings,myProjectIdToFileMapping);
  try {
    MavenProjectReader reader=new MavenProjectReader(e);
    Set<VirtualFile> updatedFiles=new HashSet<VirtualFile>();
    for (    VirtualFile each : files) {
      Node n=findProject(each);
      if (n == null) {
        doAdd(each,reader,updatedFiles);
      }
 else {
        doUpdate(n,reader,false,updatedFiles);
      }
    }
  }
  finally {
    EmbedderFactory.releaseEmbedder(e);
  }
}
