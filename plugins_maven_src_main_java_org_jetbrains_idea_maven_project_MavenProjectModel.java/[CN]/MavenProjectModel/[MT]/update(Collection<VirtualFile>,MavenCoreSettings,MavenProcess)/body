{
  MavenEmbedder e=MavenEmbedderFactory.createEmbedderForRead(mavenSettings,myProjectIdToFileMapping);
  try {
    MavenProjectReader reader=new MavenProjectReader(e);
    Set<VirtualFile> updatedFiles=new HashSet<VirtualFile>();
    for (    VirtualFile each : files) {
      Node n=findProject(each);
      if (n == null) {
        doAdd(each,reader,updatedFiles,p);
      }
 else {
        doUpdate(n,reader,false,updatedFiles,p);
      }
    }
  }
  finally {
    MavenEmbedderFactory.releaseEmbedder(e);
  }
}
