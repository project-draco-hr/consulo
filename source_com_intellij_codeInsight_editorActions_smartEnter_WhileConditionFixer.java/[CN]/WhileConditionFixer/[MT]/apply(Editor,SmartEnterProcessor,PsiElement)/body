{
  if (psiElement instanceof PsiWhileStatement) {
    final Document doc=editor.getDocument();
    final PsiWhileStatement whileStatement=(PsiWhileStatement)psiElement;
    if (whileStatement.getCondition() == null) {
      if (whileStatement.getLParenth() == null || whileStatement.getRParenth() == null) {
        int stopOffset=doc.getLineEndOffset(doc.getLineNumber(whileStatement.getTextRange().getStartOffset()));
        final PsiStatement block=whileStatement.getBody();
        if (block != null) {
          stopOffset=Math.min(stopOffset,block.getTextRange().getStartOffset());
        }
        doc.replaceString(whileStatement.getTextRange().getStartOffset(),stopOffset,"while ()");
      }
 else {
        processor.registerUnresolvedError(whileStatement.getLParenth().getTextRange().getEndOffset());
      }
    }
 else     if (whileStatement.getRParenth() == null) {
      doc.insertString(whileStatement.getCondition().getTextRange().getEndOffset(),")");
    }
  }
}
