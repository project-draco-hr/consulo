{
  Project project=psiClass.getProject();
  RunnerAndConfigurationSettings settings=cloneTemplateConfiguration(project,context);
  final AndroidRunConfiguration configuration=(AndroidRunConfiguration)settings.getConfiguration();
  final String classQName=psiClass.getQualifiedName();
  if (classQName == null) {
    return null;
  }
  configuration.ACTIVITY_CLASS=classQName;
  configuration.MODE=AndroidRunConfiguration.LAUNCH_SPECIFIC_ACTIVITY;
  configuration.setName(JavaExecutionUtil.getPresentableClassName(configuration.ACTIVITY_CLASS,configuration.getConfigurationModule()));
  setupConfigurationModule(context,configuration);
  final TargetSelectionMode targetSelectionMode=AndroidUtils.getDefaultTargetSelectionMode(context.getModule(),AndroidRunConfigurationType.getInstance(),AndroidTestRunConfigurationType.getInstance());
  if (targetSelectionMode != null) {
    configuration.setTargetSelectionMode(targetSelectionMode);
  }
  return settings;
}
