{
  List<FoldingDescriptor> descriptors=new ArrayList<FoldingDescriptor>();
  Map<ASTNode,FoldingBuilder> builders=foldings.get(document);
  if (builders == null) {
    builders=new HashMap<ASTNode,FoldingBuilder>();
    foldings.put(document,builders);
  }
  for (  FoldingBuilder builder : myBuilders) {
    final FoldingDescriptor[] foldingDescriptors=builder.buildFoldRegions(node,document);
    if (foldingDescriptors.length > 0) {
      descriptors.addAll(Arrays.asList(foldingDescriptors));
      for (      FoldingDescriptor descriptor : foldingDescriptors) {
        builders.put(descriptor.getElement(),builder);
      }
    }
  }
  return descriptors.toArray(new FoldingDescriptor[descriptors.size()]);
}
