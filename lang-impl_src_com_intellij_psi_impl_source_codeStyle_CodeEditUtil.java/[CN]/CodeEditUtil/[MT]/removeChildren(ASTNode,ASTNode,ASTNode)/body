{
  final boolean tailingElement=last.getStartOffset() + last.getTextLength() == parent.getStartOffset() + parent.getTextLength();
  final boolean forceReformat=needToForceReformat(parent,first,last);
  saveWhitespacesInfo(first);
  TreeElement child=(TreeElement)first;
  while (child != null) {
    if (child == last)     break;
    child=child.next;
  }
  final ASTNode prevLeaf=TreeUtil.prevLeaf(first);
  final ASTNode nextLeaf=TreeUtil.nextLeaf(first);
  parent.removeRange(first,last.getTreeNext());
  ASTNode nextLeafToAdjust=nextLeaf;
  if (nextLeafToAdjust != null && nextLeafToAdjust.getTreeParent() == null) {
    nextLeafToAdjust=prevLeaf.getTreeNext();
  }
  makePlaceHolderBetweenTokens(prevLeaf,nextLeafToAdjust,forceReformat,tailingElement);
}
