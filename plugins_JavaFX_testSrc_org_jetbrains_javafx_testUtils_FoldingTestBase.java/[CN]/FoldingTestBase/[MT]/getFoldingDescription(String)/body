{
  final Application application=ApplicationManager.getApplication();
  application.runWriteAction(new Runnable(){
    public void run(){
      myFixture.configureByText(JavaFxFileType.INSTANCE,content);
    }
  }
);
  final Editor editor=myFixture.getEditor();
  application.runReadAction(new Runnable(){
    public void run(){
      CodeFoldingManager.getInstance(myFixture.getProject()).buildInitialFoldings(editor);
    }
  }
);
  final FoldingModel model=editor.getFoldingModel();
  final FoldRegion[] foldingRegions=model.getAllFoldRegions();
  final List<Border> borders=new ArrayList<Border>();
  for (  FoldRegion region : foldingRegions) {
    borders.add(new Border(Border.LEFT,region.getStartOffset(),region.getPlaceholderText()));
    borders.add(new Border(Border.RIGHT,region.getEndOffset(),""));
  }
  Collections.sort(borders);
  StringBuilder result=new StringBuilder(editor.getDocument().getText());
  for (  Border border : borders) {
    result.insert(border.getOffset(),border.isSide() == Border.LEFT ? "<fold text=\"" + border.getText() + "\">" : END_FOLD);
  }
  return result.toString();
}
