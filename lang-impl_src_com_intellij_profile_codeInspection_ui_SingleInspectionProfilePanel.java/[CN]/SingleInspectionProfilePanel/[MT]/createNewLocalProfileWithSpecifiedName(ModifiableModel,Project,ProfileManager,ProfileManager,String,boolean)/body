{
  ProfileManager profileManager=isLocal && ideProfileManager != null ? ideProfileManager : currentProfileManager;
  if (ArrayUtil.find(currentProfileManager.getAvailableProfileNames(),profileName) != -1 || ideProfileManager != null && ArrayUtil.find(ideProfileManager.getAvailableProfileNames(),profileName) != -1) {
    Messages.showErrorDialog(InspectionsBundle.message("inspection.unable.to.create.profile.message",profileName),InspectionsBundle.message("inspection.unable.to.create.profile.dialog.title"));
    return null;
  }
  InspectionProfileImpl inspectionProfile=new InspectionProfileImpl(profileName,InspectionToolRegistrar.getInstance(),profileManager);
  final ModifiableModel profileModifiableModel=inspectionProfile.getModifiableModel();
  if (selectedProfile != null) {
    profileModifiableModel.copyFrom(selectedProfile);
  }
  profileModifiableModel.setName(profileName);
  profileModifiableModel.setLocal(isLocal);
  return profileModifiableModel;
}
