{
  int index=key - anchor;
  if (index >= data.length) {
    int newLength=data.length << 1;
    while (newLength <= index && newLength > 0) {
      newLength<<=1;
    }
    double[] newData=new double[newLength];
    System.arraycopy(data,0,newData,0,end);
    data=newData;
  }
  data[index]=value;
  if (index >= end) {
    end=index + 1;
  }
}
