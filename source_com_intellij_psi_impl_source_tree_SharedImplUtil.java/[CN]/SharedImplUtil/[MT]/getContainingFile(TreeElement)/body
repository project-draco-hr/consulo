{
  TreeElement element;
  for (element=thisElement; element.getTreeParent() != null; element=element.getTreeParent()) {
  }
  if (element.getManager() == null)   return null;
  PsiElement psiElement=SourceTreeToPsiMap.treeElementToPsi(element);
  if (psiElement instanceof DummyHolder)   return psiElement.getContainingFile();
  if (!(psiElement instanceof PsiFile))   return null;
  return (PsiFile)psiElement;
}
