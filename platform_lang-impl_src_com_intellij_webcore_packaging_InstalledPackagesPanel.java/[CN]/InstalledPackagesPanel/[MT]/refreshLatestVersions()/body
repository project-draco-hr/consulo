{
  final Application application=ApplicationManager.getApplication();
  application.executeOnPooledThread(new Runnable(){
    @Override public void run(){
      try {
        List<RepoPackage> packages=myPackageManagementService.reloadAllPackages();
        final Map<String,RepoPackage> packageMap=buildNameToPackageMap(packages);
        application.invokeLater(new Runnable(){
          @Override public void run(){
            for (int i=0; i != myPackagesTableModel.getRowCount(); ++i) {
              final InstalledPackage pyPackage=(InstalledPackage)myPackagesTableModel.getValueAt(i,0);
              final RepoPackage repoPackage=packageMap.get(pyPackage.getName());
              myPackagesTableModel.setValueAt(repoPackage == null ? null : repoPackage.getLatestVersion(),i,2);
            }
            myPackagesTable.setPaintBusy(false);
          }
        }
,ModalityState.stateForComponent(myPackagesTable));
      }
 catch (      IOException ignored) {
        myPackagesTable.setPaintBusy(false);
      }
    }
  }
);
}
