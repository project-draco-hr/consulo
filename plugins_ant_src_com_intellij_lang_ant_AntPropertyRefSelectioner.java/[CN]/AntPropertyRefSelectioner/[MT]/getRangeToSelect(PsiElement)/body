{
  final PsiFile containingFile=e.getContainingFile();
  if (containingFile == null) {
    return null;
  }
  final AntFile antFile=AntSupport.getAntFile(containingFile);
  if (antFile == null) {
    return null;
  }
  final PsiElement antElement=antFile.findElementAt(e.getTextOffset());
  if (antElement == null) {
    return null;
  }
  final TextRange antElementRange=antElement.getTextRange();
  final TextRange selectionElementRange=e.getTextRange();
  final PsiReference[] refs=antElement.getReferences();
  for (  PsiReference ref : refs) {
    if (ref instanceof AntPropertyReference) {
      TextRange refRange=ref.getRangeInElement();
      refRange=refRange.shiftRight(antElementRange.getStartOffset());
      if (selectionElementRange.contains(refRange)) {
        return refRange;
      }
    }
  }
  return null;
}
