{
  List<TextRange> rangesToSelect=getRangesToSelect(e);
  for (Iterator it=rangesToSelect.iterator(); it.hasNext(); ) {
    final TextRange range=(TextRange)it.next();
    if (!range.contains(cursorOffset)) {
      it.remove();
    }
  }
  return rangesToSelect;
}
