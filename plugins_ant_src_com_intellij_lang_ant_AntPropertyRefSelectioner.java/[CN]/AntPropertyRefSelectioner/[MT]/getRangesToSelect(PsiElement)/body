{
  final PsiFile containingFile=e.getContainingFile();
  if (containingFile == null) {
    return Collections.emptyList();
  }
  final AntFile antFile=AntSupport.getAntFile(containingFile);
  if (antFile == null) {
    return Collections.emptyList();
  }
  final PsiElement antElement=antFile.findElementAt(e.getTextOffset());
  if (antElement == null) {
    return Collections.emptyList();
  }
  final TextRange antElementRange=antElement.getTextRange();
  final TextRange selectionElementRange=e.getTextRange();
  final PsiReference[] refs=antElement.getReferences();
  ArrayList<TextRange> ranges=new ArrayList<TextRange>(refs.length);
  for (  PsiReference ref : refs) {
    if (ref instanceof AntPropertyReference) {
      TextRange refRange=ref.getRangeInElement();
      refRange=refRange.shiftRight(antElementRange.getStartOffset());
      if (selectionElementRange.contains(refRange)) {
        ranges.add(refRange);
      }
    }
  }
  return ranges;
}
