{
  super.visitAnnotation(annotation);
  if (!JCiPUtil.isGuardedByAnnotation(annotation)) {
    return;
  }
  final String guardValue=JCiPUtil.getGuardValue(annotation);
  if (guardValue == null || "this".equals(guardValue) || "itself".equals(guardValue)) {
    return;
  }
  final PsiClass containingClass=PsiTreeUtil.getParentOfType(annotation,PsiClass.class);
  if (containingClass == null) {
    return;
  }
  if (containingClass.findFieldByName(guardValue,true) != null) {
    return;
  }
  if (guardValue.endsWith("()")) {
    final PsiMethod[] methods=containingClass.findMethodsByName(StringUtil.trimEnd(guardValue,"()"),true);
    for (    PsiMethod method : methods) {
      if (method.getParameterList().getParameters().length == 0) {
        return;
      }
    }
  }
  final Project project=containingClass.getProject();
  final JavaPsiFacade facade=JavaPsiFacade.getInstance(project);
  if (guardValue.endsWith(".class") && facade.findClass(StringUtil.getPackageName(guardValue),GlobalSearchScope.allScope(project)) != null) {
    return;
  }
  final String classFQName=StringUtil.getPackageName(guardValue);
  final PsiClass gClass=facade.findClass(classFQName,GlobalSearchScope.allScope(project));
  if (gClass != null) {
    final String fieldName=StringUtil.getShortName(guardValue);
    if (gClass.findFieldByName(fieldName,true) != null) {
      return;
    }
  }
  final PsiAnnotationMemberValue member=annotation.findAttributeValue("value");
  if (member == null) {
    return;
  }
  myHolder.registerProblem(member,"Unknown @GuardedBy field #ref #loc");
}
