{
  if (isMovedFromOutside(e) && isMovedToOutside(e))   return;
  if (isMovedFromOutside(e)) {
    if (notAllowedOrNotUnderContentRoot(e))     return;
    myState.create(e.getFile());
  }
 else {
    VirtualFile f=new ReparentedVirtualFile(e.getOldParent(),e.getFile());
    if (isMovedToOutside(e)) {
      myState.delete(f);
    }
 else {
      myState.move(f,e.getNewParent());
    }
  }
}
