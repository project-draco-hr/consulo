{
  final RadContainer parent=FormEditingUtil.getSelectionParent(selection);
  e.getPresentation().setEnabled(parent != null && (parent.isGrid() || parent.getLayoutManager().canAddWithoutConstraints()));
  if (selection.size() > 1 && parent != null && parent.isGrid()) {
    int aRow=selection.get(0).getConstraints().getRow();
    int aRowSpan=selection.get(0).getConstraints().getRowSpan();
    for (int i=1; i < selection.size(); i++) {
      final RadComponent c=selection.get(i);
      if (c.getConstraints().getRowSpan() > 1 || aRowSpan > 1) {
        if (c.getConstraints().getRow() != aRow || c.getConstraints().getRowSpan() != aRowSpan) {
          e.getPresentation().setEnabled(false);
          break;
        }
      }
    }
  }
}
