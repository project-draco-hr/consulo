{
  final DebuggerTreeNodeImpl node=getSelectedNode(event.getDataContext());
  if (node == null) {
    return;
  }
  final NodeDescriptorImpl descriptor=node.getDescriptor();
  if (!(descriptor instanceof ValueDescriptorImpl)) {
    return;
  }
  final DebuggerTree tree=node.getTree();
  tree.saveState(node);
  final ValueDescriptorImpl valueDescriptor=((ValueDescriptorImpl)descriptor);
  final DebuggerContextImpl debuggerContext=tree.getDebuggerContext();
  final ValueMarkup markup=valueDescriptor.getMarkup(debuggerContext);
  if (markup != null) {
    valueDescriptor.setMarkup(debuggerContext,null);
  }
 else {
    final ValueMarkup valueMarkup=ObjectMarkupPropertiesDialog.chooseMarkup();
    if (valueMarkup != null) {
      valueDescriptor.setMarkup(debuggerContext,valueMarkup);
    }
 else {
      return;
    }
  }
  final DebuggerSession session=debuggerContext.getDebuggerSession();
  if (session != null) {
    session.refresh(false);
  }
}
