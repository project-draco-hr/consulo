{
  final Project project=vcsContext.getProject();
  final VirtualFile selectedFile=vcsContext.getSelectedFiles()[0];
  final FileDocumentManager fileDocumentManager=FileDocumentManager.getInstance();
  final Document document=fileDocumentManager.getDocument(selectedFile);
  if (document != null) {
    fileDocumentManager.saveDocument(document);
  }
  final ProjectLevelVcsManager vcsManager=ProjectLevelVcsManager.getInstance(project);
  final AbstractVcs vcs=vcsManager.getVcsFor(selectedFile);
  final DiffProvider diffProvider=vcs.getDiffProvider();
  final DiffActionExecutor actionExecutor=getExecutor(diffProvider,selectedFile,project);
  actionExecutor.showDiff();
}
