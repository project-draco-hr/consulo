{
  final Set<Pair<String,String>> attrsInStyle=new HashSet<Pair<String,String>>();
  for (  AndroidAttributeInfo info : myAttrMap.keySet()) {
    attrsInStyle.add(Pair.create(info.getNamespace(),info.getName()));
  }
  for (  UsageInfo usage : usages) {
    final PsiElement element=usage.getElement();
    final DomElement domElement=element instanceof XmlTag ? DomManager.getDomManager(myProject).getDomElement((XmlTag)element) : null;
    if (domElement instanceof LayoutViewElement) {
      final List<XmlAttribute> attributesToDelete=new ArrayList<XmlAttribute>();
      for (      XmlAttribute attribute : ((XmlTag)element).getAttributes()) {
        if (attrsInStyle.contains(Pair.create(attribute.getNamespace(),attribute.getLocalName()))) {
          attributesToDelete.add(attribute);
        }
      }
      ApplicationManager.getApplication().runWriteAction(new Runnable(){
        @Override public void run(){
          for (          XmlAttribute attribute : attributesToDelete) {
            attribute.delete();
          }
          ((LayoutViewElement)domElement).getStyle().setStringValue("@style/" + myStyleName);
        }
      }
);
    }
  }
  final PsiFile file=myStyleTag.getContainingFile();
  if (file != null) {
    UndoUtil.markPsiFileForUndo(file);
  }
  if (myContext != null) {
    UndoUtil.markPsiFileForUndo(myContext);
  }
}
