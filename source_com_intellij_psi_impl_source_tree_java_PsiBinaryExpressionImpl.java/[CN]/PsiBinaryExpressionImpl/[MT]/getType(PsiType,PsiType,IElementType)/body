{
  if (sign == PLUS) {
    if (rType == null)     return null;
    if (rType.equalsToText("java.lang.String")) {
      return rType;
    }
    if (lType == null)     return null;
    if (lType.equalsToText("java.lang.String")) {
      return lType;
    }
    return TypeConversionUtil.unboxAndBalanceTypes(lType,rType);
  }
  if (sign == MINUS || sign == ASTERISK || sign == DIV || sign == PERC) {
    if (lType == null && rType == null)     return null;
    return TypeConversionUtil.unboxAndBalanceTypes(lType,rType);
  }
  if (sign == LTLT || sign == GTGT || sign == GTGTGT) {
    if (lType == PsiType.BYTE || lType == PsiType.CHAR || lType == PsiType.SHORT) {
      return PsiType.INT;
    }
    return lType;
  }
  if (sign == EQEQ || sign == NE || sign == LT || sign == GT || sign == LE || sign == GE || sign == OROR || sign == ANDAND) {
    return PsiType.BOOLEAN;
  }
  if (sign == OR || sign == XOR || sign == AND) {
    if (lType instanceof PsiClassType)     lType=PsiPrimitiveType.getUnboxedType(lType);
    if (rType instanceof PsiClassType)     rType=PsiPrimitiveType.getUnboxedType(rType);
    if (lType == null && rType == null)     return null;
    if (lType == PsiType.BOOLEAN || rType == PsiType.BOOLEAN)     return PsiType.BOOLEAN;
    if (lType == PsiType.LONG || rType == PsiType.LONG)     return PsiType.LONG;
    return PsiType.INT;
  }
  LOG.assertTrue(false);
  return null;
}
