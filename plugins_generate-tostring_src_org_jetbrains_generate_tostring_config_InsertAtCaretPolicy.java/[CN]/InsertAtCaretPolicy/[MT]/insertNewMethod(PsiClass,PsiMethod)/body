{
  Project project=clazz.getProject();
  PsiAdapter psi=PsiAdapterFactory.getPsiAdapter();
  PsiJavaFile javaFile=psi.getSelectedJavaFile(project,psi.getPsiManager(project));
  Editor editor=psi.getSelectedEditor(project);
  PsiElement cur=psi.findElementAtCursorPosition(javaFile,editor);
  if (beforeLeftBrace(cur,clazz)) {
    clazz.addAfter(newMethod,clazz.getLBrace());
  }
 else   if (beforeRightBrace(cur,clazz)) {
    PsiElement spot=findBestSpotToInsert(cur);
    if (spot != null) {
      clazz.addAfter(newMethod,spot);
    }
 else {
      clazz.addAfter(newMethod,cur);
    }
  }
 else {
    clazz.addBefore(newMethod,clazz.getRBrace());
  }
  return true;
}
