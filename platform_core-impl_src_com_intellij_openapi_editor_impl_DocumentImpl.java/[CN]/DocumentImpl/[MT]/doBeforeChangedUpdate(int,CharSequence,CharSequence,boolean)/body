{
  VirtualFile file=FileDocumentManager.getInstance().getFile(this);
  if (file != null && !file.isValid()) {
    LOG.error("File of this document has been deleted.");
  }
  DocumentEvent event=new DocumentEventImpl(this,offset,oldString,newString,myModificationStamp,wholeTextReplaced);
  if (!ShutDownTracker.isShutdownHookRunning()) {
    DocumentListener[] listeners=getCachedListeners();
    for (int i=listeners.length - 1; i >= 0; i--) {
      try {
        listeners[i].beforeDocumentChange(event);
      }
 catch (      Throwable e) {
        LOG.error(e);
      }
    }
  }
  myEventsHandling=true;
  return event;
}
