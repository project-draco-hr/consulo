{
  assertNotNestedModification();
  myChangeInProgress=true;
  final DocumentEvent event;
  try {
    event=doBeforeChangedUpdate(offset,oldString,newString,wholeTextReplaced);
  }
  finally {
    myChangeInProgress=false;
  }
  myTextString=null;
  myText=newText;
  changedUpdate(event,newModificationStamp);
}
