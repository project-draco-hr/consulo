{
  if (offset < 0)   throw new IndexOutOfBoundsException("Wrong offset: " + offset);
  if (offset > getTextLength()) {
    throw new IndexOutOfBoundsException("Wrong offset: " + offset + "; documentLength: "+ getTextLength()+ "; "+ s.subSequence(Math.max(0,s.length() - 20),s.length()));
  }
  assertWriteAccess();
  assertValidSeparators(s);
  assertNotNestedModification();
  if (!isWritable())   throw new ReadOnlyModificationException(this);
  if (s.length() == 0)   return;
  RangeMarker marker=getRangeGuard(offset,offset);
  if (marker != null) {
    throwGuardedFragment(marker,offset,null,s.toString());
  }
  myText.insert(s,offset);
}
