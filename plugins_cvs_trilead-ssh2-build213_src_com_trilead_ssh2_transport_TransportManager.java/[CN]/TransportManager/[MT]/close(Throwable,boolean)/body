{
  if (useDisconnectPacket == false) {
    try {
      sock.close();
    }
 catch (    IOException ignore) {
    }
  }
synchronized (connectionSemaphore) {
    if (connectionClosed == false) {
      if (useDisconnectPacket == true) {
        try {
          byte[] msg=new PacketDisconnect(Packets.SSH_DISCONNECT_BY_APPLICATION,cause.getMessage(),"").getPayload();
          if (tc != null)           tc.sendMessage(msg);
        }
 catch (        IOException ignore) {
        }
        try {
          sock.close();
        }
 catch (        IOException ignore) {
        }
      }
      connectionClosed=true;
      reasonClosedCause=cause;
    }
    connectionSemaphore.notifyAll();
  }
  Vector monitors=null;
synchronized (this) {
    if (monitorsWereInformed == false) {
      monitorsWereInformed=true;
      monitors=(Vector)connectionMonitors.clone();
    }
  }
  if (monitors != null) {
    for (int i=0; i < monitors.size(); i++) {
      try {
        ConnectionMonitor cmon=(ConnectionMonitor)monitors.elementAt(i);
        cmon.connectionLost(reasonClosedCause);
      }
 catch (      Exception ignore) {
      }
    }
  }
}
