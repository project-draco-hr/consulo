{
  CheckUtil.checkIsIdentifier(myManager,name);
  if (type == PsiType.NULL) {
    throw new IncorrectOperationException("Cannot create field with type \"<null_type>\".");
  }
  final FileElement treeHolder=new DummyHolder(myManager,null).getTreeElement();
  final CompositeElement treeElement=DeclarationParsing.parseParameterText(myManager,("int " + name).toCharArray(),treeHolder.getCharTable());
  TreeUtil.addChildren(treeHolder,treeElement);
  TreeElement typeElement=ChangeUtil.copyToElement(createTypeElement(type));
  ChangeUtil.replaceChild(treeElement,(TreeElement)treeElement.findChildByRole(ChildRole.TYPE),typeElement);
  ChangeUtil.decodeInformation(typeElement);
  CodeStyleManager codeStyleManager=CodeStyleManager.getInstance(myManager.getProject());
  PsiParameter parameter=(PsiParameter)SourceTreeToPsiMap.treeElementToPsi(treeElement);
  parameter.getModifierList().setModifierProperty(PsiModifier.FINAL,CodeStyleSettingsManager.getSettings(myManager.getProject()).GENERATE_FINAL_PARAMETERS);
  return (PsiParameter)codeStyleManager.reformat(parameter);
}
