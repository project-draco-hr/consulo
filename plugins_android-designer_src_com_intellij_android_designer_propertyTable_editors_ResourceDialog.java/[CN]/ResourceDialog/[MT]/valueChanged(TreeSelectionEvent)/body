{
  Component selectedComponent=myContentPanel.getSelectedComponent();
  if (selectedComponent == myColorPicker) {
    Color color=myColorPicker.getColor();
    setOKActionEnabled(color != null);
    myNewResourceAction.setEnabled(false);
    myResultResourceName=color == null ? null : "#" + toHex(color.getRed()) + toHex(color.getGreen())+ toHex(color.getBlue());
  }
 else {
    boolean isProjectPanel=selectedComponent == myProjectPanel.myComponent;
    ResourcePanel panel=isProjectPanel ? myProjectPanel : mySystemPanel;
    ResourceItem element=getSelectedElement(panel.myTreeBuilder,ResourceItem.class);
    setOKActionEnabled(element != null);
    myNewResourceAction.setEnabled(isProjectPanel && !panel.myTreeBuilder.getSelectedElements().isEmpty());
    if (element == null) {
      myResultResourceName=null;
    }
 else {
      String prefix=panel == myProjectPanel ? "@" : ANDROID;
      myResultResourceName=prefix + element.getName();
    }
  }
}
