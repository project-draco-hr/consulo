{
  String fileName=AndroidResourceUtil.getDefaultResourceFileName(ResourceType.STYLE);
  VirtualFile[] dirs={AndroidRootUtil.getResourceDir(AndroidFacet.getInstance(myModule))};
  List<VirtualFile> subDirs=AndroidResourceUtil.getResourceSubdirs(ResourceFolderType.VALUES.getName(),dirs);
  List<String> dirNames=new ArrayList<String>();
  for (  VirtualFile dir : subDirs) {
    dirNames.add(dir.getName());
  }
  ExtractStyleDialog dialog=new ExtractStyleDialog(myModule,fileName,dirNames,myComponent.getTag());
  dialog.show();
  if (!dialog.isOK()) {
    return;
  }
  final List<XmlAttribute> attributes=dialog.getStyledAttributes();
  StringBuilder value=new StringBuilder();
  for (  XmlAttribute attribute : attributes) {
    value.append("<item name=\"").append(attribute.getName()).append("\">").append(attribute.getValue()).append("</item>\n");
  }
  String resName=dialog.getStyleName();
  if (!AndroidResourceUtil.createValueResource(myModule,resName,ResourceType.STYLE,fileName,dirNames,value.toString())) {
    return;
  }
  PsiDocumentManager.getInstance(myModule.getProject()).commitAllDocuments();
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    @Override public void run(){
      for (      XmlAttribute attribute : attributes) {
        attribute.delete();
      }
    }
  }
);
  myResultResourceName="@style/" + resName;
  close(OK_EXIT_CODE);
}
