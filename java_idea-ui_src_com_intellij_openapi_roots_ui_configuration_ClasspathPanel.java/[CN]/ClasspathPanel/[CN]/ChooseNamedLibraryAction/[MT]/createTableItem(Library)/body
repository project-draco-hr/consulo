{
  final OrderEntry[] orderEntries=getRootModel().getOrderEntries();
  for (  OrderEntry orderEntry : orderEntries) {
    if (orderEntry instanceof LibraryOrderEntry) {
      if (item.getName().equals(((LibraryOrderEntry)orderEntry).getLibraryName())) {
        if (orderEntry.isValid()) {
          Messages.showErrorDialog(ProjectBundle.message("classpath.message.library.already.added",item.getName()),ProjectBundle.message("classpath.title.adding.dependency"));
          return null;
        }
 else {
          getRootModel().removeOrderEntry(orderEntry);
        }
      }
    }
  }
  return new LibItem(getRootModel().addLibraryEntry(item));
}
