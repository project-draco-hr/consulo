{
  final OrderEntry[] orderEntries=getRootModel().getOrderEntries();
  final Set<Library> result=new HashSet<Library>(orderEntries.length);
  for (  OrderEntry orderEntry : orderEntries) {
    if (orderEntry instanceof LibraryOrderEntry && orderEntry.isValid()) {
      final LibraryImpl library=(LibraryImpl)((LibraryOrderEntry)orderEntry).getLibrary();
      if (library != null) {
        result.add(library.getSource());
      }
    }
  }
  return result;
}
