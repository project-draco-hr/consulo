{
  final List<PsiFile> files=findExternalAnnotationsFiles(listOwner);
  if (files == null) {
    return NO_DATA;
  }
  SmartList<AnnotationData> result=new SmartList<AnnotationData>();
  String externalName=getExternalName(listOwner,false);
  if (externalName == null)   return NO_DATA;
  String oldExternalName=getNormalizedExternalName(listOwner);
  for (  PsiFile file : files) {
    if (!file.isValid())     continue;
    if (onlyWritable && !file.isWritable())     continue;
    MostlySingularMultiMap<String,AnnotationData> fileData=getDataFromFile(file);
    Iterable<AnnotationData> data=fileData.get(externalName);
    for (    AnnotationData ad : data) {
      if (result.contains(ad)) {
        if (Comparing.equal(ad.virtualFile,file.getVirtualFile())) {
          LOG.error("Duplicate signature:\n" + externalName + "; in  "+ file);
        }
      }
 else {
        result.add(ad);
      }
    }
    if (oldExternalName != null && !externalName.equals(oldExternalName)) {
      Iterable<AnnotationData> oldCollection=fileData.get(oldExternalName);
      for (      AnnotationData ad : oldCollection) {
        if (result.contains(ad)) {
          LOG.error("Duplicate signature o:\n" + oldExternalName + "; in  "+ toVirtualFiles(files));
        }
 else {
          result.add(ad);
        }
      }
    }
  }
  if (result.isEmpty()) {
    return NO_DATA;
  }
  result.trimToSize();
  return result;
}
