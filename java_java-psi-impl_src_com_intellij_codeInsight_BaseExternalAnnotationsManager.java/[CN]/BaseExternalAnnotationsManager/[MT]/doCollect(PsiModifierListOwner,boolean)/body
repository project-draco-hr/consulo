{
  final List<PsiFile> files=findExternalAnnotationsFiles(listOwner);
  if (files == null) {
    return NO_DATA;
  }
  SmartList<AnnotationData> result=new SmartList<AnnotationData>();
  String externalName=getExternalName(listOwner,false);
  if (externalName == null)   return NO_DATA;
  String oldExternalName=getNormalizedExternalName(listOwner);
  for (  PsiFile file : files) {
    if (!file.isValid())     continue;
    if (onlyWritable && !file.isWritable())     continue;
    MostlySingularMultiMap<String,AnnotationData> fileData=getDataFromFile(file);
    addAnnotations(result,externalName,file,fileData);
    if (oldExternalName != null && !externalName.equals(oldExternalName)) {
      addAnnotations(result,externalName,file,fileData);
    }
  }
  if (result.isEmpty()) {
    return NO_DATA;
  }
  result.trimToSize();
  return result;
}
