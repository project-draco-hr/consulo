{
  final StringBuilder classpathBuffer=StringBuilderSpinAllocator.alloc();
  try {
    final OrderEntry[] orderEntries=CompilerPathsEx.getOrderEntries(module);
    final Set<VirtualFile> processedFiles=new HashSet<VirtualFile>();
    for (    final OrderEntry orderEntry : orderEntries) {
      if (orderEntry instanceof JdkOrderEntry) {
        continue;
      }
      final VirtualFile[] files=orderEntry.getFiles(OrderRootType.COMPILATION_CLASSES);
      for (      VirtualFile file : files) {
        if (processedFiles.contains(file)) {
          continue;
        }
        processedFiles.add(file);
        final String path=PathUtil.getLocalPath(file);
        if (path == null) {
          continue;
        }
        if (classpathBuffer.length() > 0) {
          classpathBuffer.append(File.pathSeparatorChar);
        }
        classpathBuffer.append(path);
      }
    }
    return classpathBuffer.toString();
  }
  finally {
    StringBuilderSpinAllocator.dispose(classpathBuffer);
  }
}
