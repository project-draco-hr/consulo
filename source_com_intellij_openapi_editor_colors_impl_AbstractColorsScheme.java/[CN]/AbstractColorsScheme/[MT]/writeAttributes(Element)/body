{
  Element element;
  List<TextAttributesKey> list=new ArrayList<TextAttributesKey>(myAttributesMap.keySet());
  Collections.sort(list);
  Iterator<TextAttributesKey> itr=list.iterator();
  while (itr.hasNext()) {
    TextAttributesKey key=itr.next();
    TextAttributes value=myAttributesMap.get(key);
    if (myParentScheme != null) {
      if (value.equals(myParentScheme.getAttributes(key))) {
        continue;
      }
    }
    element=new Element("option");
    element.setAttribute("name",key.getExternalName());
    Element valueElement=new Element("value");
    value.writeExternal(valueElement);
    element.addContent(valueElement);
    attrElements.addContent(element);
  }
}
