{
  if (!createStoreFolder())   return;
  StatisticsUnit unit=getUnit(unitNumber);
  String path=getPathToUnit(unitNumber);
  try {
    OutputStream out=new BufferedOutputStream(new FileOutputStream(path));
    out=new ScrambledOutputStream(out);
    try {
      unit.write(out);
    }
  finally {
      out.close();
    }
  }
 catch (  IOException e) {
    Messages.showMessageDialog(IdeBundle.message("error.saving.statistics",e.getLocalizedMessage()),CommonBundle.getErrorTitle(),Messages.getErrorIcon());
  }
}
