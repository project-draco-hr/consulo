{
  final Application application=ApplicationManager.getApplication();
  if (!application.isDispatchThread() && !application.isUnitTestMode()) {
    ApplicationManager.getApplication().invokeLater(new DumbAwareRunnable(){
      @Override public void run(){
        fileStatusChanged(file);
      }
    }
);
    return;
  }
  if (file == null || !file.isValid())   return;
  FileStatus cachedStatus=getCachedStatus(file);
  if (cachedStatus == FileStatusNull.INSTANCE) {
    return;
  }
  if (cachedStatus == null) {
    cacheChangedFileStatus(file,FileStatusNull.INSTANCE);
    return;
  }
  FileStatus newStatus=calcStatus(file);
  if (cachedStatus == newStatus)   return;
  cacheChangedFileStatus(file,newStatus);
  for (  FileStatusListener listener : myListeners) {
    listener.fileStatusChanged(file);
  }
}
