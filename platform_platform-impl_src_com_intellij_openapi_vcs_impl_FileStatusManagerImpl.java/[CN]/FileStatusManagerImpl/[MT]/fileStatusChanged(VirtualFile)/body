{
  final Application application=ApplicationManager.getApplication();
  if (!application.isDispatchThread() && !application.isUnitTestMode()) {
    ApplicationManager.getApplication().invokeLater(new DumbAwareRunnable(){
      public void run(){
        fileStatusChanged(file);
      }
    }
);
    return;
  }
  if ((file == null) || (!file.isValid()))   return;
  FileStatus cachedStatus=getCachedStatus(file);
  if (cachedStatus == null)   return;
  FileStatus newStatus=calcStatus(file);
  if (cachedStatus == newStatus)   return;
  myCachedStatuses.put(file,newStatus);
  for (  FileStatusListener listener : myListeners) {
    listener.fileStatusChanged(file);
  }
}
