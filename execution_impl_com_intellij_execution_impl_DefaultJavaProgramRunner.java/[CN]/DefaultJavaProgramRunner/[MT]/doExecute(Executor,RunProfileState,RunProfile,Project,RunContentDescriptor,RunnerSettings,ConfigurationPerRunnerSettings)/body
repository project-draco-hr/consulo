{
  FileDocumentManager.getInstance().saveAllDocuments();
  ExecutionResult executionResult;
  if (state instanceof JavaCommandLine) {
    patch(((JavaCommandLine)state).getJavaParameters(),state.getRunnerSettings(),true);
    final ProcessProxy proxy=ProcessProxyFactory.getInstance().createCommandLineProxy((JavaCommandLine)state);
    executionResult=state.execute(executor,this);
    if (proxy != null && executionResult != null) {
      proxy.attach(executionResult.getProcessHandler());
    }
  }
 else {
    executionResult=state.execute(executor,this);
  }
  if (executionResult == null) {
    return null;
  }
  onProcessStarted(settings,executionResult);
  final RunContentBuilder contentBuilder=new RunContentBuilder(project,this,executor);
  contentBuilder.setExecutionResult(executionResult);
  contentBuilder.setRunProfile(runProfile,settings,configurationSettings);
  customizeContent(contentBuilder);
  RunContentDescriptor runContent=contentBuilder.showRunContent(contentToReuse);
  AnAction[] actions=createActions(contentBuilder.getExecutionResult());
  for (  AnAction action : actions) {
    contentBuilder.addAction(action);
  }
  return runContent;
}
