{
  int end=myEnd;
  for (int i=0; i < myCurrentHighlighters.size(); i++) {
    RangeHighlighterEx highlighter=myCurrentHighlighters.get(i);
    if (myReverseIteration) {
      if (highlighter.getAffectedAreaStartOffset() > end) {
        end=highlighter.getAffectedAreaStartOffset();
      }
    }
 else {
      if (highlighter.getAffectedAreaEndOffset() < end) {
        end=highlighter.getAffectedAreaEndOffset();
      }
    }
  }
  end=myReverseIteration ? Math.max(end,myDoc.getMinSegmentHighlighterEnd()) : Math.min(end,myDoc.getMinSegmentHighlighterEnd());
  end=myReverseIteration ? Math.max(end,myView.getMinSegmentHighlighterEnd()) : Math.min(end,myView.getMinSegmentHighlighterEnd());
  return end;
}
