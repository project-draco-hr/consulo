{
  final PsiJavaCodeReferenceElement qualifier=thisExpr.getQualifier();
  PsiClass encodedQualifierClass=thisExpr.getCopyableUserData(THIS_QUALIFIER_CLASS_KEY);
  thisExpr.putCopyableUserData(THIS_QUALIFIER_CLASS_KEY,null);
  if (qualifier == null) {
    if (encodedQualifierClass != null && encodedQualifierClass.isValid()) {
      if (encodedQualifierClass.equals(thisClass) && thisAccessExpr != null && thisAccessExpr.isValid()) {
        return thisExpr.replace(thisAccessExpr);
      }
    }
  }
 else {
    PsiClass qualifierClass=(PsiClass)qualifier.resolve();
    if (encodedQualifierClass == qualifierClass && thisClass != null) {
      qualifier.bindToElement(thisClass);
    }
 else {
      if (qualifierClass != null) {
        if (qualifierClass.equals(thisClass) && thisAccessExpr != null && thisAccessExpr.isValid()) {
          return thisExpr.replace(thisAccessExpr);
        }
      }
    }
  }
  return thisExpr;
}
