{
  HgCommandService commandService=HgCommandService.getInstance(project);
  List<String> config=new LinkedList<String>();
  config.add("ui.merge=internal:merge");
  List<String> arguments=new LinkedList<String>();
  if (StringUtils.isNotBlank(revision)) {
    arguments.add("--rev");
    arguments.add(revision);
  }
 else   if (StringUtils.isNotBlank(branch)) {
    arguments.add(branch);
  }
  return commandService.execute(repo,config,"merge",arguments);
}
