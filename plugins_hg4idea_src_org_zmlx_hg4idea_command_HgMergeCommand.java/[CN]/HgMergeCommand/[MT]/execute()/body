{
  HgCommandExecutor commandExecutor=new HgCommandExecutor(project);
  commandExecutor.setShowOutput(true);
  List<String> arguments=new LinkedList<String>();
  if (StringUtils.isNotBlank(revision)) {
    arguments.add("--rev");
    arguments.add(revision);
  }
 else   if (StringUtils.isNotBlank(branch)) {
    arguments.add(branch);
  }
  final HgCommandResult result=commandExecutor.executeInCurrentThread(repo,"merge",arguments);
  project.getMessageBus().syncPublisher(HgVcs.BRANCH_TOPIC).update(project);
  return result;
}
