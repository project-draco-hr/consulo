{
synchronized (lock) {
    if (buffer == null) {
      throw new NullPointerException();
    }
    if (pos < 0) {
      pos=0;
    }
    if (pos >= bufferEnd) {
      if (pos == bufferEnd)       pos++;
      return -1;
    }
 else {
      return buffer[pos++];
    }
  }
}
