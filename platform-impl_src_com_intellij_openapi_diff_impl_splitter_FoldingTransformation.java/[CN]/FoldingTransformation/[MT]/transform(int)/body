{
  FoldRegion foldRegion=findFoldRegion(line);
  int yOffset=0;
  if (foldRegion != null) {
    int startLine=getStartLine(foldRegion);
    yOffset=(int)((double)(line - startLine) / getLineLength(foldRegion) * myEditor.getLineHeight());
    line=startLine;
  }
  yOffset+=myEditor.logicalPositionToXY(new LogicalPosition(line,0)).y;
  final JComponent header=myEditor.getHeaderComponent();
  int headerOffset=header == null ? 0 : header.getHeight();
  return yOffset - myEditor.getScrollingModel().getVerticalScrollOffset() + headerOffset;
}
