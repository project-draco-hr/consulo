{
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    @Override public void run(){
      Library lib=myLibraryManager.createLibrary(name);
      if (lib != null) {
        Library.ModifiableModel libModel=lib.getModifiableModel();
        for (        VirtualFile file : files) {
          libModel.addRoot(file,OrderRootType.SOURCES);
        }
        libModel.commit();
        fireLibTableChanged();
      }
    }
  }
);
}
