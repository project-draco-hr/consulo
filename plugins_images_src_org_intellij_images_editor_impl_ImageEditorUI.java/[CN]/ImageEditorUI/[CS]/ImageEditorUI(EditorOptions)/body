{
  ImageDocument document=imageComponent.getDocument();
  document.addChangeListener(changeListener);
  TransparencyChessboardOptions chessboardOptions=editorOptions.getTransparencyChessboardOptions();
  GridOptions gridOptions=editorOptions.getGridOptions();
  imageComponent.setTransparencyChessboardCellSize(chessboardOptions.getCellSize());
  imageComponent.setTransparencyChessboardWhiteColor(chessboardOptions.getWhiteColor());
  imageComponent.setTransparencyChessboardBlankColor(chessboardOptions.getBlackColor());
  imageComponent.setGridLineZoomFactor(gridOptions.getLineZoomFactor());
  imageComponent.setGridLineSpan(gridOptions.getLineSpan());
  imageComponent.setGridLineColor(gridOptions.getLineColor());
  JScrollPane scrollPane=new JScrollPane(new ImageContainerPane(imageComponent));
  scrollPane.setVerticalScrollBarPolicy(JScrollPane.VERTICAL_SCROLLBAR_AS_NEEDED);
  scrollPane.setHorizontalScrollBarPolicy(JScrollPane.HORIZONTAL_SCROLLBAR_AS_NEEDED);
  scrollPane.addMouseWheelListener(wheelAdapter);
  setLayout(new BorderLayout());
  ActionManager actionManager=ActionManager.getInstance();
  ActionGroup actionGroup=(ActionGroup)actionManager.getAction(ImageEditorActions.GROUP_TOOLBAR);
  ActionToolbar actionToolbar=actionManager.createActionToolbar(ImageEditorActions.GROUP_TOOLBAR,actionGroup,true);
  FocusRequester focusRequester=new FocusRequester();
  JComponent component=actionToolbar.getComponent();
  component.addMouseListener(focusRequester);
  scrollPane.addMouseListener(focusRequester);
  JLabel errorLabel=new JLabel("<html><b>Image not loaded</b><br>Try to open it externaly to fix format problem</html>",Messages.getErrorIcon(),JLabel.CENTER);
  JPanel errorPanel=new JPanel(new BorderLayout());
  errorPanel.add(errorLabel,BorderLayout.CENTER);
  contentPanel=new JPanel(new CardLayout());
  contentPanel.add(scrollPane,IMAGE_PANEL);
  contentPanel.add(errorPanel,ERROR_PANEL);
  add(component,BorderLayout.NORTH);
  add(contentPanel,BorderLayout.CENTER);
}
