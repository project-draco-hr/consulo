{
  for (  VirtualFile f : roots) {
    indicator.checkCanceled();
    try {
      indicator.setText2(f.getPath());
      if (f.isDirectory()) {
        if (lookForNested) {
          f.refresh(false,false);
          findPomFiles(f.getChildren(),lookForNested,indicator,result);
        }
      }
 else {
        if (f.getName().equalsIgnoreCase(MavenConstants.POM_XML)) {
          result.add(f);
        }
      }
    }
 catch (    InvalidVirtualFileAccessException e) {
      MavenLog.LOG.info(e);
    }
  }
  return result;
}
