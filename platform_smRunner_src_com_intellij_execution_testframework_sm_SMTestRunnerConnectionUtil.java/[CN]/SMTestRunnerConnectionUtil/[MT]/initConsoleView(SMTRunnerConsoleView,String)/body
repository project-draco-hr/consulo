{
  consoleView.addAttachToProcessListener(new AttachToProcessListener(){
    @Override public void onAttachToProcess(    @NotNull ProcessHandler processHandler){
      TestConsoleProperties properties=consoleView.getProperties();
      TestProxyPrinterProvider printerProvider=null;
      if (properties instanceof SMTRunnerConsoleProperties) {
        TestProxyFilterProvider filterProvider=((SMTRunnerConsoleProperties)properties).getFilterProvider();
        if (filterProvider != null) {
          printerProvider=new TestProxyPrinterProvider(consoleView,filterProvider);
        }
      }
      SMTestLocator testLocator=FileUrlProvider.INSTANCE;
      if (properties instanceof SMTRunnerConsoleProperties) {
        SMTestLocator customLocator=((SMTRunnerConsoleProperties)properties).getTestLocator();
        if (customLocator != null) {
          testLocator=new CombinedTestLocator(customLocator);
        }
      }
      boolean idBasedTestTree=false;
      if (properties instanceof SMTRunnerConsoleProperties) {
        idBasedTestTree=((SMTRunnerConsoleProperties)properties).isIdBasedTestTree();
      }
      SMTestRunnerResultsForm resultsForm=consoleView.getResultsViewer();
      attachEventsProcessors(properties,resultsForm,resultsForm.getStatisticsPane(),processHandler,testFrameworkName,testLocator,idBasedTestTree,printerProvider);
    }
  }
);
  consoleView.setHelpId("reference.runToolWindow.testResultsTab");
  consoleView.initUI();
}
