{
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    public void run(){
      final ModifiableRootModel rootModel=ModuleRootManager.getInstance(myModule).getModifiableModel();
      final Library jarLibrary=rootModel.getModuleLibraryTable().createLibrary();
      final Library.ModifiableModel libraryModel=jarLibrary.getModifiableModel();
      libraryModel.addRoot(myDir,OrderRootType.CLASSES);
      libraryModel.commit();
      rootModel.commit();
    }
  }
);
}
