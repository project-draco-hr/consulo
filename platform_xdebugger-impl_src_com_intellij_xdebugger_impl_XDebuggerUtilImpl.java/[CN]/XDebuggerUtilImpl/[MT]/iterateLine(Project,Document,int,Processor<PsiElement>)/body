{
  PsiFile file=PsiDocumentManager.getInstance(project).getPsiFile(document);
  if (file == null) {
    return;
  }
  int lineStart;
  int lineEnd;
  try {
    lineStart=document.getLineStartOffset(line);
    lineEnd=document.getLineEndOffset(line);
  }
 catch (  IndexOutOfBoundsException ignored) {
    return;
  }
  PsiElement element;
  int offset=lineStart;
  while (offset < lineEnd) {
    element=file.findElementAt(offset);
    if (element != null) {
      if (!processor.process(element)) {
        return;
      }
 else {
        offset=element.getTextRange().getEndOffset();
      }
    }
 else {
      offset++;
    }
  }
}
