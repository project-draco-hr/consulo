{
  int diagDist=encodedStep & DISTANCE_MASK;
  if (diagDist != 0) {
    if (dx != 0 || dy != 0) {
      builder.addChange(dx,dy);
      dx=0;
      dy=0;
    }
    builder.addEqual(diagDist);
  }
  x-=diagDist;
  y-=diagDist;
  boolean verticalStep=(encodedStep & VERTICAL_DIRECTION_FLAG) != 0;
  if (verticalStep) {
    y--;
    dy++;
  }
 else {
    x--;
    dx++;
  }
}
