{
  FileTemplateDescriptor templateDesc=methodKind.getFileTemplateDescriptor(descriptor);
  String templateName=templateDesc.getFileName();
  FileTemplate fileTemplate=FileTemplateManager.getInstance().getCodeTemplate(templateName);
  Template template=TemplateManager.getInstance(targetClass.getProject()).createTemplate("","");
  String templateText=fileTemplate.getText();
  int index=templateText.indexOf("${NAME}");
  if (index == -1) {
    template.addTextSegment(templateText);
  }
 else {
    if (index > 0 && !Character.isWhitespace(templateText.charAt(index - 1))) {
      name=StringUtil.capitalize(name);
    }
 else {
      name=StringUtil.decapitalize(name);
    }
    template.addTextSegment(templateText.substring(0,index));
    Expression nameExpr=new ConstantNode(name);
    template.addVariable("",nameExpr,nameExpr,!automatic);
    template.addTextSegment(templateText.substring(index + "${NAME}".length(),templateText.length()));
  }
  return template;
}
