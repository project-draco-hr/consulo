{
  PsiElement[] elements;
  GrExpression expr=findElementInRange(file,startOffset,endOffset,GrExpression.class);
  if (expr != null) {
    PsiElement parent=expr.getParent();
    if (expr.getParent() instanceof GrMethodCallExpression || parent instanceof GrIndexProperty) {
      expr=((GrExpression)expr.getParent());
    }
    elements=new PsiElement[]{expr};
  }
 else {
    elements=findStatementsInRange(file,startOffset,endOffset,true);
  }
  return elements;
}
