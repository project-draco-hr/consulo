{
  final String key=getKeyText();
  List<Property> properties;
  final List<PropertiesFile> propertiesFiles=getPropertiesFiles();
  if (propertiesFiles == null) {
    properties=PropertiesUtil.findPropertiesByKey(getElement().getProject(),key);
  }
 else {
    properties=new ArrayList<Property>();
    for (    PropertiesFile propertiesFile : propertiesFiles) {
      properties.addAll(propertiesFile.findPropertiesByKey(key));
    }
  }
  ContainerUtil.quickSort(properties,new Comparator<Property>(){
    public int compare(    final Property o1,    final Property o2){
      String name1=o1.getContainingFile().getName();
      String name2=o2.getContainingFile().getName();
      return Comparing.compare(name1,name2);
    }
  }
);
  return PsiElementResolveResult.createResults(properties);
}
