{
  final MultiMap<VirtualFile,RequestWithProcessor> local=createMultiMap();
  ApplicationManager.getApplication().runReadAction(new Runnable(){
    @Override public void run(){
      if (progress != null)       progress.checkCanceled();
      FileBasedIndex.getInstance().processValues(IdIndex.NAME,entry,null,new FileBasedIndex.ValueProcessor<Integer>(){
        @Override public boolean process(        VirtualFile file,        Integer value){
          if (progress != null)           progress.checkCanceled();
          if (index.shouldBeFound(commonScope,file)) {
            int mask=value.intValue();
            for (            RequestWithProcessor single : data) {
              final PsiSearchRequest request=single.request;
              if ((mask & request.searchContext) != 0 && ((GlobalSearchScope)request.searchScope).contains(file)) {
                local.putValue(file,single);
              }
            }
          }
          return true;
        }
      }
,commonScope);
    }
  }
);
  return local;
}
