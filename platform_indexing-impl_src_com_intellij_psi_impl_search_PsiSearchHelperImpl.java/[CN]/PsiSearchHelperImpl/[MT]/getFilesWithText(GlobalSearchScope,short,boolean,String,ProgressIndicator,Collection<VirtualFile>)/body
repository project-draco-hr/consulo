{
  myManager.startBatchFilesProcessingMode();
  try {
    Processor<VirtualFile> processor=new CommonProcessors.CollectProcessor<VirtualFile>(result){
      @Override public boolean process(      VirtualFile file){
        progress.checkCanceled();
        return super.process(file);
      }
    }
;
    boolean success=processFilesWithText(scope,searchContext,caseSensitively,text,processor);
  }
  finally {
    myManager.finishBatchFilesProcessingMode();
  }
}
