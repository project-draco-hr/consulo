{
  final File file=new File(virtualFile.getPath());
  final File cvsLightweightFile=CvsUtil.getCvsLightweightFileForFile(file);
  final String revision=CvsUtil.getRevisionFor(file);
  final CvsConnectionSettings root=CvsEntriesManager.getInstance().getCvsConnectionSettingsFor(file.getParentFile());
  final AnnotateOperation operation=executeOperation(cvsLightweightFile,revision,root,true);
  final FilePath filePath=VcsContextFactory.SERVICE.getInstance().createFilePathOn(virtualFile);
  final List<VcsFileRevision> revisions=myCvsHistoryProvider.createRevisions(filePath);
  final Annotation[] lineAnnotations=operation.getLineAnnotations();
  adjustAnnotation(revisions,lineAnnotations);
  return new CvsFileAnnotation(operation.getContent(),lineAnnotations,revisions,virtualFile);
}
