{
  clear();
  mySeparator=false;
  mySeparatorText=null;
  if (myComboBox != null) {
    setEnabled(myComboBox.isEnabled());
  }
  setFont(list.getFont());
  mySelected=selected;
  myForeground=isEnabled() ? list.getForeground() : UIManager.getColor("Label.disabledForeground");
  mySelectionForeground=list.getSelectionForeground();
  if (index == -1) {
    setOpaque(false);
    mySelected=false;
  }
 else {
    setOpaque(true);
    setBackground(selected ? list.getSelectionBackground() : null);
  }
  setPaintFocusBorder(hasFocus);
  customizeCellRenderer(list,value,index,selected,hasFocus);
  if (mySeparator) {
    final TitledSeparator separator=new TitledSeparator(mySeparatorText);
    separator.setBorder(JBUI.Borders.empty(0,2,0,0));
    if (!UIUtil.isUnderGTKLookAndFeel()) {
      separator.setOpaque(false);
      separator.setBackground(UIUtil.TRANSPARENT_COLOR);
      separator.getLabel().setOpaque(false);
      separator.getLabel().setBackground(UIUtil.TRANSPARENT_COLOR);
    }
    return separator;
  }
  if (myDefaultGtkRenderer != null && list.getModel() instanceof ComboBoxModel) {
    final Component component=myDefaultGtkRenderer.getListCellRendererComponent(list,value,index,selected,hasFocus);
    if (component instanceof JLabel) {
      return formatToLabel((JLabel)component);
    }
  }
  return this;
}
