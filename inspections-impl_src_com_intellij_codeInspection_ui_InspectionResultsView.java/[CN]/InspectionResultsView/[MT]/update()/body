{
  InspectionTool[] tools=myInspectionProfile.getInspectionTools();
  clearTree();
  boolean resultsFound=false;
  final InspectionManagerEx manager=((InspectionManagerEx)InspectionManagerEx.getInstance(myProject));
  final boolean isGroupedBySeverity=manager.getUIOptions().GROUP_BY_SEVERITY;
  myGroups=new HashMap<HighlightDisplayLevel,Map<String,InspectionGroupNode>>();
  for (  InspectionTool tool : tools) {
    final HighlightDisplayKey key=HighlightDisplayKey.find(tool.getShortName());
    if (myInspectionProfile.isToolEnabled(key)) {
      addTool(tool,myInspectionProfile.getErrorLevel(key),isGroupedBySeverity);
      resultsFound|=tool.hasReportedProblems();
    }
  }
  myTree.sort();
  myTree.restoreExpantionAndSelection();
  return resultsFound;
}
