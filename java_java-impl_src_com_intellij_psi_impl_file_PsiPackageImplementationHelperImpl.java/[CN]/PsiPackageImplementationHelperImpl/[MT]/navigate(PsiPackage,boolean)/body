{
  final Project project=psiPackage.getProject();
  ToolWindow window=ToolWindowManager.getInstance(project).getToolWindow(ToolWindowId.PROJECT_VIEW);
  window.activate(null);
  window.getActivation().doWhenDone(new Runnable(){
    @Override public void run(){
      final ProjectView projectView=ProjectView.getInstance(project);
      projectView.changeView(PackageViewPane.ID);
      final PsiDirectory[] directories=psiPackage.getDirectories();
      final VirtualFile firstDir=directories[0].getVirtualFile();
      final boolean isLibraryRoot=ProjectRootsUtil.isLibraryRoot(firstDir,project);
      final Module module=ProjectRootManager.getInstance(project).getFileIndex().getModuleForFile(firstDir);
      final PackageElement packageElement=new PackageElement(module,psiPackage,isLibraryRoot);
      projectView.getProjectViewPaneById(PackageViewPane.ID).select(packageElement,firstDir,requestFocus);
    }
  }
);
}
