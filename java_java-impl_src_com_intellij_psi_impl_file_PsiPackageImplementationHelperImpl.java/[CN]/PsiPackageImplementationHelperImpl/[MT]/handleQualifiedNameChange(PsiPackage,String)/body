{
  ApplicationManager.getApplication().assertWriteAccessAllowed();
  final String oldQualifedName=psiPackage.getQualifiedName();
  final boolean anyChanged=changePackagePrefixes(psiPackage,oldQualifedName,newQualifiedName);
  if (anyChanged) {
    UndoManager.getInstance(psiPackage.getProject()).undoableActionPerformed(new GlobalUndoableAction(){
      public void undo(){
        changePackagePrefixes(psiPackage,newQualifiedName,oldQualifedName);
      }
      public void redo(){
        changePackagePrefixes(psiPackage,oldQualifedName,newQualifiedName);
      }
    }
);
  }
}
