{
synchronized (myDocumentToStatusMap) {
    FileStatus status=myDocumentToStatusMap.get(document);
    if (status == null) {
      PsiFile file=PsiDocumentManager.getInstance(myProject).getPsiFile(document);
      return file == null ? null : file.getTextRange();
    }
    if (status.defensivelyMarked) {
      PsiFile file=PsiDocumentManager.getInstance(myProject).getPsiFile(document);
      status.dirtyScope=status.localInspectionsDirtyScope=file == null ? null : file.getTextRange();
      status.defensivelyMarked=false;
    }
switch (passId) {
case Pass.UPDATE_ALL:
      return status.dirtyScope;
case Pass.LOCAL_INSPECTIONS:
    return status.localInspectionsDirtyScope;
case Pass.EXTERNAL_TOOLS:
  return status.externalDirtyScope;
default :
if (status.customPassDirtyScopes.containsKey(passId)) {
  return status.customPassDirtyScopes.get(passId);
}
LOG.assertTrue(false);
return null;
}
}
}
