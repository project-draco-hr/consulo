{
  Condition<PsiElement> insideDeletedCondition=getUsageInsideDeletedFilter(allElementsToDelete);
  if (element instanceof PsiClass) {
    findClassUsages((PsiClass)element,allElementsToDelete,usages);
    if (element instanceof PsiTypeParameter) {
      findTypeParameterExternalUsages((PsiTypeParameter)element,usages);
    }
  }
 else   if (element instanceof PsiMethod) {
    insideDeletedCondition=findMethodUsages((PsiMethod)element,allElementsToDelete,usages);
  }
 else   if (element instanceof PsiField) {
    insideDeletedCondition=findFieldUsages((PsiField)element,usages,allElementsToDelete);
  }
 else   if (element instanceof PsiParameter) {
    LOG.assertTrue(((PsiParameter)element).getDeclarationScope() instanceof PsiMethod);
    findParameterUsages((PsiParameter)element,usages);
  }
 else   if (element instanceof PsiLocalVariable) {
    for (    PsiReference reference : ReferencesSearch.search(element)) {
      PsiReferenceExpression referencedElement=(PsiReferenceExpression)reference.getElement();
      final PsiStatement statement=PsiTreeUtil.getParentOfType(referencedElement,PsiStatement.class);
      boolean isSafeToDelete=PsiUtil.isAccessedForWriting(referencedElement);
      boolean hasSideEffects=false;
      if (PsiUtil.isOnAssignmentLeftHand(referencedElement)) {
        hasSideEffects=RemoveUnusedVariableUtil.checkSideEffects(((PsiAssignmentExpression)referencedElement.getParent()).getRExpression(),((PsiLocalVariable)element),new ArrayList<PsiElement>());
      }
      usages.add(new SafeDeleteReferenceJavaDeleteUsageInfo(statement,element,isSafeToDelete && !hasSideEffects));
    }
  }
  return new NonCodeUsageSearchInfo(insideDeletedCondition,element);
}
