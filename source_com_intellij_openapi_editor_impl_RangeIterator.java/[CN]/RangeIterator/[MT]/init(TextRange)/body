{
  int rangeStart=range.getStartOffset();
  myRangeEnd=range.getEndOffset();
  while (!mySource.atEnd()) {
    boolean sourceBeforeRange=rangeStart > mySource.getEnd();
    if (!sourceBeforeRange)     break;
    mySource.advance();
  }
  while (!mySource.atEnd() && !checkOutOfRange()) {
    if (myFilter.value(mySource.getTextAttributes()))     break;
    mySource.advance();
  }
  if (mySource.atEnd() || mySourceOutOfRange)   myNextExpanded=NO_NEXT;
 else {
    myNextExpanded=findExpanded(mySource.getStart());
    if (myNextExpanded == NO_NEXT)     myStart=NO_NEXT;
  }
}
