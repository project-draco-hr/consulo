{
  Set<VirtualFile> reverseMap=ContainerUtil.newHashSet();
  for (  GitRepository repository : GitUtil.getRepositoryManager(project).getRepositories()) {
    boolean reverse;
    if (reverseOrDetect == ReverseRequest.DETECT) {
      reverse=repository.getState().equals(GitRepository.State.REBASING);
    }
 else {
      reverse=reverseOrDetect == ReverseRequest.REVERSE;
    }
    if (reverse) {
      reverseMap.add(repository.getRoot());
    }
  }
  return reverseMap;
}
