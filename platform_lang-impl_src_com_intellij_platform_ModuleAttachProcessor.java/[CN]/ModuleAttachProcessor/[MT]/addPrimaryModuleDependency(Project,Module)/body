{
  final Module module=getPrimaryModule(project);
  if (module != null && module != newModule) {
    final ModifiableRootModel modifiableRootModel=ModuleRootManager.getInstance(module).getModifiableModel();
    modifiableRootModel.addModuleOrderEntry(newModule);
    AccessToken token=WriteAction.start();
    try {
      modifiableRootModel.commit();
    }
  finally {
      token.finish();
    }
    return module;
  }
  return null;
}
