{
  for (  Module oldModule : ModuleManager.getInstance(project).getModules()) {
    if (oldModule != newModule) {
      final VirtualFile[] roots=ModuleRootManager.getInstance(oldModule).getContentRoots();
      for (      VirtualFile root : roots) {
        if (root == project.getBaseDir()) {
          final ModifiableRootModel modifiableRootModel=ModuleRootManager.getInstance(oldModule).getModifiableModel();
          modifiableRootModel.addModuleOrderEntry(newModule);
          AccessToken token=WriteAction.start();
          try {
            modifiableRootModel.commit();
          }
  finally {
            token.finish();
          }
          break;
        }
      }
    }
  }
}
