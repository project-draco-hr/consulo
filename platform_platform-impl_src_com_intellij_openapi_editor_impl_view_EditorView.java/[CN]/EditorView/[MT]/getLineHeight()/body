{
synchronized (myLock) {
    if (myLineHeight < 0) {
      EditorColorsScheme colorsScheme=myEditor.getColorsScheme();
      FontMetrics fontMetrics=myEditor.getContentComponent().getFontMetrics(colorsScheme.getFont(EditorFontType.PLAIN));
      int fontMetricsHeight=FontLayoutService.getInstance().getHeight(fontMetrics);
      myLineHeight=(int)(fontMetricsHeight * (myEditor.isOneLineMode() ? 1 : colorsScheme.getLineSpacing()));
      if (myLineHeight <= 0) {
        myLineHeight=fontMetricsHeight;
        if (myLineHeight <= 0) {
          myLineHeight=12;
        }
      }
    }
    return myLineHeight;
  }
}
