{
  PsiElement parent=tag.getParent();
  final String namespace=tag.getNamespace();
  while (parent instanceof XmlTag && !namespace.equals(((XmlTag)parent).getNamespace()))   parent=parent.getContext();
  if (parent instanceof XmlTag) {
    final XmlTag parentTag=(XmlTag)parent;
    final XmlElementDescriptor parentDescriptor=parentTag.getDescriptor();
    if (parentDescriptor != null) {
      return parentDescriptor.getElementDescriptor(tag);
    }
 else {
      return null;
    }
  }
 else {
    return getElementDescriptor(tag.getLocalName(),tag.getNamespace());
  }
}
