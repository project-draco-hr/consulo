{
  if (visitedTags == null)   visitedTags=new HashSet<XmlTag>(3);
 else   if (visitedTags.contains(rootTag))   return true;
  visitedTags.add(rootTag);
  XmlTag[] tags=rootTag.getSubTags();
  NextTag:   for (  XmlTag tag : tags) {
    for (    String tagName : tagNames) {
      if (equalsToSchemaName(tag,tagName)) {
        final String name=tag.getAttributeValue("name");
        if (name != null) {
          if (!processor.execute(tag)) {
            return false;
          }
        }
        continue NextTag;
      }
    }
    if (equalsToSchemaName(tag,"include")) {
      final String schemaLocation=tag.getAttributeValue("schemaLocation");
      if (schemaLocation != null) {
        final XmlFile xmlFile=XmlUtil.findXmlFile(rootTag.getContainingFile(),schemaLocation);
        if (xmlFile != null) {
          final XmlDocument includedDocument=xmlFile.getDocument();
          if (includedDocument != null) {
            if (!processTagsInNamespaceInner(includedDocument.getRootTag(),tagNames,processor,visitedTags))             return false;
          }
        }
      }
    }
  }
  return true;
}
