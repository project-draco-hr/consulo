{
  DfaMemoryStateImpl newState=createNew();
  newState.myStack.addAll(myStack);
  newState.myDistinctClasses.addAll(myDistinctClasses.toArray());
  newState.myStateSize=myStateSize;
  newState.myOffsetStack=new TIntStack(myOffsetStack);
  for (int i=0; i < myEqClasses.size(); i++) {
    SortedIntSet aClass=myEqClasses.get(i);
    newState.myEqClasses.add(aClass != null ? new SortedIntSet(aClass.toNativeArray()) : null);
  }
  for (  DfaVariableValue dfaVariableValue : myVariableStates.keySet()) {
    newState.myVariableStates.put(dfaVariableValue,myVariableStates.get(dfaVariableValue).clone());
  }
  return newState;
}
