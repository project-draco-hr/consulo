{
  final Project project=module.getProject();
  final Library[] libraries=getAllSDKLibraries(project);
  if (libraries.length > 0) {
    final Library library=libraries[0];
    int result=Messages.showOkCancelDialog(GroovyBundle.message("groovy.like.library.found.text",module.getName(),library.getName(),getSDKLibVersion(library)),GroovyBundle.message("groovy.like.library.found"),GroovyIcons.GROOVY_ICON_32x32);
    final Ref<Boolean> ref=new Ref<Boolean>();
    ref.set(false);
    if (result == 0) {
      ApplicationManager.getApplication().runWriteAction(new Runnable(){
        public void run(){
          final ModifiableRootModel model=ModuleRootManager.getInstance(module).getModifiableModel();
          LibraryOrderEntry entry=model.addLibraryEntry(libraries[0]);
          LibrariesUtil.placeEntryToCorrectPlace(model,entry);
          model.commit();
          ref.set(true);
          final FacetManager manager=FacetManager.getInstance(module);
          final GroovyFacetType type=GroovyFacetType.getInstance();
          final FacetTypeId<GroovyFacet> id=type.getId();
          final GroovyFacet facetByType=manager.getFacetByType(id);
          if (facetByType == null) {
            manager.addFacet(type,type.getPresentableName(),null);
          }
        }
      }
);
    }
    return ref.get().booleanValue();
  }
  return false;
}
