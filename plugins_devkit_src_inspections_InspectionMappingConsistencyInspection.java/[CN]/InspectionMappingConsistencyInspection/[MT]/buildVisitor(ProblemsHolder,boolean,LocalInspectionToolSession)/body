{
  return new XmlElementVisitor(){
    @Override public void visitXmlTag(    XmlTag tag){
      DomElement element=DomUtil.getDomElement(tag);
      if (element instanceof Extension) {
        ExtensionPoint target=((Extension)element).getExtensionPoint();
        if (InheritanceUtil.isInheritor(target.getBeanClass().getValue(),"com.intellij.codeInspection.InspectionEP")) {
          if (tag.getAttribute("key") != null || tag.getAttribute("bundleKey") != null) {
            if (tag.getAttribute("bundle") == null && tag.getAttribute("groupBundle") == null) {
              IdeaPlugin plugin=DomUtil.getParentOfType(element,IdeaPlugin.class,true);
              if (plugin != null && plugin.getResourceBundles().isEmpty()) {
                Pair<TextRange,PsiElement> range=DomUtil.getProblemRange(element.getXmlTag());
                holder.registerProblem(range.second,range.first,"Bundle should be specified");
              }
            }
          }
        }
      }
    }
  }
;
}
