{
  final VirtualFile baseDir=ProjectBaseDirectory.getInstance(myProject).getBaseDir();
  if (baseDir != null) {
    final ModuleManager moduleManager=ModuleManager.getInstance(myProject);
    final Module[] modules=moduleManager.getModules();
    if (modules.length == 0) {
      ApplicationManager.getApplication().runWriteAction(new Runnable(){
        public void run(){
          String imlName=PlatformProjectOpenProcessor.getIprBaseName(baseDir) + ".iml";
          final Module module=moduleManager.newModule(imlName,ModuleType.EMPTY);
          ModifiableRootModel rootModel=ModuleRootManager.getInstance(module).getModifiableModel();
          rootModel.addContentEntry(baseDir);
          rootModel.commit();
        }
      }
);
    }
  }
}
