{
  final EditorColorSchemeService editorColorSchemeService=GwtUtil.get(EditorColorSchemeService.KEY);
  HorizontalPanel gridPanel=new HorizontalPanel();
  GwtUtil.fill(gridPanel);
  VerticalPanel editorLinePanel=new VerticalPanel();
  gridPanel.add(editorLinePanel);
  editorLinePanel.addStyleName("noselectable");
  editorLinePanel.addStyleName("editorLinePanel");
  editorLinePanel.getElement().getStyle().setBackgroundColor(GwtStyleUtil.toString(editorColorSchemeService.getScheme().getColor(GwtEditorColorScheme.GUTTER_BACKGROUND)));
  for (int i=0; i < myLineCount; i++) {
    final HorizontalPanel panel=new HorizontalPanel();
    panel.setHorizontalAlignment(HasHorizontalAlignment.ALIGN_RIGHT);
    GwtUtil.fill(panel);
    InlineHTML lineSpan=new InlineHTML(String.valueOf(i + 1));
    lineSpan.addStyleName("editorLineRow");
    lineSpan.addStyleName("editorLine");
    lineSpan.addStyleName("editorGutterLine" + i);
    lineSpan.getElement().getStyle().setColor(GwtStyleUtil.toString(editorColorSchemeService.getScheme().getColor(GwtEditorColorScheme.LINE_NUMBERS_COLOR)));
    panel.add(lineSpan);
    editorLinePanel.add(panel);
  }
  VerticalPanel editorCodePanel=new VerticalPanel(){
{
      sinkEvents(Event.ONCHANGE | Event.ONPASTE | Event.KEYEVENTS);
    }
    @Override public void onBrowserEvent(    Event event){
      event.preventDefault();
    }
  }
;
  gridPanel.add(editorCodePanel);
  GwtUtil.fill(editorCodePanel);
  editorCodePanel.getElement().setAttribute("spellcheck","false");
  editorCodePanel.getElement().setAttribute("contenteditable","true");
  editorCodePanel.addStyleName("noFocusBorder");
  int lineCount=0;
  FlowPanel lineElement=null;
  for (  EditorSegmentBuilder.Fragment fragment : myBuilder.getFragments()) {
    if (lineElement == null) {
      lineElement=new CodeLinePanel();
      lineElement.setWidth("100%");
      lineElement.addStyleName("editorLine");
      lineElement.addStyleName("gen_Line_" + lineCount);
    }
    lineElement.add(fragment.widget);
    if (fragment.lineWrap) {
      editorCodePanel.add(lineElement);
      lineElement=null;
      lineCount++;
    }
  }
  ScrollPanel scrollPanel=new ScrollPanel(gridPanel);
  GwtUtil.fill(scrollPanel);
  DockPanel panel=new DockPanel();
  panel.setHorizontalAlignment(HasHorizontalAlignment.ALIGN_LEFT);
  panel.setWidth("100%");
  panel.add(scrollPanel,DockPanel.CENTER);
  setWidget(panel);
}
