{
  Grid grid=new Grid(myLineCount + 1,2);
  grid.setWidth("100%");
  grid.getColumnFormatter().addStyleName(0,"editorLineColumn");
  grid.getColumnFormatter().addStyleName(1,"editorCodeColumn");
  for (int i=0; i < myLineCount; i++) {
    final HorizontalPanel panel=new HorizontalPanel();
    panel.setHorizontalAlignment(HasHorizontalAlignment.ALIGN_RIGHT);
    panel.setWidth("100%");
    panel.setHeight("100%");
    InlineHTML lineSpan=new InlineHTML(String.valueOf(i + 1));
    lineSpan.addStyleName("editorLine");
    lineSpan.addStyleName("editorGutterLine" + i);
    panel.add(lineSpan);
    HTMLTable.CellFormatter cellFormatter=grid.getCellFormatter();
    cellFormatter.addStyleName(i,0,"noselectable");
    cellFormatter.addStyleName(i,0,"editorLineRow");
    grid.setWidget(i,0,panel);
  }
  int lineCount=0;
  FlowPanel lineElement=null;
  for (  EditorSegmentBuilder.Fragment fragment : myBuilder.getFragments()) {
    if (lineElement == null) {
      lineElement=new FlowPanel();
      lineElement.setWidth("100%");
      lineElement.addStyleName("editorLine");
      lineElement.addStyleName("gen_Line_" + lineCount);
    }
    lineElement.add(fragment.widget);
    if (fragment.lineWrap) {
      grid.setWidget(lineCount,1,lineElement);
      grid.getCellFormatter().setWordWrap(lineCount,1,false);
      lineElement=null;
      lineCount++;
    }
  }
  ScrollPanel scrollPanel=new ScrollPanel(grid);
  scrollPanel.setHeight("100%");
  scrollPanel.setWidth("100%");
  DockPanel panel=new DockPanel();
  panel.setHorizontalAlignment(HasHorizontalAlignment.ALIGN_LEFT);
  panel.setWidth("100%");
  panel.add(scrollPanel,DockPanel.CENTER);
  setWidget(panel);
}
