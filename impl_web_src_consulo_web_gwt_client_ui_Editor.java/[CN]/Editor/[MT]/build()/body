{
  Grid gridPanel=GwtUtil.fillAndReturn(new MainGrid(this,1,2));
  gridPanel.getColumnFormatter().getElement(1).getStyle().setWidth(100,Style.Unit.PCT);
  myGutterPanel=new GutterPanel(this);
  gridPanel.setWidget(0,0,myGutterPanel);
  myGutterPanel.addStyleName("noselectable");
  for (int i=0; i < myLineCount; i++) {
    final Grid panel=GwtUtil.fillAndReturn(new Grid(1,5));
    panel.getCellFormatter().setHorizontalAlignment(0,0,HasHorizontalAlignment.ALIGN_RIGHT);
    panel.getCellFormatter().getElement(0,0).getStyle().setPaddingLeft(5,Style.Unit.PX);
    panel.getCellFormatter().getElement(0,4).getStyle().setPaddingRight(5,Style.Unit.PX);
    panel.getColumnFormatter().getElement(0).getStyle().setWidth(100,Style.Unit.PCT);
    LineNumberSpan lineSpan=new LineNumberSpan(String.valueOf(i + 1),this);
    lineSpan.addStyleName("editorLine");
    lineSpan.addStyleName("editorGutterLine" + i);
    panel.setWidget(0,0,lineSpan);
    myGutterPanel.add(panel);
  }
  Grid editorCodePanel=new Grid(myLineCount + 1,1){
{
      sinkEvents(Event.ONCHANGE | Event.ONPASTE | Event.KEYEVENTS);
    }
    @Override public void onBrowserEvent(    Event event){
      event.preventDefault();
    }
  }
;
  GwtUtil.fill(editorCodePanel);
  gridPanel.setWidget(0,1,editorCodePanel);
  editorCodePanel.getElement().setAttribute("spellcheck","false");
  editorCodePanel.getElement().setAttribute("contenteditable","true");
  editorCodePanel.addStyleName("noFocusBorder");
  int lineCount=0;
  FlowPanel lineElement=null;
  for (  EditorSegmentBuilder.Fragment fragment : myBuilder.getFragments()) {
    if (lineElement == null) {
      lineElement=new CodeLinePanel(this);
      setDefaultTextColors(lineElement);
      lineElement.setWidth("100%");
      lineElement.addStyleName("editorLine");
      lineElement.addStyleName("gen_Line_" + lineCount);
    }
    lineElement.add(fragment.widget);
    if (fragment.lineWrap) {
      editorCodePanel.getCellFormatter().getElement(lineCount,0).getStyle().setPaddingLeft(5,Style.Unit.PX);
      editorCodePanel.setWidget(lineCount,0,lineElement);
      lineElement=null;
      lineCount++;
    }
  }
  ScrollPanel scrollPanel=new ScrollPanel(gridPanel);
  GwtUtil.fill(scrollPanel);
  DockPanel panel=new DockPanel();
  panel.setHorizontalAlignment(HasHorizontalAlignment.ALIGN_LEFT);
  panel.setWidth("100%");
  panel.add(scrollPanel,DockPanel.CENTER);
  setWidget(panel);
}
