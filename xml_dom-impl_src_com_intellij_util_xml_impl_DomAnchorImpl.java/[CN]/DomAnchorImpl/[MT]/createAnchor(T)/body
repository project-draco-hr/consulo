{
  final DomElement parent=t.getParent();
  if (parent == null) {
    LOG.error("Parent null: " + t);
  }
  if (parent instanceof DomFileElementImpl) {
    final DomFileElementImpl fileElement=(DomFileElementImpl)parent;
    return new RootAnchor<T>(fileElement.getFile(),fileElement.getRootElementClass());
  }
  final DomAnchorImpl<DomElement> parentAnchor=createAnchor(parent);
  final String name=t.getGenericInfo().getElementName(t);
  final AbstractDomChildrenDescription description=t.getChildDescription();
  final List<? extends DomElement> values=description.getValues(parent);
  if (name != null) {
    int i=0;
    for (    DomElement value : values) {
      if (value.equals(t)) {
        return new NamedAnchor<T>(parentAnchor,description,name,i);
      }
      if (name.equals(value.getGenericInfo().getElementName(value))) {
        i++;
      }
    }
  }
  final int index=values.indexOf(t);
  if (index < 0) {
    final XmlTag parentTag=parent.getXmlTag();
    StringBuilder diag=new StringBuilder("Index<0: description=" + description + "\nparent="+ parent+ "\nt="+ t+ "\nvalues="+ values+ "\n");
    if (parentTag != null) {
      diag.append("Parent tag: ").append(parentTag.getName()).append("\n");
      if (t instanceof GenericAttributeValue) {
        for (        XmlAttribute attribute : parentTag.getAttributes()) {
          diag.append("attr: ").append(attribute.getName());
        }
        diag.append("\n");
      }
 else {
        for (        XmlTag tag : parentTag.getSubTags()) {
          diag.append("subtag: ").append(tag.getName());
        }
        diag.append("\n");
      }
    }
    diag.append("Child name: ").append(t.getXmlElementName()).append(";").append(t.getXmlElementNamespaceKey());
    LOG.error(diag);
  }
  return new IndexedAnchor<T>(parentAnchor,description,index);
}
