{
  SelectionModel model=myEditor.getSelectionModel();
  if (!model.hasSelection()) {
    return true;
  }
  TextRange range=new TextRange(model.getSelectionStart(),model.getSelectionEnd() - 1);
  for (PsiElement element=myFile.findElementAt(range.getStartOffset()); element != null && range.intersects(element.getTextRange()); element=element.getNextSibling()) {
    if (element instanceof OuterLanguageElement) {
      List<PsiElement> injectedElements=PsiTreeUtil.getInjectedElements((OuterLanguageElement)element);
      for (      PsiElement el : injectedElements) {
        if (!isWhiteSpaceOrComment(el,range)) {
          return false;
        }
      }
    }
 else {
      if (!isWhiteSpaceOrComment(element)) {
        return false;
      }
    }
  }
  return true;
}
