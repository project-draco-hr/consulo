{
  int offset=myCaret.getOffset();
  TextRange range=new TextRange(myCaret.getSelectionStart(),myCaret.getSelectionEnd());
  if (offset == range.getEndOffset()) {
    offset--;
  }
  if (offset <= range.getStartOffset()) {
    offset++;
  }
  PsiElement elt=myFile.getViewProvider().findElementAt(offset);
  if (elt == null)   return null;
  PsiElement comment=PsiTreeUtil.getParentOfType(elt,PsiComment.class,false);
  if (comment == null || myCaret.hasSelection() && !range.contains(comment.getTextRange())) {
    return null;
  }
  return comment;
}
