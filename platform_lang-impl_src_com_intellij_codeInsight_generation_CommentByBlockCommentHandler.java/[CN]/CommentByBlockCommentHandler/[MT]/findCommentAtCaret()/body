{
  int offset=myEditor.getCaretModel().getOffset();
  SelectionModel selectionModel=myEditor.getSelectionModel();
  TextRange range=new TextRange(selectionModel.getSelectionStart(),selectionModel.getSelectionEnd());
  if (offset == range.getEndOffset()) {
    offset--;
  }
  if (offset <= range.getStartOffset()) {
    offset++;
  }
  PsiElement elt=myFile.getViewProvider().findElementAt(offset);
  if (elt == null)   return null;
  PsiElement comment=PsiTreeUtil.getParentOfType(elt,PsiComment.class,false);
  if (comment == null || selectionModel.hasSelection() && !range.contains(comment.getTextRange())) {
    return null;
  }
  return comment;
}
