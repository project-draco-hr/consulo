{
  final PsiElement parent=e.getParent();
  if (PsiUtil.isInJspFile(e.getContainingFile()) && e.getLanguage() instanceof JavaLanguage && !(e instanceof PsiErrorElement)) {
    final JspFile psiFile=PsiUtil.getJspFile(e.getContainingFile());
    if (e.getParent().getTextLength() == psiFile.getTextLength()) {
      PsiFile baseRoot=psiFile.getBaseLanguageRoot();
      final ASTNode node=baseRoot.getNode();
      if (node == null)       return parent;
      final ASTNode leafElementAt=node.findLeafElementAt(e.getTextRange().getStartOffset());
      return leafElementAt != null ? leafElementAt.getPsi() : parent;
    }
  }
  return parent;
}
