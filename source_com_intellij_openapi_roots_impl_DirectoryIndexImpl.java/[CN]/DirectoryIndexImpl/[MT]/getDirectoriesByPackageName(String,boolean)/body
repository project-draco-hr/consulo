{
  LOG.assertTrue(myInitialized);
  LOG.assertTrue(!myDisposed);
  VirtualFile[] allDirs=getDirectoriesByPackageName(packageName);
  if (includeLibrarySources) {
    return allDirs;
  }
 else {
    List<VirtualFile> result=new ArrayList<VirtualFile>();
    for (int i=0; i < allDirs.length; i++) {
      VirtualFile dir=allDirs[i];
      DirectoryInfo info=getInfoForDirectory(dir);
      LOG.assertTrue(info != null);
      if (!info.isInLibrarySource || info.libraryClassRoot != null) {
        result.add(dir);
      }
    }
    return result.toArray(new VirtualFile[result.size()]);
  }
}
