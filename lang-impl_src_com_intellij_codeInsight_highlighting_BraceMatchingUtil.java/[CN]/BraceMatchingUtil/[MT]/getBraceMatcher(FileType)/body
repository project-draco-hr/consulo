{
  BraceMatcher braceMatcher=BRACE_MATCHERS.get(fileType);
  if (braceMatcher == null) {
    for (    FileTypeExtensionPoint<BraceMatcher> ext : Extensions.getExtensions(BraceMatcher.EP_NAME)) {
      if (fileType.getName().equals(ext.filetype)) {
        braceMatcher=ext.getInstance();
        break;
      }
    }
    if (braceMatcher == null) {
      if (fileType instanceof LanguageFileType) {
        final Language language=((LanguageFileType)fileType).getLanguage();
        final PairedBraceMatcher matcher=LanguageBraceMatching.INSTANCE.forLanguage(language);
        if (matcher != null) {
          braceMatcher=new PairedBraceMatcherAdapter(matcher,language);
        }
      }
    }
    if (braceMatcher == null) {
      if (ourDefaultBraceMatcher == null) {
        ourDefaultBraceMatcher=new DefaultBraceMatcher();
      }
      braceMatcher=ourDefaultBraceMatcher;
    }
    BRACE_MATCHERS.put(fileType,braceMatcher);
  }
  return braceMatcher;
}
