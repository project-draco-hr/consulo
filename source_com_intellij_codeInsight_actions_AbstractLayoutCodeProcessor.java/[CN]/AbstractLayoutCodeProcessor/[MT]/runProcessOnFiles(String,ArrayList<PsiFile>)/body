{
  boolean checkWritable=true;
  for (  PsiFile file : array) {
    if (checkWritable && !file.isWritable()) {
      int res=Messages.showOkCancelDialog(myProject,where + " contains read-only file(s).\nProcess all other files?","Cannot Modify Read-Only Files",Messages.getQuestionIcon());
      if (res != 0) {
        array.clear();
        break;
      }
      checkWritable=false;
    }
  }
  if (array.isEmpty())   return;
  final Runnable[] resultRunnable=new Runnable[1];
  runLayoutCodeProcess(new Runnable(){
    public void run(){
      resultRunnable[0]=preprocessFiles(array);
    }
  }
,new Runnable(){
    public void run(){
      if (resultRunnable[0] != null) {
        resultRunnable[0].run();
      }
    }
  }
);
}
