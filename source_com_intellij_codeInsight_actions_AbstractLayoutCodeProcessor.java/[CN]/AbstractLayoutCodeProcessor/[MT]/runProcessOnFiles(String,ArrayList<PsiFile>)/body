{
  boolean checkWritable=true;
  for (  PsiFile file : array) {
    if (checkWritable && !file.isWritable()) {
      int res=Messages.showOkCancelDialog(myProject,CodeInsightBundle.message("error.dialog.readonly.files.message",where),CodeInsightBundle.message("error.dialog.readonly.files.title"),Messages.getQuestionIcon());
      if (res != 0) {
        array.clear();
        break;
      }
      checkWritable=false;
    }
  }
  if (array.isEmpty())   return;
  final Runnable[] resultRunnable=new Runnable[1];
  runLayoutCodeProcess(new Runnable(){
    public void run(){
      resultRunnable[0]=preprocessFiles(array);
    }
  }
,new Runnable(){
    public void run(){
      if (resultRunnable[0] != null) {
        resultRunnable[0].run();
      }
    }
  }
);
}
