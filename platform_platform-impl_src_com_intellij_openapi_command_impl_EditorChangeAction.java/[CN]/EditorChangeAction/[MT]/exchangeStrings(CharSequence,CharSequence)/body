{
  DocumentEx d=getDocument();
  if (myBulkUpdate)   d.setInBulkUpdate(true);
  if (newString.length() > 0 && oldString.length() == 0) {
    d.deleteString(myOffset,myOffset + newString.length());
  }
 else   if (oldString.length() > 0 && newString.length() == 0) {
    d.insertString(myOffset,oldString);
  }
 else   if (oldString.length() > 0 && newString.length() > 0) {
    d.replaceString(myOffset,myOffset + newString.length(),oldString);
  }
  if (myBulkUpdate)   d.setInBulkUpdate(false);
}
