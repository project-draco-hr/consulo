{
  final DocumentEx document=getDocument();
  if (myBulkUpdate)   document.setInBulkUpdate(true);
  if (newString.length() > 0 && oldString.length() == 0) {
    document.deleteString(myOffset,myOffset + newString.length());
  }
 else   if (oldString.length() > 0 && newString.length() == 0) {
    document.insertString(myOffset,oldString);
  }
 else   if (oldString.length() > 0 && newString.length() > 0) {
    document.replaceString(myOffset,myOffset + newString.length(),oldString);
  }
  if (myBulkUpdate)   document.setInBulkUpdate(false);
}
