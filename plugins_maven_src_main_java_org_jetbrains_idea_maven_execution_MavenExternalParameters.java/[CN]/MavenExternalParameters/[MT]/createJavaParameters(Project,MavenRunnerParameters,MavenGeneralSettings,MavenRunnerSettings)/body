{
  final JavaParameters params=new JavaParameters();
  params.setWorkingDirectory(parameters.getWorkingDirFile());
  params.setJdk(getJdk(runnerSettings,project != null && MavenRunner.getInstance(project).getState() == runnerSettings));
  final String mavenHome=resolveMavenHome(coreSettings);
  for (  String parameter : createVMParameters(new ArrayList<String>(),mavenHome,runnerSettings)) {
    params.getVMParametersList().add(parameter);
  }
  for (  String path : getMavenClasspathEntries(mavenHome)) {
    params.getClassPath().add(path);
  }
  params.setMainClass(MAVEN_LAUNCHER_CLASS);
  EncodingManager encodingManager=project == null ? EncodingProjectManager.getInstance() : EncodingProjectManager.getInstance(project);
  params.setCharset(encodingManager.getDefaultCharset());
  for (  String parameter : createMavenParameters(new ArrayList<String>(),coreSettings,runnerSettings,parameters)) {
    if (!StringUtil.isEmpty(parameter)) {
      params.getProgramParametersList().add(parameter);
    }
  }
  return params;
}
