{
synchronized (ourEnumerationCache) {
    final Integer cachedId=ourEnumerationCache.get(sharedKey(value,this));
    if (cachedId != null)     return cachedId.intValue();
  }
  final int id=enumerateImpl(value,false);
  if (id != NULL_ID) {
synchronized (ourEnumerationCache) {
      ourEnumerationCache.put(new CacheKey(value,this),id);
    }
  }
  return id;
}
