{
synchronized (ourEnumerationCache) {
    final Integer cachedId=ourEnumerationCache.get(sharedKey(value,this));
    if (cachedId != null)     return cachedId.intValue();
  }
  final int id;
synchronized (ourLock) {
    id=enumerateImpl(value,true);
  }
synchronized (ourEnumerationCache) {
    ourEnumerationCache.put(new CacheKey(value,this),id);
  }
  return id;
}
