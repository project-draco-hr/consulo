{
  if (!panel.validate())   return;
  final String location=panel.getLocation();
  ModelLoader loader=location.toLowerCase().endsWith(".xsd") ? new XSDModelLoader() : new DTDModelLoader();
  final JetBrainsEmitter emitter=new JetBrainsEmitter();
  final MergingFileManager fileManager=new MergingFileManager();
  if (panel.getAuthor().trim().length() > 0) {
    emitter.setAuthor(panel.getAuthor());
  }
  final ModelGen modelGen=new ModelGen(loader,emitter,fileManager);
  final NamespaceDesc desc=panel.getNamespaceDescriptor();
  modelGen.setConfig(desc.name,location,desc,panel.getSkippedSchemas());
  try {
    final File output=new File(panel.getOutputDir());
    modelGen.perform(output,new File(location).getParentFile());
  }
 catch (  Exception e) {
    e.printStackTrace(System.err);
  }
  panel.saveAll();
  super.doOKAction();
}
