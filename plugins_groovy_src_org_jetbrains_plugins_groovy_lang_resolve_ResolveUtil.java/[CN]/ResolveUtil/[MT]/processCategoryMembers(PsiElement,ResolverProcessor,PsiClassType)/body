{
  PsiElement prev=null;
  while (place != null) {
    if (place instanceof GrMember)     break;
    if (place instanceof GrMethodCallExpression) {
      final GrMethodCallExpression call=(GrMethodCallExpression)place;
      final GrExpression invoked=call.getInvokedExpression();
      if (invoked instanceof GrReferenceExpression && "use".equals(((GrReferenceExpression)invoked).getReferenceName())) {
        final GrClosableBlock[] closures=call.getClosureArguments();
        if (closures.length == 1 && closures[0].equals(prev)) {
          if (useCategoryClass(call)) {
            final GrArgumentList argList=call.getArgumentList();
            if (argList != null) {
              final GrExpression[] args=argList.getExpressionArguments();
              if (args.length == 1 && args[0] instanceof GrReferenceExpression) {
                final PsiElement resolved=((GrReferenceExpression)args[0]).resolve();
                if (resolved instanceof PsiClass) {
                  try {
                    processor.setCurrentFileResolveContext(call);
                    if (!resolved.processDeclarations(processor,PsiSubstitutor.EMPTY,null,place))                     return false;
                  }
  finally {
                    processor.setCurrentFileResolveContext(null);
                  }
                }
              }
            }
          }
        }
      }
    }
    prev=place;
    place=place.getContext();
  }
  return true;
}
