{
  final Map<String,Map<String,PsiType>> cache=CachedValuesManager.getManager(project).getCachedValue(project,new CachedValueProvider<Map<String,Map<String,PsiType>>>(){
    @Override public Result<Map<String,Map<String,PsiType>>> compute(){
      final Map<String,Map<String,PsiType>> result=new ConcurrentHashMap<String,Map<String,PsiType>>();
      return Result.create(result,PsiModificationTracker.JAVA_STRUCTURE_MODIFICATION_COUNT,ProjectRootManager.getInstance(project));
    }
  }
);
  final PsiClass cls=PsiUtil.resolveClassInType(base);
  String key=cls instanceof PsiTypeParameter ? cls.getName() + cls.getSuperClass().getName() : rawCanonicalText(base);
  Map<String,PsiType> result=cache.get(key);
  if (result == null) {
    result=new HashMap<String,PsiType>();
    collectSuperTypes(base,result,project);
    cache.put(key,result);
  }
  return result;
}
