{
  PsiElement lastParent=null;
  PsiElement run=place;
  final Project project=place.getProject();
  PsiElementFactory factory=JavaPsiFacade.getElementFactory(project);
  while (run != null) {
    if (!run.processDeclarations(substituteProcessor(processor,run),ResolveState.initial(),lastParent,place))     return false;
    if (processNonCodeMethods && !processScopeNonCodeMethods(place,processor,run,factory)) {
      return false;
    }
    issueLevelChangeEvents(processor,run);
    lastParent=run;
    run=run.getContext();
  }
  return true;
}
