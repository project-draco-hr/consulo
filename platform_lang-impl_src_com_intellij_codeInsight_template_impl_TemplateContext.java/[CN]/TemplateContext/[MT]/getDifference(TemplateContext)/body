{
  Map<TemplateContextType,Boolean> result=ContainerUtil.newLinkedHashMap();
synchronized (myContextStates) {
synchronized (defaultContext == null ? myContextStates : defaultContext.myContextStates) {
      for (      TemplateContextType contextType : TemplateManagerImpl.getAllContextTypes()) {
        String context=contextType.getContextId();
        Boolean myStateInContext=myContextStates.get(context);
        if (myStateInContext != null && differsFromDefault(defaultContext,context,myStateInContext)) {
          result.put(contextType,myStateInContext);
        }
      }
    }
  }
  return result;
}
