{
  KeyboardFocusManager focusManager=(KeyboardFocusManager)e.getSource();
  Window activeWindow=focusManager.getActiveWindow();
  if (activeWindow != null) {
    mySyncAlarm.cancelAllRequests();
    if (myShouldSynchronize) {
      myShouldSynchronize=false;
      if (canSyncOrSave()) {
        synchronizeOnActivation();
      }
    }
    return;
  }
 else {
    mySyncAlarm.cancelAllRequests();
    mySyncAlarm.addRequest(new Runnable(){
      public void run(){
        myShouldSynchronize=true;
        if (canSyncOrSave()) {
          synchronizeOnDeactivation();
        }
      }
    }
,200);
  }
}
