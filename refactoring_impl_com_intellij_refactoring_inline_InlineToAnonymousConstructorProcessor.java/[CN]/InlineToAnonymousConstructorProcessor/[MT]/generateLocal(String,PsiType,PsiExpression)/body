{
  final CodeStyleManager codeStyleManager=myClass.getManager().getCodeStyleManager();
  String baseNameForIndex=baseName;
  int index=0;
  String localName;
  while (true) {
    localName=codeStyleManager.suggestUniqueVariableName(baseNameForIndex,myNewExpression,true);
    if (myClass.findFieldByName(localName,false) == null) {
      break;
    }
    index++;
    baseNameForIndex=baseName + index;
  }
  try {
    final PsiDeclarationStatement declaration=myElementFactory.createVariableDeclarationStatement(localName,type,initializer);
    PsiVariable variable=(PsiVariable)declaration.getDeclaredElements()[0];
    variable.getModifierList().setModifierProperty(PsiModifier.FINAL,true);
    myNewStatement.getParent().addBefore(declaration,myNewStatement);
    return variable;
  }
 catch (  IncorrectOperationException e) {
    LOG.error(e);
    return null;
  }
}
