{
  final VirtualFile[] children=directory.getChildren();
  if (children != null) {
    for (    VirtualFile child : children) {
      if (filter == null || filter.accept(child,myContext.getCompileContext())) {
        if (!child.isDirectory()) {
          addFileCopyInstruction(child,child.getName());
        }
 else {
          subFolder(child.getName()).addDirectoryCopyInstructions(child,filter);
        }
      }
    }
  }
}
