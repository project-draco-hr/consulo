{
  if (table.isEditing()) {
    table.getCellEditor().stopCellEditing();
  }
  TableModel model=table.getModel();
  if (!(model instanceof ItemRemovable)) {
    throw new RuntimeException("model must be instance of ItemRemovable");
  }
  ListSelectionModel selectionModel=table.getSelectionModel();
  int minSelectionIndex=selectionModel.getMinSelectionIndex();
  if (minSelectionIndex == -1)   return new ArrayList<Object[]>(0);
  List<Object[]> removedItems=new LinkedList<Object[]>();
  final int columnCount=model.getColumnCount();
  for (int idx=table.getRowCount() - 1; idx >= 0; idx--) {
    if (selectionModel.isSelectedIndex(idx) && (applyable == null || applyable.isOperationApplyable(model,idx))) {
      final Object[] row=new Object[columnCount];
      for (int column=0; column < columnCount; column++) {
        row[column]=model.getValueAt(idx,column);
      }
      removedItems.add(0,row);
      ((ItemRemovable)model).removeRow(idx);
    }
  }
  int count=model.getRowCount();
  if (count == 0) {
    table.clearSelection();
  }
 else   if (table.getSelectedRow() == -1) {
    if (minSelectionIndex >= model.getRowCount()) {
      selectionModel.setSelectionInterval(model.getRowCount() - 1,model.getRowCount() - 1);
    }
 else {
      selectionModel.setSelectionInterval(minSelectionIndex,minSelectionIndex);
    }
  }
  return removedItems;
}
