{
  final Document document=FileDocumentManager.getInstance().getDocument(newFile);
  if (document == null) {
    throw new IOException("Failed to set contents for new file " + newFile.getPath());
  }
  final String charsetName=CharsetEP.getCharset(newFile.getPath(),commitContext);
  if (charsetName != null) {
    try {
      final Charset charset=Charset.forName(charsetName);
      newFile.setCharset(charset);
    }
 catch (    IllegalArgumentException e) {
    }
  }
  document.setText(myPatch.getNewFileText());
  FileDocumentManager.getInstance().saveDocument(document);
}
