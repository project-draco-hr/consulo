{
  final AdditionalPanel panel=new AdditionalPanel();
  final InspectionManagerEx manager=(InspectionManagerEx)InspectionManager.getInstance(project);
  final JComboBox profiles=panel.myBrowseProfilesCombo.getComboBox();
  profiles.setRenderer(new ListCellRendererWrapper(){
    @Override public void customize(    JList list,    Object value,    int index,    boolean selected,    boolean hasFocus){
      if (value instanceof Profile) {
        Profile profile=(Profile)value;
        setText(profile.getName());
        setIcon(profile.isProjectLevel() ? AllIcons.General.ProjectSettings : AllIcons.General.Settings);
      }
    }
  }
);
  final InspectionProfileManager profileManager=InspectionProfileManager.getInstance();
  final InspectionProjectProfileManager projectProfileManager=InspectionProjectProfileManager.getInstance(project);
  reloadProfiles(profiles,profileManager,projectProfileManager,manager);
  panel.myBrowseProfilesCombo.addActionListener(new ActionListener(){
    @Override public void actionPerformed(    ActionEvent e){
      final IDEInspectionToolsConfigurable errorConfigurable=createConfigurable(projectProfileManager,profileManager);
      final MySingleConfigurableEditor editor=new MySingleConfigurableEditor(project,errorConfigurable,manager);
      errorConfigurable.selectProfile(((Profile)profiles.getSelectedItem()));
      if (editor.showAndGet()) {
        reloadProfiles(profiles,profileManager,projectProfileManager,manager);
      }
 else {
        final InspectionProfile profile=(InspectionProfile)profiles.getSelectedItem();
        final boolean canExecute=profile != null && profile.isExecutable(project);
        dialog.setOKActionEnabled(canExecute);
      }
    }
  }
);
  profiles.addActionListener(new ActionListener(){
    @Override public void actionPerformed(    ActionEvent e){
      myExternalProfile=(InspectionProfile)profiles.getSelectedItem();
      final boolean canExecute=myExternalProfile != null && myExternalProfile.isExecutable(project);
      dialog.setOKActionEnabled(canExecute);
      if (canExecute) {
        manager.setProfile(myExternalProfile.getName());
      }
    }
  }
);
  final InspectionProfile profile=(InspectionProfile)profiles.getSelectedItem();
  dialog.setOKActionEnabled(profile != null && profile.isExecutable(project));
  return panel.myAdditionalPanel;
}
