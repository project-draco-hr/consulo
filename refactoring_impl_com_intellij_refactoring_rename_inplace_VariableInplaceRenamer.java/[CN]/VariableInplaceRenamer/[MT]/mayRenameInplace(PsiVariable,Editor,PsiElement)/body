{
  if (!editor.getSettings().isVariableInplaceRenameEnabled())   return false;
  if (nameSuggestionContext != null && nameSuggestionContext.getContainingFile() != elementToRename.getContainingFile())   return false;
  if (!(elementToRename instanceof PsiLocalVariable) && !(elementToRename instanceof PsiParameter))   return false;
  SearchScope useScope=elementToRename.getUseScope();
  if (!(useScope instanceof LocalSearchScope))   return false;
  PsiElement[] scopeElements=((LocalSearchScope)useScope).getScope();
  if (scopeElements.length > 1)   return false;
  PsiFile containingFile=elementToRename.getContainingFile();
  if (!PsiTreeUtil.isAncestor(containingFile,scopeElements[0],false))   return false;
  String stringToSearch=ElementDescriptionUtil.getElementDescription(elementToRename,true ? NonCodeSearchDescriptionLocation.NON_JAVA : NonCodeSearchDescriptionLocation.STRINGS_AND_COMMENTS);
  List<UsageInfo> usages=new ArrayList<UsageInfo>();
  if (stringToSearch != null) {
    TextOccurrencesUtil.addUsagesInStringsAndComments(elementToRename,stringToSearch,usages,new TextOccurrencesUtil.UsageInfoFactory(){
      public UsageInfo createUsageInfo(      @NotNull PsiElement usage,      int startOffset,      int endOffset){
        return new UsageInfo(usage);
      }
    }
,true);
  }
  return usages.isEmpty();
}
