{
  if (getMaster().getDocument().getTextLength() == 0)   return;
  Rectangle viewRect=getMaster().getScrollingModel().getVisibleArea();
  int middleY=viewRect.height / 3;
  int offset;
  if (myAnchor == null) {
    LogicalPosition masterPos=getMaster().xyToLogicalPosition(new Point(viewRect.x,viewRect.y + middleY));
    int masterCenterLine=masterPos.line;
    int convertedCenterLine=convertLine(masterCenterLine);
    Point point=getSlave().logicalPositionToXY(new LogicalPosition(convertedCenterLine,masterPos.column));
    int correction=(viewRect.y + middleY) % getMaster().getLineHeight();
    offset=point.y - middleY + correction;
  }
 else {
    double progress=myAnchor.masterStartOffset == myAnchor.masterEndOffset || viewRect.y == myAnchor.masterEndOffset ? 1 : ((double)(viewRect.y - myAnchor.masterStartOffset)) / (myAnchor.masterEndOffset - myAnchor.masterStartOffset);
    offset=myAnchor.slaveStartOffset + (int)((myAnchor.slaveEndOffset - myAnchor.slaveStartOffset) * progress);
  }
  int deltaHeaderOffset=getHeaderOffset(getSlave()) - getHeaderOffset(getMaster());
  doScrollVertically(getSlave(),offset + deltaHeaderOffset,animated);
}
