{
  if (prefix.startsWith("-D")) {
    return getSystemPropertiesVariants();
  }
  List<LookupElement> res=new ArrayList<LookupElement>();
  if (text.substring(0,offset).matches("\\s*(grails\\s*)?(?:(:?-D\\S+|dev|prod|test)\\s+)*\\S*")) {
    for (    String completionVariant : getAllTargetNames(module)) {
      res.add(TailTypeDecorator.withTail(LookupElementBuilder.create(completionVariant),TailType.SPACE));
    }
  }
 else {
    GlobalSearchScope scope=GlobalSearchScope.moduleScope(module);
    JavaPsiFacade facade=JavaPsiFacade.getInstance(module.getProject());
    if (prefix.endsWith(".") && prefix.length() > 1) {
      PsiPackage p=facade.findPackage(prefix.substring(0,prefix.length() - 1));
      if (p != null) {
        for (        PsiClass aClass : p.getClasses(scope)) {
          String qualifiedName=aClass.getQualifiedName();
          if (qualifiedName != null) {
            res.add(LookupElementBuilder.create(aClass,qualifiedName));
          }
        }
      }
    }
    PsiPackage defaultPackage=facade.findPackage("");
    if (defaultPackage != null) {
      collectClassesAndPackageNames(res,defaultPackage,scope);
    }
  }
  return res;
}
