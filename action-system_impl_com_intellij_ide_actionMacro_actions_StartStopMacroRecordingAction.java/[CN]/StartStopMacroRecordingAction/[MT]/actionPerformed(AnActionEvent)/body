{
  if (!ActionMacroManager.getInstance().isRecording()) {
    final ActionMacroManager manager=ActionMacroManager.getInstance();
    manager.startRecording(IdeBundle.message("macro.noname"));
  }
 else {
    ActionMacroManager.getInstance().stopRecording(DataKeys.PROJECT.getData(e.getDataContext()));
  }
}
