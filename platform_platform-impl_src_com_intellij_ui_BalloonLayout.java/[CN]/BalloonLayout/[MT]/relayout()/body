{
  final Dimension size=myParent.getSize();
  size.width-=myInsets.left + myInsets.right;
  size.height-=myInsets.top + myInsets.bottom;
  final Rectangle layoutRec=new Rectangle(new Point(myInsets.left,myInsets.top),size);
  List<ArrayList<Balloon>> columns=createColumns(layoutRec);
  List<Integer> columnWidths=computeWidths(columns);
  int eachCoumnX=(int)layoutRec.getMaxX();
  for (int i=0; i < columns.size(); i++) {
    final ArrayList<Balloon> eachColumn=columns.get(i);
    final Integer eachWidth=columnWidths.get(i);
    eachCoumnX-=eachWidth.intValue();
    int eachY=layoutRec.y;
    for (    Balloon eachBalloon : eachColumn) {
      final Rectangle eachRec=new Rectangle();
      final Dimension eachPrefSize=eachBalloon.getPreferredSize();
      eachRec.setSize(eachPrefSize);
      eachRec.setLocation(eachCoumnX + eachWidth.intValue() - eachRec.width,eachY);
      eachBalloon.setBounds(eachRec);
      eachY+=eachRec.height;
    }
  }
}
