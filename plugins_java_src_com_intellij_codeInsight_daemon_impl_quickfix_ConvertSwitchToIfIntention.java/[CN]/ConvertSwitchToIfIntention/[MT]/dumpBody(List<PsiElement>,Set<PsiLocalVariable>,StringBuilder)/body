{
  ifStatementString.append('{');
  for (  PsiLocalVariable variable : variables) {
    if (ReferencesSearch.search(variable,new LocalSearchScope(bodyStatements.toArray(new PsiElement[bodyStatements.size()]))).findFirst() != null) {
      final PsiType varType=variable.getType();
      ifStatementString.append(varType.getPresentableText());
      ifStatementString.append(' ');
      ifStatementString.append(variable.getName());
      ifStatementString.append(';');
    }
  }
  for (  PsiElement bodyStatement : bodyStatements) {
    if (bodyStatement instanceof PsiBlockStatement) {
      final PsiBlockStatement blockStatement=(PsiBlockStatement)bodyStatement;
      final PsiCodeBlock codeBlock=blockStatement.getCodeBlock();
      final PsiStatement[] statements=codeBlock.getStatements();
      for (      PsiStatement statement : statements) {
        appendElement(statement,ifStatementString);
      }
    }
 else {
      appendElement(bodyStatement,ifStatementString);
    }
  }
  ifStatementString.append("\n}");
}
