{
  final Module module=LangDataKeys.MODULE_CONTEXT.getData(dataContext);
  final CompilerFilter filter=new CompilerFilter(){
    public boolean acceptCompiler(    com.intellij.openapi.compiler.Compiler compiler){
      return compiler instanceof AnnotationProcessingCompiler || compiler instanceof ResourceCompiler;
    }
  }
;
  if (module != null) {
    CompilerManager.getInstance(project).make(new ModuleCompileScope(module,false),filter,null);
  }
 else {
    final FileSetCompileScope scope=getCompilableFiles(project,PlatformDataKeys.VIRTUAL_FILE_ARRAY.getData(dataContext));
    if (scope != null) {
      CompilerManager.getInstance(project).make(scope,filter,null);
    }
  }
}
