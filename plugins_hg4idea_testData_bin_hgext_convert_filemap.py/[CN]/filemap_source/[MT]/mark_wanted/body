def mark_wanted(self, rev, parents):
    self.parentmap[rev] = rev
    wrev = set()
    for p in parents:
        wrev.update(self.wantedancestors[p])
    wrev.add(rev)
    self.wantedancestors[rev] = wrev
