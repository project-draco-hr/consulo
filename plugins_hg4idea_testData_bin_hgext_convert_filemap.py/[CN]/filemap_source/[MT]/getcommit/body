def getcommit(self, rev):
    c = self.commits[rev] = self.base.getcommit(rev)
    for p in c.parents:
        self.children[p] = (self.children.get(p, 0) + 1)
    return c
