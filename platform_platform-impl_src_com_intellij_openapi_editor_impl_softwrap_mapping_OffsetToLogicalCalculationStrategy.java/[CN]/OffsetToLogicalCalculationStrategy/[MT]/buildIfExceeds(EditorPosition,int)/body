{
  if (myTargetOffset >= offset) {
    return null;
  }
  Document document=myEditor.getDocument();
  int logicalLine=document.getLineNumber(myTargetOffset);
  int linesDiff=logicalLine - position.logicalLine;
  if (linesDiff > 0) {
    position.onNewLine();
    int column=myTargetOffset - document.getLineStartOffset(logicalLine);
    position.visualColumn=column;
    position.logicalColumn=column;
  }
 else {
    int columnsDiff=myTargetOffset - position.offset;
    position.logicalColumn+=columnsDiff;
    position.visualColumn+=columnsDiff;
  }
  position.logicalLine=logicalLine;
  position.offset=myTargetOffset;
  return position.buildLogicalPosition();
}
