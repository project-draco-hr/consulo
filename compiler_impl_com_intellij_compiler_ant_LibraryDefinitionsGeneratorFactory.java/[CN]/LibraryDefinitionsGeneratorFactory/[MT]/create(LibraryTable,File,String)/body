{
  final Library[] libraries=libraryTable.getLibraries();
  if (libraries.length == 0) {
    return null;
  }
  final CompositeGenerator gen=new CompositeGenerator();
  gen.add(new Comment(comment),1);
  for (  final Library library : libraries) {
    final String libraryName=library.getName();
    if (!myUsedLibraries.contains(libraryName)) {
      continue;
    }
    final VirtualFile[] files=library.getFiles(OrderRootType.COMPILATION_CLASSES);
    final Path libraryPath=new Path(BuildProperties.getLibraryPathId(libraryName));
    HashSet<String> visitedPaths=new HashSet<String>();
    for (    final VirtualFile file : files) {
      final String path=GenerationUtils.toRelativePath(file,baseDir,BuildProperties.getProjectBaseDirProperty(),myGenOptions,!myProject.isSavePathsRelative());
      if (visitedPaths.add(path)) {
        libraryPath.add(new PathElement(path));
      }
    }
    gen.add(libraryPath,1);
  }
  return gen.getGeneratorCount() > 0 ? gen : null;
}
