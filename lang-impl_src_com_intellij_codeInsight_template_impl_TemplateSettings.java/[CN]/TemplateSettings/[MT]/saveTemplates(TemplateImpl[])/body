{
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    public void run(){
      List<String> templateNames=new ArrayList<String>();
      for (      TemplateImpl template1 : templates) {
        templateNames.add(template1.getKey());
      }
      myDeletedTemplates.clear();
      for (      String defTemplateName : myDefaultTemplates.keySet()) {
        if (!templateNames.contains(defTemplateName)) {
          myDeletedTemplates.add(defTemplateName);
        }
      }
      try {
        mySchemesManager.saveSchemes(buildGroupList(templates),FILE_SPEC,myProcessor,RoamingType.PER_USER);
      }
 catch (      WriteExternalException e) {
        LOG.error(e);
      }
    }
  }
);
}
