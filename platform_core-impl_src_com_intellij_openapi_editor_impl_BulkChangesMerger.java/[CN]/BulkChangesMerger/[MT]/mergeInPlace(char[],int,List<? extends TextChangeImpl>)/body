{
  if (changes.isEmpty()) {
    return;
  }
  int diff=0;
  for (  TextChangeImpl change : changes) {
    diff+=change.getDiff();
  }
  if (length + diff > data.length) {
    throw new IllegalArgumentException(String.format("Can't perform in-place changes merge. Reason: data array is not big enough to hold resulting text. Current size: %d, " + "minimum size: %d",data.length,length + diff));
  }
  try {
    for (Context context=new Context(changes,data,length,length + diff); !context.isComplete(); ) {
      if (!context.startGroup()) {
        return;
      }
      context.endGroup();
    }
  }
 catch (  RuntimeException e) {
    LOG.error(String.format("Invalid attempt to perform in-place document changes merge detected. Initial text length: %d, changes: %s, " + "changes diff: %d, initial text: '%s'",length,changes,diff,Arrays.toString(data)),e);
    char[] merged=mergeToCharArray(data,length,changes);
    System.arraycopy(merged,0,data,0,length + diff);
  }
}
