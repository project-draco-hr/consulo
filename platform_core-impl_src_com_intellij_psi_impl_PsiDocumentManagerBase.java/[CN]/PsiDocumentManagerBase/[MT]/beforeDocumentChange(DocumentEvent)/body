{
  final Document document=event.getDocument();
  final FileViewProvider viewProvider=getCachedViewProvider(document);
  if (viewProvider == null)   return;
  if (!isRelevant(viewProvider))   return;
  VirtualFile virtualFile=viewProvider.getVirtualFile();
  if (virtualFile.getFileType().isBinary())   return;
  final List<PsiFile> files=viewProvider.getAllFiles();
  PsiFile psiCause=null;
  for (  PsiFile file : files) {
    mySmartPointerManager.fastenBelts(file,event.getOffset(),null);
    if (TextBlock.get(file).isLocked()) {
      psiCause=file;
    }
  }
  if (psiCause == null) {
    beforeDocumentChangeOnUnlockedDocument(viewProvider);
  }
  ((SingleRootFileViewProvider)viewProvider).beforeDocumentChanged(psiCause);
}
