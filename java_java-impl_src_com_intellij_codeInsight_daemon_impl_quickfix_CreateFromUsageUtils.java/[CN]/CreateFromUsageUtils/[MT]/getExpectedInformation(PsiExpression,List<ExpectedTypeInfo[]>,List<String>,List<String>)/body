{
  for (  PsiExpression expr : collectExpressions(expression,PsiMember.class,PsiFile.class)) {
    PsiElement parent=expr.getParent();
    if (!(parent instanceof PsiReferenceExpression)) {
      ExpectedTypeInfo[] someExpectedTypes=ExpectedTypesProvider.getExpectedTypes(expr,false);
      if (someExpectedTypes.length > 0) {
        types.add(someExpectedTypes);
      }
      continue;
    }
    String refName=((PsiReferenceExpression)parent).getReferenceName();
    if (refName == null) {
      continue;
    }
    PsiElement pparent=parent.getParent();
    if (pparent instanceof PsiMethodCallExpression) {
      expectedMethodNames.add(refName);
      if (refName.equals("equals")) {
        ExpectedTypeInfo[] someExpectedTypes=equalsExpectedTypes((PsiMethodCallExpression)pparent);
        if (someExpectedTypes.length > 0) {
          types.add(someExpectedTypes);
        }
      }
      continue;
    }
    if (pparent instanceof PsiReferenceExpression || pparent instanceof PsiVariable || pparent instanceof PsiExpression) {
      expectedFieldNames.add(refName);
    }
  }
}
