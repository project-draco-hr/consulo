{
  final String host=CommonProxy.getHostNameReliably(getRequestingHost(),getRequestingSite(),getRequestingURL());
  if (myHttpConfigurable.USE_HTTP_PROXY) {
    LOG.debug("CommonAuthenticator.getPasswordAuthentication will return common defined proxy");
    return myHttpConfigurable.getPromptedAuthentication(host + ":" + getRequestingPort(),getRequestingPrompt());
  }
 else   if (myHttpConfigurable.USE_PROXY_PAC) {
    LOG.debug("CommonAuthenticator.getPasswordAuthentication will return autodetected proxy");
    if (myHttpConfigurable.isGenericPasswordCanceled(host,getRequestingPort()))     return null;
    final PasswordAuthentication password=myHttpConfigurable.getGenericPassword(host,getRequestingPort());
    if (password != null) {
      return password;
    }
    if (ApplicationManager.getApplication() == null || ApplicationManager.getApplication().isDisposeInProgress() || ApplicationManager.getApplication().isDisposed())     return null;
    return myHttpConfigurable.getGenericPromptedAuthentication(host,getRequestingPrompt(),getRequestingPort(),true);
  }
 else {
    if (ApplicationManager.getApplication() == null || ApplicationManager.getApplication().isDisposeInProgress() || ApplicationManager.getApplication().isDisposed())     return null;
    LOG.debug("CommonAuthenticator.getPasswordAuthentication generic authentication will be asked");
    return myHttpConfigurable.getGenericPromptedAuthentication(host,getRequestingPrompt(),getRequestingPort(),false);
  }
}
