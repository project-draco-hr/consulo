{
  GrExpression qualifier=refExpr.getQualifierExpression();
  if (qualifier == null) {
    GrClosableBlock closure=PsiTreeUtil.getParentOfType(refExpr,GrClosableBlock.class);
    while (closure != null) {
      PsiElement parent=closure.getParent();
      if (parent instanceof GrArgumentList)       parent=parent.getParent();
      if (parent instanceof GrMethodCall) {
        GrExpression funExpr=((GrMethodCall)parent).getInvokedExpression();
        if (funExpr instanceof GrReferenceExpression && ((GrReferenceExpression)funExpr).resolve() instanceof PsiMethod) {
          qualifier=((GrReferenceExpression)funExpr).getQualifierExpression();
          if (qualifier != null) {
            return qualifier;
          }
        }
 else {
          return funExpr;
        }
      }
      closure=PsiTreeUtil.getParentOfType(closure,GrClosableBlock.class);
    }
  }
  return qualifier;
}
