{
  GrExpression qualifier=refExpr.getQualifierExpression();
  if (qualifier != null)   return qualifier;
  for (GrClosableBlock closure=PsiTreeUtil.getParentOfType(refExpr,GrClosableBlock.class); closure != null; closure=PsiTreeUtil.getParentOfType(closure,GrClosableBlock.class)) {
    PsiElement parent=closure.getParent();
    if (parent instanceof GrArgumentList)     parent=parent.getParent();
    if (!(parent instanceof GrMethodCall))     continue;
    GrExpression funExpr=((GrMethodCall)parent).getInvokedExpression();
    if (!(funExpr instanceof GrReferenceExpression))     return funExpr;
    final PsiElement resolved=((GrReferenceExpression)funExpr).resolve();
    if (!(resolved instanceof PsiMethod))     return funExpr;
    if (resolved instanceof GrGdkMethod && isFromDGM((GrGdkMethod)resolved) && !GdkMethodUtil.WITH.equals(((GrGdkMethod)resolved).getStaticMethod().getName())) {
      continue;
    }
    qualifier=((GrReferenceExpression)funExpr).getQualifierExpression();
    if (qualifier != null)     return qualifier;
  }
  return null;
}
