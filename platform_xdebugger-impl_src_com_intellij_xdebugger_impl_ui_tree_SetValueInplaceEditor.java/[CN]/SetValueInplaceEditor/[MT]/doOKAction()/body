{
  if (myModifier == null)   return;
  myExpressionEditor.saveTextInHistory();
  final XDebuggerTreeState treeState=XDebuggerTreeState.saveState(myTree);
  myValueNode.setValueModificationStarted();
  myModifier.setValue(myExpressionEditor.getExpression().getExpression(),new XValueModifier.XModificationCallback(){
    @Override public void valueModified(){
      AppUIUtil.invokeOnEdt(new Runnable(){
        @Override public void run(){
          myTree.rebuildAndRestore(treeState);
        }
      }
);
    }
    @Override public void errorOccurred(    @NotNull final String errorMessage){
      AppUIUtil.invokeOnEdt(new Runnable(){
        @Override public void run(){
          myTree.rebuildAndRestore(treeState);
          Editor editor=myExpressionEditor.getEditor();
          if (editor != null) {
            HintManager.getInstance().showErrorHint(editor,errorMessage);
          }
 else {
            Messages.showErrorDialog(myTree,errorMessage);
          }
        }
      }
);
    }
  }
);
  super.doOKAction();
}
