{
  StackFrameProxyImpl frameProxy=context.getFrameProxy();
  if (frameProxy == null) {
    throw EvaluateExceptionUtil.createEvaluateException(DebuggerBundle.message("evaluation.error.no.stackframe"));
  }
  try {
    for (; ; ) {
      LocalVariableProxyImpl local=frameProxy.visibleVariableByName(myLocalVariableName);
      if (local != null) {
        myEvaluatedVariable=local;
        myContext=context;
        return frameProxy.getValue(local);
      }
      ThreadReferenceProxyImpl threadProxy=frameProxy.threadProxy();
      if (myIsJspSpecial && frameProxy.getFrameIndex() < threadProxy.frameCount() - 1) {
        if (frameProxy.getFrameIndex() < threadProxy.frameCount() - 1) {
          frameProxy=threadProxy.frame(frameProxy.getFrameIndex() + 1);
          continue;
        }
      }
      break;
    }
    throw EvaluateExceptionUtil.createEvaluateException(DebuggerBundle.message("evaluation.error.local.variable.missing",myLocalVariableName));
  }
 catch (  EvaluateException e) {
    myEvaluatedVariable=null;
    myContext=null;
    throw e;
  }
}
