{
  PsiMethod method=(PsiMethod)getElement();
  if (method != null) {
    PsiCodeBlock body=method.getBody();
    final RefUtilImpl refUtil=(RefUtilImpl)RefUtil.getInstance();
    refUtil.addReferences(method,this,body);
    checkForSuperCall(method);
    setOnlyCallsSuper(refUtil.isMethodOnlyCallsSuper(method));
    setBodyEmpty(isOnlyCallsSuper() || !isExternalOverride() && (body == null || body.getStatements().length == 0));
    PsiType retType=method.getReturnType();
    if (retType != null) {
      PsiType psiType=retType;
      RefClass ownerClass=refUtil.getOwnerClass(getRefManager(),method);
      if (ownerClass != null) {
        psiType=psiType.getDeepComponentType();
        if (psiType instanceof PsiClassType) {
          PsiClass psiClass=PsiUtil.resolveClassInType(psiType);
          if (psiClass != null && refUtil.belongsToScope(psiClass,getRefManager())) {
            RefClassImpl refClass=(RefClassImpl)getRefManager().getReference(psiClass);
            if (refClass != null) {
              refClass.addTypeReference(ownerClass);
              refClass.addClassExporter(this);
            }
          }
        }
      }
    }
    for (    RefParameter parameter : getParameters()) {
      refUtil.setIsFinal(parameter,parameter.getElement().hasModifierProperty(PsiModifier.FINAL));
    }
    ((RefManagerImpl)getRefManager()).fireBuildReferences(this);
  }
}
