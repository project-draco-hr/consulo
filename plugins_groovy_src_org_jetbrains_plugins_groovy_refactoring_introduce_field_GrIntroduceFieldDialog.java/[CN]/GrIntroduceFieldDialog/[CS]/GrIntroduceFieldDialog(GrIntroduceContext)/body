{
  super(context.project,true);
  myContext=context;
  GrTypeDefinition clazz=(GrTypeDefinition)context.scope;
  myIsStatic=GrIntroduceFieldHandler.shouldBeStatic(context.expression,clazz);
  if (myIsStatic) {
    myFieldLabel.setText("Static Field of Type:");
  }
 else {
    myFieldLabel.setText("Field of Type:");
  }
  initVisibility();
  ButtonGroup initialization=new ButtonGroup();
  initialization.add(myCurrentMethodRadioButton);
  initialization.add(myFieldDeclarationRadioButton);
  initialization.add(myClassConstructorSRadioButton);
  new RadioUpDownListener(myCurrentMethodRadioButton,myFieldDeclarationRadioButton,myClassConstructorSRadioButton);
  myCanBeInitializedOutsideBlock=canBeInitializedOutsideBlock(context.expression,(GrTypeDefinition)context.scope);
  if (GrIntroduceFieldHandler.getContainingMethod(context.expression,clazz) == null) {
    myCurrentMethodRadioButton.setEnabled(false);
  }
  if (myCurrentMethodRadioButton.isEnabled()) {
    myCurrentMethodRadioButton.setSelected(true);
  }
 else {
    myFieldDeclarationRadioButton.setSelected(true);
  }
  final String invokedOnLocalVar=getInvokedOnLocalVar(context.expression);
  if (invokedOnLocalVar != null) {
    myReplaceAllOccurencesCheckBox.setText("Replace all occurences and remove variable '" + invokedOnLocalVar + "'");
  }
 else   if (context.occurrences.length == 1) {
    myReplaceAllOccurencesCheckBox.setSelected(false);
    myReplaceAllOccurencesCheckBox.setVisible(false);
  }
  myNameSuggestionsField.addDataChangedListener(new NameSuggestionsField.DataChanged(){
    @Override public void dataChanged(){
      validateOKAction();
    }
  }
);
  ItemListener l=new ItemListener(){
    @Override public void itemStateChanged(    ItemEvent e){
      myNameSuggestionsField.requestFocusInWindow();
      checkErrors();
    }
  }
;
  myPrivateRadioButton.addItemListener(l);
  myProtectedRadioButton.addItemListener(l);
  myPublicRadioButton.addItemListener(l);
  myPropertyRadioButton.addItemListener(l);
  myCurrentMethodRadioButton.addItemListener(l);
  myFieldDeclarationRadioButton.addItemListener(l);
  myClassConstructorSRadioButton.addItemListener(l);
  myDeclareFinalCheckBox.addItemListener(l);
  myReplaceAllOccurencesCheckBox.addItemListener(l);
  myTypeComboBox.addItemListener(l);
  isInvokedInAlwaysInvokedConstructor=allOccurrencesInOneMethod(myContext.occurrences,(GrTypeDefinition)myContext.scope) && isAlwaysInvokedConstructor(GrIntroduceFieldHandler.getContainingMethod(myContext.expression,(GrTypeDefinition)myContext.scope),(GrTypeDefinition)myContext.scope);
  hasLHSUsages=hasLhsUsages(myContext);
  myInvokedOnLocalVar=getInvokedOnLocalVar(myContext.expression);
  init();
  checkErrors();
}
