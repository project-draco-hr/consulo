{
  ApplicationManager.getApplication().runReadAction(new Runnable(){
    public void run(){
synchronized (RecursiveFileHolder.this) {
        if (myProject.isDisposed())         return;
        final List<VirtualFile> currentFiles=new ArrayList<VirtualFile>(myFiles.keySet());
        for (        VirtualFile file : currentFiles) {
          if (isFileDirty(scope,file)) {
            if (mySwitchRoots != null) {
              mySwitchRoots.remove(file);
            }
            myFiles.remove(file);
          }
        }
      }
    }
  }
);
}
