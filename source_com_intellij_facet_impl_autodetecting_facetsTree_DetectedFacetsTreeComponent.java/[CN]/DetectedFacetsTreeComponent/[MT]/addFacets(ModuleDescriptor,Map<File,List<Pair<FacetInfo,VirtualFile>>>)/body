{
  for (  File root : root2Facets.keySet()) {
    ModuleDescriptorNode moduleNode=new ModuleDescriptorNode(moduleDescriptor,root);
    Map<FacetInfo,DetectedFacetsTree.FacetNode> facetInfos=new HashMap<FacetInfo,DetectedFacetsTree.FacetNode>();
    for (    Pair<FacetInfo,VirtualFile> pair : root2Facets.get(root)) {
      DetectedFacetsTree.FacetNode parent=null;
      FacetInfo underlyingFacet=pair.getFirst().getUnderlyingFacet();
      if (underlyingFacet != null) {
        parent=facetInfos.get(underlyingFacet);
      }
      String relativePath=getRelativePath(root,pair.getSecond());
      DetectedFacetsTree.FacetNode detectedFacet=new FacetInfoNode(pair.getFirst(),relativePath,pair.getSecond(),parent);
      facetInfos.put(pair.getFirst(),detectedFacet);
      if (parent == null) {
        moduleNode.addRootFacet(detectedFacet);
      }
    }
    myModuleNodes.add(moduleNode);
  }
}
