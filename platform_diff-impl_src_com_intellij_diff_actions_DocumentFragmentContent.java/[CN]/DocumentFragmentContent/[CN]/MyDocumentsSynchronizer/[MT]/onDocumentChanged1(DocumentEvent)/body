{
  if (!myRangeMarker.isValid()) {
    myDocument2.setReadOnly(false);
    replaceString(myDocument2,0,myDocument2.getTextLength(),"Invalid selection range");
    myDocument2.setReadOnly(true);
    return;
  }
  CharSequence newText=myDocument1.getCharsSequence().subSequence(myRangeMarker.getStartOffset(),myRangeMarker.getEndOffset());
  replaceString(myDocument2,0,myDocument2.getTextLength(),newText);
}
