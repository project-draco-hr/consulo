{
  final PsiElement oldParent=event.getOldParent();
  final PsiElement child=event.getChild();
  if (oldParent instanceof PsiDirectory) {
    if (child instanceof PsiFileSystemItem && (!(child instanceof PsiFile) || !isInjected((PsiFile)child))) {
      queueUpdate(new Runnable(){
        @Override public void run(){
          final DefaultMutableTreeNode rootToReload=myBuilder.removeNode(child,child instanceof PsiDirectory ? (PsiDirectory)child : (PsiDirectory)oldParent);
          if (rootToReload != null) {
            reload(rootToReload);
          }
        }
      }
,true);
    }
  }
}
