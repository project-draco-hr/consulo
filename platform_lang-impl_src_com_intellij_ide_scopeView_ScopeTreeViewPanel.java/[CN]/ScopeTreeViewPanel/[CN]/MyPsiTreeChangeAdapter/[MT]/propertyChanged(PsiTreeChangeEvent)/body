{
  String propertyName=event.getPropertyName();
  final PsiElement element=event.getElement();
  if (element != null) {
    final NamedScope scope=getCurrentScope();
    if (propertyName.equals(PsiTreeChangeEvent.PROP_FILE_NAME) || propertyName.equals(PsiTreeChangeEvent.PROP_FILE_TYPES)) {
      queueUpdate(new Runnable(){
        public void run(){
          if (element.isValid()) {
            processRenamed(scope,element.getContainingFile());
          }
        }
      }
,false);
    }
 else     if (propertyName.equals(PsiTreeChangeEvent.PROP_DIRECTORY_NAME)) {
      queueRefreshScope(scope,(PsiDirectory)element);
    }
  }
}
