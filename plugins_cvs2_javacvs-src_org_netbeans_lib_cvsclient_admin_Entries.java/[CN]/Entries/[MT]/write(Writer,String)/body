{
  final BufferedWriter lineWriter=new BufferedWriter(writer);
  try {
    if (fileNameToEntryMap.size() == 0) {
      lineWriter.write("D");
      lineWriter.write(lineSeparator);
    }
 else {
      final Entry[] entryArray=new Entry[fileNameToEntryMap.size()];
      fileNameToEntryMap.values().toArray(entryArray);
      Arrays.sort(entryArray,new EntriesComparator());
      for (int i=0; i < entryArray.length; i++) {
        final Entry entry=entryArray[i];
        lineWriter.write(entry.toString());
        lineWriter.write(lineSeparator);
      }
    }
  }
  finally {
    lineWriter.close();
  }
}
