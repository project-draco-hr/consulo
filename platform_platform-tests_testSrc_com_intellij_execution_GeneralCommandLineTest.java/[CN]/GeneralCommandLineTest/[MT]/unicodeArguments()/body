{
  assumeTrue("UTF-8".equals(System.getProperty("file.encoding")));
  File script;
  GeneralCommandLine commandLine;
  String encoding=null;
  if (SystemInfo.isWindows) {
    script=ExecUtil.createTempExecutableScript("args.",".js","WSH.Echo(\"=====\");\n" + "for (i = 0; i < WSH.Arguments.length; i++) {\n" + "  WSH.Echo(WSH.Arguments(i));\n"+ "}\n"+ "WSH.Echo(\"=====\");\n");
    commandLine=new GeneralCommandLine("cscript","//Nologo","//U",script.getPath());
    encoding="UTF-16LE";
  }
 else {
    script=ExecUtil.createTempExecutableScript("args.",".sh","#!/bin/sh\n\n" + "echo \"=====\"\n" + "for f in \"$@\" ; do echo \"$f\"; done\n"+ "echo \"=====\"\n");
    commandLine=new GeneralCommandLine(script.getPath());
  }
  try {
    commandLine.addParameters("??????????????","??????????????????","????????????????????");
    String output=execAndGetOutput(commandLine,encoding);
    assertEquals("=====\n??????????????\n??????????????????\n????????????????????\n=====\n",StringUtil.convertLineSeparators(output));
  }
  finally {
    FileUtil.delete(script);
  }
}
