{
  LOG.assertTrue(!myStoppedAlready);
  myInstallFunAlarm.cancelAllRequests();
  super.stop();
  if (myDialog != null) {
    final Window dialogWindow=SwingUtilities.getWindowAncestor(myDialog.getPanel());
    final boolean sameWindow=dialogWindow instanceof IdeFrame;
    if (!sameWindow) {
      myDialog.hide();
    }
    if (myDialog.wasShown()) {
      myFocusTrackback.restoreFocus();
    }
 else {
      myFocusTrackback.consume();
    }
    if (sameWindow) {
      myDialog.hide();
    }
  }
  myStoppedAlready=true;
  Disposer.dispose(this);
  SwingUtilities.invokeLater(EmptyRunnable.INSTANCE);
}
