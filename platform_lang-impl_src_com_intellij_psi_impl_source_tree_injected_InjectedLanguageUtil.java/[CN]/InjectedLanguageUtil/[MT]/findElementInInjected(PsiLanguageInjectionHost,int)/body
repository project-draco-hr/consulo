{
  final Ref<PsiElement> ref=Ref.create();
  enumerate(injectionHost,new PsiLanguageInjectionHost.InjectedPsiVisitor(){
    @Override public void visit(    @NotNull final PsiFile injectedPsi,    @NotNull final List<PsiLanguageInjectionHost.Shred> places){
      ref.set(injectedPsi.findElementAt(offset - getInjectedStart(places)));
    }
  }
);
  return ref.get();
}
