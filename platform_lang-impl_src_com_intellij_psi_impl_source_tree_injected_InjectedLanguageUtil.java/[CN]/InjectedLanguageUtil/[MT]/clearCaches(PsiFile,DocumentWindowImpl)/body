{
  VirtualFileWindowImpl virtualFile=(VirtualFileWindowImpl)injected.getVirtualFile();
  PsiManagerEx psiManagerEx=(PsiManagerEx)injected.getManager();
  if (psiManagerEx.getProject().isDisposed())   return;
  psiManagerEx.getFileManager().setViewProvider(virtualFile,null);
  PsiElement context=InjectedLanguageManager.getInstance(injected.getProject()).getInjectionHost(injected);
  PsiFile hostFile;
  if (context != null) {
    hostFile=context.getContainingFile();
  }
 else {
    VirtualFile delegate=virtualFile.getDelegate();
    hostFile=delegate.isValid() ? psiManagerEx.findFile(delegate) : null;
  }
  if (hostFile != null) {
synchronized (PsiLock.LOCK) {
      List<DocumentWindow> cachedInjectedDocuments=getCachedInjectedDocuments(hostFile);
      for (int i=cachedInjectedDocuments.size() - 1; i >= 0; i--) {
        DocumentWindow cachedInjectedDocument=cachedInjectedDocuments.get(i);
        if (cachedInjectedDocument == documentWindow) {
          cachedInjectedDocuments.remove(i);
        }
      }
    }
  }
}
