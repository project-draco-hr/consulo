{
  int minChar=0;
  int maxChar=s.length();
  int chars;
  while (minChar < maxChar) {
    chars=(minChar + maxChar + 1) / 2;
    int width=metrics.stringWidth(s.substring(0,chars));
    if (width <= maxWidth) {
      minChar=chars;
    }
 else {
      maxChar=chars - 1;
    }
  }
  return minChar;
}
