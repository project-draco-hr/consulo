{
  super.initialize();
  final JUnitConfiguration.Data data=myConfiguration.getPersistentData();
  getClassFilter(data);
  final ExecutionException[] exception=new ExecutionException[1];
  ApplicationManager.getApplication().runReadAction(new Runnable(){
    public void run(){
      try {
        myConfiguration.configureClasspath(myJavaParameters);
      }
 catch (      CantRunException e) {
        exception[0]=e;
      }
    }
  }
);
  if (exception[0] != null) {
    throw exception[0];
  }
  try {
    myTempFile=FileUtil.createTempFile("idea_junit",".tmp");
    myTempFile.deleteOnExit();
    myJavaParameters.getProgramParametersList().add("@" + myTempFile.getAbsolutePath());
  }
 catch (  IOException e) {
    LOG.error(e);
  }
  try {
    myServerSocket=new ServerSocket(0,0,InetAddress.getByName(null));
    myJavaParameters.getProgramParametersList().add("-socket" + myServerSocket.getLocalPort());
  }
 catch (  IOException e) {
    LOG.error(e);
  }
}
