{
  AtomicInteger count=myProject.getUserData(HIGHLIGHT_VISITOR_INSTANCE_COUNT);
  if (count == null) {
    count=((UserDataHolderEx)myProject).putUserDataIfAbsent(HIGHLIGHT_VISITOR_INSTANCE_COUNT,new AtomicInteger(0));
  }
  HighlightVisitor[] highlightVisitors=Extensions.getExtensions(HighlightVisitor.EP_HIGHLIGHT_VISITOR,myProject);
  if (count.getAndIncrement() != 0) {
    highlightVisitors=highlightVisitors.clone();
    for (int i=0; i < highlightVisitors.length; i++) {
      HighlightVisitor highlightVisitor=highlightVisitors[i];
      highlightVisitors[i]=highlightVisitor.clone();
    }
  }
  for (  final HighlightVisitor highlightVisitor : highlightVisitors) {
    highlightVisitor.init();
  }
  return highlightVisitors;
}
