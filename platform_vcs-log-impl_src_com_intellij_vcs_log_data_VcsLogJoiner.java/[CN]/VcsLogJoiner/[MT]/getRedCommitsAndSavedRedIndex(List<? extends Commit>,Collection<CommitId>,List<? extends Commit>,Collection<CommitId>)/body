{
  Set<CommitId> startRedCommits=new THashSet<>(previousRefs);
  startRedCommits.removeAll(newRefs);
  Set<CommitId> startGreenNodes=new THashSet<>(newRefs);
  for (  Commit commit : firstBlock) {
    startGreenNodes.add(commit.getId());
    startGreenNodes.addAll(commit.getParents());
  }
  RedGreenSorter<CommitId,Commit> sorter=new RedGreenSorter<>(startRedCommits,startGreenNodes,savedLog);
  int saveRegIndex=sorter.getFirstSaveIndex();
  return new Pair<>(saveRegIndex,sorter.getAllRedCommit());
}
