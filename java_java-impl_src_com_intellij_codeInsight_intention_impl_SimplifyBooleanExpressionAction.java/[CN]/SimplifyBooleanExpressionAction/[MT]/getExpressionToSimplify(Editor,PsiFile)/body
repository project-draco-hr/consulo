{
  int offset=editor.getCaretModel().getOffset();
  PsiElement element=file.findElementAt(offset);
  if (element == null)   return null;
  PsiExpression expression=PsiTreeUtil.getParentOfType(element,PsiExpression.class);
  PsiElement parent=expression;
  while (parent instanceof PsiExpression && (PsiType.BOOLEAN.equals(((PsiExpression)parent).getType()) || parent instanceof PsiConditionalExpression)) {
    expression=(PsiExpression)parent;
    parent=parent.getParent();
  }
  return expression;
}
