{
  addElement(new Object(),myCollection);
  myCollection.add(new Object());
  addElement(new Object(),myCollection);
  myCollection.add(new Object());
  addElement(new Object(),myCollection);
  Iterator<Object> iterator=myWeakList.iterator();
  assertSame(myHolder.get(0),iterator.next());
  while (myHolder.get(1) != iterator.next())   ;
  gc();
  checkForAliveCount(4);
  iterator.remove();
  gc();
  checkForAliveCount(3);
  iterator.next();
  gc();
  checkForAliveCount(2);
  assertSame(myHolder.get(2),iterator.next());
  assertFalse(iterator.hasNext());
  myHolder.remove(1);
  checkSameNotNulls(null);
  checkSameElements(new Runnable(){
    @Override public void run(){
      myCollection.compress(-1);
    }
  }
);
}
