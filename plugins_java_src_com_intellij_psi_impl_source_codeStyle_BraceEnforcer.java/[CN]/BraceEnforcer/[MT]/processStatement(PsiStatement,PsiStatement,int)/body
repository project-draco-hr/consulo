{
  if (blockCandidate instanceof PsiBlockStatement || blockCandidate == null)   return;
  boolean forceNewLine=!FormatterUtil.isFormatterCalledExplicitly() && !ApplicationManager.getApplication().isUnitTestMode() && !myPostProcessor.getSettings().KEEP_CONTROL_STATEMENT_IN_ONE_LINE;
  if (forceNewLine || options == CommonCodeStyleSettings.FORCE_BRACES_ALWAYS || (options == CommonCodeStyleSettings.FORCE_BRACES_IF_MULTILINE && PostFormatProcessorHelper.isMultiline(statement))) {
    replaceWithBlock(statement,blockCandidate,forceNewLine);
  }
}
