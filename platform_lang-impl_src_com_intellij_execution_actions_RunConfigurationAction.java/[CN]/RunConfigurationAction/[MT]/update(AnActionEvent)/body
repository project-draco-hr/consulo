{
  final Presentation presentation=e.getPresentation();
  final Project project=e.getData(PlatformDataKeys.PROJECT);
  if (ActionPlaces.MAIN_MENU.equals(e.getPlace())) {
    presentation.setDescription(ExecutionBundle.message("choose.run.configuration.action.description"));
    presentation.setEnabled(findFrame(e.getData(PlatformDataKeys.CONTEXT_COMPONENT)) != null);
    return;
  }
  try {
    if (project == null || project.isDisposed()) {
      updateButton(null,null,presentation);
      presentation.setEnabled(false);
    }
 else {
      if (DumbService.getInstance(project).isDumb()) {
        presentation.setEnabled(false);
      }
 else {
        final RunManagerEx runManager=RunManagerEx.getInstanceEx(project);
        RunnerAndConfigurationSettings selected=runManager.getSelectedConfiguration();
        updateButton(selected,project,presentation);
        presentation.setEnabled(true);
      }
    }
  }
 catch (  IndexNotReadyException e1) {
    presentation.setEnabled(false);
  }
}
