{
  XStackFrame stackFrame=mySession.getCurrentStackFrame();
  XDebuggerTree tree=myTreePanel.getTree();
  if (event == SessionEvent.BEFORE_RESUME) {
    if (myTreeRestorer != null) {
      myTreeRestorer.dispose();
    }
    myTreeState=XDebuggerTreeState.saveState(tree);
    return;
  }
  if (stackFrame != null) {
    tree.setSourcePosition(stackFrame.getSourcePosition());
    tree.setRoot(new WatchesRootNode(tree,myWatchExpressions,stackFrame.getEvaluator()),false);
    if (myTreeState != null) {
      myTreeRestorer=myTreeState.restoreState(tree);
    }
  }
 else {
    tree.setSourcePosition(null);
    tree.setRoot(MessageTreeNode.createInfoMessage(tree,null,mySession.getDebugProcess().getCurrentStateMessage()),true);
  }
}
