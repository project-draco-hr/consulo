{
  if (!canMakeWritable(document) && !canMakeWritable(otherDocument))   return null;
  if (range.getLength() != 0) {
    if (canMakeWritable(otherDocument))     return otherRange.getLength() != 0 ? replaceOperation(range,otherRange,document,otherDocument) : insertOperation(range,otherRange.getEndOffset(),document,otherDocument);
 else     return otherRange.getLength() == 0 ? removeOperation(range,document) : null;
  }
  return null;
}
