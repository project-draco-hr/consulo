{
  final LinkedHashMap<MavenProjectModel,Module> modules=new LinkedHashMap<MavenProjectModel,Module>();
  myProjectModel.visit(new MavenProjectModelManager.SimpleVisitor(){
    public void visit(    MavenProjectModel node){
      Module m=createModule(node);
      modules.put(node,m);
    }
  }
);
  LinkedHashMap<Module,ModifiableRootModel> rootModels=new LinkedHashMap<Module,ModifiableRootModel>();
  for (  Map.Entry<MavenProjectModel,Module> each : modules.entrySet()) {
    ModifiableRootModel model=createModuleConfigurator(each.getValue(),each.getKey()).config();
    rootModels.put(each.getValue(),model);
  }
  for (  Map.Entry<MavenProjectModel,Module> each : modules.entrySet()) {
    createModuleConfigurator(each.getValue(),each.getKey()).preConfigFacets(rootModels.get(each.getValue()));
  }
  for (  Map.Entry<MavenProjectModel,Module> each : modules.entrySet()) {
    createModuleConfigurator(each.getValue(),each.getKey()).configFacets(rootModels.get(each.getValue()));
  }
  myRootModelsToCommit.addAll(rootModels.values());
  MavenProjectsManager.getInstance(myProject).setMavenizedModules(new ArrayList<Module>(modules.values()));
}
