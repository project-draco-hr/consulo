{
  List<MavenProjectModel> projects=myMavenTree.getProjects();
  for (  MavenProjectModel each : projects) {
    ensureModuleCreated(each);
  }
  LinkedHashMap<Module,ModifiableRootModel> rootModels=new LinkedHashMap<Module,ModifiableRootModel>();
  for (  MavenProjectModel each : projects) {
    Module module=myMavenProjectToModule.get(each);
    rootModels.put(module,createModuleConfigurator(module,each).config());
  }
  for (  MavenProjectModel each : projects) {
    Module module=myMavenProjectToModule.get(each);
    createModuleConfigurator(module,each).preConfigFacets(rootModels.get(module));
  }
  for (  MavenProjectModel each : projects) {
    Module module=myMavenProjectToModule.get(each);
    createModuleConfigurator(module,each).configFacets(rootModels.get(module));
  }
  myRootModelsToCommit.addAll(rootModels.values());
  ArrayList<Module> modules=new ArrayList<Module>(myMavenProjectToModule.values());
  MavenProjectsManager.getInstance(myProject).setMavenizedModules(modules);
}
