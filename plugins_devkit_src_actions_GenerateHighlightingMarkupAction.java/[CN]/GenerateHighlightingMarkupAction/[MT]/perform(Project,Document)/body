{
  final CharSequence sequence=document.getCharsSequence();
  final StringBuilder sb=new StringBuilder();
  final int[] offset=new int[]{0};
  final ArrayList<HighlightInfo> infos=new ArrayList<HighlightInfo>();
  DaemonCodeAnalyzerImpl.processHighlights(document,project,HighlightSeverity.WARNING,0,sequence.length(),new Processor<HighlightInfo>(){
    @Override public boolean process(    HighlightInfo info){
      if (info.severity != HighlightSeverity.WARNING && info.severity != HighlightSeverity.ERROR)       return true;
      offset[0]=appendInfo(info,sb,sequence,offset[0],infos);
      return true;
    }
  }
);
  offset[0]=appendInfo(null,sb,sequence,offset[0],infos);
  sb.append(sequence.subSequence(offset[0],sequence.length()));
  document.setText(sb);
}
