{
  super.init();
  ArrayList<Macro> macros=CollectUtil.COLLECT.toList(MacroManager.getInstance().getMacros());
  Collections.sort(macros,new Comparator(){
    public int compare(    Object o1,    Object o2){
      String name1=((Macro)o1).getName();
      String name2=((Macro)o2).getName();
      if (!StringUtil.startsWithChar(name1,'/')) {
        name1=ZERO + name1;
      }
      if (!StringUtil.startsWithChar(name2,'/')) {
        name2=ZERO + name2;
      }
      return name1.compareToIgnoreCase(name2);
    }
    private final String ZERO=new String(new char[]{0});
  }
);
  for (Iterator<Macro> iterator=macros.iterator(); iterator.hasNext(); ) {
    Macro macro=iterator.next();
    myMacrosModel.addElement(new MacroWrapper(macro));
  }
  addListeners();
  if (myMacrosModel.size() > 0) {
    myMacrosList.setSelectedIndex(0);
  }
 else {
    setOKActionEnabled(false);
  }
}
