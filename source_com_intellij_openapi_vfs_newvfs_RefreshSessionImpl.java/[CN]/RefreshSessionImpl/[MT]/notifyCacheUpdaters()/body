{
  final FileSystemSynchronizer synchronizer=new FileSystemSynchronizer();
  for (int i=0; i < myRefreshParticipants.size(); i++) {
    CacheUpdater participant=myRefreshParticipants.get(i);
    synchronizer.registerCacheUpdater(participant);
  }
  int filesCount=synchronizer.collectFilesToUpdate();
  if (filesCount > 0) {
    boolean runWithProgress=!ApplicationManager.getApplication().isUnitTestMode() && filesCount > 5;
    if (runWithProgress) {
      Runnable process=new Runnable(){
        public void run(){
          synchronizer.execute();
        }
      }
;
      ProgressManager.getInstance().runProcessWithProgressSynchronously(process,VfsBundle.message("file.update.modified.progress"),false,null);
    }
 else {
      synchronizer.execute();
    }
  }
}
