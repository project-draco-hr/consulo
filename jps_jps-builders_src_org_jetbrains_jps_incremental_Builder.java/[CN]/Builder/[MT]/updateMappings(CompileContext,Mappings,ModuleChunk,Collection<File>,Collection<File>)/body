{
  boolean additionalPassRequired=false;
  final Set<String> removedPaths=getRemovedPaths(context);
  final Mappings globalMappings=context.getDataManager().getMappings();
synchronized (globalMappings) {
    if (!context.isProjectRebuild()) {
      final Set<File> allCompiledFiles=getAllCompiledFilesContainer(context);
      final Set<File> allAffectedFiles=getAllAffectedFilesContainer(context);
      allAffectedFiles.addAll(filesToCompile);
      allCompiledFiles.addAll(successfullyCompiled);
      allAffectedFiles.removeAll(successfullyCompiled);
      final HashSet<File> affectedBeforeDif=new HashSet<File>(allAffectedFiles);
      final boolean incremental=globalMappings.differentiate(delta,removedPaths,successfullyCompiled,allCompiledFiles,allAffectedFiles);
      if (incremental) {
        final Set<File> newlyAffectedFiles=new HashSet<File>(allAffectedFiles);
        newlyAffectedFiles.removeAll(affectedBeforeDif);
        newlyAffectedFiles.removeAll(allCompiledFiles);
        if (!newlyAffectedFiles.isEmpty()) {
          for (          File file : newlyAffectedFiles) {
            context.markDirty(file);
          }
          additionalPassRequired=context.isMake() && chunkContainsAffectedFiles(context,chunk,newlyAffectedFiles);
        }
      }
 else {
        additionalPassRequired=context.isMake();
        context.markDirtyRecursively(chunk);
      }
    }
    globalMappings.integrate(delta,successfullyCompiled,removedPaths);
  }
  return additionalPassRequired;
}
