{
  final Template template=getObject();
  String text=template.getTemplateText();
  StringBuilder resultingText=new StringBuilder(text);
  int segmentsCount=template.getSegmentsCount();
  for (int j=segmentsCount - 1; j >= 0; j--) {
    if (template.getSegmentName(j).equals(TemplateImpl.END)) {
      continue;
    }
    int segmentOffset=template.getSegmentOffset(j);
    resultingText.insert(segmentOffset,PLACEHOLDER);
  }
  try {
    final PsiExpression templateExpression=JavaPsiFacade.getElementFactory(myContext.getProject()).createExpressionFromText(resultingText.toString(),myContext);
    return templateExpression.getType();
  }
 catch (  IncorrectOperationException e) {
    return null;
  }
}
