{
  GrExpression invoked=getInvokedExpression();
  if (invoked instanceof GrReferenceExpression) {
    GrReferenceExpression refExpr=(GrReferenceExpression)invoked;
    final GroovyResolveResult resolveResult=refExpr.advancedResolve();
    PsiElement resolved=resolveResult.getElement();
    if (resolved instanceof PsiMethod && !GroovyPsiManager.getInstance(resolved.getProject()).isTypeBeingInferred(resolved)) {
      PsiType returnType=((PsiMethod)resolved).getReturnType();
      if (returnType != null) {
        returnType=resolveResult.getSubstitutor().substitute(returnType);
        returnType=TypesUtil.boxPrimitiveType(returnType,getManager(),getResolveScope());
      }
      if (refExpr.getDotTokenType() != GroovyTokenTypes.mSPREAD_DOT) {
        return returnType;
      }
 else {
        return ResolveUtil.getListTypeForSpreadOperator(refExpr,returnType);
      }
    }
  }
  return null;
}
