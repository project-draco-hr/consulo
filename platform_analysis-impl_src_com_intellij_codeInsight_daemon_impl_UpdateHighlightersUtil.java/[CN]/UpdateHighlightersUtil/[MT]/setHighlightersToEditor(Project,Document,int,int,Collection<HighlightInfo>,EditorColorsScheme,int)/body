{
  TextRange range=new TextRange(startOffset,endOffset);
  ApplicationManager.getApplication().assertIsDispatchThread();
  PsiFile psiFile=PsiDocumentManager.getInstance(project).getPsiFile(document);
  final DaemonCodeAnalyzerEx codeAnalyzer=DaemonCodeAnalyzerEx.getInstanceEx(project);
  codeAnalyzer.cleanFileLevelHighlights(project,group,psiFile);
  MarkupModel markup=DocumentMarkupModel.forDocument(document,project,true);
  assertMarkupConsistent(markup,project);
  setHighlightersInRange(project,document,range,colorsScheme,new ArrayList<>(highlights),(MarkupModelEx)markup,group);
}
