{
  final DateFilterComponent dateComponent=new DateFilterComponent(false,DateFormatUtil.getDateFormat().getDelegate());
  if (myBefore != null) {
    dateComponent.setBefore(myBefore.getTime());
  }
  if (myAfter != null) {
    dateComponent.setAfter(myAfter.getTime());
  }
  DialogBuilder db=new DialogBuilder(DateFilterPopupComponent.this);
  db.addOkAction();
  db.setCenterPanel(dateComponent.getPanel());
  db.setPreferredFocusComponent(dateComponent.getPanel());
  db.setTitle("Select Period");
  if (DialogWrapper.OK_EXIT_CODE == db.show()) {
    long after=dateComponent.getAfter();
    long before=dateComponent.getBefore();
    myAfter=after > 0 ? new Date(after) : null;
    myBefore=before > 0 ? new Date(before) : null;
    if (myAfter != null && myBefore != null) {
      setValue(DateFormatUtil.formatDate(after) + "-" + DateFormatUtil.formatDate(before));
    }
 else     if (myAfter != null) {
      setValue("After " + DateFormatUtil.formatDate(after));
    }
 else {
      setValue("Before " + DateFormatUtil.formatDate(before));
    }
    applyFilters();
  }
}
