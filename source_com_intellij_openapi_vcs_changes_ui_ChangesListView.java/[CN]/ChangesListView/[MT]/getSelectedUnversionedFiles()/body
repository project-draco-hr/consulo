{
  List<VirtualFile> files=new ArrayList<VirtualFile>();
  final TreePath[] paths=getSelectionPaths();
  if (paths != null) {
    for (    TreePath path : paths) {
      Node node=(Node)path.getLastPathComponent();
      final Object userObject=node.getUserObject();
      if (userObject instanceof VirtualFile) {
        final VirtualFile file=(VirtualFile)userObject;
        if (file.isValid()) {
          files.add(file);
        }
      }
    }
  }
  return files;
}
