{
  if (newYEnd - newYStart < getMinHeight()) {
    newYEnd=newYStart + getMinHeight();
  }
  yEnd=Math.max(yEnd,newYEnd - yStart < getMinHeight() ? yStart + getMinHeight() : newYEnd);
  if (markers.size() != 0) {
    final int prevMarkIndex=markers.size() - 1;
    final RangeHighlighter prevMark=markers.get(prevMarkIndex);
    final int prevMarkEnd=paintingEndOffsets.get(prevMarkIndex);
    if (prevMark.getLayer() < mark.getLayer()) {
      paintingEndOffsets.set(prevMarkIndex,Math.min(prevMarkEnd,newYStart));
    }
 else     if (prevMarkEnd > newYEnd) {
      return;
    }
  }
  markers.add(mark);
  paintingEndOffsets.add(newYEnd);
}
