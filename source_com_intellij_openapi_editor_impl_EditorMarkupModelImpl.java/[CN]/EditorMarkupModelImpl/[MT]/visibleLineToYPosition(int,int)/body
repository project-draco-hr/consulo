{
  EditorImpl.MyScrollBar scrollBar=myEditor.getVerticalScrollBar();
  int top=scrollBar.getDecScrollButtonHeight() + 1;
  int bottom=scrollBar.getIncScrollButtonHeight();
  final int targetHeight=scrollBarHeight - top - bottom;
  final int sourceHeight=myEditor.getPreferredSize().height;
  if (sourceHeight < targetHeight) {
    return top + lineNumber * myEditor.getLineHeight();
  }
 else {
    final int lineCount=sourceHeight / myEditor.getLineHeight();
    return top + (int)(((float)lineNumber / lineCount) * targetHeight);
  }
}
