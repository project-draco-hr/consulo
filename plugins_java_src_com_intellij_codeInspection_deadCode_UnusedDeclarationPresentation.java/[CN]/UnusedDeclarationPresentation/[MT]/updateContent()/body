{
  getTool().checkForReachables();
  myPackageContents=new HashMap<String,Set<RefEntity>>();
  getContext().getRefManager().iterate(new RefJavaVisitor(){
    @Override public void visitElement(    @NotNull RefEntity refEntity){
      if (!(refEntity instanceof RefJavaElement))       return;
      RefJavaElement refElement=(RefJavaElement)refEntity;
      if (!(getContext().getUIOptions().FILTER_RESOLVED_ITEMS && getIgnoredRefElements().contains(refElement)) && refElement.isValid() && getFilter().accepts(refElement)) {
        String packageName=RefJavaUtil.getInstance().getPackageName(refEntity);
        Set<RefEntity> content=myPackageContents.get(packageName);
        if (content == null) {
          content=new HashSet<RefEntity>();
          myPackageContents.put(packageName,content);
        }
        content.add(refEntity);
      }
    }
  }
);
}
