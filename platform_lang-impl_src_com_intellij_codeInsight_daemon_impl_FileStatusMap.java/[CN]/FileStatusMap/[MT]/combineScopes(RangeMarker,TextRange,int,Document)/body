{
  if (scope == null)   return old;
  if (old == null) {
    return document.createRangeMarker(scope);
  }
  TextRange oldRange=new TextRange(old.getStartOffset(),old.getEndOffset());
  TextRange union=scope.union(oldRange);
  if (old.isValid() && union.equals(oldRange)) {
    return old;
  }
  if (union.getEndOffset() > textLength) {
    union=union.intersection(new TextRange(0,textLength));
  }
  old.dispose();
  return document.createRangeMarker(union);
}
