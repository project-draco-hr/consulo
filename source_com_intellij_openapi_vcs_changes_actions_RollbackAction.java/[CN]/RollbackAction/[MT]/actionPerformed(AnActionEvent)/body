{
  Project project=e.getData(DataKeys.PROJECT);
  List<FilePath> missingFiles=e.getData(ChangesListView.MISSING_FILES_DATA_KEY);
  if (missingFiles != null && !missingFiles.isEmpty()) {
    new RollbackDeletionAction().actionPerformed(e);
  }
 else {
    List<VirtualFile> modifiedWithoutEditing=getModifiedWithoutEditing(project,e);
    if (modifiedWithoutEditing != null && !modifiedWithoutEditing.isEmpty()) {
      rollbackModifiedWithoutEditing(project,modifiedWithoutEditing);
    }
 else {
      Change[] changes=getChanges(project,e);
      if (changes != null) {
        FileDocumentManager.getInstance().saveAllDocuments();
        RollbackChangesDialog.rollbackChanges(project,Arrays.asList(changes));
      }
    }
  }
}
