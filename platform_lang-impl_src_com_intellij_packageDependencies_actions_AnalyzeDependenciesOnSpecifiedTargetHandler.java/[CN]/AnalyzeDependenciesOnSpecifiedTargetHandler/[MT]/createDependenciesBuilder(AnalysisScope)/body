{
  return new ForwardDependenciesBuilder(myProject,scope){
    @Override public void analyze(){
      super.analyze();
      final Map<PsiFile,Set<PsiFile>> dependencies=getDependencies();
      for (      PsiFile file : dependencies.keySet()) {
        final Set<PsiFile> files=dependencies.get(file);
        final Iterator<PsiFile> iterator=files.iterator();
        while (iterator.hasNext()) {
          PsiFile next=iterator.next();
          final VirtualFile virtualFile=next.getVirtualFile();
          if (virtualFile == null || !myTargetScope.contains(virtualFile)) {
            iterator.remove();
          }
        }
      }
    }
  }
;
}
