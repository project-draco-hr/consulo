{
  int rc=Messages.showYesNoDialog(project,VcsBundle.message("checkout.create.project.prompt",ProjectDirCheckoutListener.getProductNameWithArticle(),directory.getAbsolutePath()),VcsBundle.message("checkout.title"),Messages.getQuestionIcon());
  if (rc == Messages.YES) {
    final ProjectManager pm=ProjectManager.getInstance();
    final Project[] projects=pm.getOpenProjects();
    final Set<VirtualFile> files=projectsLocationSet(projects);
    VirtualFile file=LocalFileSystem.getInstance().findFileByIoFile(directory);
    AddModuleWizard wizard=ImportModuleAction.createImportWizard(null,null,file,ProjectImportProvider.EP_NAME.getExtensions());
    if (wizard == null) {
      return false;
    }
    if (wizard.showAndGet()) {
      ImportModuleAction.createFromWizard(null,wizard);
    }
    final Project[] projectsAfter=pm.getOpenProjects();
    for (    Project project1 : projectsAfter) {
      if (project1.getBaseDir() != null && !files.contains(project1.getBaseDir())) {
        final ProjectLevelVcsManager vcsManager=ProjectLevelVcsManager.getInstance(project1);
        vcsManager.setDirectoryMappings(Collections.singletonList(new VcsDirectoryMapping("",vcsKey.getName())));
        break;
      }
    }
    return true;
  }
  return false;
}
