{
  StringBuffer value=new StringBuffer();
  for (int i=0; i < text.length(); i++) {
    char c=text.charAt(i);
    if (c == '\n') {
      if (!isUnescapedBackSlashAtTheEnd(value.toString())) {
        value.append("\\");
      }
      value.append("\n");
    }
 else {
      value.append(c);
    }
  }
  return value.toString();
}
