{
  int flags=0xFF & record.readByte();
  if (flags == NULL_FLAGS) {
    return NULL;
  }
  int frequentIndex=FREQUENT_INDEX_MASK & flags;
  boolean hasAnnotations=isSet(flags,HAS_ANNOTATIONS);
  byte arrayCount=isSet(flags,HAS_ARRAY_COUNT) ? record.readByte() : 0;
  boolean hasEllipsis=isSet(flags,HAS_ELLIPSIS);
  StringRef text=frequentIndex == 0 ? record.readName() : StringRef.fromString(ourIndexFrequentType.get(frequentIndex));
  List<PsiAnnotationStub> annotationStubs;
  if (hasAnnotations) {
    int size=0xFF & record.readByte();
    annotationStubs=new ArrayList<PsiAnnotationStub>(size);
    for (int i=0; i < size; i++) {
      PsiAnnotationStub annotationStub=JavaStubElementTypes.ANNOTATION.deserialize(record,parentStub);
      annotationStubs.add(annotationStub);
    }
  }
 else {
    annotationStubs=Collections.emptyList();
  }
  return new TypeInfo(text,arrayCount,hasEllipsis,annotationStubs);
}
