{
  final Presentation presentation=e.getPresentation();
  final DataContext dataContext=e.getDataContext();
  final VirtualFile vFile=PlatformDataKeys.VIRTUAL_FILE.getData(dataContext);
  final EditorWindow window=(EditorWindow)dataContext.getData(DataConstantsEx.EDITOR_WINDOW);
  if (ActionPlaces.isPopupPlace(e.getPlace())) {
    presentation.setVisible(isEnabled(vFile,window));
  }
 else {
    presentation.setEnabled(isEnabled(vFile,window));
  }
}
