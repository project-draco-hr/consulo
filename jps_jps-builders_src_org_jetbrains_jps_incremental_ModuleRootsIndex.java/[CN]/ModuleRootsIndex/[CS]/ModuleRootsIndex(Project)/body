{
  final Collection<Module> allModules=project.getModules().values();
  myTotalModuleCount=allModules.size();
  for (  Module module : allModules) {
    List<RootDescriptor> moduleRoots=myModuleToRootsMap.get(module);
    if (moduleRoots == null) {
      moduleRoots=new ArrayList<RootDescriptor>();
      myModuleToRootsMap.put(module,moduleRoots);
    }
    Set<String> generatedRoots=module.getGeneratedSourceRoots();
    if (generatedRoots == null) {
      generatedRoots=Collections.emptySet();
    }
    for (    String r : module.getSourceRoots()) {
      final File root=new File(FileUtil.toCanonicalPath(r));
      final RootDescriptor descriptor=new RootDescriptor(module,root,false,generatedRoots.contains(r));
      myRootToModuleMap.put(root,descriptor);
      moduleRoots.add(descriptor);
    }
    for (    String r : module.getTestRoots()) {
      final File root=new File(FileUtil.toCanonicalPath(r));
      final RootDescriptor descriptor=new RootDescriptor(module,root,true,generatedRoots.contains(r));
      myRootToModuleMap.put(root,descriptor);
      moduleRoots.add(descriptor);
    }
    for (    String r : module.getOwnExcludes()) {
      final File root=new File(FileUtil.toCanonicalPath(r));
      myExcludedRoots.add(root);
    }
  }
}
