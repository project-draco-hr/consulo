{
  Map<File,RootDescriptor> rootToDescriptorMap;
  Map<Module,List<RootDescriptor>> moduleToRootMap;
  if (isTemp) {
    rootToDescriptorMap=ROOT_DESCRIPTOR_MAP.get(context);
    if (rootToDescriptorMap == null) {
      rootToDescriptorMap=new HashMap<File,RootDescriptor>();
      ROOT_DESCRIPTOR_MAP.set(context,rootToDescriptorMap);
    }
    moduleToRootMap=MODULE_ROOT_MAP.get(context);
    if (moduleToRootMap == null) {
      moduleToRootMap=new HashMap<Module,List<RootDescriptor>>();
      MODULE_ROOT_MAP.set(context,moduleToRootMap);
    }
  }
 else {
    rootToDescriptorMap=myRootToDescriptorMap;
    moduleToRootMap=myModuleToRootsMap;
  }
  final RootDescriptor d=rootToDescriptorMap.get(root);
  if (d != null) {
    return d;
  }
  List<RootDescriptor> moduleRoots=moduleToRootMap.get(module);
  if (moduleRoots == null) {
    moduleRoots=new ArrayList<RootDescriptor>();
    moduleToRootMap.put(module,moduleRoots);
  }
  final RootDescriptor descriptor=new RootDescriptor(module.getName(),root,isTestRoot,isForGeneratedSources,isTemp);
  rootToDescriptorMap.put(root,descriptor);
  moduleRoots.add(descriptor);
  return descriptor;
}
