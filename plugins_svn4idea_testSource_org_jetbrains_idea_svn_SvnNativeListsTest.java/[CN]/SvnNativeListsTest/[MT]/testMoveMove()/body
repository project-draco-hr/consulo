{
  final LocalChangeList newL=myChangeListManager.addChangeList("newOne",null);
  sleepABit();
  myDirtyScopeManager.markEverythingDirty();
  myChangeListManager.ensureUpToDate(false);
  myChangeListManager.setDefaultChangeList(newL);
  enableSilentOperation(VcsConfiguration.StandardConfirmation.ADD);
  enableSilentOperation(VcsConfiguration.StandardConfirmation.REMOVE);
  final VirtualFile file=createFileInCommand("a.txt","old content");
  myDirtyScopeManager.markEverythingDirty();
  myChangeListManager.ensureUpToDate(false);
  sleepABit();
  checkin();
  renameFileInCommand(file,"b.txt");
  myDirtyScopeManager.markEverythingDirty();
  myChangeListManager.ensureUpToDate(false);
  sleepABit();
  ensureAddedToNativeList();
  verify(runSvn("status"),"","--- Changelist 'newOne':","A + b.txt","D a.txt");
  renameFileInCommand(file,"c.txt");
  myDirtyScopeManager.markEverythingDirty();
  myChangeListManager.ensureUpToDate(false);
  sleepABit();
  verify(runSvn("status"),"","--- Changelist 'newOne':","A + c.txt","D a.txt");
  ensureAddedToNativeList();
  verify(runSvn("status"),"","--- Changelist 'newOne':","A + c.txt","D a.txt");
}
