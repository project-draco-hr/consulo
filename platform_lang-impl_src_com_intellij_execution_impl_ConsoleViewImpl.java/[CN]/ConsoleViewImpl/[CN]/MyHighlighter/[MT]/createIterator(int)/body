{
  final int startIndex=ConsoleUtil.findTokenInfoIndexByOffset(myTokens,startOffset);
  return new HighlighterIterator(){
    private int myIndex=startIndex;
    @Override public TextAttributes getTextAttributes(){
      return atEnd() ? null : getTokenInfo().contentType.getAttributes();
    }
    @Override public int getStart(){
      return atEnd() ? 0 : getTokenInfo().startOffset;
    }
    @Override public int getEnd(){
      return atEnd() ? 0 : getTokenInfo().endOffset;
    }
    @Override public IElementType getTokenType(){
      return null;
    }
    @Override public void advance(){
      myIndex++;
    }
    @Override public void retreat(){
      myIndex--;
    }
    @Override public boolean atEnd(){
      return myIndex < 0 || myIndex >= myTokens.size();
    }
    @Override public Document getDocument(){
      return myEditor.getDocument();
    }
    private TokenInfo getTokenInfo(){
      return myTokens.get(myIndex);
    }
  }
;
}
