{
  final FoldingModel model=myEditor.getFoldingModel();
  model.runBatchFoldingOperationDoNotCollapseCaret(new Runnable(){
    public void run(){
      for (      FoldRegion region : toRemove) {
        model.removeFoldRegion(region);
      }
      for (      FoldRegion region : toAdd) {
        region.setExpanded(false);
        model.addFoldRegion(region);
      }
    }
  }
);
}
