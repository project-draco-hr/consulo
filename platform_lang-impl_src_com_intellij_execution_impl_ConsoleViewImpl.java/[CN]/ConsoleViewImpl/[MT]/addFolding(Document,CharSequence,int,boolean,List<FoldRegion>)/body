{
  myFolding.put(line,isInternal);
  final Boolean prevFolding=myFolding.get(line - 1);
  if (!isInternal && Boolean.TRUE.equals(prevFolding)) {
    final int lEnd=line - 1;
    int lStart=lEnd;
    while (Boolean.TRUE.equals(myFolding.get(lStart - 1)))     lStart--;
    if (lStart == lEnd) {
      return;
    }
    int oStart=document.getLineStartOffset(lStart);
    oStart=CharArrayUtil.shiftForward(chars,oStart," \t");
    int oEnd=CharArrayUtil.shiftBackward(chars,document.getLineEndOffset(lEnd) - 1," \t") + 1;
    toAdd.add(new FoldRegionImpl(myEditor,oStart,oEnd," " + (lEnd - lStart + 1) + " internal calls",null));
  }
}
