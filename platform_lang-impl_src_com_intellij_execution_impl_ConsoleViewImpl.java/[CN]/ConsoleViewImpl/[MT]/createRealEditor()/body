{
  final EditorEx editor=ConsoleViewUtil.setupConsoleEditor(myProject,true,false);
  editor.getDocument().addDocumentListener(new DocumentListener(){
    @Override public void beforeDocumentChange(    DocumentEvent event){
    }
    @Override public void documentChanged(    DocumentEvent event){
      if (event.getNewLength() == 0) {
synchronized (LOCK) {
          ConsoleUtil.updateTokensOnTextRemoval(myTokens,event.getOffset(),event.getOffset() + event.getOldLength());
          int toRemoveLen=event.getOldLength();
          myContentSize-=Math.min(myContentSize,toRemoveLen);
        }
      }
      if (myFileType != null) {
        highlightUserTokens();
      }
    }
  }
);
  editor.getSettings().setAllowSingleLogicalLineFolding(true);
  editor.setHighlighter(createHighlighter());
  if (!isViewer) {
    setEditorUpActions(editor);
  }
  return editor;
}
