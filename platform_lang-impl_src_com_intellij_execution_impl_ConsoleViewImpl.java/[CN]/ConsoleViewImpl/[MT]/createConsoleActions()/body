{
  final CommonActionsManager actionsManager=CommonActionsManager.getInstance();
  final AnAction prevAction=actionsManager.createPrevOccurenceAction(this);
  prevAction.getTemplatePresentation().setText(getPreviousOccurenceActionName());
  final AnAction nextAction=actionsManager.createNextOccurenceAction(this);
  nextAction.getTemplatePresentation().setText(getNextOccurenceActionName());
  final AnAction switchSoftWrapsAction=new ToggleUseSoftWrapsToolbarAction(SoftWrapAppliancePlaces.CONSOLE){
    @Override protected Editor getEditor(    AnActionEvent e){
      return myEditor;
    }
    @Override public void setSelected(    AnActionEvent e,    final boolean state){
      super.setSelected(e,state);
      final String placeholder=myCommandLineFolding.getPlaceholder(0);
      if (state && placeholder == null) {
        return;
      }
      final FoldingModel foldingModel=myEditor.getFoldingModel();
      FoldRegion[] foldRegions=foldingModel.getAllFoldRegions();
      Runnable foldTask=null;
      final int endFoldRegionOffset=myEditor.getDocument().getLineEndOffset(0);
      Runnable addCollapsedFoldRegionTask=new Runnable(){
        @Override public void run(){
          FoldRegion foldRegion=foldingModel.addFoldRegion(0,endFoldRegionOffset,placeholder == null ? "..." : placeholder);
          if (foldRegion != null) {
            foldRegion.setExpanded(false);
          }
        }
      }
;
      if (foldRegions.length <= 0) {
        if (!state) {
          return;
        }
        foldTask=addCollapsedFoldRegionTask;
      }
 else {
        final FoldRegion foldRegion=foldRegions[0];
        if (foldRegion.getStartOffset() == 0 && foldRegion.getEndOffset() == endFoldRegionOffset) {
          foldTask=new Runnable(){
            @Override public void run(){
              foldRegion.setExpanded(!state);
            }
          }
;
        }
 else         if (state) {
          foldTask=addCollapsedFoldRegionTask;
        }
      }
      if (foldTask != null) {
        foldingModel.runBatchFoldingOperation(foldTask);
      }
    }
  }
;
  final AnAction autoScrollToTheEndAction=new ScrollToTheEndToolbarAction(myEditor);
  final AnAction[] consoleActions=new AnAction[4 + customActions.size()];
  consoleActions[0]=prevAction;
  consoleActions[1]=nextAction;
  consoleActions[2]=switchSoftWrapsAction;
  consoleActions[3]=autoScrollToTheEndAction;
  for (int i=0; i < customActions.size(); ++i) {
    consoleActions[i + 4]=customActions.get(i);
  }
  return consoleActions;
}
