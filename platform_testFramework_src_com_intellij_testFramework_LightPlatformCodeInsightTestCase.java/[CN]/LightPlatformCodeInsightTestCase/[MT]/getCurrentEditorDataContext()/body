{
  final DataContext defaultContext=DataManager.getInstance().getDataContext();
  return new DataContext(){
    @Override @Nullable public Object getData(    @NonNls String dataId){
      if (PlatformDataKeys.EDITOR.is(dataId)) {
        return getEditor();
      }
      if (PlatformDataKeys.PROJECT.is(dataId)) {
        return getProject();
      }
      if (LangDataKeys.PSI_FILE.is(dataId)) {
        return getFile();
      }
      if (LangDataKeys.PSI_ELEMENT.is(dataId)) {
        PsiFile file=getFile();
        if (file == null)         return null;
        Editor editor=getEditor();
        if (editor == null)         return null;
        return file.findElementAt(editor.getCaretModel().getOffset());
      }
      return defaultContext.getData(dataId);
    }
  }
;
}
