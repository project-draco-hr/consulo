{
  Set<Usage> usages=getReadOnlyUsages();
  Set<VirtualFile> result=new HashSet<VirtualFile>();
  for (Iterator<Usage> i=usages.iterator(); i.hasNext(); ) {
    Usage usage=i.next();
    if (usage instanceof UsageInFile) {
      UsageInFile usageInFile=(UsageInFile)usage;
      result.add(usageInFile.getFile());
    }
    if (usage instanceof UsageInFiles) {
      UsageInFiles usageInFiles=(UsageInFiles)usage;
      result.addAll(Arrays.asList(usageInFiles.getFiles()));
    }
  }
  return result;
}
