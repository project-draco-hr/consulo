{
  Icon icon=(Icon)item.getAttribute(LookupItem.ICON_ATTR);
  if (icon != null)   return icon;
  Object o=item.getObject();
  final boolean withVisibility=CodeInsightSettings.getInstance().SHOW_SIGNATURES_IN_LOOKUPS;
  int flags=withVisibility ? Iconable.ICON_FLAG_VISIBILITY : 0;
  if (!real) {
    if (item.getObject() instanceof String) {
      return new EmptyIcon(0,0);
    }
    return new EmptyIcon(withVisibility ? SAMPLE_ICON.getIconWidth() * 2 : SAMPLE_ICON.getIconWidth(),SAMPLE_ICON.getIconHeight());
  }
  if (o instanceof Iconable && !(o instanceof PsiElement)) {
    return ((Iconable)o).getIcon(flags);
  }
  if (o instanceof LookupValueWithPsiElement) {
    o=((LookupValueWithPsiElement)o).getElement();
  }
  if (o instanceof PsiElement) {
    final PsiElement element=(PsiElement)o;
    if (element.isValid()) {
      return element.getIcon(flags);
    }
  }
  return null;
}
