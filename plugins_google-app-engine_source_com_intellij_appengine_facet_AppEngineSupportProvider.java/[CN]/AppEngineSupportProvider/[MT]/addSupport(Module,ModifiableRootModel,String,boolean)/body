{
  super.addSupport(module,rootModel,null,null);
  final AppEngineFacet appEngineFacet=FacetManager.getInstance(module).getFacetByType(AppEngineFacet.ID);
  LOG.assertTrue(appEngineFacet != null);
  final AppEngineFacetConfiguration facetConfiguration=appEngineFacet.getConfiguration();
  facetConfiguration.setSdkHomePath(sdkPath);
  final AppEngineSdk sdk=appEngineFacet.getSdk();
  final ApplicationServer appServer=sdk.getOrCreateAppServer();
  if (appServer != null) {
    final ConfigurationFactory type=AppEngineServerConfigurationType.getInstance().getConfigurationFactories()[0];
    final RunManagerEx runManager=RunManagerEx.getInstanceEx(module.getProject());
    final RunnerAndConfigurationSettingsImpl runSettings=(RunnerAndConfigurationSettingsImpl)runManager.createRunConfiguration("AppEngine Dev",type);
    final CommonStrategy configuration=(CommonStrategy)runSettings.getConfiguration();
    configuration.setApplicationServer(appServer);
    configuration.setUrlToOpenInBrowser(configuration.getDefaultUrlForBrowser());
    ((AppEngineServerModel)configuration.getServerModel()).setWebFacet(appEngineFacet.getWebFacet());
    runManager.addConfiguration(runSettings,false);
    runManager.setActiveConfiguration(runSettings);
  }
  final Library apiJar=addProjectLibrary(module,"AppEngine API",sdk.getLibUserDirectoryPath(),null);
  rootModel.addLibraryEntry(apiJar);
  if (addJdoSupport) {
    facetConfiguration.setRunEnhancerOnMake(true);
    facetConfiguration.getFilesToEnhance().addAll(AppEngineUtil.getDefaultSourceRootsToEnhance(rootModel));
    try {
      final VirtualFile[] sourceRoots=rootModel.getSourceRoots();
      final VirtualFile sourceRoot;
      if (sourceRoots.length > 0) {
        sourceRoot=sourceRoots[0];
      }
 else {
        sourceRoot=findOrCreateChildDirectory(rootModel.getContentRoots()[0],"src");
      }
      VirtualFile metaInf=findOrCreateChildDirectory(sourceRoot,"META-INF");
      createFileFromTemplate(AppEngineTemplateGroupDescriptorFactory.APP_ENGINE_JDO_CONFIG_TEMPLATE,metaInf,AppEngineUtil.JDO_CONFIG_XML_NAME);
    }
 catch (    IOException e) {
      LOG.error(e);
    }
    final Library library=addProjectLibrary(module,"AppEngine ORM",sdk.getOrmLibDirectoryPath(),sdk.getOrmLibSourcesDirectory());
    rootModel.addLibraryEntry(library);
    final JavaeePackagingConfiguration configuration=appEngineFacet.getWebFacet().getPackagingConfiguration();
    configuration.addLibraryLink(library);
    configuration.addLibraryLink(apiJar);
  }
}
