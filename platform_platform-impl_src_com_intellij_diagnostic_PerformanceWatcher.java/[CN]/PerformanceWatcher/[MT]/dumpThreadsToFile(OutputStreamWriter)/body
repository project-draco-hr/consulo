{
  boolean dumpSuccessful=false;
  if (myDumpAllThreadsMethod != null) {
    try {
      ThreadInfo[] threads=(ThreadInfo[])myDumpAllThreadsMethod.invoke(myThreadMXBean,false,false);
      for (      ThreadInfo info : threads) {
        if (info != null) {
          dumpThreadInfo(info,f);
        }
      }
      dumpSuccessful=true;
    }
 catch (    IllegalAccessException e) {
      e.printStackTrace();
    }
catch (    InvocationTargetException e) {
      e.printStackTrace();
    }
catch (    IOException e) {
      e.printStackTrace();
    }
  }
  if (!dumpSuccessful) {
    final long[] threadIds=myThreadMXBean.getAllThreadIds();
    final ThreadInfo[] threadInfo=myThreadMXBean.getThreadInfo(threadIds,Integer.MAX_VALUE);
    for (    ThreadInfo info : threadInfo) {
      if (info != null) {
        try {
          dumpThreadInfo(info,f);
        }
 catch (        IOException e) {
          e.printStackTrace();
        }
      }
    }
  }
}
