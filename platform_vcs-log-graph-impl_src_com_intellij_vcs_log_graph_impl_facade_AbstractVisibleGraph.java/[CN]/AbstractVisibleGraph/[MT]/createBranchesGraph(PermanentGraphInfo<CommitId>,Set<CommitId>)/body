{
  if (heads == null) {
    return new LinearGraphAsGraphWithHiddenNodes(permanentGraph.getPermanentLinearGraph());
  }
 else {
    Set<Integer> headIndexes=permanentGraph.getPermanentCommitsInfo().convertToCommitIndexes(heads);
    if (headIndexes.contains(-1))     throw new IllegalStateException();
    Flags visibleNodes=CurrentBranches.getVisibleNodes(permanentGraph.getPermanentLinearGraph(),headIndexes);
    return new LinearGraphAsGraphWithHiddenNodes(permanentGraph.getPermanentLinearGraph(),visibleNodes);
  }
}
