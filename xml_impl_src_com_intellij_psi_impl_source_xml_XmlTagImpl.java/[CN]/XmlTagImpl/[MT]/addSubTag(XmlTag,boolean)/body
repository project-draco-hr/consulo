{
  XmlTagChild[] children=getSubTags();
  if (children.length == 0) {
    children=getValue().getChildren();
  }
  if (children.length == 0) {
    return (XmlTag)add(subTag);
  }
 else   if (first) {
    return (XmlTag)addBefore(subTag,children[0]);
  }
 else {
    return (XmlTag)addAfter(subTag,ArrayUtil.getLastElement(children));
  }
}
