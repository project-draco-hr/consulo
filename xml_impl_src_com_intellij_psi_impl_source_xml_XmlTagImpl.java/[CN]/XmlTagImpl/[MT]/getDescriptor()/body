{
  final String namespace=getNamespace();
  XmlElementDescriptor elementDescriptor;
  final DomElement domElement=DomManager.getDomManager(getProject()).getDomElement(this);
  if (domElement != null) {
    if (parent instanceof XmlTag) {
      final XmlElementDescriptor descriptor=((XmlTag)parent).getDescriptor();
      if (descriptor != null) {
        elementDescriptor=descriptor.getElementDescriptor(this);
        return elementDescriptor;
      }
    }
 else {
      final DefinesXml definesXml=domElement.getAnnotation(DefinesXml.class);
      if (definesXml != null) {
        return new DomElementXmlDescriptor(domElement);
      }
    }
  }
  if (XmlUtil.EMPTY_URI.equals(namespace)) {
    final PsiElement parent=getParent();
    if (parent instanceof XmlTag) {
      final XmlElementDescriptor descriptor=((XmlTag)parent).getDescriptor();
      if (descriptor != null) {
        elementDescriptor=descriptor.getElementDescriptor(this);
        if (elementDescriptor != null && !(elementDescriptor instanceof AnyXmlElementDescriptor)) {
          return elementDescriptor;
        }
      }
    }
  }
  final XmlNSDescriptor nsDescriptor=getNSDescriptor(namespace,false);
  elementDescriptor=nsDescriptor == null ? null : nsDescriptor.getElementDescriptor(this);
  if (elementDescriptor == null) {
    elementDescriptor=XmlUtil.findXmlDescriptorByType(this);
  }
  return elementDescriptor;
}
