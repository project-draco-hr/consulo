{
  if (map == null)   map=new THashMap<String,CachedValue<XmlNSDescriptor>>();
  final ExternalResourceManagerEx externalResourceManager=ExternalResourceManagerEx.getInstanceEx();
  map.put(namespace,getManager().getCachedValuesManager().createCachedValue(new CachedValueProvider<XmlNSDescriptor>(){
    public Result<XmlNSDescriptor> compute(){
      XmlNSDescriptor descriptor=externalResourceManager.getImplicitNamespaceDescriptor(fileLocation);
      if (descriptor != null) {
        return new Result<XmlNSDescriptor>(descriptor,ArrayUtil.append(descriptor.getDependences(),XmlTagImpl.this));
      }
      XmlFile currentFile=retrieveFile(fileLocation,version);
      PsiMetaBaseOwner currentOwner=retrieveOwner(currentFile,namespace);
      if (currentOwner != null) {
        descriptor=(XmlNSDescriptor)currentOwner.getMetaData();
        if (descriptor != null) {
          return new Result<XmlNSDescriptor>(descriptor,descriptor.getDependences(),XmlTagImpl.this,ExternalResourceManager.getInstance());
        }
      }
      return new Result<XmlNSDescriptor>(null,XmlTagImpl.this,currentFile,ExternalResourceManager.getInstance());
    }
  }
,false));
  return map;
}
