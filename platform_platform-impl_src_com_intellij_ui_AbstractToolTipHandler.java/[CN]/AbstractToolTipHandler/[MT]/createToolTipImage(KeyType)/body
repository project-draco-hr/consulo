{
  Component rComponent;
  rComponent=getRendererComponent(key);
  if (!(rComponent instanceof JComponent)) {
    return null;
  }
  Rectangle cellBounds=getCellBounds(key,rComponent);
  if (cellBounds == null)   return null;
  Rectangle visibleRect=getVisibleRect(key);
  int width=cellBounds.x + cellBounds.width - (visibleRect.x + visibleRect.width);
  int height=cellBounds.height;
  if (width <= 0 || height <= 0)   return null;
  if (cellBounds.y < visibleRect.y)   return null;
  if (cellBounds.y + cellBounds.height > visibleRect.y + visibleRect.height)   return null;
  myImage=createImage(height,width);
  Graphics2D g=myImage.createGraphics();
  g.setClip(null);
  doFillBackground(height,width,g);
  g.translate(-(visibleRect.x + visibleRect.width - cellBounds.x),0);
  doPaintTooltipImage(rComponent,cellBounds,height,g,key);
  if (doPaintBorder(key)) {
    g.translate((visibleRect.x + visibleRect.width - cellBounds.x),0);
    g.setColor(Color.GRAY);
    int rightX=myImage.getWidth() - 1;
    final int h=myImage.getHeight();
    UIUtil.drawLine(g,0,0,rightX,0);
    UIUtil.drawLine(g,rightX,0,rightX,h);
    UIUtil.drawLine(g,0,h - 1,rightX,h - 1);
  }
  g.dispose();
  myComponent.remove(rComponent);
  return new Point(visibleRect.x + visibleRect.width,cellBounds.y);
}
