{
  if (TodoConfiguration.PROP_TODO_PATTERNS.equals(e.getPropertyName())) {
    myRebuildInProgress=true;
    ApplicationManager.getApplication().invokeLater(new Runnable(){
      public void run(){
        final ProgressWindow progressWindow=new ProgressWindow(false,null);
        progressWindow.setTitle("Looking for TODOs...");
        progressWindow.setText("Please wait...");
        final Runnable process=new Runnable(){
          public void run(){
            ApplicationManager.getApplication().runReadAction(new Runnable(){
              public void run(){
                PsiSearchHelper searchHelper=PsiManager.getInstance(myProject).getSearchHelper();
                searchHelper.findFilesWithTodoItems();
              }
            }
);
            ApplicationManager.getApplication().invokeLater(new Runnable(){
              public void run(){
                updateFilters();
                myRebuildInProgress=false;
              }
            }
,ModalityState.NON_MMODAL);
          }
        }
;
        Thread thread=new Thread(new Runnable(){
          public void run(){
            ProgressManager.getInstance().runProcess(process,progressWindow);
          }
        }
,"Todo finder");
        thread.start();
      }
    }
);
  }
 else   if (TodoConfiguration.PROP_TODO_FILTERS.equals(e.getPropertyName())) {
    if (!myRebuildInProgress) {
      updateFilters();
    }
  }
}
