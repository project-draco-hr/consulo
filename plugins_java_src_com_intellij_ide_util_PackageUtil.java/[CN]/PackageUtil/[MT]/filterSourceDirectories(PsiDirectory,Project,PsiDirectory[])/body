{
  final ProjectFileIndex fileIndex=ProjectRootManager.getInstance(project).getFileIndex();
  if (fileIndex.isInTestSourceContent(baseDir.getVirtualFile())) {
    List<PsiDirectory> result=new ArrayList<PsiDirectory>();
    for (    PsiDirectory moduleDirectory : moduleDirectories) {
      if (fileIndex.isInTestSourceContent(moduleDirectory.getVirtualFile())) {
        result.add(moduleDirectory);
      }
    }
    moduleDirectories=result.toArray(new PsiDirectory[result.size()]);
  }
  return moduleDirectories;
}
