{
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    public void run(){
      PsiClass psiClass=myJavaFacade.findClass("p.A");
      assertEquals("p.A",psiClass.getQualifiedName());
      assertTrue(psiClass.isValid());
      ModifiableRootModel rootModel=ModuleRootManager.getInstance(myModule).getModifiableModel();
      rootModel.getContentEntries()[0].addExcludeFolder(myPackDir);
      rootModel.commit();
      assertFalse(psiClass.isValid());
      rootModel=ModuleRootManager.getInstance(myModule).getModifiableModel();
      final ContentEntry content=rootModel.getContentEntries()[0];
      content.removeExcludeFolder(content.getExcludeFolders()[0]);
      rootModel.commit();
      psiClass=myJavaFacade.findClass("p.A");
      assertTrue(psiClass.isValid());
    }
  }
);
}
