{
  final DefaultComboBoxModel model=new DefaultComboBoxModel();
  createPredefinedScopeDescriptors(model);
  model.addElement(new ScopeSeparator("VCS Scopes"));
  final List<NamedScope> changeLists=ChangeListsScopesProvider.getInstance(myProject).getCustomScopes();
  for (  NamedScope changeListScope : changeLists) {
    final GlobalSearchScope scope=GlobalSearchScopes.filterScope(myProject,changeListScope);
    model.addElement(new ScopeDescriptor(scope));
  }
  final List<ScopeDescriptor> customScopes=new ArrayList<ScopeDescriptor>();
  final NamedScopesHolder[] holders=NamedScopesHolder.getAllNamedScopeHolders(myProject);
  for (  NamedScopesHolder holder : holders) {
    final NamedScope[] scopes=holder.getEditableScopes();
    for (    NamedScope scope : scopes) {
      final GlobalSearchScope searchScope=GlobalSearchScopes.filterScope(myProject,scope);
      customScopes.add(new ScopeDescriptor(searchScope));
    }
  }
  if (!customScopes.isEmpty()) {
    model.addElement(new ScopeSeparator("Custom Scopes"));
    for (    ScopeDescriptor scope : customScopes) {
      model.addElement(scope);
    }
  }
  return model;
}
