{
  final TreeNode[] pathToRoot=refElementNode.getPath();
  final HashSet<RefElement> newChildren=new HashSet<RefElement>();
  if (!refElement.isValid())   return newChildren;
  for (  RefElement refCallee : refElement.getOutReferences()) {
    if (((RefElementImpl)refCallee).isSuspicious()) {
      if (notInPath(pathToRoot,refCallee))       newChildren.add(refCallee);
    }
  }
  if (refElement instanceof RefMethod) {
    RefMethod refMethod=(RefMethod)refElement;
    if (!refMethod.isStatic() && !refMethod.isConstructor() && !refMethod.getOwnerClass().isAnonymous()) {
      for (      RefMethod refDerived : refMethod.getDerivedMethods()) {
        if (((RefMethodImpl)refDerived).isSuspicious()) {
          if (notInPath(pathToRoot,refDerived))           newChildren.add(refDerived);
        }
      }
    }
  }
 else   if (refElement instanceof RefClass) {
    RefClass refClass=(RefClass)refElement;
    for (    RefClass subClass : refClass.getSubClasses()) {
      if ((subClass.isInterface() || subClass.isAbstract()) && ((RefClassImpl)subClass).isSuspicious()) {
        if (notInPath(pathToRoot,subClass))         newChildren.add(subClass);
      }
    }
    if (refClass.getDefaultConstructor() instanceof RefImplicitConstructor) {
      Set<RefElement> fromConstructor=getPossibleChildren(refElementNode,refClass.getDefaultConstructor());
      newChildren.addAll(fromConstructor);
    }
  }
  return newChildren;
}
