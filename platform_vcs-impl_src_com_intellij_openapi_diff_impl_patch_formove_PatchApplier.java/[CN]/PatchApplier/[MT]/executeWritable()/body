{
  if (!makeWritable(myVerifier.getWritableFiles())) {
    return ApplyPatchStatus.FAILURE;
  }
  final List<Pair<VirtualFile,ApplyTextFilePatch>> textPatches=myVerifier.getTextPatches();
  if (!fileTypesAreOk(textPatches)) {
    return ApplyPatchStatus.FAILURE;
  }
  try {
    markInternalOperation(textPatches,true);
    final ApplyPatchStatus status=actualApply(myVerifier,myCommitContext);
    return status;
  }
  finally {
    markInternalOperation(textPatches,false);
  }
}
