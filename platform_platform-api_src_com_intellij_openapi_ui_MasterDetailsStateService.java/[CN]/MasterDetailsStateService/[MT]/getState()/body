{
  myStates.getStates().clear();
  for (  Map.Entry<String,MasterDetailsComponent> entry : myComponents.entrySet()) {
    final Element element=XmlSerializer.serialize(entry.getValue().getState(),mySerializationFilter);
    if (element != null) {
      final ComponentState state=new ComponentState();
      state.myKey=entry.getKey();
      state.mySettings=element;
      myStates.getStates().add(state);
    }
  }
  Collections.sort(myStates.getStates(),new Comparator<ComponentState>(){
    @Override public int compare(    ComponentState o1,    ComponentState o2){
      return o1.myKey.compareTo(o2.myKey);
    }
  }
);
  return myStates;
}
