{
  if (skipWhiteSpaces && root instanceof PsiWhiteSpace)   return;
  StringUtil.repeatSymbol(buffer,' ',indent);
  if (root instanceof CompositeElement) {
    buffer.append(root);
  }
 else {
    String text=root.getText();
    text=StringUtil.replace(text,"\n","\\n");
    text=StringUtil.replace(text,"\r","\\r");
    text=StringUtil.replace(text,"\t","\\t");
    buffer.append(root.toString()).append("('").append(text).append("')");
  }
  buffer.append(((UserDataHolderBase)root).getUserDataString());
  buffer.append("\n");
  PsiElement[] children=root.getChildren();
  for (  PsiElement child : children) {
    treeToBufferWithUserData(buffer,child,indent + 2,skipWhiteSpaces);
  }
  if (children.length == 0) {
    StringUtil.repeatSymbol(buffer,' ',indent + 2);
    buffer.append("<empty list>\n");
  }
}
