{
  PsiFile psiFile=createFile("X.java","public class X{} //iuggjhfg");
  Usage[] usages=new Usage[100];
  for (int i=0; i < usages.length; i++) {
    usages[i]=createUsage(psiFile,i);
  }
  UsageView usageView=UsageViewManager.getInstance(getProject()).createUsageView(UsageTarget.EMPTY_ARRAY,usages,new UsageViewPresentation(),null);
  Disposer.register(getTestRootDisposable(),usageView);
  ((EncodingManagerImpl)EncodingManager.getInstance()).clearDocumentQueue();
  FileDocumentManager.getInstance().saveAllDocuments();
  UIUtil.dispatchAllInvocationEvents();
  LeakHunter.checkLeak(usageView,PsiFileImpl.class);
  LeakHunter.checkLeak(usageView,Document.class);
}
