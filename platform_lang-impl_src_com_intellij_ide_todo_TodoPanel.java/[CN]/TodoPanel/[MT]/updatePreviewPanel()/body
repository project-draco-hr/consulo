{
  if (myProject.isDisposed())   return;
  List<UsageInfo> infos=new ArrayList<UsageInfo>();
  final TreePath path=myTree.getSelectionPath();
  if (path != null) {
    DefaultMutableTreeNode node=(DefaultMutableTreeNode)path.getLastPathComponent();
    Object userObject=node.getUserObject();
    if (userObject instanceof NodeDescriptor) {
      Object element=((NodeDescriptor)userObject).getElement();
      TodoItemNode pointer=myTodoTreeBuilder.getFirstPointerForElement(element);
      if (pointer != null) {
        final SmartTodoItemPointer value=pointer.getValue();
        final Document document=value.getDocument();
        final PsiFile psiFile=PsiDocumentManager.getInstance(myProject).getPsiFile(document);
        final RangeMarker rangeMarker=value.getRangeMarker();
        if (psiFile != null) {
          infos.add(new UsageInfo(psiFile,rangeMarker.getStartOffset(),rangeMarker.getEndOffset()));
        }
      }
    }
  }
  myUsagePreviewPanel.updateLayout(infos.isEmpty() ? null : infos);
}
