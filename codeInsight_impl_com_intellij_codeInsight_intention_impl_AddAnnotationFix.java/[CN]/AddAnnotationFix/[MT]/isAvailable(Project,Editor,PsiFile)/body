{
  if (myModifierListOwner != null) {
    return myModifierListOwner.isValid() && PsiManager.getInstance(project).isInProject(myModifierListOwner) && myModifierListOwner.getModifierList() != null;
  }
  if (!file.getManager().isInProject(file)) {
    final PsiElement element=file.findElementAt(editor.getCaretModel().getOffset());
    if (element != null) {
      final PsiElement parent=element.getParent();
      PsiModifierListOwner owner=null;
      if (parent instanceof PsiMethod || parent instanceof PsiField || parent instanceof PsiParameter) {
        owner=(PsiModifierListOwner)parent;
      }
      return owner != null && !AnnotationUtil.isAnnotated(owner,myFQN,false);
    }
  }
  return false;
}
