{
  StringBuilder text=new StringBuilder("String s = \"xxx\"");
  final int N=2;
  for (int i=0; i < N; i++) {
    text.append("+\"xxx\"");
  }
  text.append(";");
  final PsiElement expression=JavaPsiFacade.getInstance(getProject()).getElementFactory().createStatementFromText(text.toString(),null);
  final int[] n={0};
  IdeaTestUtil.assertTiming("",20,new Runnable(){
    @Override public void run(){
      n[0]=0;
      expression.accept(new JavaRecursiveElementWalkingVisitor(){
        @Override public void visitBinaryExpression(        final PsiBinaryExpression expression){
          PsiExpression s=expression.getLOperand();
          super.visitBinaryExpression(expression);
          s.hashCode();
          n[0]++;
        }
      }
);
      assertEquals(N,n[0]);
    }
  }
);
}
