{
  VcsLogUi ui=e.getData(VcsLogDataKeys.VCS_LOG_UI);
  if (ui != null && ui.areGraphActionsEnabled()) {
    e.getPresentation().setEnabled(true);
    if (!ui.getFilterUi().getFilters().getDetailsFilters().isEmpty()) {
      e.getPresentation().setEnabled(false);
    }
    if (ui.getBekType() == PermanentGraph.SortType.LinearBek) {
      e.getPresentation().setText(getPrefix() + MERGES);
      e.getPresentation().setDescription(getPrefix() + MERGES_DESCRIPTION);
    }
 else {
      e.getPresentation().setText(getPrefix() + LINEAR_BRANCHES);
      e.getPresentation().setDescription(getPrefix() + LINEAR_BRANCHES_DESCRIPTION);
    }
  }
 else {
    e.getPresentation().setEnabled(false);
  }
  e.getPresentation().setText(getPrefix() + LINEAR_BRANCHES);
  e.getPresentation().setDescription(getPrefix() + LINEAR_BRANCHES_DESCRIPTION);
  if (isIconHidden(e)) {
    e.getPresentation().setIcon(null);
  }
 else {
    e.getPresentation().setIcon(ui != null && ui.getBekType() == PermanentGraph.SortType.LinearBek ? getMergesIcon() : getBranchesIcon());
  }
}
