{
  final Change change=ChangeListManager.getInstance(myProject).getChange(file);
  if (change != null) {
    final ContentRevision beforeRevision=change.getBeforeRevision();
    if (beforeRevision != null) {
      final String content=beforeRevision.getContent();
      if (content == null)       myHaveEmptyContentRevisions=true;
      return content;
    }
    return null;
  }
  final Document document=FileDocumentManager.getInstance().getCachedDocument(file);
  if (document != null && document.getModificationStamp() != file.getModificationStamp()) {
    return ApplicationManager.getApplication().runReadAction(new Computable<String>(){
      public String compute(){
        return LoadTextUtil.loadText(file).toString();
      }
    }
);
  }
  return null;
}
