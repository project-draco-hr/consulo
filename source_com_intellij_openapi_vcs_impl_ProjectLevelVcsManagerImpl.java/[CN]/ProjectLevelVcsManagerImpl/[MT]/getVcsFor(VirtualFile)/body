{
  if (file == null)   return null;
  if (myProject.isDisposed())   return null;
  if (!(file.getFileSystem() instanceof LocalFileSystem)) {
    return null;
  }
  for (int i=myDirectoryMappings.size() - 1; i >= 0; i--) {
    final VcsDirectoryMapping mapping=myDirectoryMappings.get(i);
    if (fileMatchesMapping(file,mapping)) {
      final String vcs=mapping.getVcs();
      if (vcs.length() == 0) {
        return null;
      }
      return findVcsByName(vcs);
    }
  }
  return null;
}
