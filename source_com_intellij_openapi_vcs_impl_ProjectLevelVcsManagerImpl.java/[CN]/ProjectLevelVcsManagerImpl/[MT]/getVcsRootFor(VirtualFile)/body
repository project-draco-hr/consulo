{
  VcsDirectoryMapping mapping=myDirectoryMappingList.getMappingFor(file);
  if (mapping == null) {
    return null;
  }
  final String directory=mapping.getDirectory();
  if (directory.length() == 0) {
    final VirtualFile baseDir=myProject.getBaseDir();
    if (baseDir != null && VfsUtil.isAncestor(baseDir,file,false)) {
      return baseDir;
    }
    final VirtualFile contentRoot=ProjectRootManager.getInstance(myProject).getFileIndex().getContentRootForFile(file);
    if (contentRoot != null) {
      return contentRoot;
    }
    return null;
  }
  return LocalFileSystem.getInstance().findFileByPath(directory);
}
