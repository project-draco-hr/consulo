{
  if (exprText == null)   return null;
  if (psiVariable == null || !psiVariable.isValid())   return null;
  final PsiElement refVariableElement=containingFile.findElementAt(marker.getStartOffset());
  final PsiExpression expression=PsiTreeUtil.getParentOfType(refVariableElement,PsiReferenceExpression.class);
  if (expression instanceof PsiReferenceExpression && (((PsiReferenceExpression)expression).resolve() == psiVariable || Comparing.strEqual(psiVariable.getName(),((PsiReferenceExpression)expression).getReferenceName()))) {
    return (PsiExpression)expression.replace(elementFactory.createExpressionFromText(exprText,psiVariable));
  }
  return null;
}
