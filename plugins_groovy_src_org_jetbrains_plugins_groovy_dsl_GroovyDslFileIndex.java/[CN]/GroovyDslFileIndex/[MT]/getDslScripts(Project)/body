{
  return CachedValuesManager.getManager(project).getCachedValue(project,SCRIPTS_CACHE,new CachedValueProvider<List<GroovyDslScript>>(){
    @Override public Result<List<GroovyDslScript>> compute(){
      if (stopGdsl) {
        return Result.create(Collections.<GroovyDslScript>emptyList());
      }
      int count=0;
      List<GroovyDslScript> result=new ArrayList<GroovyDslScript>();
      for (      Pair<File,GroovyDslExecutor> pair : getStandardScripts()) {
        result.add(new GroovyDslScript(project,null,pair.second,pair.first.getPath()));
      }
      if (stopGdsl) {
        return Result.create(Collections.<GroovyDslScript>emptyList());
      }
      final LinkedBlockingQueue<Pair<VirtualFile,GroovyDslExecutor>> queue=new LinkedBlockingQueue<Pair<VirtualFile,GroovyDslExecutor>>();
      final ProjectFileIndex fileIndex=ProjectRootManager.getInstance(project).getFileIndex();
      for (      VirtualFile vfile : FileBasedIndex.getInstance().getContainingFiles(NAME,OUR_KEY,GlobalSearchScope.allScope(project))) {
        if (!vfile.isValid()) {
          continue;
        }
        if (!fileIndex.isInLibraryClasses(vfile) && !fileIndex.isInLibrarySource(vfile)) {
          if (!fileIndex.isInSourceContent(vfile) || !isActivated(vfile)) {
            continue;
          }
        }
        final long stamp=vfile.getModificationStamp();
        final GroovyDslExecutor cached=getCachedExecutor(vfile,stamp);
        if (cached == null) {
          scheduleParsing(queue,project,vfile,stamp,LoadTextUtil.loadText(vfile).toString());
          count++;
        }
 else {
          result.add(new GroovyDslScript(project,vfile,cached,vfile.getPath()));
        }
      }
      try {
        while (count > 0 && !stopGdsl) {
          ProgressManager.checkCanceled();
          final Pair<VirtualFile,GroovyDslExecutor> pair=queue.poll(20,TimeUnit.MILLISECONDS);
          if (pair != null) {
            count--;
            if (pair.second != null) {
              result.add(new GroovyDslScript(project,pair.first,pair.second,pair.first.getPath()));
            }
          }
        }
      }
 catch (      InterruptedException e) {
        LOG.error(e);
      }
      return Result.create(result,PsiModificationTracker.MODIFICATION_COUNT,ProjectRootManager.getInstance(project));
    }
  }
,false);
}
