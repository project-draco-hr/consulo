{
  PsiDocumentManager.getInstance(myProject).commitAllDocuments();
  boolean hadFocus=myStructureView != null && IJSwingUtilities.hasFocus2(myStructureView.getComponent());
  if (myStructureView != null) {
    myStructureView.dispose();
    myStructureView=null;
  }
  myPanel.removeAll();
  if (!isStructureViewShowing()) {
    return;
  }
  if (myFileEditor != null && myFileEditor.isValid()) {
    final StructureViewBuilder structureViewBuilder=myFileEditor.getStructureViewBuilder();
    if (structureViewBuilder != null) {
      StructureViewModel structureViewModel=structureViewBuilder.getStructureViewModel();
      myStructureView=new StructureViewComponent(myFileEditor,structureViewModel,myProject);
      myPanel.add(myStructureView.getComponent(),BorderLayout.CENTER);
      if (hadFocus) {
        IdeFocusTraversalPolicy.getPreferredFocusedComponent(myStructureView.getComponent()).requestFocus();
      }
      myStructureView.centerSelectedRow();
    }
  }
  if (myStructureView == null) {
    myPanel.add(new JLabel("Nothing to show in the Structure View",JLabel.CENTER),BorderLayout.CENTER);
  }
  myPanel.validate();
  myPanel.repaint();
}
