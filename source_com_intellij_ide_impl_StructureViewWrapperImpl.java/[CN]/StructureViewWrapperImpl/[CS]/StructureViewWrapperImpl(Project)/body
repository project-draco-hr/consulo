{
  myProject=project;
  myPanel=new JPanel(new BorderLayout());
  myPanel.setBackground(UIManager.getColor("Tree.textBackground"));
  myAlarm=new Alarm();
  getComponent().addHierarchyListener(new HierarchyListener(){
    public void hierarchyChanged(    HierarchyEvent e){
      if ((e.getChangeFlags() & HierarchyEvent.DISPLAYABILITY_CHANGED) != 0) {
        rebuild();
      }
    }
  }
);
  myEditorManagerListener=new FileEditorManagerAdapter(){
    public void selectionChanged(    final FileEditorManagerEvent event){
      final FileEditor newEditor=event.getNewEditor();
      PsiDocumentManager.getInstance(myProject).commitAllDocuments();
      final PsiManager psiManager=PsiManager.getInstance(myProject);
      myAlarm.cancelAllRequests();
      myAlarm.addRequest(new Runnable(){
        public void run(){
          if (psiManager.isDisposed()) {
            return;
          }
          setFileEditor(newEditor);
        }
      }
,400);
    }
  }
;
  FileEditorManager.getInstance(project).addFileEditorManagerListener(myEditorManagerListener);
  myFileTypeListener=new FileTypeListener(){
    public void beforeFileTypesChanged(    FileTypeEvent event){
    }
    public void fileTypesChanged(    FileTypeEvent event){
    }
  }
;
  FileTypeManager.getInstance().addFileTypeListener(myFileTypeListener);
}
