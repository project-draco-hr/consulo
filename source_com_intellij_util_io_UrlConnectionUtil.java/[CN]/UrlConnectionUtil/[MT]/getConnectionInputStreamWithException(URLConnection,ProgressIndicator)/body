{
  InputStreamGetter getter=new InputStreamGetter(connection);
  final Thread thread=new Thread(getter,"InputStreamGetter");
  thread.start();
  while (true) {
    pi.checkCanceled();
    try {
      thread.join(50);
      pi.setFraction(System.currentTimeMillis());
      if (!thread.isAlive())       break;
    }
 catch (    InterruptedException e) {
      throw new ProcessCanceledException();
    }
  }
  if (getter.getException() != null) {
    throw getter.getException();
  }
  return getter.getInputStream();
}
