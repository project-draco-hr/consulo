{
  int offset=Integer.MAX_VALUE;
  LiveOccurrence firstOccurrence=null;
  LiveOccurrence firstVisibleOccurrence=null;
  for (  LiveOccurrence o : mySearchResults) {
    if (insideVisibleArea(myEditor,o.getPrimaryRange())) {
      if (firstVisibleOccurrence == null || o.getPrimaryRange().getStartOffset() < firstVisibleOccurrence.getPrimaryRange().getStartOffset()) {
        firstVisibleOccurrence=o;
      }
    }
    if (o.getPrimaryRange().getStartOffset() < offset) {
      offset=o.getPrimaryRange().getStartOffset();
      firstOccurrence=o;
    }
  }
  return firstVisibleOccurrence != null ? firstVisibleOccurrence : firstOccurrence;
}
