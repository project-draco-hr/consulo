{
  Set<Character> commonIndex=null;
  Set<Character> lastIndex=null;
  Collection<Set<Character>> indexes=dictionaries.values();
  for (  Set<Character> index : indexes) {
    if (isEntireWordAllowed(word,index)) {
      if (lastIndex != null && commonIndex == null) {
        commonIndex=new HashSet<Character>(lastIndex.size() + index.size());
        commonIndex.addAll(lastIndex);
        lastIndex=commonIndex;
      }
      if (commonIndex != null) {
        commonIndex.addAll(index);
      }
 else {
        lastIndex=index;
      }
    }
  }
  return lastIndex;
}
