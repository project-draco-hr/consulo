{
  bounds.clear();
  for (int i=0; i < getComponentCount(); i++) {
    bounds.add(new Rectangle());
  }
  if (myLayoutPolicy == NOWRAP_LAYOUT_POLICY) {
    calculateBoundsNowrapImpl(bounds);
  }
 else   if (myLayoutPolicy == WRAP_LAYOUT_POLICY) {
    calculateBoundsWrapImpl(size2Fit,bounds);
  }
 else   if (myLayoutPolicy == AUTO_LAYOUT_POLICY) {
    calculateBoundsAutoImp(size2Fit,bounds);
  }
 else {
    throw new IllegalStateException("unknown layoutPolicy: " + myLayoutPolicy);
  }
  if (getComponentCount() > 0 && size2Fit.width < Integer.MAX_VALUE) {
    int maxHeight=0;
    for (int i=0; i < bounds.size() - 2; i++) {
      maxHeight=Math.max(maxHeight,bounds.get(i).height);
    }
    for (int i=getComponentCount() - 1, j=1; i > 0; i--, j++) {
      final Component component=getComponent(i);
      if (component instanceof JComponent && ((JComponent)component).getClientProperty(RIGHT_ALIGN_KEY) == Boolean.TRUE) {
        bounds.set(bounds.size() - j,new Rectangle(size2Fit.width - j * JBUI.scale(25),0,JBUI.scale(25),maxHeight));
      }
    }
  }
}
