{
  AntElement temp=element;
  while (temp != null) {
    final PsiElement property=temp.getProperty(name);
    if (property != null) {
      return property;
    }
    temp=temp.getAntParent();
  }
  final AntElement anchor=AntPsiUtil.getSubProjectElement(element);
  for (  PsiElement child : element.getAntProject().getChildren()) {
    if (child == anchor) {
      break;
    }
 else     if (child instanceof AntProperty) {
      AntProperty prop=(AntProperty)child;
      final PropertiesFile propFile=prop.getPropertiesFile();
      if (propFile != null) {
        String prefix=prop.getPrefix();
        if (prefix != null && !prefix.endsWith(".")) {
          prefix+='.';
        }
        final String key=(prefix == null) ? name : prefix + name;
        final Property property=propFile.findPropertyByKey(key);
        if (property != null) {
          return property;
        }
      }
    }
  }
  for (  AntFile file : AntPsiUtil.getImportedFiles(element.getAntProject(),anchor)) {
    final AntProject importedProject=file.getAntProject();
    importedProject.getChildren();
    final AntProperty property=importedProject.getProperty(name);
    if (property != null) {
      return property;
    }
  }
  return null;
}
