{
  final PsiJavaPackage[] packages=new PsiJavaPackage[packageNames.length];
  for (int i=0; i < packages.length; i++) {
    String packageName=packageNames[i];
    packages[i]=JavaPsiFacade.getInstance(myPsiManager.getProject()).findPackage(packageName);
    assertNotNull("Package " + packageName + " not found",packages[i]);
  }
  PsiJavaPackage newParentPackage=JavaPsiFacade.getInstance(myPsiManager.getProject()).findPackage(newPackageName);
  assertNotNull(newParentPackage);
  final PsiDirectory[] dirs=newParentPackage.getDirectories();
  assertEquals(dirs.length,1);
  new MoveClassesOrPackagesProcessor(myProject,packages,new SingleSourceRootMoveDestination(PackageWrapper.create(newParentPackage),dirs[0]),true,false,null).run();
  FileDocumentManager.getInstance().saveAllDocuments();
}
