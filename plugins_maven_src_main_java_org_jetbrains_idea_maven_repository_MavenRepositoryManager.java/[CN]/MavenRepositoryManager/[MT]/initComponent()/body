{
  StartupManager.getInstance(myProject).registerStartupActivity(new Runnable(){
    public void run(){
      try {
        if (ApplicationManager.getApplication().isUnitTestMode())         return;
        if (!MavenProjectsManager.getInstance(myProject).isMavenProject())         return;
        File baseDir=new File(PathManager.getSystemPath(),"Maven");
        File projectIndecesDir=new File(baseDir,myProject.getLocationHash());
        myEmbedder=MavenFactory.createEmbedderForExecute(MavenCore.getInstance(myProject).getState());
        myIndex=new MavenRepositoryIndex(myEmbedder,projectIndecesDir);
        StartupManager.getInstance(myProject).registerPostStartupActivity(new Runnable(){
          public void run(){
            try {
              addAndUpdateLocalRepository();
            }
 catch (            MavenRepositoryException e) {
              throw new RuntimeException(e);
            }
          }
        }
);
      }
 catch (      MavenException e) {
        throw new RuntimeException(e);
      }
catch (      MavenRepositoryException e) {
        throw new RuntimeException(e);
      }
    }
  }
);
}
