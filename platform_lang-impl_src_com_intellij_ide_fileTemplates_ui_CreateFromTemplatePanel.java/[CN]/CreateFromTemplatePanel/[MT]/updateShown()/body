{
  final Insets insets=new Insets(2,4,4,2);
  if (myMustEnterName || Arrays.asList(myUnsetAttributes).contains(FileTemplate.ATTRIBUTE_NAME)) {
    final JLabel filenameLabel=new JLabel(IdeBundle.message("label.file.name"));
    myAttrPanel.add(filenameLabel,new GridBagConstraints(0,1,1,1,0.0,0.0,GridBagConstraints.WEST,GridBagConstraints.NONE,insets,0,0));
    myFilenameField=new JTextField(20);
    if (myAttributesDefaults != null) {
      final String fileName=myAttributesDefaults.getDefaultFileName();
      if (fileName != null) {
        myFilenameField.setText(fileName);
        final TextRange selectionRange;
        if (myAttributesDefaults.getDefaultFileNameSelection() != null) {
          selectionRange=myAttributesDefaults.getDefaultFileNameSelection();
        }
 else {
          final int dot=fileName.indexOf('.');
          if (dot > 0) {
            selectionRange=new TextRange(0,dot);
          }
 else {
            selectionRange=null;
          }
        }
        if (selectionRange != null) {
          setPredefinedSelectionFor(myFilenameField,selectionRange);
        }
      }
    }
    myAttrPanel.add(myFilenameField,new GridBagConstraints(1,1,1,1,1.0,0.0,GridBagConstraints.WEST,GridBagConstraints.HORIZONTAL,insets,0,0));
  }
  myLastRow=2;
  for (  String attribute : myUnsetAttributes) {
    if (attribute.equals(FileTemplate.ATTRIBUTE_NAME)) {
      continue;
    }
    final JLabel label=new JLabel(attribute.replace('_',' ') + ":");
    final JTextField field=new JTextField();
    field.setColumns(30);
    if (myAttributesDefaults != null) {
      final String defaultValue=myAttributesDefaults.getDefaultValueFor(attribute);
      final TextRange selectionRange=myAttributesDefaults.getRangeFor(attribute);
      if (defaultValue != null) {
        field.setText(defaultValue);
        if (selectionRange != null) {
          setPredefinedSelectionFor(field,selectionRange);
        }
      }
    }
    myAttributes.add(new Pair<String,JTextField>(attribute,field));
    myAttrPanel.add(label,new GridBagConstraints(0,myLastRow,1,1,0.0,0.0,GridBagConstraints.WEST,GridBagConstraints.NONE,insets,0,0));
    myAttrPanel.add(field,new GridBagConstraints(1,myLastRow,1,1,1.0,0.0,GridBagConstraints.WEST,GridBagConstraints.HORIZONTAL,insets,0,0));
    myLastRow++;
  }
  myAttrPanel.repaint();
  myAttrPanel.revalidate();
  myMainPanel.revalidate();
}
