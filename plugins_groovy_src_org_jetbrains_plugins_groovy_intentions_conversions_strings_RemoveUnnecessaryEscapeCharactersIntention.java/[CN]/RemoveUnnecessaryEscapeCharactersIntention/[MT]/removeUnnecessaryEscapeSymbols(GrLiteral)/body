{
  final String text=literal.getText();
  final String quote=getStartQuote(text);
  final String value=removeQuotes(text);
  final StringBuilder buffer=new StringBuilder();
  buffer.append(quote);
  if (quote == "'") {
    escapeAndUnescapeSymbols(value,"","\"$",buffer);
  }
 else   if (quote == "'''") {
    int position=buffer.length();
    escapeAndUnescapeSymbols(value,"","\"'$n",buffer);
    fixAllTripleQuotes(buffer,position);
  }
 else   if (quote == "\"") {
    if (literal instanceof GrString) {
      final ASTNode node=literal.getNode();
      for (ASTNode child=node.getFirstChildNode(); child != null; child=child.getTreeNext()) {
        final IElementType type=child.getElementType();
        if (type == GroovyTokenTypes.mGSTRING_BEGIN || type == GroovyTokenTypes.mGSTRING_END)         continue;
        if (type == GroovyElementTypes.GSTRING_INJECTION) {
          buffer.append(child.getText());
        }
 else {
          escapeAndUnescapeSymbols(child.getText(),"","'",buffer);
        }
      }
    }
 else {
      escapeAndUnescapeSymbols(value,"","'",buffer);
    }
  }
 else   if (quote == "\"\"\"") {
    if (literal instanceof GrString) {
      final ASTNode node=literal.getNode();
      for (ASTNode child=node.getFirstChildNode(); child != null; child=child.getTreeNext()) {
        final IElementType type=child.getElementType();
        if (type == GroovyTokenTypes.mGSTRING_BEGIN || type == GroovyTokenTypes.mGSTRING_END)         continue;
        if (type == GroovyElementTypes.GSTRING_INJECTION) {
          buffer.append(child.getText());
        }
 else {
          final int position=buffer.length();
          escapeAndUnescapeSymbols(value,"","\"'n",buffer);
          fixAllTripleDoubleQuotes(buffer,position);
        }
      }
    }
 else {
      final int position=buffer.length();
      escapeAndUnescapeSymbols(value,"","\"'n",buffer);
      fixAllTripleDoubleQuotes(buffer,position);
    }
  }
 else {
    return text;
  }
  buffer.append(quote);
  return buffer.toString();
}
