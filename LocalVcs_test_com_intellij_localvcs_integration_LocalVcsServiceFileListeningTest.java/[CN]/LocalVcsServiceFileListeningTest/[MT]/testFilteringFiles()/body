{
  vcs=createMock(LocalVcs.class);
  expect(vcs.getRoots()).andReturn(Collections.<Entry>emptyList());
  vcs.apply();
  replay(vcs);
  initAndStartup(vcs);
  reset(vcs);
  expect(vcs.hasEntry((String)anyObject())).andStubReturn(false);
  replay(vcs);
  VirtualFile f=new TestVirtualFile("file",null,null);
  fileFilter.setFilesNotUnderContentRoot(f);
  fileManager.fireFileCreated(f);
  fileManager.fireContentChanged(f);
  fileManager.firePropertyChanged(f,VirtualFile.PROP_NAME,"oldName");
  fileManager.fireFileMoved(f,f,f);
  fileManager.fireFileDeletion(f);
  verify(vcs);
}
