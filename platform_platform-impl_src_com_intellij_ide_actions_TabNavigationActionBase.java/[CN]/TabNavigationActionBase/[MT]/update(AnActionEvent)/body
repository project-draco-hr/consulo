{
  Presentation presentation=event.getPresentation();
  DataContext dataContext=event.getDataContext();
  Project project=PlatformDataKeys.PROJECT.getData(dataContext);
  presentation.setEnabled(false);
  if (project == null) {
    return;
  }
  final ToolWindowManager windowManager=ToolWindowManager.getInstance(project);
  if (windowManager.isEditorComponentActive()) {
    final FileEditorManagerEx editorManager=FileEditorManagerEx.getInstanceEx(project);
    EditorWindow currentWindow=EditorWindow.DATA_KEY.getData(dataContext);
    if (currentWindow == null) {
      editorManager.getCurrentWindow();
    }
    if (currentWindow != null) {
      final VirtualFile[] files=currentWindow.getFiles();
      presentation.setEnabled(files.length > 1);
    }
    return;
  }
  ContentManager contentManager=PlatformDataKeys.NONEMPTY_CONTENT_MANAGER.getData(dataContext);
  presentation.setEnabled(contentManager != null && contentManager.getContentCount() > 1 && contentManager.isSingleSelection());
}
