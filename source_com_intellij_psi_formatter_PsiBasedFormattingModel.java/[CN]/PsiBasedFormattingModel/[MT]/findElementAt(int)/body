{
  if (myASTNode.getElementType() == ElementType.JSPX_FILE) {
    final PsiFile[] psiRoots=((JspxFileImpl)SourceTreeToPsiMap.treeElementToPsi(myASTNode)).getPsiRoots();
    for (int i=0; i < psiRoots.length; i++) {
      PsiFile psiRoot=psiRoots[i];
      final PsiElement found=psiRoot.findElementAt(offset);
      if (found != null && found.getTextRange().getStartOffset() == offset)       return SourceTreeToPsiMap.psiElementToTree(found);
    }
  }
  return myASTNode.findLeafElementAt(offset);
}
