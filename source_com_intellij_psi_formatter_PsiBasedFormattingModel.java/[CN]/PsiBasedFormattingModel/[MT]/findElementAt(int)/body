{
  final PsiElement[] psiRoots=myASTNode.getPsi().getContainingFile().getPsiRoots();
  for (int i=0; i < psiRoots.length; i++) {
    PsiElement psiRoot=psiRoots[i];
    final ASTNode found=psiRoot.getNode().findLeafElementAt(offset);
    if (found != null) {
      if (!(found.getPsi() instanceof JspText) && found.getTextRange().getStartOffset() == offset) {
        return found;
      }
    }
  }
  return myASTNode.findLeafElementAt(offset);
}
