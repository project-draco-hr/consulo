{
  final ASTNode leafElement=myASTNode.findLeafElementAt(textRange.getEndOffset());
  if (leafElement.getTextRange().getStartOffset() < textRange.getStartOffset()) {
    new Helper(StdFileTypes.JAVA,myProject).shiftIndentInside(leafElement,whiteSpace.length());
  }
 else {
    FormatterUtil.replaceWhiteSpace(whiteSpace,leafElement,ElementType.WHITE_SPACE);
    if (leafElement.textContains('\n') && whiteSpace.indexOf('\n') >= 0) {
      try {
        int lastLineIndent=getLastLineIndent(leafElement.getText());
        new Helper(StdFileTypes.JAVA,myProject).shiftIndentInside(leafElement,whiteSpace.length() - lastLineIndent);
      }
 catch (      IOException e) {
        throw new RuntimeException(e);
      }
    }
  }
}
