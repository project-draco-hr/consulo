{
  final PsiElement[] elements=new PsiElement[classNames.length + 1];
  for (int i=0; i < classNames.length; i++) {
    String className=classNames[i];
    elements[i]=myJavaFacade.findClass(className,GlobalSearchScope.projectScope(getProject()));
    assertNotNull("Class " + className + " not found",elements[i]);
  }
  elements[classNames.length]=elements[0].getContainingFile().getContainingDirectory().findFile(fileName);
  PsiJavaPackage aPackage=JavaPsiFacade.getInstance(myPsiManager.getProject()).findPackage(newPackageName);
  assertNotNull("Package " + newPackageName + " not found",aPackage);
  final PsiDirectory[] dirs=aPackage.getDirectories();
  assertEquals(dirs.length,1);
  new JavaMoveFilesOrDirectoriesHandler().doMove(getProject(),elements,dirs[0],null);
  PsiDocumentManager.getInstance(myProject).commitAllDocuments();
  FileDocumentManager.getInstance().saveAllDocuments();
}
