{
  final VirtualFile sourceRoot=selectedTarget.getVirtualFile();
  for (  PsiDirectory directory : directories) {
    final PsiJavaPackage parentPackage=JavaDirectoryService.getInstance().getPackage(directory).getParentPackage();
    final PackageWrapper wrapper=new PackageWrapper(parentPackage);
    final PsiDirectory moveTarget=RefactoringUtil.createPackageDirectoryInSourceRoot(wrapper,sourceRoot);
    MoveClassesOrPackagesUtil.moveDirectoryRecursively(directory,moveTarget);
  }
}
