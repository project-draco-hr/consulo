{
  final List<PatchHunk> hunks=patch.getHunks();
  if (hunks.isEmpty()) {
    return ApplyPatchStatus.SUCCESS;
  }
  List<String> lines=new ArrayList<String>();
  Collections.addAll(lines,LineTokenizer.tokenize(text,false));
  ApplyPatchStatus result=null;
  for (  PatchHunk hunk : hunks) {
    result=ApplyPatchStatus.and(result,new ApplyPatchHunk(hunk).apply(lines));
  }
  for (int i=0; i < lines.size(); i++) {
    newText.append(lines.get(i));
    if (i < lines.size() - 1 || !hunks.get(hunks.size() - 1).isNoNewLineAtEnd()) {
      newText.append("\n");
    }
  }
  return result;
}
