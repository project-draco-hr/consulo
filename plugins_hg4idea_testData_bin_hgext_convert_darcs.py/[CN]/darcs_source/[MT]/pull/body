def pull(self, rev):
    (output, status) = self.run('pull', self.path, all=True, match=('hash %s' % rev), no_test=True, no_posthook=True, external_merge='/bin/false', repodir=self.tmppath)
    if status:
        if (output.find('We have conflicts in') == (-1)):
            self.checkexit(status, output)
        (output, status) = self.run('revert', all=True, repodir=self.tmppath)
        self.checkexit(status, output)
