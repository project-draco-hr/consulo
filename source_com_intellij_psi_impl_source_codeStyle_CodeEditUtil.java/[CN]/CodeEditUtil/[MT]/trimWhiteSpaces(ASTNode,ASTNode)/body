{
  ASTNode current=first;
  ASTNode result=first;
  while (current != null && current != lastChild) {
    if (current.getElementType() != ElementType.XML_TEXT) {
      LeafElement leaf=TreeUtil.findFirstLeaf(current);
      if (((current == first && current.getTreeNext() != lastChild) || current.getElementType() != ElementType.WHITE_SPACE)) {
        if (leaf != null && leaf.getElementType() == ElementType.WHITE_SPACE) {
          if (leaf == result)           result=leaf.getTreeNext();
          delete(leaf);
        }
      }
      leaf=TreeUtil.findLastLeaf(current);
      if (current.getElementType() != ElementType.WHITE_SPACE) {
        if (leaf != null && leaf.getElementType() == ElementType.WHITE_SPACE) {
          if (leaf == result)           result=leaf.getTreeNext();
          delete(leaf);
        }
      }
    }
    current=current.getTreeNext();
  }
  return result;
}
