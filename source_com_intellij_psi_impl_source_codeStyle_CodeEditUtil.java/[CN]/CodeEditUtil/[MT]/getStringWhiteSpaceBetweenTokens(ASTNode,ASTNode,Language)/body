{
  final FormattingModelBuilder modelBuilder=language.getFormattingModelBuilder();
  if (modelBuilder == null) {
    final LeafElement leafElement=ParseUtil.nextLeaf((TreeElement)first,null);
    if (leafElement != second) {
      return leafElement.getText();
    }
 else {
      return null;
    }
  }
 else {
    final PsiElement secondAsPsiElement=transformToPsiElement(second);
    LOG.assertTrue(secondAsPsiElement != null);
    final PsiFile file=secondAsPsiElement.getContainingFile();
    final Project project=secondAsPsiElement.getProject();
    final CodeStyleSettings settings=CodeStyleSettingsManager.getInstance(project).getCurrentSettings();
    return getWhiteSpaceBeforeToken(second,language,true).generateNewWhiteSpace(settings.getIndentOptions(file.getFileType()));
  }
}
