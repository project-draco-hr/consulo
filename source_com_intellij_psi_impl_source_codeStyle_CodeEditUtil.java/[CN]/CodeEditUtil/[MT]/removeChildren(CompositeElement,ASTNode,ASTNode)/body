{
  LOG.assertTrue(first != null);
  LOG.assertTrue(last != null);
  final boolean tailingElement=last.getStartOffset() + last.getTextLength() == parent.getStartOffset() + parent.getTextLength();
  final boolean forceReformat=needToForceReformat(parent,first,last);
  saveWhitespacesInfo(first);
  TreeElement child=(TreeElement)first;
  while (child != null) {
    checkForOuters(child);
    if (child == last)     break;
    child=child.next;
  }
  final ASTNode prevLeaf=TreeUtil.prevLeaf(first);
  final ASTNode nextLeaf=TreeUtil.nextLeaf(last);
  parent.removeRange(first,last.getTreeNext());
  makePlaceHolderBetweenTokens(prevLeaf,nextLeaf,forceReformat,tailingElement);
}
