{
  final PsiElement firstAsPsiElement=SourceTreeToPsiMap.treeElementToPsi(first);
  LOG.assertTrue(firstAsPsiElement != null);
  final PsiFile file=firstAsPsiElement.getContainingFile();
  final FileType fileType=file.getVirtualFile().getFileType();
  final PseudoTextBuilder pseudoTextBuilder=fileType.getPseudoTextBuilder();
  LOG.assertTrue(pseudoTextBuilder != null);
  final Project project=firstAsPsiElement.getProject();
  final CodeStyleSettings settings=CodeStyleSettingsManager.getInstance(project).getCurrentSettings();
  final int startOffset=first.getStartOffset();
  final int endOffset=second.getStartOffset();
  final PseudoText pseudoText=pseudoTextBuilder.build(project,settings,file,0,file.getTextLength());
  return GeneralCodeFormatter.getWhiteSpaceBetweenTokens(pseudoText,settings,fileType,startOffset,endOffset);
}
