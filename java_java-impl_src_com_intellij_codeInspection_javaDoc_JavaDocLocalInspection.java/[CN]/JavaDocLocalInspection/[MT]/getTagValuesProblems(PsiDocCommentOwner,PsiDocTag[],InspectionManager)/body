{
  final ArrayList<ProblemDescriptor> problems=new ArrayList<ProblemDescriptor>(2);
  nextTag:   for (  PsiDocTag tag : tags) {
    final JavadocManager manager=JavaPsiFacade.getInstance(tag.getProject()).getJavadocManager();
    String tagName=tag.getName();
    JavadocTagInfo tagInfo=manager.getTagInfo(tagName);
    if (tagInfo == null || !tagInfo.isValidInContext(context)) {
      final StringTokenizer tokenizer=new StringTokenizer(myAdditionalJavadocTags,", ");
      while (tokenizer.hasMoreTokens()) {
        if (Comparing.strEqual(tagName,tokenizer.nextToken()))         continue nextTag;
      }
      if (tagInfo == null) {
        problems.add(createDescriptor(tag.getNameElement(),InspectionsBundle.message("inspection.javadoc.problem.wrong.tag","<code>" + tagName + "</code>"),new AddUnknownTagToCustoms(tag),inspectionManager));
      }
 else {
        problems.add(createDescriptor(tag.getNameElement(),InspectionsBundle.message("inspection.javadoc.problem.disallowed.tag","<code>" + tagName + "</code>"),new AddUnknownTagToCustoms(tag),inspectionManager));
      }
    }
    PsiDocTagValue value=tag.getValueElement();
    final JavadocTagInfo info=manager.getTagInfo(tagName);
    if (info != null && !info.isValidInContext(context))     continue;
    String message=info == null ? null : info.checkTagValue(value);
    final PsiReference reference=value != null ? value.getReference() : null;
    if (message == null && reference != null) {
      PsiElement element=reference.resolve();
      if (element == null) {
        final int textOffset=value.getTextOffset();
        if (textOffset == value.getTextRange().getEndOffset()) {
          problems.add(inspectionManager.createProblemDescriptor(tag,InspectionsBundle.message("inspection.javadoc.problem.name.expected"),null,ProblemHighlightType.GENERIC_ERROR_OR_WARNING,true));
        }
      }
    }
    if (message != null) {
      final PsiDocTagValue valueElement=tag.getValueElement();
      if (valueElement == null) {
        problems.add(inspectionManager.createProblemDescriptor(tag,InspectionsBundle.message("inspection.javadoc.method.problem.missing.tag.description","<code>" + tag.getName() + "</code>"),null,ProblemHighlightType.GENERIC_ERROR_OR_WARNING,true));
      }
 else {
        problems.add(createDescriptor(valueElement,message,inspectionManager));
      }
    }
    checkInlineTags(inspectionManager,problems,tag.getDataElements(),manager);
  }
  return problems.isEmpty() ? null : problems;
}
