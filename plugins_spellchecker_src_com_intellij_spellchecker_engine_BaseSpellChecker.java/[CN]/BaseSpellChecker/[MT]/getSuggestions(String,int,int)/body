{
  final String transformed=transform.transform(word);
  if (transformed == null) {
    return Collections.emptyList();
  }
  final List<Suggestion> suggestions=new ArrayList<Suggestion>();
  List<String> rawSuggestions=restore(transformed.charAt(0),0,Integer.MAX_VALUE,bundledDictionaries);
  rawSuggestions.addAll(restore(word.charAt(0),0,Integer.MAX_VALUE,dictionaries));
  for (  String rawSuggestion : rawSuggestions) {
    final int distance=metrics.calculateMetrics(transformed,rawSuggestion);
    suggestions.add(new Suggestion(rawSuggestion,distance));
  }
  List<String> result=new ArrayList<String>();
  if (suggestions.isEmpty()) {
    return result;
  }
  Collections.sort(suggestions);
  int bestMetrics=suggestions.get(0).getMetrics();
  for (int i=0; i < threshold; i++) {
    if (suggestions.size() < i || bestMetrics - suggestions.get(i).getMetrics() > quality) {
      break;
    }
    result.add(i,suggestions.get(i).getWord());
  }
  return result;
}
