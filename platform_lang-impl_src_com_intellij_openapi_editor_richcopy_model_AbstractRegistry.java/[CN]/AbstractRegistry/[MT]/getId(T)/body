{
  if (myIdsByData == null) {
    throw new IllegalStateException(String.format("Can't register data '%s'. Reason: the %s registry is already sealed",data,getClass().getName()));
  }
  int id=myIdsByData.get(data);
  if (id <= 0) {
    id=myIdsByData.size() + 1;
    myDataById.put(id,data);
    myIdsByData.put(data,id);
  }
  return id;
}
