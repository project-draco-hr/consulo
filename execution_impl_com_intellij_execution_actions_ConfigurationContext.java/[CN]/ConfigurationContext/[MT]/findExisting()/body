{
  final RuntimeConfiguration configuration=(RuntimeConfiguration)myDataContext.getData(DataConstantsEx.RUNTIME_CONFIGURATION);
  final List<ConfigurationType> types=new ArrayList<ConfigurationType>();
  if (configuration != null) {
    types.add(configuration.getType());
  }
 else {
    final List<RuntimeConfigurationProducer> producers=PreferedProducerFind.findPreferedProducers(myLocation,this);
    if (producers == null)     return null;
    for (    RuntimeConfigurationProducer producer : producers) {
      types.add(producer.createProducer(myLocation,this).getConfigurationType());
    }
  }
  for (  ConfigurationType type : types) {
    if (!(type instanceof LocatableConfigurationType))     continue;
    final LocatableConfigurationType factoryLocatable=(LocatableConfigurationType)type;
    final RunnerAndConfigurationSettingsImpl[] configurations=getRunManager().getConfigurationSettings(type);
    for (    final RunnerAndConfigurationSettingsImpl existingConfiguration : configurations) {
      if (factoryLocatable.isConfigurationByElement(existingConfiguration.getConfiguration(),getProject(),myLocation.getPsiElement())) {
        return existingConfiguration;
      }
    }
  }
  return null;
}
