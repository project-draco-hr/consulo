{
  final Project project=module.getProject();
  StructureConfigurableContext context=ModuleStructureConfigurable.getInstance(project).getContext();
  if (context != null) {
    final ModulesConfigurator configurator=context.getModulesConfigurator();
    if (!configurator.isModuleModelCommitted()) {
      final ModuleEditor moduleEditor=configurator.getModuleEditor(module);
      if (moduleEditor != null) {
        return moduleEditor.getModifiableRootModelProxy();
      }
    }
  }
  return ModuleRootManager.getInstance(module).getModifiableModel();
}
