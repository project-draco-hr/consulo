{
  final Dimension size=editor.getPreferredSize();
  JPanel result=new JPanel(){
    @Override public Dimension getMinimumSize(){
      return getPreferredSize();
    }
    @Override public Dimension getMaximumSize(){
      return getPreferredSize();
    }
    @Override public Dimension getPreferredSize(){
      if ((myExpanding && myStep >= STEPS_NUMBER) || (!myExpanding && myStep <= 1)) {
        return new Dimension(Math.min(myAvailableWidth,size.width),size.height);
      }
      final int heightUnits=myExpanding ? myStep : STEPS_NUMBER - myStep;
      return new Dimension(Math.min(myAvailableWidth,size.width),size.height * heightUnits / STEPS_NUMBER);
    }
    @Override public void paint(    Graphics g){
      if (!isInFinalState()) {
        changeState();
      }
      super.paint(g);
    }
  }
;
  result.setLayout(new GridBagLayout());
  result.add(editor,new GridBag().fillCell().weightx(1).weighty(1).anchor(GridBagConstraints.NORTHWEST));
  result.setBorder(IdeBorderFactory.createBorder());
  return result;
}
