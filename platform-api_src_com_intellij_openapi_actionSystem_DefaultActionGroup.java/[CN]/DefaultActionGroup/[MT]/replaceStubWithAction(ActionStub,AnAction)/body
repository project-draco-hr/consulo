{
  replace(stub,actualAction);
  int index=mySortedChildren.indexOf(stub);
  if (index != -1) {
    mySortedChildren.set(index,actualAction);
    return;
  }
  for (int j=0; j < myPairs.size(); j++) {
    Pair<AnAction,Constraints> pair=myPairs.get(j);
    if (pair.first.equals(stub)) {
      myPairs.set(j,new Pair<AnAction,Constraints>(actualAction,pair.second));
      return;
    }
  }
  throw new IllegalStateException("unknown stub: " + stub.getId() + "; actions="+ StringUtil.join(mySortedChildren,new Function<AnAction,String>(){
    public String fun(    AnAction action){
      return action.getTemplatePresentation().getText() + " of class " + action.getClass();
    }
  }
,","));
}
