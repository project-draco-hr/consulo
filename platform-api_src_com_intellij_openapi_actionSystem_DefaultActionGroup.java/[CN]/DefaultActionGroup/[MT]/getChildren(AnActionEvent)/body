{
  int sortedSize=mySortedChildren.size();
  AnAction[] children=new AnAction[sortedSize + myPairs.size()];
  for (int i=0; i < sortedSize; i++) {
    children[i]=mySortedChildren.get(i);
  }
  for (int i=0; i < myPairs.size(); i++) {
    children[i + sortedSize]=myPairs.get(i).first;
  }
  for (int i=0; i < children.length; i++) {
    AnAction action=children[i];
    if (!(action instanceof ActionStub)) {
      continue;
    }
    ActionStub stub=(ActionStub)action;
    ActionManager actionManager=e != null ? e.getActionManager() : ActionManager.getInstance();
    AnAction actualAction=actionManager.getAction(stub.getId());
synchronized (mySortedChildren) {
      replaceStubWithAction(stub,actualAction);
    }
    children[i]=actualAction;
  }
  return children;
}
