{
  hideBalloon();
  myBalloonRef=new WeakReference<Balloon>(balloon);
  balloon.addListener(new JBPopupAdapter(){
    @Override public void onClosed(    LightweightWindowEvent event){
      WeakReference<Balloon> ref=myBalloonRef;
      if (ref != null && ref.get() == balloon) {
        myBalloonRef=null;
      }
    }
  }
);
}
