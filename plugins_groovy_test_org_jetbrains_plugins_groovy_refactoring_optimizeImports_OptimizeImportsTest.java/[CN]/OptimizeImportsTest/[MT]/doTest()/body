{
  CodeStyleSettings settings=CodeStyleSettingsManager.getSettings(getProject()).clone();
  CodeStyleSettingsManager.getInstance(getProject()).setTemporarySettings(settings);
  settings.CLASS_COUNT_TO_USE_IMPORT_ON_DEMAND=3;
  try {
    myFixture.configureByFile(getTestName(false) + ".groovy");
    doOptimizeImports();
    PostprocessReformattingAspect.getInstance(getProject()).doPostponedFormatting();
    ((DocumentEx)myFixture.getEditor().getDocument()).stripTrailingSpaces(false);
    myFixture.checkResultByFile(getTestName(false) + "_after.groovy");
  }
  finally {
    CodeStyleSettingsManager.getInstance(getProject()).dropTemporarySettings();
  }
}
