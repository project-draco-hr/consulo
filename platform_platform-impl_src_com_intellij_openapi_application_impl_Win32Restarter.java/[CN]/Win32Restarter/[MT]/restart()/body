{
  Kernel32 kernel32=(Kernel32)Native.loadLibrary("kernel32",Kernel32.class);
  WString cline=kernel32.GetCommandLineW();
  int pid=kernel32.GetCurrentProcessId();
  try {
    String command="restarter " + Integer.toString(pid) + " "+ cline;
    LOG.info("Restarter command: " + command);
    Runtime.getRuntime().exec(command,null,new File(PathManager.getBinPath()));
  }
 catch (  IOException ex) {
    Messages.showMessageDialog("Restart failed: " + ex.getMessage(),"Restart",Messages.getErrorIcon());
    return;
  }
  try {
    Thread.sleep(500);
  }
 catch (  InterruptedException e1) {
  }
  ((ApplicationEx)ApplicationManager.getApplication()).exit(true);
}
