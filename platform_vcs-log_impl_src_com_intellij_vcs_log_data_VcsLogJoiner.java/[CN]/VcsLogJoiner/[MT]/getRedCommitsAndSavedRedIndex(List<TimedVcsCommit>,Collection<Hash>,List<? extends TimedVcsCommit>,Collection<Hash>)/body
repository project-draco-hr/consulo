{
  Set<Hash> startRedCommits=new HashSet<Hash>(previousRefs);
  startRedCommits.removeAll(newRefs);
  Set<Hash> startGreenNodes=new HashSet<Hash>(newRefs);
  for (  TimedVcsCommit commit : firstBlock) {
    startGreenNodes.add(commit.getHash());
    startGreenNodes.addAll(commit.getParents());
  }
  RedGreenSorter sorter=new RedGreenSorter(startRedCommits,startGreenNodes,savedLog);
  int saveRegIndex=sorter.getFirstSaveIndex();
  if (saveRegIndex == -1)   return new Pair<Integer,Set<Hash>>(-1,null);
  return new Pair<Integer,Set<Hash>>(saveRegIndex,sorter.getAllRedCommit());
}
