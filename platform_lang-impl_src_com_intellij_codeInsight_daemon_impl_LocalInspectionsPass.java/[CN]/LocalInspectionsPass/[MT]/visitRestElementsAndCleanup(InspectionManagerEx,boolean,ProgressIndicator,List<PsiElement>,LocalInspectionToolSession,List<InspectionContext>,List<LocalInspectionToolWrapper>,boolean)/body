{
  Processor<InspectionContext> processor=new Processor<InspectionContext>(){
    @Override public boolean process(    InspectionContext context){
      indicator.checkCanceled();
      ApplicationManager.getApplication().assertReadAccessAllowed();
      acceptElements(elements,context.visitor,context.languageIds);
      advanceProgress(1);
      context.tool.getTool().inspectionFinished(session,context.holder);
      if (context.holder.hasResults()) {
        appendDescriptors(myFile,context.holder.getResults(),context.tool);
      }
      return true;
    }
  }
;
  boolean result=JobUtil.invokeConcurrentlyUnderProgress(init,indicator,myFailFastOnAcquireReadAction,processor);
  if (!result) {
    throw new ProcessCanceledException();
  }
  inspectInjectedPsi(elements,isOnTheFly,indicator,iManager,false,checkDumbAwareness,wrappers);
}
