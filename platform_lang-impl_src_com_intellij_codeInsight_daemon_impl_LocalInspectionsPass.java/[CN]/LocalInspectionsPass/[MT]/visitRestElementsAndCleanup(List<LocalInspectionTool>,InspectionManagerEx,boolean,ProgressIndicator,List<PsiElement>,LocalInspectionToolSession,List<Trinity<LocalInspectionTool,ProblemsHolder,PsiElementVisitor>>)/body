{
  Processor<Trinity<LocalInspectionTool,ProblemsHolder,PsiElementVisitor>> processor=new Processor<Trinity<LocalInspectionTool,ProblemsHolder,PsiElementVisitor>>(){
    @Override public boolean process(    Trinity<LocalInspectionTool,ProblemsHolder,PsiElementVisitor> trinity){
      LocalInspectionTool tool=trinity.first;
      indicator.checkCanceled();
      ApplicationManager.getApplication().assertReadAccessAllowed();
      ProblemsHolder holder=trinity.second;
      PsiElementVisitor elementVisitor=trinity.third;
      for (int i=0, elementsSize=elements.size(); i < elementsSize; i++) {
        PsiElement element=elements.get(i);
        element.accept(elementVisitor);
        if (i % NUM_ELEMENTS_PER_CHECK_CANCELLED == 0)         indicator.checkCanceled();
      }
      advanceProgress(1);
      tool.inspectionFinished(session,holder);
      if (holder.hasResults()) {
        appendDescriptors(myFile,holder.getResults(),tool);
      }
      return true;
    }
  }
;
  boolean result=JobUtil.invokeConcurrentlyUnderProgress(init,processor,myFailFastOnAcquireReadAction,indicator);
  if (!result) {
    throw new ProcessCanceledException();
  }
  inspectInjectedPsi(elements,tools,isOnTheFly,indicator,iManager,false);
}
