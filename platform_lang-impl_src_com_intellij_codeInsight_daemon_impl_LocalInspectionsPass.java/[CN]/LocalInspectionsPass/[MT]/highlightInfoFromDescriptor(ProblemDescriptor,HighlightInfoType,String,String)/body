{
  TextRange textRange=((ProblemDescriptorImpl)problemDescriptor).getTextRange();
  PsiElement element=problemDescriptor.getPsiElement();
  if (textRange == null || element == null)   return null;
  boolean isFileLevel=element instanceof PsiFile && textRange.equals(element.getTextRange());
  final HighlightSeverity severity=highlightInfoType.getSeverity(element);
  TextAttributes attributes=mySeverityRegistrar.getTextAttributesBySeverity(severity);
  return new HighlightInfo(attributes,highlightInfoType,textRange.getStartOffset(),textRange.getEndOffset(),message,toolTip,severity,problemDescriptor.isAfterEndOfLine(),null,isFileLevel);
}
