{
  myFailFastOnAcquireReadAction=failFastOnAcquireReadAction;
  if (toolWrappers.isEmpty())   return;
  List<PsiElement> inside=new ArrayList<PsiElement>();
  List<PsiElement> outside=new ArrayList<PsiElement>();
  Divider.divideInsideAndOutside(myFile,myStartOffset,myEndOffset,myPriorityRange,inside,outside,HighlightLevelUtil.AnalysisLevel.HIGHLIGHT_AND_INSPECT,true);
  List<Pair<LocalInspectionTool,String>> tools=getToolsForElements(toolWrappers,checkDumbAwareness,inside,outside);
  setProgressLimit(1L * tools.size() * 2);
  final LocalInspectionToolSession session=new LocalInspectionToolSession(myFile,myStartOffset,myEndOffset);
  List<Trinity<LocalInspectionTool,ProblemsHolder,PsiElementVisitor>> init=new ArrayList<Trinity<LocalInspectionTool,ProblemsHolder,PsiElementVisitor>>();
  visitPriorityElementsAndInit(tools,iManager,isOnTheFly,indicator,inside,session,init,toolWrappers,checkDumbAwareness);
  visitRestElementsAndCleanup(iManager,isOnTheFly,indicator,outside,session,init,toolWrappers,checkDumbAwareness);
  indicator.checkCanceled();
  myInfos=new ArrayList<HighlightInfo>();
  addHighlightsFromResults(myInfos,indicator);
}
