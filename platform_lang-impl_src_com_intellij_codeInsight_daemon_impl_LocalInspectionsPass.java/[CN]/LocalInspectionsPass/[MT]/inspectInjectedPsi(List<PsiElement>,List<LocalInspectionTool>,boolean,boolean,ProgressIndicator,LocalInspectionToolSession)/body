{
  final Set<PsiFile> injected=new THashSet<PsiFile>();
  for (  PsiElement element : elements) {
    InjectedLanguageUtil.enumerate(element,myFile,new PsiLanguageInjectionHost.InjectedPsiVisitor(){
      public void visit(      @NotNull PsiFile injectedPsi,      @NotNull List<PsiLanguageInjectionHost.Shred> places){
        injected.add(injectedPsi);
      }
    }
,false);
  }
  if (injected.isEmpty())   return;
  if (!JobUtil.invokeConcurrentlyUnderProgress(new ArrayList<PsiFile>(injected),new Processor<PsiFile>(){
    public boolean process(    final PsiFile injectedPsi){
      doInspectInjectedPsi(injectedPsi,tools,onTheFly,ignoreSuppressed,indicator,session);
      return true;
    }
  }
,myFailFastOnAcquireReadAction,indicator))   throw new ProcessCanceledException();
}
