{
  final Set<PsiFile> injected=new THashSet<PsiFile>();
  for (  PsiElement element : elements) {
    InjectedLanguageUtil.enumerate(element,myFile,false,new PsiLanguageInjectionHost.InjectedPsiVisitor(){
      @Override public void visit(      @NotNull PsiFile injectedPsi,      @NotNull List<PsiLanguageInjectionHost.Shred> places){
        injected.add(injectedPsi);
      }
    }
);
  }
  if (injected.isEmpty())   return;
  if (!JobUtil.invokeConcurrentlyUnderProgress(new ArrayList<PsiFile>(injected),indicator,myFailFastOnAcquireReadAction,new Processor<PsiFile>(){
    @Override public boolean process(    final PsiFile injectedPsi){
      doInspectInjectedPsi(injectedPsi,tools,onTheFly,indicator,iManager,inVisibleRange);
      return true;
    }
  }
))   throw new ProcessCanceledException();
}
