{
  final PsiElement element=file.findElementAt(editor.getCaretModel().getOffset());
  if (element != null && PsiUtil.isJavaToken(element,JavaTokenType.CHARACTER_LITERAL)) {
    final String text=StringUtil.unescapeStringCharacters(element.getText());
    final int length=text.length();
    if (length > 1 && text.charAt(0) == '\'' && text.charAt(length - 1) == '\'') {
      final String value=StringUtil.escapeStringCharacters(text.substring(1,length - 1));
      final PsiExpression expression=JavaPsiFacade.getElementFactory(project).createExpressionFromText('"' + value + '"',null);
      final PsiElement literal=expression.getFirstChild();
      if (literal != null && PsiUtil.isJavaToken(literal,JavaTokenType.STRING_LITERAL)) {
        element.replace(literal);
      }
    }
  }
}
