{
  if (virtualFiles.length > 1) {
    JBPopupFactory.getInstance().createListPopup(new BaseListPopupStep<VirtualFile>("Annotation Roots",virtualFiles){
      @Override public PopupStep onChosen(      final VirtualFile file,      final boolean finalChoice){
        annotateExternally(file,listOwner,project,packageName,virtualFile,annotationFQName,fromFile);
        return PopupStep.FINAL_CHOICE;
      }
      @NotNull @Override public String getTextFor(      final VirtualFile value){
        return value.getPresentableUrl();
      }
      @Override public Icon getIconFor(      final VirtualFile aValue){
        return ICON;
      }
    }
).showInBestPositionFor(DataManager.getInstance().getDataContext());
  }
 else {
    annotateExternally(virtualFiles[0],listOwner,project,packageName,virtualFile,annotationFQName,fromFile);
  }
}
