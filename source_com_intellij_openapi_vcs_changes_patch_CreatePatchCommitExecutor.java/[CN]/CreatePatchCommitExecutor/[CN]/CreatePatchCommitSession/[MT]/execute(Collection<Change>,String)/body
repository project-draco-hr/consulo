{
  try {
    Writer writer=new OutputStreamWriter(new FileOutputStream(myPanel.getFileName()));
    try {
      List<FilePatch> patches=PatchBuilder.buildPatch(changes,myProject.getProjectFile().getParent().getPresentableUrl());
      UnifiedDiffWriter.write(patches,writer);
    }
  finally {
      writer.close();
    }
  }
 catch (  IOException ex) {
    Messages.showErrorDialog(myProject,VcsBundle.message("create.patch.error.title",ex.getMessage()),CommonBundle.getErrorTitle());
  }
}
