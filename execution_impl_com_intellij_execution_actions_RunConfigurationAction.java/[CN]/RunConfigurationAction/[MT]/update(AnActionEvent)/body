{
  final Presentation presentation=e.getPresentation();
  final Project project=e.getData(PlatformDataKeys.PROJECT);
  if (ActionPlaces.MAIN_MENU.equals(e.getPlace())) {
    presentation.setDescription(ExecutionBundle.message("choose.run.configuration.action.description"));
    presentation.setEnabled(findFrame(e.getData(PlatformDataKeys.CONTEXT_COMPONENT)) != null);
    return;
  }
  if (project == null || project.isDisposed()) {
    updateButton(null,null,presentation);
    presentation.setEnabled(false);
  }
 else {
    final RunManagerEx runManager=RunManagerEx.getInstanceEx(project);
    RunnerAndConfigurationSettings selected=runManager.getSelectedConfiguration();
    updateButton(selected == null ? null : selected.getConfiguration(),project,presentation);
    presentation.setEnabled(true);
  }
}
