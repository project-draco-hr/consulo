{
  final DefaultActionGroup allActionsGroup=new DefaultActionGroup();
  final Project project=DataKeys.PROJECT.getData(DataManager.getInstance().getDataContext(button));
  if (project != null) {
    final RunManagerEx runManager=RunManagerEx.getInstanceEx(project);
    allActionsGroup.add(ActionManager.getInstance().getAction(IdeActions.ACTION_EDIT_RUN_CONFIGURATIONS));
    allActionsGroup.add(new SaveTemporaryAction());
    allActionsGroup.addSeparator();
    final ConfigurationType[] types=runManager.getConfigurationFactories();
    for (    ConfigurationType type : types) {
      final DefaultActionGroup actionGroup=new DefaultActionGroup();
      final RunnerAndConfigurationSettingsImpl[] configurations=runManager.getConfigurationSettings(type);
      for (      final RunnerAndConfigurationSettingsImpl configuration : configurations) {
        final MenuAction action=new MenuAction(configuration,project);
        actionGroup.add(action);
      }
      allActionsGroup.add(actionGroup);
      allActionsGroup.addSeparator();
    }
  }
  return allActionsGroup;
}
