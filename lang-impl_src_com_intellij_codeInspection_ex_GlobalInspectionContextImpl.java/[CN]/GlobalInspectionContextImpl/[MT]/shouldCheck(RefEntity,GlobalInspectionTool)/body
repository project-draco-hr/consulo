{
  if (entity instanceof RefElementImpl) {
    final RefElementImpl refElement=(RefElementImpl)entity;
    if (refElement.isSuppressed(tool.getShortName()))     return false;
    final PsiFile file=refElement.getContainingFile();
    if (file == null)     return false;
    final Set<Pair<InspectionTool,NamedScope>> tools=myTools.get(tool.getShortName());
    for (    Pair<InspectionTool,NamedScope> inspectionProfilePair : tools) {
      if (inspectionProfilePair.second == null || inspectionProfilePair.second.getValue().contains(file,getCurrentProfile().getProfileManager().getScopesManager())) {
        return ((GlobalInspectionToolWrapper)inspectionProfilePair.first).getTool() == tool;
      }
    }
    return false;
  }
  return true;
}
