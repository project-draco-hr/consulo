{
  importProject("<groupId>test</groupId>" + "<artifactId>parent</artifactId>" + "<version>1</version>"+ "<modules>"+ "  <module>m</module>"+ "</modules>");
  VirtualFile m=createModulePom("m","<groupId>test</groupId>" + "<artifactId>m</artifactId>" + "<version>1</version>");
  waitForReadingCompletion();
  assertEquals(1,myProjectsTree.getRootProjects().size());
  assertEquals(1,myProjectsTree.getModules(myProjectsTree.getRootProjects().get(0)).size());
  myProjectsManager.addManagedFiles(Arrays.asList(m));
  waitForReadingCompletion();
  assertEquals(1,myProjectsTree.getRootProjects().size());
  assertEquals(1,myProjectsTree.getModules(myProjectsTree.getRootProjects().get(0)).size());
  createProjectPom("<groupId>test</groupId>" + "<artifactId>parent</artifactId>" + "<version>1</version>");
  waitForReadingCompletion();
  assertEquals(2,myProjectsTree.getRootProjects().size());
  assertEquals(0,myProjectsTree.getModules(myProjectsTree.getRootProjects().get(0)).size());
  assertEquals(0,myProjectsTree.getModules(myProjectsTree.getRootProjects().get(1)).size());
}
