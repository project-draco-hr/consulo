{
  importProject("<groupId>test</groupId>" + "<artifactId>project</artifactId>" + "<packaging>pom</packaging>"+ "<version>1</version>");
  createModulePom("dir/module","<groupId>test</groupId>" + "<artifactId>module</artifactId>" + "<version>1</version>");
  createProjectPom("<groupId>test</groupId>" + "<artifactId>project</artifactId>" + "<packaging>pom</packaging>"+ "<version>1</version>"+ "<modules>"+ "  <module>dir/module</module>"+ "</modules>");
  waitForFullReadingCompletion();
  assertEquals(2,MavenProjectsManager.getInstance(myProject).getProjects().size());
  VirtualFile dir=myProjectRoot.findChild("dir");
  dir.delete(null);
  waitForFullReadingCompletion();
  assertEquals(1,MavenProjectsManager.getInstance(myProject).getProjects().size());
}
