{
  boolean oldState=isDdmsEnabled();
  PropertiesComponent.getInstance().setValue(ENABLE_DDMS_PROPERTY_NAME,Boolean.toString(state));
  if (oldState != state) {
    ToolWindow toolWindow=ToolWindowManager.getInstance(project).getToolWindow(AndroidLogcatToolWindowFactory.TOOL_WINDOW_ID);
    boolean hidden=false;
    if (toolWindow != null && toolWindow.isVisible()) {
      hidden=true;
      toolWindow.hide(null);
    }
    AndroidSdkData.terminateDdmlib();
    if (hidden) {
      toolWindow.show(null);
    }
  }
}
