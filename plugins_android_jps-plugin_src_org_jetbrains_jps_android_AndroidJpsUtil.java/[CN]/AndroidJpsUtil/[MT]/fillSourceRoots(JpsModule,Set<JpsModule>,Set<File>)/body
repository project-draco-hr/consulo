{
  visited.add(module);
  final JpsAndroidModuleExtension extension=getExtension(module);
  File resDir=null;
  File resDirForCompilation=null;
  if (extension != null) {
    resDir=extension.getResourceDir();
    resDirForCompilation=extension.getResourceDirForCompilation();
  }
  for (  JpsModuleSourceRoot root : module.getSourceRoots()) {
    final File rootDir=JpsPathUtil.urlToFile(root.getUrl());
    if ((JavaSourceRootType.SOURCE.equals(root.getRootType()) || JavaSourceRootType.TEST_SOURCE.equals(root.getRootType()) && extension != null && extension.isPackTestCode()) && !rootDir.equals(resDir) && !rootDir.equals(resDirForCompilation)) {
      result.add(rootDir);
    }
  }
  for (  JpsDependencyElement classpathItem : JpsJavaExtensionService.getInstance().getDependencies(module,JpsJavaClasspathKind.PRODUCTION_RUNTIME,false)) {
    if (classpathItem instanceof JpsModuleDependency) {
      final JpsModule depModule=((JpsModuleDependency)classpathItem).getModule();
      if (depModule != null && !visited.contains(depModule)) {
        fillSourceRoots(depModule,visited,result);
      }
    }
  }
}
