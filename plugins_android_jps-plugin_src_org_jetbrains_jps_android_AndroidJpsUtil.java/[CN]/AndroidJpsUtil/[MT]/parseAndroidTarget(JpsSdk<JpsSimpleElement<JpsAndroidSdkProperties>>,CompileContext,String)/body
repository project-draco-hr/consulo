{
  JpsAndroidSdkProperties sdkProperties=sdk.getSdkProperties().getData();
  final String targetHashString=sdkProperties.getBuildTargetHashString();
  if (targetHashString == null) {
    context.processMessage(new CompilerMessage(builderName,BuildMessage.Kind.ERROR,"Cannot parse SDK " + sdk.getParent().getName() + ": build target is not specified"));
    return null;
  }
  final MessageBuildingSdkLog log=new MessageBuildingSdkLog();
  final SdkManager manager=AndroidCommonUtils.createSdkManager(sdk.getHomePath(),log);
  if (manager == null) {
    final String message=log.getErrorMessage();
    context.processMessage(new CompilerMessage(builderName,BuildMessage.Kind.ERROR,"Android SDK is parsed incorrectly." + (message.length() > 0 ? " Parsing log:\n" + message : "")));
    return null;
  }
  final IAndroidTarget target=manager.getTargetFromHashString(targetHashString);
  if (target == null) {
    context.processMessage(new CompilerMessage(builderName,BuildMessage.Kind.ERROR,"Cannot parse SDK '" + sdk.getParent().getName() + "': unknown target "+ targetHashString));
    return null;
  }
  return target;
}
