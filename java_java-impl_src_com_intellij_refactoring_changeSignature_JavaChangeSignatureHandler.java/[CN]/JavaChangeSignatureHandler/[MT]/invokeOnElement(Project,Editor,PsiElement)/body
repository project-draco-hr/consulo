{
  if (element instanceof PsiMethod) {
    final ChangeSignatureGestureDetector detector=ChangeSignatureGestureDetector.getInstance(project);
    final PsiIdentifier nameIdentifier=((PsiMethod)element).getNameIdentifier();
    if (nameIdentifier != null && detector.isChangeSignatureAvailable(nameIdentifier)) {
      detector.changeSignature(element.getContainingFile());
      return;
    }
    invoke((PsiMethod)element,project,editor);
  }
 else   if (element instanceof PsiClass) {
    invoke((PsiClass)element,editor);
  }
 else {
    String message=RefactoringBundle.getCannotRefactorMessage(RefactoringBundle.message("error.wrong.caret.position.method.or.class.name"));
    CommonRefactoringUtil.showErrorHint(project,editor,message,REFACTORING_NAME,HelpID.CHANGE_SIGNATURE);
  }
}
