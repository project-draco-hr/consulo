def loaddoc(topic):
    'Return a delayed loader for help/topic.txt.'

    def loader():
        if hasattr(sys, 'frozen'):
            module = sys.executable
        else:
            module = __file__
        base = os.path.dirname(module)
        for dir in ('.', '..'):
            docdir = os.path.join(base, dir, 'help')
            if os.path.isdir(docdir):
                break
        path = os.path.join(docdir, (topic + '.txt'))
        return gettext(open(path).read())
    return loader
