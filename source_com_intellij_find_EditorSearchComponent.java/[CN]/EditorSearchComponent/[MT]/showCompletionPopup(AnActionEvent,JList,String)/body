{
  final Runnable callback=new Runnable(){
    public void run(){
      String selectedValue=(String)list.getSelectedValue();
      if (selectedValue != null) {
        mySearchField.setText(selectedValue);
      }
    }
  }
;
  final PopupChooserBuilder builder=JBPopupFactory.getInstance().createListPopupBuilder(list);
  if (title != null) {
    builder.setTitle(title);
  }
  final JBPopup popup=builder.setMovable(false).setResizable(false).setRequestFocus(true).setItemChoosenCallback(callback).createPopup();
  final InputEvent event=e.getInputEvent();
  if (event instanceof MouseEvent) {
    popup.showUnderneathOf(myToolbarComponent);
  }
 else {
    popup.showUnderneathOf(mySearchField);
  }
}
