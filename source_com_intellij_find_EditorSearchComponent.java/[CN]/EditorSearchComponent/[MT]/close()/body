{
  removeCurrentHighlights();
  if (myEditor.getSelectionModel().hasSelection()) {
    myEditor.getCaretModel().moveToOffset(myEditor.getSelectionModel().getSelectionStart());
    myEditor.getSelectionModel().removeSelection();
  }
  myEditor.setHeaderComponent(null);
  myEditor.getDocument().removeDocumentListener(myDocumentListener);
  myConnection.disconnect();
  addCurrentTextToRecents();
}
