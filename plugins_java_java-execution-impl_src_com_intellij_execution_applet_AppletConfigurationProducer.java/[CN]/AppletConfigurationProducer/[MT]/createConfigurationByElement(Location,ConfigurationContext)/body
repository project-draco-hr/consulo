{
  location=JavaExecutionUtil.stepIntoSingleClass(location);
  if (location == null)   return null;
  final Project project=location.getProject();
  final PsiElement element=location.getPsiElement();
  myPsiClass=getAppletClass(element,PsiManager.getInstance(project));
  if (myPsiClass == null)   return null;
  RunnerAndConfigurationSettings settings=cloneTemplateConfiguration(project,context);
  final AppletConfiguration configuration=(AppletConfiguration)settings.getConfiguration();
  configuration.MAIN_CLASS_NAME=JavaExecutionUtil.getRuntimeQualifiedName(myPsiClass);
  configuration.setModule(myPsiClass.isValid() ? ModuleUtilCore.findModuleForPsiElement(myPsiClass) : null);
  configuration.setName(configuration.getGeneratedName());
  return settings;
}
