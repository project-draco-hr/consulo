{
  File targetDir=new File(myMavenProject.getBuildDirectory());
  Map<File,Boolean> generatedDirs=new THashMap<File,Boolean>();
  generatedDirs.put(new File(myMavenProject.getGeneratedSourcesDirectory(true)),true);
  generatedDirs.put(new File(myMavenProject.getGeneratedSourcesDirectory(false)),false);
  myModel.unregisterAll(targetDir.getPath(),true,false);
  for (  File f : getChildren(targetDir)) {
    if (!f.isDirectory())     continue;
    Boolean isGeneratedTestSources=generatedDirs.get(f);
    if (isGeneratedTestSources != null) {
      addAllSubDirsAsSources(f,isGeneratedTestSources);
    }
 else {
      if (myModel.hasRegisteredSourceSubfolder(f))       continue;
      if (myModel.isAlreadyExcluded(f))       continue;
      myModel.addExcludedFolder(f.getPath());
    }
  }
  List<String> facetExcludes=new ArrayList<String>();
  for (  MavenImporter each : MavenImporter.getSuitableImporters(myMavenProject)) {
    each.collectExcludedFolders(myMavenProject,facetExcludes);
  }
  for (  String eachFolder : facetExcludes) {
    myModel.unregisterAll(eachFolder,true,true);
    myModel.addExcludedFolder(eachFolder);
  }
  if (!myModel.hasRegisteredSourceSubfolder(targetDir)) {
    myModel.addExcludedFolder(targetDir.getPath());
  }
}
