{
  ArtifactRepositoryLayout layout=getComponent(ArtifactRepositoryLayout.class,"default");
  ArtifactRepositoryFactory factory=getComponent(ArtifactRepositoryFactory.class);
  String url=myMavenSettings.getLocalRepository();
  if (!url.startsWith("file:"))   url="file://" + url;
  ArtifactRepository localRepository=factory.createArtifactRepository("local",url,layout,null,null);
  boolean snapshotPolicySet=myMavenSettings.isOffline();
  if (!snapshotPolicySet && snapshotUpdatePolicy == MavenServerSettings.UpdatePolicy.ALWAYS_UPDATE) {
    factory.setGlobalUpdatePolicy(ArtifactRepositoryPolicy.UPDATE_POLICY_ALWAYS);
  }
  factory.setGlobalChecksumPolicy(ArtifactRepositoryPolicy.CHECKSUM_POLICY_WARN);
  return localRepository;
}
