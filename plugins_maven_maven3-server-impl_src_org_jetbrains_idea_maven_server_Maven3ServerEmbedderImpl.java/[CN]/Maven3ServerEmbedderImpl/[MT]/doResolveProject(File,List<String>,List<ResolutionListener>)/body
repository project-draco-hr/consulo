{
  MavenExecutionRequest request=createRequest(file,activeProfiles,Collections.<String>emptyList(),Collections.<String>emptyList());
  ProjectBuildingRequest config=request.getProjectBuildingRequest();
  List<Exception> exceptions=new ArrayList<Exception>();
  try {
    ProjectBuilder builder=getComponent(ProjectBuilder.class);
    ProjectBuildingResult buildingResult=builder.build(new File(file.getPath()),config);
    MavenProject project=buildingResult.getProject();
    project.setDependencyArtifacts(project.createArtifacts(getComponent(ArtifactFactory.class),null,null));
    ArtifactResolver resolver=getComponent(ArtifactResolver.class);
    ArtifactResolutionRequest resolutionRequest=new ArtifactResolutionRequest();
    resolutionRequest.setArtifactDependencies(project.getDependencyArtifacts());
    resolutionRequest.setArtifact(project.getArtifact());
    resolutionRequest.setManagedVersionMap(project.getManagedVersionMap());
    resolutionRequest.setLocalRepository(myLocalRepository);
    resolutionRequest.setRemoteRepositories(project.getRemoteArtifactRepositories());
    resolutionRequest.setListeners(listeners);
    resolutionRequest.setResolveRoot(false);
    resolutionRequest.setResolveTransitively(true);
    ArtifactResolutionResult result=resolver.resolve(resolutionRequest);
    project.setArtifacts(result.getArtifacts());
    return new MavenExecutionResult(project,exceptions);
  }
 catch (  Exception e) {
    return handleException(e);
  }
}
