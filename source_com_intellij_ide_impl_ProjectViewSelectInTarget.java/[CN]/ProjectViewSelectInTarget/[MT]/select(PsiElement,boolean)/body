{
  PsiElement current=element;
  while (current != null) {
    if (current instanceof PsiFileSystemItem) {
      break;
    }
    if (isTopLevelClass(current)) {
      break;
    }
    current=current.getParent();
  }
  if (current instanceof PsiJavaFile) {
    PsiClass[] classes=((PsiJavaFile)current).getClasses();
    if (classes.length > 0 && isTopLevelClass(classes[0])) {
      current=classes[0];
    }
  }
  if (current == null) {
    current=element;
  }
  PsiElement originalElement=current.getOriginalElement();
  JspFile jspFile=PsiUtil.getJspFile(originalElement);
  final VirtualFile virtualFile=PsiUtil.getVirtualFile(originalElement);
  select(jspFile == null ? originalElement : jspFile,virtualFile,requestFocus);
}
