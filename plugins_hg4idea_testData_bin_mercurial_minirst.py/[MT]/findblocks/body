def findblocks(text):
    "Find continuous blocks of lines in text.\n\n    Returns a list of dictionaries representing the blocks. Each block\n    has an 'indent' field and a 'lines' field.\n    "
    blocks = [[]]
    lines = text.splitlines()
    for line in lines:
        if line.strip():
            blocks[(-1)].append(line)
        elif blocks[(-1)]:
            blocks.append([])
    if (not blocks[(-1)]):
        del blocks[(-1)]
    for (i, block) in enumerate(blocks):
        indent = min(((len(l) - len(l.lstrip())) for l in block))
        blocks[i] = dict(indent=indent, lines=[l[indent:] for l in block])
    return blocks
