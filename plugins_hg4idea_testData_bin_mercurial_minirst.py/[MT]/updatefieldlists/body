def updatefieldlists(blocks):
    'Find key and maximum key width for field lists.'
    i = 0
    while (i < len(blocks)):
        if (blocks[i]['type'] != 'field'):
            i += 1
            continue
        keywidth = 0
        j = i
        while ((j < len(blocks)) and (blocks[j]['type'] == 'field')):
            m = _fieldre.match(blocks[j]['lines'][0])
            (key, rest) = m.groups()
            blocks[j]['lines'][0] = rest
            blocks[j]['key'] = key
            keywidth = max(keywidth, len(key))
            j += 1
        for block in blocks[i:j]:
            block['keywidth'] = keywidth
        i = (j + 1)
    return blocks
