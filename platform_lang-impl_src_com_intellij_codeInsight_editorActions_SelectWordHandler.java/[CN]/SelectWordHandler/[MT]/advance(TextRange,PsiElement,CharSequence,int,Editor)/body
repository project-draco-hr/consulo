{
  if (LOG.isDebugEnabled()) {
    LOG.debug("enter: advance(selectionRange='" + selectionRange + "', element='"+ element+ "')");
  }
  TextRange minimumRange=null;
  for (  ExtendWordSelectionHandler selectioner : SelectWordUtil.getExtendWordSelectionHandlers()) {
    if (!selectioner.canSelect(element)) {
      continue;
    }
    List<TextRange> ranges=selectioner.select(element,text,cursorOffset,editor);
    if (ranges == null) {
      continue;
    }
    for (    TextRange range : ranges) {
      if (range == null) {
        continue;
      }
      if (range.contains(selectionRange) && !range.equals(selectionRange)) {
        if (minimumRange == null || minimumRange.contains(range)) {
          minimumRange=range;
        }
      }
    }
  }
  if (minimumRange != null) {
    LOG.assertTrue(minimumRange.getEndOffset() <= text.length());
  }
  return minimumRange;
}
