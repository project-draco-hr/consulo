{
  if (LOG.isDebugEnabled()) {
    LOG.debug("enter: execute(editor='" + editor + "')");
  }
  Project project=CommonDataKeys.PROJECT.getData(DataManager.getInstance().getDataContext(editor.getComponent()));
  if (project == null) {
    if (myOriginalHandler != null) {
      myOriginalHandler.execute(editor,dataContext);
    }
    return;
  }
  PsiDocumentManager.getInstance(project).commitAllDocuments();
  TextRange range=selectWord(editor,project);
  if (editor instanceof EditorWindow) {
    if (range == null || !isInsideEditableInjection((EditorWindow)editor,range,project) || TextRange.from(0,editor.getDocument().getTextLength()).equals(new TextRange(editor.getSelectionModel().getSelectionStart(),editor.getSelectionModel().getSelectionEnd()))) {
      editor=((EditorWindow)editor).getDelegate();
      range=selectWord(editor,project);
    }
  }
  if (range == null) {
    if (myOriginalHandler != null) {
      myOriginalHandler.execute(editor,dataContext);
    }
  }
 else {
    editor.getSelectionModel().setSelection(range.getStartOffset(),range.getEndOffset());
  }
}
