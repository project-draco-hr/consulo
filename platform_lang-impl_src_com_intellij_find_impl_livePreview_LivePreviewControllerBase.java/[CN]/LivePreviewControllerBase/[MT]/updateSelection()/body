{
  Editor editor=mySearchResults.getEditor();
  SelectionModel selection=editor.getSelectionModel();
  FindModel findModel=mySearchResults.getFindModel();
  if (findModel != null && findModel.isGlobal()) {
    FindResult cursor=mySearchResults.getCursor();
    if (cursor != null) {
      TextRange range=cursor;
      FoldingModel foldingModel=editor.getFoldingModel();
      final FoldRegion startFolding=foldingModel.getCollapsedRegionAtOffset(range.getStartOffset());
      final FoldRegion endFolding=foldingModel.getCollapsedRegionAtOffset(range.getEndOffset());
      foldingModel.runBatchFoldingOperation(new Runnable(){
        @Override public void run(){
          if (startFolding != null) {
            startFolding.setExpanded(true);
          }
          if (endFolding != null) {
            endFolding.setExpanded(true);
          }
        }
      }
);
      selection.setSelection(range.getStartOffset(),range.getEndOffset());
      editor.getCaretModel().moveToOffset(range.getEndOffset());
      editor.getScrollingModel().scrollToCaret(ScrollType.RELATIVE);
    }
  }
}
