{
  if (!Utils.ensureOkToWrite(e))   return;
  if (mySearchResults.getFindModel() != null) {
    final FindModel copy=new FindModel();
    copy.copyFrom(mySearchResults.getFindModel());
    final SelectionModel selectionModel=mySearchResults.getEditor().getSelectionModel();
    int offset;
    if (selectionModel.getSelectedText() != null) {
      offset=selectionModel.getSelectionStart();
    }
 else {
      offset=0;
      copy.setGlobal(true);
    }
    FindUtil.replace(e.getProject(),e,offset,copy,this);
    if (myReplaceListener != null) {
      myReplaceListener.replaceAllPerformed(e);
    }
  }
}
