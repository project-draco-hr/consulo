{
  EditorFileSwapper[] swappers=Extensions.getExtensions(EditorFileSwapper.EP_NAME);
  for (  EditorWindow eachWindow : getWindows()) {
    VirtualFile selected=eachWindow.getSelectedFile();
    VirtualFile[] files=eachWindow.getFiles();
    for (int i=0; i < files.length - 1 + 1; i++) {
      VirtualFile eachFile=files[i];
      VirtualFile newFile=null;
      for (      EditorFileSwapper each : swappers) {
        newFile=each.getFileToSwapTo(myProject,eachFile);
      }
      if (newFile == null)       continue;
      if (eachWindow.findFileIndex(newFile) != -1)       continue;
      closeFile(eachFile,eachWindow);
      try {
        newFile.putUserData(EditorWindow.INITIAL_INDEX_KEY,i);
        openFile(newFile,eachFile == selected);
      }
  finally {
        newFile.putUserData(EditorWindow.INITIAL_INDEX_KEY,null);
      }
    }
  }
}
