{
  final boolean async=Registry.is("ide.windowSystem.asyncSplitters") && !syncUsage;
  final AsyncResult<EditorsSplitters> result=new AsyncResult<EditorsSplitters>();
  final IdeFocusManager fm=IdeFocusManager.getInstance(myProject);
  Runnable run=new Runnable(){
    @Override public void run(){
      if (myProject.isDisposed()) {
        result.setRejected();
        return;
      }
      Component focusOwner=async ? fm.getFocusOwner() : KeyboardFocusManager.getCurrentKeyboardFocusManager().getFocusOwner();
      if (focusOwner != null) {
        Set<EditorsSplitters> splitters=getAllSplitters();
        for (        EditorsSplitters each : splitters) {
          if (each == focusOwner || SwingUtilities.isDescendingFrom(focusOwner,each)) {
            result.setDone(each);
            return;
          }
        }
      }
      result.setDone(getMainSplitters());
    }
  }
;
  if (async) {
    fm.doWhenFocusSettlesDown(run);
  }
 else {
    run.run();
  }
  return result;
}
