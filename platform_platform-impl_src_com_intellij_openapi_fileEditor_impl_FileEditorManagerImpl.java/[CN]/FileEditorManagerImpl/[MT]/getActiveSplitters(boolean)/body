{
  final boolean async=Registry.is("ide.windowSystem.asyncSplitters") && !syncUsage;
  final AsyncResult<EditorsSplitters> result=new AsyncResult<EditorsSplitters>();
  final IdeFocusManager fm=IdeFocusManager.getInstance(myProject);
  Runnable run=new Runnable(){
    @Override public void run(){
      if (myProject.isDisposed()) {
        result.setRejected();
        return;
      }
      Component focusOwner=fm.getFocusOwner();
      if (focusOwner == null && !async) {
        focusOwner=KeyboardFocusManager.getCurrentKeyboardFocusManager().getFocusOwner();
      }
      if (focusOwner == null && !async) {
        focusOwner=fm.getLastFocusedFor(fm.getLastFocusedFrame());
      }
      DockContainer container=myDockManager.getContainerFor(focusOwner);
      if (container == null && !async) {
        focusOwner=KeyboardFocusManager.getCurrentKeyboardFocusManager().getActiveWindow();
        container=myDockManager.getContainerFor(focusOwner);
      }
      if (container instanceof DockableEditorTabbedContainer) {
        result.setDone(((DockableEditorTabbedContainer)container).getSplitters());
      }
 else {
        result.setDone(getMainSplitters());
      }
    }
  }
;
  if (async) {
    fm.doWhenFocusSettlesDown(run);
  }
 else {
    UIUtil.invokeAndWaitIfNeeded(run);
  }
  return result;
}
