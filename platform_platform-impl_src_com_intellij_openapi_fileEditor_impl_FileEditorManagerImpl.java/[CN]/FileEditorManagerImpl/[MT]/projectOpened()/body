{
  getMainSplitters().startListeningFocus();
  MessageBusConnection connection=myProject.getMessageBus().connect(myProject);
  final FileStatusManager fileStatusManager=FileStatusManager.getInstance(myProject);
  if (fileStatusManager != null) {
    final MyFileStatusListener myFileStatusListener=new MyFileStatusListener();
    fileStatusManager.addFileStatusListener(myFileStatusListener,myProject);
  }
  connection.subscribe(FileTypeManager.TOPIC,new MyFileTypeListener());
  connection.subscribe(ProjectTopics.PROJECT_ROOTS,new MyRootsListener());
  final MyVirtualFileListener myVirtualFileListener=new MyVirtualFileListener();
  VirtualFileManager.getInstance().addVirtualFileListener(myVirtualFileListener,myProject);
  final MyUISettingsListener myUISettingsListener=new MyUISettingsListener();
  UISettings.getInstance().addUISettingsListener(myUISettingsListener,myProject);
  StartupManager.getInstance(myProject).registerPostStartupActivity(new DumbAwareRunnable(){
    @Override public void run(){
      if (myProject.isDisposed())       return;
      setTabsMode(UISettings.getInstance().EDITOR_TAB_PLACEMENT != UISettings.TABS_NONE);
      ToolWindowManager.getInstance(myProject).invokeLater(new Runnable(){
        @Override public void run(){
          CommandProcessor.getInstance().executeCommand(myProject,new Runnable(){
            @Override public void run(){
              LaterInvocator.invokeLater(new Runnable(){
                @Override public void run(){
                  long currentTime=System.nanoTime();
                  Long startTime=myProject.getUserData(ProjectImpl.CREATION_TIME);
                  if (startTime != null) {
                    LOG.info("Project opening took " + (currentTime - startTime.longValue()) / 1000000 + " ms");
                    PluginManagerCore.dumpPluginClassStatistics();
                  }
                }
              }
,myProject.getDisposed());
            }
          }
,"",null);
        }
      }
);
    }
  }
);
}
