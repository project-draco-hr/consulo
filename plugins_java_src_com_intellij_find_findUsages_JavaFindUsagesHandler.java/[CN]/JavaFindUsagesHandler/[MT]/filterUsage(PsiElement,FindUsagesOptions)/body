{
  if (!(usage instanceof PsiJavaCodeReferenceElement)) {
    return true;
  }
  if (options instanceof JavaPackageFindUsagesOptions && !((JavaPackageFindUsagesOptions)options).isIncludeSubpackages && ((PsiReference)usage).resolve() instanceof PsiJavaPackage) {
    PsiElement parent=usage.getParent();
    if (parent instanceof PsiJavaCodeReferenceElement && ((PsiJavaCodeReferenceElement)parent).resolve() instanceof PsiJavaPackage) {
      return false;
    }
  }
  if (!(usage instanceof PsiReferenceExpression)) {
    if (options instanceof JavaFindUsagesOptions && ((JavaFindUsagesOptions)options).isSkipImportStatements) {
      PsiElement parent=usage.getParent();
      while (parent instanceof PsiJavaCodeReferenceElement) {
        parent=parent.getParent();
      }
      if (parent instanceof PsiImportStatement) {
        return false;
      }
    }
    if (options instanceof JavaPackageFindUsagesOptions && ((JavaPackageFindUsagesOptions)options).isSkipPackageStatements) {
      PsiElement parent=usage.getParent();
      while (parent instanceof PsiJavaCodeReferenceElement) {
        parent=parent.getParent();
      }
      if (parent instanceof PsiPackageStatement) {
        return false;
      }
    }
  }
  return true;
}
