{
  final Change leadSelection=myViewer.getLeadSelection();
  List<Change> changes=myViewer.getSelectedChanges();
  if (changes.size() < 2) {
    final Collection<Change> displayedChanges=getCurrentDisplayedChanges();
    changes=new ArrayList<Change>(displayedChanges);
  }
  int indexInSelection=changes.indexOf(leadSelection);
  if (indexInSelection >= 0) {
    Change[] changesArray=changes.toArray(new Change[changes.size()]);
    ShowDiffAction.showDiffForChange(changesArray,indexInSelection,myProject,myDiffExtendUIFactory,isInFrame());
  }
 else   if ((leadSelection == null && changes.size() > 0)) {
    Change[] changesArray=changes.toArray(new Change[changes.size()]);
    ShowDiffAction.showDiffForChange(changesArray,0,myProject,myDiffExtendUIFactory,isInFrame());
  }
 else   if (leadSelection != null) {
    ShowDiffAction.showDiffForChange(new Change[]{leadSelection},0,myProject,myDiffExtendUIFactory,isInFrame());
  }
}
