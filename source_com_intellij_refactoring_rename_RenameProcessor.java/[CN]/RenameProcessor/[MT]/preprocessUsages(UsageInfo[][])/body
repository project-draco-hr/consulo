{
  if (myDialog != null) {
    String[] conflicts=RenameUtil.getConflictDescriptions(usages[0]);
    if (conflicts.length > 0) {
      ConflictsDialog conflictsDialog=new ConflictsDialog(conflicts,myProject);
      conflictsDialog.show();
      if (!conflictsDialog.isOK()) {
        return false;
      }
    }
  }
  Set<UsageInfo> usagesSet=new HashSet<UsageInfo>(Arrays.asList(usages[0]));
  RenameUtil.removeConflictUsages(usagesSet);
  final List<UsageInfo> variableUsages=new ArrayList<UsageInfo>();
  if (!myRenamers.isEmpty()) {
    boolean isOK=findRenamedVariables(variableUsages);
    if (!isOK)     return false;
  }
  if (!variableUsages.isEmpty()) {
    usagesSet.addAll(variableUsages);
    usages[0]=usagesSet.toArray(new UsageInfo[usagesSet.size()]);
  }
  if (myDialog != null) {
    ToolWindowManager.getInstance(myProject).invokeLater(new Runnable(){
      public void run(){
        myDialog.close(DialogWrapper.CANCEL_EXIT_CODE);
      }
    }
);
  }
  return true;
}
