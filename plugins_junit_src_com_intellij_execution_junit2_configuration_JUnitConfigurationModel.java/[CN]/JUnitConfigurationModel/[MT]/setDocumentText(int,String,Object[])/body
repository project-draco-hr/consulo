{
  final Object document=documents[index];
  if (document instanceof PlainDocument) {
    try {
      ((PlainDocument)document).remove(0,((PlainDocument)document).getLength());
      ((PlainDocument)document).insertString(0,text,null);
    }
 catch (    BadLocationException e) {
      throw new RuntimeException(e);
    }
  }
 else {
    ApplicationManager.getApplication().runWriteAction(new Runnable(){
      public void run(){
        ((Document)document).replaceString(0,((Document)document).getTextLength(),text);
      }
    }
);
  }
}
