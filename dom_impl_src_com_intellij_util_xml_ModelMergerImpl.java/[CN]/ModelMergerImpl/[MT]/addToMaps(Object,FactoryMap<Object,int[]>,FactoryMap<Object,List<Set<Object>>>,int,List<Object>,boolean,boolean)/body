{
  final Object primaryKey=getPrimaryKey(o,singleValuedInvocation);
  if (primaryKey != null || singleValuedInvocation) {
    final List<Set<Object>> list=map.get(primaryKey);
    final int[] indices=counts.get(primaryKey);
    int objIndex=intersect ? indices[index] : indices[index]++;
    if (list.size() <= objIndex) {
      list.add(new LinkedHashSet<Object>());
    }
    list.get(objIndex).add(o);
    return false;
  }
  results.add(o);
  return true;
}
