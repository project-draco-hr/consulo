{
  int first=range.getOffset1() >= myDocument.getLineCount() ? myDocument.getTextLength() : myDocument.getLineStartOffset(range.getOffset1());
  int second=range.getOffset2() >= myDocument.getLineCount() ? myDocument.getTextLength() : myDocument.getLineStartOffset(range.getOffset2());
  RangeHighlighter highlighter=myDocument.getMarkupModel(myProject).addRangeHighlighter(first,second,HighlighterLayer.FIRST - 1,null,HighlighterTargetArea.LINES_IN_RANGE);
  myHighlighterCount++;
  TextAttributes attr=getAttributesFor(range);
  highlighter.setErrorStripeMarkColor(attr.getErrorStripeColor());
  highlighter.setThinErrorStripeMark(true);
  highlighter.setGreedyToLeft(true);
  highlighter.setGreedyToRight(true);
  highlighter.setLineMarkerRenderer(createRenderer(range));
  highlighter.setEditorFilter(MarkupEditorFilterFactory.createIsNotDiffFilter());
  highlighter.setErrorStripeTooltip("Line changed");
  return highlighter;
}
