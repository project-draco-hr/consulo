{
  if (task.isHeadless()) {
    task.run(new EmptyProgressIndicator());
    return;
  }
  if (task.isModal()) {
    runProcessWithProgressSynchronously(task.asModal());
  }
 else {
    final Task.Backgroundable backgroundable=task.asBackgroundable();
    if (backgroundable.isConditionalModal() && !backgroundable.shouldStartInBackground()) {
      runProcessWithProgressSynchronously(task);
    }
 else {
      runProcessWithProgressAsynchronously(backgroundable);
    }
  }
}
