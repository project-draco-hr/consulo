{
  LOG.assertTrue(process != null);
  Thread currentThread=Thread.currentThread();
  ProgressIndicator oldIndicator;
synchronized (this) {
    oldIndicator=myThreadToIndicatorMap.get(currentThread);
    if (progress != null) {
      myThreadToIndicatorMap.put(currentThread,progress);
    }
 else {
      myThreadToIndicatorMap.remove(currentThread);
    }
  }
synchronized (process) {
    process.notify();
  }
  try {
    if (progress != null && !progress.isRunning()) {
      progress.start();
    }
    process.run();
  }
  finally {
    if (progress != null && progress.isRunning()) {
      progress.stop();
    }
synchronized (this) {
      if (oldIndicator != null) {
        myThreadToIndicatorMap.put(currentThread,oldIndicator);
      }
 else {
        myThreadToIndicatorMap.remove(currentThread);
      }
    }
  }
}
