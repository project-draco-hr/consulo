{
  Thread currentThread=Thread.currentThread();
  ProgressIndicator oldIndicator;
  if (progress == null) {
    oldIndicator=myThreadToIndicatorMap.remove(currentThread);
  }
 else {
    oldIndicator=myThreadToIndicatorMap.put(currentThread,progress);
  }
synchronized (process) {
    process.notify();
  }
  try {
    if (progress != null && !progress.isRunning()) {
      progress.start();
    }
    process.run();
  }
  finally {
    if (progress != null && progress.isRunning()) {
      progress.stop();
    }
    if (oldIndicator == null) {
      myThreadToIndicatorMap.remove(currentThread);
    }
 else {
      myThreadToIndicatorMap.put(currentThread,oldIndicator);
    }
  }
}
