{
  final ProgressIndicator progressIndicator=new BackgroundableProcessIndicator(project,progressTitle,option,"Cancel","Stop \"" + progressTitle + "\"");
  Runnable action=new Runnable(){
    public void run(){
      boolean canceled=false;
      try {
        ProgressManager.getInstance().runProcess(process,progressIndicator);
      }
 catch (      ProcessCanceledException e) {
        canceled=true;
      }
      if (canceled && canceledRunnable != null) {
        ApplicationManager.getApplication().invokeLater(canceledRunnable,ModalityState.NON_MODAL);
      }
 else       if (!canceled && successRunnable != null) {
        ApplicationManager.getApplication().invokeLater(successRunnable,ModalityState.NON_MODAL);
      }
    }
  }
;
synchronized (process) {
    ApplicationManager.getApplication().executeOnPooledThread(action);
    try {
      process.wait();
    }
 catch (    InterruptedException e) {
      throw new RuntimeException(e);
    }
  }
}
