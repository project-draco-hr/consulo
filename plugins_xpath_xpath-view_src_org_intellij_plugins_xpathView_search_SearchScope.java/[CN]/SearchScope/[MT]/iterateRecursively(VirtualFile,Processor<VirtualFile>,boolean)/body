{
  VfsUtilCore.visitChildrenRecursively(virtualFile,new VirtualFileVisitor(recursive ? null : VirtualFileVisitor.ONE_LEVEL_DEEP){
    @Override public boolean visitFile(    @NotNull VirtualFile file){
      if (!file.isDirectory()) {
        processor.process(file);
      }
      return true;
    }
  }
);
}
