{
  PrintStream os=null;
  try {
    os=getErrorLogStream();
    StringBuffer buf=prepareMessage(message);
    System.err.println(buf.toString() + ": " + t.toString());
    os.println(buf.toString());
    t.printStackTrace(os);
  }
 catch (  IOException e) {
    System.err.println("Failed to write to error log file: " + e.toString());
    System.err.println("Initial stack trace: " + t.toString());
  }
 finally {
    if (os != null) {
      os.close();
    }
  }
}
