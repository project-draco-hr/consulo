{
  doTest(new PerformAction(){
    public void performAction(    final VirtualFile rootDir,    final VirtualFile rootAfter) throws Exception {
      PsiClass aClass=myJavaFacade.findClass("Test");
      if (aClass == null)       aClass=myJavaFacade.findClass("p.Test");
      assertNotNull("Class Test not found",aClass);
      final PsiField field=aClass.findFieldByName("myField",false);
      final Set<PsiMethod> methods=DelegationUtils.getDelegatingMethodsForField(field);
      List<MemberInfo> infos=new ArrayList<MemberInfo>();
      for (      PsiMethod method : methods) {
        final MemberInfo info=new MemberInfo(method);
        info.setChecked(true);
        info.setToAbstract(delete);
        infos.add(info);
      }
      RemoveMiddlemanProcessor processor=new RemoveMiddlemanProcessor(field,infos);
      processor.run();
      LocalFileSystem.getInstance().refresh(false);
      FileDocumentManager.getInstance().saveAllDocuments();
    }
  }
);
}
