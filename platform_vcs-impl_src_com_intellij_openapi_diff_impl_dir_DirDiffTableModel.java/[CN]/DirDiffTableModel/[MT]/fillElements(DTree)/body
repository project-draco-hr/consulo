{
  boolean separatorAdded=tree.getParent() == null;
  for (  DTree child : tree.getChildren()) {
    if (!child.isContainer()) {
      if (child.isVisible()) {
        if (!separatorAdded) {
          myElements.add(DirDiffElement.createDirElement(tree.getSource(),tree.getTarget(),tree.getPath()));
          separatorAdded=true;
        }
switch (child.getType()) {
case SOURCE:
          myElements.add(DirDiffElement.createSourceOnly(child.getSource()));
        break;
case TARGET:
      myElements.add(DirDiffElement.createTargetOnly(child.getTarget()));
    break;
case CHANGED:
  myElements.add(DirDiffElement.createChange(child.getSource(),child.getTarget()));
break;
case EQUAL:
myElements.add(DirDiffElement.createEqual(child.getSource(),child.getTarget()));
break;
}
}
}
 else {
fillElements(child);
}
}
}
