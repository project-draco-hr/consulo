{
  if (!myUpdating.get())   myUpdating.set(true);
  if (!getDecorator().isLoading()) {
    getDecorator().startLoading(false);
    if (updater == null) {
      updater=new Updater(getDecorator(),100);
      updater.start();
    }
  }
  ApplicationManager.getApplication().executeOnPooledThread(new Runnable(){
    public void run(){
      myTree.updateVisibility(mySettings);
      final ArrayList<DirDiffElement> elements=new ArrayList<DirDiffElement>();
      fillElements(myTree,elements);
      ApplicationManager.getApplication().invokeLater(new Runnable(){
        public void run(){
          clear();
          myElements.addAll(elements);
          myUpdating.set(false);
          fireTableDataChanged();
          DirDiffTableModel.this.text.set("");
          if (getDecorator().isLoading()) {
            getDecorator().stopLoading();
          }
        }
      }
);
    }
  }
);
}
