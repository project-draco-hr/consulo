{
  final SdkType sdkType=sdk.getSdkType();
  if (sdkType instanceof JavaSdk) {
    final String versionString=sdkType.getVersionString(sdk);
    try {
      final VirtualFile mainClassFile=JarFileSystem.getInstance().findFileByPath(ideaSdk.getHomePath() + "/lib/bootstrap.jar!/com/intellij/idea/Main.class");
      if (mainClassFile != null) {
        final BytePointer ptr=new BytePointer(mainClassFile.contentsToByteArray(),6);
        int majorVersion=ClsUtil.readU2(ptr);
        if (versionString != null) {
          if (majorVersion == 48 && versionString.contains("1.4")) {
            return true;
          }
          if (majorVersion == 49 && (versionString.contains("5.0") || versionString.contains("1.5"))) {
            return true;
          }
          if (majorVersion == 50 && versionString.contains("1.6")) {
            return true;
          }
        }
      }
    }
 catch (    IOException e) {
      return false;
    }
catch (    ClsFormatException e) {
      return false;
    }
  }
  return false;
}
