{
  final PsiFile mainRoot=getPsi(getBaseLanguage());
  PsiElement ret=null;
  for (  final Language language : getRelevantLanguages()) {
    if (!lang.isAssignableFrom(language.getClass()))     continue;
    final PsiFile psiRoot=getPsi(language);
    final PsiElement psiElement;
    psiElement=findElementAt(psiRoot,offset);
    if (psiElement == null || psiElement instanceof OuterLanguageElement)     continue;
    if (ret == null || psiRoot != mainRoot) {
      ret=psiElement;
    }
  }
  return ret;
}
