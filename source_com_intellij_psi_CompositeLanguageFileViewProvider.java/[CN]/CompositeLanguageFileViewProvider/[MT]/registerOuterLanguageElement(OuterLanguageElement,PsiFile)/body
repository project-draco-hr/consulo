{
  if (myRoots.get(root.getLanguage()) != root) {
    return;
  }
  final SoftReference<Set<OuterLanguageElement>> weakOuterElements=myOuterLanguageElements.get(root);
  Set<OuterLanguageElement> outerLanguageElements=weakOuterElements != null ? weakOuterElements.get() : null;
  if (outerLanguageElements == null) {
    outerLanguageElements=new TreeSet<OuterLanguageElement>(new Comparator<OuterLanguageElement>(){
      public int compare(      final OuterLanguageElement languageElement,      final OuterLanguageElement languageElement2){
        if (languageElement.equals(languageElement2))         return 0;
        final int result=languageElement.getTextRange().getStartOffset() - languageElement2.getTextRange().getStartOffset();
        if (result != 0)         return result;
        return languageElement.getTextRange().getEndOffset() - languageElement2.getTextRange().getEndOffset();
      }
    }
);
    myOuterLanguageElements.put(root,new SoftReference<Set<OuterLanguageElement>>(outerLanguageElements));
  }
  outerLanguageElements.add(element);
}
