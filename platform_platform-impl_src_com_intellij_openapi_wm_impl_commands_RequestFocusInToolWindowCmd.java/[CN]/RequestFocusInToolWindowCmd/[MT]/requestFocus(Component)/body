{
  ActionCallback result=new ActionCallback();
  final Component owner=KeyboardFocusManager.getCurrentKeyboardFocusManager().getPermanentFocusOwner();
  if (owner != null && owner == c) {
    myManager.getFocusManager().requestFocus(new FocusCommand(){
      public ActionCallback run(){
        return new ActionCallback.Done();
      }
    }
,myForced).doWhenProcessed(new Runnable(){
      public void run(){
        updateToolWindow(c);
      }
    }
).notify(result);
  }
 else {
    myManager.getFocusManager().requestFocus(new FocusCommand.ByComponent(c,myToolWindow.getComponent()),myForced).doWhenProcessed(new Runnable(){
      public void run(){
        updateToolWindow(c);
      }
    }
).notify(result);
  }
  return result;
}
