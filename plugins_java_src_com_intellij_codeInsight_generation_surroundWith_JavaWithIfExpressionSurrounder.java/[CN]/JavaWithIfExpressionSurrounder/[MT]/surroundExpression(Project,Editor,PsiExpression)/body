{
  PsiManager manager=expr.getManager();
  PsiElementFactory factory=JavaPsiFacade.getInstance(manager.getProject()).getElementFactory();
  CodeStyleManager codeStyleManager=CodeStyleManager.getInstance(project);
  @NonNls String text="if(a){\nst;\n}";
  PsiIfStatement ifStatement=(PsiIfStatement)factory.createStatementFromText(text,null);
  ifStatement=(PsiIfStatement)codeStyleManager.reformat(ifStatement);
  ifStatement.getCondition().replace(expr);
  PsiExpressionStatement statement=(PsiExpressionStatement)expr.getParent();
  ifStatement=(PsiIfStatement)statement.replace(ifStatement);
  PsiCodeBlock block=((PsiBlockStatement)ifStatement.getThenBranch()).getCodeBlock();
  block=CodeInsightUtilBase.forcePsiPostprocessAndRestoreElement(block);
  TextRange range=block.getStatements()[0].getTextRange();
  editor.getDocument().deleteString(range.getStartOffset(),range.getEndOffset());
  return new TextRange(range.getStartOffset(),range.getStartOffset());
}
