{
  super.update(e);
  final DataContext dataContext=e.getDataContext();
  final Project project=(Project)dataContext.getData(DataConstants.PROJECT);
  final Presentation presentation=e.getPresentation();
  if (presentation.isEnabled()) {
    final IdeView view=(IdeView)dataContext.getData(DataConstantsEx.IDE_VIEW);
    if (view != null) {
      final ProjectFileIndex projectFileIndex=ProjectRootManager.getInstance(project).getFileIndex();
      final PsiDirectory[] dirs=view.getDirectories();
      for (      final PsiDirectory dir : dirs) {
        if (projectFileIndex.isInSourceContent(dir.getVirtualFile()) && dir.getPackage() != null) {
          return;
        }
      }
    }
    presentation.setEnabled(false);
    presentation.setVisible(false);
  }
}
