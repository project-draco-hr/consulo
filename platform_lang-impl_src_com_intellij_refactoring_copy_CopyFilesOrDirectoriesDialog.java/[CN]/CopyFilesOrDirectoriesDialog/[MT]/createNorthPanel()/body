{
  JPanel panel=new JPanel(new GridBagLayout());
  panel.setBorder(IdeBorderFactory.createBorder());
  myInformationLabel=new JLabel();
  panel.add(myInformationLabel,new GridBagConstraints(0,0,2,1,1,0,GridBagConstraints.WEST,GridBagConstraints.HORIZONTAL,new Insets(4,8,4,8),0,0));
  DocumentListener documentListener=new DocumentAdapter(){
    public void textChanged(    DocumentEvent event){
      validateOKButton();
    }
  }
;
  if (myShowDirectoryField) {
    panel.add(new JLabel(RefactoringBundle.message("copy.files.to.directory.label")),new GridBagConstraints(0,1,1,1,0,0,GridBagConstraints.WEST,GridBagConstraints.HORIZONTAL,new Insets(4,8,4,8),0,0));
    final ComponentWithBrowseButton.BrowseFolderActionListener browseActionListener=new ComponentWithBrowseButton.BrowseFolderActionListener<JComboBox>(RefactoringBundle.message("select.target.directory"),RefactoringBundle.message("the.file.will.be.copied.to.this.directory"),null,myProject,FileChooserDescriptorFactory.createSingleFolderDescriptor(),TextComponentAccessor.STRING_COMBOBOX_WHOLE_TEXT);
    myTargetDirectoryField=new EditorComboWithBrowseButton(browseActionListener,"",myProject,RECENT_KEYS);
    myTargetDirectoryField.setTextFieldPreferredWidth(60);
    panel.add(myTargetDirectoryField,new GridBagConstraints(1,1,1,1,1,0,GridBagConstraints.WEST,GridBagConstraints.HORIZONTAL,new Insets(4,0,4,8),0,0));
    myTargetDirectoryField.getChildComponent().getDocument().addDocumentListener(new com.intellij.openapi.editor.event.DocumentAdapter(){
      @Override public void documentChanged(      com.intellij.openapi.editor.event.DocumentEvent e){
        validateOKButton();
      }
    }
);
  }
  if (myShowNewNameField) {
    myNewNameField=new JTextField();
    Dimension size=myNewNameField.getPreferredSize();
    FontMetrics fontMetrics=myNewNameField.getFontMetrics(myNewNameField.getFont());
    size.width=fontMetrics.charWidth('a') * 60;
    myNewNameField.setPreferredSize(size);
    panel.add(new JLabel(RefactoringBundle.message("copy.files.new.name.label")),new GridBagConstraints(0,2,1,1,0,0,GridBagConstraints.WEST,GridBagConstraints.HORIZONTAL,new Insets(4,8,4,8),0,0));
    panel.add(myNewNameField,new GridBagConstraints(1,2,1,1,1,0,GridBagConstraints.WEST,GridBagConstraints.HORIZONTAL,new Insets(4,0,4,8),0,0));
    myNewNameField.getDocument().addDocumentListener(documentListener);
  }
  return panel;
}
