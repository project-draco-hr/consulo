{
  JPanel panel=new JPanel(new GridBagLayout());
  myInformationLabel=new JLabel();
  panel.add(myInformationLabel,new GridBagConstraints(0,0,2,1,1,0,GridBagConstraints.WEST,GridBagConstraints.HORIZONTAL,new Insets(4,8,4,8),0,0));
  DocumentListener documentListener=new DocumentAdapter(){
    public void textChanged(    DocumentEvent event){
      validateOKButton();
    }
  }
;
  if (myShowNewNameField) {
    myNewNameField=new JTextField();
    Dimension size=myNewNameField.getPreferredSize();
    FontMetrics fontMetrics=myNewNameField.getFontMetrics(myNewNameField.getFont());
    size.width=fontMetrics.charWidth('a') * 60;
    myNewNameField.setPreferredSize(size);
    panel.add(new JLabel(RefactoringBundle.message("copy.files.new.name.label")),new GridBagConstraints(0,1,1,1,0,0,GridBagConstraints.WEST,GridBagConstraints.HORIZONTAL,new Insets(4,8,4,8),0,0));
    panel.add(myNewNameField,new GridBagConstraints(1,1,1,1,1,0,GridBagConstraints.WEST,GridBagConstraints.HORIZONTAL,new Insets(4,0,4,8),0,0));
    myNewNameField.getDocument().addDocumentListener(documentListener);
  }
  if (myShowDirectoryField) {
    panel.add(new JLabel(RefactoringBundle.message("copy.files.to.directory.label")),new GridBagConstraints(0,2,1,1,0,0,GridBagConstraints.WEST,GridBagConstraints.HORIZONTAL,new Insets(4,8,4,8),0,0));
    myTargetDirectoryField=new TextFieldWithHistoryWithBrowseButton();
    final List<String> recentEntries=RecentsManager.getInstance(myProject).getRecentEntries(RECENT_KEYS);
    if (recentEntries != null) {
      myTargetDirectoryField.getChildComponent().setHistory(recentEntries);
    }
    final FileChooserDescriptor descriptor=FileChooserDescriptorFactory.createSingleFolderDescriptor();
    myTargetDirectoryField.addBrowseFolderListener(RefactoringBundle.message("select.target.directory"),RefactoringBundle.message("the.file.will.be.copied.to.this.directory"),myProject,descriptor,TextComponentAccessor.TEXT_FIELD_WITH_HISTORY_WHOLE_TEXT);
    myTargetDirectoryField.setTextFieldPreferredWidth(60);
    panel.add(myTargetDirectoryField,new GridBagConstraints(1,2,1,1,1,0,GridBagConstraints.WEST,GridBagConstraints.HORIZONTAL,new Insets(4,0,2,8),0,0));
    myTargetDirectoryField.getChildComponent().addDocumentListener(new DocumentAdapter(){
      @Override protected void textChanged(      DocumentEvent e){
        validateOKButton();
      }
    }
);
    String shortcutText=KeymapUtil.getFirstKeyboardShortcutText(ActionManager.getInstance().getAction(IdeActions.ACTION_CODE_COMPLETION));
    final JLabel label=new JLabel(RefactoringBundle.message("path.completion.shortcut",shortcutText));
    UIUtil.applyStyle(UIUtil.ComponentStyle.MINI,label);
    panel.add(label,new GridBagConstraints(1,3,2,1,1,0,GridBagConstraints.WEST,GridBagConstraints.HORIZONTAL,new Insets(0,6,4,8),0,0));
  }
  return panel;
}
