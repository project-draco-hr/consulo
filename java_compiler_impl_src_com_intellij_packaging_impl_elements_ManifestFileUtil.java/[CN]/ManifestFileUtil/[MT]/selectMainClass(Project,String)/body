{
  final TreeClassChooserFactory chooserFactory=TreeClassChooserFactory.getInstance(project);
  final GlobalSearchScope searchScope=GlobalSearchScope.allScope(project);
  final PsiClass aClass=initialClassName != null ? JavaPsiFacade.getInstance(project).findClass(initialClassName,searchScope) : null;
  final TreeClassChooser chooser=chooserFactory.createWithInnerClassesScopeChooser("Select Main Class",searchScope,new MainClassFilter(),aClass);
  chooser.showDialog();
  return chooser.getSelectedClass();
}
