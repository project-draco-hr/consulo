{
  final VirtualFile metaInfDir=ArtifactUtil.findSourceFileByOutputPath(root,MANIFEST_DIR_NAME,context,artifactType);
  if (metaInfDir != null) {
    return metaInfDir.getPath() + "/" + MANIFEST_FILE_NAME;
  }
  final Ref<VirtualFile> sourceDir=Ref.create(null);
  final Ref<VirtualFile> sourceFile=Ref.create(null);
  ArtifactUtil.processElements(root.getChildren(),context,artifactType,new Processor<PackagingElement<?>>(){
    public boolean process(    PackagingElement<?> element){
      if (element instanceof FileCopyPackagingElement) {
        final VirtualFile file=((FileCopyPackagingElement)element).findFile();
        if (file != null) {
          if (file.isDirectory()) {
            sourceDir.set(file);
            return false;
          }
          sourceFile.set(file);
        }
      }
      return true;
    }
  }
);
  if (!sourceDir.isNull()) {
    return sourceDir.get().getPath() + "/" + MANIFEST_PATH;
  }
  final Project project=context.getProject();
  final VirtualFile dir=suggestBaseDir(project,sourceFile.get());
  String filePath=dir.getPath() + "/" + MANIFEST_PATH;
  PackagingElementFactory.getInstance().addFileCopy(root,MANIFEST_DIR_NAME,filePath);
  return filePath;
}
