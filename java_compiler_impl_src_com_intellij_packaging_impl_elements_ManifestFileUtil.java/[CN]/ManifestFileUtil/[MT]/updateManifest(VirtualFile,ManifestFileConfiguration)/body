{
  final Manifest manifest=readManifest(file);
  final Attributes mainAttributes=manifest.getMainAttributes();
  final String mainClass=configuration.getMainClass();
  if (mainClass != null) {
    mainAttributes.put(Attributes.Name.MAIN_CLASS,mainClass);
  }
 else {
    mainAttributes.remove(Attributes.Name.MAIN_CLASS);
  }
  final List<String> classpath=configuration.getClasspath();
  if (classpath != null && !classpath.isEmpty()) {
    mainAttributes.put(Attributes.Name.CLASS_PATH,StringUtil.join(classpath," "));
  }
 else {
    mainAttributes.remove(Attributes.Name.CLASS_PATH);
  }
  ManifestBuilder.setVersionAttribute(mainAttributes);
  try {
    final OutputStream outputStream=file.getOutputStream(ManifestFileUtil.class);
    try {
      manifest.write(outputStream);
    }
  finally {
      outputStream.close();
    }
  }
 catch (  IOException e) {
    LOG.info(e);
  }
}
