{
  final Project project=(Project)dataContext.getData(DataConstants.PROJECT);
  final FileEditor editor=(FileEditor)dataContext.getData(DataConstants.FILE_EDITOR);
  if (project == null || editor == null)   return null;
  VirtualFile file=FileEditorManagerEx.getInstanceEx(project).getFile(editor);
  if (file == null)   return null;
  final PsiFile psiFile=PsiManager.getInstance(project).findFile(file);
  if (psiFile == null)   return null;
  if (editor instanceof TextEditor) {
    return new TextEditorContext((TextEditor)editor,psiFile);
  }
 else {
    return new SimpleContext(new ComponentCenterLocation(editor.getComponent()),psiFile);
  }
}
