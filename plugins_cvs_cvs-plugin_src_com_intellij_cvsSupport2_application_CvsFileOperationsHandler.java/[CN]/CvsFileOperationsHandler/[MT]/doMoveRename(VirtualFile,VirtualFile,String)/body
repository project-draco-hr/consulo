{
  if (!CvsUtil.fileIsUnderCvs(file))   return false;
  if (newParent == null)   return false;
  final File newFile=new File(newParent.getPath(),newName);
  myComponent.getDeleteHandler().addDeletedRoot(file);
  if (!file.isDirectory()) {
    myComponent.getAddHandler().addFile(newFile);
    return false;
  }
  newFile.mkdir();
  copyDirectoryStructure(file,newFile);
  myComponent.getAddHandler().addFile(newFile);
  final DocumentReference ref=DocumentReferenceManager.getInstance().create(file);
  UndoManager.getInstance(myProject).nonundoableActionPerformed(ref,false);
  return true;
}
