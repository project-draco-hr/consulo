{
  KeyboardFocusManager mgr=KeyboardFocusManager.getCurrentKeyboardFocusManager();
  Component eachComponent=mgr.getFocusOwner();
  ToolWindowScrollable scrollable=null;
  while (eachComponent != null) {
    if (!SwingUtilities.isDescendingFrom(eachComponent,wnd.getComponent()))     break;
    if (eachComponent instanceof ToolWindowScrollable) {
      ToolWindowScrollable eachScrollable=(ToolWindowScrollable)eachComponent;
      if (isHorizontalStretchingOffered) {
        if (eachScrollable.isHorizontalScrollingNeeded()) {
          scrollable=eachScrollable;
          break;
        }
      }
 else {
        if (eachScrollable.isVerticalScrollingNeeded()) {
          scrollable=eachScrollable;
          break;
        }
      }
    }
    eachComponent=eachComponent.getParent();
  }
  if (scrollable == null) {
    scrollable=new DefaultToolWindowScrollable();
  }
  if (isHorizontalStretchingOffered && scrollable.isHorizontalScrollingNeeded())   return scrollable;
  if (!isHorizontalStretchingOffered && scrollable.isVerticalScrollingNeeded())   return scrollable;
  return null;
}
