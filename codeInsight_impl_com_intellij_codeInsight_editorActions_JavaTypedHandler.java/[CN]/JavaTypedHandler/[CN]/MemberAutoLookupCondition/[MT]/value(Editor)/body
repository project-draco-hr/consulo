{
  final Project project=editor.getProject();
  if (project == null)   return false;
  PsiFile file=PsiDocumentManager.getInstance(project).getPsiFile(editor.getDocument());
  if (file == null)   return false;
  int offset=editor.getCaretModel().getOffset();
  PsiElement lastElement=file.findElementAt(offset - 1);
  if (lastElement == null) {
    return false;
  }
  final PsiElement prevSibling=lastElement.getPrevSibling();
  if (prevSibling == null || ".".equals(prevSibling.getText()))   return false;
  PsiElement parent=prevSibling;
  do {
    parent=parent.getParent();
  }
 while (parent instanceof PsiJavaCodeReferenceElement || parent instanceof PsiTypeElement);
  if (parent instanceof PsiParameterList)   return false;
  if (!".".equals(lastElement.getText()) && !"#".equals(lastElement.getText())) {
    return false;
  }
 else {
    final PsiElement element=file.findElementAt(offset);
    if (element != null && "#".equals(lastElement.getText()) && !new SuperParentFilter(new ClassFilter(PsiDocComment.class)).isAcceptable(element,element.getParent())) {
      return false;
    }
    return true;
  }
}
