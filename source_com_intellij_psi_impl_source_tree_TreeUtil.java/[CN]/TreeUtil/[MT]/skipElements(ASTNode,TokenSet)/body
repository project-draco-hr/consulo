{
  while (true) {
    if (element == null)     return null;
    if (element.getElementType() != ElementType.REFORMAT_MARKER && !types.contains(element.getElementType()))     break;
    element=element.getTreeNext();
  }
  return element;
}
