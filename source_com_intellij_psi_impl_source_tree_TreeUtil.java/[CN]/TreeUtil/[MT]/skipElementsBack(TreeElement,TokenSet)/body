{
  while (true) {
    if (element == null)     return null;
    if (!types.isInSet(element.getElementType()))     break;
    element=element.getTreePrev();
  }
  return element;
}
