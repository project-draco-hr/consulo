{
  if (DebugUtil.CHECK_INSIDE_ATOMIC_ACTION_ENABLED) {
    ApplicationManager.getApplication().assertReadAccessAllowed();
  }
  for (TreeElement element=parent.lastChild; element != null; element=element.getTreePrev()) {
    if (types.isInSet(element.getElementType()))     return element;
  }
  return null;
}
