{
  final LookupElement item=(LookupElement)value;
  Color background=isSelected ? SELECTED_BACKGROUND_COLOR : BACKGROUND_COLOR;
  final Color foreground=isSelected ? SELECTED_FOREGROUND_COLOR : FOREGROUND_COLOR;
  final int preferredCount=myLookup.getPreferredItemsCount();
  if (index <= preferredCount - 1 && preferredCount < list.getModel().getSize() - 1) {
    background=isSelected ? SELECTED_BACKGROUND_COLOR : new Color(220,245,220);
  }
  myLookupElementPresentation.setContext(item,background,foreground,list,isSelected);
  myNameComponent.clear();
  myLabel2.setBackground(background);
  myLabel2.setText(null);
  myLabel3.setText(null);
  myLabel4.setIcon(myLookup.getActionsFor(item).isEmpty() ? PopupIcons.EMPTY_ICON : PopupIcons.HAS_NEXT_ICON_GRAYED);
  myLabel4.setBackground(background);
  myLabel4.setForeground(foreground);
  myNameComponent.setIcon(myEmptyIcon);
  item.renderElement(myLookupElementPresentation);
  return myPanel;
}
