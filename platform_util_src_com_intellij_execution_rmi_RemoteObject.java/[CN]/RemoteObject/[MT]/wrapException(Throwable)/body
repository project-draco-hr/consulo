{
  boolean foreignException=false;
  Throwable each=ex;
  while (each != null) {
    if (!each.getClass().getName().startsWith("java") && !isKnownException(each)) {
      foreignException=true;
      break;
    }
    each=each.getCause();
  }
  if (foreignException) {
    Throwable wrapper=new Throwable(ex.toString());
    wrapper.setStackTrace(ex.getStackTrace());
    ex=wrapper;
  }
  return ex;
}
