{
  int start=0;
  boolean asBytes=forAddition && IOUtil.isAscii(path);
  List<SubstringWrapper> key=new ArrayList<SubstringWrapper>();
  SubstringWrapper flyweightKey=new SubstringWrapper();
  while (start < path.length()) {
    flyweightKey.findSubStringUntilNextSeparator(path,start);
    SubstringWrapper interned=myInternMap.get(flyweightKey);
    if (interned == null) {
      if (!forAddition) {
        return null;
      }
      myInternMap.add(interned=flyweightKey.createPersistentCopy(asBytes));
    }
    key.add(interned);
    start+=flyweightKey.len;
  }
  return key.toArray(new SubstringWrapper[key.size()]);
}
