{
  if (psiElement instanceof PsiReturnStatement) {
    PsiReturnStatement retStatement=(PsiReturnStatement)psiElement;
    if (retStatement.getReturnValue() != null && startLine(editor,retStatement) == startLine(editor,retStatement.getReturnValue())) {
      return;
    }
    PsiElement parent=PsiTreeUtil.getParentOfType(psiElement,PsiClassInitializer.class,PsiMethod.class);
    if (parent instanceof PsiMethod) {
      PsiMethod method=(PsiMethod)parent;
      final PsiType returnType=method.getReturnType();
      if (returnType != null && returnType != PsiType.VOID) {
        final int startOffset=retStatement.getTextRange().getStartOffset();
        if (retStatement.getReturnValue() != null) {
          editor.getDocument().insertString(startOffset + "return".length(),";");
        }
        processor.registerUnresolvedError(startOffset + "return".length());
      }
    }
  }
}
