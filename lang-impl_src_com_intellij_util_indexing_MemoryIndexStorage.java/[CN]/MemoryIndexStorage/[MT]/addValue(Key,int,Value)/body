{
  if (!myBufferingEnabled) {
    myBackendStorage.addValue(key,inputId,value);
    return;
  }
  ValueContainerImpl<Value> valueContainer=myMap.get(key);
  if (valueContainer == null) {
    if (myRemovedKeys.contains(key)) {
      myRemovedKeys.remove(key);
      valueContainer=new ValueContainerImpl<Value>();
    }
 else {
      final ValueContainer<Value> backendContainer=myBackendStorage.read(key);
      valueContainer=backendContainer != null ? copyOf(backendContainer) : new ValueContainerImpl<Value>();
    }
    myMap.put(key,valueContainer);
  }
  valueContainer.addValue(inputId,value);
}
