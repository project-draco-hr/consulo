{
  LOG.debug("Error: " + errorMessage);
  FileDownloadingListener[] listeners;
synchronized (myLock) {
    myLocalVirtualFile=null;
    myPrevLocalFile=null;
    myState=RemoteFileState.ERROR_OCCURRED;
    myErrorMessage=errorMessage;
    listeners=myListeners.toArray(new FileDownloadingListener[myListeners.size()]);
  }
  for (  FileDownloadingListener listener : listeners) {
    if (!cancelled) {
      listener.errorOccurred(errorMessage);
    }
  }
}
