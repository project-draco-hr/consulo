{
  final MockApplicationEx instance=new MockApplicationEx(getTestRootDisposable());
  ApplicationManager.setApplication(instance,new Getter<FileTypeRegistry>(){
    @Override public FileTypeRegistry get(){
      return FileTypeManager.getInstance();
    }
  }
,new Getter<EncodingRegistry>(){
    @Override public EncodingRegistry get(){
      return EncodingManager.getInstance();
    }
  }
,getTestRootDisposable());
  getApplication().registerService(EncodingManager.class,EncodingManagerImpl.class);
}
