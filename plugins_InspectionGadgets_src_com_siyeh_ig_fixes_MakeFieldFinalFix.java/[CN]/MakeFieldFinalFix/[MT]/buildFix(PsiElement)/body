{
  final PsiField field;
  if (location instanceof PsiReferenceExpression) {
    final PsiReferenceExpression referenceExpression=(PsiReferenceExpression)location;
    final PsiElement target=referenceExpression.resolve();
    if (!(target instanceof PsiField)) {
      return null;
    }
    field=(PsiField)target;
  }
 else {
    final PsiElement parent=location.getParent();
    if (!(parent instanceof PsiField)) {
      return null;
    }
    field=(PsiField)parent;
  }
  if (field.hasModifierProperty(PsiModifier.STATIC)) {
    if (!canStaticFieldBeFinal(field)) {
      return null;
    }
  }
 else   if (!canInstanceFieldBeFinal(field)) {
    return null;
  }
  final String name=field.getName();
  return new MakeFieldFinalFix(name);
}
