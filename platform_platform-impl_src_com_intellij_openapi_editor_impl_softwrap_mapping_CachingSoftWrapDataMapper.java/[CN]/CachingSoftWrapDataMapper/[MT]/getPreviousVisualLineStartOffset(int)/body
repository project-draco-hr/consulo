{
  Document document=myEditor.getDocument();
  int cacheIndex=MappingUtil.getCacheEntryIndexForOffset(offset,document,myCache);
  if (cacheIndex < 0) {
    return document.getLineStartOffset(document.getLineNumber(offset));
  }
 else   if (cacheIndex == 0) {
    return myCache.get(cacheIndex).startOffset;
  }
 else {
    CacheEntry thisEntry=myCache.get(cacheIndex);
    CacheEntry prevEntry=myCache.get(cacheIndex - 1);
    return thisEntry.startOffset == prevEntry.endOffset ? prevEntry.startOffset : thisEntry.startOffset;
  }
}
