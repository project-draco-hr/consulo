{
  reset();
  endOffset=range.getEndOffset();
  int startIndex=MappingUtil.getCacheEntryIndexForOffset(range.getStartOffset(),myEditor.getDocument(),myCache);
  if (startIndex < 0) {
    return;
  }
  valid=true;
  endCacheEntryIndex=MappingUtil.getCacheEntryIndexForOffset(endOffset,myEditor.getDocument(),myCache);
  visualLines=endCacheEntryIndex - startIndex + 1;
  CacheEntry startEntry=myCache.get(startIndex);
  CacheEntry endEntry=myCache.get(endCacheEntryIndex);
  logicalLines=endEntry.endLogicalLine - startEntry.startLogicalLine + 1;
  foldedLines=endEntry.endFoldedLines - startEntry.startFoldedLines;
  softWrapLines=endEntry.endSoftWrapLinesBefore + endEntry.endSoftWrapLinesCurrent - startEntry.startSoftWrapLinesBefore - startEntry.startSoftWrapLinesCurrent;
}
