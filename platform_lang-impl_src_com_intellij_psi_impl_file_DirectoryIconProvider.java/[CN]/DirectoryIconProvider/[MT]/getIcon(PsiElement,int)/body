{
  if (element instanceof PsiDirectory) {
    final PsiDirectory psiDirectory=(PsiDirectory)element;
    final VirtualFile vFile=psiDirectory.getVirtualFile();
    boolean inTestSource=ProjectRootsUtil.isInTestSource(vFile,psiDirectory.getProject());
    boolean isSourceOrTestRoot=ProjectRootsUtil.isSourceOrTestRoot(vFile,psiDirectory.getProject());
    final boolean isOpen=(flags & Iconable.ICON_FLAG_OPEN) != 0;
    if (isSourceOrTestRoot) {
      return IconSet.getSourceRootIcon(inTestSource,isOpen);
    }
 else {
      return isOpen ? Icons.DIRECTORY_OPEN_ICON : Icons.DIRECTORY_CLOSED_ICON;
    }
  }
  return null;
}
