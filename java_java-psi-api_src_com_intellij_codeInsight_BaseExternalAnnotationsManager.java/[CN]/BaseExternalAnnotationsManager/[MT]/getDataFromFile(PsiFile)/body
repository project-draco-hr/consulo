{
  if (annotationsFileToData.containsKey(file) && file.getModificationStamp() == annotationsFileToModificationStamp.get(file)) {
    return annotationsFileToData.get(file);
  }
 else {
    MultiMap<String,AnnotationData> data=new MultiMap<String,AnnotationData>();
    annotationsFileToData.put(file,data);
    annotationsFileToModificationStamp.put(file,file.getModificationStamp());
    Document document;
    try {
      VirtualFile virtualFile=file.getVirtualFile();
      if (virtualFile == null)       return data;
      document=JDOMUtil.loadDocument(escapeAttributes(StreamUtil.readText(virtualFile.getInputStream())));
    }
 catch (    IOException e) {
      LOG.error(e);
      return data;
    }
catch (    JDOMException e) {
      LOG.error(e);
      return data;
    }
    Element rootElement=document.getRootElement();
    if (rootElement == null)     return data;
    for (    Element element : (List<Element>)rootElement.getChildren()) {
      String ownerName=element.getAttributeValue("name");
      if (ownerName == null)       continue;
      for (      Element annotationElement : (List<Element>)element.getChildren()) {
        String annotationFQN=annotationElement.getAttributeValue("name");
        StringBuilder buf=new StringBuilder();
        for (        Element annotationParameter : (List<Element>)annotationElement.getChildren()) {
          buf.append(",");
          String nameValue=annotationParameter.getAttributeValue("name");
          if (nameValue != null) {
            buf.append(nameValue).append("=");
          }
          buf.append(annotationParameter.getAttributeValue("val"));
        }
        String annotationText="@" + annotationFQN + (buf.length() > 0 ? "(" + StringUtil.trimStart(buf.toString(),",") + ")" : "");
        data.putValue(ownerName,new AnnotationData(annotationFQN,annotationText));
      }
    }
    return data;
  }
}
