{
  final List<PsiFile> files=findExternalAnnotationsFiles(listOwner);
  if (files == null) {
    return Collections.emptyMap();
  }
  Map<String,PsiAnnotation> result=new THashMap<String,PsiAnnotation>();
  String externalName=getExternalName(listOwner,false);
  String oldExternalName=getNormalizedExternalName(listOwner);
  final PsiElementFactory factory=JavaPsiFacade.getInstance(myPsiManager.getProject()).getElementFactory();
  for (  PsiFile file : files) {
    if (!file.isValid())     continue;
    if (onlyWritable && !file.isWritable())     continue;
    final MultiMap<String,AnnotationData> fileData=getDataFromFile(file);
    collectAnnotations(result,fileData.get(externalName),factory);
    collectAnnotations(result,fileData.get(oldExternalName),factory);
  }
  return result;
}
