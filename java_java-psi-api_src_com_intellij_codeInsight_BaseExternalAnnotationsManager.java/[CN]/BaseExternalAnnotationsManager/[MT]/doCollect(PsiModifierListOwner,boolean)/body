{
  final List<PsiFile> files=findExternalAnnotationsFiles(listOwner);
  if (files == null) {
    return Collections.emptyMap();
  }
  Map<String,PsiAnnotation> result=new THashMap<String,PsiAnnotation>();
  String externalName=getExternalName(listOwner,false);
  String oldExternalName=getNormalizedExternalName(listOwner);
  for (  PsiFile file : files) {
    if (!file.isValid())     continue;
    if (onlyWritable && !file.isWritable())     continue;
    MultiMap<String,AnnotationData> fileData=getDataFromFile(file);
    for (    AnnotationData annotationData : ContainerUtil.concat(fileData.get(externalName),fileData.get(oldExternalName))) {
      if (result.containsKey(annotationData.annotationClassFqName))       continue;
      try {
        PsiElementFactory factory=JavaPsiFacade.getInstance(myPsiManager.getProject()).getElementFactory();
        PsiAnnotation annotation=factory.createAnnotationFromText(annotationData.annotationText,null);
        result.put(annotationData.annotationClassFqName,annotation);
      }
 catch (      IncorrectOperationException e) {
        LOG.error(e);
      }
    }
  }
  return result;
}
