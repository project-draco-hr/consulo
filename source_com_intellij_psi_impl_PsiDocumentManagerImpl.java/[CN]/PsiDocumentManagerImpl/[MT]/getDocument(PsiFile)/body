{
  if (file instanceof PsiBinaryFile)   return null;
  Document document=getCachedDocument(file);
  if (document != null)   return document;
  if (!file.getViewProvider().isEventSystemEnabled())   return null;
  document=FileDocumentManager.getInstance().getDocument(file.getViewProvider().getVirtualFile());
  if (!file.getViewProvider().isPhysical()) {
    document.putUserData(HARD_REF_TO_PSI,file);
  }
  fireDocumentCreated(document,file);
  return document;
}
