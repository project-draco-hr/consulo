{
  ApplicationManager.getApplication().runWriteAction(new CommitToPsiFileAction(){
    public void run(){
      if (!isUncommited(document))       return;
      myUncommittedDocuments.remove(document);
      final PsiFile file=getCachedPsiFile(document);
      if (file == null || !file.isValid())       return;
      commit(document,file);
    }
  }
);
}
