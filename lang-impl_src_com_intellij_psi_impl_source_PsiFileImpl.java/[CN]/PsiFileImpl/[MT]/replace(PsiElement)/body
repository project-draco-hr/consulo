{
  CompositeElement treeElement=calcTreeElement();
  LOG.assertTrue(treeElement.getTreeParent() != null);
  CheckUtil.checkWritable(this);
  TreeElement elementCopy=ChangeUtil.copyToElement(newElement);
  treeElement.getTreeParent().replaceChildInternal(treeElement,elementCopy);
  elementCopy=ChangeUtil.decodeInformation(elementCopy);
  return SourceTreeToPsiMap.treeElementToPsi(elementCopy);
}
