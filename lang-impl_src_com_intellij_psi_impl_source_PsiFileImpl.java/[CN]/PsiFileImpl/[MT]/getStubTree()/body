{
synchronized (myStubLock) {
    StubTree stubHolder=derefStub();
    if (stubHolder == null) {
      if (getTreeElementNoLock() == null) {
        final VirtualFile vFile=getVirtualFile();
        stubHolder=StubTree.readFromVFile(vFile);
        if (stubHolder != null) {
          myStub=new WeakReference<StubTree>(stubHolder);
          StubBase<PsiFile> base=(StubBase)stubHolder.getRoot();
          base.setPsi(this);
        }
      }
    }
    return stubHolder;
  }
}
