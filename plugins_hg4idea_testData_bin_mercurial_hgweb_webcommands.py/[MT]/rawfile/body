def rawfile(web, req, tmpl):
    path = webutil.cleanpath(web.repo, req.form.get('file', [''])[0])
    if (not path):
        content = manifest(web, req, tmpl)
        req.respond(HTTP_OK, web.ctype)
        return content
    try:
        fctx = webutil.filectx(web.repo, req)
    except error.LookupError as inst:
        try:
            content = manifest(web, req, tmpl)
            req.respond(HTTP_OK, web.ctype)
            return content
        except ErrorResponse:
            raise inst
    path = fctx.path()
    text = fctx.data()
    mt = mimetypes.guess_type(path)[0]
    if (mt is None):
        mt = ((binary(text) and 'application/octet-stream') or 'text/plain')
    req.respond(HTTP_OK, mt, path, len(text))
    return [text]
