{
  List<UsageInfo> usages=new ArrayList<UsageInfo>();
  String newName=myTargetClass.getQualifiedName() + "." + myClassToMove.getName();
  Collections.addAll(usages,MoveClassesOrPackagesUtil.findUsages(myClassToMove,mySearchInComments,mySearchInNonJavaFiles,newName));
  for (Iterator<UsageInfo> iterator=usages.iterator(); iterator.hasNext(); ) {
    UsageInfo usageInfo=iterator.next();
    if (!(usageInfo instanceof NonCodeUsageInfo) && PsiTreeUtil.isAncestor(myClassToMove,usageInfo.getElement(),false)) {
      iterator.remove();
    }
  }
  return usages.toArray(new UsageInfo[usages.size()]);
}
