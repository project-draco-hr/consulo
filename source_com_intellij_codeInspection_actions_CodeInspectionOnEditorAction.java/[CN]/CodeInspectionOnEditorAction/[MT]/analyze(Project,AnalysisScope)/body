{
  FileDocumentManager.getInstance().saveAllDocuments();
  final InspectionManagerEx inspectionManagerEx=(InspectionManagerEx)InspectionManager.getInstance(project);
  inspectionManagerEx.setCurrentScope(scope);
  final InspectionProfileImpl inspectionProfile=DaemonCodeAnalyzerSettings.getInstance().getInspectionProfile();
  inspectionProfile.getInspectionTools(project);
  inspectionManagerEx.setExternalProfile(inspectionProfile);
  inspectionManagerEx.doInspections(scope,false);
  ApplicationManager.getApplication().invokeLater(new Runnable(){
    public void run(){
      inspectionManagerEx.setExternalProfile(null);
    }
  }
);
}
