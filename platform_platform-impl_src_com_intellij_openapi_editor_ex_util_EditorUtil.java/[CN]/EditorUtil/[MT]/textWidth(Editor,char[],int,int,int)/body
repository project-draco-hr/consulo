{
  int result=0;
  for (int i=start; i < end; i++) {
    char c=text[i];
    if (c != '\t') {
      FontInfo font=fontForChar(c,fontType,editor);
      result+=font.charWidth(c,editor.getContentComponent());
      continue;
    }
    if (editor.getSettings().isWhitespacesShown()) {
      result+=getTabSize(editor) * getSpaceWidth(fontType,editor);
    }
 else {
      result+=getSpaceWidth(fontType,editor);
    }
  }
  return result;
}
