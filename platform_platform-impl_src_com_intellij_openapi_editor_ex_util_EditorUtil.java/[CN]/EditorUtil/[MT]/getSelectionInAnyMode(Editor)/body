{
  SelectionModel selection=editor.getSelectionModel();
  int[] starts=selection.getBlockSelectionStarts();
  int[] ends=selection.getBlockSelectionEnds();
  int start=starts.length > 0 ? starts[0] : selection.getSelectionStart();
  int end=ends.length > 0 ? ends[ends.length - 1] : selection.getSelectionEnd();
  return TextRange.create(start,end);
}
