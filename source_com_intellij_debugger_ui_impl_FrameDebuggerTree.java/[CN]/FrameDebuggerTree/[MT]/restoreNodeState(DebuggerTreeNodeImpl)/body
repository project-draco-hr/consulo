{
  if (myAnyNewLocals) {
    node.getDescriptor().myIsSelected=node.getDescriptor().myIsSelected && node.getDescriptor() instanceof LocalVariableDescriptorImpl;
  }
  super.restoreNodeState(node);
  if (myAnyNewLocals && node.getDescriptor().myIsExpanded) {
    DebuggerTreeNodeImpl root=(DebuggerTreeNodeImpl)getMutableModel().getRoot();
    DebuggerTreeNodeImpl lastSelected=null;
    for (Enumeration<DebuggerTreeNodeImpl> children=root.children(); children.hasMoreElements(); ) {
      DebuggerTreeNodeImpl child=children.nextElement();
      if (child.getDescriptor().myIsSelected) {
        lastSelected=child;
      }
    }
    if (lastSelected != null) {
      scrollPathToVisible(new TreePath(lastSelected.getPath()));
    }
  }
}
