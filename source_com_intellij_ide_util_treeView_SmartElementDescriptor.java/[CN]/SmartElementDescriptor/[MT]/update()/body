{
  myElement=mySmartPointer.getElement();
  if (myElement == null)   return true;
  int flags=Iconable.ICON_FLAG_VISIBILITY;
  if (isMarkReadOnly()) {
    flags|=Iconable.ICON_FLAG_READ_STATUS;
  }
  Icon icon=myElement.getIcon(flags);
  Color color=null;
  if (isMarkModified()) {
    VirtualFile virtualFile=PsiUtil.getVirtualFile(myElement);
    if (virtualFile != null) {
      color=FileStatusManager.getInstance(myProject).getStatus(virtualFile).getColor();
    }
  }
  if (CopyPasteManager.getInstance().isCutElement(myElement)) {
    color=CopyPasteManager.CUT_COLOR;
  }
  boolean changes=!Comparing.equal(icon,myOpenIcon) || !Comparing.equal(color,myColor);
  myOpenIcon=icon;
  myClosedIcon=myOpenIcon;
  myColor=color;
  return changes;
}
