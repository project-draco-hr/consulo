{
  ParameterizedCachedValue<T,P> value;
  if (dataHolder instanceof UserDataHolderEx) {
    UserDataHolderEx dh=(UserDataHolderEx)dataHolder;
    value=dh.getUserData(key);
    if (value == null) {
      value=createParameterizedCachedValue(provider,trackValue);
      value=dh.putUserDataIfAbsent(key,value);
    }
  }
 else {
synchronized (dataHolder) {
      value=dataHolder.getUserData(key);
      if (value == null) {
        value=createParameterizedCachedValue(provider,trackValue);
        dataHolder.putUserData(key,value);
      }
    }
  }
  return value.getValue(parameter);
}
