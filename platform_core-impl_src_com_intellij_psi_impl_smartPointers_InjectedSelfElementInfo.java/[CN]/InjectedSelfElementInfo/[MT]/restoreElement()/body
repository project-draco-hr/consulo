{
  PsiFile hostFile=myHostContext.getContainingFile();
  if (hostFile == null || !hostFile.isValid())   return null;
  PsiElement hostContext=myHostContext.getElement();
  if (hostContext == null)   return null;
  Segment segment=myInjectedFileRangeInHostFile.getRange();
  if (segment == null)   return null;
  final TextRange rangeInHostFile=TextRange.create(segment);
  PsiElement result=null;
  PsiFile injectedPsi=getInjectedFileIn(hostContext,hostFile,rangeInHostFile);
  if (injectedPsi != null) {
    Document document=PsiDocumentManager.getInstance(getProject()).getDocument(injectedPsi);
    int start=((DocumentWindow)document).hostToInjected(rangeInHostFile.getStartOffset());
    int end=((DocumentWindow)document).hostToInjected(rangeInHostFile.getEndOffset());
    result=SelfElementInfo.findElementInside(injectedPsi,start,end,anchorClass,anchorLanguage);
  }
  return result;
}
