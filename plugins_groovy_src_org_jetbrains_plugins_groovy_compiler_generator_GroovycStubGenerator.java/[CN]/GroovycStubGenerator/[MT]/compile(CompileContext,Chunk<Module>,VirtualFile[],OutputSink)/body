{
  boolean hasJava=false;
  final ExcludedEntriesConfiguration excluded=GroovyCompilerConfiguration.getExcludeConfiguration(myProject);
  List<VirtualFile> total=new ArrayList<VirtualFile>();
  for (  final VirtualFile virtualFile : virtualFiles) {
    final FileType fileType=virtualFile.getFileType();
    if (fileType == StdFileTypes.JAVA) {
      hasJava=true;
    }
    if (!excluded.isExcluded(virtualFile)) {
      if (fileType == GroovyFileType.GROOVY_FILE_TYPE) {
        total.add(virtualFile);
      }
    }
  }
  if (!hasJava) {
    return;
  }
  if (total.isEmpty()) {
    return;
  }
  super.compile(compileContext,moduleChunk,VfsUtil.toVirtualFileArray(total),sink);
}
