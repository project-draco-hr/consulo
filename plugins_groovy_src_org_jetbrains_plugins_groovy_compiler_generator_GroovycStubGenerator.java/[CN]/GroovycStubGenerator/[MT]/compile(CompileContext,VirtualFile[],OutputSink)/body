{
  boolean hasTests=false;
  for (  final VirtualFile item : virtualFiles) {
    if (ProjectRootManager.getInstance(myProject).getFileIndex().isInTestSourceContent(item)) {
      hasTests=true;
      break;
    }
  }
  List<VirtualFile> total=new ArrayList<VirtualFile>();
  total.addAll(Arrays.asList(virtualFiles));
  for (  final VirtualFile javaFile : compileContext.getCompileScope().getFiles(StdFileTypes.JAVA,!hasTests)) {
    if (isCompilableJavaFile(javaFile,compileContext)) {
      total.add(javaFile);
    }
  }
  super.compile(compileContext,total.toArray(new VirtualFile[total.size()]),sink);
}
