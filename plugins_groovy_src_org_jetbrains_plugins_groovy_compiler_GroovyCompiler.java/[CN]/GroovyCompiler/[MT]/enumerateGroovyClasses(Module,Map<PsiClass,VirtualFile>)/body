{
  final Set<VirtualFile> groovyFiles=new THashSet<VirtualFile>();
  ModuleRootManager.getInstance(module).getFileIndex().iterateContent(new ContentIterator(){
    public boolean processFile(    final VirtualFile vfile){
      if (!vfile.isDirectory() && GroovyFileType.GROOVY_FILE_TYPE.equals(vfile.getFileType())) {
        final List<PsiClass> classes=getAllClasses(vfile);
        if (!classes.isEmpty()) {
          groovyFiles.add(vfile);
          for (          PsiClass psiClass : classes) {
            moduleClasses.put(psiClass,vfile);
          }
        }
      }
      return true;
    }
  }
);
  return groovyFiles.size();
}
