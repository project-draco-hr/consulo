{
  final Set<VirtualFile> allToCompile=new LinkedHashSet<VirtualFile>(toCompile);
  if (!"false".equals(System.getProperty("compile.groovy.dependencies","true"))) {
    context.getProgressIndicator().checkCanceled();
    context.getProgressIndicator().setText("Enumerating Groovy classes...");
    Set<VirtualFile> groovyFiles=enumerateGroovyFiles(module);
    if (toCompile.size() < groovyFiles.size()) {
      context.getProgressIndicator().checkCanceled();
      context.getProgressIndicator().setText("Processing Groovy dependencies...");
      addIntermediateGroovyClasses(allToCompile,groovyFiles);
    }
  }
  context.getProgressIndicator().checkCanceled();
  context.getProgressIndicator().setText(GroovycOSProcessHandler.GROOVY_COMPILER_IN_OPERATION);
  runGroovycCompiler(context,module,new ArrayList<VirtualFile>(allToCompile),false,getMainOutput(context,module,tests),sink,tests);
}
