{
  final int startOffset=elements[0].getTextRange().getStartOffset();
  final int endOffset=elements[elements.length - 1].getTextRange().getEndOffset();
  editor.getCaretModel().moveToOffset(startOffset);
  editor.getSelectionModel().setSelection(startOffset,endOffset);
  final String text=editor.getDocument().getText().substring(startOffset,endOffset).trim();
  TemplateManager.getInstance(project).startTemplate(editor,text,myTemplate);
  return null;
}
