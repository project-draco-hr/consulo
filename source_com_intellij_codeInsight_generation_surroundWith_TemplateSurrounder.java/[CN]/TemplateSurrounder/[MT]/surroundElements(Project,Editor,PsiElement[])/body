{
  final PsiElement first=elements[0];
  final PsiElement last=elements[elements.length - 1];
  final int startOffset=first.getTextRange().getStartOffset();
  final int endOffset=last.getTextRange().getEndOffset();
  editor.getCaretModel().moveToOffset(startOffset);
  editor.getSelectionModel().setSelection(startOffset,endOffset);
  final String text=editor.getDocument().getText().substring(startOffset,endOffset).trim();
  TemplateManager.getInstance(project).startTemplate(editor,text,myTemplate);
  return null;
}
