{
  JComponent toFocus=myRootContent.getTargetComponent() == myActiveContentComponent ? myActiveFocusedContent : myInactiveContentComponent;
  final ComponentPopupBuilder builder=JBPopupFactory.getInstance().createComponentPopupBuilder(myRootContent,toFocus);
  builder.addListener(new JBPopupListener(){
    public void onClosed(    final JBPopup popup){
      myProgressPanel.hideProcessPopup();
    }
  }
);
  builder.setMovable(true);
  builder.setResizable(true);
  builder.setTitle(IdeBundle.message("progress.window.title"));
  builder.setDimensionServiceKey(null,"ProcessPopupWindow",true);
  builder.setMinSize(getMinSize());
  builder.setCancelOnClickOutside(false);
  builder.setRequestFocus(true);
  builder.setCancelButton(new MinimizeButton("Hide"));
  myPopup=builder.createPopup();
  myPopup.showInCenterOf(myProgressPanel.getRootPane());
}
