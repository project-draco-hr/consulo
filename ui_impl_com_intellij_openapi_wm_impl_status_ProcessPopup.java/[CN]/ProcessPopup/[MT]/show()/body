{
  JPanel content=new Content();
  final JPanel wrapper=new JPanel(new BorderLayout());
  wrapper.add(myProcessBox,BorderLayout.NORTH);
  content.add(wrapper,BorderLayout.CENTER);
  final JScrollPane scrolls=new JScrollPane(content){
    public Dimension getPreferredSize(){
      if (myProcessBox.getComponentCount() > 0) {
        return super.getPreferredSize();
      }
 else {
        final Dimension size=Toolkit.getDefaultToolkit().getScreenSize();
        size.width*=0.3d;
        size.height*=0.3d;
        return size;
      }
    }
  }
;
  scrolls.getViewport().setBackground(content.getBackground());
  scrolls.setBorder(null);
  myContent=scrolls;
  final ComponentPopupBuilder builder=JBPopupFactory.getInstance().createComponentPopupBuilder(scrolls,content);
  builder.addListener(new JBPopupListener(){
    public void onClosed(    final JBPopup popup){
      myProgressPanel.hideProcessPopup();
    }
  }
);
  builder.setMovable(true);
  builder.setResizable(true);
  builder.setTitle(IdeBundle.message("progress.window.title"));
  builder.setDimensionServiceKey("ProcessPopupWindow",true);
  builder.setCancelOnClickOutside(false);
  builder.setRequestFocus(true);
  final IconButton hideButton=new IconButton("Hide",IconLoader.getIcon("/general/hideToolWindow.png"),IconLoader.getIcon("/general/hideToolWindow.png"),IconLoader.getIcon("/general/hideToolWindowInactive.png"));
  builder.setCancelButton(hideButton);
  myPopup=builder.createPopup();
  myPopup.showInCenterOf(myProgressPanel.getRootPane());
}
