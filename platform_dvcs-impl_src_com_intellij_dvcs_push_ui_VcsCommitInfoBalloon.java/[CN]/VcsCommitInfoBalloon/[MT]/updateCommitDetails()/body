{
  if (myBalloon != null && myBalloon.isVisible()) {
    TreePath[] selectionPaths=myTree.getSelectionPaths();
    if (selectionPaths == null || selectionPaths.length != 1) {
      myBalloon.cancel();
    }
 else {
      Object node=selectionPaths[0].getLastPathComponent();
      myEditorPane.setText(XmlStringUtil.wrapInHtml(node instanceof TooltipNode ? ((TooltipNode)node).getTooltip().replaceAll("\n","<br>") : EMPTY_COMMIT_INFO));
      RepaintManager rp=RepaintManager.currentManager(myEditorPane);
      rp.markCompletelyDirty(myEditorPane);
      rp.validateInvalidComponents();
      rp.paintDirtyRegions();
      myBalloon.setSize(myWrapper.getPreferredSize());
      myBalloon.setLocation(calculateBestPopupLocation());
    }
  }
}
