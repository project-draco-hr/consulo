{
  super.visitNewExpression(expression);
  final PsiType type=expression.getType();
  if (!(type instanceof PsiClassType)) {
    return;
  }
  final PsiClassType classType=(PsiClassType)type;
  if (!classType.hasParameters()) {
    return;
  }
  final PsiType[] typeArguments=classType.getParameters();
  if (typeArguments.length != 1) {
    return;
  }
  final PsiType argumentType=typeArguments[0];
  if (!(argumentType instanceof PsiClassType)) {
    return;
  }
  if (!TypeUtils.expressionHasTypeOrSubtype(expression,"java.util.Set")) {
    return;
  }
  if (TypeUtils.expressionHasTypeOrSubtype(expression,"java.util.EnumSet")) {
    return;
  }
  final PsiClassType argumentClassType=(PsiClassType)argumentType;
  final PsiClass argumentClass=argumentClassType.resolve();
  if (argumentClass == null) {
    return;
  }
  if (!argumentClass.isEnum()) {
    return;
  }
  registerNewExpressionError(expression);
}
