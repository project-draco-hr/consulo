{
  final Component component=myRenderer.getTableCellRendererComponent(table,value,isSelected,hasFocus,row,column);
  final java.util.List<DomElementProblemDescriptor> problems=DomElementAnnotationsManager.getInstance().getProblems(myCellValueDomElement,true);
  final boolean hasErrors=problems.size() > 0;
  if (hasErrors) {
    component.setForeground(Color.RED);
  }
 else {
    component.setForeground(isSelected ? table.getSelectionForeground() : table.getForeground());
  }
  if (hasErrors && (value == null || value.toString().trim().length() == 0)) {
    component.setBackground(new Color(255,204,204));
  }
  final java.util.List<DomElementProblemDescriptor> problemDescriptors=DomElementAnnotationsManager.getInstance().getProblems(myRowDomElement,true,true);
  if (table.getModel().getColumnCount() - 1 == column && problemDescriptors.size() > 0) {
    final JPanel wrapper=new JPanel(new BorderLayout());
    wrapper.add(component,BorderLayout.CENTER);
    wrapper.setBackground(component.getBackground());
    final JLabel errorLabel=new JLabel(getErrorIcon());
    ToolTipManager.sharedInstance().registerComponent(errorLabel);
    wrapper.setToolTipText(TooltipUtils.getTooltipText(problemDescriptors));
    wrapper.add(errorLabel,BorderLayout.EAST);
    if (component instanceof JComponent) {
      wrapper.setBorder(((JComponent)component).getBorder());
      ((JComponent)component).setBorder(BorderFactory.createEmptyBorder());
    }
    return wrapper;
  }
 else {
    if (component instanceof JComponent) {
      ((JComponent)component).setToolTipText(hasErrors ? TooltipUtils.getTooltipText(problemDescriptors) : null);
    }
    return component;
  }
}
