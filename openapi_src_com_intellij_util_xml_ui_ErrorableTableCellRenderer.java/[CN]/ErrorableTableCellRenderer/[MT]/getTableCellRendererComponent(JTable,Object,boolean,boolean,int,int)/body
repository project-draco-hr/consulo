{
  final Component component=myRenderer.getTableCellRendererComponent(table,value,isSelected,hasFocus,row,column);
  final List<DomElementProblemDescriptor> errorProblems=DomElementAnnotationsManager.getInstance().getProblems(myCellValueDomElement,true);
  final List<DomElementProblemDescriptor> warningProblems=DomElementAnnotationsManager.getInstance().getProblems(myCellValueDomElement,true,true,HighlightSeverity.WARNING);
  final boolean hasErrors=errorProblems.size() > 0;
  if (hasErrors) {
    component.setForeground(Color.RED);
  }
 else {
    component.setForeground(isSelected ? table.getSelectionForeground() : table.getForeground());
  }
  if (hasErrors && (value == null || value.toString().trim().length() == 0)) {
    component.setBackground(BaseControl.ERROR_BACKGROUND);
  }
 else   if (warningProblems.size() > 0) {
    component.setBackground(BaseControl.WARNING_BACKGROUND);
    if (isSelected)     component.setForeground(Color.BLACK);
  }
  final List<DomElementProblemDescriptor> errorDescriptors=DomElementAnnotationsManager.getInstance().getProblems(myRowDomElement,true,true);
  if (table.getModel().getColumnCount() - 1 == column && errorDescriptors.size() > 0) {
    final JPanel wrapper=new JPanel(new BorderLayout());
    wrapper.add(component,BorderLayout.CENTER);
    wrapper.setBackground(component.getBackground());
    final JLabel errorLabel=new JLabel(getErrorIcon());
    wrapper.setToolTipText(TooltipUtils.getTooltipText(errorDescriptors));
    wrapper.add(errorLabel,BorderLayout.EAST);
    if (component instanceof JComponent) {
      wrapper.setBorder(((JComponent)component).getBorder());
      ((JComponent)component).setBorder(BorderFactory.createEmptyBorder());
    }
    return wrapper;
  }
 else {
    if (component instanceof JComponent) {
      ((JComponent)component).setToolTipText(errorDescriptors.size() > 0 ? TooltipUtils.getTooltipText(errorDescriptors) : null);
    }
    return component;
  }
}
