{
  if (key == SHELVED_CHANGELIST_KEY) {
    final Set<ShelvedChangeList> changeLists=getSelectedLists(false);
    if (changeLists.size() > 0) {
      sink.put(SHELVED_CHANGELIST_KEY,changeLists.toArray(new ShelvedChangeList[changeLists.size()]));
    }
  }
 else   if (key == SHELVED_RECYCLED_CHANGELIST_KEY) {
    final Set<ShelvedChangeList> changeLists=getSelectedLists(true);
    if (changeLists.size() > 0) {
      sink.put(SHELVED_RECYCLED_CHANGELIST_KEY,changeLists.toArray(new ShelvedChangeList[changeLists.size()]));
    }
  }
 else   if (key == SHELVED_CHANGE_KEY) {
    sink.put(SHELVED_CHANGE_KEY,TreeUtil.collectSelectedObjectsOfType(this,ShelvedChange.class));
  }
 else   if (key == SHELVED_BINARY_FILE_KEY) {
    sink.put(SHELVED_BINARY_FILE_KEY,TreeUtil.collectSelectedObjectsOfType(this,ShelvedBinaryFile.class));
  }
 else   if (key == VcsDataKeys.CHANGES) {
    List<ShelvedChange> shelvedChanges=TreeUtil.collectSelectedObjectsOfType(this,ShelvedChange.class);
    if (shelvedChanges.size() > 0) {
      Change[] changes=new Change[shelvedChanges.size()];
      for (int i=0; i < shelvedChanges.size(); i++) {
        changes[i]=shelvedChanges.get(i).getChange(myProject);
      }
      sink.put(VcsDataKeys.CHANGES,changes);
    }
 else {
      final List<ShelvedChangeList> changeLists=TreeUtil.collectSelectedObjectsOfType(this,ShelvedChangeList.class);
      if (changeLists.size() > 0) {
        List<Change> changes=new ArrayList<Change>();
        for (        ShelvedChangeList changeList : changeLists) {
          shelvedChanges=changeList.getChanges();
          for (          ShelvedChange shelvedChange : shelvedChanges) {
            changes.add(shelvedChange.getChange(myProject));
          }
        }
        sink.put(VcsDataKeys.CHANGES,changes.toArray(new Change[changes.size()]));
      }
    }
  }
 else   if (key == PlatformDataKeys.DELETE_ELEMENT_PROVIDER) {
    sink.put(PlatformDataKeys.DELETE_ELEMENT_PROVIDER,myDeleteProvider);
  }
}
