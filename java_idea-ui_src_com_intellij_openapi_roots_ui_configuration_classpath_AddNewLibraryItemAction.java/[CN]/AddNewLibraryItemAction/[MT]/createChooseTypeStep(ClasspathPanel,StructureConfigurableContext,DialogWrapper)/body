{
  return new BaseListPopupStep<LibraryType>("Select Library Type",getSuitableTypes(classpathPanel)){
    @NotNull @Override public String getTextFor(    LibraryType value){
      return value != null ? value.getCreateActionName() : IdeBundle.message("create.default.library.type.action.name");
    }
    @Override public Icon getIconFor(    LibraryType aValue){
      return aValue != null ? aValue.getIcon() : PlatformIcons.LIBRARY_ICON;
    }
    @Override public PopupStep onChosen(    final LibraryType selectedValue,    boolean finalChoice){
      return doFinalStep(new Runnable(){
        @Override public void run(){
          if (parentDialog != null)           parentDialog.close(DialogWrapper.CANCEL_EXIT_CODE);
          new AddNewLibraryItemAction(classpathPanel,context,selectedValue).execute();
        }
      }
);
    }
  }
;
}
