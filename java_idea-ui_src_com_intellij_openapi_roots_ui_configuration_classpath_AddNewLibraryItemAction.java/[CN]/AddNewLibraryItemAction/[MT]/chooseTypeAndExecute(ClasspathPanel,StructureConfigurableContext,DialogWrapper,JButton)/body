{
  if (LibraryEditingUtil.hasSuitableTypes(classpathPanel)) {
    final ListPopup popup=JBPopupFactory.getInstance().createListPopup(createChooseTypeStep(classpathPanel,context,parentDialog));
    popup.showUnderneathOf(contextButton);
  }
 else {
    if (parentDialog != null)     parentDialog.close(DialogWrapper.CANCEL_EXIT_CODE);
    new AddNewLibraryItemAction(classpathPanel,context,null).execute();
  }
}
