{
  if (LOG.isDebugEnabled()) {
    LOG.debug("enter: lock(path='" + path + "')");
  }
  acquireSocket();
  if (mySocket == null) {
    if (!myIsDialogShown) {
      JOptionPane.showMessageDialog(JOptionPane.getRootFrame(),"IDEA was unable to create a local connection in order to check whether\n" + "other instance of IDEA is currently running on the same machine.\n" + "Running multiple instances of IDEA on the same machine may cause unpredictable\n"+ "results because of sharing system folders.\n"+ "Please troubleshoot your TCP/IP configuration and/or local firewall settings.\n" + ReportMessages.getReportAddress() + "\n"+ "and attach the "+ PathManager.getSystemPath()+ "/log/idea.log file".replace('/',File.separatorChar),"Warning",JOptionPane.WARNING_MESSAGE);
      myIsDialogShown=true;
    }
    return true;
  }
  for (int i=SOCKET_NUMBER_START; i < SOCKET_NUMBER_END; i++) {
    if (i == mySocket.getLocalPort())     continue;
    List lockedList=readLockedList(i);
    if (lockedList.contains(path))     return false;
  }
  myLockedPaths.add(path);
  return true;
}
