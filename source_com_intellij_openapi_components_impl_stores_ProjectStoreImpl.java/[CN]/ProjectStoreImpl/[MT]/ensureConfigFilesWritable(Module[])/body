{
  final List<VirtualFile> readonlyFiles=new ArrayList<VirtualFile>(modules.length + 2);
  collectReadonlyFiles(getConfigurationFiles(),readonlyFiles);
  for (  Module module : modules) {
    final ModuleStoreImpl moduleStore=(ModuleStoreImpl)((ModuleImpl)module).getStateStore();
    moduleStore.collectReadonlyFiles(moduleStore.getConfigurationFiles(),readonlyFiles);
  }
  return ReadonlyStatusHandler.getInstance(myProject).ensureFilesWritable(readonlyFiles.toArray(new VirtualFile[readonlyFiles.size()]));
}
