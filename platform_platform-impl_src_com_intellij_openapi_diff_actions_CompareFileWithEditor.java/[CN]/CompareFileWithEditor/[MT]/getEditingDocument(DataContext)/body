{
  Project project=PlatformDataKeys.PROJECT.getData(dataContext);
  if (project == null)   return null;
  VirtualFile[] selectedFiles=FileEditorManager.getInstance(project).getSelectedFiles();
  if (selectedFiles.length == 0)   return null;
  if (!DiffContentUtil.isTextFile(selectedFiles[0]))   return null;
  return FileDocumentManager.getInstance().getDocument(selectedFiles[0]);
}
