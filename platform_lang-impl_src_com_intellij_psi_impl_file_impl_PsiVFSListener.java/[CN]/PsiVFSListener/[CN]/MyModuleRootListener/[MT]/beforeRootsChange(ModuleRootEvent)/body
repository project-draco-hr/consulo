{
  if (!myFileManager.isInitialized())   return;
  if (event.isCausedByFileTypesChange())   return;
  ApplicationManager.getApplication().runWriteAction(new ExternalChangeAction(){
    public void run(){
      depthCounter++;
      if (depthCounter > 1)       return;
      PsiTreeChangeEventImpl treeEvent=new PsiTreeChangeEventImpl(myManager);
      treeEvent.setPropertyName(PsiTreeChangeEvent.PROP_ROOTS);
      final VirtualFile[] contentRoots=myProjectRootManager.getContentRoots();
      LOG.assertTrue(myOldContentRoots == null);
      myOldContentRoots=contentRoots;
      treeEvent.setOldValue(contentRoots);
      myManager.beforePropertyChange(treeEvent);
    }
  }
);
}
