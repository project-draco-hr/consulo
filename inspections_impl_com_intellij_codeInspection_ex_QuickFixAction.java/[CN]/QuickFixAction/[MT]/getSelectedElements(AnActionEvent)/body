{
  final InspectionResultsView invoker=getInvoker(e);
  if (invoker == null)   return new RefElement[0];
  List<RefEntity> selection=new ArrayList<RefEntity>(Arrays.asList(invoker.getTree().getSelectedElements()));
  PsiDocumentManager.getInstance(invoker.getProject()).commitAllDocuments();
  Collections.sort(selection,new Comparator(){
    public int compare(    Object o1,    Object o2){
      if (o1 instanceof RefElement && o2 instanceof RefElement) {
        RefElement r1=(RefElement)o1;
        RefElement r2=(RefElement)o2;
        int i1=r1 instanceof RefImplicitConstructor ? 0 : r1.getElement().getTextOffset();
        int i2=r2 instanceof RefImplicitConstructor ? 0 : r2.getElement().getTextOffset();
        if (i1 < i2)         return 1;
        if (i1 == i2)         return 0;
        return -1;
      }
      if (o1 instanceof RefElement) {
        return 1;
      }
      if (o2 instanceof RefElement) {
        return -1;
      }
      return ((RefEntity)o1).getName().compareTo(((RefEntity)o2).getName());
    }
  }
);
  return selection.toArray(new RefElement[selection.size()]);
}
