{
  context.getDocument().deleteString(context.getStartOffset(),context.getTailOffset());
  for (int i=0; i < myTypeItems.size(); i++) {
    CompletionUtil.emulateInsertion(context,context.getTailOffset(),myTypeItems.get(i));
    context.setTailOffset(getTail(i == myTypeItems.size() - 1).processTail(context.getEditor(),context.getTailOffset()));
  }
  context.setAddCompletionChar(false);
  context.commitDocument();
  PsiElement leaf=context.getFile().findElementAt(context.getTailOffset() - 1);
  if (psiElement().withParents(PsiReferenceParameterList.class,PsiJavaCodeReferenceElement.class,PsiNewExpression.class).accepts(leaf)) {
    ParenthesesInsertHandler.getInstance(myHasParameters).handleInsert(context,this);
    myGlobalTail.processTail(context.getEditor(),context.getTailOffset());
  }
}
