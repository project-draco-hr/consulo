{
  final VirtualFile virtualFile=LocalFileSystem.getInstance().refreshAndFindFileByPath(path);
  if (virtualFile == null)   return null;
  if (path.endsWith(ProjectFileType.DOT_DEFAULT_EXTENSION) || virtualFile.isDirectory() && virtualFile.findChild(DIRECTORY_BASED_PROJECT_DIR) != null) {
    return openProject(path,projectToClose,forceOpenInNewFrame);
  }
 else {
    ProjectOpenProcessor provider=getImportProvider(virtualFile);
    if (provider != null) {
      return provider.doOpenProject(virtualFile,projectToClose,forceOpenInNewFrame);
    }
  }
  return null;
}
