{
  final ContentRevision beforeRevision=change.getBeforeRevision();
  final ContentRevision afterRevision=change.getAfterRevision();
  File beforeFile=beforeRevision == null ? null : beforeRevision.getFile().getIOFile();
  File afterFile=afterRevision == null ? null : afterRevision.getFile().getIOFile();
  String shelvedPath=null;
  if (afterFile != null) {
    String shelvedName=FileUtil.getNameWithoutExtension(afterFile.getName());
    String shelvedExt=FileUtil.getExtension(afterFile.getName());
    File shelvedFile=FileUtil.findSequentNonexistentFile(new File(myShelfPath),shelvedName,shelvedExt);
    FileUtil.copy(afterRevision.getFile().getIOFile(),shelvedFile);
    shelvedPath=shelvedFile.getPath();
  }
  File baseDirFile=new File(myProject.getBaseDir().getPath());
  String beforePath=beforeFile == null ? null : FileUtil.getRelativePath(baseDirFile,beforeFile);
  String afterPath=afterFile == null ? null : FileUtil.getRelativePath(baseDirFile,afterFile);
  return new ShelvedBinaryFile(beforePath,afterPath,shelvedPath);
}
