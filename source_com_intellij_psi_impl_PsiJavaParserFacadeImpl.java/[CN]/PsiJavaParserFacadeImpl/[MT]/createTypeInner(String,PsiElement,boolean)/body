{
  PsiPrimitiveType primitiveType=ourPrimitiveTypesMap.get(text);
  if (primitiveType != null)   return primitiveType;
  final FileElement holderElement=DummyHolderFactory.createHolder(myManager,context).getTreeElement();
  CompositeElement typeElement=Parsing.parseTypeText(myManager,text,0,text.length(),holderElement.getCharTable());
  if (typeElement == null) {
    throw new IncorrectOperationException("Incorrect type \"" + text + "\"");
  }
  TreeUtil.addChildren(holderElement,typeElement);
  if (markAsCopy) {
    holderElement.acceptTree(new GeneratedMarkerVisitor());
  }
  PsiTypeElement psiTypeElement=(PsiTypeElement)SourceTreeToPsiMap.treeElementToPsi(typeElement);
  if (psiTypeElement == null) {
    throw new IncorrectOperationException("PSI is null for element " + typeElement);
  }
  return psiTypeElement.getType();
}
