{
  final VirtualFile[] roots=new VirtualFile[1];
  ApplicationManager.getApplication().runReadAction(new Runnable(){
    @Override public void run(){
      if (!project.isDisposed()) {
        ProjectLevelVcsManager mgr=ProjectLevelVcsManager.getInstance(project);
        roots[0]=(mgr != null) ? mgr.getVcsRootFor(file) : null;
      }
    }
  }
);
  return roots[0];
}
