{
  VirtualFile file=baseFile.getVirtualFile();
  if (file == null) {
    final PsiFile originalFile=baseFile.getOriginalFile();
    if (originalFile != null)     file=originalFile.getVirtualFile();
  }
  final Module moduleForFile=file != null ? ProjectRootManager.getInstance(baseFile.getProject()).getFileIndex().getModuleForFile(file) : null;
  final XmlFile schema=XmlSchemaProvider.findSchema(url,moduleForFile,baseFile);
  if (schema != null) {
    return schema;
  }
  final String location=getResourceLocation(url,version);
  return XmlUtil.findXmlFile(baseFile,location);
}
