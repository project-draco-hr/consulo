{
  if (EventQueue.isDispatchThread()) {
    ApplicationManager.getApplication().executeOnPooledThread(new Runnable(){
      @Override public void run(){
        getRobot().waitForIdle();
        SwingUtilities.invokeLater(runnable);
      }
    }
);
  }
 else {
    getRobot().waitForIdle();
    SwingUtilities.invokeLater(runnable);
  }
}
