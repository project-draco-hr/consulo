{
  final Module module=myModuleSelector.getModule();
  final GlobalSearchScope scope;
  if (module == null) {
    scope=GlobalSearchScope.allScope(myProject);
  }
 else {
    scope=GlobalSearchScope.moduleWithDependenciesAndLibrariesScope(module);
  }
  final ClassFilter filter=createFilter(module);
  return new ClassFilter.ClassFilterWithScope(){
    public GlobalSearchScope getScope(){
      return scope;
    }
    public boolean isAccepted(    final PsiClass aClass){
      return filter == null || filter.isAccepted(aClass);
    }
  }
;
}
