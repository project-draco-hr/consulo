{
synchronized (BUFFER) {
    try {
      InputStream input=virtualFile.getInputStream();
      final int read;
      try {
        read=input.read(BUFFER);
      }
  finally {
        input.close();
      }
      if (Patches.SUN_BUG_ID_4508058) {
        if (startsWith(BUFFER,read,CharsetToolkit.UTF8_BOM)) {
          return CharsetToolkit.UTF8_BOM.length;
        }
      }
      return 0;
    }
 catch (    IOException e) {
      return 0;
    }
  }
}
