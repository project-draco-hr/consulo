{
  Content allTodosContent=ContentFactory.SERVICE.getInstance().createContent(null,IdeBundle.message("title.project"),false);
  myAllTodos=new TodoPanel(myProject,myAllPanelSettings,false,allTodosContent){
    @Override protected TodoTreeBuilder createTreeBuilder(    JTree tree,    DefaultTreeModel treeModel,    Project project){
      AllTodosTreeBuilder builder=new AllTodosTreeBuilder(tree,treeModel,project);
      builder.init();
      return builder;
    }
  }
;
  allTodosContent.setComponent(myAllTodos);
  Disposer.register(this,myAllTodos);
  Content currentFileTodosContent=ContentFactory.SERVICE.getInstance().createContent(null,IdeBundle.message("title.todo.current.file"),false);
  myCurrentFileTodos=new CurrentFileTodosPanel(myProject,myCurrentPanelSettings,currentFileTodosContent){
    @Override protected TodoTreeBuilder createTreeBuilder(    JTree tree,    DefaultTreeModel treeModel,    Project project){
      CurrentFileTodosTreeBuilder builder=new CurrentFileTodosTreeBuilder(tree,treeModel,project);
      builder.init();
      return builder;
    }
  }
;
  Disposer.register(this,myCurrentFileTodos);
  currentFileTodosContent.setComponent(myCurrentFileTodos);
  myChangeListTodosContent=ContentFactory.SERVICE.getInstance().createContent(null,IdeBundle.message("changelist.todo.title",ChangeListManager.getInstance(myProject).getDefaultChangeList().getName()),false);
  myChangeListTodos=new ChangeListTodosPanel(myProject,myCurrentPanelSettings,myChangeListTodosContent){
    @Override protected TodoTreeBuilder createTreeBuilder(    JTree tree,    DefaultTreeModel treeModel,    Project project){
      ChangeListTodosTreeBuilder builder=new ChangeListTodosTreeBuilder(tree,treeModel,project);
      builder.init();
      return builder;
    }
  }
;
  Disposer.register(this,myChangeListTodos);
  myChangeListTodosContent.setComponent(myChangeListTodos);
  Content scopeBasedTodoContent=ContentFactory.SERVICE.getInstance().createContent(null,"Scope Based",false);
  myScopeBasedTodos=new ScopeBasedTodosPanel(myProject,myCurrentPanelSettings,scopeBasedTodoContent);
  Disposer.register(this,myScopeBasedTodos);
  scopeBasedTodoContent.setComponent(myScopeBasedTodos);
  myContentManager=toolWindow.getContentManager();
  myContentManager.addContent(allTodosContent);
  myContentManager.addContent(currentFileTodosContent);
  myContentManager.addContent(scopeBasedTodoContent);
  if (myVCSManager.getAllActiveVcss().length > 0) {
    myVcsListener.myIsVisible=true;
    myContentManager.addContent(myChangeListTodosContent);
  }
  for (  Content content : myNotAddedContent) {
    myContentManager.addContent(content);
  }
  myChangeListTodosContent.setCloseable(false);
  allTodosContent.setCloseable(false);
  currentFileTodosContent.setCloseable(false);
  scopeBasedTodoContent.setCloseable(false);
  Content content=myContentManager.getContent(mySelectedIndex);
  content=content == null ? allTodosContent : content;
  myContentManager.setSelectedContent(content);
  myPanels.add(myAllTodos);
  myPanels.add(myChangeListTodos);
  myPanels.add(myCurrentFileTodos);
  myPanels.add(myScopeBasedTodos);
}
