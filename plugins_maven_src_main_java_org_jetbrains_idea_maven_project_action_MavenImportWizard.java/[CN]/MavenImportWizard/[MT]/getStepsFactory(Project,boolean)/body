{
  if ((updateCurrent)) {
    projectToUpdate=currentProject;
    preferences=MavenImporterPreferencesComponent.getInstance(currentProject).getState().safeClone();
  }
 else {
    projectToUpdate=null;
    preferences=new MavenImporterPreferences();
  }
  myImportProcessor=new MavenImportProcessor(projectToUpdate,preferences);
  return new AddModuleWizard.ModuleWizardStepFactory(){
    public ModuleWizardStep[] createSteps(    final WizardContext wizardContext){
      return new ModuleWizardStep[]{new MavenImportRootStep(wizardContext,MavenImportWizard.this,preferences),new SelectImportedProjectsStep<MavenProjectModel.Node>(MavenImportWizard.this,updateCurrent){
        protected String getElementText(        final MavenProjectModel.Node node){
          final StringBuilder stringBuilder=new StringBuilder();
          stringBuilder.append(node.getArtifact().toString());
          final String relPath=VfsUtil.getRelativePath(node.getFile().getParent(),getRootDirectory(),File.separatorChar);
          if (relPath.length() != 0) {
            stringBuilder.append(" [").append(relPath).append("]");
          }
          return stringBuilder.toString();
        }
      }
};
    }
  }
;
}
