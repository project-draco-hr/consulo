{
  myImportProcessor.resolve(project);
  myImportProcessor.commit(project,preferences.isAutoImportNew());
  if (preferences.isAutoImportNew()) {
    final MavenImporterState importerState=project.getComponent(MavenImporter.class).getState();
    myImportProcessor.getMavenProjectModel().visit(new MavenProjectModel.MavenProjectVisitorPlain(){
      public void visit(      MavenProjectModel.Node node){
        if (!node.isLinked()) {
          importerState.remember(node.getPath());
        }
      }
      public Iterable<MavenProjectModel.Node> getChildren(      final MavenProjectModel.Node node){
        return node.isLinked() ? super.getChildren(node) : null;
      }
    }
);
  }
  MavenImporterPreferencesComponent.getInstance(project).loadState(preferences);
}
