{
  return doExecute(new Executor<MavenWrapperResolutionResult>(){
    public MavenWrapperResolutionResult execute() throws Exception {
      DependencyTreeResolutionListener listener=new DependencyTreeResolutionListener(myLogger);
      MavenExecutionResult result=myImpl.resolveProject(new File(file.getPath()),new ArrayList<String>(activeProfiles),Arrays.<ResolutionListener>asList(listener));
      DependencyNode rootNode=listener.getRootNode();
      Collection<DependencyNode> depsTree=rootNode == null ? Collections.emptyList() : rootNode.getChildren();
      return new MavenWrapperResolutionResult(result.getMavenProject(),depsTree,retrieveUnresolvedArtifactIds(),result.getExceptions());
    }
  }
);
}
