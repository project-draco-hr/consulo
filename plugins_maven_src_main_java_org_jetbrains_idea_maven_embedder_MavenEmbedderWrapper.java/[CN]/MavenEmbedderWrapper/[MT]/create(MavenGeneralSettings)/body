{
  MavenEmbedderSettings settings=new MavenEmbedderSettings();
  settings.setConfigurator(new PlexusComponentConfigurator(){
    public void configureComponents(    @NotNull PlexusContainer c){
      setupContainer(c);
    }
  }
);
  MavenLogger logger=new MavenLogger();
  logger.setThreshold(generalSettings.getLoggingLevel().getLevel());
  settings.setLogger(logger);
  settings.setRecursive(false);
  settings.setWorkOffline(generalSettings.isWorkOffline());
  settings.setUsePluginRegistry(generalSettings.isUsePluginRegistry());
  settings.setMavenHome(generalSettings.getMavenHome());
  settings.setMavenSettingsFile(generalSettings.getMavenSettingsFile());
  settings.setLocalRepository(generalSettings.getEffectiveLocalRepository().getPath());
  settings.setSnapshotUpdatePolicy(generalSettings.getSnapshotUpdatePolicy().getEmbedderPolicy());
  settings.setPluginUpdatePolicy(generalSettings.getPluginUpdatePolicy().getEmbedderPolicy());
  return new MavenEmbedderWrapper(MavenEmbedder.create(settings),logger);
}
