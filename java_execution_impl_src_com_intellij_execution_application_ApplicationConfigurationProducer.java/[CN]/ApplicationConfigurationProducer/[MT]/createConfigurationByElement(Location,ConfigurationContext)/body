{
  location=JavaExecutionUtil.stepIntoSingleClass(location);
  if (location == null)   return null;
  final PsiElement element=location.getPsiElement();
  if (!element.isPhysical())   return null;
  PsiElement currentElement=element;
  PsiMethod method;
  while ((method=findMain(currentElement)) != null) {
    final PsiClass aClass=method.getContainingClass();
    if (ConfigurationUtil.MAIN_CLASS.value(aClass)) {
      myPsiElement=method;
      return createConfiguration(aClass,context,location);
    }
    currentElement=method.getParent();
  }
  final PsiClass aClass=ApplicationConfigurationType.getMainClass(element);
  if (aClass == null)   return null;
  myPsiElement=aClass;
  return createConfiguration(aClass,context,location);
}
