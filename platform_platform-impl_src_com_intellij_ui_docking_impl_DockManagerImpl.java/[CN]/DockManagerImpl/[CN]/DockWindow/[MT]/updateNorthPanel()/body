{
  if (ApplicationManager.getApplication().isUnitTestMode())   return;
  myNorthPanel.setVisible(UISettings.getInstance().SHOW_NAVIGATION_BAR && !(myContainer instanceof DockContainer.Dialog) && !UISettings.getInstance().PRESENTATION_MODE);
  IdeRootPaneNorthExtension[] extensions=Extensions.getArea(myProject).getExtensionPoint(IdeRootPaneNorthExtension.EP_NAME).getExtensions();
  HashSet<String> processedKeys=new HashSet<>();
  for (  IdeRootPaneNorthExtension each : extensions) {
    processedKeys.add(each.getKey());
    if (myNorthExtensions.containsKey(each.getKey()))     continue;
    IdeRootPaneNorthExtension toInstall=each.copy();
    myNorthExtensions.put(toInstall.getKey(),toInstall);
    myNorthPanel.add(toInstall.getComponent());
  }
  Iterator<String> existing=myNorthExtensions.keySet().iterator();
  while (existing.hasNext()) {
    String each=existing.next();
    if (processedKeys.contains(each))     continue;
    IdeRootPaneNorthExtension toRemove=myNorthExtensions.get(each);
    myNorthPanel.remove(toRemove.getComponent());
    existing.remove();
    Disposer.dispose(toRemove);
  }
  myNorthPanel.revalidate();
  myNorthPanel.repaint();
}
