{
  int needsUpdate=STATE_UP_TO_DATE;
  if (test.getChildCount() != myLastChildCount) {
    needsUpdate=STATE_OUT_OF_DATE;
  }
 else   if (test.getStateTimestamp() != myTimestamp)   needsUpdate=STATE_UNKNOWN;
  if (needsUpdate == STATE_UNKNOWN) {
    final int magnitude=test.getState().getMagnitude();
    needsUpdate=magnitude == myLastMagnitude ? STATE_UP_TO_DATE : STATE_OUT_OF_DATE;
    myLastMagnitude=magnitude;
  }
  if (needsUpdate == STATE_UP_TO_DATE)   return false;
  if (needsUpdate == STATE_OUT_OF_DATE) {
    return true;
  }
  LOG.error(String.valueOf(needsUpdate));
  return true;
}
