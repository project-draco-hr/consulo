{
  ((EditorEx)editor).stopOptimizedScrolling();
  int lineHeight=editor.getLineHeight();
  Rectangle viewRect=editor.getScrollingModel().getVisibleArea();
  int linesIncrement=viewRect.height / lineHeight;
  int allowedBottom=((EditorEx)editor).getContentSize().height - viewRect.height;
  editor.getScrollingModel().scrollVertically(Math.min(allowedBottom,viewRect.y - viewRect.y % lineHeight + linesIncrement * lineHeight));
  editor.getCaretModel().moveCaretRelatively(0,linesIncrement,isWithSelection,editor.isColumnMode(),true);
}
