{
  final StringBuffer classPathBuffer=new StringBuffer();
  final Path cp=new Path(getProject());
  appendPath(cp,getBootclasspath());
  cp.setLocation(getDestdir().getAbsoluteFile());
  appendPath(cp,getClasspath());
  appendPath(cp,getSourcepath());
  appendPath(cp,getSrcdir());
  if (getIncludeantruntime()) {
    cp.addExisting(cp.concatSystemClasspath("last"));
  }
  if (getIncludejavaruntime()) {
    cp.addJavaRuntime();
  }
  cp.addExtdirs(getExtdirs());
  final String[] pathElements=cp.list();
  for (int i=0; i < pathElements.length; i++) {
    final String pathElement=pathElements[i];
    classPathBuffer.append(File.pathSeparator);
    classPathBuffer.append(pathElement);
  }
  final String classPath=classPathBuffer.toString();
  log("classpath=" + classPath,Project.MSG_VERBOSE);
  try {
    return createClassLoader(classPath);
  }
 catch (  MalformedURLException e) {
    fireError(e.getMessage());
    return null;
  }
}
