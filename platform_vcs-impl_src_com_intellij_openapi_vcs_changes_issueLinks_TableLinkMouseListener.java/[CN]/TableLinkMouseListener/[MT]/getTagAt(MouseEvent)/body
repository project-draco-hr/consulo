{
  Object tag=null;
  JTable table=(JTable)e.getSource();
  int row=table.rowAtPoint(e.getPoint());
  int column=table.columnAtPoint(e.getPoint());
  if (row == -1 || column == -1)   return null;
  TableCellRenderer cellRenderer=table.getCellRenderer(row,column);
  if (cellRenderer instanceof DualView.TableCellRendererWrapper) {
    cellRenderer=((DualView.TableCellRendererWrapper)cellRenderer).getRenderer();
  }
  if (cellRenderer instanceof TreeTableView.CellRendererWrapper) {
    cellRenderer=((TreeTableView.CellRendererWrapper)cellRenderer).getBaseRenderer();
  }
  if (cellRenderer instanceof ColoredTableCellRenderer) {
    final ColoredTableCellRenderer renderer=(ColoredTableCellRenderer)cellRenderer;
    tag=forColoredRenderer(e,table,row,column,renderer);
  }
 else {
    tag=tryGetTag(e,table,row,column);
  }
  return tag;
}
