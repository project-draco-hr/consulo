{
  Object tag=null;
  JTable table=(JTable)e.getSource();
  int row=table.rowAtPoint(e.getPoint());
  int column=table.columnAtPoint(e.getPoint());
  TableCellRenderer cellRenderer=table.getCellRenderer(row,column);
  if (cellRenderer instanceof DualView.TableCellRendererWrapper) {
    cellRenderer=((DualView.TableCellRendererWrapper)cellRenderer).getRenderer();
  }
  if (cellRenderer instanceof TreeTableView.CellRendererWrapper) {
    cellRenderer=((TreeTableView.CellRendererWrapper)cellRenderer).getBaseRenderer();
  }
  if (cellRenderer instanceof ColoredTableCellRenderer) {
    final ColoredTableCellRenderer renderer=(ColoredTableCellRenderer)cellRenderer;
    renderer.getTableCellRendererComponent(table,table.getValueAt(row,column),false,false,row,column);
    final Rectangle rc=table.getCellRect(row,column,false);
    int index=renderer.findFragmentAt(e.getPoint().x - rc.x);
    if (index >= 0) {
      tag=renderer.getFragmentTag(index);
    }
  }
  return tag;
}
