{
  if (file.getFileSystem().isReadOnly()) {
    throw new IllegalArgumentException("Wrong file system: " + file.getFileSystem());
  }
  if (file.isWritable() == !readOnlyStatus) {
    return;
  }
  if (file instanceof NewVirtualFile) {
    ((NewVirtualFile)file).setWritable(!readOnlyStatus);
  }
 else {
    String path=file.getPresentableUrl();
    setReadOnlyAttribute(path,readOnlyStatus);
    file.refresh(false,false);
  }
}
