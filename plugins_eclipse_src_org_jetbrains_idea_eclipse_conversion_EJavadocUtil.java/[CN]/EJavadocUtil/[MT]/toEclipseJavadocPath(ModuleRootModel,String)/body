{
  final String protocol=VirtualFileManager.extractProtocol(javadocPath);
  if (!Comparing.strEqual(protocol,HttpFileSystem.getInstance().getProtocol())) {
    final String path=VfsUtil.urlToPath(javadocPath);
    final VirtualFile contentRoot=getCurrentRoot(model);
    final Project project=model.getModule().getProject();
    final VirtualFile baseDir=contentRoot != null ? contentRoot.getParent() : project.getBaseDir();
    if (Comparing.strEqual(protocol,JarFileSystem.getInstance().getProtocol())) {
      final VirtualFile javadocFile=JarFileSystem.getInstance().getVirtualFileForJar(VirtualFileManager.getInstance().findFileByUrl(javadocPath));
      if (javadocFile != null) {
        String relativeUrl=relativeToOtherModule(project,javadocFile);
        if (relativeUrl == null && VfsUtil.isAncestor(baseDir,javadocFile,false)) {
          relativeUrl="/" + VfsUtil.getRelativePath(javadocFile,baseDir,'/');
        }
        if (relativeUrl != null) {
          if (javadocPath.indexOf(JarFileSystem.JAR_SEPARATOR) == -1) {
            javadocPath=StringUtil.trimEnd(javadocPath,"/") + JarFileSystem.JAR_SEPARATOR;
          }
          javadocPath=JAR_PREFIX + PLATFORM_PROTOCOL + "resource"+ relativeUrl+ javadocPath.substring(javadocFile.getUrl().length() - 1);
        }
 else {
          javadocPath=JAR_PREFIX + FILE_PROTOCOL + StringUtil.trimStart(path,"/");
        }
      }
 else {
        javadocPath=JAR_PREFIX + FILE_PROTOCOL + StringUtil.trimStart(path,"/");
      }
    }
 else     if (new File(path).exists()) {
      javadocPath=FILE_PROTOCOL + StringUtil.trimStart(path,"/");
    }
  }
  return javadocPath;
}
