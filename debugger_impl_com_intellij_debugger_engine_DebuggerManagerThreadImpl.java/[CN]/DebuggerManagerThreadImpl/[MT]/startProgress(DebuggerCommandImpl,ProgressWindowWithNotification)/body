{
  progressWindow.addListener(new ProgressIndicatorListenerAdapter(){
    public void cancelled(){
      command.release();
    }
  }
);
  ApplicationManager.getApplication().executeOnPooledThread(new Runnable(){
    public void run(){
      ProgressManager.getInstance().runProcess(new Runnable(){
        public void run(){
          invokeAndWait(command,HIGH_PRIORITY);
        }
      }
,progressWindow);
    }
  }
);
}
