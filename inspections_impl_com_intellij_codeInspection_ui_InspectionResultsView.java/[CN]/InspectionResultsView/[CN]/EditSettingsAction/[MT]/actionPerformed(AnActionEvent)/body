{
  final InspectionProjectProfileManager profileManager=InspectionProjectProfileManager.getInstance(myProject);
  final InspectionTool tool=myTree.getSelectedTool();
  InspectionProfile inspectionProfile=myInspectionProfile;
  final boolean profileNotDefined=!isProfileDefined(inspectionProfile);
  if (profileNotDefined) {
    inspectionProfile=guessProfileToSelect(profileManager);
  }
  if (tool != null) {
    final HighlightDisplayKey key=HighlightDisplayKey.find(tool.getShortName());
    if (key != null) {
      if (new EditInspectionToolsSettingsAction(key).editToolSettings(myProject,(InspectionProfileImpl)inspectionProfile,profileNotDefined) && profileNotDefined) {
        updateCurrentProfile(myInspectionProfile);
      }
      return;
    }
  }
  if (EditInspectionToolsSettingsAction.editToolSettings(myProject,inspectionProfile,profileNotDefined,null,profileManager) && profileNotDefined) {
    updateCurrentProfile(myInspectionProfile);
  }
}
