{
  if (element instanceof PsiMethod && isReturnTypeInferrable((PsiMethod)element,context,expectedType,substitutor)) {
    return true;
  }
  PsiType typeByElement=FilterUtil.getTypeByElement(element,context);
  if (typeByElement == null) {
    return false;
  }
  if (substitutor != null) {
    typeByElement=substitutor.substitute(typeByElement);
  }
  if (!allowBoxing(context) && (expectedType instanceof PsiPrimitiveType != typeByElement instanceof PsiPrimitiveType)) {
    return false;
  }
  return expectedType.isAssignableFrom(typeByElement);
}
