{
  if (t instanceof PsiClassType) {
    PsiClassType.ClassResolveResult result=((PsiClassType)t).resolveGenerics();
    PsiClass aClass=result.getElement();
    PsiSubstitutor aSubst=result.getSubstitutor();
    if (aClass == null) {
      return 0;
    }
    PsiTypeParameter[] parms=getTypeParametersList(aClass);
    int max=0;
    for (int i=0; i < parms.length; i++) {
      max=Math.max(max,getHeight(aSubst.substitute(parms[i])));
      if (max > HEIGHT_BOUND) {
        break;
      }
    }
    return 1 + max;
  }
 else   if (t instanceof PsiArrayType) {
    return getHeight(((PsiArrayType)t).getDeepComponentType());
  }
 else   if (t instanceof SubtypeOf) {
    return getHeight(((SubtypeOf)t).getSuperType());
  }
 else   if (t instanceof SupertypeOf) {
    return getHeight(((SupertypeOf)t).getSubType());
  }
  return 0;
}
