{
  if (type instanceof PsiClassType) {
    PsiClassType.ClassResolveResult result=resolveType(type);
    if (result == null) {
      return false;
    }
    PsiClass aClass=result.getElement();
    PsiSubstitutor aSubst=result.getSubstitutor();
    if (!PsiUtil.isAccessible(aClass,context,null)) {
      return false;
    }
    PsiTypeParameter[] aParms=getTypeParametersList(aClass);
    for (int i=0; i < aParms.length; i++) {
      if (!isValidType(aSubst.substitute(aParms[i]),context)) {
        return false;
      }
    }
    return true;
  }
  if (type instanceof PsiArrayType) {
    return isValidType(((PsiArrayType)type).getComponentType(),context);
  }
  return true;
}
