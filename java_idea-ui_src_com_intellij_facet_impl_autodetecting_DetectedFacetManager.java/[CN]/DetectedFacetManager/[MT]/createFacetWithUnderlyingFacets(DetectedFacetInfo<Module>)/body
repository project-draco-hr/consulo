{
  FacetInfo2<Module> underlyingInfo=detectedFacetInfo.getUnderlyingFacetInfo();
  final Facet underlyingFacet;
  if (underlyingInfo instanceof FacetInfoBackedByFacet) {
    underlyingFacet=((FacetInfoBackedByFacet)underlyingInfo).getFacet();
  }
 else   if (underlyingInfo instanceof DetectedFacetInfo) {
    underlyingFacet=createFacetWithUnderlyingFacets((DetectedFacetInfo<Module>)underlyingInfo);
  }
 else {
    underlyingFacet=null;
  }
  return createFacet(detectedFacetInfo,underlyingFacet);
}
