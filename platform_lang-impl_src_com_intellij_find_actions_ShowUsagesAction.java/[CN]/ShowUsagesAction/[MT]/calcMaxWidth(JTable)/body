{
  int colsNum=table.getColumnModel().getColumnCount();
  int totalWidth=0;
  for (int col=0; col < colsNum - 1; col++) {
    TableColumn column=table.getColumnModel().getColumn(col);
    int preferred=column.getPreferredWidth();
    int width=Math.max(preferred,columnMaxWidth(table,col));
    totalWidth+=width;
    column.setMinWidth(width);
    column.setMaxWidth(width);
    column.setWidth(width);
    column.setPreferredWidth(width);
  }
  totalWidth+=columnMaxWidth(table,colsNum - 1);
  return totalWidth;
}
