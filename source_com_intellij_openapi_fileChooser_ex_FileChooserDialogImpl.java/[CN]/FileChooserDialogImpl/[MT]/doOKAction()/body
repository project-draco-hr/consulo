{
  if (!isOKActionEnabled()) {
    return;
  }
  final VirtualFile[] selectedFiles=getSelectedFiles();
  try {
    myChooserDescriptor.validateSelectedFiles(selectedFiles);
  }
 catch (  Exception e) {
    Messages.showErrorDialog(getContentPane(),e.getMessage(),myChooserDescriptor.getTitle());
    return;
  }
  myChosenFiles=selectedFiles;
  if (selectedFiles.length == 0) {
    close(CANCEL_EXIT_CODE);
    return;
  }
  ourLastFile=selectedFiles[selectedFiles.length - 1];
  super.doOKAction();
}
