{
  if (!isOKActionEnabled()) {
    return;
  }
  if (ourTextFieldShown) {
    final String text=myPathTextField.getTextFieldText();
    if (text == null || myPathTextField.getFile() == null || !myPathTextField.getFile().exists()) {
      setErrorText("Specified path cannot be found");
      return;
    }
  }
  final VirtualFile[] selectedFiles=getSelectedFiles();
  try {
    myChooserDescriptor.validateSelectedFiles(selectedFiles);
  }
 catch (  Exception e) {
    Messages.showErrorDialog(getContentPane(),e.getMessage(),UIBundle.message("file.chooser.default.title"));
    return;
  }
  myChosenFiles=selectedFiles;
  if (selectedFiles.length == 0) {
    close(CANCEL_EXIT_CODE);
    return;
  }
  ourLastFile=selectedFiles[selectedFiles.length - 1];
  super.doOKAction();
}
