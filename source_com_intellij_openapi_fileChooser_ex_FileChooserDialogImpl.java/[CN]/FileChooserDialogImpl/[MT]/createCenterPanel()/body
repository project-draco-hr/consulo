{
  JPanel panel=new MyPanel();
  myTextUpdate=new MergingUpdateQueue("FileChooserUpdater",200,false,panel);
  Disposer.register(myDisposable,myTextUpdate);
  new UiNotifyConnector(panel,myTextUpdate);
  myFileLocator.start();
  Disposer.register(myDisposable,new Disposable(){
    public void dispose(){
      myFileLocator.dispose(true);
    }
  }
);
  panel.setBorder(BorderFactory.createEmptyBorder(0,0,0,0));
  createTree();
  final DefaultActionGroup group=createActionGroup();
  ActionToolbar toolBar=ActionManager.getInstance().createActionToolbar(ActionPlaces.UNKNOWN,group,true);
  final JPanel toolbarPanel=new JPanel(new BorderLayout());
  toolbarPanel.add(toolBar.getComponent(),BorderLayout.CENTER);
  myTextFieldAction=new TextFieldAction();
  toolbarPanel.add(myTextFieldAction,BorderLayout.EAST);
  myPathTextFieldWrapper=new JPanel(new BorderLayout());
  myPathTextFieldWrapper.setBorder(new EmptyBorder(0,0,2,0));
  myPathTextField=new JTextField();
  myPathTextFieldWrapper.add(myPathTextField,BorderLayout.CENTER);
  myPathTextField.getDocument().addDocumentListener(new DocumentListener(){
    public void insertUpdate(    final DocumentEvent e){
      updateTreeFromPath();
    }
    public void removeUpdate(    final DocumentEvent e){
      updateTreeFromPath();
    }
    public void changedUpdate(    final DocumentEvent e){
      updateTreeFromPath();
    }
  }
);
  myPathTextField.addKeyListener(new KeyAdapter(){
    public void keyPressed(    final KeyEvent e){
      processListNavigation(e);
    }
  }
);
  myPathTextField.addFocusListener(new FocusAdapter(){
    public void focusLost(    final FocusEvent e){
      closePopup();
    }
  }
);
  myNorthPanel=new JPanel(new BorderLayout());
  myNorthPanel.add(toolbarPanel,BorderLayout.NORTH);
  updateTextFieldShowing();
  panel.add(myNorthPanel,BorderLayout.NORTH);
  registerMouseListener(group);
  JScrollPane scrollPane=new JScrollPane(myFileSystemTree.getTree());
  scrollPane.setBorder(BorderFactory.createLineBorder(new Color(148,154,156)));
  panel.add(scrollPane,BorderLayout.CENTER);
  panel.setPreferredSize(new Dimension(400,400));
  return panel;
}
