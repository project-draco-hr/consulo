{
  if (!FileModificationService.getInstance().preparePsiElementsForWrite(element))   return;
  final XmlTag tag=(XmlTag)element.getParent();
  final String value;
  if (tag.getSubTags().length == 0) {
    value=tag.getValue().getText().trim();
  }
 else {
    value=StringUtil.join(tag.getSubTags(),new Function<XmlTag,String>(){
      @Override public String fun(      XmlTag childTag){
        final XmlAttribute valueAttr=childTag.getAttribute(FxmlConstants.FX_VALUE);
        if (valueAttr != null) {
          return valueAttr.getValue();
        }
        return "";
      }
    }
,", ");
  }
  final XmlAttribute attribute=XmlElementFactory.getInstance(project).createXmlAttribute(tag.getName(),value);
  final XmlTag parentTag=tag.getParentTag();
  parentTag.add(attribute);
  tag.delete();
}
