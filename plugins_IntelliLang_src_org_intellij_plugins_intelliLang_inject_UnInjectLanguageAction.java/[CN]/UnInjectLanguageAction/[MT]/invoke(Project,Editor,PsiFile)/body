{
  final PsiLanguageInjectionHost host=findInjectionHost(editor,file);
  try {
    if (defaultFunctionalityWorked(host))     return;
    for (    LanguageInjectorSupport support : Extensions.getExtensions(LanguageInjectorSupport.EP_NAME)) {
      if (support.removeInjectionInPlace(host))       return;
    }
    TemporaryPlacesRegistry.getInstance(project).removeHostWithUndo(project,host);
  }
  finally {
    FileContentUtil.reparseFiles(project,Collections.<VirtualFile>emptyList(),true);
  }
}
