{
  AbstractProjectViewPane currentPane=getCurrentProjectViewPane();
  PsiElement selectedPsiElement=null;
  Module selectedModule=null;
  if (currentPane != null) {
    if (currentPane != newPane) {
      currentPane.saveExpandedPaths();
    }
    final PsiElement[] elements=currentPane.getSelectedPSIElements();
    if (elements.length > 0) {
      selectedPsiElement=elements[0];
    }
 else {
      Object selected=currentPane.getSelectedElement();
      if (selected instanceof Module) {
        selectedModule=(Module)selected;
      }
    }
    Disposer.dispose(currentPane);
  }
  removeLabelFocusListener();
  myViewContentPanel.removeAll();
  JComponent component=newPane.createComponent();
  myViewContentPanel.setLayout(new BorderLayout());
  myViewContentPanel.add(component,BorderLayout.CENTER);
  myCurrentViewId=newPane.getId();
  String newSubId=myCurrentViewSubId=newPane.getSubId();
  myViewContentPanel.revalidate();
  myViewContentPanel.repaint();
  createToolbarActions();
  newPane.setTreeChangeListener(myTreeChangeListener);
  myAutoScrollToSourceHandler.install(newPane.myTree);
  newPane.getComponentToFocus().requestFocus();
  updateToolWindowTitle();
  showOrHideStructureView(isShowStructure());
  newPane.restoreExpandedPaths();
  if (selectedPsiElement != null) {
    VirtualFile virtualFile=PsiUtilBase.getVirtualFile(selectedPsiElement);
    if (((ProjectViewSelectInTarget)newPane.createSelectInTarget()).isSubIdSelectable(newSubId,virtualFile)) {
      newPane.select(selectedPsiElement,virtualFile,true);
    }
  }
 else   if (selectedModule != null) {
    newPane.select(selectedModule,selectedModule.getModuleFile(),true);
  }
  installLabelFocusListener();
}
