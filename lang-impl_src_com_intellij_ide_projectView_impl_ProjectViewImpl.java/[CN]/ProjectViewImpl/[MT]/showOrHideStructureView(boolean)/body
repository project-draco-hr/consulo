{
  boolean hadFocus=IJSwingUtilities.hasFocus2(getComponent());
  myStructureViewPanel.setVisible(toShow);
  setShowStructure(toShow,myCurrentViewId);
  if (hadFocus) {
    final AbstractProjectViewPane viewPane=getCurrentProjectViewPane();
    if (viewPane != null) {
      viewPane.getComponentToFocus().requestFocus();
    }
  }
  if (toShow) {
    VirtualFile[] files=myFileEditorManager.getSelectedFiles();
    FileEditor editor=files.length == 0 ? null : myFileEditorManager.getSelectedEditor(files[0]);
    myStructureViewWrapper.setFileEditor(editor);
  }
}
