{
  if (isIsReadOnly())   return;
  final boolean before=doesNotContainAnySpaces();
  final int lineFeedsBefore=getLineFeeds();
  action.run();
  if (isLineFeedsAreReadOnly()) {
    myLineFeeds=lineFeedsBefore;
  }
  if (isIsSafe()) {
    final boolean after=doesNotContainAnySpaces();
    if (before && !after) {
      mySpaces=0;
      myIndentSpaces=0;
      myLineFeeds=0;
    }
 else     if (!before && after) {
      mySpaces=1;
      myIndentSpaces=0;
    }
  }
}
