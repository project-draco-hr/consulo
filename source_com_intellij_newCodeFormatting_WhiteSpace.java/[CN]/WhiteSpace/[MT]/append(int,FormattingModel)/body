{
  final int oldEndOffset=myTextRange.getEndOffset();
  if (newEndOffset == oldEndOffset)   return;
  int oldLastLine=model.getLineNumber(oldEndOffset);
  int newLine=model.getLineNumber(newEndOffset);
  myTextRange=new TextRange(myTextRange.getStartOffset(),newEndOffset);
  final int lineIncrement=newLine - oldLastLine;
  if (lineIncrement > 0) {
    mySpaces=newEndOffset - model.getLineStartOffset(model.getLineNumber(newEndOffset));
  }
 else {
    mySpaces+=myTextRange.getEndOffset() - oldEndOffset;
  }
  myLineFeeds+=lineIncrement;
  myInitial=model.getText(myTextRange);
}
