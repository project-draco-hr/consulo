{
  final XmlElementDescriptor descriptor=tag.getDescriptor();
  final XmlNSDescriptor nsDescriptor=descriptor != null ? descriptor.getNSDescriptor() : null;
  XmlFile descriptorFile=nsDescriptor != null ? nsDescriptor.getDescriptorFile() : containingFile.getDocument().getProlog().getDoctype() != null ? containingFile : null;
  if (nsDescriptor != null && (descriptorFile == null || descriptorFile.getName().equals(containingFile.getName() + ".dtd"))) {
    descriptorFile=containingFile;
  }
  return descriptorFile;
}
