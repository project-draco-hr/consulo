{
  PsiExpression[] arguments=myArgumentList == null ? PsiExpression.EMPTY_ARRAY : myArgumentList.getExpressions();
  PsiTypeParameter[] typeParameters=method.getTypeParameterList().getTypeParameters();
  if (method.getSignature(substitutor).isRaw()) {
    return substitutor;
  }
  PsiResolveHelper helper=method.getManager().getResolveHelper();
  for (int i=0; i < typeParameters.length; i++) {
    final PsiTypeParameter typeParameter=typeParameters[i];
    final PsiParameter[] parameters=method.getParameterList().getParameters();
    PsiType substitution=helper.inferTypeForMethodTypeParameter(typeParameter,parameters,arguments,substitutor,myArgumentList.getParent());
    if (substitution == null)     return createRawSubstitutor(substitutor,typeParameters);
    if (substitution == PsiType.NULL)     continue;
    if (substitution == PsiType.NULL || substitution == PsiType.VOID)     substitution=null;
    substitutor=substitutor.put(typeParameter,substitution);
  }
  return substitutor;
}
