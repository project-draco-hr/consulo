{
  PsiMethod method=getElement();
  PsiSubstitutor partialSubstitutor=mySubstitutor;
  PsiExpression[] arguments=myArgumentList == null ? PsiExpression.EMPTY_ARRAY : myArgumentList.getExpressions();
  PsiTypeParameter[] typeParameters=method.getTypeParameters();
  if (!method.hasModifierProperty(PsiModifier.STATIC)) {
    final PsiClass containingClass=method.getContainingClass();
    if (containingClass != null && PsiUtil.isRawSubstitutor(containingClass,partialSubstitutor)) {
      return createRawSubstitutor(partialSubstitutor,typeParameters);
    }
  }
  PsiResolveHelper helper=method.getManager().getResolveHelper();
  return helper.inferTypeArguments(typeParameters,method.getParameterList().getParameters(),arguments,partialSubstitutor,myArgumentList.getParent(),forCompletion);
}
