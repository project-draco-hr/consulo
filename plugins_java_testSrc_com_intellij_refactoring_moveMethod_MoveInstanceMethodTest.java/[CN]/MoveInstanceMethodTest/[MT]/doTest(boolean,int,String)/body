{
  final String filePath="/refactoring/moveInstanceMethod/" + getTestName(false) + ".java";
  configureByFile(filePath);
  final PsiElement targetElement=TargetElementUtilBase.findTargetElement(getEditor(),TargetElementUtilBase.ELEMENT_NAME_ACCEPTED);
  assertTrue("<caret> is not on method name",targetElement instanceof PsiMethod);
  PsiMethod method=(PsiMethod)targetElement;
  final PsiVariable targetVariable=isTargetParameter ? method.getParameterList().getParameters()[targetIndex] : method.getContainingClass().getFields()[targetIndex];
  new MoveInstanceMethodProcessor(getProject(),method,targetVariable,newVisibility,MoveInstanceMethodHandler.suggestParameterNames(method,targetVariable)).run();
  checkResultByFile(filePath + ".after");
}
