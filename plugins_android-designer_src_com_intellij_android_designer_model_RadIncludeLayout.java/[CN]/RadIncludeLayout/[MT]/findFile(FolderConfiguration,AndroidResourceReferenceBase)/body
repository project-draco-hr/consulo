{
  PsiElement[] elements=reference.computeTargetElements();
  if (elements.length == 0) {
    return null;
  }
  if (elements.length == 1) {
    return (XmlFile)elements[0];
  }
  List<MyConfigurable> configurables=new ArrayList<MyConfigurable>();
  for (  PsiElement element : elements) {
    XmlFile xmlFile=(XmlFile)element;
    VirtualFile file=xmlFile.getVirtualFile();
    if (file == null) {
      continue;
    }
    VirtualFile folder=file.getParent();
    if (folder == null) {
      continue;
    }
    FolderConfiguration includeConfig=FolderConfiguration.getConfig(folder.getName().split(AndroidConstants.RES_QUALIFIER_SEP));
    configurables.add(new MyConfigurable(xmlFile,includeConfig));
  }
  MyConfigurable configurable=(MyConfigurable)configuration.findMatchingConfigurable(configurables);
  return configurable == null ? null : configurable.getFile();
}
