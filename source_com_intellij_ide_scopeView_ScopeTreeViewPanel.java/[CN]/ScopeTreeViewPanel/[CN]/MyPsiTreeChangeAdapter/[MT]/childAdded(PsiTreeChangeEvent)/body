{
  final PsiElement element=event.getParent();
  final PsiElement child=event.getChild();
  if (child == null)   return;
  if (element instanceof PsiDirectory || element instanceof PsiPackage) {
    queueUpdate(new Runnable(){
      public void run(){
        if (myProject.isDisposed())         return;
        myTreeExpansionMonitor.freeze();
        if (!child.isValid())         return;
        if (child instanceof PsiFile) {
          processFileAddition((PsiFile)child);
        }
 else         if (child instanceof PsiDirectory) {
          processDirectoryCreation((PsiDirectory)child);
        }
        myTreeExpansionMonitor.restore();
      }
    }
,false);
  }
}
