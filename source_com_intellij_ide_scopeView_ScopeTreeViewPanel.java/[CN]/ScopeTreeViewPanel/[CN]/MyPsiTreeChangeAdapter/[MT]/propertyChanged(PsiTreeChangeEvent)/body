{
  String propertyName=event.getPropertyName();
  final PsiElement element=event.getElement();
  if (element != null && element.isValid()) {
    final NamedScope scope=getCurrentScope();
    if (propertyName.equals(PsiTreeChangeEvent.PROP_FILE_NAME) || propertyName.equals(PsiTreeChangeEvent.PROP_FILE_TYPES)) {
      queueUpdate(new Runnable(){
        public void run(){
          processFileRenamed(scope,element.getContainingFile());
        }
      }
,false);
    }
 else     if (propertyName.equals(PsiTreeChangeEvent.PROP_DIRECTORY_NAME)) {
      queueRefreshScope(scope);
    }
  }
}
