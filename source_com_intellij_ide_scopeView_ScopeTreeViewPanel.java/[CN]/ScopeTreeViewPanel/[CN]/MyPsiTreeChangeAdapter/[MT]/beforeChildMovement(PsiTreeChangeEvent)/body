{
  final PsiElement oldParent=event.getOldParent();
  final PsiElement newParent=event.getNewParent();
  final PsiElement child=event.getChild();
  if (oldParent instanceof PsiDirectory && newParent instanceof PsiDirectory) {
    if (child instanceof PsiFile) {
      queueUpdate(new Runnable(){
        public void run(){
          if (myProject.isDisposed())           return;
          myTreeExpansionMonitor.freeze();
          collapseExpand(myBuilder.removeNode(child,(PsiDirectory)oldParent));
          collapseExpand(myBuilder.addFileNode((PsiFile)child));
          myTreeExpansionMonitor.restore();
        }
      }
,true);
    }
  }
}
