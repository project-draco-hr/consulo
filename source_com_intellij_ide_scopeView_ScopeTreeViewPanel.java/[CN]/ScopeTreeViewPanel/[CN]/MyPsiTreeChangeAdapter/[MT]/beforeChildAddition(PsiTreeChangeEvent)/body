{
  ApplicationManager.getApplication().invokeLater(new Runnable(){
    public void run(){
      final PsiElement element=event.getParent();
      if (element instanceof PsiDirectory || element instanceof PsiPackage) {
        final PsiElement child=event.getChild();
        if (child instanceof PsiFile) {
          final PackageDependenciesNode rootToReload=myBuilder.addFileNode((PsiFile)child);
          final DefaultTreeModel treeModel=(DefaultTreeModel)myTree.getModel();
          if (rootToReload != null) {
            TreeUtil.sort(rootToReload,new DependecyNodeComparator());
            treeModel.reload(rootToReload);
          }
 else {
            TreeUtil.sort(treeModel,new DependecyNodeComparator());
            treeModel.reload();
          }
        }
      }
    }
  }
,ModalityState.NON_MMODAL);
}
