{
  final List<AbstractFilePatchInProgress.PatchChange> selectedChanges=myChangesTreeList.getSelectedChanges();
  if ((selectedChanges.size() >= 1) && (sameBase(selectedChanges))) {
    final AbstractFilePatchInProgress.PatchChange patchChange=selectedChanges.get(0);
    final AbstractFilePatchInProgress patch=patchChange.getPatchInProgress();
    final List<VirtualFile> autoBases=patch.getAutoBasesCopy();
    if (autoBases.isEmpty() || (autoBases.size() == 1 && autoBases.get(0).equals(patch.getBase()))) {
      myNewBaseSelector.run();
    }
 else {
      autoBases.add(null);
      final MapPopup step=new MapPopup(autoBases,myNewBaseSelector);
      JBPopupFactory.getInstance().createListPopup(step).showCenteredInCurrentWindow(myProject);
    }
  }
}
