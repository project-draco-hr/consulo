{
  final String forkMode=myConfiguration.getForkMode();
  if (Comparing.strEqual(forkMode,"none"))   return;
  if (myRunnerSettings.getData() instanceof DebuggingRunnerData) {
    throw new CantRunException("Debug is disabled in fork mode. <br> Change fork mode to &lt;none&gt; to debug");
  }
  File tempFile=null;
  try {
    tempFile=FileUtil.createTempFile("command.line","");
    myJavaParameters.getProgramParametersList().add("@@@" + tempFile.getAbsolutePath());
  }
 catch (  IOException e) {
    LOG.error(e);
  }
  final JavaParameters javaParameters=getJavaParameters();
  try {
    final PrintWriter writer=new PrintWriter(tempFile,"UTF-8");
    try {
      writer.print(GeneralCommandLine.quoteParameter(((JavaSdkType)javaParameters.getJdk().getSdkType()).getVMExecutablePath(javaParameters.getJdk())) + " ");
      writer.print(javaParameters.getVMParametersList().getParametersString() + " ");
      writer.print("-classpath ");
      writer.print(GeneralCommandLine.quoteParameter(javaParameters.getClassPath().getPathsString()));
      writer.print("\n" + forkMode);
    }
  finally {
      writer.close();
    }
    tempFile.deleteOnExit();
  }
 catch (  Exception e) {
    LOG.error(e);
  }
}
