{
  try {
    if (createTempFile) {
      myTempFile=File.createTempFile("idea_junit",".tmp");
      myTempFile.deleteOnExit();
      myJavaParameters.getProgramParametersList().add("@" + myTempFile.getAbsolutePath());
    }
    final PrintWriter writer=new PrintWriter(new FileWriter(myTempFile));
    try {
      writer.println(junit4 ? JUnitStarter.JUNIT4_PARAMETER : "-junit3");
      writer.println(packageName);
      final List<String> testNames=new ArrayList<String>();
      for (      final T element : elements) {
        final String name=nameFunction.fun(element);
        if (name == null) {
          LOG.error("invalid element " + element);
          return;
        }
        testNames.add(name);
      }
      Collections.sort(testNames);
      for (      String testName : testNames) {
        writer.println(testName);
      }
    }
  finally {
      writer.close();
    }
  }
 catch (  IOException e) {
    LOG.error(e);
  }
}
