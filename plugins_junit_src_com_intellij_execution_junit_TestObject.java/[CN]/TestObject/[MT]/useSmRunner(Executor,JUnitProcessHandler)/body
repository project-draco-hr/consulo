{
  TestConsoleProperties testConsoleProperties=new SMTRunnerConsoleProperties(new RuntimeConfigurationProducer.DelegatingRuntimeConfiguration<JUnitConfiguration>((JUnitConfiguration)myEnvironment.getRunProfile()),JUNIT_TEST_FRAMEWORK_NAME,executor);
  testConsoleProperties.setIfUndefined(TestConsoleProperties.HIDE_PASSED_TESTS,false);
  BaseTestsOutputConsoleView smtConsoleView=SMTestRunnerConnectionUtil.createConsoleWithCustomLocator(JUNIT_TEST_FRAMEWORK_NAME,testConsoleProperties,myEnvironment,null);
  Disposer.register(myProject,smtConsoleView);
  final ConsoleView consoleView=smtConsoleView;
  consoleView.attachToProcess(handler);
  final RerunFailedTestsAction rerunFailedTestsAction=new RerunFailedTestsAction(consoleView);
  rerunFailedTestsAction.init(testConsoleProperties,myEnvironment);
  rerunFailedTestsAction.setModelProvider(new Getter<TestFrameworkRunningModel>(){
    @Override public TestFrameworkRunningModel get(){
      return ((SMTRunnerConsoleView)consoleView).getResultsViewer();
    }
  }
);
  final DefaultExecutionResult result=new DefaultExecutionResult(consoleView,handler);
  result.setRestartActions(rerunFailedTestsAction);
  return result;
}
