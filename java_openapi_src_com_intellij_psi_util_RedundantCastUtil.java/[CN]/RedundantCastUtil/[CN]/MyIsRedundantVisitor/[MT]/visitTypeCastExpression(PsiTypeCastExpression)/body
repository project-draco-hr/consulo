{
  PsiExpression operand=typeCast.getOperand();
  if (operand == null)   return;
  PsiElement expr=deparenthesizeExpression(operand);
  if (expr instanceof PsiTypeCastExpression) {
    PsiTypeElement typeElement=((PsiTypeCastExpression)expr).getCastType();
    if (typeElement == null)     return;
    PsiType castType=typeElement.getType();
    if (!(castType instanceof PsiPrimitiveType)) {
      addToResults((PsiTypeCastExpression)expr);
    }
  }
 else {
    PsiElement parent=typeCast.getParent();
    if (parent instanceof PsiConditionalExpression) {
      if (!PsiUtil.isLanguageLevel5OrHigher(typeCast)) {
        if (!Comparing.equal(operand.getType(),((PsiConditionalExpression)parent).getType()))         return;
      }
    }
 else     if (parent instanceof PsiTypeCastExpression) {
      PsiTypeElement typeElement=((PsiTypeCastExpression)parent).getCastType();
      if (typeElement != null) {
        PsiType castType=typeElement.getType();
        if (castType instanceof PsiPrimitiveType) {
          final PsiType operandType=operand.getType();
          if (!(operandType instanceof PsiPrimitiveType) && PsiPrimitiveType.getUnboxedType(operandType) != castType) {
            return;
          }
        }
      }
    }
    processAlreadyHasTypeCast(typeCast);
  }
  super.visitTypeCastExpression(typeCast);
}
