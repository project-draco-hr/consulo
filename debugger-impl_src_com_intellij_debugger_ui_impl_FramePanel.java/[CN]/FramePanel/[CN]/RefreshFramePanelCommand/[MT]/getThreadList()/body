{
  final java.util.List<ThreadReferenceProxyImpl> threads=new ArrayList<ThreadReferenceProxyImpl>(getSuspendContext().getDebugProcess().getVirtualMachineProxy().allThreads());
  Collections.sort(threads,ThreadReferenceProxyImpl.ourComparator);
  final java.util.List<ThreadDescriptorImpl> descriptors=new ArrayList<ThreadDescriptorImpl>(threads.size());
  EvaluationContextImpl evaluationContext=getDebuggerContext().createEvaluationContext();
  for (Iterator<ThreadReferenceProxyImpl> iterator=threads.iterator(); iterator.hasNext(); ) {
    ThreadReferenceProxyImpl thread=iterator.next();
    ThreadDescriptorImpl threadDescriptor=new ThreadDescriptorImpl(thread);
    threadDescriptor.setContext(evaluationContext);
    threadDescriptor.updateRepresentation(evaluationContext,DescriptorLabelListener.DUMMY_LISTENER);
    descriptors.add(threadDescriptor);
  }
  return descriptors;
}
