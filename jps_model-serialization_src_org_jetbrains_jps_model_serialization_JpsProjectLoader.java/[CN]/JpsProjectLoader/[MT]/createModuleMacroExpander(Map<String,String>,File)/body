{
  final JpsMacroExpander expander=new JpsMacroExpander(pathVariables);
  String moduleDirPath=PathMacroUtil.getModuleDir(moduleFile.getAbsolutePath());
  if (moduleDirPath != null) {
    expander.addFileHierarchyReplacements(PathMacroUtil.MODULE_DIR_MACRO_NAME,new File(FileUtil.toSystemDependentName(moduleDirPath)));
  }
  return expander;
}
