{
  File file=new File(projectPath).getCanonicalFile();
  if (file.isFile() && projectPath.endsWith(".ipr")) {
    new JpsProjectLoader(project,pathVariables,file.getParentFile()).loadFromIpr(file);
  }
 else {
    File directory;
    if (file.isDirectory() && file.getName().equals(PathMacroUtil.DIRECTORY_STORE_NAME)) {
      directory=file;
    }
 else {
      directory=new File(file,PathMacroUtil.DIRECTORY_STORE_NAME);
      if (!directory.isDirectory()) {
        throw new IOException("Cannot find IntelliJ IDEA project files at " + projectPath);
      }
    }
    new JpsProjectLoader(project,pathVariables,directory.getParentFile()).loadFromDirectory(directory);
  }
}
