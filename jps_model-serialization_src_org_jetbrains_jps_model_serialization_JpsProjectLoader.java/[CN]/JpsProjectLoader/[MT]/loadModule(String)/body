{
  final File file=new File(path);
  String name=FileUtil.getNameWithoutExtension(file);
  final JpsMacroExpander expander=new JpsMacroExpander(myPathVariables);
  expander.addFileHierarchyReplacements("MODULE_DIR",file.getParentFile());
  final Element moduleRoot=loadRootElement(file,expander);
  final String typeId=moduleRoot.getAttributeValue("type");
  final JpsModulePropertiesLoader<?> loader=getModulePropertiesLoader(typeId);
  final JpsModule module=createModule(name,moduleRoot,loader);
  JpsModuleLoader.loadRootModel(module,findComponent(moduleRoot,"NewModuleRootManager"));
  return module;
}
