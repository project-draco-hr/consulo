{
  final File file=new File(path);
  String name=FileUtil.getNameWithoutExtension(file);
  final JpsMacroExpander expander=createModuleMacroExpander(myPathVariables,file);
  final Element moduleRoot=loadRootElement(file,expander);
  final String typeId=moduleRoot.getAttributeValue("type");
  final JpsModulePropertiesSerializer<?> serializer=getModulePropertiesSerializer(typeId);
  final JpsModule module=createModule(name,moduleRoot,serializer);
  JpsModuleSerializer.loadRootModel(module,JDomSerializationUtil.findComponent(moduleRoot,"NewModuleRootManager"),projectSdkType);
  final String moduleDirPath=file.getParent();
  JpsFacetSerializer.loadFacets(module,JDomSerializationUtil.findComponent(moduleRoot,"FacetManager"),FileUtil.toSystemIndependentName(moduleDirPath));
  return module;
}
