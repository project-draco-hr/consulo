{
  final int delta=bytes.getLength();
  if (delta == 0)   return;
synchronized (myLock) {
    int capacity=myRecordsTable.getCapacity(record);
    int oldSize=myRecordsTable.getSize(record);
    int newSize=oldSize + delta;
    if (newSize > capacity) {
      if (oldSize > 0) {
        final byte[] newbytes=new byte[newSize];
        System.arraycopy(readBytes(record),0,newbytes,0,oldSize);
        System.arraycopy(bytes.getBytes(),bytes.getOffset(),newbytes,oldSize,delta);
        writeBytes(record,new ByteSequence(newbytes),false);
      }
 else {
        writeBytes(record,bytes,false);
      }
    }
 else {
      long address=myRecordsTable.getAddress(record) + oldSize;
      myDataTable.writeBytes(address,bytes.getBytes(),bytes.getOffset(),bytes.getLength());
      myRecordsTable.setSize(record,newSize);
    }
  }
}
