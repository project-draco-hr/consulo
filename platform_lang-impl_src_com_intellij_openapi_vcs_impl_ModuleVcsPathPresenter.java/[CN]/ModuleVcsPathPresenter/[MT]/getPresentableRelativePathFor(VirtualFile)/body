{
  if (file == null)   return "";
  return ApplicationManager.getApplication().runReadAction(new Computable<String>(){
    public String compute(){
      ProjectFileIndex fileIndex=ProjectRootManager.getInstance(myProject).getFileIndex();
      Module module=fileIndex.getModuleForFile(file);
      VirtualFile contentRoot=fileIndex.getContentRootForFile(file);
      if (module == null || contentRoot == null)       return file.getPresentableUrl();
      StringBuffer result=new StringBuffer();
      result.append("[");
      result.append(module.getName());
      result.append("] ");
      result.append(contentRoot.getName());
      String relativePath=VfsUtil.getRelativePath(file,contentRoot,File.separatorChar);
      if (relativePath.length() > 0) {
        result.append(File.separatorChar);
        result.append(relativePath);
      }
      return result.toString();
    }
  }
);
}
