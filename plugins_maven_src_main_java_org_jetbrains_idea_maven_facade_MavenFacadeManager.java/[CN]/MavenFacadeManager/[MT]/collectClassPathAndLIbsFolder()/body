{
  File pluginFileOrDir=new File(PathUtil.getJarPathForClass(MavenFacadeManager.class));
  File libDir;
  List<File> classpath=new SmartList<File>();
  if (pluginFileOrDir.isDirectory()) {
    classpath.add(new File(pluginFileOrDir.getParent(),"maven-facade-api"));
    classpath.add(new File(pluginFileOrDir.getParent(),"maven-facade-impl"));
    File luceneLib=new File(PathUtil.getJarPathForClass(Query.class));
    libDir=new File(luceneLib.getParentFile().getParentFile().getParentFile(),"facade-impl/lib");
  }
 else {
    libDir=pluginFileOrDir.getParentFile();
  }
  MavenLog.LOG.assertTrue(libDir.exists() && libDir.isDirectory(),"Maven Facade libraries dir not found: " + libDir);
  File[] files=libDir.listFiles();
  for (  File jar : files) {
    if (jar.isFile() && jar.getName().endsWith(".jar") && !jar.equals(pluginFileOrDir)) {
      classpath.add(jar);
    }
  }
  return Pair.create(classpath,libDir);
}
