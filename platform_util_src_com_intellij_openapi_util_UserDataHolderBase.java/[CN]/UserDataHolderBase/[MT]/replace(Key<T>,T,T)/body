{
  while (true) {
    SmartFMap<Key,Object> map=myUserMap;
    if (map.get(key) != oldValue) {
      return false;
    }
    SmartFMap<Key,Object> newMap=newValue == null ? map.minus(key) : map.plus(key,newValue);
    if (newMap == map || updater.compareAndSet(this,map,newMap)) {
      return true;
    }
  }
}
