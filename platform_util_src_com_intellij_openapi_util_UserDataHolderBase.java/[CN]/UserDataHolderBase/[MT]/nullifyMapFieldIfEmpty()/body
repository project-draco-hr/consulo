{
  try {
    while (true) {
      StripedLockConcurrentHashMap<Key,Object> map=(StripedLockConcurrentHashMap<Key,Object>)myUserMap;
      if (map == null || !map.isEmpty())       break;
      map.blockModification();
      ConcurrentMap<Key,Object> newMap;
      if (map.isEmpty()) {
        newMap=null;
      }
 else {
        newMap=createDataMap(map.size());
        newMap.putAll(map);
      }
      boolean replaced=updater.compareAndSet(this,map,newMap);
      if (replaced)       break;
    }
  }
 catch (  ConcurrentModificationException ignored) {
  }
}
