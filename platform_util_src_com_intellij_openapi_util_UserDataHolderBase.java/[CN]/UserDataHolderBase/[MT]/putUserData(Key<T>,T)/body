{
  while (true) {
    try {
      if (value == null) {
        ConcurrentMap<Key,Object> map=myUserMap;
        if (map == null)         break;
        T previous=(T)map.remove(key);
        boolean removed=previous != null;
        if (removed) {
          nullifyMapFieldIfEmpty();
        }
      }
 else {
        Map<Key,Object> map=getOrCreateMap();
        map.put(key,value);
      }
      break;
    }
 catch (    ConcurrentModificationException ignored) {
    }
  }
}
