{
  TreeElement first=null;
  TreeElement last=null;
  while (isTokenValid(lexer.getTokenType())) {
    TreeElement tokenElement=ASTFactory.leaf(lexer.getTokenType(),context.tokenText(lexer));
    IElementType type=lexer.getTokenType();
    if (!isInSet(type)) {
      LOG.error("Missed token should be white space or comment:" + tokenElement);
      throw new RuntimeException();
    }
    if (last != null) {
      last.setTreeNext(tokenElement);
      tokenElement.setTreePrev(last);
      last=tokenElement;
    }
 else {
      first=last=tokenElement;
    }
    lexer.advance();
  }
  return first;
}
