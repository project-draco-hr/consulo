{
  final TextRange textRange=el.getTextRange();
  final AntFile file=getAntFile(el);
  if (file == null) {
    return;
  }
  AntElement element=file.lightFindElementAt(textRange.getStartOffset());
  final boolean shouldInvalidateProperties=element instanceof AntProperty;
  if (element instanceof AntTypeDef) {
    ((AntTypeDef)element).clearClassesCache();
  }
  if (element != null && element.isValid()) {
    if (element instanceof AntMacroDef || element instanceof AntPresetDef || element instanceof AntScriptDef) {
      element.clearCaches();
    }
  }
  if (element != null) {
    do {
      element=element.getAntParent();
    }
 while (element != null && !(element instanceof AntFile) && (!element.isValid() || element.getTextLength() <= textRange.getLength() || element instanceof AntOuterProjectElement));
  }
  if (element == null) {
    element=file;
  }
synchronized (PsiLock.LOCK) {
    element.clearCaches();
    if (shouldInvalidateProperties) {
      file.invalidateProperties();
    }
    final AntMacroDef macrodef=PsiTreeUtil.getParentOfType(element,AntMacroDef.class,false,true);
    if (macrodef != null) {
      macrodef.clearCaches();
    }
    final AntPresetDef presetdef=PsiTreeUtil.getParentOfType(element,AntPresetDef.class,false,true);
    if (presetdef != null) {
      presetdef.clearCaches();
    }
    final AntScriptDef scriptdef=PsiTreeUtil.getParentOfType(element,AntScriptDef.class,false,true);
    if (scriptdef != null) {
      scriptdef.clearCaches();
    }
    final AntTypeDef typeDef=PsiTreeUtil.getParentOfType(element,AntTypeDef.class,false,true);
    if (typeDef != null) {
      typeDef.clearCaches();
    }
  }
  updateBuildFile(file);
}
