{
  if (!EventQueue.isDispatchThread()) {
    EventQueue.invokeLater(new Runnable(){
      public void run(){
        updateBuildFile(file);
      }
    }
);
  }
 else {
    final Project project=file.getProject();
    if (project.isDisposed()) {
      return;
    }
    final VirtualFile vFile=file.getVirtualFile();
    for (    final AntBuildFile buildFile : AntConfiguration.getInstance(project).getBuildFiles()) {
      if (Comparing.equal(vFile,buildFile.getVirtualFile())) {
synchronized (myDirtyFiles) {
          myDirtyFiles.add(buildFile);
        }
        myAlarm.cancelAllRequests();
        myAlarm.addRequest(new Runnable(){
          public void run(){
            AntBuildFile[] files=null;
synchronized (myDirtyFiles) {
              if (myDirtyFiles.size() > 0) {
                files=myDirtyFiles.toArray(new AntBuildFile[myDirtyFiles.size()]);
                myDirtyFiles.clear();
              }
            }
            if (files != null) {
              for (              final AntBuildFile dirtyFile : files) {
                final Project proj=dirtyFile.getProject();
                if (!proj.isDisposed()) {
                  AntConfiguration.getInstance(project).updateBuildFile(dirtyFile);
                }
              }
            }
          }
        }
,300);
        break;
      }
    }
  }
}
