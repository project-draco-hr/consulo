{
  editor.getCaretModel().runForEachCaret(new CaretAction(){
    @Override public void perform(    Caret caret){
      insertStringAtCaretNoScrolling(editor,str,toProcessOverwriteMode,true,caretShift);
    }
  }
);
  editor.getScrollingModel().scrollToCaret(ScrollType.RELATIVE);
}
