{
  EditorCopyPasteHelper helper=EditorCopyPasteHelper.getInstance();
  if (producer == null) {
    TextRange[] ranges=helper.pasteFromClipboard(editor);
    return ranges != null && ranges.length == 1 ? ranges[0] : null;
  }
  Transferable transferable=producer.produce();
  if (transferable == null) {
    return null;
  }
  TextRange[] ranges=helper.pasteTransferable(editor,transferable);
  return ranges != null && ranges.length == 1 ? ranges[0] : null;
}
