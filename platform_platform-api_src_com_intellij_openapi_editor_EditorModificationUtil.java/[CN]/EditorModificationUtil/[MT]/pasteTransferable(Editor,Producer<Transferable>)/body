{
  String text=getStringContent(producer);
  if (text == null)   return null;
  if (editor.getCaretModel().supportsMultipleCarets()) {
    int caretCount=editor.getCaretModel().getAllCarets().size();
    final Iterator<String> segments=new ClipboardTextPerCaretSplitter().split(text,caretCount).iterator();
    editor.getCaretModel().runForEachCaret(new CaretAction(){
      @Override public void perform(      Caret caret){
        insertStringAtCaret(editor,segments.next(),false,true);
      }
    }
);
    return null;
  }
 else {
    int caretOffset=editor.getCaretModel().getOffset();
    insertStringAtCaret(editor,text,false,true);
    return new TextRange(caretOffset,caretOffset + text.length());
  }
}
