{
  Transferable content=getTransferable(producer);
  if (content == null)   return;
  String text=getStringContent(content);
  if (text == null)   return;
  int caretLine=editor.getCaretModel().getLogicalPosition().line;
  LogicalPosition caretToRestore=editor.getCaretModel().getLogicalPosition();
  String[] lines=LineTokenizer.tokenize(text.toCharArray(),false);
  int longestLineLength=0;
  for (int i=0; i < lines.length; i++) {
    String line=lines[i];
    longestLineLength=Math.max(longestLineLength,line.length());
    editor.getCaretModel().moveToLogicalPosition(new LogicalPosition(caretLine + i,caretToRestore.column));
    insertStringAtCaret(editor,line,false,true);
  }
  caretToRestore=new LogicalPosition(caretLine,caretToRestore.column + longestLineLength);
  editor.getCaretModel().moveToLogicalPosition(caretToRestore);
  zeroWidthBlockSelectionAtCaretColumn(editor,caretLine,caretLine);
}
