{
  int result=insertStringAtCaretNoScrolling(editor,s,toProcessOverwriteMode,toMoveCaret,caretShift);
  if (toMoveCaret && editor.getCaretModel().getCurrentCaret() == editor.getCaretModel().getPrimaryCaret()) {
    editor.getScrollingModel().scrollToCaret(ScrollType.RELATIVE);
  }
  return result;
}
