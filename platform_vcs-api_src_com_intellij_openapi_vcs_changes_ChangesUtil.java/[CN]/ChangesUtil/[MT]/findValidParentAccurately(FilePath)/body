{
  if (filePath.getVirtualFile() != null)   return filePath.getVirtualFile();
  final LocalFileSystem lfs=LocalFileSystem.getInstance();
  VirtualFile result=lfs.findFileByIoFile(filePath.getIOFile());
  if (result != null)   return result;
  if (!ApplicationManager.getApplication().isReadAccessAllowed()) {
    result=lfs.refreshAndFindFileByIoFile(filePath.getIOFile());
    if (result != null)     return result;
  }
  return getValidParentUnderReadAction(filePath);
}
