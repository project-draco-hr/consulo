{
  ((ApplicationImpl)ApplicationManager.getApplication()).editorPaintStart();
  try {
    UIUtil.paintWithRetina(getSize(),g,myEditor.paintBlockCaret(),new Consumer<Graphics2D>(){
      @Override public void consume(      Graphics2D graphics){
        UIUtil.setupComposite(graphics);
        UISettings.setupAntialiasing(graphics);
        myEditor.paint(graphics);
      }
    }
);
  }
  finally {
    ((ApplicationImpl)ApplicationManager.getApplication()).editorPaintFinish();
  }
}
