{
  if (myDocument.isInBulkUpdate())   return;
  if (myDocument.isInEventsHandling()) {
    myDocumentChangeStartOffset=Math.min(myDocumentChangeStartOffset,startOffset);
    myDocumentChangeEndOffset=Math.max(myDocumentChangeEndOffset,endOffset);
  }
 else   if (myFoldingChangeEndOffset != Integer.MIN_VALUE) {
    myFoldingChangeStartOffset=Math.min(myFoldingChangeStartOffset,startOffset);
    myFoldingChangeEndOffset=Math.max(myFoldingChangeEndOffset,endOffset);
  }
 else {
    doInvalidateRange(startOffset,endOffset);
  }
}
