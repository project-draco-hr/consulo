{
  if (!XmlCompletionContributor.isXmlNameCompletion(parameters)) {
    return;
  }
  result.stopHere();
  if (!(element.getParent() instanceof XmlTag)) {
    return;
  }
  final XmlTag tag=(XmlTag)element.getParent();
  final XmlTag parentTag=tag.getParentTag();
  final PsiFile file=tag.getContainingFile().getOriginalFile();
  if (!(file instanceof XmlFile))   return;
  XSModel xsModel=ApplicationManager.getApplication().runReadAction(new NullableComputable<XSModel>(){
    @Override public XSModel compute(){
      return getXSModel((XmlFile)file);
    }
  }
);
  if (xsModel != null) {
    processXsModel(result,tag,parentTag,xsModel);
    return;
  }
  ApplicationManager.getApplication().runReadAction(new Runnable(){
    @Override public void run(){
      processDtd(result,tag,parentTag);
    }
  }
);
}
