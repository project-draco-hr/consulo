def wrapgetresponse(cls):
    'Wraps getresponse in cls with a broken-pipe sane version.\n    '

    def safegetresponse(self):
        r = getattr(self, '_broken_pipe_resp', None)
        if (r is not None):
            return r
        return cls.getresponse(self)
    safegetresponse.__doc__ = cls.getresponse.__doc__
    return safegetresponse
