def get_ready_conn(self, host):
    conn = None
    self._lock.acquire()
    try:
        if (host in self._hostmap):
            for c in self._hostmap[host]:
                if self._readymap[c]:
                    self._readymap[c] = 0
                    conn = c
                    break
    finally:
        self._lock.release()
    return conn
