def instance(self, ui, url, create):
    url = url.split('://', 1)[1]
    parts = url.split('/', self.parts)
    if (len(parts) > self.parts):
        tail = parts[(-1)]
        parts = parts[:(-1)]
    else:
        tail = ''
    context = dict(((str((i + 1)), v) for (i, v) in enumerate(parts)))
    url = (''.join(self.templater.process(self.url, context)) + tail)
    return hg._lookup(url).instance(ui, url, create)
