{
  VersionedMap<K,V> map=CACHE.get();
  if (version != map.version) {
    CACHE.remove();
    map=CACHE.get();
  }
  List<V> cached=map.get(key);
  if (cached == null) {
    Collection<V> templates=initialValue(key);
    cached=cloneTemplates(templates);
    map.put(key,cached);
  }
  return cached;
}
