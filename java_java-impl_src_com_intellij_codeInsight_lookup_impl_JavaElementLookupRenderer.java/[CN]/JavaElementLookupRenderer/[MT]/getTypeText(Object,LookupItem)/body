{
  String text=null;
  if (o instanceof PsiElement) {
    final PsiElement element=(PsiElement)o;
    if (element.isValid()) {
      if (element instanceof PsiVariable) {
        PsiVariable variable=(PsiVariable)element;
        PsiType type=variable.getType();
        if (item instanceof VariableLookupItem) {
          type=((VariableLookupItem)item).getSubstitutor().substitute(type);
        }
        text=type.getPresentableText();
      }
 else       if (element instanceof PsiExpression) {
        PsiExpression expression=(PsiExpression)element;
        PsiType type=expression.getType();
        if (type != null) {
          text=type.getPresentableText();
        }
      }
 else       if (element instanceof BeanPropertyElement) {
        return getTypeText(item,((BeanPropertyElement)element).getPropertyType());
      }
    }
  }
  return text;
}
