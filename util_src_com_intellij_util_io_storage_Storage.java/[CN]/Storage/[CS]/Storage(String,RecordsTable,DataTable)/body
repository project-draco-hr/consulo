{
  myRecordsTable=recordsTable;
  myDataTable=dataTable;
  myAppendersCache.addDeletedPairsListener(new IntObjectCache.DeletedPairsListener(){
    public void objectRemoved(    final int record,    final Object value){
      try {
        AppenderStream stream=(AppenderStream)value;
        stream.realClose();
      }
 catch (      IOException e) {
        throw new RuntimeException(e);
      }
    }
  }
);
  if (myDataTable.isCompactNecessary()) {
    compact(path);
  }
}
