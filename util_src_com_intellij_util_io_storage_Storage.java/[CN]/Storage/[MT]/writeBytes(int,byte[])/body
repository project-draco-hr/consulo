{
synchronized (lock) {
    final int requiredLength=bytes.length;
    final int currentSize=myRecordsTable.getSize(record);
    if (requiredLength == currentSize && currentSize == 0)     return;
    final long address;
    if (currentSize >= requiredLength) {
      address=myRecordsTable.getAddress(record);
    }
 else {
      if (currentSize > 0) {
        myDataTable.reclaimSpace(currentSize);
      }
      address=myDataTable.allocateSpace(requiredLength);
      myRecordsTable.setAddress(record,address);
    }
    myDataTable.writeBytes(address,bytes);
    myRecordsTable.setSize(record,requiredLength);
  }
}
