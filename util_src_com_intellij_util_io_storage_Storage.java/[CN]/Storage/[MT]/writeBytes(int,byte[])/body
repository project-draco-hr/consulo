{
synchronized (lock) {
    final int requiredLength=bytes.length;
    final int currentCapacity=myRecordsTable.getCapacity(record);
    if (requiredLength == 0 && myRecordsTable.getSize(record) == 0)     return;
    final long address;
    if (currentCapacity >= requiredLength) {
      address=myRecordsTable.getAddress(record);
    }
 else {
      if (currentCapacity > 0) {
        myDataTable.reclaimSpace(currentCapacity);
      }
      final int newCapacity=calcCapacity(requiredLength);
      address=myDataTable.allocateSpace(newCapacity);
      myRecordsTable.setAddress(record,address);
      myRecordsTable.setCapacity(record,newCapacity);
    }
    myDataTable.writeBytes(address,bytes);
    myRecordsTable.setSize(record,requiredLength);
  }
}
