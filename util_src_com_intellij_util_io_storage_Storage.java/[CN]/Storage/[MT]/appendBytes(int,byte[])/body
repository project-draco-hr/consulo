{
  int delta=bytes.length;
  if (delta == 0)   return;
synchronized (lock) {
    int capacity=myRecordsTable.getCapacity(record);
    int oldSize=myRecordsTable.getSize(record);
    int newSize=oldSize + delta;
    totalBytesAppended+=delta;
    maxDelta=Math.max(delta,maxDelta);
    if (newSize > capacity) {
      if (oldSize > 0) {
        maxNewSize=Math.max(maxNewSize,newSize);
        byte[] newbytes=new byte[newSize];
        System.arraycopy(readBytes(record),0,newbytes,0,oldSize);
        System.arraycopy(bytes,0,newbytes,oldSize,delta);
        writeBytes(record,newbytes);
      }
 else {
        writeBytes(record,bytes);
      }
    }
 else {
      long address=myRecordsTable.getAddress(record) + oldSize;
      myDataTable.writeBytes(address,bytes);
      myRecordsTable.setSize(record,newSize);
    }
  }
}
