{
synchronized (lock) {
    for (    Integer key : new ArrayList<Integer>(myAppendersCache.keySet())) {
      AppenderStream stream=myAppendersCache.get(key);
      if (stream != null) {
        try {
          stream.realClose();
        }
 catch (        IOException e) {
          LOG.error(e);
        }
        myAppendersCache.remove(key);
      }
    }
    myDataTable.force();
    myRecordsTable.force();
  }
}
