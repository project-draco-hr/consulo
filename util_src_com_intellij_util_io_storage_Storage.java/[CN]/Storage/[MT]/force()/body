{
synchronized (lock) {
    for (    AppenderCacheKey key : new ArrayList<AppenderCacheKey>(ourAppendersCache.keySet())) {
      AppenderStream stream=ourAppendersCache.get(key);
      if (stream != null && stream.myStorage == this) {
        try {
          stream.realClose();
        }
 catch (        IOException e) {
          LOG.error(e);
        }
        ourAppendersCache.remove(key);
      }
    }
    myDataTable.force();
    myRecordsTable.force();
  }
}
