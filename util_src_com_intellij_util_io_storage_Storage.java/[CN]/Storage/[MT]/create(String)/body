{
  final File recordsFile=new File(storageFilePath + ".rindex");
  final File dataFile=new File(storageFilePath + ".data");
  if (recordsFile.exists() != dataFile.exists()) {
    deleteFiles(storageFilePath);
  }
  if (!recordsFile.exists()) {
    recordsFile.getParentFile().mkdirs();
    recordsFile.createNewFile();
    dataFile.createNewFile();
  }
  RecordsTable recordsTable=null;
  DataTable dataTable;
  try {
    recordsTable=new RecordsTable(recordsFile);
    dataTable=new DataTable(dataFile);
  }
 catch (  IOException e) {
    LOG.info(e.getMessage());
    if (recordsTable != null) {
      recordsTable.dispose();
    }
    boolean deleted=deleteFiles(storageFilePath);
    if (!deleted) {
      throw new IOException("Can't delete caches at: " + storageFilePath);
    }
    return create(storageFilePath);
  }
  return new Storage(storageFilePath,recordsTable,dataTable);
}
