{
  final File recordsFile=new File(storageFilePath + ".rindex");
  final File dataFile=new File(storageFilePath + ".data");
  if (recordsFile.exists() != dataFile.exists()) {
    deleteFiles(storageFilePath);
  }
  if (!recordsFile.exists()) {
    recordsFile.getParentFile().mkdirs();
    recordsFile.createNewFile();
    dataFile.createNewFile();
  }
  RecordsTable myRecordsTable=null;
  DataTable myDataTable;
  try {
    myRecordsTable=new RecordsTable(recordsFile);
    myDataTable=new DataTable(dataFile);
  }
 catch (  IOException e) {
    LOG.info(e.getMessage());
    if (myRecordsTable != null) {
      myRecordsTable.dispose();
    }
    boolean deleted=deleteFiles(storageFilePath);
    assert deleted;
    return create(storageFilePath);
  }
  return new Storage(storageFilePath,myRecordsTable,myDataTable);
}
