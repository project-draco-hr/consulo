{
  final Application application=ApplicationManager.getApplication();
  if (application == null)   return;
synchronized (this) {
    boolean initialized=myProject.isInitialized() || application.isUnitTestMode() && myPostStartupActivitiesPassed;
    if (!initialized) {
      registerPostStartupActivity(action);
      return;
    }
  }
  UIUtil.invokeLaterIfNeeded(new Runnable(){
    @Override public void run(){
      if (!myProject.isDisposed()) {
        action.run();
      }
    }
  }
);
}
