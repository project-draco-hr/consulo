{
  final Runnable runnable;
  final Application application=ApplicationManager.getApplication();
  if (application == null)   return;
  if (DumbService.isDumbAware(action)) {
    runnable=new DumbAwareRunnable(){
      public void run(){
        action.run();
      }
    }
;
  }
 else {
    runnable=new Runnable(){
      public void run(){
        action.run();
      }
    }
;
  }
  if (myProject.isInitialized() || application.isUnitTestMode() && myPostStartupActivitiesPassed) {
    UIUtil.invokeLaterIfNeeded(new Runnable(){
      public void run(){
        if (!myProject.isDisposed()) {
          runnable.run();
        }
      }
    }
);
  }
 else {
    registerPostStartupActivity(runnable);
  }
}
