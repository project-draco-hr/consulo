{
  final Application app=ApplicationManager.getApplication();
  app.assertIsDispatchThread();
  if (myPostStartupActivitiesPassed)   return;
  runActivities(myDumbAwarePostStartupActivities);
  DumbService.getInstance(myProject).runWhenSmart(new Runnable(){
    public void run(){
synchronized (StartupManagerImpl.this) {
        app.assertIsDispatchThread();
        if (myProject.isDisposed())         return;
        runActivities(myDumbAwarePostStartupActivities);
        runActivities(myNotDumbAwarePostStartupActivities);
        myPostStartupActivitiesPassed=true;
      }
    }
  }
);
  if (!app.isUnitTestMode()) {
    VirtualFileManager.getInstance().refresh(!app.isHeadlessEnvironment());
  }
}
