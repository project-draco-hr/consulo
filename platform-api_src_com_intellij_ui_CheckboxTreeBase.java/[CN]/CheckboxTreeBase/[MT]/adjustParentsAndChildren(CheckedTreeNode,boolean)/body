{
  changeNodeState(node,checked);
  if (!checked) {
    if (myCheckPolicy.uncheckParentWithUncheckedChild) {
      CheckedTreeNode parent=(CheckedTreeNode)node.getParent();
      while (parent != null) {
        changeNodeState(parent,false);
        parent=(CheckedTreeNode)parent.getParent();
      }
    }
    if (myCheckPolicy.uncheckChildrenWithUncheckedParent) {
      uncheckChildren(node);
    }
  }
 else {
    if (myCheckPolicy.checkChildrenWithCheckedParent) {
      checkChildren(node);
    }
    if (myCheckPolicy.checkParentWithCheckedChild) {
      CheckedTreeNode parent=(CheckedTreeNode)node.getParent();
      while (parent != null) {
        changeNodeState(parent,true);
        parent=(CheckedTreeNode)parent.getParent();
      }
    }
  }
  repaint();
}
