{
  Project project=vcsContext.getProject();
  if (project != null) {
    String actionName=getCompleteActionName(vcsContext);
    if (myActionInfo.showOptions(project) || OptionsDialog.shiftIsPressed(vcsContext.getModifiers())) {
      actionName+="...";
    }
    presentation.setText(actionName);
    presentation.setVisible(true);
    presentation.setEnabled(true);
    FilePath[] roots=myScopeInfo.getRoots(vcsContext);
    if (roots == null || roots.length == 0) {
      presentation.setVisible(false);
      presentation.setEnabled(false);
      return;
    }
    if (roots != null && roots.length > 0) {
      for (int i=0; i < roots.length; i++) {
        FilePath file=roots[i];
        AbstractVcs vcs=VcsUtil.getVcsFor(project,file);
        if (vcs == null) {
          presentation.setVisible(false);
          presentation.setEnabled(false);
          return;
        }
        UpdateEnvironment updateEnvironment=myActionInfo.getEnvironment(vcs);
        if (updateEnvironment == null) {
          presentation.setVisible(false);
          presentation.setEnabled(false);
          return;
        }
      }
    }
  }
 else {
    presentation.setVisible(false);
    presentation.setEnabled(false);
  }
}
