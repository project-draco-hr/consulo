{
  DataInputStream stream=getContentStorage().readStream(contentId);
  if (useSnappyForCompression) {
    byte[] bytes=CompressionUtil.readCompressed(stream);
    stream=new DataInputStream(new ByteArrayInputStream(bytes));
  }
  return stream;
}
