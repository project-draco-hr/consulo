{
  final Project project=(Project)context.getData(DataConstants.PROJECT);
  if (project == null) {
    return null;
  }
  final GeneralCommandLine commandLine=createCommandLine(context);
  if (commandLine == null) {
    return null;
  }
  CommandLineState commandLineState=new CommandLineState(runnerSettings,configurationSettings){
    protected GeneralCommandLine createCommandLine(){
      return commandLine;
    }
    public ExecutionResult execute() throws ExecutionException {
      final ExecutionResult result=super.execute();
      final ProcessHandler processHandler=result.getProcessHandler();
      if (processHandler != null) {
        processHandler.addProcessListener(new MyProcessAdapter(project));
      }
      return result;
    }
  }
;
  TextConsoleBuilder builder=TextConsoleBuidlerFactory.getInstance().createBuilder(project);
  for (int i=0; i < myOutputFilters.size(); i++) {
    FilterInfo filter=myOutputFilters.get(i);
    builder.addFilter(new RegexpFilter(project,filter.getRegExp()));
  }
  commandLineState.setConsoleBuilder(builder);
  return commandLineState;
}
