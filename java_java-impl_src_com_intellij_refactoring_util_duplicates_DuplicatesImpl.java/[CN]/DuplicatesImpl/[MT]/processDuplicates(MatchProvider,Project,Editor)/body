{
  boolean hasDuplicates=provider.hasDuplicates();
  if (hasDuplicates) {
    List<Match> duplicates=provider.getDuplicates();
    if (duplicates.size() == 1) {
      previewMatch(project,duplicates.get(0),editor);
    }
    final int answer=ApplicationManager.getApplication().isUnitTestMode() ? 0 : Messages.showYesNoDialog(project,RefactoringBundle.message("0.has.detected.1.code.fragments.in.this.file.that.can.be.replaced.with.a.call.to.extracted.method",ApplicationNamesInfo.getInstance().getProductName(),duplicates.size()),"Process Duplicates",Messages.getQuestionIcon());
    if (answer == 0) {
      invoke(project,editor,provider);
    }
  }
}
