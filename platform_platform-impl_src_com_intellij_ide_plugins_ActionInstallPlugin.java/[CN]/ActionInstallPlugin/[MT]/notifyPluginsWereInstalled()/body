{
  final ApplicationEx app=ApplicationManagerEx.getApplicationEx();
  final boolean restartCapable=app.isRestartCapable();
  String message="<html>";
  message+=restartCapable ? IdeBundle.message("message.idea.restart.required",ApplicationNamesInfo.getInstance().getProductName()) : IdeBundle.message("message.idea.shutdown.required",ApplicationNamesInfo.getInstance().getProductName());
  message+="<br><a href=";
  message+=restartCapable ? "\"restart\">Restart now" : "\"shutdown\">Shutdown";
  message+="</a></html>";
  Notifications.Bus.notify(new Notification(IdeBundle.message("title.plugin.error"),IdeBundle.message("title.plugin.error"),message,NotificationType.INFORMATION,new NotificationListener(){
    @Override public void hyperlinkUpdate(    @NotNull Notification notification,    @NotNull HyperlinkEvent event){
      notification.expire();
      if (restartCapable) {
        app.restart();
      }
 else {
        app.exit(true);
      }
    }
  }
));
}
