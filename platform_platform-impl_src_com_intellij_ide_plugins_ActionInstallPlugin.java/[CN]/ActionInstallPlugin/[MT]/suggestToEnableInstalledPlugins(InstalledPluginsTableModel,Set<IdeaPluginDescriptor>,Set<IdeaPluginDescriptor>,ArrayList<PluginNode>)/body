{
  if (!disabled.isEmpty() || !disabledDependants.isEmpty()) {
    String message="";
    if (disabled.size() == 1) {
      message="Updated plugin '" + disabled.iterator().next().getName() + "' is disabled";
    }
 else     if (!disabled.isEmpty()) {
      message="Updated plugins " + StringUtil.join(disabled,new Function<IdeaPluginDescriptor,String>(){
        @Override public String fun(        IdeaPluginDescriptor pluginDescriptor){
          return pluginDescriptor.getName();
        }
      }
,", ") + " are disabled.";
    }
    if (!disabledDependants.isEmpty()) {
      if (!message.isEmpty()) {
        message+="\n";
      }
      message+="Updated plugin" + (list.size() > 1 ? "s depend " : " depends ") + "on disabled";
      if (disabledDependants.size() == 1) {
        message+=" plugin '" + disabledDependants.iterator().next().getName() + "'.";
      }
 else {
        message+=" plugins " + StringUtil.join(disabledDependants,new Function<IdeaPluginDescriptor,String>(){
          @Override public String fun(          IdeaPluginDescriptor pluginDescriptor){
            return pluginDescriptor.getName();
          }
        }
,", ") + ".";
      }
    }
    message+="\nWould you like to enable plugins with dependencies?";
    int result;
    if (!disabled.isEmpty() && !disabledDependants.isEmpty()) {
      result=Messages.showYesNoCancelDialog(message,CommonBundle.getWarningTitle(),"Enable all","Enable updated plugin" + (disabled.size() > 1 ? "s" : ""),CommonBundle.getCancelButtonText(),Messages.getQuestionIcon());
    }
 else {
      result=Messages.showOkCancelDialog(message,CommonBundle.getWarningTitle(),"Enable",CommonBundle.getCancelButtonText(),Messages.getQuestionIcon());
    }
    if (result == DialogWrapper.OK_EXIT_CODE) {
      disabled.addAll(disabledDependants);
      pluginsModel.enableRows(disabled.toArray(new IdeaPluginDescriptor[disabled.size()]),true);
    }
 else     if (result == DialogWrapper.CANCEL_EXIT_CODE && !disabled.isEmpty()) {
      pluginsModel.enableRows(disabled.toArray(new IdeaPluginDescriptor[disabled.size()]),true);
    }
  }
}
