{
  int nonWs=CharArrayUtil.shiftForward(editor.getDocument().getCharsSequence(),toDuplicate.getStartOffset(),"\n\t ");
  PsiElement psi=file.findElementAt(nonWs);
  PsiNamedElement named=null;
  while (psi != null) {
    TextRange range=psi.getTextRange();
    if (range == null || psi instanceof PsiFile || !toDuplicate.contains(psi.getTextRange())) {
      break;
    }
    if (psi instanceof PsiNamedElement) {
      named=(PsiNamedElement)psi;
    }
    psi=psi.getParent();
  }
  return named;
}
