{
  Project project=editor.getProject();
  if (project != null && !editor.getSelectionModel().hasSelection()) {
    PsiDocumentManager.getInstance(project).commitDocument(editor.getDocument());
    PsiFile file=PsiDocumentManager.getInstance(project).getPsiFile(editor.getDocument());
    if (file != null) {
      VisualPosition caret=editor.getCaretModel().getVisualPosition();
      Pair<LogicalPosition,LogicalPosition> lines=EditorUtil.calcCaretLinesRange(editor,caret,caret);
      TextRange toDuplicate=new TextRange(editor.logicalPositionToOffset(lines.first),editor.logicalPositionToOffset(lines.second));
      PsiNamedElement named=findNamedElement(editor,file,toDuplicate);
      if (named != null) {
        editor.getCaretModel().moveToOffset(named.getTextOffset());
      }
    }
  }
  myOriginal.execute(editor,dataContext);
}
