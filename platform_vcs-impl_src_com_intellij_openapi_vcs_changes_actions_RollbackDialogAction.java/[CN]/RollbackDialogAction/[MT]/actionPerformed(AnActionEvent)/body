{
  FileDocumentManager.getInstance().saveAllDocuments();
  Change[] changes=e.getData(VcsDataKeys.CHANGES);
  Project project=e.getData(CommonDataKeys.PROJECT);
  final ChangesBrowserBase browser=e.getData(ChangesBrowserBase.DATA_KEY);
  if (browser != null) {
    browser.setDataIsDirty(true);
  }
  RollbackChangesDialog.rollbackChanges(project,Arrays.asList(changes),true,new Runnable(){
    public void run(){
      if (browser != null) {
        browser.rebuildList();
        browser.setDataIsDirty(false);
      }
    }
  }
);
}
