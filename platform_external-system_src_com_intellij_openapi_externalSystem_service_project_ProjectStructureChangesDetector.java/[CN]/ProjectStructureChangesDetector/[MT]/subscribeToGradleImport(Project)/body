{
  MessageBusConnection connection=project.getMessageBus().connect(project);
  connection.subscribe(ProjectEntityChangeListener.TOPIC,new ProjectEntityChangeListener(){
    @Override public void onChangeStart(    @NotNull Object entity,    @NotNull ProjectSystemId externalSystemId){
      myImportCounter.incrementAndGet();
    }
    @Override public void onChangeEnd(    @NotNull Object entity,    @NotNull ProjectSystemId externalSystemId){
      if (myImportCounter.decrementAndGet() <= 0) {
        myUserProjectChangesCalculator.updateCurrentProjectState(project);
        ProjectData externalProject=myChangesModel.getExternalProject(externalSystemId,project);
        if (externalProject != null) {
          myChangesModel.update(externalProject,project,true);
        }
        rebuildTreeModel(externalSystemId);
      }
    }
  }
);
}
