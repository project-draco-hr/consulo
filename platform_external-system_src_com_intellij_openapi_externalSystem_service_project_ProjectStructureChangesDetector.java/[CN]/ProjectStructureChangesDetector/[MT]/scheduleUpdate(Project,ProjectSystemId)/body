{
  if (ApplicationManager.getApplication().isUnitTestMode() || StringUtil.isEmpty(mySettingsManager.getSettings(myProject,externalSystemId).getLinkedProjectPath())) {
    return;
  }
  myUserProjectChangesCalculator.updateChanges(ideProject);
  ProjectData project=myChangesModel.getExternalProject(externalSystemId,ideProject);
  if (project != null) {
    myNewChangesDetected.set(false);
    myChangesModel.update(project,ideProject,true);
    if (!myNewChangesDetected.get()) {
      return;
    }
  }
  myStartRefreshTime.set(System.currentTimeMillis() + REFRESH_DELAY_MILLIS);
  myAlarm.cancelAllRequests();
  myAlarm.addRequest(new RefreshRequest(externalSystemId),REFRESH_DELAY_MILLIS);
}
