{
  final PsiExpression expression=(PsiExpression)descriptor.getPsiElement();
  final PsiType expectedType=ExpectedTypeUtils.findExpectedType(expression,true);
  if (expectedType == null) {
    return;
  }
  final String newExpression;
  if (expression instanceof PsiTypeCastExpression) {
    final PsiTypeCastExpression typeCastExpression=(PsiTypeCastExpression)expression;
    final PsiExpression operand=typeCastExpression.getOperand();
    if (operand == null) {
      newExpression=buildNewExpressionText(expression,expectedType);
    }
 else {
      final PsiType castType=operand.getType();
      if (expectedType.equals(castType)) {
        typeCastExpression.replace(operand);
        return;
      }
 else {
        newExpression=buildNewExpressionText(operand,expectedType);
      }
    }
  }
 else   if (isConvertible(expression,expectedType)) {
    newExpression=convertExpression(expression,expectedType);
    if (newExpression == null) {
      return;
    }
  }
 else {
    newExpression=buildNewExpressionText(expression,expectedType);
  }
  replaceExpression(expression,newExpression);
}
