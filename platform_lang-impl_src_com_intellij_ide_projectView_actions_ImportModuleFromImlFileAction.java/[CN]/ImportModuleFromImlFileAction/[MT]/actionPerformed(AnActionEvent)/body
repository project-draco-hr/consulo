{
  final VirtualFile[] files=e.getData(PlatformDataKeys.VIRTUAL_FILE_ARRAY);
  final Project project=getEventProject(e);
  if (files == null || project == null)   return;
  try {
    final ModifiableModuleModel model=ModuleManager.getInstance(project).getModifiableModel();
    for (    VirtualFile file : files) {
      model.loadModule(file.getPath());
    }
    AccessToken token=WriteAction.start();
    try {
      model.commit();
    }
  finally {
      token.finish();
    }
  }
 catch (  Exception ex) {
    LOG.info(ex);
    Messages.showErrorDialog(project,"Cannot import module: " + ex.getMessage(),CommonBundle.getErrorTitle());
  }
}
