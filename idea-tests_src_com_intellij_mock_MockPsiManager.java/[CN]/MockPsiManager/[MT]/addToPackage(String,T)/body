{
  if (qName == null)   return declaration;
  String superName=StringUtil.getPackageName(qName);
  PsiPackage superPackage=findPackage(superName);
  if (superPackage == null && StringUtil.isNotEmpty(qName)) {
    superPackage=addPackage(superName);
  }
  if (superPackage instanceof MockPsiPackage) {
    ((MockPsiPackage)superPackage).addDeclaration(declaration);
  }
  if (declaration instanceof MockPsiElement) {
    ((MockPsiElement)declaration).setParent(declaration instanceof MockPsiPackage ? superPackage : new MockPsiDirectory(superPackage));
  }
  final PsiFile file=declaration.getContainingFile();
  if (file != null) {
    LiteFixture.setContext(file,superPackage);
  }
  return declaration;
}
