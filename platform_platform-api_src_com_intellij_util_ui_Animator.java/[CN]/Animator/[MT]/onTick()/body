{
  if (isDisposed())   return;
  if (myInitialStep) {
    myInitialStep=false;
    myStartTime=System.currentTimeMillis() - myStartDeltaTime;
    paint();
    return;
  }
  double cycleTime=System.currentTimeMillis() - myStartTime;
  if (cycleTime < 0)   return;
  long newFrame=(long)(cycleTime * myTotalFrames / myCycleDuration);
  if (myRepeatable) {
    newFrame%=myTotalFrames;
  }
  if (newFrame == myCurrentFrame)   return;
  if (!myRepeatable && newFrame >= myTotalFrames) {
    animationDone();
    return;
  }
  myCurrentFrame=(int)newFrame;
  paint();
}
