{
  final StringBuilder builder=StringBuilderSpinAllocator.alloc();
  try {
    final VirtualFile file=message.getFile();
    if (message.getLine() > 0) {
      if (file != null) {
        ApplicationManager.getApplication().runReadAction(new Runnable(){
          public void run(){
            String presentableUrl=file.getPresentableUrl();
            builder.append(presentableUrl);
            builder.append(' ');
          }
        }
);
      }
 else       if (url != null) {
        builder.append(url);
        builder.append(' ');
      }
      builder.append('(');
      builder.append(message.getLine());
      builder.append(':');
      builder.append(message.getColumn());
      builder.append(") ");
    }
    addJavacMessageImpl(new AntMessage(message.getType(),message.getPriority(),builder.toString() + message.getText(),message.getFile(),message.getLine(),message.getColumn()));
  }
  finally {
    StringBuilderSpinAllocator.dispose(builder);
  }
}
