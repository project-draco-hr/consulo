{
  if (!(element instanceof PsiIdentifier || element instanceof PsiKeyword)) {
    return null;
  }
  PsiElement expression=null;
  PsiElement parent=element.getParent();
  if (parent instanceof PsiVariable) {
    expression=element;
  }
 else   if (parent instanceof PsiReferenceExpression && canProcess((PsiExpression)parent)) {
    expression=parent;
  }
  if (parent instanceof PsiThisExpression) {
    expression=parent;
  }
  try {
    if (expression != null) {
      PsiElement context=element;
      if (parent instanceof PsiParameter) {
        try {
          context=((PsiMethod)((PsiParameter)parent).getDeclarationScope()).getBody();
        }
 catch (        Throwable e) {
        }
      }
 else {
        while (context != null && !(context instanceof PsiStatement) && !(context instanceof PsiClass)) {
          context=context.getParent();
        }
      }
      myCurrentRange=expression.getTextRange();
      return expression.getManager().getElementFactory().createExpressionFromText(expression.getText(),context);
    }
  }
 catch (  IncorrectOperationException e) {
    LOG.debug(e);
  }
  return null;
}
