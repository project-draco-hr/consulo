{
  final Project project=myFile.getProject();
  final ProjectFileIndex fileIndex=ProjectRootManager.getInstance(project).getFileIndex();
  final VirtualFile formVirtualFile=myFile.getVirtualFile();
  if (formVirtualFile == null) {
    return null;
  }
  final Module module=fileIndex.getModuleForFile(formVirtualFile);
  if (module == null) {
    return null;
  }
  URL resource=new ResourceBundleLoader(module).getResource(myBundleName + ".properties");
  if (resource == null) {
    return null;
  }
  final VirtualFile vFile=VfsUtil.findFileByURL(resource);
  if (vFile == null) {
    return null;
  }
  final PsiFile propertrtiesFile=PsiManager.getInstance(project).findFile(vFile);
  if (!(propertrtiesFile instanceof PropertiesFile)) {
    return null;
  }
  return ((PropertiesFile)propertrtiesFile).findPropertyByKey(getRangeText());
}
