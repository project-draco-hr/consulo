{
  if (instruction instanceof ReadWriteVariableInstruction && ((ReadWriteVariableInstruction)instruction).isWrite()) {
    final PsiElement element=instruction.getElement();
    if (element instanceof GrReferenceExpression && ((GrReferenceExpression)element).getQualifierExpression() == null && element.getParent() instanceof GrAssignmentExpression) {
      final GrExpression rValue=((GrAssignmentExpression)element.getParent()).getRValue();
      if (rValue != null) {
        final PsiType type=rValue.getType();
        if (type != null) {
          map.put(((ReadWriteVariableInstruction)instruction).getVariableName(),type);
        }
      }
    }
  }
}
