{
  PsiElement element=TargetElementUtilBase.findTargetElement(myEditor,TargetElementUtilBase.ELEMENT_NAME_ACCEPTED | TargetElementUtilBase.REFERENCED_ELEMENT_ACCEPTED);
  final PsiReference ref=myFile.findReferenceAt(myEditor.getCaretModel().getOffset());
  PsiReferenceExpression refExpr=ref instanceof PsiReferenceExpression ? (PsiReferenceExpression)ref : null;
  assertTrue(element instanceof PsiMethod);
  PsiMethod method=(PsiMethod)element;
  final boolean condition=InlineMethodProcessor.checkBadReturns(method) && !InlineMethodHandler.allUsagesAreTailCalls(method);
  assertFalse("Bad returns found",condition);
  InlineOptions options=new MockInlineMethodOptions();
  final InlineMethodProcessor processor=new InlineMethodProcessor(myProject,method,refExpr,myEditor,options.isInlineThisOnly());
  processor.run();
}
