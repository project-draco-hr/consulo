{
  Map<VirtualFile,VcsLogProvider> logProviders=ContainerUtil.newHashMap();
  VcsLogProvider[] allLogProviders=Extensions.getExtensions(LOG_PROVIDER_EP,project);
  for (  VcsRoot root : roots) {
    AbstractVcs vcs=root.getVcs();
    VirtualFile path=root.getPath();
    if (vcs == null || path == null) {
      LOG.error("Skipping invalid VCS root: " + root);
      continue;
    }
    for (    VcsLogProvider provider : allLogProviders) {
      if (provider.getSupportedVcs().equals(vcs.getKeyInstanceMethod())) {
        logProviders.put(path,provider);
        break;
      }
    }
  }
  return logProviders;
}
