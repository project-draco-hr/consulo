{
  if (!source.isShowing())   return;
  final WindowInfoImpl info=getInfo(source.getToolWindow().getId());
  if (info.isFloating()) {
    final Window owner=SwingUtilities.getWindowAncestor(source);
    if (owner != null) {
      info.setFloatingBounds(owner.getBounds());
    }
  }
 else {
    float size=ToolWindowAnchor.TOP == info.getAnchor() || ToolWindowAnchor.BOTTOM == info.getAnchor() ? source.getWidth() : source.getHeight();
    if (source.getParent() instanceof Splitter) {
      Splitter splitter=(Splitter)source.getParent();
      if (splitter.getSecondComponent() == source) {
        size+=splitter.getDividerWidth();
      }
    }
    if (ToolWindowAnchor.TOP == info.getAnchor() || ToolWindowAnchor.BOTTOM == info.getAnchor()) {
      info.setWeight((float)source.getHeight() / (float)myToolWindowsPane.getMyLayeredPane().getHeight());
      float newSideWeight=size / (float)myToolWindowsPane.getMyLayeredPane().getWidth();
      if (newSideWeight < 1.0f) {
        info.setSideWeight(newSideWeight);
      }
    }
 else {
      info.setWeight((float)source.getWidth() / (float)myToolWindowsPane.getMyLayeredPane().getWidth());
      float newSideWeight=size / (float)myToolWindowsPane.getMyLayeredPane().getHeight();
      if (newSideWeight < 1.0f) {
        info.setSideWeight(newSideWeight);
      }
    }
  }
}
