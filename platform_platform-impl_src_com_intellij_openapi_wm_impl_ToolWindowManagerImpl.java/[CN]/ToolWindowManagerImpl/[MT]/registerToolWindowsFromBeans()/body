{
  ToolWindowEP[] beans=Extensions.getExtensions(ToolWindowEP.EP_NAME);
  for (  final ToolWindowEP bean : beans) {
    Condition<Project> mergedCond=Conditions.and(bean.getCondition(),bean.getModuleExtensionCondition());
    if (mergedCond.value(myProject)) {
      initToolWindow(bean);
    }
  }
  myProject.getMessageBus().connect().subscribe(ModuleExtension.CHANGE_TOPIC,new ModuleExtensionChangeListener.Adapter(){
    @Override public void afterExtensionChanged(    @NotNull ModuleExtension<?> oldExtension,    @NotNull ModuleExtension<?> newExtension){
      if (oldExtension.isEnabled() == newExtension.isEnabled()) {
        return;
      }
      ToolWindowEP[] beans=Extensions.getExtensions(ToolWindowEP.EP_NAME);
      boolean extensionVal=newExtension.isEnabled();
      for (      final ToolWindowEP bean : beans) {
        Condition<Project> mergedCond=Conditions.and(bean.getCondition(),bean.getModuleExtensionCondition());
        boolean value=mergedCond.value(myProject);
        if (extensionVal && value) {
          if (isToolWindowRegistered(bean.id)) {
            continue;
          }
          initToolWindow(bean);
        }
 else         if (!extensionVal && !value) {
          unregisterToolWindow(bean.id);
        }
      }
    }
  }
);
}
