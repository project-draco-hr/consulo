{
  ToolWindowEP[] beans=Extensions.getExtensions(ToolWindowEP.EP_NAME);
  for (  final ToolWindowEP bean : beans) {
    if (checkCondition(myProject,bean)) {
      initToolWindow(bean);
    }
  }
  myProject.getMessageBus().connect().subscribe(ModuleExtension.CHANGE_TOPIC,new ModuleExtensionChangeListener(){
    @Override public void beforeExtensionChanged(    @NotNull ModuleExtension<?> oldExtension,    @NotNull ModuleExtension<?> newExtension){
      ToolWindowEP[] beans=Extensions.getExtensions(ToolWindowEP.EP_NAME);
      boolean extensionVal=newExtension.isEnabled();
      for (      final ToolWindowEP bean : beans) {
        boolean value=checkCondition(newExtension,bean);
        if (extensionVal && value) {
          if (isToolWindowRegistered(bean.id)) {
            continue;
          }
          initToolWindow(bean);
        }
 else         if (!extensionVal && !value) {
          unregisterToolWindow(bean.id);
        }
      }
    }
  }
);
}
