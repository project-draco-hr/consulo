{
  checkId(id);
  final WindowInfoImpl info=getInfo(id);
  if (info.getType() == type) {
    return;
  }
  if (info.isVisible()) {
    final boolean dirtyMode=info.isDocked() || info.isSliding();
    info.setVisible(false);
    if (info.isFloating()) {
      appendRemoveFloatingDecoratorCmd(info,commandsList);
    }
 else {
      appendRemoveDecoratorCmd(id,dirtyMode,commandsList);
    }
    info.setType(type);
    appendApplyWindowInfoCmd(info,commandsList);
    prepareForActivation(id,commandsList);
    showAndActivate(id,dirtyMode,commandsList,true,true);
    appendUpdateToolWindowsPaneCmd(commandsList);
  }
 else {
    info.setType(type);
    appendApplyWindowInfoCmd(info,commandsList);
  }
}
