{
  if (LOG.isDebugEnabled()) {
    LOG.debug("enter: unregisterToolWindow(" + id + ")");
  }
  ApplicationManager.getApplication().assertIsDispatchThread();
  if (!myLayout.isToolWindowRegistered(id)) {
    return;
  }
  final WindowInfoImpl info=getInfo(id);
  final ToolWindowEx toolWindow=(ToolWindowEx)getToolWindow(id);
  myLayout.unregister(id);
  final ArrayList<FinalizableCommand> commandsList=new ArrayList<FinalizableCommand>();
  if (info.isVisible()) {
    info.setVisible(false);
    if (info.isFloating()) {
      appendRemoveFloatingDecoratorCmd(info,commandsList);
    }
 else {
      appendRemoveDecoratorCmd(id,false,commandsList);
    }
  }
  appendRemoveButtonCmd(id,commandsList);
  appendApplyWindowInfoCmd(info,commandsList);
  execute(commandsList);
  toolWindow.removePropertyChangeListener(myToolWindowPropertyChangeListener);
  myActiveStack.remove(id,true);
  mySideStack.remove(id);
  final StripeButton button=getStripeButton(id);
  button.dispose();
  myId2StripeButton.remove(id);
  ToolWindowFocusWatcher watcher=(ToolWindowFocusWatcher)myId2FocusWatcher.remove(id);
  watcher.deinstall();
  final InternalDecorator decorator=getInternalDecorator(id);
  decorator.dispose();
  decorator.removeInternalDecoratorListener(myInternalDecoratorListener);
  myId2InternalDecorator.remove(id);
}
