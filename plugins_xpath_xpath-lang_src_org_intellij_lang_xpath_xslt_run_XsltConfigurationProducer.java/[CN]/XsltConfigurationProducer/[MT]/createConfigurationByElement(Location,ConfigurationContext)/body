{
  final XmlFile file=PsiTreeUtil.getParentOfType(location.getPsiElement(),XmlFile.class,false);
  if (file != null && file.isPhysical() && XsltSupport.isXsltFile(file)) {
    myFile=file;
    final Project project=myFile.getProject();
    final RunnerAndConfigurationSettings settings=RunManager.getInstance(project).createRunConfiguration(myFile.getName(),getConfigurationFactory());
    ((XsltRunConfiguration)settings.getConfiguration()).initFromFile(myFile);
    return (RunnerAndConfigurationSettingsImpl)settings;
  }
  return null;
}
