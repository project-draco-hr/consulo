{
  final VirtualFile repository=dialog.getRepository();
  return new HgGlobalCommand(){
    public VirtualFile getRepo(){
      return repository;
    }
    public void execute(){
      String currentBranch=new HgTagBranchCommand(project,repository).getCurrentBranch();
      if (currentBranch == null) {
        return;
      }
      List<HgRevisionNumber> heads=new HgHeadsCommand(project,repository).execute(currentBranch);
      new HgConflictResolver(project,Collections.max(heads),Collections.min(heads)).resolve(repository);
    }
  }
;
}
