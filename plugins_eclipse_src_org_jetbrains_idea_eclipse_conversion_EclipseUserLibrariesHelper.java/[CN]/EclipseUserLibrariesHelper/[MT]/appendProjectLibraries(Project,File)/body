{
  final File prefsParent=getPathToUserLibsFile(workspaceRoot);
  if (!prefsParent.isDirectory()) {
    if (!prefsParent.mkdirs())     return;
  }
  File prefs=new File(prefsParent,ORG_ECLIPSE_JDT_CORE_PREFS);
  if (!prefs.exists()) {
    if (!prefs.createNewFile())     return;
  }
  final Properties properties=new Properties();
  final FileInputStream inputStream=new FileInputStream(prefs);
  try {
    properties.load(inputStream);
  }
 catch (  IOException e) {
    inputStream.close();
  }
  final Library[] libraries=ProjectLibraryTable.getInstance(project).getLibraries();
  for (  Library library : libraries) {
    properties.setProperty(ORG_ECLIPSE_JDT_CORE_USER_LIBRARY + library.getName(),writeUserLibrary(library,project));
  }
  FileOutputStream outputStream=new FileOutputStream(prefs);
  try {
    properties.save(outputStream,null);
  }
  finally {
    outputStream.close();
  }
}
