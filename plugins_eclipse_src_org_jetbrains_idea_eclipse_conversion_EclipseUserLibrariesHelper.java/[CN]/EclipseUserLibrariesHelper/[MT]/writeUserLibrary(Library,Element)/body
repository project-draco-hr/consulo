{
  final VirtualFile[] files=library.getFiles(OrderRootType.CLASSES);
  for (  VirtualFile file : files) {
    Element archElement=new Element("archive");
    if (file.getFileSystem() instanceof JarFileSystem) {
      final VirtualFile localFile=JarFileSystem.getInstance().getVirtualFileForJar(file);
      if (localFile != null) {
        file=localFile;
      }
    }
    archElement.setAttribute("path",file.getPath());
    libElement.addContent(archElement);
  }
}
