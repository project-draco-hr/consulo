{
  if (isEmpty())   return;
  if (isUnitTestMode()) {
    while (!isEmpty() && doRunCycle()) {
    }
    return;
  }
  final Semaphore semaphore=new Semaphore();
  semaphore.down();
  scheduleTask(new MavenProjectsProcessorTask(){
    public void perform(    Project project,    MavenEmbeddersManager embeddersManager,    MavenConsole console,    MavenProgressIndicator process) throws MavenProcessCanceledException {
      semaphore.up();
    }
    public boolean immediateInTestMode(){
      return false;
    }
  }
);
  while (true) {
    if (isStopped || isEmpty() || semaphore.waitFor(WAIT_TIMEOUT))     return;
  }
}
