{
  JPanel rootPane=new JPanel(new BorderLayout());
  mySplitter=new Splitter(true);
  mySplitter.setHonorComponentsMinimumSize(true);
  mySplitter.setFirstComponent(myBrowser);
  mySplitter.setSecondComponent(myCommitMessageArea);
  initMainSplitter();
  rootPane.add(mySplitter,BorderLayout.CENTER);
  myChangesInfoCalculator=new ChangeInfoCalculator();
  myLegend=new CommitLegendPanel(myChangesInfoCalculator);
  JPanel legendPanel=new JPanel(new BorderLayout());
  legendPanel.add(myLegend.getComponent(),BorderLayout.EAST);
  myBrowser.getBottomPanel().add(legendPanel,BorderLayout.SOUTH);
  JPanel infoPanel=new JPanel(new BorderLayout());
  infoPanel.add(myAdditionalOptionsPanel,BorderLayout.CENTER);
  rootPane.add(infoPanel,BorderLayout.EAST);
  infoPanel.setBorder(IdeBorderFactory.createEmptyBorder(0,10,0,0));
  final JPanel wrapper=new JPanel(new GridBagLayout());
  final GridBagConstraints gb=new GridBagConstraints(0,0,1,1,0,0,GridBagConstraints.NORTHWEST,GridBagConstraints.NONE,new Insets(0,0,0,0),0,0);
  final JPanel panel=new JPanel(new BorderLayout());
  panel.add(wrapper,BorderLayout.WEST);
  rootPane.add(panel,BorderLayout.SOUTH);
  myWarningLabel.setBorder(BorderFactory.createEmptyBorder(5,5,0,5));
  wrapper.add(myWarningLabel,gb);
  myDetailsSplitter=new SplitterWithSecondHideable(true,"Details",rootPane,new OnOffListener<Integer>(){
    @Override public void on(    Integer integer){
      if (integer == 0)       return;
      myDiffDetails.refresh();
      mySplitter.skipNextLayouting();
      myDetailsSplitter.getComponent().skipNextLayouting();
      final Dimension dialogSize=getSize();
      setSize(dialogSize.width,dialogSize.height + integer);
      repaint();
    }
    @Override public void off(    Integer integer){
      if (integer == 0)       return;
      myDiffDetails.clear();
      mySplitter.skipNextLayouting();
      myDetailsSplitter.getComponent().skipNextLayouting();
      final Dimension dialogSize=getSize();
      setSize(dialogSize.width,dialogSize.height - integer);
      repaint();
    }
  }
){
    @Override protected RefreshablePanel createDetails(){
      return new RefreshablePanel(){
        @Override public boolean refreshDataSynch(){
          return false;
        }
        @Override public void dataChanged(){
        }
        @Override public void refresh(){
        }
        @Override public JPanel getPanel(){
          return (JPanel)myDiffDetails.getComponent();
        }
        @Override public void away(){
        }
        @Override public boolean isStillValid(        Object o){
          return false;
        }
        @Override public void dispose(){
        }
      }
;
    }
    @Override protected float getSplitterInitialProportion(){
      float value=0;
      final String remembered=PropertiesComponent.getInstance().getValue(DETAILS_SPLITTER_PROPORTION_OPTION);
      if (remembered != null) {
        try {
          value=Float.valueOf(remembered);
        }
 catch (        NumberFormatException e) {
        }
      }
      if (value <= 0.05 || value >= 0.95) {
        return 0.6f;
      }
      return value;
    }
  }
;
  return myDetailsSplitter.getComponent();
}
