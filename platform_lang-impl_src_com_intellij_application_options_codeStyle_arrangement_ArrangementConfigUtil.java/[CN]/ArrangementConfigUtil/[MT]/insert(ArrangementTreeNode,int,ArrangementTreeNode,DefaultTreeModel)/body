{
  if (parent.getChildCount() < index) {
    treeModel.insertNodeInto(child,parent,parent.getChildCount());
    return false;
  }
  if (child.getChildCount() <= 0) {
    treeModel.insertNodeInto(child,parent,index);
  }
  boolean anchorAbove=false;
  ArrangementTreeNode mergeCandidate=null;
  if (index > 0) {
    mergeCandidate=parent.getChildAt(index - 1);
    if (!mergeCandidate.equals(child)) {
      mergeCandidate=null;
    }
  }
  if (index < parent.getChildCount()) {
    ArrangementTreeNode n=parent.getChildAt(index);
    if (n.equals(child)) {
      mergeCandidate=n;
      anchorAbove=true;
    }
  }
  if (mergeCandidate == null) {
    treeModel.insertNodeInto(child,parent,index);
    return false;
  }
  for (int i=0, limit=child.getChildCount(); i < limit; i++) {
    insert(mergeCandidate,anchorAbove ? 0 : mergeCandidate.getChildCount(),child.getChildAt(0),treeModel);
  }
  return true;
}
