{
  ArrangementTreeNode uiNode=null;
  int rowsCreated=0;
  if (uiParentNode != null) {
    for (int i=uiParentNode.getChildCount() - 1; i >= 0; i--) {
      ArrangementTreeNode child=uiParentNode.getChildAt(i);
      if (settingsNode.getCurrent().equals(child.getUserObject())) {
        uiNode=child;
        break;
      }
    }
  }
  if (uiNode == null) {
    uiNode=new ArrangementTreeNode(settingsNode.getCurrent());
    if (uiParentNode != null) {
      uiParentNode.add(uiNode);
    }
    rowsCreated++;
  }
  ArrangementTreeNode leaf=uiNode;
  HierarchicalArrangementSettingsNode childSettingsNode=settingsNode.getChild();
  if (childSettingsNode != null) {
    Pair<ArrangementTreeNode,Integer> pair=map(uiNode,childSettingsNode);
    leaf=pair.first;
    rowsCreated+=pair.second;
  }
  return Pair.create(leaf,rowsCreated);
}
