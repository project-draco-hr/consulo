{
  final TextRange originalRange=e.getTextRange();
  LOG.assertTrue(originalRange.getEndOffset() <= editorText.length(),getClass() + "; " + e);
  List<TextRange> ranges;
  if (isSeparateStatement(e)) {
    ranges=ExtendWordSelectionHandlerBase.expandToWholeLine(editorText,originalRange,true);
    if (ranges.size() == 1 && ranges.contains(originalRange)) {
      ranges=ExtendWordSelectionHandlerBase.expandToWholeLine(editorText,originalRange,false);
    }
  }
 else {
    ranges=new ArrayList<TextRange>();
    ranges.add(e.getTextRange());
  }
  SelectWordUtil.addWordSelection(editor.getSettings().isCamelWords(),editorText,cursorOffset,ranges);
  return ranges;
}
