{
  final Object userObject=node.getUserObject();
  if (userObject instanceof AbstractModuleNode) {
    final ModuleRootManager moduleRootManager=ModuleRootManager.getInstance(((AbstractModuleNode)userObject).getValue());
    final VirtualFile[] sourceRoots=moduleRootManager.getSourceRoots();
    List<PsiDirectory> dirs=new ArrayList<PsiDirectory>(sourceRoots.length);
    final PsiManager psiManager=PsiManager.getInstance(myProject);
    for (    final VirtualFile sourceRoot : sourceRoots) {
      final PsiDirectory directory=psiManager.findDirectory(sourceRoot);
      if (directory != null) {
        dirs.add(directory);
      }
    }
    return dirs.toArray(new PsiDirectory[dirs.size()]);
  }
  return PsiDirectory.EMPTY_ARRAY;
}
