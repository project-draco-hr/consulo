{
  TreePath[] paths=getSelectionPaths();
  if (paths == null)   return PsiElement.EMPTY_ARRAY;
  ArrayList<Object> list=new ArrayList<Object>(paths.length);
  for (  TreePath path : paths) {
    Object lastPathComponent=path.getLastPathComponent();
    Object element=getElementFromTreeNode(lastPathComponent);
    if (element instanceof Object[]) {
      Collections.addAll(list,(Object[])element);
    }
 else     if (element != null) {
      list.add(element);
    }
  }
  return ArrayUtil.toObjectArray(list);
}
