{
  final Library[] libraries=libraryTable.getLibraries();
  if (libraries.length == 0) {
    return null;
  }
  final CompositeGenerator gen=new CompositeGenerator();
  gen.add(new Comment(comment),1);
  for (int idx=0; idx < libraries.length; idx++) {
    final Library library=libraries[idx];
    final String libraryName=library.getName();
    if (!myUsedLibraries.contains(libraryName)) {
      continue;
    }
    final VirtualFile[] files=library.getFiles(OrderRootType.COMPILATION_CLASSES);
    final Path libraryPath=new Path(BuildProperties.getLibraryPathId(libraryName));
    for (int i=0; i < files.length; i++) {
      final VirtualFile file=files[i];
      libraryPath.add(new PathElement(GenerationUtils.toRelativePath(file,baseDir,BuildProperties.getProjectBaseDirProperty(),myGenOptions,!myProject.isSavePathsRelative())));
    }
    gen.add(libraryPath,1);
  }
  return gen.getGeneratorCount() > 0 ? gen : null;
}
