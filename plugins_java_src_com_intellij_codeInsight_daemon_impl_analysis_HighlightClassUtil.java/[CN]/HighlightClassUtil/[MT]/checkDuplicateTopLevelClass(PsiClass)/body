{
  if (!(aClass.getParent() instanceof PsiFile))   return null;
  String qualifiedName=aClass.getQualifiedName();
  if (qualifiedName == null)   return null;
  int numOfClassesToFind=2;
  if (qualifiedName.contains("$")) {
    qualifiedName=qualifiedName.replaceAll("\\$",".");
    numOfClassesToFind=1;
  }
  PsiManager manager=aClass.getManager();
  Module module=ModuleUtilCore.findModuleForPsiElement(aClass);
  if (module == null)   return null;
  PsiClass[] classes=JavaPsiFacade.getInstance(aClass.getProject()).findClasses(qualifiedName,GlobalSearchScope.moduleScope(module));
  if (classes.length < numOfClassesToFind)   return null;
  String dupFileName=null;
  for (  PsiClass dupClass : classes) {
    if (dupClass != aClass) {
      VirtualFile file=dupClass.getContainingFile().getVirtualFile();
      if (file != null && manager.isInProject(dupClass)) {
        dupFileName=FileUtil.toSystemDependentName(file.getPath());
        break;
      }
    }
  }
  if (dupFileName == null)   return null;
  String message=JavaErrorMessages.message("duplicate.class.in.other.file",dupFileName);
  TextRange textRange=HighlightNamesUtil.getClassDeclarationTextRange(aClass);
  return HighlightInfo.newHighlightInfo(HighlightInfoType.ERROR).range(textRange).descriptionAndTooltip(message).create();
}
