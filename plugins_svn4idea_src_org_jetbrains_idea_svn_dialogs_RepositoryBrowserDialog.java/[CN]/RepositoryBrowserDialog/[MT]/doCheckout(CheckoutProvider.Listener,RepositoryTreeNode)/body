{
  if (selectedNode == null) {
    return;
  }
  SVNURL url=selectedNode.getURL();
  final String relativePath;
  if (selectedNode.isRepositoryRoot()) {
    relativePath="";
  }
 else {
    final SVNDirEntry dirEntry=selectedNode.getSVNDirEntry();
    if (dirEntry == null) {
      return;
    }
    if (dirEntry.getRepositoryRoot() != null) {
      relativePath=SVNPathUtil.getRelativePath(dirEntry.getRepositoryRoot().toString(),url.toString());
    }
 else {
      relativePath=dirEntry.getRelativePath();
    }
  }
  File dir=selectFile(SvnBundle.message("svn.checkout.destination.directory.title"),SvnBundle.message("svn.checkout.destination.directory.description"));
  if (dir == null) {
    return;
  }
  Project p=myProject;
  CheckoutOptionsDialog dialog=new CheckoutOptionsDialog(p,url,dir,SvnUtil.getVirtualFile(dir.getAbsolutePath()),relativePath);
  dialog.show();
  dir=dialog.getTarget();
  if (dialog.isOK() && dir != null) {
    final SVNRevision revision;
    try {
      revision=dialog.getRevision();
    }
 catch (    ConfigurationException e) {
      Messages.showErrorDialog(SvnBundle.message("message.text.cannot.checkout",e.getMessage()),SvnBundle.message("message.title.check.out"));
      return;
    }
    SvnCheckoutProvider.doCheckout(myProject,dir,url.toString(),revision,dialog.getDepth(),dialog.isIgnoreExternals(),listener);
  }
}
