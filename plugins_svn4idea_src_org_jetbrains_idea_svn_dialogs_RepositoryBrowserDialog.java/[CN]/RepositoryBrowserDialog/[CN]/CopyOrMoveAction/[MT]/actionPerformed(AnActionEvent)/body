{
  final RepositoryTreeNode node=getSelectedNode();
  if (node == null) {
    return;
  }
  RepositoryTreeNode rootNode=node;
  while (!rootNode.isRepositoryRoot()) {
    rootNode=(RepositoryTreeNode)rootNode.getParent();
  }
  CopyOptionsDialog dialog=new CopyOptionsDialog(SvnBundle.message(myDialogTitleKey),myProject,rootNode,node);
  dialog.show();
  VcsConfiguration.getInstance(myProject).saveCommitMessage(dialog.getCommitMessage());
  if (dialog.isOK()) {
    SVNURL dst=dialog.getTargetURL();
    SVNURL src=dialog.getSourceURL();
    String message=dialog.getCommitMessage();
    doCopy(src,dst,myMove,message);
    final CopyMoveReloadHelper sourceReloader=myMove ? new MoveSourceReloader(node) : CopyMoveReloadHelper.EMPTY;
    final TargetReloader destinationReloader=new TargetReloader(dialog,node,rootNode,myRepositoryBrowser);
    sourceReloader.doSynthetic();
    destinationReloader.doSynthetic();
    if ((!myMove) || (!Comparing.equal(sourceReloader.parent(),destinationReloader.parent()))) {
      destinationReloader.doRefresh();
    }
    sourceReloader.doRefresh();
  }
}
