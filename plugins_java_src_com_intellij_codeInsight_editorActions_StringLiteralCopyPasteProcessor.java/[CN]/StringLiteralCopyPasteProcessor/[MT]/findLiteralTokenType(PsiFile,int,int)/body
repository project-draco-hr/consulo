{
  final PsiElement elementAtSelectionStart=file.findElementAt(selectionStart);
  if (elementAtSelectionStart == null) {
    return null;
  }
  if (!isStringLiteral(elementAtSelectionStart) && !isCharLiteral(elementAtSelectionStart)) {
    return null;
  }
  if (elementAtSelectionStart.getTextRange().getEndOffset() < selectionEnd) {
    final PsiElement elementAtSelectionEnd=file.findElementAt(selectionEnd);
    if (elementAtSelectionEnd == null) {
      return null;
    }
    if (elementAtSelectionEnd.getNode().getElementType() == elementAtSelectionStart.getNode().getElementType() && elementAtSelectionEnd.getTextRange().getStartOffset() < selectionEnd) {
      return elementAtSelectionStart;
    }
  }
  final TextRange textRange=elementAtSelectionStart.getTextRange();
  if (selectionStart <= textRange.getStartOffset() || selectionEnd >= textRange.getEndOffset()) {
    return null;
  }
  return elementAtSelectionStart;
}
