{
  final Object userObject=root.getUserObject();
  final TreeNode[] rootPath=((DefaultMutableTreeNode)root).getPath();
  if (userObject instanceof Descriptor) {
    final String displayName=((Descriptor)userObject).getText();
    if (mySelectedNodes.contains(displayName)) {
      toSelect.add(new TreePath(rootPath));
    }
    if (myExpandedNodes.contains(displayName)) {
      pathsToExpand.add(new TreePath(rootPath));
    }
  }
 else {
    if (mySelectedNodes.contains(userObject)) {
      toSelect.add(new TreePath(rootPath));
    }
    if (myExpandedNodes.contains(userObject)) {
      pathsToExpand.add(new TreePath(rootPath));
    }
    for (int i=0; i < root.getChildCount(); i++) {
      traverseNodes((DefaultMutableTreeNode)root.getChildAt(i),pathsToExpand,toSelect);
    }
  }
}
