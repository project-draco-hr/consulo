{
  if (endElement == null || !endElement.isValid()) {
    return null;
  }
  final LinkedList<BreadcrumbsPsiItem> result=new LinkedList<BreadcrumbsPsiItem>();
  PsiElement element=endElement;
  while (element != null) {
    BreadcrumbsInfoProvider provider=findProviderForElement(element);
    if (provider == null) {
      provider=myInfoProvider;
    }
    if (provider != null && provider.acceptElement(element)) {
      result.addFirst(new BreadcrumbsPsiItem(element,provider));
    }
    element=(provider != null) ? provider.getParent(element) : element.getParent();
  }
  return result;
}
