{
  VirtualFile file=event.getFile();
  if (!shouldProcess(event)) {
    createNonUndoableAction(file,true);
  }
 else {
    CompositeUndoableAction undoableAction=createUndoableAction(file,false);
    if (!undoableAction.isEmpty()) {
      file.putUserData(DELETE_UNDOABLE_ACTION_KEY,undoableAction);
    }
  }
}
