{
  if (getLocalVcs() == null) {
    return;
  }
  if (!vFile.getFileType().isBinary() && !getLocalVcs().isUnderVcs(vFile)) {
    return;
  }
  DocumentReference oldRef=myUndoManager.findInvalidatedReferenceByUrl(vFile.getUrl());
  final DocumentReference newRef=new DocumentReferenceByVirtualFile(vFile);
  createNonUndoableAction(vFile,newRef,isComplex);
  if ((oldRef != null) && !oldRef.equals(newRef)) {
    createNonUndoableAction(vFile,oldRef,isComplex);
  }
}
