{
  String filePath=f.getPath();
  boolean isDirectory=f.isDirectory();
  LvcsRevision revisionAfterAction=getCurrentRevision(filePath,isDirectory);
  if (revisionAfterAction == null)   return;
  myLockedRevisions.add(revisionAfterAction);
  a.addAction(new LvcsBasedUndoableAction(f,filePath,isDirectory,revisionAfterAction,isContentAffected));
  if (isDirectory) {
    for (    VirtualFile child : f.getChildren()) {
      buildCompositeUndoableAction(a,child,isContentAffected);
    }
  }
}
