{
  if (type == null || element.getType().equals(type)) {
    if (!processor.process((E)element)) {
      return false;
    }
  }
  if (element instanceof CompositePackagingElement<?>) {
    return processElements(((CompositePackagingElement<?>)element).getChildren(),type,processor,resolvingContext,processSubstituions);
  }
 else   if (element instanceof ComplexPackagingElement<?> && processSubstituions) {
    final List<? extends PackagingElement<?>> substitution=((ComplexPackagingElement<?>)element).getSubstitution(resolvingContext);
    return processElements(substitution,type,processor,resolvingContext,processSubstituions);
  }
  return true;
}
