{
  setStacktraceIfNotSet(stackTrace);
  if (myState instanceof TestFailedState) {
    ((TestFailedState)myState).addError(localizedMessage,stackTrace,myPrinter);
  }
 else {
    myState=testError ? new TestErrorState(localizedMessage,stackTrace) : new TestFailedState(localizedMessage,stackTrace);
    fireOnNewPrintable(myState);
  }
}
