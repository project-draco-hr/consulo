{
  final File root=context.getDataManager().getDataStorageRoot();
  AndroidFileSetStorage dexStateStorage=null;
  AndroidFileSetStorage proguardStateStorage=null;
  try {
    dexStateStorage=new AndroidFileSetStorage(root,"dex");
    proguardStateStorage=new AndroidFileSetStorage(root,"proguard");
    if (!doDexBuild(context,dexStateStorage,proguardStateStorage)) {
      throw new ProjectBuildException();
    }
  }
  finally {
    if (proguardStateStorage != null) {
      proguardStateStorage.close();
    }
    if (dexStateStorage != null) {
      dexStateStorage.close();
    }
  }
}
