{
  if (myPaintingBgNow)   return;
  if (isOpaque()) {
    final Container parent=getParent();
    JComponent opaque=null;
    if (parent instanceof JComponent) {
      opaque=(JComponent)UIUtil.findNearestOpaque((JComponent)parent);
    }
    Color bg=opaque != null ? opaque.getBackground() : UIUtil.getPanelBackground();
    g.setColor(bg);
    g.fillRect(0,0,getWidth(),getHeight());
  }
  Icon icon;
  if (myAnimator.isRunning()) {
    icon=myIcons[myCurrentIconIndex];
  }
 else {
    icon=getPassiveIcon();
  }
  final Dimension size=getSize();
  int x=(size.width - icon.getIconWidth()) / 2;
  int y=(size.height - icon.getIconHeight()) / 2;
  paintIcon(g,icon,x,y);
  myLastPaintWasRunning=myAnimator.isRunning();
}
