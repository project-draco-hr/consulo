{
  CodeInsightSettings settings=CodeInsightSettings.getInstance();
  if (!method.isValid()) {
    context.setUIComponentEnabled(false);
    return;
  }
  int highlightStartOffset=-1;
  int highlightEndOffset=-1;
  StringBuffer buffer=new StringBuffer();
  if (settings.SHOW_FULL_SIGNATURES_IN_PARAMETER_INFO) {
    if (!method.isConstructor()) {
      PsiType returnType=method.getReturnType();
      if (substitutor != null) {
        returnType=substitutor.substitute((returnType));
      }
      buffer.append(returnType.getPresentableText());
      buffer.append(" ");
    }
    buffer.append(method.getName());
    buffer.append("(");
  }
  final int currentParameter=context.getCurrentParameterIndex();
  PsiParameter[] parms=method.getParameterList().getParameters();
  int numParams=parms.length;
  if (numParams > 0) {
    for (int j=0; j < numParams; j++) {
      PsiParameter parm=parms[j];
      int startOffset=buffer.length();
      if (parm.isValid()) {
        PsiType paramType=parm.getType();
        if (substitutor != null) {
          paramType=substitutor.substitute(paramType);
        }
        buffer.append(paramType.getPresentableText());
        String name=parm.getName();
        if (name != null) {
          buffer.append(" ");
          buffer.append(name);
        }
      }
      int endOffset=buffer.length();
      if (j < numParams - 1) {
        buffer.append(", ");
      }
      if (context.isUIComponentEnabled() && (j == currentParameter || (j == numParams - 1 && parm.isVarArgs() && currentParameter >= numParams))) {
        highlightStartOffset=startOffset;
        highlightEndOffset=endOffset;
      }
    }
  }
 else {
    buffer.append(CodeInsightBundle.message("parameter.info.no.parameters"));
  }
  if (settings.SHOW_FULL_SIGNATURES_IN_PARAMETER_INFO) {
    buffer.append(")");
  }
  context.setupUIComponentPresentation(buffer.toString(),highlightStartOffset,highlightEndOffset,!context.isUIComponentEnabled(),method.isDeprecated(),false,context.getDefaultParameterColor());
}
