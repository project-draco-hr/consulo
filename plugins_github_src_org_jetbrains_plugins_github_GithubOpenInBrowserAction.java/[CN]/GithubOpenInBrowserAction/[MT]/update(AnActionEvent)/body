{
  final long startTime=System.nanoTime();
  try {
    final Project project=e.getData(PlatformDataKeys.PROJECT);
    final VirtualFile virtualFile=e.getData(PlatformDataKeys.VIRTUAL_FILE);
    if (project == null || project.isDefault() || virtualFile == null) {
      e.getPresentation().setVisible(false);
      e.getPresentation().setEnabled(false);
      return;
    }
    final GitRepository gitRepository=GitRepositoryManager.getInstance(project).getRepositoryForFile(project.getBaseDir());
    if (gitRepository == null) {
      e.getPresentation().setVisible(false);
      e.getPresentation().setEnabled(false);
      return;
    }
    final GitRemote gitHubRemoteBranch=GithubUtil.findGitHubRemoteBranch(gitRepository);
    if (gitHubRemoteBranch == null) {
      e.getPresentation().setVisible(false);
      e.getPresentation().setEnabled(false);
      return;
    }
    e.getPresentation().setVisible(true);
    e.getPresentation().setEnabled(true);
  }
  finally {
    if (LOG.isDebugEnabled()) {
      LOG.debug("GithubOpenInBrowserAction#update finished in: " + (System.nanoTime() - startTime) / 10e6 + "ms");
    }
  }
}
