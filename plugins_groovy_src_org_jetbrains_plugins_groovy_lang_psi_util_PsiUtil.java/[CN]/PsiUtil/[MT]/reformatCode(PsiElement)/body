{
  final TextRange textRange=element.getTextRange();
  PsiFile file=element.getContainingFile();
  FileViewProvider viewProvider=file.getViewProvider();
  if (viewProvider instanceof MultiplePsiFilesPerDocumentFileViewProvider) {
    MultiplePsiFilesPerDocumentFileViewProvider multiProvider=(MultiplePsiFilesPerDocumentFileViewProvider)viewProvider;
    file=multiProvider.getPsi(multiProvider.getBaseLanguage());
  }
  try {
    CodeStyleManager.getInstance(element.getProject()).reformatText(file,textRange.getStartOffset(),textRange.getEndOffset());
  }
 catch (  IncorrectOperationException e) {
    LOG.error(e);
  }
}
