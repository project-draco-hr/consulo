{
  while (elem != null && elem.getNode() != null && set.contains(elem.getNode().getElementType())) {
    if (forward) {
      elem=elem.getNextSibling();
    }
 else {
      elem=elem.getPrevSibling();
    }
  }
  return elem;
}
