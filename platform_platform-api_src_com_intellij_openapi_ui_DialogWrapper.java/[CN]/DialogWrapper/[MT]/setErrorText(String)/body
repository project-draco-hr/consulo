{
  if (Comparing.equal(myLastErrorText,text)) {
    return;
  }
  myLastErrorText=text;
  if (mySizeBeforeError == null && !StringUtil.isEmpty(text)) {
    mySizeBeforeError=getSize();
  }
  myErrorTextAlarm.cancelAllRequests();
  myErrorTextAlarm.addRequest(new Runnable(){
    public void run(){
      final String text=myLastErrorText;
      myErrorText.setError(text);
      if (text != null && text.length() > myMaxErrorTextLength) {
        if (myMaxErrorTextLength == 0) {
          updateHeightForErrorText();
        }
 else {
          if (getRootPane() != null)           myPeer.pack();
        }
        myMaxErrorTextLength=text.length();
        updateHeightForErrorText();
      }
      myErrorText.repaint();
      if (StringUtil.isEmpty(text) && mySizeBeforeError != null) {
        setSize(mySizeBeforeError.width,mySizeBeforeError.height);
        myMaxErrorTextLength=0;
      }
    }
  }
,300,null);
}
