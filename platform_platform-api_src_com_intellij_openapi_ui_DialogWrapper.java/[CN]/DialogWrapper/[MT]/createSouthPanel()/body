{
  Action[] actions=createActions();
  Action[] leftSideActions=createLeftSideActions();
  List<JButton> buttons=new ArrayList<JButton>();
  boolean hasHelpToMoveToLeftSide=false;
  if (SystemInfo.isMacOSLeopard && Arrays.asList(actions).contains(getHelpAction())) {
    hasHelpToMoveToLeftSide=true;
    actions=ArrayUtil.remove(actions,getHelpAction());
  }
  JPanel panel=new JPanel(new BorderLayout());
  final JPanel lrButtonsPanel=new JPanel(new GridBagLayout());
  final Insets insets=SystemInfo.isMacOSLeopard ? new Insets(0,0,0,0) : new Insets(8,0,0,0);
  if (actions.length > 0 || leftSideActions.length > 0) {
    int gridx=0;
    if (leftSideActions.length > 0) {
      JPanel buttonsPanel=createButtons(leftSideActions,buttons);
      lrButtonsPanel.add(buttonsPanel,new GridBagConstraints(gridx++,0,1,1,0,0,GridBagConstraints.CENTER,GridBagConstraints.NONE,insets,0,0));
    }
    lrButtonsPanel.add(Box.createHorizontalGlue(),new GridBagConstraints(gridx++,0,1,1,1,0,GridBagConstraints.CENTER,GridBagConstraints.HORIZONTAL,insets,0,0));
    if (actions.length > 0) {
      JPanel buttonsPanel=createButtons(actions,buttons);
      lrButtonsPanel.add(buttonsPanel,new GridBagConstraints(gridx++,0,1,1,0,0,GridBagConstraints.CENTER,GridBagConstraints.NONE,insets,0,0));
    }
    if (SwingConstants.CENTER == myButtonAlignment) {
      lrButtonsPanel.add(Box.createHorizontalGlue(),new GridBagConstraints(gridx,0,1,1,1,0,GridBagConstraints.CENTER,GridBagConstraints.HORIZONTAL,insets,0,0));
    }
    myButtons=buttons.toArray(new JButton[buttons.size()]);
  }
  if (hasHelpToMoveToLeftSide) {
    JButton helpButton=new JButton(getHelpAction());
    helpButton.putClientProperty("JButton.buttonType","help");
    helpButton.setText("");
    helpButton.setMargin(insets);
    panel.add(helpButton,BorderLayout.WEST);
  }
  panel.add(lrButtonsPanel,BorderLayout.CENTER);
  panel.setBorder(IdeBorderFactory.createEmptyBorder(new Insets(8,0,0,0)));
  return panel;
}
