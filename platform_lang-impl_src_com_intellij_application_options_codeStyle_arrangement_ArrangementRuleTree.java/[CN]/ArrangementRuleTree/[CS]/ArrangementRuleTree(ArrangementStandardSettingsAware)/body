{
  myFilter=filter;
  myDisplayManager=new ArrangementNodeDisplayManager(filter);
  myFactory=new ArrangementNodeComponentFactory(myDisplayManager);
  DefaultMutableTreeNode root=new DefaultMutableTreeNode();
  myTreeModel=new DefaultTreeModel(root);
  myTree=new Tree(myTreeModel){
    @Override protected void setExpandedState(    TreePath path,    boolean state){
      if (state) {
        super.setExpandedState(path,state);
      }
    }
  }
;
  myTree.setSelectionModel(null);
  myTree.addMouseMotionListener(new MouseAdapter(){
    @Override public void mouseMoved(    MouseEvent e){
      onMouseMoved(e);
    }
  }
);
  myTree.putClientProperty(DataManager.CLIENT_PROPERTY_DATA_PROVIDER,new DataProvider(){
    @Override public Object getData(    @NonNls String dataId){
      if (ArrangementSettingsUtil.NODE_COMPONENT.is(dataId)) {
        return myPrevComponentUnderMouse;
      }
 else       if (ArrangementSettingsUtil.DISPLAY_MANAGER.is(dataId)) {
        return myDisplayManager;
      }
 else       if (ArrangementSettingsUtil.FILTER.is(dataId)) {
        return myFilter;
      }
 else       if (ArrangementSettingsUtil.TREE.is(dataId)) {
        return myTree;
      }
      return null;
    }
  }
);
  List<ArrangementSettingsNode> children=new ArrayList<ArrangementSettingsNode>();
  children.add(new ArrangementSettingsAtomNode(ArrangementSettingType.MODIFIER,ArrangementModifier.PUBLIC));
  children.add(new ArrangementSettingsAtomNode(ArrangementSettingType.MODIFIER,ArrangementModifier.STATIC));
  children.add(new ArrangementSettingsAtomNode(ArrangementSettingType.MODIFIER,ArrangementModifier.FINAL));
  HierarchicalArrangementSettingsNode settingsNode=new HierarchicalArrangementSettingsNode(new ArrangementSettingsAtomNode(ArrangementSettingType.TYPE,ArrangementEntryType.FIELD));
  ArrangementSettingsCompositeNode modifiers=new ArrangementSettingsCompositeNode(ArrangementSettingsCompositeNode.Operator.AND);
  for (  ArrangementSettingsNode child : children) {
    modifiers.addOperand(child);
  }
  settingsNode.addChild(new HierarchicalArrangementSettingsNode(modifiers));
  if (settingsNode != null) {
    map(root,settingsNode);
  }
  expandAll(myTree,new TreePath(root));
  myTree.setRootVisible(false);
  myTree.setShowsRootHandles(false);
  myTree.setCellRenderer(new MyCellRenderer());
}
