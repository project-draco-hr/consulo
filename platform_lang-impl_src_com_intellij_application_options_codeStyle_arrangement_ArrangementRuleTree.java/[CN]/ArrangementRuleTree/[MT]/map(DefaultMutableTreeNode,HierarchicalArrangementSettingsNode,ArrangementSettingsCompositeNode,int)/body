{
  DefaultMutableTreeNode childTreeNode=new DefaultMutableTreeNode(settingsNode.getCurrent());
  parentTreeNode.add(childTreeNode);
  List<HierarchicalArrangementSettingsNode> children=settingsNode.getChildren();
  if (children.isEmpty()) {
    ArrangementMatcherSettings settings=new ArrangementMatcherSettings();
    ArrangementSettingsNode condition;
    if (template == null) {
      condition=settingsNode.getCurrent();
    }
 else {
      condition=template.clone().addOperand(settingsNode.getCurrent());
    }
    settings.addCondition(condition);
    mySettings.put(row,settings);
    return row + 1;
  }
 else {
    row++;
    ArrangementSettingsCompositeNode newTemplate=template == null ? new ArrangementSettingsCompositeNode(ArrangementSettingsCompositeNode.Operator.AND) : template.clone();
    newTemplate.addOperand(settingsNode.getCurrent());
    for (    HierarchicalArrangementSettingsNode node : children) {
      row=map(childTreeNode,node,newTemplate,row);
    }
    return row;
  }
}
