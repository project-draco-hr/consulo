{
  List<ArrangementRuleEditingModelImpl> activeModels=getActiveModels();
  final ArrangementTreeNode anchor=activeModels.size() != 1 ? null : activeModels.get(0).getBottomMost();
  doClearSelection();
  Pair<ArrangementRuleEditingModelImpl,TIntIntHashMap> pair=myModelBuilder.build(ArrangementRuleEditingModel.EMPTY_RULE,myTree,myRoot,anchor,myGroupingRules);
  processRowChanges(pair.second);
  myModels.put(pair.first.getRow(),pair.first);
  pair.first.addListener(myModelChangeListener);
  mySelectionModel.setSelectionPath(myTree.getPathForRow(pair.first.getRow()));
  return pair.first;
}
