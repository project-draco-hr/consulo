{
  ArrangementRuleEditingModelImpl activeModel=getActiveModel();
  final ArrangementTreeNode anchor=activeModel == null ? null : activeModel.getBottomMost();
  doClearSelection();
  Pair<ArrangementRuleEditingModelImpl,TIntIntHashMap> pair=myModelBuilder.build(new ArrangementCompositeMatchCondition(ArrangementCompositeMatchCondition.Operator.AND),myTree,myRoot,anchor,myGrouper);
  processRowChanges(pair.second);
  myModels.put(pair.first.getRow(),pair.first);
  pair.first.addListener(myModelChangeListener);
  mySelectionModel.setSelectionPath(myTree.getPathForRow(pair.first.getRow()));
  return pair.first;
}
