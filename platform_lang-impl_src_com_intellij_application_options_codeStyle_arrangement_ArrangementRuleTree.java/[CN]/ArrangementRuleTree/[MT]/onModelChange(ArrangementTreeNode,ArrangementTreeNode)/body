{
  expandAll(myTree,new TreePath(topMost.getPath()));
  mySelectionModel.clearSelection();
  mySkipSelectionChange=true;
  try {
    for (ArrangementTreeNode node=bottomMost; node != null; node=node.getParent()) {
      TreePath path=new TreePath(node.getPath());
      int row=myTree.getRowForPath(path);
      myRenderers.remove(row);
      myTreeModel.nodeChanged(node);
      mySelectionModel.addSelectionPath(path);
      ArrangementSettingsNode setting=node.getBackingSetting();
      if (setting != null) {
        getNodeComponentAt(row,setting).setSelected(true);
      }
      if (node == topMost) {
        break;
      }
    }
  }
  finally {
    mySkipSelectionChange=false;
  }
}
