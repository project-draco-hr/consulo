{
  Project project=PlatformDataKeys.PROJECT.getData(dataContext);
  if (project == null)   return Collections.emptyList();
  Module moduleContext=LangDataKeys.MODULE_CONTEXT.getData(dataContext);
  Collection<AbstractTreeNode> nodesToAdd=null;
  for (  FavoriteNodeProvider provider : Extensions.getExtensions(FavoriteNodeProvider.EP_NAME,project)) {
    nodesToAdd=provider.getFavoriteNodes(dataContext,ViewSettings.DEFAULT);
    if (nodesToAdd != null) {
      break;
    }
  }
  if (nodesToAdd == null) {
    Object elements=collectSelectedElements(dataContext);
    if (elements != null) {
      nodesToAdd=createNodes(project,moduleContext,elements,inProjectView,ViewSettings.DEFAULT);
    }
  }
  return nodesToAdd;
}
