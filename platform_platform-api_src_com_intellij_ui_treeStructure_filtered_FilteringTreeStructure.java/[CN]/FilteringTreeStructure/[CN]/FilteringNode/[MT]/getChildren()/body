{
  List<FilteringNode> nodes=myNodesCache.get(this);
  if (nodes == null) {
    return myDelegate instanceof SimpleNode ? ((SimpleNode)myDelegate).getChildren() : NO_CHILDREN;
  }
  ArrayList<FilteringNode> result=new ArrayList<FilteringNode>();
  for (  FilteringNode node : nodes) {
    if (node.state == State.VISIBLE) {
      result.add(node);
    }
  }
  return result.toArray(new FilteringNode[result.size()]);
}
