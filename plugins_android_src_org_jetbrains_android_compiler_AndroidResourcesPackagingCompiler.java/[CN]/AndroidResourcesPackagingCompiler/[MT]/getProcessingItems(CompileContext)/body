{
  final List<ProcessingItem> items=new ArrayList<ProcessingItem>();
  Module[] affectedModules=context.getCompileScope().getAffectedModules();
  for (  Module module : affectedModules) {
    AndroidFacet facet=AndroidFacet.getInstance(module);
    if (facet != null && !facet.getConfiguration().LIBRARY_PROJECT) {
      VirtualFile manifestFile=AndroidRootUtil.getManifestFileForCompiler(facet);
      VirtualFile assetsDir=AndroidRootUtil.getAssetsDir(module);
      if (manifestFile != null) {
        AndroidFacetConfiguration configuration=facet.getConfiguration();
        VirtualFile outputDir=AndroidDexCompiler.getOutputDirectoryForDex(module);
        if (outputDir != null) {
          String outputPath=getOutputPath(module,outputDir);
          IAndroidTarget target=configuration.getAndroidTarget();
          if (target != null) {
            String assetsDirPath=assetsDir != null ? assetsDir.getPath() : null;
            String[] resourcesDirPaths=AndroidCompileUtil.collectResourceDirs(facet);
            items.add(new MyItem(module,target,manifestFile,resourcesDirPaths,assetsDirPath,outputPath));
          }
        }
      }
    }
  }
  return items.toArray(new ProcessingItem[items.size()]);
}
