{
  RefactoringUtil.sortDepthFirstRightLeftOrder(usages);
  for (  UsageInfo usage : usages) {
    GrVariableInliner.inlineReference(usage,myLocal,mySettings.getInitializer());
  }
  final GrExpression initializer=mySettings.getInitializer();
  final PsiElement initializerParent=initializer.getParent();
  if (initializerParent instanceof GrAssignmentExpression) {
    initializerParent.delete();
    return;
  }
  if (initializerParent instanceof GrVariable) {
    final Collection<PsiReference> all=ReferencesSearch.search(myLocal).findAll();
    if (all.size() > 0) {
      initializer.delete();
      return;
    }
  }
  final PsiElement owner=myLocal.getParent().getParent();
  if (owner instanceof GrVariableDeclarationOwner) {
    ((GrVariableDeclarationOwner)owner).removeVariable(myLocal);
  }
 else {
    myLocal.delete();
  }
}
