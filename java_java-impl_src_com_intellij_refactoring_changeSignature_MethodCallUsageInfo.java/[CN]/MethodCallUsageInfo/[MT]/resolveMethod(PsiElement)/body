{
  if (ref instanceof PsiEnumConstant)   return ((PsiEnumConstant)ref).resolveConstructor();
  PsiElement parent=ref.getParent();
  if (parent instanceof PsiCall) {
    return ((PsiCall)parent).resolveMethod();
  }
 else   if (parent instanceof PsiAnonymousClass) {
    return ((PsiNewExpression)parent.getParent()).resolveConstructor();
  }
  LOG.error("Unknown reference");
  return null;
}
