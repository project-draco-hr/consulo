{
  Project project=e.getProject();
  VcsLog log=e.getData(VcsLogDataKeys.VCS_LOG);
  if (project == null || log == null) {
    e.getPresentation().setEnabledAndVisible(false);
    return;
  }
  List<VcsFullCommitDetails> details=log.getSelectedDetails();
  MultiMap<Repo,VcsFullCommitDetails> grouped=groupByRootWithCheck(project,details);
  if (grouped == null) {
    e.getPresentation().setEnabledAndVisible(false);
  }
 else {
    e.getPresentation().setVisible(isVisible(project,grouped));
    e.getPresentation().setEnabled(!grouped.isEmpty() && isEnabled(grouped));
  }
}
