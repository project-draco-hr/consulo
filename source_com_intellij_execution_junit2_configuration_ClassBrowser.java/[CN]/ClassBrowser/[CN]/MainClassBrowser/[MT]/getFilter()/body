{
  final Module module=myModuleSelector.getModule();
  final GlobalSearchScope scope;
  if (module == null)   scope=GlobalSearchScope.projectScope(myProject);
 else   scope=GlobalSearchScope.moduleWithDependenciesScope(module);
  final TreeClassChooserDialog.ClassFilter filter=createFilter(module);
  return new TreeClassChooserDialog.ClassFilterWithScope(){
    public GlobalSearchScope getScope(){
      return scope;
    }
    public boolean isAccepted(    final PsiClass aClass){
      return (filter == null || filter.isAccepted(aClass));
    }
  }
;
}
