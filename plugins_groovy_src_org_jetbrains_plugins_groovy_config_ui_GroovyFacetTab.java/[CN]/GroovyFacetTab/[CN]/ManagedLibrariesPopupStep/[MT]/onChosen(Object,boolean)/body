{
  if (selectedValue instanceof ManagedLibrary) {
    myEditorContext.getModifiableRootModel().addLibraryEntry(((ManagedLibrary)selectedValue).library);
  }
 else   if (selectedValue instanceof LibraryManager) {
    final Library library=((LibraryManager)selectedValue).createLibrary(myEditorContext);
    if (library == null) {
      return FINAL_CHOICE;
    }
    myEditorContext.getModifiableRootModel().addLibraryEntry(library);
  }
  updateLibraryList();
  return FINAL_CHOICE;
}
