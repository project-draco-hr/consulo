{
  final PsiFile file=myElement.getContainingFile();
  if (!CodeInsightUtilBase.prepareFileForWrite(file))   return;
  CommandProcessor.getInstance().executeCommand(myProject,new Runnable(){
    public void run(){
      ApplicationManager.getApplication().runWriteAction(new Runnable(){
        public void run(){
          try {
            UnwrapDescriptor d=getUnwrapDescription(file);
            if (d.shouldTryToRestoreCaretPosition())             saveCaretPosition(file);
            myUnwrapper.unwrap(myEditor,myElement);
            if (d.shouldTryToRestoreCaretPosition())             restoreCaretPosition(file);
          }
 catch (          IncorrectOperationException ex) {
            throw new RuntimeException(ex);
          }
        }
      }
);
    }
  }
,null,null);
}
