{
  int offset=editor.getCaretModel().getOffset();
  PsiElement el=file.findElementAt(offset);
  try {
    while (el != null && !dispatch(el)) {
      el=el.getParent();
    }
  }
 catch (  IncorrectOperationException e) {
    throw new RuntimeException(e);
  }
}
