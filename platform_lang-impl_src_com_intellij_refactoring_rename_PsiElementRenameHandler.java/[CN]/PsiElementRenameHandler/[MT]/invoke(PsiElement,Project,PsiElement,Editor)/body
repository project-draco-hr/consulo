{
  if (element != null && !canRename(project,editor,element)) {
    return;
  }
  if (nameSuggestionContext != null && !PsiManager.getInstance(project).isInProject(nameSuggestionContext)) {
    final String message="Selected element is used from non-project files. These usages won't be renamed. Proceed anyway?";
    if (ApplicationManager.getApplication().isUnitTestMode())     throw new CommonRefactoringUtil.RefactoringErrorHintException(message);
    if (Messages.showYesNoDialog(project,message,RefactoringBundle.getCannotRefactorMessage(null),Messages.getWarningIcon()) != DialogWrapper.OK_EXIT_CODE) {
      return;
    }
  }
  FeatureUsageTracker.getInstance().triggerFeatureUsed("refactoring.rename");
  rename(element,project,nameSuggestionContext,editor);
}
