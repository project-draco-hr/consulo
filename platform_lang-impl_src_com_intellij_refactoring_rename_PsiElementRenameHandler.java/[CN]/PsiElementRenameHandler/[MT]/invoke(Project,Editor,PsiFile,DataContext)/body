{
  PsiElement element=getElement(dataContext);
  if (element == null) {
    element=BaseRefactoringAction.getElementAtCaret(editor,file);
  }
  if (ApplicationManager.getApplication().isUnitTestMode()) {
    final String newName=DEFAULT_NAME.getData(dataContext);
    if (newName != null) {
      rename(element,project,element,editor,newName);
      return;
    }
  }
  editor.getScrollingModel().scrollToCaret(ScrollType.MAKE_VISIBLE);
  final PsiElement nameSuggestionContext=InjectedLanguageUtil.findElementAtNoCommit(file,editor.getCaretModel().getOffset());
  invoke(element,project,nameSuggestionContext,editor);
}
