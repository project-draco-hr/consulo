{
  Application application=ApplicationManager.getApplication();
  if (!application.isUnitTestMode()) {
    final InlineMethodDialog dialog=new InlineMethodDialog(project,method,invokedOnReference,checkMethodForRecursion(method));
    dialog.show();
    if (!dialog.isOK()) {
      WindowManager.getInstance().getStatusBar(project).setInfo(GroovyRefactoringBundle.message("press.escape.to.remove.the.highlighting"));
      return null;
    }
 else {
      return new InlineHandler.Settings(){
        public boolean isOnlyOneReferenceToInline(){
          return dialog.isInlineThisOnly();
        }
      }
;
    }
  }
  return new InlineHandler.Settings(){
    public boolean isOnlyOneReferenceToInline(){
      return true;
    }
  }
;
}
