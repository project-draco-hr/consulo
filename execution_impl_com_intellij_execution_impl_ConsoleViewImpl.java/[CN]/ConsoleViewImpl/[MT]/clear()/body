{
  assertIsDispatchThread();
  final Document document;
synchronized (LOCK) {
    myContentSize=0;
    if (USE_CYCLIC_BUFFER) {
      myDeferredOutput=new StringBuffer(Math.min(myDeferredOutput.length(),CYCLIC_BUFFER_SIZE));
    }
 else {
      myDeferredOutput=new StringBuffer();
    }
    myDeferredUserInput=new StringBuffer();
    myHyperlinks.clear();
    myEditor.getMarkupModel().removeAllHighlighters();
    myTokens.clear();
    document=myEditor == null ? null : myEditor.getDocument();
  }
  if (document != null) {
    ApplicationManager.getApplication().runWriteAction(new Runnable(){
      public void run(){
        CommandProcessor.getInstance().executeCommand(myProject,new Runnable(){
          public void run(){
            document.deleteString(0,document.getTextLength());
          }
        }
,null,document);
      }
    }
);
  }
}
