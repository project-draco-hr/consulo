{
  MarkupModelEx markupModel=(MarkupModelEx)myEditor.getMarkupModel();
  for (  Map.Entry<RangeHighlighter,HyperlinkInfo> entry : myHyperlinks.getRanges().entrySet()) {
    RangeHighlighter range=entry.getKey();
    if (range.getTextAttributes() == FOLLOWED_HYPERLINK_ATTRIBUTES) {
      TextAttributes oldAttr=range.getUserData(OLD_HYPERLINK_TEXT_ATTRIBUTES);
      markupModel.setRangeHighlighterAttributes(range,oldAttr);
    }
    if (entry.getValue() == info) {
      range.putUserData(OLD_HYPERLINK_TEXT_ATTRIBUTES,range.getTextAttributes());
      markupModel.setRangeHighlighterAttributes(range,FOLLOWED_HYPERLINK_ATTRIBUTES);
    }
  }
  RangeHighlighter dummy=markupModel.addRangeHighlighter(0,0,HYPERLINK_LAYER,HYPERLINK_ATTRIBUTES,HighlighterTargetArea.EXACT_RANGE);
  markupModel.removeHighlighter(dummy);
}
