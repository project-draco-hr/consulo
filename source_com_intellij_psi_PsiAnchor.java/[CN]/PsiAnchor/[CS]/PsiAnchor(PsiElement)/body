{
  LOG.assertTrue(element.isValid());
  if (element instanceof PsiCompiledElement || element instanceof PsiMember) {
    myElement=element;
    myRootIndex=0;
  }
 else {
    myElement=null;
    myFile=element.getContainingFile();
    int rootIndex=0;
    final PsiElement[] psiRoots=myFile.getPsiRoots();
    for (int i=0; i < psiRoots.length; i++) {
      PsiElement root=psiRoots[i];
      if (PsiTreeUtil.isAncestor(root,element,false)) {
        rootIndex=i;
        break;
      }
    }
    LOG.assertTrue((myRootIndex=rootIndex) >= 0);
    myClass=element.getClass();
    TextRange textRange=element.getTextRange();
    if (textRange != null) {
      myStartOffset=textRange.getStartOffset();
      myEndOffset=textRange.getEndOffset();
    }
  }
}
