{
  DefaultActionGroup actions=new DefaultActionGroup();
  for (  final Language language : getEditorsProvider().getSupportedLanguages(myProject,mySourcePosition)) {
    actions.add(new AnAction(language.getDisplayName(),null,language.getAssociatedFileType().getIcon()){
      @Override public void actionPerformed(      AnActionEvent e){
        XExpression currentExpression=getExpression();
        setExpression(new XExpressionImpl(currentExpression.getExpression(),language,currentExpression.getCustomInfo()));
        IdeFocusManager.getInstance(getProject()).requestFocus(getComponent(),true);
      }
    }
);
  }
  DataContext dataContext=DataManager.getInstance().getDataContext(getComponent());
  return JBPopupFactory.getInstance().createActionGroupPopup("Choose language",actions,dataContext,JBPopupFactory.ActionSelectionAid.SPEEDSEARCH,false);
}
