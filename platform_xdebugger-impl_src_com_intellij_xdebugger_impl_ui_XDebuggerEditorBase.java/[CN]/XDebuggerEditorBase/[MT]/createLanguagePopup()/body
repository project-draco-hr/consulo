{
  DefaultActionGroup actions=new DefaultActionGroup();
  for (  final Language language : getEditorsProvider().getSupportedLanguages(myProject,mySourcePosition)) {
    actions.add(new AnAction(language.getDisplayName(),null,language.getAssociatedFileType().getIcon()){
      @RequiredDispatchThread @Override public void actionPerformed(      @NotNull AnActionEvent e){
        XExpression currentExpression=getExpression();
        setExpression(new XExpressionImpl(currentExpression.getExpression(),language,currentExpression.getCustomInfo()));
        requestFocusInEditor();
      }
    }
);
  }
  DataContext dataContext=DataManager.getInstance().getDataContext(getComponent());
  return JBPopupFactory.getInstance().createActionGroupPopup("Choose Language",actions,dataContext,JBPopupFactory.ActionSelectionAid.SPEEDSEARCH,false);
}
