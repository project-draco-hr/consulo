{
  MavenExecuteGoalDialog dialog=new MavenExecuteGoalDialog(myProject);
  dialog.setTitle(TasksBundle.message("maven.tasks.select.goal.title"));
  if (task.getGoal() == null) {
    MavenProjectsManager projectsManager=MavenProjectsManager.getInstance(myProject);
    List<MavenProject> rootProjects=projectsManager.getRootProjects();
    if (rootProjects.size() > 0) {
      dialog.setSelectedMavenProject(rootProjects.get(0));
    }
 else {
      dialog.setSelectedMavenProject(null);
    }
  }
 else {
    dialog.setGoals(task.getGoal());
    MavenProject mavenProject=getMavenProject(task);
    if (mavenProject != null) {
      dialog.setSelectedMavenProject(mavenProject);
    }
 else {
      dialog.setSelectedMavenProject(null);
    }
  }
  dialog.show();
  if (!dialog.isOK())   return false;
  MavenProject newMavenProject=dialog.getSelectedMavenProject();
  task.setProjectPath(newMavenProject == null ? null : newMavenProject.getPath());
  task.setGoal(dialog.getGoals());
  return true;
}
