{
  TextOccurrencesUtil.UsageInfoFactory nonCodeUsageFactory=new TextOccurrencesUtil.UsageInfoFactory(){
    @Override public UsageInfo createUsageInfo(    @NotNull PsiElement usage,    int startOffset,    int endOffset){
      if (insideElements != null && insideElements.value(usage)) {
        return null;
      }
      return new SafeDeleteReferenceSimpleDeleteUsageInfo(usage,element,startOffset,endOffset,true,false);
    }
  }
;
  if (mySearchInCommentsAndStrings) {
    String stringToSearch=ElementDescriptionUtil.getElementDescription(element,NonCodeSearchDescriptionLocation.STRINGS_AND_COMMENTS);
    TextOccurrencesUtil.addUsagesInStringsAndComments(element,stringToSearch,usages,nonCodeUsageFactory);
  }
  if (mySearchNonJava) {
    String stringToSearch=ElementDescriptionUtil.getElementDescription(element,NonCodeSearchDescriptionLocation.NON_JAVA);
    TextOccurrencesUtil.addTextOccurences(element,stringToSearch,GlobalSearchScope.projectScope(myProject),usages,nonCodeUsageFactory);
  }
}
