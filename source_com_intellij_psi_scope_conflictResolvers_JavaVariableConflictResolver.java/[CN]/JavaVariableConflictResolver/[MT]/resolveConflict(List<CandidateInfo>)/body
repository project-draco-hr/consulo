{
  final int size=conflicts.size();
  if (size == 1) {
    return conflicts.get(0);
  }
  if (size > 0) {
    final CandidateInfo[] uncheckedResult=conflicts.toArray(new CandidateInfo[size]);
    CandidateInfo currentResult=uncheckedResult[0];
    if (currentResult.getElement() instanceof PsiField) {
      for (int i=1; i < uncheckedResult.length; i++) {
        final CandidateInfo candidate=uncheckedResult[i];
        if (candidate.getElement() == null || candidate.getElement() instanceof PsiIntertypeField)         continue;
        if (!(candidate.getElement() instanceof PsiField)) {
          if (candidate.getElement() instanceof PsiLocalVariable) {
            return candidate;
          }
 else {
            if (!currentResult.isAccessible())             return candidate;
            conflicts.remove(candidate);
            continue;
          }
        }
        final PsiClass newClass=((PsiField)candidate.getElement()).getContainingClass();
        final PsiClass oldClass=((PsiField)currentResult.getElement()).getContainingClass();
        if (newClass == null && candidate.getElement().getContainingFile() instanceof JspFile) {
          conflicts.remove(currentResult);
          currentResult=candidate;
        }
        if (oldClass == null && currentResult.getElement().getContainingFile() instanceof JspFile) {
          conflicts.remove(candidate);
          continue;
        }
        if (newClass.isInheritor(oldClass,true)) {
          conflicts.remove(currentResult);
          currentResult=candidate;
        }
 else         if (oldClass.isInheritor(newClass,true)) {
          conflicts.remove(candidate);
          continue;
        }
 else {
          if (!candidate.isAccessible()) {
            conflicts.remove(candidate);
            continue;
          }
          if (!currentResult.isAccessible()) {
            conflicts.remove(currentResult);
            currentResult=candidate;
            continue;
          }
          return null;
        }
        if (!candidate.isAccessible()) {
          conflicts.remove(candidate);
          continue;
        }
        if (!currentResult.isAccessible()) {
          conflicts.remove(currentResult);
          currentResult=candidate;
          continue;
        }
      }
    }
    return currentResult;
  }
  return null;
}
