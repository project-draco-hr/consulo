{
  DaemonCodeAnalyzerStatus status=getDaemonCodeAnalyzerStatus(false);
  if (status == null) {
    return NO_ICON;
  }
  if (status.noHighlightingRoots != null && status.noHighlightingRoots.length == status.rootsNumber) {
    return NO_ANALYSIS_ICON;
  }
  boolean atLeastOnePassFinished=status.errorAnalyzingFinished;
  for (  ProgressableTextEditorHighlightingPass passStatus : status.passStati) {
    atLeastOnePassFinished|=passStatus.isFinished();
  }
  Icon icon=HighlightDisplayLevel.DO_NOT_SHOW.getIcon();
  if (atLeastOnePassFinished) {
    SeverityRegistrar severityRegistrar=SeverityRegistrar.getInstance(myProject);
    for (int i=status.errorCount.length - 1; i >= 0; i--) {
      if (status.errorCount[i] != 0) {
        icon=severityRegistrar.getRendererIconByIndex(i);
        break;
      }
    }
  }
  if (status.errorAnalyzingFinished)   return icon;
  double progress=getOverallProgress(status);
  TruncatingIcon trunc=new TruncatingIcon(icon,(int)(icon.getIconWidth() * progress),(int)(icon.getIconHeight() * progress));
  return LayeredIcon.create(trunc,STARING_EYE_ICON);
}
