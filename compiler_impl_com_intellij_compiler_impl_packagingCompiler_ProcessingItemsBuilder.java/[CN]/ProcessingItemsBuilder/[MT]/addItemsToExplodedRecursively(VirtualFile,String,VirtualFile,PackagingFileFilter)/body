{
  if (fileFilter != null && !fileFilter.accept(sourceFile,myContext.getCompileContext())) {
    return;
  }
  if (sourceFile.isDirectory()) {
    final VirtualFile[] children=sourceFile.getChildren();
    THashMap<String,VirtualFile> outputChildren=null;
    if (outputFile != null) {
      outputChildren=new THashMap<String,VirtualFile>();
      VirtualFile[] files=outputFile.getChildren();
      if (files != null) {
        for (        VirtualFile file : files) {
          outputChildren.put(file.getName(),file);
        }
      }
    }
    for (    VirtualFile child : children) {
      final VirtualFile outputChild=outputChildren != null ? outputChildren.get(child.getName()) : null;
      addItemsToExplodedRecursively(child,DeploymentUtil.appendToPath(outputPath,child.getName()),outputChild,fileFilter);
    }
  }
 else   if (myContext.checkOutputPath(outputPath,sourceFile)) {
    PackagingProcessingItem item=myContext.getOrCreateProcessingItem(sourceFile,myBuildParticipant);
    item.addDestination(createExplodedDestination(outputPath,outputFile));
  }
}
