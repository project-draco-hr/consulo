{
  filePath=canonicalize(filePath);
  if (LOG_PROJECT_LEAKAGE_IN_TESTS && ApplicationManager.getApplication().isUnitTestMode()) {
    for (int i=0; i < 42; i++) {
      if (myProjects.size() < MAX_LEAKY_PROJECTS)       break;
      System.gc();
      try {
        Thread.sleep(100);
      }
 catch (      InterruptedException e) {
        throw new RuntimeException(e);
      }
      System.gc();
    }
    if (myProjects.size() >= MAX_LEAKY_PROJECTS) {
      List<Project> copy=new ArrayList<Project>(myProjects.keySet());
      myProjects.clear();
      throw new TooManyProjectLeakedException(copy);
    }
  }
  try {
    ProjectImpl project=createAndInitProject(projectName,filePath,false,isDummy,ApplicationManager.getApplication().isUnitTestMode(),useDefaultProjectSettings ? getDefaultProject() : null);
    if (LOG_PROJECT_LEAKAGE_IN_TESTS) {
      myProjects.put(project,null);
    }
    return project;
  }
 catch (  final Exception e) {
    LOG.info(e);
    Messages.showErrorDialog(message(e),ProjectBundle.message("project.load.default.error"));
  }
  return null;
}
