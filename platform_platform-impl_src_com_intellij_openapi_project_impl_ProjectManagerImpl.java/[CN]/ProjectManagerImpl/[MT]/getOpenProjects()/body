{
synchronized (myOpenProjects) {
    if (myOpenProjectsArrayCache.length != myOpenProjects.size()) {
      LOG.error("Open projects: " + myOpenProjects + "; cache: "+ Arrays.asList(myOpenProjectsArrayCache));
    }
    if (myOpenProjectsArrayCache.length > 0 && myOpenProjectsArrayCache[0] != myOpenProjects.get(0)) {
      LOG.error("Open projects cache corrupted. Open projects: " + myOpenProjects + "; cache: "+ Arrays.asList(myOpenProjectsArrayCache));
    }
    if (ApplicationManager.getApplication().isUnitTestMode()) {
      Project currentTestProject=myCurrentTestProject;
      if (currentTestProject != null && !currentTestProject.isDisposed()) {
        return ArrayUtil.append(myOpenProjectsArrayCache,currentTestProject);
      }
    }
    return myOpenProjectsArrayCache;
  }
}
