{
synchronized (myOpenProjects) {
    if (myOpenProjectsArrayCache.length != myOpenProjects.size()) {
      LOG.error("Open projects: " + myOpenProjects + "; cache: "+ Arrays.asList(myOpenProjectsArrayCache));
    }
    if (myOpenProjectsArrayCache.length > 0 && myOpenProjectsArrayCache[0] != myOpenProjects.get(0)) {
      LOG.error("Open projects cache corrupted. Open projects: " + myOpenProjects + "; cache: "+ Arrays.asList(myOpenProjectsArrayCache));
    }
    if (ApplicationManager.getApplication().isUnitTestMode()) {
      return ArrayUtil.mergeArrays(myOpenProjectsArrayCache,myTestProjects.toArray(new Project[myTestProjects.size()]));
    }
    return myOpenProjectsArrayCache;
  }
}
