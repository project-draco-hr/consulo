{
  if (ApplicationManager.getApplication().isUnitTestMode()) {
    final Project currentTestProject=myCurrentTestProject;
    if (myOpenProjects.isEmpty() && currentTestProject != null && !currentTestProject.isDisposed()) {
      return new Project[]{currentTestProject};
    }
  }
  return ContainerUtil.toArray(myOpenProjects,new Project[myOpenProjects.size()]);
}
