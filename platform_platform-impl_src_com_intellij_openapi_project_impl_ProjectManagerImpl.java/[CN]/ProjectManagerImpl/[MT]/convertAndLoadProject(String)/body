{
  final String fp=toCanonicalName(filePath);
  final ConversionResult conversionResult=ConversionService.getInstance().convert(fp);
  if (conversionResult.openingIsCanceled()) {
    return null;
  }
  final Project project;
  try {
    project=loadProjectWithProgress(filePath);
    if (project == null)     return null;
  }
 catch (  IOException e) {
    LOG.info(e);
    throw e;
  }
catch (  Throwable t) {
    LOG.info(t);
    throw new IOException(t);
  }
  if (!conversionResult.conversionNotNeeded()) {
    StartupManager.getInstance(project).registerPostStartupActivity(new Runnable(){
      @Override public void run(){
        conversionResult.postStartupActivity(project);
      }
    }
);
  }
  return project;
}
