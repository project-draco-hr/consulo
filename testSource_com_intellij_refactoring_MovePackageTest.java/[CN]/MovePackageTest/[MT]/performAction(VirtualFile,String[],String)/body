{
  final PsiPackage[] packages=new PsiPackage[packageNames.length];
  for (int i=0; i < packages.length; i++) {
    String packageName=packageNames[i];
    packages[i]=myPsiManager.findPackage(packageName);
    assertNotNull("Package " + packageName + " not found",packages[i]);
  }
  PsiPackage newParentPackage=myPsiManager.findPackage(newPackageName);
  assertNotNull(newParentPackage);
  final PsiDirectory[] dirs=newParentPackage.getDirectories();
  assertEquals(dirs.length,1);
  new MoveClassesOrPackagesProcessor(myProject,packages,new SingleSourceRootMoveDestination(PackageWrapper.create(newParentPackage),dirs[0]),true,false,false,null,null).testRun();
  FileDocumentManager.getInstance().saveAllDocuments();
}
