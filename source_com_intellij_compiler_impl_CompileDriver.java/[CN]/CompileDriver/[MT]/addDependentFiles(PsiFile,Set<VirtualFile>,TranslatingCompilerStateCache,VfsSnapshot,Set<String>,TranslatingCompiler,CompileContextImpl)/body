{
  final DependenciesBuilder builder=new ForwardDependenciesBuilder(myProject,new AnalysisScope(psiFile));
  builder.analyze();
  final Map<PsiFile,Set<PsiFile>> dependencies=builder.getDependencies();
  final Set<PsiFile> dependentFiles=dependencies.get(psiFile);
  if (dependentFiles != null && dependentFiles.size() > 0) {
    for (    final PsiFile dependentFile : dependentFiles) {
      if (dependentFile instanceof PsiCompiledElement) {
        continue;
      }
      final VirtualFile vFile=dependentFile.getVirtualFile();
      if (toCompile.contains(vFile)) {
        continue;
      }
      String url=snapshot.getUrlByFile(vFile);
      if (url == null) {
        url=vFile.getUrl();
      }
      if (!sourcesWithOutputRemoved.contains(url)) {
        if (vFile.getTimeStamp() == cache.getSourceTimestamp(url)) {
          continue;
        }
      }
      if (!compiler.isCompilableFile(vFile,context)) {
        continue;
      }
      toCompile.add(vFile);
      addDependentFiles(dependentFile,toCompile,cache,snapshot,sourcesWithOutputRemoved,compiler,context);
    }
  }
}
