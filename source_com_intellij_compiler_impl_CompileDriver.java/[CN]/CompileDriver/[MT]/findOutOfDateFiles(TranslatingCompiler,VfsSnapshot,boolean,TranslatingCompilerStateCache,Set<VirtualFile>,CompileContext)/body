{
  final CompilerConfiguration compilerConfiguration=CompilerConfiguration.getInstance(myProject);
  VirtualFile[] compilableFiles=getCompilableFiles(compiler,snapshot,context);
  for (int idx=0; idx < compilableFiles.length; idx++) {
    final VirtualFile file=compilableFiles[idx];
    if (!forceCompile) {
      if (compilerConfiguration.isExcludedFromCompilation(file)) {
        continue;
      }
    }
    if (forceCompile || file.getTimeStamp() != cache.getSourceTimestamp(snapshot.getUrlByFile(file))) {
      toCompile.add(file);
    }
  }
}
