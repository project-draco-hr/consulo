{
  final PsiElement owner=modifierList.getParent();
  if (owner instanceof GrVariableDeclaration && owner.getParent() instanceof GrTypeDefinitionBody) {
    PsiElement pParent=owner.getParent().getParent();
    if (!modifierList.hasExplicitVisibilityModifiers()) {
      if (!(pParent instanceof PsiClass) || !((PsiClass)pParent).isInterface()) {
        if (modifier.equals(GrModifier.PRIVATE))         return true;
        if (modifier.equals(GrModifier.PROTECTED))         return false;
        if (modifier.equals(GrModifier.PUBLIC))         return false;
      }
    }
    if (pParent instanceof PsiClass && ((PsiClass)pParent).isInterface()) {
      if (modifier.equals(GrModifier.STATIC))       return true;
      if (modifier.equals(GrModifier.FINAL))       return true;
    }
    if (pParent instanceof GrTypeDefinition) {
      PsiModifierList pModifierList=((GrTypeDefinition)pParent).getModifierList();
      if (pModifierList != null && pModifierList.findAnnotation(ConstructorAnnotationsProcessor.IMMUTABLE) != null) {
        if (modifier.equals(GrModifier.FINAL))         return true;
      }
    }
  }
  if (owner instanceof GrTypeDefinition && ((GrTypeDefinition)owner).getContainingClass() == null) {
    if (modifier.equals(PROTECTED) || modifier.equals(PRIVATE))     return false;
    if (modifier.equals(PACKAGE_LOCAL))     return modifierList.hasExplicitModifier(PRIVATE) || modifierList.hasExplicitModifier(PROTECTED);
  }
  if (modifierList.hasExplicitModifier(modifier)) {
    return true;
  }
  if (modifier.equals(GrModifier.PUBLIC)) {
    if (owner instanceof GrPackageDefinition)     return false;
    if (owner instanceof GrVariableDeclaration && !(owner.getParent() instanceof GrTypeDefinitionBody) || owner instanceof GrVariable) {
      return false;
    }
    return !modifierList.hasExplicitModifier(GrModifier.PRIVATE) && !modifierList.hasExplicitModifier(GrModifier.PROTECTED);
  }
  if (owner instanceof GrTypeDefinition) {
    if (modifier.equals(GrModifier.STATIC)) {
      final PsiClass containingClass=((GrTypeDefinition)owner).getContainingClass();
      return containingClass != null && containingClass.isInterface();
    }
    if (modifier.equals(GrModifier.ABSTRACT)) {
      return ((GrTypeDefinition)owner).isInterface();
    }
  }
  return false;
}
