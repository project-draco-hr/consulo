{
  Project project=e.getData(PlatformDataKeys.PROJECT);
  MavenProjectsManager manager=project != null ? MavenProjectsManager.getInstance(project) : null;
  VirtualFile file=e.getData(PlatformDataKeys.VIRTUAL_FILE);
  List<String> profiles=e.getData(MavenDataKeys.MAVEN_PROFILES_KEY);
  if (manager != null && profiles != null && !profiles.isEmpty() && isEnabled(manager,profiles)) {
    List<String> activeProfiles=new ArrayList<String>(manager.getActiveProfiles());
    if (activeProfiles.contains(profiles.get(0))) {
      activeProfiles.removeAll(profiles);
    }
 else {
      activeProfiles.addAll(profiles);
    }
    manager.setActiveProfiles(activeProfiles);
  }
}
