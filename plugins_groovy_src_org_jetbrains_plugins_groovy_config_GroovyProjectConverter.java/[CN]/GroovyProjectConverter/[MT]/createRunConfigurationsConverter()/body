{
  return new ConversionProcessor<RunManagerSettings>(){
    @Override public boolean isConversionNeeded(    RunManagerSettings settings){
      for (      Element element : settings.getRunConfigurations()) {
        final String confType=element.getAttributeValue("type");
        if (GRAILS_TESTS_RUN_CONFIGURATION_TYPE.equals(confType) || GANT_SCRIPT_RUN_CONFIGURATION.equals(confType)) {
          return true;
        }
        if (GRAILS_RUN_CONFIGURATION_TYPE.equals(confType) && "Grails Application".equals(element.getAttributeValue("factoryName"))) {
          return true;
        }
      }
      return false;
    }
    @Override public void process(    RunManagerSettings settings) throws CannotConvertException {
      for (      Element element : settings.getRunConfigurations()) {
        final String confType=element.getAttributeValue("type");
        final boolean wasGrails=GRAILS_TESTS_RUN_CONFIGURATION_TYPE.equals(confType);
        if (wasGrails || GANT_SCRIPT_RUN_CONFIGURATION.equals(confType)) {
          if ("true".equals(element.getAttributeValue("default"))) {
            element.detach();
          }
 else {
            element.setAttribute("type",wasGrails ? GRAILS_RUN_CONFIGURATION_TYPE : "GroovyScriptRunConfiguration");
            element.setAttribute("factoryName",wasGrails ? "Grails" : "Groovy");
          }
        }
 else         if (GRAILS_RUN_CONFIGURATION_TYPE.equals(confType) && "Grails Application".equals(element.getAttributeValue("factoryName"))) {
          element.setAttribute("factoryName","Grails");
        }
      }
    }
  }
;
}
