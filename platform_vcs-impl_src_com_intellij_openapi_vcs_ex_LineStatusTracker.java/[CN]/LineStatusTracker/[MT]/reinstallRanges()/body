{
  myApplication.assertReadAccessAllowed();
synchronized (myLock) {
    removeAnathema();
    removeHighlightersFromMarkupModel();
    try {
      myRanges=new RangesBuilder(myDocument,myUpToDateDocument).getRanges();
    }
 catch (    FilesTooBigForDiffException e) {
      myRanges.clear();
      installAnathema();
      return;
    }
    for (    final Range range : myRanges) {
      range.setHighlighter(createHighlighter(range));
    }
  }
}
