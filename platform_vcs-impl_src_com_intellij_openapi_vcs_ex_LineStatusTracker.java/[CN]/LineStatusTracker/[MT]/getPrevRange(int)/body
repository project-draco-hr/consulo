{
  final Range currentRange=getRangeForLine(line);
  if (currentRange != null) {
    return getPrevRange(currentRange);
  }
  for (ListIterator<Range> iterator=myRanges.listIterator(myRanges.size()); iterator.hasPrevious(); ) {
    Range range=iterator.previous();
    if (range.getOffset1() > line) {
      continue;
    }
    return range;
  }
  return null;
}
