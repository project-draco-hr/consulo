{
synchronized (myLock) {
    myReleased=true;
    if (myDocumentListener != null) {
      myDocument.removeDocumentListener(myDocumentListener);
    }
    if (myApplication.isDispatchThread()) {
      removeAnathema();
      removeHighlightersFromMarkupModel();
    }
 else {
      invalidateRanges();
      myApplication.invokeLater(new Runnable(){
        @Override public void run(){
          removeAnathema();
          removeHighlightersFromMarkupModel();
        }
      }
);
    }
  }
}
