{
synchronized (myLock) {
    myReleased=true;
    myDocument.removeDocumentListener(myDocumentListener);
    ApplicationManager.getApplication().removeApplicationListener(myApplicationListener);
    if (myApplication.isDispatchThread()) {
      destroyRanges();
    }
 else {
      invalidateRanges();
      myApplication.invokeLater(new Runnable(){
        @Override public void run(){
          destroyRanges();
        }
      }
);
    }
  }
}
