{
  if (rangeType == emptyRangeCondition) {
    int lineStartOffset;
    if (offset1 == 0) {
      lineStartOffset=0;
    }
 else {
      lineStartOffset=document.getLineEndOffset(offset1 - 1);
    }
    return new TextRange(lineStartOffset,lineStartOffset);
  }
 else {
    int startOffset=document.getLineStartOffset(offset1);
    int endOffset=document.getLineEndOffset(offset2 - 1);
    if (startOffset > 0) {
      --startOffset;
      if (!keepEnd) {
        --endOffset;
      }
    }
    return new TextRange(startOffset,endOffset);
  }
}
