{
  if (changedLine1 == changedLine2 && vcsLine1 == vcsLine2) {
    return Collections.emptyList();
  }
  if (changedLine1 == changedLine2) {
    return Collections.singletonList(new Range(changedLine1,changedLine2,vcsLine1,vcsLine2));
  }
  if (vcsLine1 == vcsLine2) {
    return Collections.singletonList(new Range(changedLine1,changedLine2,vcsLine1,vcsLine2));
  }
  List<String> lines=new DocumentWrapper(myDocument).getLines(changedLine1,changedLine2 - 1);
  List<String> vcsLines=new DocumentWrapper(myVcsDocument).getLines(vcsLine1,vcsLine2 - 1);
  return new RangesBuilder(lines,vcsLines,changedLine1,vcsLine1,myMode).getRanges();
}
