{
  ApplicationManager.getApplication().isReadAccessAllowed();
  LOG.assertTrue(BaseLoadState.LOADING == myBaseLoaded);
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    public void run(){
      try {
        myUpToDateDocument.setReadOnly(false);
        myUpToDateDocument.replaceString(0,myUpToDateDocument.getTextLength(),StringUtil.convertLineSeparators(upToDateContent));
        myUpToDateDocument.setReadOnly(true);
        reinstallRanges();
        if (myDocumentListener == null) {
          myDocumentListener=new MyDocumentListener();
          myDocument.addDocumentListener(myDocumentListener);
        }
      }
  finally {
        myBaseLoaded=BaseLoadState.LOADED;
      }
    }
  }
);
}
