{
  if (refEntity instanceof RefJavaElement) {
    final RefJavaElement refElement=(RefJavaElement)refEntity;
    if (refElement instanceof RefParameter)     return null;
    if (!refElement.isReferenced())     return null;
    if (refElement.isSyntheticJSP())     return null;
    if (refElement.isFinal())     return null;
    if (!((RefElementImpl)refElement).checkFlag(CanBeFinalAnnotator.CAN_BE_FINAL_MASK))     return null;
    final PsiMember psiMember=(PsiMember)refElement.getElement();
    if (psiMember == null || !CanBeFinalHandler.allowToBeFinal(psiMember))     return null;
    PsiIdentifier psiIdentifier=null;
    if (refElement instanceof RefClass) {
      RefClass refClass=(RefClass)refElement;
      if (refClass.isInterface() || refClass.isAnonymous() || refClass.isAbstract())       return null;
      if (!isReportClasses())       return null;
      psiIdentifier=((PsiClass)psiMember).getNameIdentifier();
    }
 else     if (refElement instanceof RefMethod) {
      RefMethod refMethod=(RefMethod)refElement;
      if (refMethod.getOwnerClass().isFinal())       return null;
      if (!isReportMethods())       return null;
      psiIdentifier=((PsiMethod)psiMember).getNameIdentifier();
    }
 else     if (refElement instanceof RefField) {
      if (!isReportFields())       return null;
      psiIdentifier=((PsiField)psiMember).getNameIdentifier();
    }
    if (psiIdentifier != null) {
      return new ProblemDescriptor[]{manager.createProblemDescriptor(psiIdentifier,InspectionsBundle.message("inspection.export.results.can.be.final.description"),new AcceptSuggested(globalContext.getRefManager()),ProblemHighlightType.GENERIC_ERROR_OR_WARNING,false)};
    }
  }
  return null;
}
