{
  VirtualFile virtualFile=problem == null ? null : problem.getVirtualFile();
  if (!isToBeHighlighted(virtualFile))   return;
  boolean fireListener=false;
synchronized (myProblems) {
    ProblemFileInfo storedProblems=myProblems.get(virtualFile);
    if (storedProblems == null) {
      storedProblems=new ProblemFileInfo();
      myProblems.put(virtualFile,storedProblems);
      fireListener=true;
    }
    storedProblems.problems.add(problem);
    myCheckingQueue.addIfAbsent(virtualFile);
  }
  if (fireListener) {
    fireProblemListeners.problemsAppeared(virtualFile);
  }
}
