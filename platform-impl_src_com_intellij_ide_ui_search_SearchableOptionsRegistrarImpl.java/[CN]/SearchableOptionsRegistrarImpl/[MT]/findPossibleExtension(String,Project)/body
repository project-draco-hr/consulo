{
  final boolean perProject=CodeStyleFacade.getInstance(project).projectUsesOwnSettings();
  final Map<String,Set<String>> result=new THashMap<String,Set<String>>();
  int count=0;
  final Set<String> prefixes=getProcessedWordsWithoutStemming(prefix);
  for (  String opt : prefixes) {
    Set<OptionDescription> configs=getAcceptableDescriptions(opt);
    if (configs == null)     continue;
    for (    OptionDescription description : configs) {
      String groupName=myId2Name.get(description.getConfigurableId());
      if (perProject) {
        if (Comparing.strEqual(groupName,ApplicationBundle.message("title.global.code.style"))) {
          groupName=ApplicationBundle.message("title.project.code.style");
        }
      }
 else {
        if (Comparing.strEqual(groupName,ApplicationBundle.message("title.project.code.style"))) {
          groupName=ApplicationBundle.message("title.global.code.style");
        }
      }
      Set<String> foundHits=result.get(groupName);
      if (foundHits == null) {
        foundHits=new THashSet<String>();
        result.put(groupName,foundHits);
      }
      foundHits.add(description.getHit());
      count++;
    }
  }
  if (count > LOAD_FACTOR) {
    result.clear();
  }
  return result;
}
