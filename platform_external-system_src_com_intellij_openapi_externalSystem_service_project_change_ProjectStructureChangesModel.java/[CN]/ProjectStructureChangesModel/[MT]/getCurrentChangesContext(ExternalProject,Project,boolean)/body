{
  IntegrationKey key=new IntegrationKey(ideProject,externalProject.getOwner());
  ExternalProjectChangesCalculationContext context=new ExternalProjectChangesCalculationContext(myChanges.get(key),myPlatformFacade,myLibraryPathTypeMapper);
  myChangesCalculator.calculate(externalProject,ideProject,context);
  for (  ExternalProjectStructureChangesPostProcessor processor : myCommonPostProcessors) {
    processor.processChanges(context.getCurrentChanges(),externalProject.getOwner(),ideProject,onIdeProjectStructureChange);
  }
  Set<ExternalProjectStructureChangesPostProcessor> postProcessors=mySpecificPostProcessors.get(externalProject.getOwner());
  if (postProcessors != null)   for (  ExternalProjectStructureChangesPostProcessor processor : myCommonPostProcessors) {
    processor.processChanges(context.getCurrentChanges(),externalProject.getOwner(),ideProject,onIdeProjectStructureChange);
  }
  return context;
}
