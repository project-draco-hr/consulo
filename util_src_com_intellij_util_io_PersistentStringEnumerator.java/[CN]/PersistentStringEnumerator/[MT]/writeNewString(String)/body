{
  try {
    final MappedFile storage=myStorage;
    final int pos=(int)storage.length();
    storage.seek(pos);
    storage.writeInt(0);
    storage.writeInt(value.hashCode());
    int len=value.length();
    if (len < 255 && isAscii(value)) {
      storage.writeByte((byte)len);
      final byte[] buf=buffer;
      for (int i=0; i < len; i++) {
        buf[i]=(byte)value.charAt(i);
      }
      storage.put(buf,0,len);
    }
 else {
      storage.writeByte((byte)0xFF);
      storage.writeUTF(value);
    }
    return pos;
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
}
