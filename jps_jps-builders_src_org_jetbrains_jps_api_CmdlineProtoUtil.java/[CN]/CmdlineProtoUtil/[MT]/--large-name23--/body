{
  final CmdlineRemoteProto.Message.ControllerMessage.ParametersMessage.Builder builder=CmdlineRemoteProto.Message.ControllerMessage.ParametersMessage.newBuilder();
  builder.setGlobalSettings(globals);
  builder.setBuildType(buildType);
  builder.setProjectId(project);
  if (!modules.isEmpty()) {
    builder.addAllModuleName(modules);
  }
  if (!artifacts.isEmpty()) {
    builder.addAllArtifactName(artifacts);
  }
  if (!userData.isEmpty()) {
    for (    Map.Entry<String,String> entry : userData.entrySet()) {
      final String key=entry.getKey();
      final String value=entry.getValue();
      if (key != null && value != null) {
        builder.addBuilderParameter(createPair(key,value));
      }
    }
  }
  if (!paths.isEmpty()) {
    builder.addAllFilePath(paths);
  }
  for (  String moduleName : fsState.getInitializedModules()) {
    builder.addFsState(createFSStateMessage(moduleName,fsState));
  }
  return CmdlineRemoteProto.Message.ControllerMessage.newBuilder().setType(CmdlineRemoteProto.Message.ControllerMessage.Type.BUILD_PARAMETERS).setParamsMessage(builder.build()).build();
}
