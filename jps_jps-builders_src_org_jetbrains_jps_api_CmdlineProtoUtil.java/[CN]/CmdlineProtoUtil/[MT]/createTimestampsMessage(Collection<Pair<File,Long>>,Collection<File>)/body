{
  final CmdlineRemoteProto.Message.BuilderMessage.TimestampsMessage.Builder tsBuilder=CmdlineRemoteProto.Message.BuilderMessage.TimestampsMessage.newBuilder();
  for (  Pair<File,Long> p : toUpdate) {
    final File file=p.first;
    final Long timestamp=p.second;
    final CmdlineRemoteProto.Message.PathStampPair pair=CmdlineRemoteProto.Message.PathStampPair.newBuilder().setPath(FileUtil.toSystemIndependentName(file.getPath())).setStamp(timestamp).build();
    tsBuilder.addToUpdate(pair);
  }
  for (  File file : toRemove) {
    tsBuilder.addToRemove(FileUtil.toSystemIndependentName(file.getPath()));
  }
  return CmdlineRemoteProto.Message.BuilderMessage.newBuilder().setType(CmdlineRemoteProto.Message.BuilderMessage.Type.TIMESTAMPS_EVENT).setTimestampsMessage(tsBuilder.build()).build();
}
