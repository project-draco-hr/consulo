{
  for (  Map.Entry<File,Set<File>> entry : fsState.getSourcesToRecompile(moduleName,forTests).entrySet()) {
    final CmdlineRemoteProto.Message.FSStateMessage.RootDelta.Builder deltaBuilder=CmdlineRemoteProto.Message.FSStateMessage.RootDelta.newBuilder();
    deltaBuilder.setTestSources(forTests);
    deltaBuilder.setRoot(FileUtil.toSystemIndependentName(entry.getKey().getPath()));
    for (    File file : entry.getValue()) {
      deltaBuilder.addPath(FileUtil.toSystemIndependentName(file.getPath()));
    }
    stateBuilder.addRecompileDelta(deltaBuilder.build());
  }
}
