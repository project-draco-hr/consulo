{
  final CmdlineRemoteProto.Message.Failure.Builder builder=CmdlineRemoteProto.Message.Failure.newBuilder();
  if (description != null) {
    builder.setDescription(description);
  }
  if (cause != null) {
    final ByteArrayOutputStream baos=new ByteArrayOutputStream();
    final PrintStream stream=new PrintStream(baos);
    try {
      cause.printStackTrace(stream);
    }
  finally {
      stream.close();
    }
    final String stacktrace=new String(baos.toByteArray());
    builder.setStacktrace(stacktrace);
    if (description == null) {
      builder.setDescription(stacktrace);
    }
  }
  return builder.build();
}
