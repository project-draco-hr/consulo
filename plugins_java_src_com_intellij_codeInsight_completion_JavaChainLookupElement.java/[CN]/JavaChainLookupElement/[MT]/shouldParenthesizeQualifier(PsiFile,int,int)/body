{
  PsiElement element=file.findElementAt(startOffset);
  if (element == null) {
    return false;
  }
  PsiElement last=element;
  while (element != null && element.getTextRange().getStartOffset() >= startOffset && element.getTextRange().getEndOffset() <= endOffset && !(element instanceof PsiExpressionStatement)) {
    last=element;
    element=element.getParent();
  }
  PsiExpression expr=PsiTreeUtil.getParentOfType(last,PsiExpression.class,false,PsiClass.class);
  if (expr == null) {
    return false;
  }
  if (expr.getTextRange().getEndOffset() > endOffset) {
    return true;
  }
  if (expr instanceof PsiJavaCodeReferenceElement || expr instanceof PsiMethodCallExpression || expr instanceof PsiArrayAccessExpression) {
    return false;
  }
  return true;
}
