{
  myProject=project;
  myBreakpointCategory=breakpointCategory;
  myCompact=compact;
  mySuspendPolicyGroup=new ButtonGroup();
  mySuspendPolicyGroup.add(mySuspendAllRadio);
  mySuspendPolicyGroup.add(mySuspendThreadRadio);
  updateSuspendPolicyRbFont();
  final ItemListener suspendPolicyChangeListener=new ItemListener(){
    public void itemStateChanged(    final ItemEvent e){
      if (e.getStateChange() == ItemEvent.SELECTED) {
        final String defaultPolicy=getBreakpointManager(myProject).getDefaultSuspendPolicy(breakpointCategory);
        myMakeDefaultButton.setEnabled(!defaultPolicy.equals(getSelectedSuspendPolicy()));
      }
    }
  }
;
  mySuspendJBCheckBox.addActionListener(new ActionListener(){
    @Override public void actionPerformed(    ActionEvent event){
      mySuspendAllRadio.setEnabled(mySuspendJBCheckBox.isSelected());
      mySuspendThreadRadio.setEnabled(mySuspendJBCheckBox.isSelected());
    }
  }
);
  mySuspendAllRadio.addItemListener(suspendPolicyChangeListener);
  mySuspendThreadRadio.addItemListener(suspendPolicyChangeListener);
  myMakeDefaultButton.addActionListener(new ActionListener(){
    public void actionPerformed(    final ActionEvent e){
      final BreakpointManager breakpointManager=getBreakpointManager(myProject);
      final String suspendPolicy=getSelectedSuspendPolicy();
      breakpointManager.setDefaultSuspendPolicy(breakpointCategory,suspendPolicy);
      updateSuspendPolicyRbFont();
      if (DebuggerSettings.SUSPEND_THREAD.equals(suspendPolicy)) {
        mySuspendThreadRadio.requestFocus();
      }
 else {
        mySuspendAllRadio.requestFocus();
      }
      myMakeDefaultButton.setEnabled(false);
    }
  }
);
  myConditionCombo=new DebuggerExpressionComboBox(project,"LineBreakpoint condition");
  myConditionCombo.addDocumentListener(new DocumentListener(){
    @Override public void beforeDocumentChange(    DocumentEvent event){
      myConditionCheckbox.setSelected(true);
    }
    @Override public void documentChanged(    DocumentEvent event){
    }
  }
);
  myConditionCombo.getEditorComponent().addMouseListener(new MouseAdapter(){
    @Override public void mouseClicked(    MouseEvent event){
      myConditionCombo.setEnabled(true);
      myConditionCheckbox.setSelected(true);
    }
  }
);
  if (myCompact) {
    myPanel.addFocusListener(new FocusAdapter(){
      @Override public void focusGained(      FocusEvent event){
        IdeFocusManager.findInstance().requestFocus(myConditionCombo,true);
      }
    }
);
  }
  myLogExpressionCombo=new DebuggerExpressionComboBox(project,"LineBreakpoint logMessage");
  myInstanceFiltersField=new FieldPanel(new MyTextField(),"",null,new ActionListener(){
    public void actionPerformed(    ActionEvent e){
      reloadInstanceFilters();
      EditInstanceFiltersDialog _dialog=new EditInstanceFiltersDialog(myProject);
      _dialog.setFilters(myInstanceFilters);
      _dialog.show();
      if (_dialog.getExitCode() == DialogWrapper.OK_EXIT_CODE) {
        myInstanceFilters=_dialog.getFilters();
        updateInstanceFilterEditor(true);
      }
    }
  }
,null);
  myClassFiltersField=new FieldPanel(new MyTextField(),"",null,new ActionListener(){
    public void actionPerformed(    ActionEvent e){
      reloadClassFilters();
      ClassFilter classFilter=createClassConditionFilter();
      EditClassFiltersDialog _dialog=new EditClassFiltersDialog(myProject,classFilter);
      _dialog.setFilters(myClassFilters,myClassExclusionFilters);
      _dialog.show();
      if (_dialog.getExitCode() == DialogWrapper.OK_EXIT_CODE) {
        myClassFilters=_dialog.getFilters();
        myClassExclusionFilters=_dialog.getExclusionFilters();
        updateClassFilterEditor(true);
      }
    }
  }
,null);
  ToolTipManager.sharedInstance().registerComponent(myClassFiltersField.getTextField());
  ToolTipManager.sharedInstance().registerComponent(myInstanceFiltersField.getTextField());
  JComponent specialBox=createSpecialBox();
  if (specialBox != null) {
    insert(mySpecialBoxPanel,specialBox);
  }
 else {
    mySpecialBoxPanel.setVisible(false);
  }
  final JPanel conditionPanel=new JPanel(new BorderLayout());
  conditionPanel.add(myConditionCombo,BorderLayout.CENTER);
  myConditionMagnifierButton=new FixedSizeButton(myConditionCombo);
  conditionPanel.add(myConditionMagnifierButton,BorderLayout.EAST);
  myConditionMagnifierButton.setFocusable(false);
  myConditionMagnifierButton.addActionListener(new MagnifierButtonAction(project,myConditionCombo,"Condition"));
  insert(myConditionComboPanel,conditionPanel);
  insert(myLogExpressionComboPanel,myLogExpressionCombo);
  insert(myInstanceFiltersFieldPanel,myInstanceFiltersField);
  insert(myClassFiltersFieldPanel,myClassFiltersField);
  DebuggerUIUtil.enableEditorOnCheck(myLogExpressionCheckBox,myLogExpressionCombo);
  ActionListener updateListener=new ActionListener(){
    public void actionPerformed(    ActionEvent e){
      updateCheckboxes();
    }
  }
;
  myPassCountCheckbox.addActionListener(updateListener);
  myInstanceFiltersCheckBox.addActionListener(updateListener);
  myClassFiltersCheckBox.addActionListener(updateListener);
  myConditionCheckbox.addActionListener(updateListener);
  DebuggerUIUtil.focusEditorOnCheck(myPassCountCheckbox,myPassCountField);
  DebuggerUIUtil.focusEditorOnCheck(myLogExpressionCheckBox,myLogExpressionCombo);
  DebuggerUIUtil.focusEditorOnCheck(myInstanceFiltersCheckBox,myInstanceFiltersField.getTextField());
  DebuggerUIUtil.focusEditorOnCheck(myClassFiltersCheckBox,myClassFiltersField.getTextField());
  DebuggerUIUtil.focusEditorOnCheck(myConditionCheckbox,myConditionCombo);
  IJSwingUtilities.adjustComponentsOnMac(mySuspendJBCheckBox);
  IJSwingUtilities.adjustComponentsOnMac(myLogExpressionCheckBox);
  IJSwingUtilities.adjustComponentsOnMac(myLogMessageCheckBox);
}
