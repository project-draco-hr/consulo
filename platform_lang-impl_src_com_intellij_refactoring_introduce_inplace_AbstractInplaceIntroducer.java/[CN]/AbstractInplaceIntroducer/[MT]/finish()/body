{
  final TemplateState templateState=TemplateManagerImpl.getTemplateState(myEditor);
  if (templateState != null) {
    myEditor.putUserData(ACTIVE_INTRODUCE,null);
  }
  myEditor.getDocument().removeDocumentListener(myDocumentAdapter);
  final Boolean isRestart=myEditor.getUserData(INTRODUCE_RESTART);
  if (isRestart == null || !isRestart.booleanValue()) {
    EditorFactory.getInstance().releaseEditor(myPreview);
  }
  super.finish();
  PsiDocumentManager.getInstance(myProject).commitAllDocuments();
  final V variable=getVariable();
  if (variable == null) {
    return;
  }
  restoreState(variable);
}
