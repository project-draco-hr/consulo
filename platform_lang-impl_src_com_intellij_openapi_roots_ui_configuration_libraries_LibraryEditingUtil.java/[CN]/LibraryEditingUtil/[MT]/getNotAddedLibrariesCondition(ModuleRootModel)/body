{
  final OrderEntry[] orderEntries=rootModel.getOrderEntries();
  final Set<Library> result=new HashSet<Library>(orderEntries.length);
  for (  OrderEntry orderEntry : orderEntries) {
    if (orderEntry instanceof LibraryOrderEntry && orderEntry.isValid()) {
      final LibraryImpl library=(LibraryImpl)((LibraryOrderEntry)orderEntry).getLibrary();
      if (library != null) {
        final Library source=library.getSource();
        result.add(source != null ? source : library);
      }
    }
  }
  return new Condition<Library>(){
    @Override public boolean value(    Library library){
      if (result.contains(library))       return false;
      if (library instanceof LibraryImpl) {
        final Library source=((LibraryImpl)library).getSource();
        if (source != null && result.contains(source))         return false;
      }
      return true;
    }
  }
;
}
