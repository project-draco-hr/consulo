{
  String value=myDescriptorTag.getAttributeValue("name");
  if (context instanceof XmlElement) {
    final String namespace=getNamespaceByContext(context);
    final XmlTag tag=PsiTreeUtil.getParentOfType(context,XmlTag.class,false);
    if (tag != null) {
      final String namespacePrefix=tag.getPrefixByNamespace(namespace);
      if (namespacePrefix != null && namespacePrefix.length() > 0) {
        final XmlTag rootTag=((XmlFile)myDescriptorTag.getContainingFile()).getRootTag();
        String elementFormDefault;
        if (rootTag != null && (NONQUALIFIED_ATTR_VALUE.equals(elementFormDefault=rootTag.getAttributeValue(ELEMENT_FORM_DEFAULT)) || elementFormDefault == null) && tag.getNamespaceByPrefix("").isEmpty() && myDescriptorTag.getParentTag() != rootTag) {
          value=XmlUtil.findLocalNameByQualifiedName(value);
        }
 else {
          value=namespacePrefix + ":" + XmlUtil.findLocalNameByQualifiedName(value);
        }
      }
    }
  }
  return value;
}
