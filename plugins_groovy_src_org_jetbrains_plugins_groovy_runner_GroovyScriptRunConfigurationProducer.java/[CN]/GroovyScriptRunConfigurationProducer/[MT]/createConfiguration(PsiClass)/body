{
  final Project project=aClass.getProject();
  RunnerAndConfigurationSettings settings=RunManagerEx.getInstanceEx(project).createConfiguration("",getConfigurationFactory());
  final GroovyScriptRunConfiguration configuration=(GroovyScriptRunConfiguration)settings.getConfiguration();
  final PsiFile file=aClass.getContainingFile().getOriginalFile();
  final PsiDirectory dir=file.getContainingDirectory();
  if (dir == null)   return null;
  configuration.setWorkDir(dir.getVirtualFile().getPath());
  final VirtualFile vFile=file.getVirtualFile();
  if (vFile == null)   return null;
  configuration.setScriptPath(vFile.getPath());
  RunConfigurationModule module=configuration.getConfigurationModule();
  String name=GroovyRunnerUtil.getConfigurationName(aClass,module);
  configuration.setName(name);
  configuration.setModule(JavaExecutionUtil.findModule(aClass));
  return settings;
}
