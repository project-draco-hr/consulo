{
  final PsiElement element=location.getPsiElement();
  final PsiFile file=element.getContainingFile();
  if (!(file instanceof GroovyFile)) {
    return null;
  }
  GroovyFile groovyFile=(GroovyFile)file;
  if (groovyFile.isScript()) {
    mySourceElement=element;
    final RunnerAndConfigurationSettings settings=GroovyScriptRunConfigurationType.getInstance().createConfigurationByLocation(location);
    if (settings != null) {
      final AbstractGroovyScriptRunConfiguration configuration=(AbstractGroovyScriptRunConfiguration)settings.getConfiguration();
      GroovyScriptType.getScriptType(groovyFile).tuneConfiguration(groovyFile,configuration,location);
      return (RunnerAndConfigurationSettingsImpl)settings;
    }
  }
  return null;
}
