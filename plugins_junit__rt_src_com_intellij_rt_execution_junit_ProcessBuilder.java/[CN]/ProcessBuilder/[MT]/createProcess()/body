{
  if (myParameters.size() < 1) {
    throw new IllegalArgumentException("Executable name not specified");
  }
  String command=myParameters.get(0).toString();
  boolean winShell=isWindows && ("cmd".equalsIgnoreCase(command) || "cmd.exe".equalsIgnoreCase(command)) && myParameters.size() > 1 && "/c".equalsIgnoreCase(myParameters.get(0).toString());
  String[] commandLine=new String[myParameters.size()];
  commandLine[0]=command;
  for (int i=1; i < myParameters.size(); i++) {
    String parameter=myParameters.get(i).toString();
    if (isWindows) {
      int pos=parameter.indexOf('\"');
      if (pos >= 0) {
        StringBuffer buffer=new StringBuffer(parameter);
        do {
          buffer.insert(pos,'\\');
          pos+=2;
        }
 while ((pos=parameter.indexOf('\"',pos)) >= 0);
        parameter=buffer.toString();
      }
 else       if (parameter.length() == 0) {
        parameter="\"\"";
      }
      if (winShell && containsAnyChar(parameter,WIN_SHELL_SPECIALS)) {
        parameter='"' + parameter + '"';
      }
    }
    commandLine[i]=parameter;
  }
  return Runtime.getRuntime().exec(commandLine);
}
