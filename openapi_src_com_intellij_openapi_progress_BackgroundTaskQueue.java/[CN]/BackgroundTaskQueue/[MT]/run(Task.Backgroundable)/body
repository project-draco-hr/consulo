{
  if (task.isConditionalModal() && !task.shouldStartInBackground()) {
    ProgressManager.getInstance().run(task);
  }
 else {
    boolean hadActiveTask;
synchronized (myQueue) {
      hadActiveTask=myHasActiveTask;
      myQueue.offer(task);
      myHasActiveTask=true;
    }
    if (!hadActiveTask) {
      if (ApplicationManager.getApplication().isDispatchThread()) {
        ProgressManager.getInstance().run(myRunnerTask);
      }
 else {
        ApplicationManager.getApplication().invokeLater(new Runnable(){
          public void run(){
            ProgressManager.getInstance().run(myRunnerTask);
          }
        }
);
      }
    }
  }
}
