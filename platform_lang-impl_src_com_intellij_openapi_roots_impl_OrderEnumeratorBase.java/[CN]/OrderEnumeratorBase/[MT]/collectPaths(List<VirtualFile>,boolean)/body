{
  forEach(new Processor<OrderEntry>(){
    @Override public boolean process(    OrderEntry orderEntry){
      final Module ownerModule=orderEntry.getOwnerModule();
      if (orderEntry instanceof ModuleSourceOrderEntry) {
        collectModulePaths(((ModuleSourceOrderEntry)orderEntry).getRootModel(),list,collectSources);
      }
 else       if (orderEntry instanceof ModuleOrderEntry) {
        ModuleOrderEntry moduleOrderEntry=(ModuleOrderEntry)orderEntry;
        final Module module=moduleOrderEntry.getModule();
        if (module != null) {
          if (myCustomHandlers != null) {
            for (            OrderEnumerationHandler handler : myCustomHandlers) {
              if (handler.addCustomOutput(moduleOrderEntry,myProductionOnly,list)) {
                return true;
              }
            }
          }
          collectModulePaths(ModuleRootManager.getInstance(module),list,collectSources);
        }
      }
 else {
        Collections.addAll(list,orderEntry.getFiles(collectSources ? OrderRootType.SOURCES : OrderRootType.CLASSES));
      }
      return true;
    }
  }
);
}
