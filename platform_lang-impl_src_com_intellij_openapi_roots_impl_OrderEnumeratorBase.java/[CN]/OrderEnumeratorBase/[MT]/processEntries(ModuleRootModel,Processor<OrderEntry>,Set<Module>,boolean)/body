{
  if (processed != null && !processed.add(rootModel.getModule()))   return;
  for (  OrderEntry entry : rootModel.getOrderEntries()) {
    if (myWithoutJdk && entry instanceof JdkOrderEntry)     continue;
    if (myWithoutLibraries && entry instanceof LibraryOrderEntry)     continue;
    if (myWithoutDepModules) {
      if (!myRecursively && entry instanceof ModuleOrderEntry)       continue;
      if (entry instanceof ModuleSourceOrderEntry && !isMainModuleModel(((ModuleSourceOrderEntry)entry).getRootModel()))       continue;
    }
    if (myWithoutThisModuleContent && entry instanceof ModuleSourceOrderEntry)     continue;
    OrderEnumerationHandler.AddDependencyType shouldAdd=OrderEnumerationHandler.AddDependencyType.DEFAULT;
    for (    OrderEnumerationHandler handler : myCustomHandlers) {
      shouldAdd=handler.shouldAddDependency(entry,myProductionOnly,myRuntimeOnly,myCompileOnly);
      if (shouldAdd != OrderEnumerationHandler.AddDependencyType.DEFAULT)       break;
    }
    if (shouldAdd == OrderEnumerationHandler.AddDependencyType.DO_NOT_ADD)     continue;
    boolean exported=!(entry instanceof JdkOrderEntry);
    if (entry instanceof ExportableOrderEntry) {
      ExportableOrderEntry exportableEntry=(ExportableOrderEntry)entry;
      if (shouldAdd == OrderEnumerationHandler.AddDependencyType.DEFAULT) {
        final DependencyScope scope=exportableEntry.getScope();
        if (myCompileOnly && !scope.isForProductionCompile() && !scope.isForTestCompile())         continue;
        if (myRuntimeOnly && !scope.isForProductionRuntime() && !scope.isForTestRuntime())         continue;
        if (myProductionOnly) {
          if (!scope.isForProductionCompile() && !scope.isForProductionRuntime() || myCompileOnly && !scope.isForProductionCompile() || myRuntimeOnly && !scope.isForProductionRuntime()) {
            continue;
          }
        }
      }
      exported=exportableEntry.isExported();
    }
    if (!exported) {
      if (myExportedOnly)       continue;
      if (myRecursivelyExportedOnly && !firstLevel)       continue;
    }
    if (myCondition != null && !myCondition.value(entry))     continue;
    if (myRecursively && entry instanceof ModuleOrderEntry) {
      ModuleOrderEntry moduleOrderEntry=(ModuleOrderEntry)entry;
      final Module module=moduleOrderEntry.getModule();
      if (module != null) {
        boolean processRecursively=true;
        for (        OrderEnumerationHandler handler : myCustomHandlers) {
          if (!handler.shouldProcessRecursively(moduleOrderEntry)) {
            processRecursively=false;
            break;
          }
        }
        if (processRecursively) {
          processEntries(getRootModel(module),processor,processed,false);
          continue;
        }
      }
    }
    if (!processor.process(entry)) {
      return;
    }
  }
}
