{
  final GitRepositoryLocation l=(GitRepositoryLocation)getLocationFor(new FilePathImpl(file));
  VirtualFile root=LocalFileSystem.getInstance().findFileByIoFile(l.getRoot());
  if (root == null) {
    throw new VcsException("The repository does not exists anymore: " + l.getRoot());
  }
  final CommittedChangeList[] result=new CommittedChangeList[1];
  GitUtil.getLocalCommittedChanges(myProject,root,new Consumer<GitSimpleHandler>(){
    public void consume(    GitSimpleHandler h){
      h.addParameters("-n1");
      h.addParameters(number.asString());
    }
  }
,new Consumer<CommittedChangeList>(){
    @Override public void consume(    CommittedChangeList committedChangeList){
      result[0]=committedChangeList;
    }
  }
,false);
  return result[0];
}
