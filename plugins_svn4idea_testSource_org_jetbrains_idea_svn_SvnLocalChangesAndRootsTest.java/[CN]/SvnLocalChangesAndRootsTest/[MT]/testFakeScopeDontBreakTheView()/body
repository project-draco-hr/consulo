{
  enableSilentOperation(VcsConfiguration.StandardConfirmation.ADD);
  enableSilentOperation(VcsConfiguration.StandardConfirmation.REMOVE);
  final SubTree subTree=new SubTree(myWorkingCopyDir);
  checkin();
  editFileInCommand(myProject,subTree.myOuterFile,"***");
  editFileInCommand(myProject,subTree.myInnerFile,"*&*");
  VcsDirtyScopeManager.getInstance(myProject).markEverythingDirty();
  myClManager.ensureUpToDate(false);
  DuringChangeListManagerUpdateTestScheme.checkFilesAreInList(new VirtualFile[]{subTree.myOuterFile,subTree.myInnerFile},myClManager.getDefaultListName(),myClManager);
  VcsDirtyScopeManagerImpl.getInstance(myProject).fileDirty(subTree.myNonVersionedUpper);
  myClManager.ensureUpToDate(false);
  DuringChangeListManagerUpdateTestScheme.checkFilesAreInList(new VirtualFile[]{subTree.myOuterFile,subTree.myInnerFile},myClManager.getDefaultListName(),myClManager);
}
