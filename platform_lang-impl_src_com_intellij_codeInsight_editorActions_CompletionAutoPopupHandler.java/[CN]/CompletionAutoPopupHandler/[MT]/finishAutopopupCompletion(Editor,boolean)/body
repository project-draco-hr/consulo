{
  final AutoPopupState state=getAutoPopupState(editor);
  if (state == null || state.changeGuard) {
    return;
  }
  if (!neglectLookup && LookupManager.getActiveLookup(editor) != null) {
    return;
  }
  final CompletionProgressIndicator currentCompletion=CompletionServiceImpl.getCompletionService().getCurrentCompletion();
  if (currentCompletion != null) {
    currentCompletion.closeAndFinish(true);
  }
  state.stopAutoPopup();
}
