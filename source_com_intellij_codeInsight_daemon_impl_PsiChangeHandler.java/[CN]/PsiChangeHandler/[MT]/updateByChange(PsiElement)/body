{
  Editor editor=FileEditorManager.getInstance(myProject).getSelectedTextEditor();
  if (editor != null) {
    EditorMarkupModel markupModel=(EditorMarkupModel)editor.getMarkupModel();
    markupModel.setErrorStripeRenderer(markupModel.getErrorStripeRenderer());
  }
  PsiFile file=child.getContainingFile();
  if (file == null) {
    myDaemonCodeAnalyzer.getFileStatusMap().markAllFilesDirty();
    return;
  }
  Document document=PsiDocumentManager.getInstance(myProject).getCachedDocument(file);
  if (document == null)   return;
  PsiElement parent=child;
  while (true) {
    if (parent instanceof PsiFile || parent instanceof PsiDirectory) {
      myDaemonCodeAnalyzer.getFileStatusMap().markAllFilesDirty();
      return;
    }
    PsiElement pparent=parent.getParent();
    if (parent instanceof XmlTag) {
      myDaemonCodeAnalyzer.getFileStatusMap().markFileScopeDirty(document,pparent);
      return;
    }
    if (parent instanceof PsiCodeBlock && pparent instanceof PsiMethod && !((PsiMethod)pparent).isConstructor()&& pparent.getParent() instanceof PsiClass&& !(pparent.getParent() instanceof PsiAnonymousClass)) {
      myDaemonCodeAnalyzer.getFileStatusMap().markFileScopeDirty(document,pparent);
      return;
    }
    parent=pparent;
  }
}
