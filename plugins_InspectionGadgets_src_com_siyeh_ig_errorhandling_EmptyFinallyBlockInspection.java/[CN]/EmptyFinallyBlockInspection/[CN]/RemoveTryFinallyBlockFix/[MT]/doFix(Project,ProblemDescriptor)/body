{
  final PsiElement element=descriptor.getPsiElement();
  final PsiTryStatement tryStatement=PsiTreeUtil.getParentOfType(element,PsiTryStatement.class);
  if (tryStatement == null) {
    return;
  }
  final PsiCodeBlock tryBlock=tryStatement.getTryBlock();
  if (tryBlock == null) {
    return;
  }
  final PsiElement parent=tryStatement.getParent();
  if (parent == null) {
    return;
  }
  final PsiResourceList resources=tryStatement.getResourceList();
  if (resources != null) {
    final PsiElementFactory factory=JavaPsiFacade.getElementFactory(project);
    for (    PsiResourceVariable resource : resources.getResourceVariables()) {
      final PsiStatement statement=factory.createStatementFromText(resource.getText() + ";",parent);
      parent.addBefore(statement,tryStatement);
    }
  }
  final PsiElement first=tryBlock.getFirstBodyElement();
  final PsiElement last=tryBlock.getLastBodyElement();
  if (first != null && last != null) {
    parent.addRangeAfter(first,last,tryStatement);
  }
  tryStatement.delete();
}
