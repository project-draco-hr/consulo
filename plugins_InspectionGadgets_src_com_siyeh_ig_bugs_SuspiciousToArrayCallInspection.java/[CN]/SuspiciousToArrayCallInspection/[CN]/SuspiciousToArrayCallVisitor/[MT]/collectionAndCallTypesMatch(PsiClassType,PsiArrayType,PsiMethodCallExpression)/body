{
  if (collectionType.hasParameters()) {
    final PsiType[] parameters=collectionType.getParameters();
    if (parameters.length != 1) {
      return true;
    }
    final PsiType parameter=parameters[0];
    final PsiType componentType=callType.getComponentType();
    if (!parameter.equals(componentType)) {
      errorString=InspectionGadgetsBundle.message("suspicious.to.array.call.problem.descriptor1",parameter.getPresentableText());
      return false;
    }
  }
 else {
    final PsiElement parent=expression.getParent();
    if (!(parent instanceof PsiTypeCastExpression)) {
      return true;
    }
    final PsiTypeCastExpression castExpression=(PsiTypeCastExpression)parent;
    final PsiTypeElement castTypeElement=castExpression.getCastType();
    if (castTypeElement == null) {
      return true;
    }
    final PsiType castType=castTypeElement.getType();
    if (!castType.equals(callType)) {
      errorString=InspectionGadgetsBundle.message("suspicious.to.array.call.problem.descriptor2",castType.getPresentableText());
      return false;
    }
  }
  return true;
}
