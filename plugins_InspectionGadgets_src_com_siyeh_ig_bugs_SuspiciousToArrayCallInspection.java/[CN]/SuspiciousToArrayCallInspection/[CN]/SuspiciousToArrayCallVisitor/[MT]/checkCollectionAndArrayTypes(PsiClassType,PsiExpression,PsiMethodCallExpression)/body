{
  final PsiType argumentType=argument.getType();
  if (!(argumentType instanceof PsiArrayType)) {
    return;
  }
  final PsiArrayType arrayType=(PsiArrayType)argumentType;
  final PsiType componentType=arrayType.getComponentType();
  final PsiElement parent=expression.getParent();
  if (parent instanceof PsiTypeCastExpression) {
    final PsiTypeCastExpression castExpression=(PsiTypeCastExpression)parent;
    final PsiTypeElement castTypeElement=castExpression.getCastType();
    if (castTypeElement == null) {
      return;
    }
    final PsiType castType=castTypeElement.getType();
    if (!castType.equals(arrayType)) {
      registerError(argument,arrayType.getComponentType());
    }
  }
 else {
    if (!collectionType.hasParameters()) {
      return;
    }
    final PsiType[] parameters=collectionType.getParameters();
    if (parameters.length != 1) {
      return;
    }
    final PsiType parameter=parameters[0];
    if (!componentType.isAssignableFrom(parameter)) {
      registerError(argument,parameter);
    }
  }
}
