{
  String programFiles=System.getenv("ProgramFiles");
  if (programFiles != null) {
    File jetbrainsHome=new File(programFiles,"JetBrains");
    if (jetbrainsHome.isDirectory()) {
      final File[] files=jetbrainsHome.listFiles();
      String latestVersion=null;
      File latestFile=null;
      for (      File file : files) {
        if (file.isDirectory() && file.getName().startsWith(productName)) {
          String versionName=file.getName().substring(productName.length()).trim();
          if (versionName.indexOf('.') > 0) {
            if (latestVersion == null || StringUtil.compareVersionNumbers(latestVersion,versionName) > 0) {
              latestVersion=versionName;
              latestFile=file;
            }
          }
        }
      }
      if (latestFile != null) {
        return latestFile.getAbsolutePath();
      }
    }
  }
  return null;
}
