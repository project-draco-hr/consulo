{
  String programFiles=System.getenv("ProgramFiles");
  if (programFiles != null) {
    File jetbrainsHome=new File(programFiles,"JetBrains");
    File[] files=jetbrainsHome.isDirectory() ? jetbrainsHome.listFiles() : null;
    if (files != null) {
      String latestVersion=null;
      File latestFile=null;
      for (      File file : files) {
        if (file.isDirectory() && file.getName().startsWith(productName)) {
          String versionName=file.getName().substring(productName.length()).trim();
          if (latestVersion == null || StringUtil.compareVersionNumbers(latestVersion,versionName) > 0) {
            latestVersion=versionName;
            latestFile=file;
          }
        }
      }
      if (latestFile != null) {
        return latestFile.getAbsolutePath();
      }
    }
  }
  return null;
}
