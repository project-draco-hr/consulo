{
  final Project project=e.getData(PlatformDataKeys.PROJECT);
  final VcsKey vcsKey=e.getData(VcsDataKeys.VCS);
  if (project == null || vcsKey == null) {
    e.getPresentation().setEnabled(false);
    return;
  }
  final VirtualFile revisionVirtualFile=e.getData(VcsDataKeys.VCS_VIRTUAL_FILE);
  boolean enabled=(e.getData(VcsDataKeys.VCS_FILE_REVISION) != null) && (revisionVirtualFile != null);
  enabled=enabled && (isInLocalFSHack(revisionVirtualFile) || canPresentNonLocal(project,vcsKey,revisionVirtualFile));
  e.getPresentation().setEnabled(enabled);
}
