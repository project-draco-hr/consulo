{
  final InjectedLanguageManager injectedManager=InjectedLanguageManager.getInstance(element.getProject());
  if (element instanceof PomTargetPsiElement) {
    final PomTarget target=((PomTargetPsiElement)element).getTarget();
    if (target instanceof PsiDeclaredTarget) {
      final PsiDeclaredTarget declaredTarget=(PsiDeclaredTarget)target;
      final TextRange range=declaredTarget.getNameIdentifierRange();
      if (range != null) {
        if (range.getStartOffset() < 0 || range.getLength() <= 0) {
          return null;
        }
        final PsiElement navElement=declaredTarget.getNavigationElement();
        if (PsiUtilBase.isUnderPsiRoot(file,navElement)) {
          return injectedManager.injectedToHost(navElement,range.shiftRight(navElement.getTextRange().getStartOffset()));
        }
      }
    }
  }
  if (!PsiUtilBase.isUnderPsiRoot(file,element)) {
    return null;
  }
  PsiElement identifier=getNameIdentifier(element);
  if (identifier != null && PsiUtilBase.isUnderPsiRoot(file,identifier)) {
    return injectedManager.injectedToHost(identifier,identifier.getTextRange());
  }
  return null;
}
