{
  final Project project=e.getData(PlatformDataKeys.PROJECT);
  if (project == null)   return;
  if (ChangeListManager.getInstance(project).isFreezedWithNotification("Can not apply patch now"))   return;
  if (e.getPlace().equals(ActionPlaces.PROJECT_VIEW_POPUP)) {
    VirtualFile vFile=e.getData(PlatformDataKeys.VIRTUAL_FILE);
    if (vFile != null && vFile.getFileType() == StdFileTypes.PATCH) {
      showApplyPatch(project,vFile);
      return;
    }
  }
  showApplyPatch(project,null);
}
