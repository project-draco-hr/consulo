{
  final JTree tree=getCurrentTree();
  if (tree == null) {
    return new MethodHierarchyNodeDescriptor[0];
  }
  final TreePath[] paths=tree.getSelectionPaths();
  if (paths == null) {
    return new MethodHierarchyNodeDescriptor[0];
  }
  final ArrayList<MethodHierarchyNodeDescriptor> list=new ArrayList<MethodHierarchyNodeDescriptor>(paths.length);
  for (int i=0; i < paths.length; i++) {
    final TreePath path=paths[i];
    final Object lastPathComponent=path.getLastPathComponent();
    if (lastPathComponent instanceof DefaultMutableTreeNode) {
      final DefaultMutableTreeNode node=(DefaultMutableTreeNode)lastPathComponent;
      final Object userObject=node.getUserObject();
      if (userObject instanceof MethodHierarchyNodeDescriptor) {
        list.add((MethodHierarchyNodeDescriptor)userObject);
      }
    }
  }
  return list.toArray(new MethodHierarchyNodeDescriptor[list.size()]);
}
