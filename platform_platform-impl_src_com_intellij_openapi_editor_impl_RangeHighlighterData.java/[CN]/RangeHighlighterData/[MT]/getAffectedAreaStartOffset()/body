{
  int startOffset=getRangeHighlighter().getStartOffset();
  if (getTargetArea() == HighlighterTargetArea.EXACT_RANGE)   return startOffset;
  Document document=myModel.getDocument();
  int textLength=document.getTextLength();
  if (startOffset >= textLength)   return textLength;
  return document.getLineStartOffset(document.getLineNumber(startOffset));
}
