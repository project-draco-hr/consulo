{
  int startOffset=getRangeHighlighter().getStartOffset();
  if (getTargetArea() == HighlighterTargetArea.EXACT_RANGE)   return startOffset;
  int textLength=myModel.getDocument().getTextLength();
  if (startOffset >= textLength)   return textLength;
  return myModel.getDocument().getLineStartOffset(myModel.getDocument().getLineNumber(startOffset));
}
