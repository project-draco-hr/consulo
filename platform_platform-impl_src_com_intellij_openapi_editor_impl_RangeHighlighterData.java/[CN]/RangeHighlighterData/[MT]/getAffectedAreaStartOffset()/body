{
  int startOffset=getRangeHighlighter().getStartOffset();
  if (getTargetArea() == HighlighterTargetArea.EXACT_RANGE)   return startOffset;
  if (startOffset == myModel.getDocument().getTextLength())   return startOffset;
  return myModel.getDocument().getLineStartOffset(myModel.getDocument().getLineNumber(startOffset));
}
