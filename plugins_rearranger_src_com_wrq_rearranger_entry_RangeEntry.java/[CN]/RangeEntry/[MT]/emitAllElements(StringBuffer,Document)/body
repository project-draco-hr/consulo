{
  if (alternateValue != null) {
    String result=alternateValue;
    if (separatorCommentPrecedes) {
      LOG.debug("emitAllElements: separator comment precedes " + name + "; original value="+ alternateValue.replaceAll("\n","#"));
      result=alternateValue.replaceFirst("\n[ \t\n]*\n","\n");
      LOG.debug("emitAllElements: resulting value=" + alternateValue.replaceAll("\n","#"));
    }
    sb.append(result);
  }
 else {
    PsiElement curr=start;
    while (curr != null && curr != end) {
      if (curr == end.getParent()) {
        curr=curr.getFirstChild();
      }
 else {
        emitElement(curr,sb,document);
        curr=curr.getNextSibling();
      }
    }
    if (curr == end) {
      emitElement(end,sb,document);
    }
  }
}
