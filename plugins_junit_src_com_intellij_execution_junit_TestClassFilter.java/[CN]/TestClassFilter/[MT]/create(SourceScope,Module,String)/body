{
  if (sourceScope == null)   throw new JUnitUtil.NoJUnitException();
  PsiClass testCase=module == null ? JUnitUtil.getTestCaseClass(sourceScope) : JUnitUtil.getTestCaseClass(module);
  final String[] patterns=pattern.split("\\|\\|");
  final List<Pattern> compilePatterns=new ArrayList<Pattern>();
  for (  String p : patterns) {
    final Pattern compilePattern=getCompilePattern(p);
    if (compilePattern != null) {
      compilePatterns.add(compilePattern);
    }
  }
  return new TestClassFilter(testCase,sourceScope.getGlobalSearchScope()){
    @Override public boolean isAccepted(    final PsiClass aClass){
      if (super.isAccepted(aClass)) {
        final String qualifiedName=ApplicationManager.getApplication().runReadAction(new Computable<String>(){
          @Override public String compute(){
            return aClass.getQualifiedName();
          }
        }
);
        for (        Pattern compilePattern : compilePatterns) {
          if (compilePattern.matcher(qualifiedName).matches()) {
            return true;
          }
        }
      }
      return false;
    }
  }
;
}
