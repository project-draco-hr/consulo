{
  final GitLineHandler rc=new GitLineHandler(project,vcsRoot,GitHandler.PUSH);
  rc.addParameters("-v","--all");
  rc.addLineListener(new GitLineHandlerAdapter(){
    @Override public void onLineAvailable(    final String line,    final Key outputType){
      if (outputType == ProcessOutputTypes.STDERR && line.startsWith(" ! [")) {
        rc.addError(new VcsException("Rejected push: " + line));
      }
    }
  }
);
  return rc;
}
