{
  GitBranch current=GitBranch.current(project,vcsRoot);
  if (current == null) {
    return null;
  }
  String remote=current.getTrackedRemoteName(project,vcsRoot);
  if (remote == null) {
    return null;
  }
  String tracked=current.getTrackedBranchName(project,vcsRoot);
  if (tracked == null) {
    return null;
  }
  final GitLineHandler rc=new GitLineHandler(project,vcsRoot,GitHandler.PUSH);
  rc.addParameters("-v",remote,current.getFullName() + ":" + tracked);
  rc.addLineListener(new GitLineHandlerAdapter(){
    @Override public void onLineAvailable(    final String line,    final Key outputType){
      if (outputType == ProcessOutputTypes.STDERR && line.startsWith(" ! [")) {
        rc.addError(new VcsException("Rejected push: " + line));
      }
    }
  }
);
  return rc;
}
