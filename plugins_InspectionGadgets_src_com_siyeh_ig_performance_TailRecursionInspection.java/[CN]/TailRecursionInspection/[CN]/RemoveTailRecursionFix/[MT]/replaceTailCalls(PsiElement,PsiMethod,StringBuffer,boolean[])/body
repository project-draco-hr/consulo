{
  final String text=element.getText();
  if (isTailCallReturn(element,method)) {
    final PsiReturnStatement returnStatement=(PsiReturnStatement)element;
    final PsiMethodCallExpression call=(PsiMethodCallExpression)returnStatement.getReturnValue();
    final PsiExpressionList argumentList=call.getArgumentList();
    final PsiExpression[] args=argumentList.getExpressions();
    final PsiParameterList parameterList=method.getParameterList();
    final PsiParameter[] parameters=parameterList.getParameters();
    final boolean isInBlock=returnStatement.getParent() instanceof PsiCodeBlock;
    if (!isInBlock) {
      out.append('{');
    }
    for (int i=0; i < parameters.length; i++) {
      final PsiParameter parameter=parameters[i];
      final PsiExpression arg=args[i];
      final String parameterName=parameter.getName();
      final String argText=arg.getText();
      out.append(parameterName + " = " + argText+ ';');
    }
    if (ControlFlowUtils.blockCompletesWithStatement(method.getBody(),returnStatement)) {
    }
 else     if (ControlFlowUtils.isInLoop(element)) {
      final String methodName=method.getName();
      containedTailCallInLoop[0]=true;
      out.append("continue " + methodName + ';');
    }
 else {
      out.append("continue;");
    }
    if (!isInBlock) {
      out.append('}');
    }
  }
 else {
    final PsiElement[] children=element.getChildren();
    if (children.length == 0) {
      out.append(text);
    }
 else {
      for (int i=0; i < children.length; i++) {
        final PsiElement child=children[i];
        replaceTailCalls(child,method,out,containedTailCallInLoop);
      }
    }
  }
}
