{
  final DataContext dataContext=event.getDataContext();
  final Project project=PlatformDataKeys.PROJECT.getData(dataContext);
  if (project != null) {
    final VirtualFile[] virtualFiles=PlatformDataKeys.VIRTUAL_FILE_ARRAY.getData(dataContext);
    if (virtualFiles != null) {
      final ProjectFileIndex fileIndex=ProjectRootManager.getInstance(project).getFileIndex();
      for (      VirtualFile virtualFile : virtualFiles) {
        fileIndex.iterateContentUnderDirectory(virtualFile,new ContentIterator(){
          @Override public boolean processFile(          VirtualFile fileOrDir){
            if (!fileOrDir.isDirectory()) {
              changeLineSeparators(project,fileOrDir);
            }
            return true;
          }
        }
);
      }
    }
  }
}
