{
  PsiElement element=origElement;
  if (element instanceof PsiExpression) {
    element=PsiUtil.deparenthesizeExpression((PsiExpression)element);
  }
  PsiElementFactory factory=origElement.getManager().getElementFactory();
  PsiTypeCastExpression typeCast=(PsiTypeCastExpression)factory.createExpressionFromText("(Type)value",null);
  typeCast=(PsiTypeCastExpression)CodeStyleManager.getInstance(project).reformat(typeCast);
  typeCast.getCastType().replace(factory.createTypeElement(type));
  typeCast.getOperand().replace(element);
  return typeCast;
}
