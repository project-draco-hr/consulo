{
  for (  final String branchName : taskInfo.branches.keySet()) {
    List<R> repositories=getRepositories(taskInfo.branches.get(branchName));
    List<R> notFound=ContainerUtil.filter(repositories,new Condition<R>(){
      @Override public boolean value(      R repository){
        return !hasBranch(repository,branchName);
      }
    }
);
    if (!notFound.isEmpty()) {
      checkoutAsNewBranch(branchName,notFound);
    }
    repositories.removeAll(notFound);
    if (!repositories.isEmpty()) {
      checkout(branchName,repositories,invokeAfter);
    }
  }
}
