def share(ui, source, dest=None, noupdate=False):
    'create a new shared repository\n\n    Initialize a new repository and working directory that shares its\n    history with another repository.\n\n    NOTE: using rollback or extensions that destroy/modify history\n    (mq, rebase, etc.) can cause considerable confusion with shared\n    clones. In particular, if two shared clones are both updated to\n    the same changeset, and one of them destroys that changeset with\n    rollback, the other clone will suddenly stop working: all\n    operations will fail with "abort: working directory has unknown\n    parent". The only known workaround is to use debugsetparents on\n    the broken clone to reset it to a changeset that still exists\n    (e.g. tip).\n    '
    return hg.share(ui, source, dest, (not noupdate))
