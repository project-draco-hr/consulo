{
  String compileInBackgroundValue=null;
  Element component=Util.findComponent(root,COMPILER_CONFIGURATION_CLASS);
  if (component != null) {
    component.setAttribute(ATTR_NAME,COMPILER_CONFIGURATION_COMPONENT);
    component.removeAttribute(ATTR_CLASS);
    for (Iterator children=component.getChildren().iterator(); children.hasNext(); ) {
      Element element=(Element)children.next();
      String elementName=element.getName();
      if (ATTR_OPTION.equals(elementName)) {
        String name=element.getAttributeValue(ATTR_NAME);
        if (name != null) {
          if (name.equals("COMPILE_IN_BACKGROUND")) {
            compileInBackgroundValue=element.getAttributeValue(ATTR_VALUE);
          }
        }
      }
 else       if (ATTR_EXCLUDE_FROM_COMPILE.equals(elementName)) {
        for (Iterator excludeIterator=element.getChildren().iterator(); excludeIterator.hasNext(); ) {
          Element excludeElement=(Element)excludeIterator.next();
          String path=excludeElement.getAttributeValue(ATTR_PATH);
          if (path != null) {
            String url=VirtualFileManager.constructUrl(LocalFileSystem.PROTOCOL,path);
            excludeElement.removeAttribute(ATTR_PATH);
            excludeElement.setAttribute(ATTR_URL,url);
          }
        }
      }
    }
  }
  if (compileInBackgroundValue != null) {
    component=Util.findComponent(root,COMPILER_WORKSPACE_CONFIGURATION_COMPONENT);
    if (component == null) {
      component=new Element("component");
      component.setAttribute(ATTR_NAME,COMPILER_WORKSPACE_CONFIGURATION_COMPONENT);
      root.addContent(component);
    }
    boolean added=false;
    for (Iterator children=component.getChildren().iterator(); children.hasNext(); ) {
      Element element=(Element)children.next();
      String elementName=element.getName();
      if (ATTR_OPTION.equals(elementName)) {
        String name=element.getAttributeValue(ATTR_NAME);
        if (name != null) {
          if (name.equals("COMPILE_IN_BACKGROUND")) {
            element.setAttribute(ATTR_VALUE,compileInBackgroundValue);
            added=true;
          }
        }
      }
    }
    if (!added) {
      Element compileInBackgroundElement=new Element(ATTR_OPTION);
      compileInBackgroundElement.setAttribute(ATTR_NAME,"COMPILE_IN_BACKGROUND");
      compileInBackgroundElement.setAttribute(ATTR_VALUE,compileInBackgroundValue);
      component.addContent(compileInBackgroundElement);
    }
  }
}
