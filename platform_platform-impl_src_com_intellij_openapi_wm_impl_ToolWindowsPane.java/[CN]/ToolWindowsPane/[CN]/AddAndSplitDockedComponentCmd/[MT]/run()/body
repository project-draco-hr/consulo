{
  try {
    float newWeight;
    final ToolWindowAnchor anchor=myInfo.getAnchor();
    Splitter splitter=new Splitter(!myInfo.getAnchor().isHorizontal());
    InternalDecorator oldComponent=(InternalDecorator)getComponentAt(myInfo.getAnchor());
    if (myInfo.isSplit()) {
      splitter.setFirstComponent(oldComponent);
      splitter.setSecondComponent(myNewComponent);
      float proportion=getPreferredSplitProportion(oldComponent.getWindowInfo().getId(),normalizeWeigh(oldComponent.getWindowInfo().getSideWeight() / (oldComponent.getWindowInfo().getSideWeight() + myInfo.getSideWeight())));
      splitter.setProportion(proportion);
      newWeight=normalizeWeigh(oldComponent.getWindowInfo().getWeight());
    }
 else {
      splitter.setFirstComponent(myNewComponent);
      splitter.setSecondComponent(oldComponent);
      splitter.setProportion(normalizeWeigh(myInfo.getSideWeight()));
      newWeight=normalizeWeigh(myInfo.getWeight());
    }
    setComponent(splitter,anchor,newWeight);
    if (!myDirtyMode) {
      myLayeredPane.validate();
      myLayeredPane.repaint();
    }
  }
  finally {
    finish();
  }
}
