{
  if (canCreateModule()) {
    if (myName == null) {
      myName=project.getName();
    }
    if (myModuleFilePath == null) {
      myModuleFilePath=project.getBaseDir().getPath() + File.separator + myName+ ".iml";
    }
    Exception ex=ApplicationManager.getApplication().runWriteAction(new Computable<Exception>(){
      public Exception compute(){
        try {
          final ModifiableModuleModel moduleModel=ModuleManager.getInstance(project).getModifiableModel();
          createAndCommit(moduleModel,true);
          return null;
        }
 catch (        Exception e) {
          return e;
        }
      }
    }
);
    if (ex != null) {
      Messages.showErrorDialog(IdeBundle.message("error.adding.module.to.project",ex.getMessage()),IdeBundle.message("title.add.module"));
    }
  }
}
