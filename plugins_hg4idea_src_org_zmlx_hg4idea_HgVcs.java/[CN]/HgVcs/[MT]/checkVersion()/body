{
  final String executable=getGlobalSettings().getHgExecutable();
  HgCommandResultNotifier errorNotification=new HgCommandResultNotifier(myProject);
  String message;
  final String SETTINGS_LINK="settings";
  final String UPDATE_LINK="update";
  NotificationListener linkAdapter=new NotificationListener.Adapter(){
    @Override protected void hyperlinkActivated(    @NotNull Notification notification,    @NotNull HyperlinkEvent e){
      if (SETTINGS_LINK.equals(e.getDescription())) {
        ShowSettingsUtil.getInstance().showSettingsDialog(myProject,getConfigurable().getDisplayName());
      }
 else       if (UPDATE_LINK.equals(e.getDescription())) {
        BrowserUtil.browse("http://mercurial.selenic.com");
      }
    }
  }
;
  try {
    myVersion=HgVersion.identifyVersion(executable);
    if (!myVersion.isSupported()) {
      LOG.info("Unsupported Hg version: " + myVersion);
      message=String.format("The <a href='" + SETTINGS_LINK + "'>configured</a> version of Hg is not supported: %s.<br/> "+ "The minimal supported version is %s. Please <a href='"+ UPDATE_LINK+ "'>update</a>.",myVersion,HgVersion.MIN);
      errorNotification.notifyError(null,"Unsupported Hg version",message,linkAdapter);
    }
  }
 catch (  Exception e) {
    if (getExecutableValidator().checkExecutableAndNotifyIfNeeded()) {
      final String reason=(e.getCause() != null ? e.getCause() : e).getMessage();
      message=HgVcsMessages.message("hg4idea.unable.to.run.hg",executable);
      errorNotification.notifyError(null,message,String.format(reason + "<br/> Please check your hg executable path in <a href='" + SETTINGS_LINK+ "'> settings </a>"),linkAdapter);
    }
  }
}
