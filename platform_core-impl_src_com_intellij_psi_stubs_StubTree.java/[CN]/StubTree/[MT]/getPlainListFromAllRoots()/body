{
  final PsiFileStub[] roots=getRoot().getStubRoots();
  if (roots.length == 1)   return super.getPlainListFromAllRoots();
  return ContainerUtil.concat(roots,new Function<PsiFileStub,Collection<? extends StubElement<?>>>(){
    @Override public Collection<? extends StubElement<?>> fun(    PsiFileStub stub){
      final ObjectStubTree existingTree=stub.getUserData(STUB_TO_TREE_REFERENCE);
      return existingTree != null ? existingTree.getPlainList() : new StubTree(stub,false).getPlainList();
    }
  }
);
}
