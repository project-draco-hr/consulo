{
  final RunConfigurationBase configuration=getRunConfiguration();
  if (configuration instanceof ModuleBasedConfiguration) {
    final Module module=((ModuleBasedConfiguration)configuration).getConfigurationModule().getModule();
    if (module != null) {
      return GlobalSearchScope.moduleRuntimeScope(module,isTrackTestFolders());
    }
  }
  return isTrackTestFolders() ? GlobalSearchScope.projectScope(project) : GlobalSearchScopesCore.projectProductionScope(project);
}
