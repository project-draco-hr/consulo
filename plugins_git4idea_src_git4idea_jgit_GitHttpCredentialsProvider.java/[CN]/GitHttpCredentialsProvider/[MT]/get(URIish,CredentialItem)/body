{
  CredentialItem.Username userNameItem=null;
  CredentialItem.Password passwordItem=null;
  for (  CredentialItem item : items) {
    if (item instanceof CredentialItem.Username) {
      userNameItem=(CredentialItem.Username)item;
    }
 else     if (item instanceof CredentialItem.Password) {
      passwordItem=(CredentialItem.Password)item;
    }
  }
  if (userNameItem != null || passwordItem != null) {
    String username=getUserNameFromUrl(myRemoteUrl);
    String password=null;
    if (username == null) {
      username=myUserName;
      password=myPassword;
    }
 else     if (username.equals(myUserName)) {
      password=myPassword;
    }
    final AuthDialog dialog=new AuthDialog(myProject,"Login required","Login to " + myRemoteUrl,username,password,false);
    boolean ok;
    if (username != null && password != null && !myShowDialog) {
      ok=true;
      myDialogShown=false;
    }
 else {
      UIUtil.invokeAndWaitIfNeeded(new Runnable(){
        @Override public void run(){
          dialog.show();
        }
      }
);
      ok=dialog.isOK();
      myDialogShown=true;
    }
    if (!ok) {
      myCancelled=true;
      myRememberPassword=false;
    }
 else {
      if (userNameItem != null) {
        userNameItem.setValue(dialog.getUsername());
      }
      if (passwordItem != null) {
        passwordItem.setValue(dialog.getPassword().toCharArray());
      }
      myRememberPassword=dialog.isRememberPassword();
      myPassword=dialog.getPassword();
      myUserName=dialog.getUsername();
    }
    return ok;
  }
  return true;
}
