{
  DebuggerTreeNodeImpl[] selectedNodes=getSelectedNodes(e.getDataContext());
  boolean visible=false;
  boolean enabled=false;
  String text=DebuggerBundle.message("action.resume.thread.text.resume");
  if (selectedNodes != null && selectedNodes.length > 0) {
    visible=true;
    enabled=true;
    for (    DebuggerTreeNodeImpl selectedNode : selectedNodes) {
      final NodeDescriptorImpl threadDescriptor=selectedNode.getDescriptor();
      if (!(threadDescriptor instanceof ThreadDescriptorImpl) || !((ThreadDescriptorImpl)threadDescriptor).isSuspended()) {
        visible=false;
        break;
      }
    }
    if (visible) {
      for (      DebuggerTreeNodeImpl selectedNode : selectedNodes) {
        final ThreadDescriptorImpl threadDescriptor=(ThreadDescriptorImpl)selectedNode.getDescriptor();
        if (threadDescriptor.getSuspendContext().getSuspendPolicy() == EventRequest.SUSPEND_ALL && !threadDescriptor.isFrozen()) {
          enabled=false;
          break;
        }
 else {
          if (threadDescriptor.isFrozen()) {
            text=DebuggerBundle.message("action.resume.thread.text.unfreeze");
          }
        }
      }
    }
  }
  final Presentation presentation=e.getPresentation();
  presentation.setText(text);
  presentation.setVisible(visible);
  presentation.setEnabled(enabled);
}
