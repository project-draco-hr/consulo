{
  return ApplicationManager.getApplication().runReadAction(new Computable<FileType>(){
    @Override public FileType compute(){
      VirtualFile tempFile=file;
      if ((file.getFileSystem() instanceof ArchiveFileSystem) && file.getParent() == null) {
        String path=file.getPath().substring(0,file.getPath().length() - ArchiveFileSystem.ARCHIVE_SEPARATOR.length());
        tempFile=LocalFileSystem.getInstance().findFileByPath(path);
      }
      if (tempFile != null && !tempFile.isDirectory()) {
        return tempFile.getFileType();
      }
      return null;
    }
  }
);
}
