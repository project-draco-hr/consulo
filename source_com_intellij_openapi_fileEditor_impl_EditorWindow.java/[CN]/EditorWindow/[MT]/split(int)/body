{
  checkConsistency();
  final FileEditorManagerImpl fileEditorManager=myOwner.getManager();
  if (splitAvailable()) {
    final JPanel panel=myPanel;
    final int tabCount=getTabCount();
    if (tabCount != 0) {
      final EditorWithProviderComposite firstEC=getEditorAt(0);
      myPanel=new JPanel(new BorderLayout());
      final Splitter splitter=new Splitter(orientation == JSplitPane.VERTICAL_SPLIT,0.5f,0.1f,0.9f);
      final EditorWindow res=new EditorWindow(myOwner);
      if (myTabbedPane != null) {
        final EditorWithProviderComposite selectedEditor=getSelectedEditor();
        panel.remove(myTabbedPane.getComponent());
        panel.add(splitter,BorderLayout.CENTER);
        splitter.setFirstComponent(myPanel);
        myPanel.add(myTabbedPane.getComponent(),BorderLayout.CENTER);
        splitter.setSecondComponent(res.myPanel);
        final VirtualFile file=selectedEditor.getFile();
        fileEditorManager.openFileImpl3(res,file,false,null);
        res.setFilePinned(file,isFilePinned(file));
        res.setSelectedEditor(selectedEditor,true);
        selectedEditor.getComponent().requestFocus();
        panel.revalidate();
      }
 else {
        panel.removeAll();
        panel.add(splitter,BorderLayout.CENTER);
        splitter.setFirstComponent(myPanel);
        splitter.setSecondComponent(res.myPanel);
        panel.revalidate();
        final VirtualFile file=firstEC.getFile();
        fileEditorManager.openFileImpl3(this,file,true,null);
        fileEditorManager.openFileImpl3(res,file,false,null);
      }
      return res;
    }
  }
  return this;
}
