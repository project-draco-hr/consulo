{
  if (editor != null) {
    if (myTabbedPane == null) {
      myPanel.removeAll();
      myPanel.add(new TComp(editor),BorderLayout.CENTER);
      myPanel.revalidate();
      return;
    }
    final int index=findEditorIndex(editor);
    try {
      ++myInsideTabChange;
      if (index != -1) {
        setSelectedEditor(editor);
      }
 else {
        final int indexToInsert=myTabbedPane.getSelectedIndex() + 1;
        final VirtualFile file=editor.getFile();
        myTabbedPane.insertTab(file.getPresentableName(),null,new TComp(editor),null,indexToInsert);
        trimToSize(UISettings.getInstance().EDITOR_TAB_LIMIT,file);
        setSelectedEditor(editor);
        myOwner.updateFileIcon(file,false);
        myOwner.updateFileColor(file);
      }
      myOwner.setCurrentWindow(this,false);
    }
  finally {
      --myInsideTabChange;
    }
  }
  myPanel.revalidate();
}
