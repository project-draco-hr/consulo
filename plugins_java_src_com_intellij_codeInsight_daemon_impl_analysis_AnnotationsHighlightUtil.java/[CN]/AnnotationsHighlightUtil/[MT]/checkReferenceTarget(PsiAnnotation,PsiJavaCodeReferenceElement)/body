{
  if (ref == null)   return null;
  PsiElement refTarget=ref.resolve();
  if (refTarget == null)   return null;
  String message=null;
  if (!(refTarget instanceof PsiClass)) {
    message=JavaErrorMessages.message("annotation.not.allowed.ref");
  }
 else {
    PsiElement parent=ref.getParent();
    if (parent instanceof PsiJavaCodeReferenceElement) {
      PsiElement qualified=((PsiJavaCodeReferenceElement)parent).resolve();
      if (qualified instanceof PsiMember && ((PsiMember)qualified).hasModifierProperty(PsiModifier.STATIC)) {
        message=JavaErrorMessages.message("annotation.not.allowed.static");
      }
    }
  }
  return message != null ? annotationError(annotation,message) : null;
}
