{
  ConcurrentMap<ProperTextRange,ManualRangeMarker> cache=markerCache;
  if (cache == null) {
    cache=ContainerUtil.newConcurrentMap();
    for (    SmartPsiElementPointerImpl pointer : getAlivePointers()) {
      SmartPointerElementInfo info=pointer == null ? null : pointer.getElementInfo();
      ManualRangeMarker marker=info instanceof SelfElementInfo ? ((SelfElementInfo)info).getRangeMarker() : null;
      ProperTextRange key=marker == null ? null : marker.getRange();
      if (key != null) {
        cache.putIfAbsent(key,marker);
      }
    }
    markerCache=cache;
  }
  return cache;
}
