{
  final PsiElementFactory elementFactory=JavaPsiFacade.getInstance(element.getProject()).getElementFactory();
  PsiType componentType=PsiUtil.extractIterableTypeParameter(parameters.getExpectedType(),true);
  if (componentType == null || !(itemType instanceof PsiArrayType) || !componentType.isAssignableFrom(((PsiArrayType)itemType).getComponentType())) {
    return;
  }
  final String qualifierText=getQualifierText(qualifier);
  final PsiExpression conversion=elementFactory.createExpressionFromText("java.util.Arrays.asList(" + qualifierText + prefix+ ")",element);
  final LookupItem item=LookupItemUtil.objectToLookupItem(conversion);
  @NonNls final String presentable="Arrays.asList(" + qualifierText + prefix+ ")";
  item.setLookupString(StringUtil.isEmpty(qualifierText) ? presentable : prefix);
  item.setPresentableText(presentable);
  item.addLookupStrings(prefix,presentable,"asList(" + prefix + ")");
  item.setIcon(Icons.METHOD_ICON);
  item.setInsertHandler(new SimpleInsertHandler<LookupElement>(){
    public int handleInsert(    final Editor editor,    int startOffset,    final LookupElement item,    final LookupElement[] allItems,    final TailType tailType,    final char completionChar) throws IncorrectOperationException {
      FeatureUsageTracker.getInstance().triggerFeatureUsed(JavaCompletionFeatures.SECOND_SMART_COMPLETION_ASLIST);
      final Document document=editor.getDocument();
      final int tailOffset=startOffset + item.getLookupString().length();
      RangeMarker tail=document.createRangeMarker(tailOffset,tailOffset);
      startOffset-=qualifierText.length();
      final Project project=element.getProject();
      final String callSpace=getSpace(CodeStyleSettingsManager.getSettings(project).SPACE_WITHIN_METHOD_CALL_PARENTHESES);
      @NonNls final String newText="java.util.Arrays.asList(" + callSpace + qualifierText+ prefix+ callSpace+ ")";
      document.replaceString(startOffset,tailOffset,newText);
      PsiDocumentManager.getInstance(project).commitDocument(document);
      final PsiFile file=PsiDocumentManager.getInstance(project).getPsiFile(document);
      try {
        JavaCodeStyleManager.getInstance(project).shortenClassReferences(file,startOffset,startOffset + CommonClassNames.JAVA_UTIL_ARRAYS.length());
      }
 catch (      IncorrectOperationException e) {
        LOG.error(e);
      }
      PostprocessReformattingAspect.getInstance(project).doPostponedFormatting();
      return tail.getEndOffset();
    }
  }
);
  result.addElement(item);
}
