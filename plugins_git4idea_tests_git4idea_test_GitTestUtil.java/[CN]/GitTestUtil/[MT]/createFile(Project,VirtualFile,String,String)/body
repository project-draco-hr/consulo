{
  final Ref<VirtualFile> result=new Ref<VirtualFile>();
  new WriteCommandAction.Simple(project){
    @Override protected void run() throws Throwable {
      try {
        VirtualFile file=parent.createChildData(this,name);
        if (content != null) {
          file.setBinaryContent(CharsetToolkit.getUtf8Bytes(content));
        }
        result.set(file);
      }
 catch (      IOException e) {
        throw new RuntimeException(e);
      }
    }
  }
.execute();
  return result.get();
}
