{
  super(project,true);
  setTitle("Create New Project");
  init();
  myBaseDir=getBaseDir();
  File projectName=FileUtil.findSequentNonexistentFile(new File(myBaseDir),"untitled","");
  myLocationField.setText(projectName.toString());
  myProjectNameTextField.setText(projectName.getName());
  FileChooserDescriptor descriptor=new FileChooserDescriptor(false,true,false,false,false,false);
  ComponentWithBrowseButton.BrowseFolderActionListener<JTextField> listener=new ComponentWithBrowseButton.BrowseFolderActionListener<JTextField>("Select Location for Project Directory","",myLocationField,project,descriptor,TextComponentAccessor.TEXT_FIELD_WHOLE_TEXT){
    protected void onFileChoosen(    VirtualFile chosenFile){
      super.onFileChoosen(chosenFile);
      myBaseDir=chosenFile.getPath();
      myLocationField.setText(new File(chosenFile.getPath(),myProjectNameTextField.getText()).toString());
    }
  }
;
  myLocationField.addActionListener(listener);
  myProjectNameTextField.getDocument().addDocumentListener(new DocumentAdapter(){
    protected void textChanged(    final DocumentEvent e){
      myLocationField.setText(new File(myBaseDir,myProjectNameTextField.getText()).getPath());
    }
  }
);
  myProjectNameTextField.selectAll();
  final DirectoryProjectGenerator[] generators=Extensions.getExtensions(DirectoryProjectGenerator.EP_NAME);
  if (generators.length == 0) {
    myProjectTypePanel.setVisible(false);
  }
 else {
    DefaultComboBoxModel model=new DefaultComboBoxModel();
    model.addElement(EMPTY_PROJECT_GENERATOR);
    for (    DirectoryProjectGenerator generator : generators) {
      model.addElement(generator);
    }
    myProjectTypeComboBox.setModel(model);
    myProjectTypeComboBox.setRenderer(new ColoredListCellRenderer(){
      protected void customizeCellRenderer(      final JList list,      final Object value,      final int index,      final boolean selected,      final boolean hasFocus){
        if (value == EMPTY_PROJECT_GENERATOR) {
          append("Empty project",SimpleTextAttributes.REGULAR_ATTRIBUTES);
        }
 else {
          DirectoryProjectGenerator generator=(DirectoryProjectGenerator)value;
          append(generator.getName(),SimpleTextAttributes.REGULAR_ATTRIBUTES);
        }
      }
    }
);
  }
}
