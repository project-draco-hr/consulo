{
  String failReason=checkCanConvert(virtualFile);
  if (failReason != null)   return null;
  FileDocumentManager documentManager=FileDocumentManager.getInstance();
  Document document=documentManager.getDocument(virtualFile);
  if (document == null)   return null;
  Charset charsetFromContent=EncodingManager.getInstance().getCachedCharsetFromContent(document);
  Charset charset=charsetFromContent != null ? charsetFromContent : virtualFile.getCharset();
  String text=MessageFormat.format("Save ''{0}''-encoded file ''{1}'' in another encoding",charset.displayName(),virtualFile.getName());
  return Pair.create(document,text);
}
