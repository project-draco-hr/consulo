{
  int w=icon.getIconWidth();
  int h=icon.getIconHeight();
  BufferedImage first=UIUtil.createImage(w,h,BufferedImage.TYPE_INT_ARGB);
  Graphics2D g=first.createGraphics();
  icon.paintIcon(new JPanel(),g,0,0);
  g.dispose();
  BufferedImage second=UIUtil.createImage(w,h,BufferedImage.TYPE_INT_ARGB);
  g=second.createGraphics();
  if (horizontal) {
    g.drawImage(first,0,0,w,h,w,0,0,h,null);
  }
 else {
    g.drawImage(first,0,0,w,h,0,h,w,0,null);
  }
  g.dispose();
  return new ImageIcon(second);
}
