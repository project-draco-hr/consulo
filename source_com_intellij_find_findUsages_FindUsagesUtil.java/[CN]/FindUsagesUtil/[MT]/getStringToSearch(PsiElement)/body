{
  return ApplicationManager.getApplication().runReadAction(new Computable<String>(){
    public String compute(){
      PsiElement norm=element;
      if (element instanceof PsiDirectory) {
        norm=((PsiDirectory)element).getPackage();
      }
      if (norm instanceof PsiPackage) {
        return ((PsiPackage)norm).getQualifiedName();
      }
      if (norm instanceof PsiClass) {
        return ((PsiClass)norm).getQualifiedName();
      }
      if (norm instanceof PsiMethod) {
        return ((PsiMethod)norm).getName();
      }
      if (norm instanceof PsiVariable) {
        return ((PsiVariable)norm).getName();
      }
      if (norm instanceof PsiMetaBaseOwner) {
        final PsiMetaDataBase metaData=((PsiMetaBaseOwner)norm).getMetaData();
        if (metaData != null) {
          return metaData.getName();
        }
      }
      if (norm instanceof PsiNamedElement) {
        return ((PsiNamedElement)norm).getName();
      }
      if (norm instanceof XmlAttributeValue) {
        return ((XmlAttributeValue)norm).getValue();
      }
      LOG.error("Unknown element type: " + element);
      return null;
    }
  }
);
}
