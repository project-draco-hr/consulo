{
  int offset=editor.getCaretModel().getOffset();
  PsiElement element=file.findElementAt(offset);
  if (element instanceof PsiKeyword) {
    PsiKeyword keyword=(PsiKeyword)element;
    if ((keyword.getTokenType() == JavaTokenType.IF_KEYWORD || keyword.getTokenType() == JavaTokenType.ELSE_KEYWORD) && keyword.getParent() instanceof PsiIfStatement) {
      PsiIfStatement ifStatement=PsiTreeUtil.getParentOfType(keyword,PsiIfStatement.class);
      if (ifStatement == null)       return false;
      PsiElement block=findCodeBlock(ifStatement);
      if (block == null)       return false;
      if (ifStatement.getCondition() == null)       return false;
      if (ifStatement.getThenBranch() == null)       return false;
      return true;
    }
  }
  return false;
}
