{
  final PsiParameter parameter=statement.getIterationParameter();
  final PsiExpression expression=statement.getIteratedValue();
  if (expression == null)   return null;
  if (parameter == null)   return null;
  final PsiType itemType=getCollectionItemType(expression);
  if (itemType == null) {
    String description=MessageFormat.format("foreach not applicable to type ''{0}''.",new Object[]{HighlightUtil.formatType(expression.getType())});
    return HighlightInfo.createHighlightInfo(HighlightInfoType.ERROR,expression,description);
  }
  final int start=parameter.getTextRange().getStartOffset();
  final int end=expression.getTextRange().getEndOffset();
  final PsiType parameterType=parameter.getType();
  final HighlightInfo highlightInfo=HighlightUtil.checkAssignability(parameterType,itemType,null,new TextRange(start,end));
  if (highlightInfo != null) {
    QuickFixAction.registerQuickFixAction(highlightInfo,new VariableTypeFix(parameter,itemType));
  }
  return highlightInfo;
}
