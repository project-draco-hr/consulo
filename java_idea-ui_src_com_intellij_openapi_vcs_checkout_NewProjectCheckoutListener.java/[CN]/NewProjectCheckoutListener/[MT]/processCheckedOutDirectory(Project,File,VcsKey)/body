{
  int rc=Messages.showYesNoDialog(project,VcsBundle.message("checkout.create.project.prompt",ProjectCheckoutListener.getProductNameWithArticle(),directory.getAbsolutePath()),VcsBundle.message("checkout.title"),Messages.getQuestionIcon());
  if (rc == 0) {
    final ProjectManager pm=ProjectManager.getInstance();
    final Project[] projects=pm.getOpenProjects();
    final Set<VirtualFile> files=projectsLocationSet(projects);
    NewProjectUtil.createNewProject(project,directory.getAbsolutePath());
    final Project[] projectsAfter=pm.getOpenProjects();
    for (    Project project1 : projectsAfter) {
      if (project1.getBaseDir() != null && !files.contains(project1.getBaseDir())) {
        final ProjectLevelVcsManager vcsManager=ProjectLevelVcsManager.getInstance(project1);
        vcsManager.setDirectoryMappings(Collections.singletonList(new VcsDirectoryMapping("",vcsKey.getName())));
        break;
      }
    }
    return true;
  }
  return false;
}
