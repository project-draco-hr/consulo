{
  int offset=editor.getCaretModel().getOffset();
  Set<TemplateImpl> array=new LinkedHashSet<TemplateImpl>();
  for (  TemplateImpl template : TemplateSettings.getInstance().getTemplates()) {
    if (!template.isDeactivated() && template.isSelectionTemplate() == selection && TemplateManagerImpl.isApplicable(file,offset,template)) {
      array.add(template);
    }
  }
  final ArrayList<TemplateImpl> list=new ArrayList<TemplateImpl>(array);
  Collections.sort(list,new Comparator<TemplateImpl>(){
    public int compare(    TemplateImpl o1,    TemplateImpl o2){
      return o1.getKey().compareTo(o2.getKey());
    }
  }
);
  return list;
}
