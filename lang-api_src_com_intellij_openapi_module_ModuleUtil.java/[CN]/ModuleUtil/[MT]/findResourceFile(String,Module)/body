{
  final VirtualFile[] sourceRoots=ModuleRootManager.getInstance(inModule).getSourceRoots();
  final ProjectFileIndex fileIndex=ProjectRootManager.getInstance(inModule.getProject()).getFileIndex();
  for (  final VirtualFile sourceRoot : sourceRoots) {
    final String packagePrefix=fileIndex.getPackageNameByDirectory(sourceRoot);
    final String prefix=packagePrefix == null || packagePrefix.length() == 0 ? null : packagePrefix.replace('.','/') + "/";
    final String relPath=prefix != null && name.startsWith(prefix) && name.length() > prefix.length() ? name.substring(prefix.length()) : name;
    final String fullPath=sourceRoot.getPath() + "/" + relPath;
    final VirtualFile fileByPath=LocalFileSystem.getInstance().findFileByPath(fullPath);
    if (fileByPath != null) {
      return fileByPath;
    }
  }
  return null;
}
