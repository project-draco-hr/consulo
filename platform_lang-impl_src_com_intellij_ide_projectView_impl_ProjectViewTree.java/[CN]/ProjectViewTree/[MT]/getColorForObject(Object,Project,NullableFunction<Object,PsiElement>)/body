{
  Color color=null;
  final PsiElement psi=converter.fun(object);
  if (psi != null) {
    if (!psi.isValid())     return null;
    final VirtualFile file=PsiUtilCore.getVirtualFile(psi);
    if (file != null) {
      color=FileColorManager.getInstance(project).getFileColor(file);
    }
 else     if (psi instanceof PsiDirectory) {
      color=FileColorManager.getInstance(project).getFileColor(((PsiDirectory)psi).getVirtualFile());
    }
 else     if (psi instanceof PsiDirectoryContainer) {
      final PsiDirectory[] dirs=((PsiDirectoryContainer)psi).getDirectories();
      for (      PsiDirectory dir : dirs) {
        Color c=FileColorManager.getInstance(project).getFileColor(dir.getVirtualFile());
        if (c != null && color == null) {
          color=c;
        }
 else         if (c != null) {
          color=null;
          break;
        }
      }
    }
  }
  return color == null ? null : ColorUtil.softer(color);
}
