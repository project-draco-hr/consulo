{
  final TreePath leadSelectionPath=tree.getLeadSelectionPath();
  int row=tree.getRowCount() - 1;
  while (row >= 0) {
    tree.collapseRow(row);
    row--;
  }
  final DefaultMutableTreeNode root=(DefaultMutableTreeNode)tree.getModel().getRoot();
  tree.expandPath(new TreePath(root));
  if (leadSelectionPath != null) {
    final Object[] path=leadSelectionPath.getPath();
    final Object[] pathToSelect=new Object[path.length > keepSelectionLevel && keepSelectionLevel >= 0 ? keepSelectionLevel : path.length];
    System.arraycopy(path,0,pathToSelect,0,pathToSelect.length);
    if (pathToSelect.length == 0)     return;
    selectPath(tree,new TreePath(pathToSelect));
  }
}
