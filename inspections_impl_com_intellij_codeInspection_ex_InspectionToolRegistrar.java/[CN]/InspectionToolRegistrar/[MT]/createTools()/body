{
  ensureInitialized();
  int ordinaryToolsSize=myInspectionTools.size();
  final int withLocal=ordinaryToolsSize + myLocalInspectionTools.size();
  InspectionTool[] tools=new InspectionTool[withLocal + myGlobalInspectionTools.size()];
  for (int i=0; i < ordinaryToolsSize; i++) {
    tools[i]=(InspectionTool)instantiateTool(myInspectionTools.get(i));
  }
  for (int i=ordinaryToolsSize; i < withLocal; i++) {
    tools[i]=new LocalInspectionToolWrapper((LocalInspectionTool)instantiateTool(myLocalInspectionTools.get(i - ordinaryToolsSize)));
  }
  for (int i=withLocal; i < tools.length; i++) {
    tools[i]=new GlobalInspectionToolWrapper((GlobalInspectionTool)instantiateTool(myGlobalInspectionTools.get(i - withLocal)));
  }
  buildInspectionIndex(tools);
  return tools;
}
