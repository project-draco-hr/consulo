{
  Document document=editor.getDocument();
  if (line >= getLineCount(document)) {
    int y=lineToY(editor,getLineCount(document) - 1);
    return y + editor.getLineHeight() * (line - getLineCount(document) + 1);
  }
  return editor.logicalPositionToXY(editor.offsetToLogicalPosition(document.getLineStartOffset(line))).y;
}
