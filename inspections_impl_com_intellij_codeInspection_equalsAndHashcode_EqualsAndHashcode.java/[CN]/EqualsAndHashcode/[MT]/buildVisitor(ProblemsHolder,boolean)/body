{
  if (!myInitialized.getAndSet(true)) {
    final PsiClass psiObjectClass=ApplicationManager.getApplication().runReadAction(new Computable<PsiClass>(){
      @Nullable public PsiClass compute(){
        return myPsiFacade.findClass("java.lang.Object");
      }
    }
);
    if (psiObjectClass != null) {
      PsiMethod[] methods=psiObjectClass.getMethods();
      for (      PsiMethod method : methods) {
        @NonNls final String name=method.getName();
        if ("equals".equals(name)) {
          myEquals=method;
        }
 else         if ("hashCode".equals(name)) {
          myHashCode=method;
        }
      }
    }
  }
  if (myEquals == null || myHashCode == null || !myEquals.isValid() || !myHashCode.isValid())   return new PsiElementVisitor(){
  }
;
  return new JavaElementVisitor(){
    @Override public void visitClass(    PsiClass aClass){
      super.visitClass(aClass);
      boolean[] hasEquals=new boolean[]{false};
      boolean[] hasHashCode=new boolean[]{false};
      processClass(aClass,hasEquals,hasHashCode);
      if (hasEquals[0] != hasHashCode[0]) {
        PsiIdentifier identifier=aClass.getNameIdentifier();
        holder.registerProblem(identifier != null ? identifier : aClass,hasEquals[0] ? InspectionsBundle.message("inspection.equals.hashcode.only.one.defined.problem.descriptor","<code>equals()</code>","<code>hashCode()</code>") : InspectionsBundle.message("inspection.equals.hashcode.only.one.defined.problem.descriptor","<code>hashCode()</code>","<code>equals()</code>"),(LocalQuickFix[])null);
      }
    }
    @Override public void visitReferenceExpression(    PsiReferenceExpression expression){
    }
  }
;
}
