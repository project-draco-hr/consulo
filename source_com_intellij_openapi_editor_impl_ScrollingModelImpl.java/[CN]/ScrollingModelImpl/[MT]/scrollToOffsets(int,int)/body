{
  cancelAnimatedScrolling(false);
  VisibleEditorsTracker editorsTracker=VisibleEditorsTracker.getInstance();
  boolean useAnimation;
  if (!myEditor.getSettings().isAnimatedScrolling() || myAnimationDisabled) {
    useAnimation=false;
  }
 else   if (CommandProcessor.getInstance().getCurrentCommand() == null) {
    useAnimation=myEditor.getComponent().isShowing();
  }
 else   if (editorsTracker.getCurrentCommandStart() - editorsTracker.getLastCommandFinish() < AnimatedScrollingRunnable.SCROLL_DURATION) {
    useAnimation=false;
  }
 else {
    useAnimation=editorsTracker.wasEditorVisibleOnCommandStart(myEditor);
  }
  if (useAnimation) {
    int startHOffset=getHorizontalScrollOffset();
    int startVOffset=getVerticalScrollOffset();
    if (startHOffset == hOffset && startVOffset == vOffset) {
      return;
    }
    try {
      myCurrentAnimatedRunnable=new AnimatedScrollingRunnable(startHOffset,startVOffset,hOffset,vOffset);
      new Thread(myCurrentAnimatedRunnable,"AnimatedScrollingThread").start();
    }
 catch (    NoAnimationRequiredException e) {
      _scrollHorizontally(hOffset);
      _scrollVertically(vOffset);
    }
  }
 else {
    _scrollHorizontally(hOffset);
    _scrollVertically(vOffset);
  }
}
