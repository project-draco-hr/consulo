{
  mySession=session;
  myWaitFor.down();
  ApplicationManager.getApplication().assertIsDispatchThread();
  LOG.assertTrue(isInInitialState());
  myConnection=remoteConnection;
  createVirtualMachine(state,pollConnection);
  try {
synchronized (myProcessListeners) {
      if (state instanceof CommandLineState) {
        final TextConsoleBuilder consoleBuilder=((CommandLineState)state).getConsoleBuilder();
        if (consoleBuilder != null) {
          List<Filter> filters=ExceptionFilters.getFilters(session.getSearchScope());
          for (          Filter filter : filters) {
            consoleBuilder.addFilter(filter);
          }
        }
      }
      myExecutionResult=state.execute(executor,runner);
      if (myExecutionResult == null) {
        fail();
        return null;
      }
      for (      ProcessListener processListener : myProcessListeners) {
        myExecutionResult.getProcessHandler().addProcessListener(processListener);
      }
      myProcessListeners.clear();
    }
  }
 catch (  ExecutionException e) {
    fail();
    throw e;
  }
  myDebugProcessStarted=true;
  if (ApplicationManager.getApplication().isUnitTestMode()) {
    return myExecutionResult;
  }
  return myExecutionResult;
}
