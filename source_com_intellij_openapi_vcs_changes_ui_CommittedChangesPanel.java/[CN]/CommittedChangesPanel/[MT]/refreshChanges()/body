{
  final Ref<VcsException> refEx=new Ref<VcsException>();
  final Ref<List<CommittedChangeList>> changes=new Ref<List<CommittedChangeList>>();
  boolean cancelled=ProgressManager.getInstance().runProcessWithProgressSynchronously(new Runnable(){
    public void run(){
      try {
        if (myRoot == null) {
          changes.set(myProvider.getAllCommittedChanges(mySettings,50));
        }
 else {
          changes.set(myProvider.getCommittedChanges(mySettings,myRoot,myMaxCount));
        }
      }
 catch (      VcsException ex) {
        refEx.set(ex);
      }
    }
  }
,"Loading changes",true,myProject);
  if (!refEx.isNull()) {
    LOG.info(refEx.get());
    Messages.showErrorDialog(myProject,"Error refreshing view: " + StringUtil.join(refEx.get().getMessages(),"\n"),"Committed Changes");
  }
 else   if (!cancelled) {
    myChangesFromProvider=changes.get();
    updateFilteredModel();
  }
}
