{
  CaretListener wrapper=new CaretListener(){
    @Override public void caretPositionChanged(    CaretEvent e){
      if (!myEditorWindow.getDocument().isValid())       return;
      CaretEvent event=new CaretEvent(myEditorWindow,createInjectedCaret(e.getCaret()),myEditorWindow.hostToInjected(e.getOldPosition()),myEditorWindow.hostToInjected(e.getNewPosition()));
      listener.caretPositionChanged(event);
    }
  }
;
  myCaretListeners.registerWrapper(listener,wrapper);
  myDelegate.addCaretListener(wrapper);
}
