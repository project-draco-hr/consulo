{
  myProject=project;
  JPanel panel=new JPanel(new BorderLayout());
  JBSplitter splitter=new JBSplitter();
  splitter.setSplitterProportionKey(getClass().getName() + ".splitter");
  myStructureViewPanel=new JPanel();
  splitter.setFirstComponent(myStructureViewPanel);
  myValuesPanel=new JPanel();
  splitter.setSecondComponent(myValuesPanel);
  panel.add(splitter,BorderLayout.CENTER);
  myResourceBundle=resourceBundle;
  myStructureViewComponent=new ResourceBundleStructureViewComponent(project,myResourceBundle,this);
  myStructureViewPanel.setLayout(new BorderLayout());
  myStructureViewPanel.add(myStructureViewComponent,BorderLayout.CENTER);
  myStructureViewComponent.getTree().getSelectionModel().addTreeSelectionListener(new TreeSelectionListener(){
    private String selectedPropertyName;
    private PropertiesFile selectedPropertiesFile;
    @Override public void valueChanged(    TreeSelectionEvent e){
      if (getSelectedPropertyName() == null)       return;
      if (!Comparing.strEqual(selectedPropertyName,getSelectedPropertyName()) || !Comparing.equal(selectedPropertiesFile,getSelectedPropertiesFile())) {
        selectedPropertyName=getSelectedPropertyName();
        selectedPropertiesFile=getSelectedPropertiesFile();
        selectionChanged();
      }
    }
  }
);
  installPropertiesChangeListeners();
  myEditors=new THashMap<PropertiesFile,Editor>();
  myTitledPanels=new THashMap<PropertiesFile,JPanel>();
  recreateEditorsPanel();
  TreeElement[] children=myStructureViewComponent.getTreeModel().getRoot().getChildren();
  if (children.length != 0) {
    TreeElement child=children[0];
    String propName=((ResourceBundlePropertyStructureViewElement)child).getValue();
    setState(new ResourceBundleEditorState(propName));
  }
  myDataProviderPanel=new DataProviderPanel(panel);
  project.getMessageBus().connect(project).subscribe(FileEditorManagerListener.FILE_EDITOR_MANAGER,new FileEditorManagerAdapter(){
    @Override public void selectionChanged(    @NotNull FileEditorManagerEvent event){
      onSelectionChanged(event);
    }
  }
);
}
