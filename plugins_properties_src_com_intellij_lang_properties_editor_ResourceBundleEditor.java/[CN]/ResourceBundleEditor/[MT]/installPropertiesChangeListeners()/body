{
  VirtualFileManager.getInstance().addVirtualFileListener(new VirtualFileAdapter(){
    @Override public void fileCreated(    VirtualFileEvent event){
      if (PropertiesUtil.isPropertiesFile(event.getFile(),myProject)) {
        recreateEditorsPanel();
      }
    }
    @Override public void fileDeleted(    VirtualFileEvent event){
      for (      PropertiesFile file : myEditors.keySet()) {
        if (file.getVirtualFile() == event.getFile()) {
          recreateEditorsPanel();
          return;
        }
      }
    }
    @Override public void propertyChanged(    VirtualFilePropertyEvent event){
      if (PropertiesUtil.isPropertiesFile(event.getFile(),myProject)) {
        if (VirtualFile.PROP_NAME.equals(event.getPropertyName())) {
          recreateEditorsPanel();
        }
 else {
          updateEditorsFromProperties();
        }
      }
    }
  }
,this);
  myPsiTreeChangeAdapter=new PsiTreeChangeAdapter(){
    public void childAdded(    PsiTreeChangeEvent event){
      childrenChanged(event);
    }
    public void childRemoved(    PsiTreeChangeEvent event){
      childrenChanged(event);
    }
    public void childReplaced(    PsiTreeChangeEvent event){
      childrenChanged(event);
    }
    public void childMoved(    PsiTreeChangeEvent event){
      childrenChanged(event);
    }
    public void childrenChanged(    PsiTreeChangeEvent event){
      final PsiFile file=event.getFile();
      PropertiesFile propertiesFile=PropertiesUtil.getPropertiesFile(file);
      if (propertiesFile == null)       return;
      if (!propertiesFile.getResourceBundle().equals(myResourceBundle))       return;
      updateEditorsFromProperties();
    }
  }
;
  PsiManager.getInstance(myProject).addPsiTreeChangeListener(myPsiTreeChangeAdapter,this);
}
