{
  IdeaPluginDescriptorImpl descriptor=PluginManagerCore.loadDescriptorFromJar(file);
  if (descriptor == null) {
    if (file.getName().endsWith(".zip")) {
      final File outputDir=FileUtil.createTempDirectory("plugin","");
      try {
        ZipUtil.extract(file,outputDir,null);
        final File[] files=outputDir.listFiles();
        if (files != null && files.length == 1) {
          descriptor=PluginManagerCore.loadDescriptor(files[0],PluginManagerCore.PLUGIN_XML);
        }
      }
  finally {
        FileUtil.delete(outputDir);
      }
    }
  }
  return descriptor;
}
