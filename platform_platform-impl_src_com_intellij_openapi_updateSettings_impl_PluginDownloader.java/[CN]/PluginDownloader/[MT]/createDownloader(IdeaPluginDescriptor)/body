{
  String installationUUID=UpdateChecker.getInstallationUID(PropertiesComponent.getInstance());
  final BuildNumber buildNumber=ApplicationInfo.getInstance().getBuild();
  @NonNls String url=RepositoryHelper.DOWNLOAD_URL + URLEncoder.encode(pluginDescriptor.getPluginId().getIdString(),"UTF8") + "&build="+ buildNumber.asString()+ "&uuid="+ URLEncoder.encode(installationUUID,"UTF8");
  if (pluginDescriptor instanceof PluginNode && ((PluginNode)pluginDescriptor).getDownloadUrl() != null) {
    url=((PluginNode)pluginDescriptor).getDownloadUrl();
  }
  final PluginDownloader downloader=new PluginDownloader(pluginDescriptor.getPluginId().getIdString(),url,null,null,pluginDescriptor.getName());
  downloader.setDescriptor(pluginDescriptor);
  return downloader;
}
