{
  myProjectListener=new ProjectManagerAdapter(){
    public void projectClosing(    final Project project){
      VirtualFileDelegate[] delegates;
synchronized (cachedFiles) {
        delegates=cachedFiles.toArray(new VirtualFileDelegate[cachedFiles.size()]);
      }
      for (      VirtualFileDelegate file : delegates) {
        if (file == null)         continue;
        DocumentRange documentRange=file.getDocumentRange();
        PsiFile injected=PsiDocumentManager.getInstance(project).getCachedPsiFile(documentRange);
        if (injected != null) {
          InjectedLanguageUtil.clearCaches(injected,documentRange);
        }
      }
    }
  }
;
}
