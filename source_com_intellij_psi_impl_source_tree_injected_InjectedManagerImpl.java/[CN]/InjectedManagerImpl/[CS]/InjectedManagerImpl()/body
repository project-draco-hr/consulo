{
  myProjectListener=new ProjectManagerAdapter(){
    public void projectClosing(    final Project project){
      VirtualFileDelegate[] delegates;
synchronized (cachedFiles) {
        delegates=new VirtualFileDelegate[cachedFiles.size()];
        Iterator<VirtualFileDelegate> iterator=cachedFiles.iterator();
        int i=0;
        while (iterator.hasNext()) {
          delegates[i++]=iterator.next();
        }
      }
      for (      VirtualFileDelegate file : delegates) {
        if (file == null)         continue;
        DocumentRange documentRange=file.getDocumentRange();
        PsiFile injected=PsiDocumentManager.getInstance(project).getCachedPsiFile(documentRange);
        if (injected != null) {
          InjectedLanguageUtil.clearCaches(injected,documentRange);
        }
      }
    }
  }
;
}
