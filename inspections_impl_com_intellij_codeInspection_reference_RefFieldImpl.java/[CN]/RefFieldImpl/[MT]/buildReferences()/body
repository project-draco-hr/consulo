{
  PsiField psiField=getElement();
  if (psiField != null) {
    final RefUtilImpl refUtil=(RefUtilImpl)RefUtil.getInstance();
    refUtil.addReferences(psiField,this,psiField.getInitializer());
    if (psiField instanceof PsiEnumConstant) {
      refUtil.addReferences(psiField,this,psiField);
    }
    if (psiField.getInitializer() != null || psiField instanceof PsiEnumConstant) {
      if (!checkFlag(USED_FOR_WRITING_MASK)) {
        setFlag(true,ASSIGNED_ONLY_IN_INITIALIZER);
        setFlag(true,USED_FOR_WRITING_MASK);
      }
    }
    PsiType psiType=psiField.getType();
    RefClass ownerClass=refUtil.getOwnerClass(getRefManager(),psiField);
    if (ownerClass != null) {
      psiType=psiType.getDeepComponentType();
      if (psiType instanceof PsiClassType) {
        PsiClass psiClass=PsiUtil.resolveClassInType(psiType);
        if (psiClass != null && refUtil.belongsToScope(psiClass,getRefManager())) {
          RefClassImpl refClass=(RefClassImpl)getRefManager().getReference(psiClass);
          if (refClass != null) {
            refClass.addTypeReference(ownerClass);
            refClass.addClassExporter(this);
          }
        }
      }
    }
    ((RefManagerImpl)getRefManager()).fireBuildReferences(this);
  }
}
