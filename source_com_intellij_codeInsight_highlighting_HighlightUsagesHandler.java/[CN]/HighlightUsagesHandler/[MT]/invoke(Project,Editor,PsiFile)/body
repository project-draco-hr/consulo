{
  PsiDocumentManager.getInstance(project).commitAllDocuments();
  SelectionModel selectionModel=editor.getSelectionModel();
  if (file == null && !selectionModel.hasSelection()) {
    selectionModel.selectWordAtCaret(false);
  }
  if (file == null || selectionModel.hasSelection()) {
    doRangeHighlighting(editor,project);
    return;
  }
  PsiElement target=getTargetElement(editor);
  if (target == null) {
    if (file.findElementAt(editor.getCaretModel().getOffset()) instanceof PsiWhiteSpace)     return;
    selectionModel.selectWordAtCaret(false);
    String selection=selectionModel.getSelectedText();
    for (int i=0; i < selection.length(); i++) {
      if (!Character.isJavaIdentifierPart(selection.charAt(i))) {
        selectionModel.removeSelection();
        return;
      }
    }
    doRangeHighlighting(editor,project);
    selectionModel.removeSelection();
    return;
  }
  createHighlightAction(project,file,target,editor).run();
}
