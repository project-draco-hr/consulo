{
  if (payload == null) {
    TypesWriter tw=new TypesWriter();
    tw.writeByte(Packets.SSH_MSG_KEXINIT);
    tw.writeBytes(kp.cookie,0,16);
    tw.writeNameList(kp.kex_algorithms);
    tw.writeNameList(kp.server_host_key_algorithms);
    tw.writeNameList(kp.encryption_algorithms_client_to_server);
    tw.writeNameList(kp.encryption_algorithms_server_to_client);
    tw.writeNameList(kp.mac_algorithms_client_to_server);
    tw.writeNameList(kp.mac_algorithms_server_to_client);
    tw.writeNameList(kp.compression_algorithms_client_to_server);
    tw.writeNameList(kp.compression_algorithms_server_to_client);
    tw.writeNameList(kp.languages_client_to_server);
    tw.writeNameList(kp.languages_server_to_client);
    tw.writeBoolean(kp.first_kex_packet_follows);
    tw.writeUINT32(kp.reserved_field1);
    payload=tw.getBytes();
  }
  return payload;
}
