{
  if (editor != null) {
    if (myTabbedPane == null) {
      myPanel.removeAll();
      myPanel.add(new TCompForTablessMode(this,editor),BorderLayout.CENTER);
      myPanel.revalidate();
      return;
    }
    final int index=findEditorIndex(editor);
    if (index != -1) {
      setSelectedEditor(editor,focusEditor);
    }
 else {
      Integer initialIndex=editor.getFile().getUserData(INITIAL_INDEX_KEY);
      final int indexToInsert=initialIndex == null ? myTabbedPane.getSelectedIndex() + 1 : initialIndex;
      final VirtualFile file=editor.getFile();
      final Icon template=IconLoader.getIcon("/fileTypes/text.png");
      myTabbedPane.insertTab(file,new EmptyIcon(template.getIconWidth(),template.getIconHeight()),new TComp(editor),null,indexToInsert);
      trimToSize(UISettings.getInstance().EDITOR_TAB_LIMIT,file,false);
      setSelectedEditor(editor,focusEditor);
      myOwner.updateFileIcon(file);
      myOwner.updateFileColor(file);
    }
    myOwner.setCurrentWindow(this,false);
  }
  myPanel.revalidate();
}
