{
  if (editor != null) {
    if (myTabbedPane == null) {
      myPanel.removeAll();
      myPanel.add(new TCompForTablessMode(this,editor),BorderLayout.CENTER);
      myPanel.revalidate();
      return;
    }
    final int index=findEditorIndex(editor);
    if (index != -1) {
      setSelectedEditor(editor,focusEditor);
    }
 else {
      Integer initialIndex=editor.getFile().getUserData(INITIAL_INDEX_KEY);
      int indexToInsert=0;
      if (initialIndex == null) {
        int selectedIndex=myTabbedPane.getSelectedIndex();
        if (selectedIndex >= 0) {
          indexToInsert=UISettings.getInstance().ACTIVATE_RIGHT_EDITOR_ON_CLOSE ? selectedIndex : selectedIndex + 1;
        }
      }
 else {
        indexToInsert=initialIndex;
      }
      final VirtualFile file=editor.getFile();
      final Icon template=AllIcons.FileTypes.Text;
      myTabbedPane.insertTab(file,new EmptyIcon(template.getIconWidth(),template.getIconHeight()),new TComp(this,editor),null,indexToInsert);
      trimToSize(UISettings.getInstance().EDITOR_TAB_LIMIT,file,false);
      setSelectedEditor(editor,focusEditor);
      myOwner.updateFileIcon(file);
      myOwner.updateFileColor(file);
    }
    myOwner.setCurrentWindow(this,false);
  }
  myPanel.revalidate();
}
