{
  LinkedHashSet<VirtualFile> closingOrder=getTabClosingOrder(closeNonModifiedFilesFirst);
  for (  VirtualFile file : closingOrder) {
    if (myTabbedPane.getTabCount() <= limit || myTabbedPane.getTabCount() == 0 || areAllTabsPinned(fileToIgnore)) {
      return;
    }
    if (fileCanBeClosed(file,fileToIgnore)) {
      defaultCloseFile(file,transferFocus);
    }
  }
}
