{
  PsiStatement thenBranch=statement.getThenBranch();
  thenBranch=ControlFlowUtils.stripBraces(thenBranch);
  if (thenBranch == null) {
    return "";
  }
  PsiStatement elseBranch=statement.getElseBranch();
  elseBranch=ControlFlowUtils.stripBraces(elseBranch);
  if (elseBranch == null) {
    final PsiElement nextStatement=PsiTreeUtil.skipSiblingsForward(statement,PsiWhiteSpace.class);
    if (nextStatement instanceof PsiStatement) {
      elseBranch=(PsiStatement)nextStatement;
    }
  }
  if (elseBranch == null) {
    return "";
  }
  final PsiExpression condition=statement.getCondition();
  if (condition == null) {
    return "";
  }
  if (elseBranch instanceof PsiReturnStatement) {
    return calculateReplacementReturnStatement(thenBranch,elseBranch,condition);
  }
  final PsiExpressionStatement thenStatement=(PsiExpressionStatement)thenBranch;
  final PsiExpressionStatement elseStatement=(PsiExpressionStatement)elseBranch;
  final PsiAssignmentExpression thenAssignment=(PsiAssignmentExpression)thenStatement.getExpression();
  final PsiAssignmentExpression elseAssignment=(PsiAssignmentExpression)elseStatement.getExpression();
  return calculateReplacementAssignmentStatement(thenAssignment,elseAssignment,condition);
}
