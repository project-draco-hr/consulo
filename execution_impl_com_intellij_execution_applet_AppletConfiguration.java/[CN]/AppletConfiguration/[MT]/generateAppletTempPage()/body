{
  final File tempFile=File.createTempFile("AppletPage",".html");
  @NonNls final FileWriter writer=new FileWriter(tempFile);
  try {
    writer.write("<html>\n" + "<head>\n" + "<title>" + MAIN_CLASS_NAME + "</title>\n"+ "</head>\n"+ "<applet codebase=\".\"\n"+ "code=\""+ MAIN_CLASS_NAME+ "\"\n"+ "name=\""+ MAIN_CLASS_NAME+ "\"\n"+ "width="+ WIDTH+ "\n"+ "height="+ HEIGHT+ "\n"+ "align=top>\n");
    final AppletParameter[] appletParameters=getAppletParameters();
    if (appletParameters != null) {
      for (      final AppletParameter parameter : appletParameters) {
        writer.write("<param name=\"" + parameter.getName() + "\" value=\""+ parameter.getValue()+ "\">\n");
      }
    }
    writer.write("</applet>\n</body>\n</html>\n");
  }
  finally {
    writer.close();
  }
  final String htmlFile=tempFile.getAbsolutePath();
  return new AppletHtmlFile(htmlFile,tempFile);
}
