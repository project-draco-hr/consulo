{
  return new ProcessListener(){
    @Override public void startNotified(    ProcessEvent event){
      ProcessHandler processHandler=event.getProcessHandler();
      processHandler.putUserData(ProcessHandler.SILENTLY_DESTROY_ON_CLOSE,Boolean.TRUE);
      Info o;
synchronized (myProcMap) {
        o=myProcMap.get(key);
        if (o instanceof PendingInfo) {
          myProcMap.put(key,new PendingInfo(((PendingInfo)o).ref,processHandler));
        }
      }
    }
    @Override public void processTerminated(    ProcessEvent event){
      if (dropProcessInfo(key,null,event.getProcessHandler())) {
        fireModificationCountChanged();
      }
    }
    @Override public void processWillTerminate(    ProcessEvent event,    boolean willBeDestroyed){
      if (dropProcessInfo(key,null,event.getProcessHandler())) {
        fireModificationCountChanged();
      }
    }
    @Override public void onTextAvailable(    ProcessEvent event,    Key outputType){
      String text=StringUtil.notNullize(event.getText());
      if (outputType == ProcessOutputTypes.STDERR) {
        LOG.warn(text.trim());
      }
 else {
        LOG.info(text.trim());
      }
      RunningInfo result=null;
      PendingInfo info;
synchronized (myProcMap) {
        Info o=myProcMap.get(key);
        logText(key.second,event,outputType,o);
        if (o instanceof PendingInfo) {
          info=(PendingInfo)o;
          if (outputType == ProcessOutputTypes.STDOUT) {
            String prefix="Port/ID:";
            if (text.startsWith(prefix)) {
              String pair=text.substring(prefix.length()).trim();
              int idx=pair.indexOf("/");
              result=new RunningInfo(info.handler,Integer.parseInt(pair.substring(0,idx)),pair.substring(idx + 1));
              myProcMap.put(key,result);
              myProcMap.notifyAll();
            }
          }
 else           if (outputType == ProcessOutputTypes.STDERR) {
            info.stderr.append(text);
          }
        }
 else {
          info=null;
        }
      }
      if (result != null) {
synchronized (info.ref) {
          info.ref.set(result);
          info.ref.notifyAll();
        }
        fireModificationCountChanged();
        try {
          RemoteDeadHand.TwoMinutesTurkish.startCooking("localhost",result.port);
        }
 catch (        Exception e) {
          LOG.warn("The cook failed to start due to " + ExceptionUtil.getRootCause(e));
        }
      }
    }
  }
;
}
