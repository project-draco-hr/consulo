{
  final Matcher matcher=MACRO_PATTERN.matcher(file);
  while (matcher.find()) {
    String m=matcher.group(1);
    if (!myMacros.containsKey(m)) {
      throw new IllegalArgumentException("Unknown macro: " + m + " in storage spec: "+ file);
    }
  }
  String actualFile=file;
  for (  String macro : myMacros.keySet()) {
    final String replacement=myMacros.get(macro);
    if (replacement == null) {
      return null;
    }
    actualFile=StringUtil.replace(actualFile,macro,replacement);
  }
  return actualFile;
}
