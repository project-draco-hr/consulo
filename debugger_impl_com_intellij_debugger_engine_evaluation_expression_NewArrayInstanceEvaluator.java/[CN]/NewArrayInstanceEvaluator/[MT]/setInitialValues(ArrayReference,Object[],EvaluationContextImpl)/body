{
  ArrayType type=(ArrayType)arrayReference.referenceType();
  DebugProcessImpl debugProcess=context.getDebugProcess();
  try {
    if (type.componentType() instanceof ArrayType) {
      ArrayType componentType=(ArrayType)type.componentType();
      int length=arrayReference.length();
      for (int idx=0; idx < length; idx++) {
        ArrayReference componentArray=(ArrayReference)arrayReference.getValue(idx);
        Object[] componentArrayValues=(Object[])values[idx];
        if (componentArray == null) {
          componentArray=debugProcess.newInstance(componentType,componentArrayValues.length);
          arrayReference.setValue(idx,componentArray);
        }
        setInitialValues(componentArray,componentArrayValues,context);
      }
    }
 else {
      if (values.length > 0) {
        List list=new ArrayList(values.length);
        for (int idx=0; idx < values.length; idx++) {
          list.add(values[idx]);
        }
        arrayReference.setValues(list);
      }
    }
  }
 catch (  ClassNotLoadedException ex) {
    final ReferenceType referenceType;
    try {
      referenceType=context.isAutoLoadClasses() ? debugProcess.loadClass(context,ex.className(),type.classLoader()) : null;
    }
 catch (    InvocationException e) {
      throw EvaluateExceptionUtil.createEvaluateException(e);
    }
catch (    ClassNotLoadedException e) {
      throw EvaluateExceptionUtil.createEvaluateException(e);
    }
catch (    IncompatibleThreadStateException e) {
      throw EvaluateExceptionUtil.createEvaluateException(e);
    }
catch (    InvalidTypeException e) {
      throw EvaluateExceptionUtil.createEvaluateException(e);
    }
    if (referenceType != null) {
      setInitialValues(arrayReference,values,context);
    }
 else {
      throw EvaluateExceptionUtil.createEvaluateException(DebuggerBundle.message("error.class.not.loaded",ex.className()));
    }
  }
catch (  InvalidTypeException ex) {
    throw EvaluateExceptionUtil.createEvaluateException(DebuggerBundle.message("evaluation.error.incompatible.array.initializer.type"));
  }
catch (  IndexOutOfBoundsException ex) {
    throw EvaluateExceptionUtil.createEvaluateException(DebuggerBundle.message("evaluation.error.invalid.array.size"));
  }
catch (  ClassCastException ex) {
    throw EvaluateExceptionUtil.createEvaluateException(DebuggerBundle.message("evaluation.error.cannot.initialize.array"));
  }
}
