{
  if (myPackageName != null) {
    CommandProcessor.getInstance().executeCommand(facet.getModule().getProject(),new ExternalChangeAction(){
      public void run(){
        Runnable action=new Runnable(){
          public void run(){
            PsiDirectory packageDir=createPackageIfPossible(sourceDir,myPackageName);
            if (packageDir == null)             return;
            final Manifest manifest=facet.getManifest();
            if (manifest != null) {
              manifest.getPackage().setValue(myPackageName);
              final Module module=facet.getModule();
              final Project project=module.getProject();
              StartupManager.getInstance(project).runWhenProjectIsInitialized(new Runnable(){
                public void run(){
                  FileDocumentManager.getInstance().saveAllDocuments();
                }
              }
);
              assignApplicationName(facet);
              Sdk sdk=getAndroidSdkForModule(module);
              if (sdk != null) {
                final AndroidPlatform platform=AndroidPlatform.parse(sdk);
                if (platform != null) {
                  configureManifest(facet,platform.getTarget());
                }
              }
            }
          }
        }
;
        ApplicationManager.getApplication().runWriteAction(action);
      }
    }
,AndroidBundle.message("build.android.module.process.title"),null);
  }
}
