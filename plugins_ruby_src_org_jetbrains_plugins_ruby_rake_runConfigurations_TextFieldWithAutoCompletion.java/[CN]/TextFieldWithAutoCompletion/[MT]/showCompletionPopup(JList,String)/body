{
  final Runnable chooseCallback=new Runnable(){
    public void run(){
      final String selectedValue=(String)list.getSelectedValue();
      if (selectedValue != null) {
        setText(selectedValue);
      }
      IdeFocusManager.getInstance(myProject).requestFocus(TextFieldWithAutoCompletion.this,true);
    }
  }
;
  final PopupChooserBuilder builder=JBPopupFactory.getInstance().createListPopupBuilder(list);
  if (title != null) {
    builder.setTitle(title);
  }
  final JBPopup popup=builder.setMovable(false).setResizable(false).setRequestFocus(true).setItemChoosenCallback(chooseCallback).setCancelKeyEnabled(false).createPopup();
  popup.showUnderneathOf(this);
}
