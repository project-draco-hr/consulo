{
  myProject.getMessageBus().connect().subscribe(DumbService.DUMB_MODE,new DumbService.DumbModeListener(){
    boolean myFirstNotification=true;
    BalloonHandler myHandler;
    public void enteredDumbMode(){
      final boolean first=myFirstNotification;
      myFirstNotification=false;
      myAlarm.addRequest(new Runnable(){
        public void run(){
          myHandler=DumbService.getInstance(myProject).showDumbModeNotification("Updating project indices...<br>" + "Refactorings, usage search and some other features will become available after indexing is complete");
        }
      }
,first ? 10000 : 1000);
    }
    public void exitDumbMode(){
      myAlarm.cancelAllRequests();
      if (myHandler != null)       myHandler.hide();
      myHandler=null;
      FileEditorManagerEx.getInstanceEx(myProject).refreshIcons();
    }
  }
);
}
