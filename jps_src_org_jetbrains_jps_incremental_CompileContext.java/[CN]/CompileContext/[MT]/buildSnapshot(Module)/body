{
  final Set<File> excludes=new HashSet<File>();
  for (  String excludePath : (Collection<String>)module.getExcludes()) {
    excludes.add(new File(excludePath));
  }
  final FSSnapshot snapshot=new FSSnapshot(module);
  final Collection<String> roots=myCompilingTests ? (Collection<String>)module.getTestRoots() : (Collection<String>)module.getSourceRoots();
  for (  String srcRoot : roots) {
    final FSSnapshot.Root root=snapshot.addRoot(new File(srcRoot),srcRoot);
    buildStructure(root.getNode(),excludes);
  }
  return snapshot;
}
