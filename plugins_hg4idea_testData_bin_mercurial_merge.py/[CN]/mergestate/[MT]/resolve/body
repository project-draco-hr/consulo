def resolve(self, dfile, wctx, octx):
    if (self[dfile] == 'r'):
        return 0
    (state, hash, lfile, afile, anode, ofile, flags) = self._state[dfile]
    f = self._repo.opener(('merge/' + hash))
    self._repo.wwrite(dfile, f.read(), flags)
    fcd = wctx[dfile]
    fco = octx[ofile]
    fca = self._repo.filectx(afile, fileid=anode)
    r = filemerge.filemerge(self._repo, self._local, lfile, fcd, fco, fca)
    if (not r):
        self.mark(dfile, 'r')
    return r
