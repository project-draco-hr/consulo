def _forgetremoved(wctx, mctx, branchmerge):
    "\n    Forget removed files\n\n    If we're jumping between revisions (as opposed to merging), and if\n    neither the working directory nor the target rev has the file,\n    then we need to remove it from the dirstate, to prevent the\n    dirstate from listing the file when it is no longer in the\n    manifest.\n\n    If we're merging, and the other revision has removed a file\n    that is not present in the working directory, we need to mark it\n    as removed.\n    "
    action = []
    state = ((branchmerge and 'r') or 'f')
    for f in wctx.deleted():
        if (f not in mctx):
            action.append((f, state))
    if (not branchmerge):
        for f in wctx.removed():
            if (f not in mctx):
                action.append((f, 'f'))
    return action
