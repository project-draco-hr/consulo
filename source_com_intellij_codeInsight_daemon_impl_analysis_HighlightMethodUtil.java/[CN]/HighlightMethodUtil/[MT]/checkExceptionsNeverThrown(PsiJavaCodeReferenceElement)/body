{
  if (!DaemonCodeAnalyzerSettings.getInstance().getInspectionProfile().isToolEnabled(HighlightDisplayKey.UNUSED_THROWS_DECL)) {
    return null;
  }
  if (!(referenceElement.getParent() instanceof PsiReferenceList))   return null;
  PsiReferenceList referenceList=(PsiReferenceList)referenceElement.getParent();
  if (!(referenceList.getParent() instanceof PsiMethod))   return null;
  PsiMethod method=(PsiMethod)referenceList.getParent();
  if (referenceList != method.getThrowsList())   return null;
  if (!InspectionManagerEx.isToCheckMember(method,HighlightDisplayKey.UNUSED_THROWS_DECL.toString()))   return null;
  PsiClass aClass=method.getContainingClass();
  if (aClass == null)   return null;
  PsiManager manager=referenceElement.getManager();
  PsiClassType exceptionType=manager.getElementFactory().createType(referenceElement);
  if (ExceptionUtil.isUncheckedExceptionOrSuperclass(exceptionType))   return null;
  PsiCodeBlock body=method.getBody();
  if (body == null)   return null;
  PsiModifierList modifierList=method.getModifierList();
  PsiClass containingClass=method.getContainingClass();
  if (!modifierList.hasModifierProperty(PsiModifier.PRIVATE) && !modifierList.hasModifierProperty(PsiModifier.STATIC) && !modifierList.hasModifierProperty(PsiModifier.FINAL)&& !method.isConstructor()&& !(containingClass instanceof PsiAnonymousClass)&& !(containingClass != null && containingClass.hasModifierProperty(PsiModifier.FINAL))) {
    return null;
  }
  PsiClassType[] types=ExceptionUtil.collectUnhandledExceptions(body,method);
  Collection<PsiClassType> unhandled=new HashSet<PsiClassType>(Arrays.asList(types));
  if (method.isConstructor()) {
    PsiField[] fields=aClass.getFields();
    for (    final PsiField field : fields) {
      if (field.hasModifierProperty(PsiModifier.STATIC))       continue;
      PsiExpression initializer=field.getInitializer();
      if (initializer == null)       continue;
      unhandled.addAll(Arrays.asList(ExceptionUtil.collectUnhandledExceptions(initializer,field)));
    }
  }
  for (  PsiClassType unhandledException : unhandled) {
    if (unhandledException.isAssignableFrom(exceptionType) || exceptionType.isAssignableFrom(unhandledException)) {
      return null;
    }
  }
  String description=MessageFormat.format(EXCEPTION_NEVER_THROWN_IN_METHOD,new Object[]{HighlightUtil.formatType(exceptionType)});
  HighlightInfo errorResult=HighlightInfo.createHighlightInfo(HighlightInfoType.UNUSED_THROWS_DECL,referenceElement,description);
  List<IntentionAction> options=new ArrayList<IntentionAction>();
  options.add(new AddNoInspectionDocTagAction(HighlightDisplayKey.UNUSED_THROWS_DECL,method.getBody()));
  options.add(new AddNoInspectionAllForClassAction(method.getBody()));
  options.add(new SwitchOffToolAction(HighlightDisplayKey.UNUSED_THROWS_DECL));
  QuickFixAction.registerQuickFixAction(errorResult,new MethodThrowsFix(method,exceptionType,false),options);
  return errorResult;
}
