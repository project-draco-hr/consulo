{
  ApplicationManager.getApplication().assertIsDispatchThread();
  if (LOG.isDebugEnabled()) {
    LOG.debug("executeCommand: " + command + ", name = "+ name+ ", groupId = "+ groupId);
  }
  if (myCurrentCommand != null) {
    command.run();
    return;
  }
  try {
    myCurrentCommand=new CommandDescriptor(command,project,name,groupId,undoConfirmationPolicy);
    fireCommandStarted();
    command.run();
  }
 catch (  Exception e) {
    LOG.error(e);
  }
 finally {
    final PostprocessReformatingAspect component=project.getComponent(PostprocessReformatingAspect.class);
    component.doPostponedFormatting();
    _fireCommandFinished();
  }
}
