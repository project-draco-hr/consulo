{
  if (s1 == null || s2 == null)   return false;
  if (s1 == s2)   return true;
  if (s1.length() != s2.length())   return false;
  int len=s1.length();
  if (len > COMPARISON_THRESHOLD && s1 instanceof String && s2 instanceof String) {
    return s1.equals(s2);
  }
  for (int i=0; i < len; i++) {
    if (s1.charAt(i) != s2.charAt(i))     return false;
  }
  return true;
}
