{
  List variables=new ArrayList();
  PsiStatement[] statements=method.getBody().getStatements();
  for (  PsiStatement statement : statements) {
    if (statement instanceof PsiDeclarationStatement) {
      PsiElement[] declaredElements=((PsiDeclarationStatement)statement).getDeclaredElements();
      for (      PsiElement declaredElement : declaredElements) {
        if (declaredElement instanceof PsiLocalVariable)         variables.add(declaredElement);
      }
    }
  }
  PsiParameter[] parameters=method.getParameterList().getParameters();
  ContainerUtil.addAll(variables,parameters);
  return (PsiVariable[])variables.toArray(new PsiVariable[variables.size()]);
}
