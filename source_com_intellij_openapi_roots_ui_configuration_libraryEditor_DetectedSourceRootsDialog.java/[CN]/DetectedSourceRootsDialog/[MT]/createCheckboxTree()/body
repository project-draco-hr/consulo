{
  CheckboxTree tree=new CheckboxTree(new CheckboxTree.CheckboxTreeCellRenderer(true){
    public void customizeCellRenderer(    JTree tree,    Object value,    boolean selected,    boolean expanded,    boolean leaf,    int row,    boolean hasFocus){
      CheckedTreeNode node=(CheckedTreeNode)value;
      VirtualFile file=(VirtualFile)node.getUserObject();
      String text;
      SimpleTextAttributes attributes;
      Icon icon;
      if (leaf) {
        VirtualFile ancestor=(VirtualFile)((CheckedTreeNode)node.getParent()).getUserObject();
        text=VfsUtil.getRelativePath(file,ancestor,File.separatorChar);
        attributes=SimpleTextAttributes.REGULAR_ATTRIBUTES;
        icon=Icons.DIRECTORY_CLOSED_ICON;
      }
 else {
        text=file == null ? "found files" : file.getPresentableUrl();
        attributes=SimpleTextAttributes.REGULAR_BOLD_ATTRIBUTES;
        icon=expanded ? Icons.DIRECTORY_OPEN_ICON : Icons.DIRECTORY_CLOSED_ICON;
      }
      final ColoredTreeCellRenderer textRenderer=getTextRenderer();
      textRenderer.setIcon(icon);
      textRenderer.append(text,attributes);
    }
  }
,myRootNode);
  tree.setRootVisible(false);
  TreeUtil.expandAll(tree);
  return tree;
}
