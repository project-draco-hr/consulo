{
  final int WAIT_INTERVAL=100;
  int waitingTime=0;
  boolean setExitCode=true;
  startNotify();
  while (!waitFor(WAIT_INTERVAL)) {
    waitingTime+=WAIT_INTERVAL;
    boolean timeout=waitingTime >= timeoutInMilliseconds;
    boolean canceled=indicator.isCanceled();
    if (canceled || timeout) {
      boolean destroying=canceled || destroyOnTimeout;
      setExitCode=destroying;
      if (destroying && !isProcessTerminating() && !isProcessTerminated()) {
        destroyProcess();
      }
      if (canceled) {
        myOutput.setCancelled();
      }
 else {
        myOutput.setTimeout();
      }
      break;
    }
  }
  if (setExitCode) {
    if (waitFor()) {
      setErrorCodeIfNotYetSet();
    }
 else {
      LOG.info("runProcess: exit value unavailable");
    }
  }
  return myOutput;
}
