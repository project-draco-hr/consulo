{
  Integer exitCode=waitFor(process,timeoutMillis);
  if (exitCode != null) {
    return exitCode;
  }
  LOG.warn("shell env loader is timed out");
  UnixProcessManager.sendSigIntToProcessTree(process);
  exitCode=waitFor(process,1000);
  if (exitCode != null) {
    return exitCode;
  }
  LOG.warn("failed to terminate shell env loader process gracefully, terminating forcibly");
  UnixProcessManager.sendSigKillToProcessTree(process);
  exitCode=waitFor(process,1000);
  if (exitCode != null) {
    return exitCode;
  }
  LOG.warn("failed to kill shell env loader");
  return -1;
}
