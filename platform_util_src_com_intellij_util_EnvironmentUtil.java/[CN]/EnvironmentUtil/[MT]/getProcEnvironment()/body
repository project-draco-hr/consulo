{
  List procEnvironment=new ArrayList();
  try {
    String[] procEnvCommand=getProcEnvCommand();
    Process process=Runtime.getRuntime().exec(procEnvCommand);
    if (process == null)     return null;
    InputStream processIn=process.getInputStream();
    ByteArrayOutputStream out=new ByteArrayOutputStream();
    while (true) {
      int b=processIn.read();
      if (b < 0)       break;
      out.write(b);
    }
    int exitCode=process.waitFor();
    if (exitCode < 0)     return null;
    BufferedReader in=new BufferedReader(new StringReader(out.toString()));
    String var=null;
    String line;
    String lineSep=SystemProperties.getLineSeparator();
    while ((line=in.readLine()) != null) {
      if (line.indexOf('=') == -1) {
        if (var == null) {
          var=lineSep + line;
        }
 else {
          var+=lineSep + line;
        }
      }
 else {
        if (var != null) {
          procEnvironment.add(var);
        }
        var=line;
      }
    }
    if (var != null) {
      procEnvironment.add(var);
    }
  }
 catch (  Throwable exc) {
    LOG.debug(exc);
  }
  return procEnvironment;
}
