{
  PsiElement target=null;
  final PsiMember[] targetElements=getTargetElements(file,editor);
  if (targetElements == null || targetElements.length == 0)   return null;
  if (!ApplicationManager.getApplication().isUnitTestMode()) {
    MemberChooser chooser=new MemberChooser(targetElements,false,false,project);
    chooser.setTitle(CodeInsightBundle.message("generate.delegate.target.chooser.title"));
    chooser.setCopyJavadocVisible(false);
    chooser.show();
    if (chooser.getExitCode() != MemberChooser.OK_EXIT_CODE)     return null;
    final Object[] selectedElements=chooser.getSelectedElements();
    if (selectedElements != null && selectedElements.length > 0)     target=(PsiElement)selectedElements[0];
  }
 else {
    target=targetElements[0];
  }
  return target;
}
