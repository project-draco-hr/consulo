{
synchronized (myFilesToRefresh) {
    if (myFilesToRefresh.add(fileToRefresh)) {
      myUpdateProblemAlarm.cancelAllRequests();
      myUpdateProblemAlarm.addRequest(new Runnable(){
        public void run(){
          if (!myProject.isOpen())           return;
          Set<VirtualFile> filesToRefresh;
synchronized (myFilesToRefresh) {
            filesToRefresh=new THashSet<VirtualFile>(myFilesToRefresh);
          }
          updateNodesContaining(filesToRefresh,myRootNode);
synchronized (myFilesToRefresh) {
            myFilesToRefresh.removeAll(filesToRefresh);
          }
        }
      }
,200,ModalityState.NON_MODAL);
    }
  }
}
