{
  super(project,tree,treeModel,treeStructure,comparator);
  myPsiTreeChangeListener=new ProjectViewPsiTreeChangeListener(){
    protected DefaultMutableTreeNode getRootNode(){
      return myRootNode;
    }
    protected AbstractTreeUpdater getUpdater(){
      return myUpdater;
    }
    protected boolean isFlattenPackages(){
      return ((AbstractProjectTreeStructure)getTreeStructure()).isFlattenPackages();
    }
  }
;
  myModuleRootListener=new ModuleRootListener(){
    public void beforeRootsChange(    ModuleRootEvent event){
    }
    public void rootsChanged(    ModuleRootEvent event){
      myUpdater.addSubtreeToUpdate(myRootNode);
    }
  }
;
  PsiManager.getInstance(myProject).addPsiTreeChangeListener(myPsiTreeChangeListener);
  ProjectRootManager.getInstance(myProject).addModuleRootListener(myModuleRootListener);
  myFileStatusListener=new MyFileStatusListener();
  FileStatusManager.getInstance(myProject).addFileStatusListener(myFileStatusListener);
  myCopyPasteListener=new CopyPasteUtil.DefaultCopyPasteListener(myUpdater);
  CopyPasteManager.getInstance().addContentChangedListener(myCopyPasteListener);
  myPropertiesFileListener=new PropertiesFileListener();
  PropertiesFilesManager.getInstance().addPropertiesFileListener(myPropertiesFileListener);
  initRootNode();
}
