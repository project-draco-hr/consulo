{
  ProjectManager.getInstance().addProjectManagerListener(new ProjectManagerAdapter(){
    @Override public void projectClosing(    Project project){
      CompletionProgressIndicator indicator=getCurrentCompletion();
      if (indicator != null && indicator.getProject() == project) {
        LookupManager.getInstance(indicator.getProject()).hideActiveLookup();
        setCompletionPhase(CompletionPhase.NoCompletion);
      }
 else       if (indicator == null) {
        setCompletionPhase(CompletionPhase.NoCompletion);
      }
    }
  }
);
}
