{
  ApplicationManager.getApplication().assertIsDispatchThread();
  Document hostDocument=document instanceof DocumentRange ? ((DocumentRange)document).getDelegate() : document;
  EditorImpl editor=new EditorImpl(hostDocument,isViewer,project);
  myEditors.add(editor);
  myEditorEventMulticaster.registerEditor(editor);
  myEditorFactoryEventDispatcher.getMulticaster().editorCreated(new EditorFactoryEvent(this,editor));
  if (LOG.isDebugEnabled()) {
    LOG.debug("number of Editor's:" + myEditors.size());
  }
  final ByteArrayOutputStream buffer=new ByteArrayOutputStream();
  final PrintWriter printWriter=new PrintWriter(buffer);
  new RuntimeException("Editor created").printStackTrace(printWriter);
  printWriter.flush();
  editor.putUserData(EDITOR_CREATOR,buffer.toString());
  return editor;
}
