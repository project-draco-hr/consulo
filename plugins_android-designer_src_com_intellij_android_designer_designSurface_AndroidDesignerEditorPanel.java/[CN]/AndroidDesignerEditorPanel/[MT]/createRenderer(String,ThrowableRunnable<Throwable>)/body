{
  if (mySession == null) {
    ApplicationManager.getApplication().invokeLater(new Runnable(){
      @Override public void run(){
        if (mySession == null) {
          showProgress("Create RenderLib");
        }
      }
    }
,new Condition(){
      @Override public boolean value(      Object o){
        return mySession != null;
      }
    }
);
  }
 else {
    disposeSession();
  }
  ApplicationManager.getApplication().executeOnPooledThread(new Runnable(){
    @Override public void run(){
      try {
        AndroidPlatform platform=AndroidPlatform.getInstance(myModule);
        if (platform == null) {
          throw new AndroidSdkNotConfiguredException();
        }
        IAndroidTarget target=platform.getTarget();
        AndroidFacet facet=AndroidFacet.getInstance(myModule);
        LayoutDeviceManager layoutDeviceManager=new LayoutDeviceManager();
        layoutDeviceManager.loadDevices(platform.getSdkData());
        LayoutDevice layoutDevice=layoutDeviceManager.getCombinedList().get(0);
        LayoutDeviceConfiguration deviceConfiguration=layoutDevice.getConfigurations().get(0);
        FolderConfiguration config=new FolderConfiguration();
        config.set(deviceConfiguration.getConfiguration());
        config.setUiModeQualifier(new UiModeQualifier(UiMode.NORMAL));
        config.setNightModeQualifier(new NightModeQualifier(NightMode.NIGHT));
        config.setLanguageQualifier(new LanguageQualifier());
        config.setRegionQualifier(new RegionQualifier());
        float xdpi=deviceConfiguration.getDevice().getXDpi();
        float ydpi=deviceConfiguration.getDevice().getYDpi();
        ThemeData theme=new ThemeData("Theme",false);
        mySession=RenderUtil.createRenderSession(getProject(),layoutXmlText,myFile,target,facet,config,xdpi,ydpi,theme);
        ApplicationManager.getApplication().invokeLater(new Runnable(){
          @Override public void run(){
            try {
              hideProgress();
              runnable.run();
            }
 catch (            Throwable e) {
              showError("Parse error: ",e);
            }
          }
        }
);
      }
 catch (      final Throwable e) {
        ApplicationManager.getApplication().invokeLater(new Runnable(){
          @Override public void run(){
            showError("Render session error: ",e);
          }
        }
);
      }
    }
  }
);
}
