{
  if (shallNotWatch())   return;
  deleteOldThreadDumps();
  myLogDir=new File(PathManager.getSystemPath() + "/log/threadDumps-" + myDateFormat.format(new Date()));
  myLogDir.mkdirs();
  myThreadMXBean=ManagementFactory.getThreadMXBean();
  try {
    myDumpAllThreadsMethod=ThreadMXBean.class.getMethod("dumpAllThreads",boolean.class,boolean.class);
  }
 catch (  NoSuchMethodException e) {
    myDumpAllThreadsMethod=null;
  }
  try {
    myShutdownSemaphore.acquire();
  }
 catch (  InterruptedException e) {
  }
  myThread=new Thread(new Runnable(){
    public void run(){
      checkEDTResponsiveness();
    }
  }
,"Performance watcher");
  myThread.start();
}
