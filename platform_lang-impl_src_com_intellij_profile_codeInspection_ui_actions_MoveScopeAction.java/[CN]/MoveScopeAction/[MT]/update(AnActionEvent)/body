{
  final Presentation presentation=e.getPresentation();
  presentation.setEnabled(false);
  if (getSelectedProfile() == null)   return;
  final InspectionConfigTreeNode[] nodes=myTree.getSelectedNodes(InspectionConfigTreeNode.class,null);
  if (nodes.length > 0) {
    final InspectionConfigTreeNode treeNode=nodes[0];
    if (treeNode.getScope(getEventProject(e)) != null && !treeNode.isByDefault()) {
      final TreeNode parent=treeNode.getParent();
      final int index=parent.getIndex(treeNode);
      presentation.setEnabled(isEnabledFor(index,(InspectionConfigTreeNode)parent));
    }
  }
}
