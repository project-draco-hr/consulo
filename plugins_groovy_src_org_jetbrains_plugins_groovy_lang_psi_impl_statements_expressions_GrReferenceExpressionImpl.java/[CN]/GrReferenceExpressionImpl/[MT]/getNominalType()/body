{
  final GroovyResolveResult resolveResult=advancedResolve();
  PsiElement resolved=resolveResult.getElement();
  for (  GrReferenceTypeEnhancer enhancer : GrReferenceTypeEnhancer.EP_NAME.getExtensions()) {
    PsiType type=enhancer.getReferenceType(this,resolved);
    if (type != null) {
      return type;
    }
  }
  IElementType dotType=getDotTokenType();
  if (dotType == mMEMBER_POINTER) {
    return GrClosureType.create(multiResolve(false),this);
  }
  PsiType result=getNominalTypeInner(resolved);
  if (result == null)   return null;
  result=TypesUtil.substituteBoxAndNormalizeType(result,resolveResult.getSubstitutor(),resolveResult.getSpreadState(),this);
  return result;
}
