{
  if (getQualifier() != null) {
    throw new IncorrectOperationException("Reference has qualifier");
  }
  if (StringUtil.isEmpty(getReferenceName())) {
    throw new IncorrectOperationException("Reference has empty name");
  }
  PsiClass containingClass=member.getContainingClass();
  if (containingClass == null) {
    throw new IncorrectOperationException("Member has no containing class");
  }
  final PsiFile file=getContainingFile();
  if (file instanceof GroovyFile) {
    GroovyPsiElementFactory factory=GroovyPsiElementFactory.getInstance(getProject());
    String text="import static " + containingClass.getQualifiedName() + "."+ member.getName();
    final GrImportStatement statement=factory.createImportStatementFromText(text);
    ((GroovyFile)file).addImport(statement);
  }
  return this;
}
