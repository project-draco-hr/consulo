{
  if (isQualified()) {
    final GrExpression qualifierExpression=getQualifierExpression();
    if (qualifierExpression instanceof GrReferenceExpression) {
      final PsiElement dotToken=getDotToken();
      return ((GrReferenceExpression)qualifierExpression).getCanonicalText() + dotToken.getText() + getName();
    }
  }
 else {
    final PsiElement resolvedRefExpr=resolve();
    if (resolvedRefExpr == null)     return getName();
    if (resolvedRefExpr instanceof PsiClass)     return ((PsiClass)resolvedRefExpr).getQualifiedName();
    if (resolvedRefExpr instanceof PsiMember)     return ((PsiMember)resolvedRefExpr).getContainingClass().getQualifiedName() + "." + getName();
  }
  return getName();
}
