{
  if (files.isEmpty())   return;
  Map<VirtualFile,MavenProject> readProjects=new LinkedHashMap<VirtualFile,MavenProject>();
  Stack<MavenProject> updateStack=new Stack<MavenProject>();
  for (  VirtualFile each : files) {
    MavenProject mavenProject=findProject(each);
    if (mavenProject == null) {
      doAdd(projectReader,each,readProjects,updateStack,generalSettings,process,recursive);
    }
 else {
      doUpdate(projectReader,findAggregator(mavenProject),mavenProject,false,readProjects,updateStack,generalSettings,process,recursive);
    }
  }
  fireProjectsRead(new ArrayList<MavenProject>(readProjects.values()));
}
