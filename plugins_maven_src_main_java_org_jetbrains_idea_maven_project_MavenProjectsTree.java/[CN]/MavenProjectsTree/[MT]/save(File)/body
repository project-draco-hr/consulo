{
  file.getParentFile().mkdirs();
  FileOutputStream fs=new FileOutputStream(file);
  DataOutputStream out=new DataOutputStream(fs);
  try {
    out.writeUTF(VERSION);
    writeList(out,myManagedFilesPaths);
    writeList(out,myActiveProfiles);
    out.writeLong(myLastGlobalSettingsTimestamp);
    out.writeLong(myLastUserSettingsTimestamp);
    writeProjectsRecursively(out,myRootProjects);
  }
  finally {
    out.close();
    fs.close();
  }
}
