{
  List<String> availableProfiles=getAvailableProfiles();
synchronized (myStateLock) {
    List<String> removedProfiles=new ArrayList<String>(myActiveProfiles);
    removedProfiles.removeAll(availableProfiles);
    myTemporarilyRemovedProfiles.addAll(removedProfiles);
    List<String> restoredProfiles=new ArrayList<String>(myTemporarilyRemovedProfiles);
    restoredProfiles.retainAll(availableProfiles);
    myTemporarilyRemovedProfiles.removeAll(restoredProfiles);
    myActiveProfiles.removeAll(removedProfiles);
    myActiveProfiles.addAll(restoredProfiles);
  }
}
