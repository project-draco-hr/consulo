{
  for (  MavenProject each : getModules(project)) {
    doRemove(project,each,removedProjects);
  }
  writeLock();
  try {
    if (aggregator != null) {
      removeModule(aggregator,project);
    }
 else {
      myRootProjects.remove(project);
    }
    myVirtualFileToProjectMapping.remove(project.getFile());
    myMavenIdToProjectMapping.remove(project.getMavenId());
    myAggregatorToModuleMapping.remove(project);
    myModuleToAggregatorMapping.remove(project);
  }
  finally {
    writeUnlock();
  }
  removedProjects.add(project);
  fireRemoved(project);
}
