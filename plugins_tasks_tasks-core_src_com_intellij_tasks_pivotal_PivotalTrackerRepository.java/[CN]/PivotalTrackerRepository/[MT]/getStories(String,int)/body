{
  String url=API_URL + "/projects/" + myProjectId+ "/stories";
  url+="?filter=" + encodeUrl("state:started,unstarted,unscheduled,rejected");
  if (!StringUtil.isEmpty(query)) {
    url+=encodeUrl(" \"" + query + '"');
  }
  if (max >= 0) {
    url+="&limit=" + encodeUrl(String.valueOf(max));
  }
  LOG.info("Getting all the stories with url: " + url);
  final HttpMethod method=doREST(url,HTTPMethod.GET);
  final InputStream stream=method.getResponseBodyAsStream();
  final Element element=new SAXBuilder(false).build(stream).getRootElement();
  if (!"stories".equals(element.getName())) {
    LOG.warn("Error fetching issues for: " + url + ", HTTP status code: "+ method.getStatusCode());
    throw new Exception("Error fetching issues for: " + url + ", HTTP status code: "+ method.getStatusCode()+ "\n"+ element.getText());
  }
  return element.getChildren("story");
}
