{
  final VirtualFile selected=myFileSystemTree.getSelectedFile();
  if (selected != null && !selected.isDirectory()) {
    return new File(selected.getPath());
  }
  String path=(selected == null) ? myPathTextField.getTextFieldText() : selected.getPath();
  final File dir=new File(path);
  if (!dir.exists() || path == null)   return null;
  if (dir.isDirectory()) {
    path+=File.separator + myFileName.getText();
  }
  boolean correctExt=true;
  for (  String ext : myDescriptor.getFileExtensions()) {
    correctExt=path.endsWith("." + ext);
    if (correctExt)     break;
  }
  if (!correctExt) {
    path+="." + myExtentions.getSelectedItem();
  }
  return new File(path);
}
