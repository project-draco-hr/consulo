{
  ProgressIndicator indicator=ProgressManager.getInstance().getProgressIndicator();
  String fullPath=folder + File.separator + fileName;
  if (indicator != null) {
    ProgressManager.getInstance().checkCanceled();
    indicator.setText(InspectionsBundle.message("inspection.export.generating.html.for",fullPath));
  }
  try {
    File myFolder=new File(folder);
    myFolder.mkdirs();
    FileWriter myWriter=new FileWriter(fullPath);
    myWriter.write(buf.toString().toCharArray());
    myWriter.close();
  }
 catch (  IOException e) {
    Messages.showMessageDialog(project,InspectionsBundle.message("inspection.export.error.writing.to",fullPath),InspectionsBundle.message("inspection.export.results.error.title"),Messages.getErrorIcon());
    throw new ProcessCanceledException();
  }
}
