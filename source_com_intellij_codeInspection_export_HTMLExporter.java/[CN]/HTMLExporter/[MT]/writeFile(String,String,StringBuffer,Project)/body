{
  ProgressIndicator indicator=ProgressManager.getInstance().getProgressIndicator();
  String fullPath=folder + File.separator + fileName;
  if (indicator != null) {
    ProgressManager.getInstance().checkCanceled();
    indicator.setText("Generating HTML:" + fullPath);
  }
  try {
    File myFolder=new File(folder);
    myFolder.mkdirs();
    FileWriter myWriter=new FileWriter(fullPath);
    myWriter.write(buf.toString().toCharArray());
    myWriter.close();
  }
 catch (  IOException e) {
    Messages.showMessageDialog(project,"Error writing to " + fullPath,"Inspection Results Export",Messages.getErrorIcon());
    throw new ProcessCanceledException();
  }
}
