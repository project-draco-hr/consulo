{
  final String baseName=BASE_PATH + getTestName(false);
  configureByFiles(null,getVirtualFile(baseName + ".xml"),getVirtualFile(baseName + ".dtd"),getVirtualFile(baseName + ".ent"));
  doDoTest(true,false);
  final List<PsiReference> refs=new ArrayList<PsiReference>();
  myFile.accept(new XmlRecursiveElementVisitor(){
    @Override public void visitXmlAttribute(    final XmlAttribute attribute){
      refs.add(attribute.getReference());
    }
    @Override public void visitXmlTag(    final XmlTag tag){
      refs.add(tag.getReference());
      super.visitXmlTag(tag);
    }
  }
);
  assertEquals(2,refs.size());
  for (  PsiReference ref : refs) {
    final PsiElement element=ref.resolve();
    assertTrue(element instanceof PsiNamedElement);
    assertSame(element.getNavigationElement(),element);
    assertTrue(!element.isPhysical());
    final PsiElement original=element.getOriginalElement();
    if (original != element && !(element instanceof XmlAttlistDecl)) {
      assertNotNull(original);
      assertTrue(original.isPhysical());
    }
  }
}
