{
  Change c=new DeleteChange(p("entry"));
  c.applyTo(new Snapshot(){
    @Override public Entry getEntry(    Path path){
      Entry e=new DirectoryEntry(1,"entry");
      e.addChild(new FileEntry(2,"file",""));
      e.addChild(new DirectoryEntry(3,"dir"));
      return e;
    }
  }
);
  os.writeChange(c);
  Entry result=((DeleteChange)is.readChange()).getAffectedEntry();
  assertEquals(DirectoryEntry.class,result.getClass());
  assertEquals("entry",result.getName());
  assertEquals(2,result.getChildren().size());
  assertEquals("file",result.getChildren().get(0).getName());
  assertEquals("dir",result.getChildren().get(1).getName());
}
