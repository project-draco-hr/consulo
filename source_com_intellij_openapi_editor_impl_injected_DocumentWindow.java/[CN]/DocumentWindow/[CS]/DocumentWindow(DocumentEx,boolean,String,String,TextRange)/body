{
  myDelegate=delegate;
  myOneLine=oneLine;
  myPrefix=prefix;
  mySuffix=suffix;
  myHostRanges=new RangeMarker[ranges.length];
  for (int i=0; i < ranges.length; i++) {
    TextRange range=ranges[i];
    RangeMarker rangeMarker=delegate.createRangeMarker(range);
    rangeMarker.setGreedyToLeft(true);
    rangeMarker.setGreedyToRight(true);
    myHostRanges[i]=rangeMarker;
  }
  myPrefixLineCount=Math.max(1,new DocumentImpl(myPrefix).getLineCount());
  mySuffixLineCount=Math.max(1,new DocumentImpl(mySuffix).getLineCount());
}
