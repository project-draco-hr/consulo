{
  if (hostOffset < myHostRanges[0].getStartOffset())   return myPrefix.length();
  int offset=myPrefix.length();
  for (  RangeMarker currentRange : myHostRanges) {
    if (currentRange.getStartOffset() <= hostOffset && hostOffset < currentRange.getEndOffset()) {
      return offset + hostOffset - currentRange.getStartOffset();
    }
    offset+=currentRange.getEndOffset() - currentRange.getStartOffset();
  }
  return getTextLength() - mySuffix.length();
}
