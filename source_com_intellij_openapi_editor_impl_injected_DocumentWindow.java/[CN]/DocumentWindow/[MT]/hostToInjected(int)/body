{
  if (hostOffset < myRelevantRangesInHostDocument[0].getStartOffset())   return myPrefixes[0].length();
  int offset=0;
  for (int i=0; i < myRelevantRangesInHostDocument.length; i++) {
    offset+=myPrefixes[i].length();
    RangeMarker currentRange=myRelevantRangesInHostDocument[i];
    if (hostOffset < currentRange.getEndOffset()) {
      return offset + hostOffset - currentRange.getStartOffset();
    }
    offset+=currentRange.getEndOffset() - currentRange.getStartOffset();
    offset+=mySuffixes[i].length();
  }
  return getTextLength() - mySuffixes[mySuffixes.length - 1].length();
}
