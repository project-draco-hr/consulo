{
  if (offset < myPrefixes[0].length())   return myHostRanges[0].getStartOffset();
  for (int i=0; i < myHostRanges.length; i++) {
    RangeMarker currentRange=myHostRanges[i];
    offset-=myPrefixes[i].length();
    int length=currentRange.getEndOffset() - currentRange.getStartOffset();
    if (offset < length || !strict && offset == length)     return currentRange.getStartOffset() + offset;
    offset-=length;
    offset-=mySuffixes[i].length();
  }
  return myHostRanges[myHostRanges.length - 1].getEndOffset();
}
