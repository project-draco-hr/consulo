{
  if (offset < myPrefix.length())   return myHostRanges[0].getStartOffset();
  offset-=myPrefix.length();
  for (  RangeMarker currentRange : myHostRanges) {
    int length=currentRange.getEndOffset() - currentRange.getStartOffset();
    if (offset < length || !strict && offset == length)     return currentRange.getStartOffset() + offset;
    offset-=length;
  }
  return myHostRanges[myHostRanges.length - 1].getEndOffset();
}
