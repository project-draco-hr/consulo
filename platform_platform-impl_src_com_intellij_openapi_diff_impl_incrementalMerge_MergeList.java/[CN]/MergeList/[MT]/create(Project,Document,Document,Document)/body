{
  MergeList mergeList=new MergeList(project,left,base,right);
  String leftText=left.getText();
  String baseText=base.getText();
  String rightText=right.getText();
  @NonNls final Object[] data={"Left\n",leftText,"\nBase\n",baseText,"\nRight\n",rightText};
  ContextLogger logger=new ContextLogger(LOG,new ContextLogger.SimpleContext(data));
  List<MergeBuilder.MergeFragment> fragmentList=processText(leftText,baseText,rightText,logger);
  ArrayList<Change> leftChanges=new ArrayList<Change>();
  ArrayList<Change> rightChanges=new ArrayList<Change>();
  final int fragmentsListSize=fragmentList.size();
  for (int i=0; i < fragmentsListSize; i++) {
    final MergeBuilder.MergeFragment mergeFragment=fragmentList.get(i);
    TextRange baseRange=mergeFragment.getBase();
    TextRange leftRange=mergeFragment.getLeft();
    TextRange rightRange=mergeFragment.getRight();
    if (leftRange == null) {
      if (rightRange == null) {
        if (i == fragmentsListSize - 1 && baseRange.getEndOffset() == baseText.length()) {
          final int rightTextLength=rightText.length();
          final int leftTextLength=leftText.length();
          rightChanges.add(SimpleChange.fromRanges(baseRange,new TextRange(rightTextLength,rightTextLength),mergeList.myChanges[1]));
          leftChanges.add(SimpleChange.fromRanges(baseRange,new TextRange(leftTextLength,leftTextLength),mergeList.myChanges[0]));
        }
 else {
          LOG.error("Left Text: " + leftText + "\n"+ "Right Text: "+ rightText+ "\nBase Text: "+ baseText);
        }
      }
 else {
        rightChanges.add(SimpleChange.fromRanges(baseRange,rightRange,mergeList.myChanges[1]));
      }
    }
 else     if (rightRange == null) {
      leftChanges.add(SimpleChange.fromRanges(baseRange,leftRange,mergeList.myChanges[0]));
    }
 else {
      Change[] changes=MergeConflict.createChanges(leftRange,baseRange,rightRange,mergeList);
      leftChanges.add(changes[0]);
      rightChanges.add(changes[1]);
    }
  }
  mergeList.myChanges[0].setChanges(leftChanges);
  mergeList.myChanges[1].setChanges(rightChanges);
  return mergeList;
}
