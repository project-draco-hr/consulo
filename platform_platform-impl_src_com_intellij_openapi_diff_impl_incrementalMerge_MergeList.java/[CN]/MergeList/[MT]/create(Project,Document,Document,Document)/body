{
  MergeList mergeList=new MergeList(project,left,base,right);
  String leftText=left.getText();
  String baseText=base.getText();
  String rightText=right.getText();
  @NonNls final Object[] data={"Left\n",leftText,"\nBase\n",baseText,"\nRight\n",rightText};
  ContextLogger logger=new ContextLogger(LOG,new ContextLogger.SimpleContext(data));
  List<MergeFragment> fragmentList=processText(leftText,baseText,rightText,logger);
  ArrayList<Change> leftChanges=new ArrayList<Change>();
  ArrayList<Change> rightChanges=new ArrayList<Change>();
  for (Iterator<MergeFragment> fragmentIterator=fragmentList.iterator(); fragmentIterator.hasNext(); ) {
    final MergeFragment mergeFragment=fragmentIterator.next();
    TextRange baseRange=mergeFragment.getBase();
    TextRange leftRange=mergeFragment.getLeft();
    TextRange rightRange=mergeFragment.getRight();
    if (leftRange == null) {
      if (rightRange == null) {
        if (!fragmentIterator.hasNext() && baseRange.getEndOffset() == baseText.length()) {
          final int rightTextLength=rightText.length();
          final int leftTextLength=leftText.length();
          rightChanges.add(SimpleChange.fromRanges(baseRange,new TextRange(rightTextLength,rightTextLength),mergeList.myBaseToRightChangeList));
          leftChanges.add(SimpleChange.fromRanges(baseRange,new TextRange(leftTextLength,leftTextLength),mergeList.myBaseToLeftChangeList));
        }
 else {
          LOG.error("Left Text: " + leftText + "\n"+ "Right Text: "+ rightText+ "\nBase Text: "+ baseText);
        }
      }
 else {
        rightChanges.add(SimpleChange.fromRanges(baseRange,rightRange,mergeList.myBaseToRightChangeList));
      }
    }
 else     if (rightRange == null) {
      leftChanges.add(SimpleChange.fromRanges(baseRange,leftRange,mergeList.myBaseToLeftChangeList));
    }
 else {
      MergeConflict conflict=new MergeConflict(baseRange,mergeList,leftRange,rightRange);
      leftChanges.add(conflict.getLeftChange());
      rightChanges.add(conflict.getRightChange());
    }
  }
  mergeList.myBaseToLeftChangeList.setChanges(leftChanges);
  mergeList.myBaseToRightChangeList.setChanges(rightChanges);
  return mergeList;
}
