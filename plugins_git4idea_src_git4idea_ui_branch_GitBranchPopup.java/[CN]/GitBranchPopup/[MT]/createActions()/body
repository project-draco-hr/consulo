{
  DefaultActionGroup popupGroup=new DefaultActionGroup(null,false);
  GitRepositoryManager repositoryManager=GitRepositoryManager.getInstance(myProject);
  if (repositoryManager.moreThanOneRoot()) {
    if (!myMultiRootBranchConfig.diverged() && userWantsSyncControl()) {
      fillWithCommonRepositoryActions(popupGroup,repositoryManager);
    }
 else {
      if (myMultiRootBranchConfig.diverged() && userWantsSyncControl()) {
        warnThatBranchesDiverged(popupGroup);
      }
      fillPopupWithCurrentRepositoryActions(popupGroup,createRepositoriesActions());
    }
  }
 else {
    fillPopupWithCurrentRepositoryActions(popupGroup,null);
  }
  popupGroup.addSeparator();
  return popupGroup;
}
