{
  final Map<GradleModule,Module> result=new HashMap<GradleModule,Module>();
  UIUtil.invokeAndWaitIfNeeded(new Runnable(){
    @Override public void run(){
      Application application=ApplicationManager.getApplication();
      AccessToken writeLock=application.acquireWriteActionLock(getClass());
      try {
        try {
          result.putAll(doImportModules(modules,model));
        }
  finally {
          model.commit();
        }
      }
  finally {
        writeLock.finish();
      }
    }
  }
);
  return result;
}
