{
  return new FutureTask<Boolean>(new Callable<Boolean>(){
    @Override public Boolean call() throws Exception {
      FormattingProgressIndicatorImpl.FORMATTING_CANCELLED_FLAG.set(false);
      try {
        TextRange range=myRange == null ? file.getTextRange() : myRange;
        CodeStyleManager.getInstance(myProject).reformatText(file,range.getStartOffset(),range.getEndOffset());
        return !FormattingProgressIndicatorImpl.FORMATTING_CANCELLED_FLAG.get();
      }
 catch (      IncorrectOperationException e) {
        LOG.error(e);
        return false;
      }
    }
  }
);
}
