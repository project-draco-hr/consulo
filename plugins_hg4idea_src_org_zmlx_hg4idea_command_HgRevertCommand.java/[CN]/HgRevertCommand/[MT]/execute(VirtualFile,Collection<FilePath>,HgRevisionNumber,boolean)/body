{
  final List<String> options=new LinkedList<String>();
  if (vcsRevisionNumber != null && !HgRevisionNumber.NULL_REVISION_NUMBER.equals(vcsRevisionNumber)) {
    options.add("--rev");
    if (!StringUtil.isEmptyOrSpaces(vcsRevisionNumber.getChangeset())) {
      options.add(vcsRevisionNumber.getChangeset());
    }
 else {
      options.add(vcsRevisionNumber.getRevision());
    }
  }
  if (!backupFile) {
    options.add("--no-backup");
  }
  for (  List<String> chunk : VcsFileUtil.chunkPaths(repo,files)) {
    List<String> args=new LinkedList<String>();
    args.addAll(options);
    args.addAll(chunk);
    new HgCommandExecutor(project).executeInCurrentThread(repo,"revert",args);
  }
  project.getMessageBus().syncPublisher(HgVcs.BRANCH_TOPIC).update(project);
}
