{
  String linkedExternalProjectPath=null;
  for (  ExternalSystemManager<?,?,?,?,?> manager : ExternalSystemApiUtil.getAllManagers()) {
    ProjectSystemId externalSystemId=manager.getSystemId();
    AbstractExternalSystemSettings systemSettings=ExternalSystemApiUtil.getSettings(ideProject,externalSystemId);
    Collection projectsSettings=systemSettings.getLinkedProjectsSettings();
    int linkedProjectsNumber=projectsSettings.size();
    if (linkedProjectsNumber > 1) {
      return false;
    }
 else     if (linkedProjectsNumber == 1) {
      if (linkedExternalProjectPath == null) {
        linkedExternalProjectPath=((ExternalProjectSettings)projectsSettings.iterator().next()).getExternalProjectPath();
      }
 else {
        return false;
      }
    }
  }
  ProjectData projectData=externalProject.getData();
  if (linkedExternalProjectPath != null && !linkedExternalProjectPath.equals(projectData.getLinkedExternalProjectPath())) {
    return false;
  }
  Set<String> externalModulePaths=ContainerUtilRt.newHashSet();
  for (  DataNode<ModuleData> moduleNode : ExternalSystemApiUtil.findAll(externalProject,ProjectKeys.MODULE)) {
    externalModulePaths.add(moduleNode.getData().getLinkedExternalProjectPath());
  }
  externalModulePaths.remove(linkedExternalProjectPath);
  for (  Module module : ModuleManager.getInstance(ideProject).getModules()) {
    String path=module.getOptionValue(ExternalSystemConstants.LINKED_PROJECT_PATH_KEY);
    if (!StringUtil.isEmpty(path) && !externalModulePaths.remove(path)) {
      return false;
    }
  }
  return externalModulePaths.isEmpty();
}
