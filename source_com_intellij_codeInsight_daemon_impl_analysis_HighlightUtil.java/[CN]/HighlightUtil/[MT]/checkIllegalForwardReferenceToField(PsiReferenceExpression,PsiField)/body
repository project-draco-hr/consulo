{
  final PsiClass containingClass=referencedField.getContainingClass();
  if (containingClass == null)   return null;
  if (expression.getContainingFile() != referencedField.getContainingFile())   return null;
  if (expression.getTextRange().getStartOffset() >= referencedField.getTextRange().getEndOffset())   return null;
  if (expression.getQualifierExpression() != null)   return null;
  final PsiField initField=findEnclosingFieldInitializer(expression);
  final PsiClassInitializer classInitializer=findParentClassInitializer(expression);
  if (initField == null && classInitializer == null)   return null;
  boolean isStaticClassInitializer=classInitializer != null && PsiUtil.hasModifierProperty(classInitializer,PsiModifier.STATIC);
  boolean isStaticInitField=initField != null && PsiUtil.hasModifierProperty(initField,PsiModifier.STATIC);
  boolean inStaticContext=isStaticInitField || isStaticClassInitializer;
  if (!inStaticContext && PsiUtil.hasModifierProperty(referencedField,PsiModifier.STATIC))   return null;
  if (PsiUtil.isOnAssignmentLeftHand(expression) && !PsiUtil.isAccessedForReading(expression))   return null;
  if (!containingClass.getManager().areElementsEquivalent(containingClass,PsiTreeUtil.getParentOfType(expression,PsiClass.class)))   return null;
  return HighlightInfo.createHighlightInfo(HighlightInfoType.ERROR,expression,"Illegal forward reference");
}
