{
  if (place instanceof PsiReferenceExpression) {
    PsiReferenceExpression expression=(PsiReferenceExpression)place;
    while (true) {
      final PsiElement resolved=expression.resolve();
      if (resolved instanceof PsiField) {
        final PsiField field=(PsiField)resolved;
        final PsiClass aClass=field.getContainingClass();
        if (aClass != null && PsiUtil.hasModifierProperty(aClass,PsiModifier.PACKAGE_LOCAL) && !aClass.getManager().arePackagesTheSame(aClass,place)) {
          return aClass;
        }
      }
      final PsiExpression qualifier=expression.getQualifierExpression();
      if (!(qualifier instanceof PsiReferenceExpression))       break;
      expression=(PsiReferenceExpression)qualifier;
    }
  }
  return null;
}
