{
  GlobalSearchScope scope=includeNonProjectItems ? GlobalSearchScope.allScope(project) : GlobalSearchScope.projectScope(project);
  PsiShortNamesCache cache=PsiManager.getInstance(project).getShortNamesCache();
  PsiMethod[] methods=cache.getMethodsByName(name,scope);
  methods=filterInheritedMethods(methods);
  PsiField[] fields=cache.getFieldsByName(name,scope);
  PsiClass[] classes=cache.getClassesByName(name,scope);
  List<PsiMember> result=new ArrayList<PsiMember>();
  result.addAll(Arrays.asList(methods));
  result.addAll(Arrays.asList(fields));
  result.addAll(Arrays.asList(classes));
  filterOutNonOpenable(result);
  PsiMember[] array=result.toArray(new PsiMember[result.size()]);
  Arrays.sort(array,MyComparator.INSTANCE);
  return array;
}
