{
  if (element instanceof FileElement) {
    VirtualFile file=((FileElement)element).getFile();
    if (file == null)     return null;
    VirtualFile parent=file.getParent();
    if (parent != null && parent.getFileSystem() instanceof JarFileSystem && parent.getParent() == null) {
      String localPath=parent.getPath().substring(0,parent.getPath().length() - JarFileSystem.JAR_SEPARATOR.length());
      parent=LocalFileSystem.getInstance().findFileByPath(localPath);
    }
    if (parent == null) {
      return myRootElement;
    }
    return new FileElement(parent,parent.getName());
  }
  return null;
}
