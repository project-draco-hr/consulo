{
  final C configuration=type.createDefaultConfiguration();
  final Element config=state.getConfiguration();
  if (config != null) {
    configuration.readExternal(config);
  }
  String name=state.getName();
  final Facet facet=createFacet(type,name,configuration,underlyingFacet);
  facet.setImplicit(state.isImplicit());
  if (facet instanceof JDOMExternalizable) {
    ((JDOMExternalizable)facet).readExternal(config);
  }
  model.addFacet(facet);
  addFacets(state.getSubFacets(),facet,model);
}
