{
  CommandProcessor.getInstance().setCurrentCommandGroupId(EditorActionUtil.DELETE_COMMAND_GROUP);
  SelectionModel selectionModel=editor.getSelectionModel();
  if (selectionModel.hasSelection()) {
    Document document=editor.getDocument();
    int selectionStart=selectionModel.getSelectionStart();
    int selectionEnd=selectionModel.getSelectionEnd();
    selectionModel.removeSelection();
    int lineStartOffset=document.getLineStartOffset(document.getLineNumber(selectionStart));
    int lineEndOffset=document.getLineEndOffset(document.getLineNumber(selectionEnd));
    document.deleteString(lineStartOffset,lineEndOffset);
    return;
  }
  deleteLineAtCaret(editor);
}
