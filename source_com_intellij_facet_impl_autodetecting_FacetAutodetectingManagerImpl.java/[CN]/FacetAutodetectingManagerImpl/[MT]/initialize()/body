{
  myImplicitFacetManager=new ImplicitFacetManager(myProject,this);
  FacetType[] types=FacetTypeRegistry.getInstance().getFacetTypes();
  for (  FacetType<?,?> type : types) {
    registerDetectors(type);
  }
  myFileIndex=new FacetDetectionIndex(myProject,this,myDetectors.keySet());
  myFileIndex.initialize();
  myPsiTreeChangeListener=new MyPsiTreeChangeListener();
  myPsiManager.addPsiTreeChangeListener(myPsiTreeChangeListener);
  myMergingUpdateQueue=new MergingUpdateQueue("FacetAutodetectionQueue",500,true,null);
}
