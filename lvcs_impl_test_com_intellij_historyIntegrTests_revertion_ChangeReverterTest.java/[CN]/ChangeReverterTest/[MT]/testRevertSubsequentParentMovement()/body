{
  VirtualFile dir1=root.createChildDirectory(null,"dir1");
  VirtualFile dir2=root.createChildDirectory(null,"dir2");
  VirtualFile f=dir1.createChildData(null,"f.txt");
  f.setBinaryContent(new byte[]{1},-1,123);
  dir1.move(null,dir2);
  revertChange(f,1);
  assertEquals(0,f.contentsToByteArray().length);
  assertEquals(root,dir1.getParent());
  assertEquals(0,dir2.getChildren().length);
}
