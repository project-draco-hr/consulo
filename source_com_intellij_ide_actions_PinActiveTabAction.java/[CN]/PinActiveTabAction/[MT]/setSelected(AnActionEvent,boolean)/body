{
  DataContext context=e.getDataContext();
  VirtualFile file=getFile(context);
  if (file != null) {
    Project project=(Project)context.getData(DataConstants.PROJECT);
    final FileEditorManagerEx fileEditorManager=FileEditorManagerEx.getInstanceEx(project);
    EditorWindow editorWindow=(EditorWindow)context.getData(DataConstantsEx.EDITOR_WINDOW);
    if (editorWindow == null) {
      editorWindow=fileEditorManager.getCurrentWindow();
    }
    editorWindow.setFilePinned(file,state);
  }
 else {
    Content content=getContent(context);
    content.setPinned(state);
  }
}
