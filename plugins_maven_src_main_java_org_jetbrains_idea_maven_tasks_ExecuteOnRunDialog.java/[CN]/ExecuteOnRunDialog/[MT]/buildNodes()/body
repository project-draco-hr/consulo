{
  DefaultMutableTreeNode root=new DefaultMutableTreeNode(new Descriptor());
  ConfigurationType[] configurationFactories=myRunManager.getConfigurationFactories();
  for (  final ConfigurationType type : configurationFactories) {
    final Icon icon=type.getIcon();
    DefaultMutableTreeNode typeNode=new DefaultMutableTreeNode(new ConfigurationTypeDescriptor(type,icon,isAssigned(type,null)));
    root.add(typeNode);
    final Set<String> addedNames=StringSetSpinAllocator.alloc();
    try {
      RunConfiguration[] configurations=myRunManager.getConfigurations(type);
      for (      final RunConfiguration configuration : configurations) {
        final String configurationName=configuration.getName();
        if (addedNames.contains(configurationName)) {
          continue;
        }
        addedNames.add(configurationName);
        typeNode.add(new DefaultMutableTreeNode(new ConfigurationDescriptor(type,configuration,configurationName,isAssigned(type,configuration))));
      }
    }
  finally {
      StringSetSpinAllocator.dispose(addedNames);
    }
  }
  return root;
}
