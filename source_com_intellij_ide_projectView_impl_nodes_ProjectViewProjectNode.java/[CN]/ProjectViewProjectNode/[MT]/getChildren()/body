{
  final Module[] modules=ModuleManager.getInstance(getProject()).getModules();
  ArrayList<AbstractTreeNode> nodes=new ArrayList<AbstractTreeNode>();
  nodes.addAll(modulesAndGroups(modules));
  final VirtualFile baseDir=getProject().getBaseDir();
  final VirtualFile compilerOutput=ProjectRootManager.getInstance(getProject()).getCompilerOutput();
  final PsiManager psiManager=PsiManager.getInstance(getProject());
  final VirtualFile[] files=baseDir.getChildren();
  for (  VirtualFile file : files) {
    if (ModuleUtil.findModuleForFile(file,getProject()) == null) {
      if (file.isDirectory()) {
        if (compilerOutput == file)         continue;
        nodes.add(new PsiDirectoryNode(getProject(),psiManager.findDirectory(file),getSettings()));
      }
 else {
        nodes.add(new PsiFileNode(getProject(),psiManager.findFile(file),getSettings()));
      }
    }
  }
  return nodes;
}
