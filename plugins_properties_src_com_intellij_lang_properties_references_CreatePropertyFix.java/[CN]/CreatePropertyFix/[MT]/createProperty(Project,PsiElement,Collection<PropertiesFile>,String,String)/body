{
  for (  PropertiesFile selectedFile : selectedPropertiesFiles) {
    if (!CodeInsightUtilBase.prepareFileForWrite(selectedFile.getContainingFile()))     return;
  }
  UndoUtil.markPsiFileForUndo(psiElement.getContainingFile());
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    public void run(){
      CommandProcessor.getInstance().executeCommand(project,new Runnable(){
        public void run(){
          try {
            I18nUtil.createProperty(project,selectedPropertiesFiles,key,value);
          }
 catch (          IncorrectOperationException e) {
            LOG.error(e);
          }
        }
      }
,CodeInsightBundle.message("quickfix.i18n.command.name"),project);
    }
  }
);
}
