{
  if (e == null)   return AnAction.EMPTY_ARRAY;
  final DataContext dataContext=e.getDataContext();
  final Project project=(Project)dataContext.getData(DataConstantsEx.PROJECT);
  Module[] allModules=ModuleManager.getInstance(project).getModules();
  Set<String> topLevelGroupNames=new HashSet<String>();
  for (  final Module child : allModules) {
    String[] group=ModuleManager.getInstance(project).getModuleGroupPath(child);
    if (group != null) {
      topLevelGroupNames.add(group[0]);
    }
  }
  List<AnAction> result=new ArrayList<AnAction>();
  result.add(new MoveModulesOutsideGroupAction());
  result.add(new MoveModulesToSubGroupAction(null));
  result.add(Separator.getInstance());
  for (  String name : topLevelGroupNames) {
    result.add(new MoveModuleToGroup(new ModuleGroup(new String[]{name})));
  }
  return result.toArray(new AnAction[result.size()]);
}
