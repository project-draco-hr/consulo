{
  myFixture.configureByFile(getTestName(false) + ".groovy");
  final PsiType type=selectedType == null ? null : JavaPsiFacade.getElementFactory(getProject()).createTypeFromText(selectedType,myFixture.getFile());
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    @Override public void run(){
      final IntroduceFieldTestHandler handler=new IntroduceFieldTestHandler(isStatic,removeLocal,declareFinal,initIn,replaceAll,type);
      handler.invoke(getProject(),myFixture.getEditor(),myFixture.getFile(),null);
      PostprocessReformattingAspect.getInstance(getProject()).doPostponedFormatting();
    }
  }
);
  myFixture.checkResultByFile(getTestName(false) + "_after.groovy");
}
