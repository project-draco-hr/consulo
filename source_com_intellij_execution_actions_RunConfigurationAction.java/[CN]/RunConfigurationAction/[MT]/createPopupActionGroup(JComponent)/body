{
  final DefaultActionGroup allActionsGroup=new DefaultActionGroup();
  final Project project=(Project)DataManager.getInstance().getDataContext(button).getData(DataConstants.PROJECT);
  if (project != null) {
    final RunManagerEx runManager=RunManagerEx.getInstanceEx(project);
    final ConfigurationType[] types=runManager.getConfigurationFactories();
    for (int i=0; i < types.length; i++) {
      final DefaultActionGroup actionGroup=new DefaultActionGroup();
      final RunnerAndConfigurationSettingsImpl[] configurations=runManager.getConfigurationSettings(types[i]);
      for (int j=0; j < configurations.length; j++) {
        final RunnerAndConfigurationSettingsImpl configuration=configurations[j];
        final MenuAction action=new MenuAction(configuration,project);
        actionGroup.add(action);
      }
      allActionsGroup.add(actionGroup);
      allActionsGroup.addSeparator();
    }
    allActionsGroup.add(ActionManager.getInstance().getAction(IdeActions.ACTION_EDIT_RUN_CONFIGURATIONS));
    allActionsGroup.add(new SaveTemporaryAction());
  }
  return allActionsGroup;
}
