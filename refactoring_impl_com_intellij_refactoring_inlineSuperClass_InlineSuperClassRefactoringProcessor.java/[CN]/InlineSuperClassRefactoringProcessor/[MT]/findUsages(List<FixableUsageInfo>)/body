{
  ReferencesSearch.search(mySuperClass).forEach(new Processor<PsiReference>(){
    public boolean process(    final PsiReference reference){
      final PsiElement element=reference.getElement();
      if (element instanceof PsiJavaCodeReferenceElement) {
        final PsiImportStatement importStatement=PsiTreeUtil.getParentOfType(element,PsiImportStatement.class);
        if (importStatement != null) {
          usages.add(new ReplaceImportUsageInfo(importStatement,myTargetClass));
        }
 else {
          final PsiElement parent=element.getParent();
          if (parent instanceof PsiTypeElement) {
            usages.add(new ReplaceWithSubtypeUsageInfo((PsiTypeElement)parent,myTargetClass));
          }
 else           if (parent instanceof PsiReferenceList) {
            final PsiElement pparent=parent.getParent();
            if (pparent instanceof PsiClass) {
              final PsiClass inheritor=(PsiClass)pparent;
              if (parent.equals(inheritor.getExtendsList()) || parent.equals(inheritor.getImplementsList())) {
                usages.add(new ReplaceExtendsListUsageInfo((PsiJavaCodeReferenceElement)element,mySuperClass,myTargetClass));
              }
            }
          }
        }
      }
      return true;
    }
  }
);
}
