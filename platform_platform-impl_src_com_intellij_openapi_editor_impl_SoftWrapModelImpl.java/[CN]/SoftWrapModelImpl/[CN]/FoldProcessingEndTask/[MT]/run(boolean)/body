{
  if (!softWrapAware) {
    return;
  }
  try {
    for (    FoldRegionInfo info : myDeferredFoldRegions) {
      FoldRegion outerRegion=myEditor.getFoldingModel().getCollapsedRegionAtOffset(info.start);
      if (outerRegion != null && outerRegion != info.region && outerRegion.getStartOffset() <= info.start && outerRegion.getEndOffset() >= info.end) {
        continue;
      }
      for (      SoftWrapFoldingListener listener : myFoldListeners) {
        listener.onFoldRegionStateChange(info.start,info.end);
      }
    }
  }
  finally {
    myDeferredFoldRegions.clear();
  }
  for (  SoftWrapFoldingListener listener : myFoldListeners) {
    listener.onFoldProcessingEnd();
  }
}
