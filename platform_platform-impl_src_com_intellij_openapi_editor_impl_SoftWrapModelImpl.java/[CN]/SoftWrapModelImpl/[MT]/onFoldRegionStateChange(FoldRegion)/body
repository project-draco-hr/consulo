{
  myUpdateInProgress=true;
  if (!isSoftWrappingEnabled() || !region.isValid()) {
    myDirty=true;
    return;
  }
  FoldRegion outerRegion=myEditor.getFoldingModel().getCollapsedRegionAtOffset(region.getStartOffset());
  if (outerRegion != null && outerRegion != region && outerRegion.getStartOffset() <= region.getStartOffset() && outerRegion.getEndOffset() >= region.getEndOffset()) {
    return;
  }
  for (  FoldingListener listener : myFoldListeners) {
    listener.onFoldRegionStateChange(region);
  }
}
