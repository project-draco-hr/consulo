{
  if (myInitialized) {
    return;
  }
  myInitialized=true;
  ScrollingModel scrollingModel=myEditor.getScrollingModel();
  scrollingModel.addVisibleAreaListener(new VisibleAreaListener(){
    public void visibleAreaChanged(    VisibleAreaEvent e){
      updateVisibleAreaIfNecessary(e.getNewRectangle());
    }
  }
);
  updateVisibleAreaIfNecessary(scrollingModel.getVisibleArea());
  myEditor.getDocument().addDocumentListener(new DocumentListener(){
    public void beforeDocumentChange(    DocumentEvent event){
    }
    public void documentChanged(    DocumentEvent event){
      myActive++;
      try {
        updateRegisteredSoftWraps(new TextChange(event.getNewFragment(),event.getOffset(),event.getOffset() + event.getOldLength()));
      }
  finally {
        myActive--;
      }
    }
  }
);
}
