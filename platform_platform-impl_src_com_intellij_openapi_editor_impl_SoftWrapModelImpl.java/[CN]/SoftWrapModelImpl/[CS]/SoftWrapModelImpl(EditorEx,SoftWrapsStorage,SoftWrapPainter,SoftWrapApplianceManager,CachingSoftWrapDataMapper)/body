{
  myEditor=editor;
  myStorage=storage;
  myPainter=painter;
  myApplianceManager=applianceManager;
  myDataMapper=dataMapper;
  myFoldBasedApplianceStrategy=new SoftWrapFoldBasedApplianceStrategy(editor);
  myVisualSizeManager=new SoftWrapAwareVisualSizeManager(painter);
  myDocumentListeners.add(myApplianceManager);
  myFoldListeners.add(myApplianceManager);
  applianceManager.addListener(myVisualSizeManager);
  EditorSettings settings=myEditor.getSettings();
  myAdditionalColumnsCount=settings.getAdditionalColumnsCount();
  myUseSoftWraps=settings.isUseSoftWraps();
  editor.addPropertyChangeListener(this);
}
