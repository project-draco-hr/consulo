{
  if (!visited.add(module)) {
    return;
  }
  for (  OrderEntry entry : ModuleRootManager.getInstance(module).getOrderEntries()) {
    if (entry instanceof LibraryOrderEntry) {
      LibraryOrderEntry libEntry=(LibraryOrderEntry)entry;
      if (exportedOnly && !libEntry.isExported()) {
        continue;
      }
      Library library=libEntry.getLibrary();
      if (condition.value(library)) {
        libraries.add(library);
      }
    }
 else     if (entry instanceof ModuleOrderEntry) {
      final Module dep=((ModuleOrderEntry)entry).getModule();
      if (module != null) {
        populateOrderEntries(dep,condition,libraries,true,visited);
      }
    }
  }
}
