{
  KeyMaterial km=new KeyMaterial();
  HashForSSH2Types sh=new HashForSSH2Types(hashType);
  km.initial_iv_client_to_server=calculateKey(sh,K,H,(byte)'A',SessionID,blockSizeCS);
  km.initial_iv_server_to_client=calculateKey(sh,K,H,(byte)'B',SessionID,blockSizeSC);
  km.enc_key_client_to_server=calculateKey(sh,K,H,(byte)'C',SessionID,keyLengthCS);
  km.enc_key_server_to_client=calculateKey(sh,K,H,(byte)'D',SessionID,keyLengthSC);
  km.integrity_key_client_to_server=calculateKey(sh,K,H,(byte)'E',SessionID,macLengthCS);
  km.integrity_key_server_to_client=calculateKey(sh,K,H,(byte)'F',SessionID,macLengthSC);
  return km;
}
