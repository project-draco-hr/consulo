{
  Map<String,String> env=new HashMap<>();
  setupEnvironment(env);
  if (isRedirectErrorStream()) {
    LOG.error("Launching process with PTY and redirected error stream is unsupported yet");
  }
  String[] command=ArrayUtil.toStringArray(commands);
  File workDirectory=getWorkDirectory();
  String directory=workDirectory != null ? workDirectory.getPath() : null;
  boolean cygwin=myUseCygwinLaunch && SystemInfo.isWindows;
  return PtyProcess.exec(command,env,directory,console,cygwin,getPtyLogFile());
}
