{
  final PackageDependenciesNode leftNode=myLeftTree.getSelectedNode();
  final PackageDependenciesNode rightNode=myRightTree.getSelectedNode();
  if (leftNode != null && rightNode != null) {
    PackageSet leftPackageSet=ScopeEditorPanel.getNodePackageSet(leftNode,true);
    if (leftPackageSet == null) {
      leftPackageSet=ScopeEditorPanel.getNodePackageSet(leftNode,false);
    }
    LOG.assertTrue(leftPackageSet != null);
    PackageSet rightPackageSet=ScopeEditorPanel.getNodePackageSet(rightNode,true);
    if (rightPackageSet == null) {
      rightPackageSet=ScopeEditorPanel.getNodePackageSet(rightNode,false);
    }
    LOG.assertTrue(rightPackageSet != null);
    DependencyValidationManager.getInstance(myProject).addRule(new DependencyRule(new NamedScope.UnnamedScope(leftPackageSet),new NamedScope.UnnamedScope(rightPackageSet),true));
    rebuild();
  }
}
