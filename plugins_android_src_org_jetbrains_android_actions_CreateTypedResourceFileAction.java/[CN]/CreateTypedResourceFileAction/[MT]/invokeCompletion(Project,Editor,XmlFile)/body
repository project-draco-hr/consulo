{
  new CodeCompletionHandlerBase(CompletionType.BASIC).invokeCompletion(project,editor,file,1);
  CompletionProgressIndicator indicator=CompletionServiceImpl.getCompletionService().getCurrentCompletion();
  if (indicator != null) {
    final LookupImpl lookup=indicator.getLookup();
    lookup.setAdditionalPrefix(myDefaultRootTag);
    lookup.addLookupListener(new LookupAdapter(){
      boolean prefixCanceled;
      @Override public void itemSelected(      LookupEvent event){
        TemplateManagerImpl.getTemplateState(editor).gotoEnd();
      }
      @Override public void currentItemChanged(      LookupEvent event){
        if (!prefixCanceled) {
          prefixCanceled=true;
          lookup.setAdditionalPrefix("");
        }
      }
      @Override public void lookupCanceled(      LookupEvent event){
      }
    }
);
  }
}
