{
  final boolean goIntoNested=SvnConfiguration.getInstance(myVcs.getProject()).DETECT_NESTED_COPIES;
  final VirtualFile[] roots=myHelper.getRootSettings();
  final SvnMapping mapping=new SvnMapping();
  final List<Real> allRoots=new ArrayList<Real>();
  for (  VirtualFile root : roots) {
    final List<Real> foundRoots=ForNestedRootChecker.getAllNestedWorkingCopies(root,myVcs,goIntoNested);
    allRoots.addAll(foundRoots);
    for (    Real foundRoot : foundRoots) {
      addRoot(mapping,foundRoot);
    }
  }
  final SvnMapping groupedMapping=new SvnMapping();
  final List<Real> filtered=new ArrayList<Real>();
  ForNestedRootChecker.filterOutSuperfluousChildren(myVcs,allRoots,filtered);
  for (  Real copy : filtered) {
    addRoot(groupedMapping,copy);
  }
synchronized (myMonitor) {
    myMapping.copyFrom(mapping);
    myMoreRealMapping.copyFrom(groupedMapping);
  }
}
