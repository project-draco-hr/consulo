{
  new WriteCommandAction.Simple(myProject){
    @Override protected void run() throws Throwable {
      try {
        final VirtualFile[] children=dir.getChildren();
        for (        VirtualFile child : children) {
          if (filter != null && filter.process(child)) {
            child.delete(null);
          }
        }
      }
 catch (      IOException e) {
        throw new RuntimeException(e);
      }
    }
  }
.execute();
}
