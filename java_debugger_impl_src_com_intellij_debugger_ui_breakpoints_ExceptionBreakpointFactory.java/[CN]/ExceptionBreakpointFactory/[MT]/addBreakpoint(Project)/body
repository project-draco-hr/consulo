{
  ExceptionBreakpoint breakpoint=null;
  final PsiClass throwableClass=JavaPsiFacade.getInstance(project).findClass("java.lang.Throwable",GlobalSearchScope.allScope(project));
  TreeClassChooser chooser=TreeClassChooserFactory.getInstance(project).createInheritanceClassChooser(DebuggerBundle.message("add.exception.breakpoint.classchooser.title"),GlobalSearchScope.allScope(project),throwableClass,true,true,null);
  chooser.showDialog();
  PsiClass selectedClass=chooser.getSelected();
  String qName=selectedClass == null ? null : JVMNameUtil.getNonAnonymousClassName(selectedClass);
  if (qName != null && qName.length() > 0) {
    breakpoint=DebuggerManagerEx.getInstanceEx(project).getBreakpointManager().addExceptionBreakpoint(qName,((PsiClassOwner)selectedClass.getContainingFile()).getPackageName());
  }
  return breakpoint;
}
