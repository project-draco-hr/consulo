{
  return new DataIndexer<Integer,InfoHolder<LinkInfo>,FileContent>(){
    @NotNull public Map<Integer,InfoHolder<LinkInfo>> map(    final FileContent inputData){
      final int id=Math.abs(FileBasedIndex.getFileId(inputData.getFile()));
      final Language language=((LanguageFileType)inputData.getFileType()).getLanguage();
      final List<LinkInfo> result=new ArrayList<LinkInfo>();
      if (HTMLLanguage.INSTANCE == language || XHTMLLanguage.INSTANCE == language) {
        mapHtml(inputData,language,result);
      }
 else {
        mapJsp(inputData,language,result);
      }
      return Collections.singletonMap(id,new InfoHolder<LinkInfo>(result.toArray(new LinkInfo[result.size()])));
    }
  }
;
}
