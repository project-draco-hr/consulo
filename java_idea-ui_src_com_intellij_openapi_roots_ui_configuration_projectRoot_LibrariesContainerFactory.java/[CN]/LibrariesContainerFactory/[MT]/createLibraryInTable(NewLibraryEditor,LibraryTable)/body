{
  LibraryTableBase.ModifiableModelEx modifiableModel=(LibraryTableBase.ModifiableModelEx)table.getModifiableModel();
  final String name=StringUtil.isEmpty(editor.getName()) ? null : getUniqueLibraryName(editor.getName(),modifiableModel);
  Library library=modifiableModel.createLibrary(name,editor.getType());
  final Library.ModifiableModel model=library.getModifiableModel();
  editor.applyRoots(model);
  ((LibraryEx.ModifiableModelEx)model).setProperties(editor.getProperties());
  model.commit();
  modifiableModel.commit();
  return library;
}
