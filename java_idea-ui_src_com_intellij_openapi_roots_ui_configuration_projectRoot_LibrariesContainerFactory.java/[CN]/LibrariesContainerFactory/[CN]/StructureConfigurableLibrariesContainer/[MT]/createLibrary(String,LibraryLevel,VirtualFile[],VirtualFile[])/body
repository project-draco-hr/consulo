{
  LibraryTableModifiableModelProvider provider=getProvider(level);
  if (provider == null) {
    LOG.error("cannot create module library in this context");
  }
  LibraryTable.ModifiableModel model=provider.getModifiableModel();
  Library library=model.createLibrary(getUniqueLibraryName(name,model));
  LibraryEditor libraryEditor=((LibrariesModifiableModel)model).getLibraryEditor(library);
  for (  VirtualFile root : classRoots) {
    libraryEditor.addRoot(root,OrderRootType.CLASSES);
  }
  for (  VirtualFile source : sourceRoots) {
    libraryEditor.addRoot(source,OrderRootType.SOURCES);
  }
  return library;
}
