{
  ProjectLevelVcsManager vcsManager=ProjectLevelVcsManager.getInstance(project);
  AbstractVcs gitVcs=GitVcs.getInstance(project);
  if (gitVcs == null) {
    return null;
  }
  VirtualFile[] gitRoots=vcsManager.getRootsUnderVcs(gitVcs);
  if (gitRoots.length == 0) {
    return null;
  }
  VirtualFile selectedFile=getSelectedFile(project);
  if (selectedFile != null) {
    VirtualFile selectedFileRoot=vcsManager.getVcsRootFor(selectedFile);
    return ArrayUtil.contains(selectedFileRoot,gitRoots) ? selectedFileRoot : null;
  }
  if (gitRoots.length == 1) {
    return gitRoots[0];
  }
  return null;
}
