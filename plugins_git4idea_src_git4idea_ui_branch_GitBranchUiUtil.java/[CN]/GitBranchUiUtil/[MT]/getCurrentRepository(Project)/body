{
  if (project == null) {
    return null;
  }
  GitRepositoryManager manager=GitUtil.getRepositoryManager(project);
  if (manager == null) {
    return null;
  }
  VirtualFile file=getSelectedFile(project);
  if (file != null) {
    return manager.getRepositoryForRoot(getVcsRootFor(project,file));
  }
  return manager.getRepositoryForRoot(guessGitRoot(project));
}
