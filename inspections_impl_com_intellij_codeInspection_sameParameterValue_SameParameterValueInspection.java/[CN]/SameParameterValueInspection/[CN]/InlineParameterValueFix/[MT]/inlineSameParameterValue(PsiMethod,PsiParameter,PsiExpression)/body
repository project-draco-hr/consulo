{
  final Collection<PsiReference> refsToInline=ReferencesSearch.search(parameter).findAll();
  final Runnable runnable=new Runnable(){
    public void run(){
      try {
        PsiExpression[] exprs=new PsiExpression[refsToInline.size()];
        int idx=0;
        for (        PsiReference reference : refsToInline) {
          if (reference instanceof PsiJavaCodeReferenceElement) {
            exprs[idx++]=InlineUtil.inlineVariable(parameter,defToInline,(PsiJavaCodeReferenceElement)reference);
          }
        }
        for (        final PsiExpression expr : exprs) {
          if (expr != null)           InlineUtil.tryToInlineArrayCreationForVarargs(expr);
        }
        removeParameter(method,parameter);
      }
 catch (      IncorrectOperationException e) {
        LOG.error(e);
      }
    }
  }
;
  ApplicationManager.getApplication().runWriteAction(runnable);
}
