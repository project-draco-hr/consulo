{
  final Project project=method.getProject();
  final Collection<PsiReference> refsToInline=ReferencesSearch.search(parameter).findAll();
  final Runnable runnable=new Runnable(){
    public void run(){
      try {
        PsiExpression[] exprs=new PsiExpression[refsToInline.size()];
        int idx=0;
        for (        PsiReference reference : refsToInline) {
          PsiJavaCodeReferenceElement refElement=(PsiJavaCodeReferenceElement)reference;
          exprs[idx++]=InlineUtil.inlineVariable(parameter,defToInline,refElement);
        }
        for (        final PsiExpression expr : exprs) {
          InlineUtil.tryToInlineArrayCreationForVarargs(expr);
        }
        removeParameter(method,parameter);
      }
 catch (      IncorrectOperationException e) {
        LOG.error(e);
      }
    }
  }
;
  ApplicationManager.getApplication().runWriteAction(runnable);
}
