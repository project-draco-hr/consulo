{
  final String allText=parent.getContainingFile().getText();
  final TextRange parentRange=parent.getTextRange();
  String beg=allText.substring(parentRange.getStartOffset(),rangeMarker.getStartOffset());
  if (StringUtil.stripQuotesAroundValue(beg).trim().length() == 0 && prefix == null)   beg="";
  String end=allText.substring(rangeMarker.getEndOffset(),parentRange.getEndOffset());
  if (StringUtil.stripQuotesAroundValue(end).trim().length() == 0 && suffix == null)   end="";
  final String start=beg + (prefix != null ? prefix : "");
  refIdx[0]=start.length();
  final String text=start + refText + (suffix != null ? suffix : "")+ end;
  return JavaPsiFacade.getInstance(project).getElementFactory().createExpressionFromText(text,parent);
}
