{
  final boolean replaceAll=replaceChoice == OccurrencesChooser.ReplaceChoice.ALL || replaceChoice == OccurrencesChooser.ReplaceChoice.NO_WRITE;
  final SuggestedNameInfo suggestedName=getSuggestedName(typeSelectorManager.getDefaultType(),expr,anchor);
  final String variableName=suggestedName.names[0];
  final boolean declareFinal=replaceAll && declareFinalIfAll || !anyAssignmentLHS && createFinals(project);
  final boolean replaceWrite=anyAssignmentLHS && replaceChoice == OccurrencesChooser.ReplaceChoice.ALL;
  return new IntroduceVariableSettings(){
    @Override public String getEnteredName(){
      return variableName;
    }
    @Override public boolean isReplaceAllOccurrences(){
      return replaceAll;
    }
    @Override public boolean isDeclareFinal(){
      return declareFinal;
    }
    @Override public boolean isReplaceLValues(){
      return replaceWrite;
    }
    @Override public PsiType getSelectedType(){
      final PsiType selectedType=typeSelectorManager.getTypeSelector().getSelectedType();
      return selectedType != null ? selectedType : typeSelectorManager.getDefaultType();
    }
    @Override public boolean isOK(){
      return true;
    }
  }
;
}
