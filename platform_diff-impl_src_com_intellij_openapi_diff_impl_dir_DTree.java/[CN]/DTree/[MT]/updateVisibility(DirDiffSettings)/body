{
  if (getChildren().isEmpty()) {
    if (myType == ERROR) {
      myVisible=true;
      return;
    }
    if (myType != DiffType.SEPARATOR && !"".equals(settings.getFilter())) {
      if (!settings.getFilterPattern().matcher(getName()).matches()) {
        myVisible=false;
        return;
      }
    }
    if (myType == null) {
      myVisible=true;
    }
 else {
switch (myType) {
case SOURCE:
        myVisible=settings.showNewOnSource;
      break;
case TARGET:
    myVisible=settings.showNewOnTarget;
  break;
case SEPARATOR:
case ERROR:
myVisible=true;
break;
case CHANGED:
myVisible=settings.showDifferent;
break;
case EQUAL:
myVisible=settings.showEqual;
break;
}
}
}
 else {
myVisible=false;
for (DTree child : myChildren.values()) {
child.updateVisibility(settings);
myVisible=myVisible || child.isVisible();
}
}
}
