{
  final DataContext dataContext=e.getDataContext();
  Project project=(Project)dataContext.getData(DataConstants.PROJECT);
  Collection<AbstractTreeNode> nodesToAdd=AddToFavoritesAction.getNodesToAdd(dataContext,true);
  if (nodesToAdd != null) {
    final String newName=AddNewFavoritesListAction.doAddNewFavoritesList((Project)dataContext.getData(DataConstants.PROJECT));
    if (newName != null) {
      FavoritesManager.getInstance(project).addRoots(newName,nodesToAdd);
    }
  }
}
