{
  final DataContext dataContext=e.getDataContext();
  Project project=DataKeys.PROJECT.getData(dataContext);
  Collection<AbstractTreeNode> nodesToAdd=AddToFavoritesAction.getNodesToAdd(dataContext,true);
  if (nodesToAdd != null) {
    final String newName=AddNewFavoritesListAction.doAddNewFavoritesList(DataKeys.PROJECT.getData(dataContext));
    if (newName != null) {
      FavoritesManager.getInstance(project).addRoots(newName,nodesToAdd);
    }
  }
}
