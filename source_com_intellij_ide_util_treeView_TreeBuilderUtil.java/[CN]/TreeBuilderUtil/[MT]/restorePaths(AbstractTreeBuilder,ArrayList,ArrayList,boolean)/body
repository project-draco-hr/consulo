{
  JTree tree=treeBuilder.getTree();
  if (!elementsOnly) {
    for (int i=0; i < pathsToExpand.size(); i++) {
      TreePath path=(TreePath)pathsToExpand.get(i);
      tree.expandPath(path);
    }
    tree.addSelectionPaths((TreePath[])selectionPaths.toArray(new TreePath[selectionPaths.size()]));
  }
 else {
    for (int i=0; i < pathsToExpand.size(); i++) {
      Object element=pathsToExpand.get(i);
      treeBuilder.buildNodeForElement(element);
      DefaultMutableTreeNode node=treeBuilder.getNodeForElement(element);
      if (node != null) {
        tree.expandPath(new TreePath(node.getPath()));
      }
    }
    for (int i=0; i < selectionPaths.size(); i++) {
      Object element=selectionPaths.get(i);
      DefaultMutableTreeNode node=treeBuilder.getNodeForElement(element);
      if (node != null) {
        DefaultTreeModel treeModel=(DefaultTreeModel)tree.getModel();
        tree.addSelectionPath(new TreePath(treeModel.getPathToRoot(node)));
      }
    }
  }
}
