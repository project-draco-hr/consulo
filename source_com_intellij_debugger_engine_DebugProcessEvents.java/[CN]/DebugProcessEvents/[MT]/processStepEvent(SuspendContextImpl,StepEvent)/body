{
  ThreadReference thread=event.thread();
  LOG.assertTrue(thread.isSuspended());
  preprocessEvent(suspendContext,thread);
  RequestHint hint=(RequestHint)event.request().getProperty("hint");
  boolean shouldResume=false;
  if (hint != null) {
    if (hint.shouldSkipFrame(suspendContext)) {
      if (LOG.isDebugEnabled()) {
        LOG.debug("STEPOUT doStep");
      }
      final ThreadReferenceProxyImpl threadProxy=suspendContext.getThread();
      doStep(threadProxy,hint.getDepth(),hint);
      shouldResume=true;
    }
    if (!shouldResume && hint.isRestoreBreakpoints()) {
      DebuggerManagerEx.getInstanceEx(getProject()).getBreakpointManager().enableBreakpoints(DebugProcessEvents.this);
    }
  }
  if (shouldResume) {
    getSuspendManager().voteResume(suspendContext);
  }
 else {
    showStatusText("");
    getSuspendManager().voteSuspend(suspendContext);
  }
}
