{
  myCheckinPanel=panel;
  myPanel=new JPanel(new GridBagLayout());
  final Insets insets=new Insets(2,2,2,2);
  GridBagConstraints c=new GridBagConstraints();
  c.gridx=0;
  c.gridy=1;
  c.gridwidth=2;
  c.anchor=GridBagConstraints.CENTER;
  c.insets=insets;
  c.weightx=1;
  c.fill=GridBagConstraints.HORIZONTAL;
  myAmend=new NonFocusableCheckBox(DvcsBundle.message("commit.amend"));
  myAmend.setMnemonic('m');
  myAmend.setToolTipText(DvcsBundle.message("commit.amend.tooltip"));
  myPreviousMessage=myCheckinPanel.getCommitMessage();
  myAmend.addActionListener(new ActionListener(){
    @Override public void actionPerformed(    ActionEvent e){
      if (myAmend.isSelected()) {
        if (myPreviousMessage.equals(myCheckinPanel.getCommitMessage())) {
          if (myMessagesForRoots == null) {
            loadMessagesInModalTask(project);
          }
          String message=constructAmendedMessage();
          if (!StringUtil.isEmptyOrSpaces(message)) {
            myAmendedMessage=message;
            substituteCommitMessage(myAmendedMessage);
          }
        }
      }
 else {
        if (myCheckinPanel.getCommitMessage().equals(myAmendedMessage)) {
          myCheckinPanel.setCommitMessage(myPreviousMessage);
        }
      }
    }
  }
);
  myPanel.add(myAmend,c);
}
