{
  dropDataIfNecessary();
  if (start >= end) {
    return;
  }
  Document document=myEditor.getDocument();
  int startLine=document.getLineNumber(start);
  int endLine=document.getLineNumber(end);
  for (int i=startLine; i <= endLine; i++) {
    if (!myProcessedLogicalLines.contains(i)) {
      IndentType indent=IndentType.NONE;
      if (!myEditor.isViewer() && !document.isWritable()) {
        indent=IndentType.TO_PREV_LINE_NON_WS_START;
      }
      processLogicalLine(text,i,fontType,indent);
      myProcessedLogicalLines.add(i);
    }
  }
}
