{
  dropDataIfNecessary();
  if (myVisibleAreaWidth <= 0 || start >= end) {
    return;
  }
  IndentType indent=getIndentToUse();
  boolean useCustomIndent=indent == IndentType.CUSTOM;
  int currentCustomIndent=myEditor.getSettings().getCustomSoftWrapIndent();
  if (useCustomIndent ^ myCustomIndentUsedLastTime || (useCustomIndent && myCustomIndentValueUsedLastTime != currentCustomIndent)) {
    myProcessedLogicalLines.clear();
  }
  myCustomIndentUsedLastTime=useCustomIndent;
  myCustomIndentValueUsedLastTime=currentCustomIndent;
  Document document=myEditor.getDocument();
  int startLine=document.getLineNumber(start);
  int endLine=document.getLineNumber(end);
  for (int i=startLine; i <= endLine; i++) {
    if (!myProcessedLogicalLines.contains(i) || (!temporary && myProcessedLogicalLines.get(i))) {
      processLogicalLine(text,i,fontType,indent,temporary);
      myProcessedLogicalLines.put(i,temporary);
    }
  }
}
