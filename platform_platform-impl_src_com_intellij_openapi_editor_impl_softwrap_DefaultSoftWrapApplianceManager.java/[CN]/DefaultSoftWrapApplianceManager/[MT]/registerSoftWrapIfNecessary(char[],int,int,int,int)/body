{
  dropDataIfNecessary();
  if (start >= end) {
    return;
  }
  Document document=myEditor.getDocument();
  int startLine=document.getLineNumber(start);
  int endLine=document.getLineNumber(end);
  for (int i=startLine; i <= endLine; i++) {
    if (!myProcessedLogicalLines.contains(i)) {
      processLogicalLine(chars,i,fontType,IndentType.TO_PREV_LINE_NON_WS_START);
      myProcessedLogicalLines.add(i);
    }
  }
}
