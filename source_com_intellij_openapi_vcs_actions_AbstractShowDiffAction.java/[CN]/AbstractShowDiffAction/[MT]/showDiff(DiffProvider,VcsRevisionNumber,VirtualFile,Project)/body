{
  try {
    final VcsFileContent fileRevision=diffProvider.createFileContent(revisionNumber,selectedFile);
    fileRevision.loadContent();
    final SimpleDiffRequest request=new SimpleDiffRequest(project,selectedFile.getPresentableUrl());
    final SimpleContent content1=new SimpleContent(new String(fileRevision.getContent(),selectedFile.getCharset().name()),selectedFile.getFileType());
    final DocumentContent content2=new DocumentContent(project,FileDocumentManager.getInstance().getDocument(selectedFile));
    final VcsRevisionNumber currentRevision=diffProvider.getCurrentRevision(selectedFile);
    if (revisionNumber.compareTo(currentRevision) > 0) {
      request.setContents(content2,content1);
      request.setContentTitles("Local",revisionNumber.asString());
    }
 else {
      request.setContents(content1,content2);
      request.setContentTitles(revisionNumber.asString(),"Local");
    }
    DiffManager.getInstance().getDiffTool().show(request);
  }
 catch (  VcsException e) {
    AbstractVcsHelper.getInstance(project).showError(e,"Diff");
  }
catch (  IOException e) {
    AbstractVcsHelper.getInstance(project).showError(new VcsException(e),"Diff");
  }
}
