{
  String path=file.getCanonicalPath();
  if (!visited.add(path)) {
    return;
  }
  if (file.isDirectory()) {
    for (    File child : file.listFiles()) {
      collectFiles(root,child,result,visited,qNames);
    }
  }
 else {
    if ("class".equals(FileUtil.getExtension(file.getName()))) {
      final String qName=getQualifiedName(root,file);
      if (qName != null && !qNames.add(qName)) {
        reportWarning(FileUtil.toSystemDependentName(file.getPath()) + " won't be added. Class " + qName+ " already exists in classpath");
        return;
      }
    }
    result.add(path);
  }
}
