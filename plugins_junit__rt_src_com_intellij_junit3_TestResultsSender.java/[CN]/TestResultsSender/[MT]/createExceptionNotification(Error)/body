{
  if (assertion instanceof KnownException)   return ((KnownException)assertion).getPacketFactory();
  if (assertion instanceof ComparisonFailure || assertion.getClass().getName().equals("org.junit.ComparisonFailure")) {
    return ComparisonDetailsExtractor.create(assertion);
  }
  return new ExceptionPacketFactory(PoolOfTestStates.FAILED_INDEX,assertion);
}
