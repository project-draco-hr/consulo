{
  super.clearCaches();
  if (myMacroDefinition != null) {
    final AntFile file=getAntFile();
    for (    AntTypeId id : myMacroDefinition.getNestedElements()) {
      final AntTypeDefinition nestedDef=file.getBaseTypeDefinition(myMacroDefinition.getNestedClassName(id));
      file.unregisterCustomType(nestedDef);
    }
    getAntParent().unregisterCustomType(myMacroDefinition);
    invalidateMacroDefinition();
  }
}
