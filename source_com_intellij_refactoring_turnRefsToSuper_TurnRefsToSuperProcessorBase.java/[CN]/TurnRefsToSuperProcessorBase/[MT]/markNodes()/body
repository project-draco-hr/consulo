{
  for (Iterator<PsiElement> iterator=myElementToNode.keySet().iterator(); iterator.hasNext(); ) {
    final PsiElement element=iterator.next();
    if (element instanceof PsiExpression) {
      final PsiElement parent=element.getParent();
      if (parent instanceof PsiReferenceExpression) {
        final PsiReferenceExpression refExpr=(PsiReferenceExpression)parent;
        if (element.equals(refExpr.getQualifierExpression())) {
          final PsiElement refElement=refExpr.resolve();
          if (refElement != null && !isInSuper(refElement)) {
            markNode(element);
          }
        }
      }
    }
 else     if (!myReplaceInstanceOf && element.getParent() != null && element.getParent().getParent() instanceof PsiInstanceOfExpression) {
      markNode(element);
    }
 else     if (element.getParent() instanceof PsiClassObjectAccessExpression) {
      markNode(element);
    }
 else     if (element instanceof PsiParameter) {
      final PsiType type=((PsiParameter)element).getType();
      final PsiClass aClass=PsiUtil.resolveClassInType(type);
      if (aClass != null) {
        if (!myManager.isInProject(element) || !myManager.areElementsEquivalent(aClass,myClass)) {
          if (!isSuperInheritor(aClass)) {
            markNode(element);
          }
        }
      }
 else {
        markNode(element);
      }
    }
  }
}
