{
  Map<VirtualFile,String> result=ContainerUtil.newHashMap();
  final ModuleManager moduleManager=ModuleManager.getInstance(myProject);
  Module[] modules=ApplicationManager.getApplication().runReadAction(new Computable<Module[]>(){
    public Module[] compute(){
      return moduleManager.getModules();
    }
  }
);
  TreeSet<VirtualFile> checkSet=new TreeSet<>(FilePathComparator.getInstance());
  checkSet.addAll(roots);
  for (  Module module : modules) {
    VirtualFile[] files=ModuleRootManager.getInstance(module).getContentRoots();
    for (    VirtualFile file : files) {
      VirtualFile floor=checkSet.floor(file);
      if (floor != null) {
        result.put(file,module.getName());
      }
    }
  }
  return result;
}
