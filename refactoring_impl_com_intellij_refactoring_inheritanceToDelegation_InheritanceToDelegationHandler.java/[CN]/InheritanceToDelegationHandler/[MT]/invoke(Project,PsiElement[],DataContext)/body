{
  if (elements.length != 1)   return;
  final PsiClass aClass=(PsiClass)elements[0];
  if (aClass.isInterface()) {
    String message=RefactoringBundle.getCannotRefactorMessage(RefactoringBundle.message("class.is.interface",aClass.getQualifiedName()));
    CommonRefactoringUtil.showErrorMessage(REFACTORING_NAME,message,null,project);
    return;
  }
  if (!CommonRefactoringUtil.checkReadOnlyStatus(project,aClass))   return;
  final PsiClass[] bases=aClass.getSupers();
  @NonNls final String javaLangObject="java.lang.Object";
  if (bases.length == 0 || bases.length == 1 && javaLangObject.equals(bases[0].getQualifiedName())) {
    String message=RefactoringBundle.getCannotRefactorMessage(RefactoringBundle.message("class.does.not.have.base.classes.or.interfaces",aClass.getQualifiedName()));
    CommonRefactoringUtil.showErrorMessage(REFACTORING_NAME,message,null,project);
    return;
  }
  final HashMap<PsiClass,MemberInfo[]> basesToMemberInfos=new HashMap<PsiClass,MemberInfo[]>();
  for (  PsiClass base : bases) {
    basesToMemberInfos.put(base,createBaseClassMemberInfos(base));
  }
  new InheritanceToDelegationDialog(project,aClass,bases,basesToMemberInfos).show();
}
