{
  String keyStoreLocation=myKeystoreLocationField.getText().trim();
  if (keyStoreLocation.length() == 0) {
    throw new CommitStepException(AndroidBundle.message("android.export.package.specify.keystore.location.error"));
  }
  File file=new File(keyStoreLocation);
  if (myNewKeystoreButton.isSelected()) {
    checkNewKeystoreOptions(file);
  }
 else {
    KeyStore keyStore=checkExistingKeystoreOptionsAndCreateKeystore(file);
    if (keyStore != null) {
      myWizard.setKeystore(keyStore);
    }
 else {
      throw new CommitStepException(AndroidBundle.message("android.export.package.keystore.error.title"));
    }
    PropertiesComponent.getInstance(myWizard.getProject()).setValue(DEFAULT_KEYSTORE_LOCATION,keyStoreLocation);
  }
  myWizard.setKeystoreLocation(keyStoreLocation);
  myWizard.setKeystorePassword(myKeystorePasswordField.getPassword());
}
