{
  if (!caret.isUpToDate()) {
    return false;
  }
  EditorImpl editor=caret.getEditor();
  SoftWrapModel softWrapModel=editor.getSoftWrapModel();
  int offset=caret.getOffset();
  SoftWrap softWrap=softWrapModel.getSoftWrap(offset);
  if (softWrap == null) {
    return false;
  }
  return editor.offsetToVisualLine(offset) == caret.getVisualPosition().line;
}
