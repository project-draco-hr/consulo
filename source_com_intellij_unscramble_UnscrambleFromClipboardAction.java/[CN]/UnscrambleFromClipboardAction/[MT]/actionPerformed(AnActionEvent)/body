{
  Project project=(Project)e.getDataContext().getData(DataConstants.PROJECT);
  String text=UnscrambleDialog.getTextInClipboard();
  if (text != null) {
    String file=UnscrambleDialog.getLastUsedLogUrl();
    if (file != null && file.trim().length() == 0) {
      file=null;
    }
    UnscrambleSupport savedUnscrambler=UnscrambleDialog.getSavedUnscrambler();
    if (savedUnscrambler == null || file != null) {
      boolean success=UnscrambleDialog.showUnscrambledText(savedUnscrambler,file,project,text);
      if (success) {
        return;
      }
    }
  }
  UnscrambleDialog dialog=new UnscrambleDialog(project);
  dialog.show();
}
