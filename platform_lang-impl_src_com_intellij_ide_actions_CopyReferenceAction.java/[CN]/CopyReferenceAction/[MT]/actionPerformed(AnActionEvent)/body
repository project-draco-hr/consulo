{
  DataContext dataContext=e.getDataContext();
  Editor editor=PlatformDataKeys.EDITOR.getData(dataContext);
  Project project=PlatformDataKeys.PROJECT.getData(dataContext);
  PsiElement element=getElementToCopy(editor,dataContext);
  if (!doCopy(element,project,editor))   return;
  HighlightManager highlightManager=HighlightManager.getInstance(project);
  EditorColorsManager manager=EditorColorsManager.getInstance();
  TextAttributes attributes=manager.getGlobalScheme().getAttributes(EditorColors.SEARCH_RESULT_ATTRIBUTES);
  if (editor != null) {
    PsiElement nameIdentifier=HighlightUsagesHandler.getNameIdentifier(element);
    if (nameIdentifier != null) {
      highlightManager.addOccurrenceHighlights(editor,new PsiElement[]{nameIdentifier},attributes,true,null);
    }
 else {
      PsiReference reference=TargetElementUtilBase.findReference(editor,editor.getCaretModel().getOffset());
      if (reference != null) {
        highlightManager.addOccurrenceHighlights(editor,new PsiReference[]{reference},attributes,true,null);
      }
 else {
        highlightManager.addOccurrenceHighlights(editor,new PsiElement[]{element},attributes,true,null);
      }
    }
  }
}
