{
  if (!(virtualFile instanceof LightVirtualFile)) {
    throw new UnsupportedOperationException();
  }
  ((LightVirtualFile)virtualFile).setLanguage(language);
  ((LightVirtualFile)virtualFile).setContent(getDocument(),getDocument().getText(),false);
  FileContentUtil.reparseFiles(project,Collections.singletonList(virtualFile),false);
}
