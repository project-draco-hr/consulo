{
  final int componentCount=parent.getComponentCount();
  if (componentCount == 0)   return;
  final EditorEx history=myHistoryViewer;
  final EditorEx editor=componentCount == 2 ? myConsoleEditor : null;
  if (editor == null) {
    parent.getComponent(0).setBounds(parent.getBounds());
    return;
  }
  final Dimension panelSize=parent.getSize();
  if (panelSize.getHeight() <= 0)   return;
  final Dimension historySize=history.getContentSize();
  final Dimension editorSize=editor.getContentSize();
  final Dimension newEditorSize=new Dimension();
  final int width=Math.max(editorSize.width,historySize.width);
  newEditorSize.width=width + editor.getScrollPane().getHorizontalScrollBar().getHeight();
  history.getSoftWrapModel().forceAdditionalColumnsUsage();
  editor.getSettings().setAdditionalColumnsCount(2 + (width - editorSize.width) / EditorUtil.getSpaceWidth(Font.PLAIN,editor));
  history.getSettings().setAdditionalColumnsCount(2 + (width - historySize.width) / EditorUtil.getSpaceWidth(Font.PLAIN,history));
  if (historySize.width == 0)   historySize.height=0;
  final int minHistorySize=historySize.height > 0 ? 2 * history.getLineHeight() + (myShowSeparatorLine ? SEPARATOR_THICKNESS : 0) : 0;
  final int minEditorSize=editor.isViewer() ? 0 : editor.getLineHeight();
  final int editorPreferred=editor.isViewer() ? 0 : Math.max(minEditorSize,editorSize.height);
  final int historyPreferred=Math.max(minHistorySize,historySize.height);
  if (panelSize.height < minEditorSize) {
    newEditorSize.height=panelSize.height;
  }
 else   if (panelSize.height < editorPreferred) {
    newEditorSize.height=panelSize.height - minHistorySize;
  }
 else   if (panelSize.height < editorPreferred + historyPreferred) {
    newEditorSize.height=editorPreferred;
  }
 else {
    newEditorSize.height=editorPreferred == 0 ? 0 : panelSize.height - historyPreferred;
  }
  final Dimension newHistorySize=new Dimension(width,panelSize.height - newEditorSize.height);
  editor.getComponent().setBounds(0,newHistorySize.height,panelSize.width,newEditorSize.height);
  myForceScrollToEnd.compareAndSet(false,shouldScrollHistoryToEnd());
  history.getComponent().setBounds(0,0,panelSize.width,newHistorySize.height);
}
