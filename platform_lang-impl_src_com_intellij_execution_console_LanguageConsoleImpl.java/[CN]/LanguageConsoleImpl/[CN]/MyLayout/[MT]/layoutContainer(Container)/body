{
  final int componentCount=parent.getComponentCount();
  if (componentCount == 0) {
    return;
  }
  final EditorEx history=myHistoryViewer;
  final EditorEx input=componentCount == 2 ? myConsoleEditor : null;
  if (input == null) {
    parent.getComponent(0).setBounds(parent.getBounds());
    return;
  }
  final Dimension panelSize=parent.getSize();
  if (panelSize.getHeight() <= 0) {
    return;
  }
  final Dimension historySize=history.getContentSize();
  final Dimension inputSize=input.getContentSize();
  int newInputHeight;
  final int width=Math.max(inputSize.width,historySize.width);
  if (isHistoryViewerForceAdditionalColumnsUsage()) {
    history.getSoftWrapModel().forceAdditionalColumnsUsage();
    input.getSettings().setAdditionalColumnsCount(2 + (width - inputSize.width) / EditorUtil.getSpaceWidth(Font.PLAIN,input));
    history.getSettings().setAdditionalColumnsCount(2 + (width - historySize.width) / EditorUtil.getSpaceWidth(Font.PLAIN,history));
  }
  if (history.getDocument().getLineCount() == 0) {
    historySize.height=0;
  }
  int minHistoryHeight=historySize.height > 0 ? (getMinHistoryLineCount() * history.getLineHeight() + (myShowSeparatorLine ? SEPARATOR_THICKNESS : 0)) : 0;
  int minInputHeight=input.isViewer() ? 0 : input.getLineHeight();
  final int inputPreferredHeight=input.isViewer() ? 0 : Math.max(minInputHeight,inputSize.height);
  final int historyPreferredHeight=Math.max(minHistoryHeight,historySize.height);
  if (panelSize.height < minInputHeight) {
    newInputHeight=panelSize.height;
  }
 else   if (panelSize.height < inputPreferredHeight) {
    newInputHeight=panelSize.height - minHistoryHeight;
  }
 else   if (panelSize.height < (inputPreferredHeight + historyPreferredHeight) || inputPreferredHeight == 0) {
    newInputHeight=inputPreferredHeight;
  }
 else {
    newInputHeight=panelSize.height - historyPreferredHeight;
  }
  int newHistoryHeight=panelSize.height - newInputHeight;
  input.getComponent().setBounds(0,newHistoryHeight,panelSize.width,newInputHeight);
  myForceScrollToEnd.compareAndSet(false,shouldScrollHistoryToEnd());
  history.getComponent().setBounds(0,0,panelSize.width,newHistoryHeight);
}
