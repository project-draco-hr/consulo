{
  setupEditorDefault(myConsoleEditor);
  setupEditorDefault(myHistoryViewer);
  setPrompt(myPrompt);
  myConsoleEditor.addEditorMouseListener(EditorActionUtil.createEditorPopupHandler(IdeActions.GROUP_CUT_COPY_PASTE));
  if (SEPARATOR_THICKNESS > 0) {
    myHistoryViewer.getComponent().setBorder(new SideBorder(Color.LIGHT_GRAY,SideBorder.BOTTOM));
  }
  myHistoryViewer.getComponent().setMinimumSize(new Dimension(0,0));
  myHistoryViewer.getComponent().setPreferredSize(new Dimension(0,0));
  myConsoleEditor.getSettings().setAdditionalLinesCount(2);
  myConsoleEditor.setHighlighter(EditorHighlighterFactory.getInstance().createEditorHighlighter(myProject,myFile.getVirtualFile()));
  myHistoryViewer.setCaretVisible(false);
  myConsoleEditor.setHorizontalScrollbarVisible(true);
  final VisibleAreaListener areaListener=new VisibleAreaListener(){
    public void visibleAreaChanged(    VisibleAreaEvent e){
      final int offset=myConsoleEditor.getScrollingModel().getHorizontalScrollOffset();
      final ScrollingModel model=myHistoryViewer.getScrollingModel();
      final int historyOffset=model.getHorizontalScrollOffset();
      if (historyOffset != offset) {
        try {
          model.disableAnimation();
          model.scrollHorizontally(offset);
        }
  finally {
          model.enableAnimation();
        }
      }
    }
  }
;
  myConsoleEditor.getScrollingModel().addVisibleAreaListener(areaListener);
  final DocumentAdapter docListener=new DocumentAdapter(){
    @Override public void documentChanged(    final DocumentEvent e){
      queueUiUpdate(false);
    }
  }
;
  myEditorDocument.addDocumentListener(docListener,this);
  myHistoryViewer.getDocument().addDocumentListener(docListener,this);
  myHistoryViewer.getContentComponent().addKeyListener(new KeyAdapter(){
    public void keyTyped(    KeyEvent event){
      if (UIUtil.isReallyTypedEvent(event)) {
        myConsoleEditor.getContentComponent().requestFocus();
        myConsoleEditor.processKeyTyped(event);
      }
    }
  }
);
  for (  AnAction action : createActions()) {
    action.registerCustomShortcutSet(action.getShortcutSet(),myConsoleEditor.getComponent());
  }
  registerActionShortcuts(myHistoryViewer.getComponent());
}
