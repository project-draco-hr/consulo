{
  String text;
  EditorHighlighter highlighter;
  if (inputEditor instanceof EditorWindow) {
    PsiFile file=((EditorWindow)inputEditor).getInjectedFile();
    highlighter=HighlighterFactory.createHighlighter(file.getVirtualFile(),EditorColorsManager.getInstance().getGlobalScheme(),console.getProject());
    String fullText=InjectedLanguageUtil.getUnescapedText(file,null,null);
    highlighter.setText(fullText);
    text=textRange.substring(fullText);
  }
 else {
    text=inputEditor.getDocument().getText(textRange);
    highlighter=((EditorEx)inputEditor).getHighlighter();
  }
  SyntaxHighlighter syntax=highlighter instanceof LexerEditorHighlighter ? ((LexerEditorHighlighter)highlighter).getSyntaxHighlighter() : null;
  ((LanguageConsoleImpl)console).doAddPromptToHistory();
  if (syntax != null) {
    ConsoleViewUtil.printWithHighlighting(console,text,syntax);
  }
 else {
    console.print(text,ConsoleViewContentType.USER_INPUT);
  }
  console.print("\n",ConsoleViewContentType.NORMAL_OUTPUT);
  return text;
}
