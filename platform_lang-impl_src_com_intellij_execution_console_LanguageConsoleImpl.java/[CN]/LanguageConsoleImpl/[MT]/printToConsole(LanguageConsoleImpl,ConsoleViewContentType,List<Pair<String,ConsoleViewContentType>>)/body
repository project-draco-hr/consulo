{
  final List<Pair<String,TextAttributes>> attributedText=Lists.transform(textToPrint,new Function<Pair<String,ConsoleViewContentType>,Pair<String,TextAttributes>>(){
    @Override public Pair<String,TextAttributes> apply(    final Pair<String,ConsoleViewContentType> input){
      final TextAttributes mainAttributes=mainType.getAttributes();
      final TextAttributes attributes;
      if (input.getSecond() == null) {
        attributes=mainAttributes;
      }
 else {
        attributes=input.getSecond().getAttributes().clone();
        attributes.setBackgroundColor(mainAttributes.getBackgroundColor());
      }
      return Pair.create(input.getFirst(),attributes);
    }
  }
);
  Application application=ApplicationManager.getApplication();
  if (application.isDispatchThread()) {
    console.printToHistory(attributedText);
  }
 else {
    application.invokeLater(new Runnable(){
      public void run(){
        console.printToHistory(attributedText);
      }
    }
,ModalityState.stateForComponent(console.getComponent()));
  }
}
