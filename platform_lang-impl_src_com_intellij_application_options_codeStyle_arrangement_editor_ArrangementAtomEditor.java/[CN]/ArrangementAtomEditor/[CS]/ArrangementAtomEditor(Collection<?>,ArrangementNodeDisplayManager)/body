{
  String[] uiValues=new String[values.size()];
  int i=0;
  for (  Object value : values) {
    String uiValue=manager.getDisplayValue(value);
    uiValues[i++]=uiValue;
    myValues.put(uiValue,value);
  }
  Arrays.sort(uiValues);
  myValueBox=new JComboBox(uiValues);
  setLayout(new GridBagLayout());
  add(myValueBox,new GridBag().anchor(GridBagConstraints.CENTER).weightx(1).fillCellHorizontally());
  FontMetrics metrics=myValueBox.getFontMetrics(myValueBox.getFont());
  int maxWidth=0;
  String widestText=null;
  for (  String value : uiValues) {
    int width=metrics.stringWidth(value);
    if (width > maxWidth) {
      widestText=value;
      maxWidth=width;
    }
  }
  if (widestText != null) {
    myValueBox.setSelectedItem(widestText);
  }
  myPrefSize=super.getPreferredSize();
  if (uiValues.length > 0) {
    myValueBox.setSelectedItem(uiValues[0]);
  }
}
