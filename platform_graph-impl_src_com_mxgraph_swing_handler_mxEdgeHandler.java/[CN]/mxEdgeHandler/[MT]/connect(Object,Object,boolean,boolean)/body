{
  mxGraph graph=graphComponent.getGraph();
  mxIGraphModel model=graph.getModel();
  model.beginUpdate();
  try {
    if (isClone) {
      Object clone=graph.cloneCells(new Object[]{edge})[0];
      Object parent=model.getParent(edge);
      graph.addCells(new Object[]{clone},parent);
      Object other=model.getTerminal(edge,!isSource);
      graph.connectCell(clone,other,!isSource);
      graph.setSelectionCell(clone);
      edge=clone;
    }
    graph.connectCell(edge,terminal,isSource,new mxConnectionConstraint());
  }
  finally {
    model.endUpdate();
  }
}
