{
  Graphics2D g2=(Graphics2D)g;
  Stroke stroke=g2.getStroke();
  g2.setStroke(getSelectionStroke());
  g.setColor(getSelectionColor());
  Point last=state.getAbsolutePoint(0).getPoint();
  for (int i=1; i < state.getAbsolutePointCount(); i++) {
    Point current=state.getAbsolutePoint(i).getPoint();
    Line2D line=new Line2D.Float(last.x,last.y,current.x,current.y);
    Rectangle bounds=g2.getStroke().createStrokedShape(line).getBounds();
    if (g.hitClip(bounds.x,bounds.y,bounds.width,bounds.height)) {
      g2.draw(line);
    }
    last=current;
  }
  g2.setStroke(stroke);
  super.paint(g);
}
