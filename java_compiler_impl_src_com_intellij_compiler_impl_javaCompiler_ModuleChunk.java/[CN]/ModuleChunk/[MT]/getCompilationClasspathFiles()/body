{
  final Set<Module> modules=getNodes();
  OrderedSet<VirtualFile> cpFiles=new OrderedSet<VirtualFile>(TObjectHashingStrategy.CANONICAL);
  for (  final Module module : modules) {
    OrderEnumerator enumerator=OrderEnumerator.orderEntries(module).compileOnly().satisfying(new AfterJdkOrderEntryCondition());
    if ((mySourcesFilter & TEST_SOURCES) == 0) {
      enumerator=enumerator.productionOnly();
    }
    cpFiles.addAll(enumerator.recursively().exportedOnly().getClassesRoots());
  }
  cpFiles=JarClasspathHelper.patchFiles(cpFiles,myContext.getProject());
  return cpFiles;
}
