{
  final Set<Module> modules=getNodes();
  final OrderedSet<VirtualFile> cpFiles=new OrderedSet<VirtualFile>(TObjectHashingStrategy.CANONICAL);
  for (  final Module module : modules) {
    final OrderEntry[] orderEntries=ModuleRootManager.getInstance(module).getOrderEntries();
    boolean skip=true;
    for (    OrderEntry orderEntry : orderEntries) {
      if (orderEntry instanceof JdkOrderEntry) {
        skip=false;
        continue;
      }
      if (skip) {
        continue;
      }
      VirtualFile[] files=orderEntry.getFiles((mySourcesFilter & TEST_SOURCES) == 0 ? OrderRootType.PRODUCTION_COMPILATION_CLASSES : OrderRootType.COMPILATION_CLASSES);
      if (orderEntry instanceof ModuleOrderEntry) {
        Project project=module.getProject();
        JarClasspathHelper.patchFiles(files,project);
      }
      cpFiles.addAll(Arrays.asList(files));
    }
  }
  return cpFiles;
}
