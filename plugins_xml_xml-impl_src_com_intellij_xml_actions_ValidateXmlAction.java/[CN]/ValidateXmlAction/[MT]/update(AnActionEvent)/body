{
  super.update(event);
  Presentation presentation=event.getPresentation();
  PsiElement psiElement=LangDataKeys.PSI_FILE.getData(event.getDataContext());
  boolean flag=psiElement instanceof XmlFile;
  presentation.setVisible(flag);
  boolean value=psiElement instanceof XmlFile;
  if (value) {
    final PsiFile containingFile=psiElement.getContainingFile();
    if (containingFile != null && (containingFile.getFileType() == StdFileTypes.XML || containingFile.getFileType() == StdFileTypes.XHTML)) {
      value=containingFile.getUserData(runningValidationKey) == null;
    }
 else {
      value=false;
    }
  }
  presentation.setEnabled(value);
  if (ActionPlaces.isPopupPlace(event.getPlace())) {
    presentation.setVisible(value);
  }
}
