{
  IntentionAction action=findActionWithText(text);
  if (action == null) {
    if (actionShouldBeAvailable) {
      fail("Action with text '" + text + "' is not available in test "+ testFullPath);
    }
  }
 else {
    if (!actionShouldBeAvailable) {
      fail("Action '" + text + "' is available in test "+ testFullPath);
    }
    action.invoke(getProject(),getEditor(),getFile());
    if (!shouldBeAvailableAfterExecution()) {
      final IntentionAction afterAction=findActionWithText(text);
      if (afterAction != null) {
        fail("Action '" + text + "' is still available after it's invocation in test "+ testFullPath);
      }
    }
    final String expectedFilePath=getBasePath() + "/after" + testName;
    checkResultByFile("In file :" + expectedFilePath,expectedFilePath,false);
  }
}
