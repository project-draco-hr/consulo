{
  Content content=null;
  if (descriptor != null) {
    if (descriptor.isContentReuseProhibited()) {
      return null;
    }
    final Content attachedContent=descriptor.getAttachedContent();
    if (attachedContent != null && attachedContent.isValid() && contentManager.getIndexOfContent(attachedContent) != -1 && (Comparing.equal(descriptor.getDisplayName(),attachedContent.getDisplayName()) || !attachedContent.isPinned())) {
      content=attachedContent;
    }
  }
  if (content == null) {
    content=getContentFromManager(contentManager,preferredName,executionId);
  }
  if (content == null || !isTerminated(content) || (content.getExecutionId() == executionId && executionId != 0)) {
    return null;
  }
  final RunContentDescriptor oldDescriptor=getRunContentDescriptorByContent(content);
  if (oldDescriptor != null && !oldDescriptor.isContentReuseProhibited()) {
    return oldDescriptor;
  }
  return null;
}
