{
  if (macroName != null) {
    myRecordingMacro.setName(macroName);
    myMacros.add(myRecordingMacro);
    myRecordingMacro=null;
  }
 else {
    for (int i=0; i < myMacros.size(); i++) {
      ActionMacro macro=myMacros.get(i);
      if (IdeBundle.message("macro.noname").equals(macro.getName())) {
        myMacros.set(i,myRecordingMacro);
        myRecordingMacro=null;
        break;
      }
    }
    if (myRecordingMacro != null) {
      myMacros.add(myRecordingMacro);
      myRecordingMacro=null;
    }
  }
}
