{
  myActionManager=actionManagerEx;
  myActionManager.addAnActionListener(new AnActionListener(){
    public void beforeActionPerformed(    AnAction action,    DataContext dataContext,    final AnActionEvent event){
      if (myIsRecording) {
        String id=myActionManager.getId(action);
        if (id != null && !"StartStopMacroRecording".equals(id)) {
          myRecordingMacro.appendAction(id);
          String shortcut=null;
          if (event.getInputEvent() instanceof KeyEvent) {
            shortcut=KeymapUtil.getKeystrokeText(KeyStroke.getKeyStrokeForEvent((KeyEvent)event.getInputEvent()));
          }
          notifyUser(id + (shortcut != null ? " (" + shortcut + ")" : ""),false);
        }
        if (id != null) {
          myLastActionInputEvent.add(event.getInputEvent());
        }
      }
    }
    public void beforeEditorTyping(    char c,    DataContext dataContext){
    }
    public void afterActionPerformed(    final AnAction action,    final DataContext dataContext,    final AnActionEvent event){
    }
  }
);
  myKeyProcessor=new MyKeyPostpocessor();
  IdeEventQueue.getInstance().addPostprocessor(myKeyProcessor,null);
}
