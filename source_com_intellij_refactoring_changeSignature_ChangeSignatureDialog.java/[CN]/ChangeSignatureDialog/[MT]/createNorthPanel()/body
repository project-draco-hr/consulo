{
  JPanel panel=new JPanel(new VerticalFlowLayout(VerticalFlowLayout.TOP));
  if (myAllowDelegation) {
    myDelegationPanel=createDelegationPanel();
    panel.add(myDelegationPanel);
  }
  if (!myMethod.isConstructor()) {
    JLabel namePrompt=new JLabel("Name:");
    panel.add(namePrompt);
    myNameField=new EditorTextField(myMethod.getName());
    namePrompt.setLabelFor(myNameField);
    namePrompt.setDisplayedMnemonic('N');
    panel.add(myNameField);
    JLabel typePrompt=new JLabel("Return type:");
    panel.add(typePrompt);
    final PsiElementFactory factory=myMethod.getManager().getElementFactory();
    myReturnTypeCodeFragment=factory.createTypeCodeFragment(myMethod.getReturnTypeElement().getText(),myMethod.getParameterList(),true,true);
    final Document document=PsiDocumentManager.getInstance(myProject).getDocument(myReturnTypeCodeFragment);
    myReturnTypeField=new EditorTextField(document,myProject,StdFileTypes.JAVA);
    typePrompt.setLabelFor(myReturnTypeField);
    typePrompt.setDisplayedMnemonic('t');
    panel.add(myReturnTypeField);
    myReturnTypeField.setText(factory.createTypeElement(myMethod.getReturnType()).getText());
    final DocumentListener documentListener=new DocumentListener(){
      public void beforeDocumentChange(      DocumentEvent event){
      }
      public void documentChanged(      DocumentEvent event){
        updateSignature();
      }
    }
;
    myNameField.addDocumentListener(documentListener);
    myReturnTypeField.addDocumentListener(documentListener);
  }
  return panel;
}
