{
  final String addressDisplayName=DebuggerBundle.getAddressDisplayName(remoteConnection);
  final String transportName=DebuggerBundle.getTransportName(remoteConnection);
  final Module[] modules=profile.getModules();
  if (modules.length == 0) {
    mySearchScope=GlobalSearchScope.allScope(getProject());
  }
 else {
    GlobalSearchScope scope=GlobalSearchScope.moduleRuntimeScope(modules[0],true);
    for (int idx=1; idx < modules.length; idx++) {
      Module module=modules[idx];
      scope=scope.uniteWith(GlobalSearchScope.moduleRuntimeScope(module,true));
    }
    mySearchScope=scope;
  }
  final ExecutionResult executionResult=myDebugProcess.attachVirtualMachine(executor,runner,this,state,remoteConnection,pollConnection);
  getContextManager().setState(SESSION_EMPTY_CONTEXT,STATE_WAITING_ATTACH,EVENT_START_WAIT_ATTACH,DebuggerBundle.message("status.waiting.attach",addressDisplayName,transportName));
  return executionResult;
}
