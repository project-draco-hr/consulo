{
  super.valueChanged(event);
  boolean enableButtons=false;
  int selected=getSelectedRow();
  if (selected >= 0 && selected < myTreeTable.getRowCount()) {
    TemplateSettings templateSettings=TemplateSettings.getInstance();
    TemplateKey templateKey=getTemplateKey(selected);
    if (templateKey != null) {
      TemplateImpl template=(TemplateImpl)myTemplates.get(templateKey);
      if (template != null) {
        templateSettings.setLastSelectedTemplateKey(template.getKey());
      }
    }
 else {
      templateSettings.setLastSelectedTemplateKey(null);
    }
    DefaultMutableTreeNode node=(DefaultMutableTreeNode)myTreeTable.getTree().getPathForRow(selected).getLastPathComponent();
    enableButtons=!(node.getUserObject() instanceof String);
  }
  updateTemplateTextArea();
  if (myCopyButton != null) {
    myCopyButton.setEnabled(enableButtons);
    myEditButton.setEnabled(enableButtons);
    myRemoveButton.setEnabled(enableButtons);
  }
}
