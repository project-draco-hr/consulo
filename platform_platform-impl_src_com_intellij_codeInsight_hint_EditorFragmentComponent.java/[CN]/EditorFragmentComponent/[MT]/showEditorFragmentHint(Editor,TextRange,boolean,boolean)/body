{
  if (!(editor instanceof EditorEx))   return null;
  JRootPane rootPane=editor.getComponent().getRootPane();
  if (rootPane == null)   return null;
  JLayeredPane layeredPane=rootPane.getLayeredPane();
  int lineHeight=editor.getLineHeight();
  int overhang=editor.getScrollingModel().getVisibleArea().y - editor.logicalPositionToXY(editor.offsetToLogicalPosition(range.getEndOffset())).y;
  int yRelative=overhang > 0 && overhang < lineHeight ? lineHeight - overhang + JBUI.scale(LINE_BORDER_THICKNESS + EMPTY_BORDER_THICKNESS) : 0;
  Point point=SwingUtilities.convertPoint(((EditorEx)editor).getScrollPane().getViewport(),-2,yRelative,layeredPane);
  return showEditorFragmentHintAt(editor,range,point.y,true,showFolding,hideByAnyKey,true,false);
}
