{
  final DataContext dataContext=e.getDataContext();
  final Presentation presentation=e.getPresentation();
  presentation.setEnabled(false);
  presentation.setVisible(false);
  final Project project=CommonDataKeys.PROJECT.getData(dataContext);
  if (project != null) {
    final CoverageSuitesBundle currentSuite=CoverageDataManager.getInstance(project).getCurrentSuitesBundle();
    if (currentSuite != null) {
      final CoverageEngine coverageEngine=currentSuite.getCoverageEngine();
      if (coverageEngine.isReportGenerationAvailable(project,dataContext,currentSuite)) {
        presentation.setEnabled(true);
        presentation.setVisible(true);
      }
    }
  }
}
