{
  if (mySectionRuleManager == null || getModel().getSize() < index) {
    return null;
  }
  int startSectionIndex=-1;
  final Set<String> rules=ContainerUtil.newHashSet();
  for (int i=0; i < index; i++) {
    final ArrangementSectionRuleData section=extractSectionText(i);
    if (section != null) {
      startSectionIndex=section.isSectionStart() ? i : -1;
      if (StringUtil.isNotEmpty(section.getText())) {
        rules.add(section.getText());
      }
    }
  }
  final ArrangementSectionRuleData data=extractSectionText(index);
  if (data != null) {
    if (StringUtil.isNotEmpty(data.getText()) && rules.contains(data.getText())) {
      return ApplicationBundle.message("arrangement.settings.validation.duplicate.section.text");
    }
    if (!data.isSectionStart()) {
      if (startSectionIndex == -1) {
        return ApplicationBundle.message("arrangement.settings.validation.end.section.rule.without.start");
      }
 else       if (startSectionIndex == index - 1) {
        return ApplicationBundle.message("arrangement.settings.validation.empty.section.rule");
      }
    }
  }
  return null;
}
