{
  if (getModel().getSize() <= 0) {
    return Collections.emptyList();
  }
  final List<ArrangementSectionRule> result=ContainerUtil.newArrayList();
  final List<StdArrangementMatchRule> currentRules=ContainerUtil.newArrayList();
  String currentSectionStart=null;
  for (int i=0; i < getModel().getSize(); i++) {
    Object element=getModel().getElementAt(i);
    if (element instanceof StdArrangementMatchRule) {
      final ArrangementSectionRuleData sectionRule=mySectionRuleManager == null ? null : mySectionRuleManager.getSectionRuleData((StdArrangementMatchRule)element);
      if (sectionRule != null) {
        if (sectionRule.isSectionStart()) {
          if (currentSectionStart != null) {
            result.add(ArrangementSectionRule.create(currentSectionStart,null,currentRules));
            currentRules.clear();
          }
          currentSectionStart=sectionRule.getText();
        }
 else {
          result.add(ArrangementSectionRule.create(StringUtil.notNullize(currentSectionStart),sectionRule.getText(),currentRules));
          currentRules.clear();
          currentSectionStart=null;
        }
      }
 else       if (currentSectionStart == null) {
        result.add(ArrangementSectionRule.create((StdArrangementMatchRule)element));
      }
 else {
        currentRules.add((StdArrangementMatchRule)element);
      }
    }
  }
  if (currentSectionStart != null) {
    result.add(ArrangementSectionRule.create(currentSectionStart,null,currentRules));
  }
  return result;
}
