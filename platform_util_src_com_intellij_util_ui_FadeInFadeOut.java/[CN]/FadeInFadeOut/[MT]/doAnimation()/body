{
  if (myTriggered || !isShowing())   return;
  myTriggered=true;
  long startTime=System.currentTimeMillis();
  while (true) {
    paintImmediately(0,0,getWidth(),getHeight());
    final long timeSpent=System.currentTimeMillis() - startTime;
    if (timeSpent >= myTimeToComplete) {
      return;
    }
    double linearProgress=Math.max(0,Math.min(1,(double)timeSpent / myTimeToComplete));
    if (!myFadeIn)     linearProgress=1 - linearProgress;
    myRatio=(1 - Math.cos(Math.PI * linearProgress)) / 2;
  }
}
