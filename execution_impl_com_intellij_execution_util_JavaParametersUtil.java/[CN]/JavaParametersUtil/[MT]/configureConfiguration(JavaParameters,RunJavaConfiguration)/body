{
  parameters.getProgramParametersList().addParametersString(configuration.getProperty(RunJavaConfiguration.PROGRAM_PARAMETERS_PROPERTY));
  parameters.getVMParametersList().addParametersString(configuration.getProperty(RunJavaConfiguration.VM_PARAMETERS_PROPERTY));
  String workingDirectory=configuration.getProperty(RunJavaConfiguration.WORKING_DIRECTORY_PROPERTY);
  if (workingDirectory == null || workingDirectory.trim().length() == 0) {
    final VirtualFile projectFile=configuration.getProject().getProjectFile();
    if (projectFile != null) {
      workingDirectory=PathUtil.getLocalPath(projectFile.getParent());
    }
  }
  parameters.setWorkingDirectory(workingDirectory);
}
