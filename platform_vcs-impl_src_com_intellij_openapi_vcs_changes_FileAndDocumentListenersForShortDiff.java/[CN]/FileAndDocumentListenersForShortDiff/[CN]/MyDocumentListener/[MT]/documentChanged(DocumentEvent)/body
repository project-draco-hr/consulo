{
  final VirtualFile vf=myFileDocumentManager.getFile(event.getDocument());
  if (vf != null) {
    final FilePath filePath=myDiffDetails.getCurrentFilePath();
    if (filePath != null && filePath.getVirtualFile() != null && filePath.getVirtualFile().equals(vf)) {
      SwingUtilities.invokeLater(new Runnable(){
        @Override public void run(){
          if (!updateSynchronously()) {
            impl(vf);
          }
        }
      }
);
    }
 else {
      impl(vf);
    }
  }
}
