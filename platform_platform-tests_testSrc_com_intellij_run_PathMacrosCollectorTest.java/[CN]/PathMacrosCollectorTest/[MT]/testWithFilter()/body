{
  Element root=new Element("root");
  final Element testTag=new Element("test");
  testTag.setAttribute("path","$MACRO$");
  testTag.setAttribute("ignore","$PATH$");
  root.addContent(testTag);
  final Set<String> macros=PathMacrosCollector.getMacroNames(root,null,null,new PathMacrosImpl());
  assertEquals(2,macros.size());
  assertTrue(macros.contains("MACRO"));
  assertTrue(macros.contains("PATH"));
  final Set<String> filtered=PathMacrosCollector.getMacroNames(root,new NotNullFunction<Object,Boolean>(){
    @Override @NotNull public Boolean fun(    Object o){
      if (o instanceof Attribute && "ignore".equals(((Attribute)o).getName()))       return false;
      return true;
    }
  }
,null,new PathMacrosImpl());
  assertEquals(1,filtered.size());
  assertTrue(macros.contains("MACRO"));
}
