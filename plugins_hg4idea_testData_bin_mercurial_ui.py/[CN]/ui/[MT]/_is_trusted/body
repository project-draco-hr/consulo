def _is_trusted(self, fp, f):
    st = util.fstat(fp)
    if util.isowner(st):
        return True
    (tusers, tgroups) = (self._trustusers, self._trustgroups)
    if (('*' in tusers) or ('*' in tgroups)):
        return True
    user = util.username(st.st_uid)
    group = util.groupname(st.st_gid)
    if ((user in tusers) or (group in tgroups) or (user == util.username())):
        return True
    if self._reportuntrusted:
        self.warn((_('Not trusting file %s from untrusted user %s, group %s\n') % (f, user, group)))
    return False
