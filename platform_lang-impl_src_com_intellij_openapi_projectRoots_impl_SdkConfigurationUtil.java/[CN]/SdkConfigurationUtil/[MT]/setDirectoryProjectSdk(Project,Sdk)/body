{
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    public void run(){
      ProjectRootManager.getInstance(project).setProjectJdk(sdk);
      final Module[] modules=ModuleManager.getInstance(project).getModules();
      if (modules.length > 0) {
        final ModifiableRootModel model=ModuleRootManager.getInstance(modules[0]).getModifiableModel();
        model.inheritSdk();
        model.commit();
      }
    }
  }
);
}
