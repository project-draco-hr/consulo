{
  return ApplicationManager.getApplication().runWriteAction(new Computable<Sdk>(){
    public Sdk compute(){
      final Sdk[] sdks=ProjectJdkTable.getInstance().getAllJdks();
      final String sdkName=createUniqueSdkName(sdkType,homeDir.getPath(),Arrays.asList(sdks));
      final ProjectJdkImpl projectJdk=new ProjectJdkImpl(sdkName,sdkType);
      projectJdk.setHomePath(homeDir.getPath());
      sdkType.setupSdkPaths(projectJdk);
      ProjectJdkTable.getInstance().addJdk(projectJdk);
      return projectJdk;
    }
  }
);
}
