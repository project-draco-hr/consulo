{
  final Runnable runnable=new Runnable(){
    public void run(){
      try {
        checkCanceled();
        sendRequests(requests,connectionStreams,communicationProgressHandler);
        checkCanceled();
        sendRequest(requests.getResponseExpectingRequest(),connectionStreams);
        connectionStreams.flushForReading();
        myResult=handleResponses(connectionStreams,new DefaultResponseHandler());
      }
 catch (      IOException e) {
        myIOException=e;
      }
catch (      CommandException e) {
        myCommandException=e;
      }
 finally {
        afterInRunnable();
      }
    }
  }
;
  before();
  callRunnable(runnable);
  if (myIOException != null)   throw new IOCommandException(myIOException);
  if (myCommandException != null)   throw myCommandException;
  after();
  return myResult;
}
