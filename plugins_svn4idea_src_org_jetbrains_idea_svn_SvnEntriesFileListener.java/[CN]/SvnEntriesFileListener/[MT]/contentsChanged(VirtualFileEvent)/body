{
  if (!event.isFromRefresh()) {
    return;
  }
  final VirtualFile file=event.getFile();
  if (isWcDbFile(file)) {
    LOG.debug("wc.db had changed");
    final List<File> affectedPaths=myChangeListManager.getAffectedPaths();
    myDirtyScopeManager.filePathsDirty(ObjectsConvertor.convert(affectedPaths,ObjectsConvertor.FILE_FILEPATH,ObjectsConvertor.NOT_NULL),null);
    return;
  }
  if (isEntriesFile(file) && file.getParent() != null) {
    VirtualFile parent=file.getParent();
    if (parent != null) {
      VirtualFile grandParent=parent.getParent();
      if (grandParent != null) {
        fireFileStatusesChanged(grandParent);
        fileEntriesChanged(grandParent);
      }
    }
    return;
  }
  final AbstractVcs vcsFor=myVcsManager.getVcsFor(file);
  if (vcsFor == null)   return;
  if (SvnVcs.VCS_NAME.equals(vcsFor.getName())) {
    final RootUrlInfo path=((SvnVcs)vcsFor).getSvnFileUrlMapping().getWcRootForFilePath(new File(file.getPath()));
    if (path != null && WorkingCopyFormat.ONE_DOT_SEVEN.equals(path.getFormat())) {
      VcsDirtyScopeManager.getInstance(myProject).filesDirty(Collections.singletonList(file),null);
      fileRevisionProbablyChanged(file);
    }
  }
}
