{
  Icon icon=(Icon)item.getAttribute(LookupItem.ICON_ATTR);
  if (icon == null) {
    Object o=item.getObject();
    if (o instanceof Iconable && !(o instanceof PsiElement)) {
      icon=((Iconable)o).getIcon(ICON_FLAGS);
    }
 else {
      if (o instanceof LookupValueWithPsiElement) {
        o=((LookupValueWithPsiElement)o).getElement();
      }
      if (o instanceof PsiElement) {
        final PsiElement element=(PsiElement)o;
        if (element.isValid()) {
          icon=element.getIcon(ICON_FLAGS);
        }
      }
    }
  }
  if (icon == null) {
    icon=EMPTY_ICON;
  }
 else   if (icon.getIconWidth() < EMPTY_ICON.getIconWidth()) {
    final RowIcon rowIcon=new RowIcon(2);
    rowIcon.setIcon(icon,0);
    rowIcon.setIcon(new EmptyIcon(EMPTY_ICON.getIconWidth() - icon.getIconWidth()),1);
    icon=rowIcon;
  }
  return icon;
}
