{
  final TIntObjectHashMap<BlockWrapper> result=new TIntObjectHashMap<BlockWrapper>();
  BlockWrapper current=first;
  while (current != null) {
    result.put(current.getTextRange().getStartOffset(),current);
    current=current.getNextBlock();
  }
  return result;
}
