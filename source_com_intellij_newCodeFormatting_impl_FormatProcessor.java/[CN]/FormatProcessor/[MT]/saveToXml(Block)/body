{
  final Element result=new Element("Block");
  final TextRange textRange=root.getTextRange();
  result.setAttribute("start",String.valueOf(textRange.getStartOffset()));
  result.setAttribute("stop",String.valueOf(textRange.getEndOffset()));
  final Alignment alignment=root.getAlignment();
  if (alignment != null) {
    result.addContent(save((AlignmentImpl)alignment));
  }
  final Indent indent=root.getIndent();
  if (indent != null) {
    result.addContent(save((IndentImpl)indent));
  }
  final Wrap wrap=root.getWrap();
  if (wrap != null) {
    result.addContent(save((WrapImpl)wrap));
  }
  final List<Block> subBlocks=root.getSubBlocks();
  Block prev=null;
  for (Iterator<Block> iterator=subBlocks.iterator(); iterator.hasNext(); ) {
    Block block=iterator.next();
    if (prev != null) {
      final SpaceProperty spaceProperty=root.getSpaceProperty(prev,block);
      if (spaceProperty != null) {
        result.addContent(save((SpacePropertyImpl)spaceProperty));
      }
    }
    result.addContent(saveToXml(block));
    prev=block;
  }
  result.addContent(new Text(root.toString()));
  return result;
}
