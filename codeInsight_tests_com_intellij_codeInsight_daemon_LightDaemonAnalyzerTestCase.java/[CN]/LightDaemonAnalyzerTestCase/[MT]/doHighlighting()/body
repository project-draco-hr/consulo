{
  PsiDocumentManager.getInstance(getProject()).commitAllDocuments();
  MockProgressIndicator progress=new MockProgressIndicator();
  int[] toIgnore=doFolding() ? new int[0] : new int[]{Pass.UPDATE_FOLDING};
  List<TextEditorHighlightingPass> passes=TextEditorHighlightingPassRegistrarEx.getInstanceEx(getProject()).instantiatePasses(getFile(),getEditor(),toIgnore);
  for (  TextEditorHighlightingPass pass : passes) {
    pass.collectInformation(progress);
  }
  for (  TextEditorHighlightingPass pass : passes) {
    pass.applyInformationToEditor();
  }
  List<HighlightInfo> infos=DaemonCodeAnalyzerImpl.getHighlights(getEditor().getDocument(),getProject());
  return infos == null ? Collections.<HighlightInfo>emptyList() : new ArrayList<HighlightInfo>(infos);
}
