{
  GitCheckoutDialog dialog=new GitCheckoutDialog(project,gitRoots,defaultRoot);
  dialog.show();
  if (!dialog.isOK()) {
    return;
  }
  GitSimpleHandler branch=dialog.createBranchHandler();
  if (branch != null) {
    branch.run();
  }
  GitLineHandler checkout=dialog.checkoutHandler();
  affectedRoots.add(dialog.gitRoot());
  try {
    GitHandlerUtil.doSynchronously(checkout,GitBundle.message("checking.out",dialog.getSourceBranch()),"git checkout");
  }
  finally {
    exceptions.addAll(checkout.errors());
    GitRepositoryManager.getInstance(project).updateRepository(dialog.gitRoot(),GitRepository.TrackedTopic.ALL_CURRENT);
  }
}
