{
  final FileAndDirsCollector dirtyFilesAndDirs=new FileAndDirsCollector();
  for (  VFileEvent event : events) {
    final VirtualFile file=getFileForEvent(event);
    if (file == null) {
      continue;
    }
    if (event instanceof VFileDeleteEvent) {
      if (!file.isInLocalFileSystem()) {
        continue;
      }
      dirtyFilesAndDirs.add(file);
    }
 else     if (event instanceof VFileMoveEvent || event instanceof VFilePropertyChangeEvent) {
      dirtyFilesAndDirs.addToFiles(file);
    }
  }
  dirtyFilesAndDirs.markDirty();
}
