{
  final boolean isDirectory=file.isDirectory();
  final FilePathImpl path=new FilePathImpl(new File(file.getPath()),isDirectory);
  final Collection<VcsDirtyScopeManager> managers=getManagers(file);
  for (  VcsDirtyScopeManager manager : managers) {
    Pair<HashSet<FilePath>,HashSet<FilePath>> filesAndDirs=map.get(manager);
    if (filesAndDirs == null) {
      filesAndDirs=Pair.create(new HashSet<FilePath>(),new HashSet<FilePath>());
      map.put(manager,filesAndDirs);
    }
    if (addToFiles || isDirectory) {
      filesAndDirs.first.add(path);
    }
 else {
      filesAndDirs.second.add(path);
    }
  }
}
