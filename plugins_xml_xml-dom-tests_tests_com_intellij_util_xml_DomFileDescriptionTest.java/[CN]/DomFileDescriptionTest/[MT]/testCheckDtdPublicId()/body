{
  getDomManager().registerFileDescription(new DomFileDescription(NamespacedElement.class,"xxx","bar"){
    @Override protected void initializeFileDescription(){
      registerNamespacePolicy("foo","bar");
    }
  }
,getTestRootDisposable());
  final PsiFile file=createFile("xxx.xml","<xxx/>");
  assertFalse(getDomManager().isDomFile(file));
  new WriteCommandAction(getProject()){
    @Override protected void run(    Result result) throws Throwable {
      final Document document=getDocument(file);
      document.insertString(0,"<!DOCTYPE xxx PUBLIC \"bar\" \"http://java.sun.com/dtd/ejb-jar_2_0.dtd\">\n");
      commitDocument(document);
    }
  }
.execute();
  assertTrue(getDomManager().isDomFile(file));
}
