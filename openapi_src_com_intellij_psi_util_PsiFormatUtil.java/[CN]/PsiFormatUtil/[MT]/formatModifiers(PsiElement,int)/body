{
  PsiModifierList list;
  if (element instanceof PsiVariable) {
    list=((PsiVariable)element).getModifierList();
  }
 else   if (element instanceof PsiMethod) {
    list=((PsiMethod)element).getModifierList();
  }
 else   if (element instanceof PsiClass) {
    list=((PsiClass)element).getModifierList();
    if (list == null)     return "";
  }
 else   if (element instanceof PsiClassInitializer) {
    list=((PsiClassInitializer)element).getModifierList();
    if (list == null)     return "";
  }
 else {
    throw new IllegalArgumentException();
  }
  if (list == null)   return "";
  PsiClass parentClass=element.getParent() instanceof PsiClass ? (PsiClass)element.getParent() : null;
  StringBuffer buffer=new StringBuffer();
  if (list.hasModifierProperty(PsiModifier.PUBLIC)) {
    if ((options & SHOW_REDUNDANT_MODIFIERS) != 0 || parentClass == null || !parentClass.isInterface()) {
      buffer.append("public ");
    }
  }
  if (list.hasModifierProperty(PsiModifier.PROTECTED)) {
    buffer.append("protected ");
  }
  if (list.hasModifierProperty(PsiModifier.PRIVATE)) {
    buffer.append("private ");
  }
  if (list.hasModifierProperty(PsiModifier.PACKAGE_LOCAL) && (options & SHOW_PACKAGE_LOCAL) != 0) {
    if (element instanceof PsiClass || element instanceof PsiMethod || element instanceof PsiField) {
      if (element instanceof PsiClass && element.getParent() instanceof PsiDeclarationStatement) {
        buffer.append("local ");
      }
 else {
        buffer.append("package local ");
      }
    }
  }
  if (list.hasModifierProperty(PsiModifier.STATIC)) {
    if ((options & SHOW_REDUNDANT_MODIFIERS) != 0 || !(element instanceof PsiField && parentClass != null && parentClass.isInterface())) {
      buffer.append("static ");
    }
  }
  if (list.hasModifierProperty(PsiModifier.ABSTRACT)) {
    if ((options & SHOW_REDUNDANT_MODIFIERS) != 0 || !(element instanceof PsiClass && ((PsiClass)element).isInterface() || element instanceof PsiMethod && parentClass != null && parentClass.isInterface())) {
      buffer.append("abstract ");
    }
  }
  if (list.hasModifierProperty(PsiModifier.FINAL)) {
    if ((options & SHOW_REDUNDANT_MODIFIERS) != 0 || !(element instanceof PsiField && parentClass != null && parentClass.isInterface())) {
      buffer.append("final ");
    }
  }
  if (list.hasModifierProperty(PsiModifier.NATIVE) && (options & JAVADOC_MODIFIERS_ONLY) == 0) {
    buffer.append("native ");
  }
  if (list.hasModifierProperty(PsiModifier.SYNCHRONIZED) && (options & JAVADOC_MODIFIERS_ONLY) == 0) {
    buffer.append("synchronized ");
  }
  if (list.hasModifierProperty(PsiModifier.STRICTFP) && (options & JAVADOC_MODIFIERS_ONLY) == 0) {
    buffer.append("strictfp ");
  }
  if (list.hasModifierProperty(PsiModifier.TRANSIENT) && element instanceof PsiVariable) {
    buffer.append("transient ");
  }
  if (list.hasModifierProperty(PsiModifier.VOLATILE)) {
    buffer.append("volatile ");
  }
  if (buffer.length() > 0) {
    buffer.setLength(buffer.length() - 1);
  }
  return buffer.toString();
}
