{
  try {
    ExtractClassProcessor processor=new ExtractClassProcessor(aClass,fields,methods,new ArrayList<PsiClass>(),"",null,"Extracted",null,generateGettersSetters,Collections.<MemberInfo>emptyList());
    processor.run();
    LocalFileSystem.getInstance().refresh(false);
    FileDocumentManager.getInstance().saveAllDocuments();
  }
 catch (  BaseRefactoringProcessor.ConflictsInTestsException e) {
    if (conflicts != null) {
      TreeSet expectedConflictsSet=new TreeSet(Arrays.asList(conflicts.split("\n")));
      TreeSet actualConflictsSet=new TreeSet(Arrays.asList(e.getMessage().split("\n")));
      Assert.assertEquals(expectedConflictsSet,actualConflictsSet);
      return;
    }
 else {
      fail(e.getMessage());
    }
  }
  if (conflicts != null) {
    fail("Conflicts were not detected: " + conflicts);
  }
}
