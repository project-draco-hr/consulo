{
  final LibraryCompositionSettings libraryCompositionSettings=node.getLibraryCompositionSettings(true);
  final LibraryOptionsPanel oldPanel=node.getLibraryCompositionOptionsPanel();
  LibraryOptionsPanel newPanel=oldPanel;
  if (oldPanel == null || !oldPanel.getSettings().equals(libraryCompositionSettings)) {
    if (libraryCompositionSettings != null) {
      newPanel=new LibraryOptionsPanel(libraryCompositionSettings,myLibrariesContainer,node.getConfigurable().getComponent() != null);
    }
 else {
      newPanel=null;
    }
  }
  node.setLibraryCompositionOptionsPanel(newPanel);
  if (newPanel != null) {
    if (addSeparator) {
      JComponent separator=SeparatorFactory.createSeparator("Libraries",null);
      separator.setBorder(IdeBorderFactory.createEmptyBorder(5,0,5,5));
      librariesOptionsPanelWrapper.add(BorderLayout.NORTH,separator);
    }
    librariesOptionsPanelWrapper.add(BorderLayout.CENTER,newPanel.getMainPanel());
  }
}
