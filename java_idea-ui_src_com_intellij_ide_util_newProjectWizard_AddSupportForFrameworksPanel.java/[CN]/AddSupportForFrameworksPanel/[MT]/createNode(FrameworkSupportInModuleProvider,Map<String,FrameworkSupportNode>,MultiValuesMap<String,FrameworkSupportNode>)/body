{
  FrameworkSupportNode node=nodes.get(provider.getFrameworkType().getId());
  if (node == null) {
    String underlyingTypeId=provider.getFrameworkType().getUnderlyingFrameworkTypeId();
    FrameworkSupportNode parentNode=null;
    if (underlyingTypeId != null) {
      FrameworkSupportInModuleProvider parentProvider=FrameworkSupportUtil.findProvider(underlyingTypeId,myProviders);
      if (parentProvider == null) {
        LOG.info("Cannot find id = " + underlyingTypeId);
        return null;
      }
      parentNode=createNode(parentProvider,nodes,groups);
    }
    node=new FrameworkSupportNode(provider,parentNode,myModel,this);
    nodes.put(provider.getFrameworkType().getId(),node);
    final String groupId=provider instanceof OldFrameworkSupportProviderWrapper ? ((OldFrameworkSupportProviderWrapper)provider).getProvider().getGroupId() : null;
    groups.put(groupId,node);
  }
  return node;
}
