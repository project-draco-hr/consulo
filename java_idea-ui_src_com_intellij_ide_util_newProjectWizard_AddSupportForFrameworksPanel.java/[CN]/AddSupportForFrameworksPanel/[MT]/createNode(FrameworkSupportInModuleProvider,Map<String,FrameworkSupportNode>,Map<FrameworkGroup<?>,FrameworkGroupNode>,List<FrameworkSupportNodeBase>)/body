{
  FrameworkSupportNode node=nodes.get(provider.getFrameworkType().getId());
  if (node == null) {
    String underlyingTypeId=provider.getFrameworkType().getUnderlyingFrameworkTypeId();
    FrameworkSupportNodeBase parentNode=null;
    final FrameworkGroup<?> group=provider.getFrameworkType().getParentGroup();
    if (underlyingTypeId != null) {
      FrameworkSupportInModuleProvider parentProvider=FrameworkSupportUtil.findProvider(underlyingTypeId,myProviders);
      if (parentProvider == null) {
        LOG.info("Cannot find id = " + underlyingTypeId);
        return null;
      }
      parentNode=createNode(parentProvider,nodes,groupNodes,roots);
    }
 else     if (group != null) {
      parentNode=groupNodes.get(group);
      if (parentNode == null) {
        FrameworkGroupNode groupNode=new FrameworkGroupNode(group,null);
        groupNodes.put(group,groupNode);
        parentNode=groupNode;
        roots.add(groupNode);
      }
    }
    node=new FrameworkSupportNode(provider,parentNode,myModel,this);
    nodes.put(provider.getFrameworkType().getId(),node);
    if (parentNode == null) {
      roots.add(node);
    }
  }
  return node;
}
