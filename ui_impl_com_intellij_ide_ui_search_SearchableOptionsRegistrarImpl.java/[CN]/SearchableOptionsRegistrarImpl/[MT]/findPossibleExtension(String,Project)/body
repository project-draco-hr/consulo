{
  final boolean perProject=CodeStyleSettingsManager.getInstance(project).USE_PER_PROJECT_SETTINGS;
  final Map<String,Set<String>> result=new THashMap<String,Set<String>>();
  int count=0;
  final Set<String> prefixes=getProcessedWords(prefix);
  for (  String opt : prefixes) {
    for (    String option : myStorage.keySet()) {
      if (option.startsWith(opt)) {
        Set<OptionDescription> configs=myStorage.get(option);
        if (configs == null)         continue;
        for (        OptionDescription description : configs) {
          String groupName=myId2Name.get(description.getConfigurableId());
          if (perProject) {
            if (Comparing.strEqual(groupName,ApplicationBundle.message("title.global.code.style"))) {
              groupName=ApplicationBundle.message("title.project.code.style");
            }
          }
 else {
            if (Comparing.strEqual(groupName,ApplicationBundle.message("title.project.code.style"))) {
              groupName=ApplicationBundle.message("title.global.code.style");
            }
          }
          Set<String> foundHits=result.get(groupName);
          if (foundHits == null) {
            foundHits=new THashSet<String>();
            result.put(groupName,foundHits);
          }
          foundHits.add(description.getHit());
          count++;
        }
      }
    }
  }
  if (count > LOAD_FACTOR) {
    result.clear();
  }
  return result;
}
