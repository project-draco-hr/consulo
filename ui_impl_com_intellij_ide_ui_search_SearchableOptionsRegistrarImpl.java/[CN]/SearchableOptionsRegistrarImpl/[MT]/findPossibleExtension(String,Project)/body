{
  final boolean perProject=CodeStyleSettingsManager.getInstance(project).USE_PER_PROJECT_SETTINGS;
  final Map<String,TreeSet<OptionDescription>> result=new TreeMap<String,TreeSet<OptionDescription>>();
  final Set<String> prefixes=getProcessedWords(prefix);
  for (  String opt : prefixes) {
    Set<String> hints=new HashSet<String>();
    for (    OptionDescription description : myHints) {
      if (description != null) {
        final String hit=description.getHit();
        if (hit != null) {
          final Set<String> words=getProcessedWords(hit);
          for (          String word : words) {
            if (word.startsWith(opt)) {
              String groupName=description.getGroupName();
              if (perProject) {
                if (Comparing.strEqual(groupName,ApplicationBundle.message("title.global.code.style"))) {
                  groupName=ApplicationBundle.message("title.project.code.style");
                }
              }
 else {
                if (Comparing.strEqual(groupName,ApplicationBundle.message("title.project.code.style"))) {
                  groupName=ApplicationBundle.message("title.global.code.style");
                }
              }
              TreeSet<OptionDescription> descriptions=result.get(groupName);
              if (descriptions == null) {
                descriptions=new TreeSet<OptionDescription>();
                result.put(groupName,descriptions);
              }
              if (!hints.contains(hit.toLowerCase())) {
                descriptions.add(description);
              }
              hints.add(hit.toLowerCase());
              break;
            }
          }
        }
      }
    }
  }
  return result;
}
