{
  MavenEmbedderWrapper result=myPool.get(kind);
  boolean alwaysOnline=kind == FOR_DOWNLOAD;
  if (result == null) {
    result=MavenFacadeManager.getInstance().createEmbedder(myProject,alwaysOnline);
    myPool.put(kind,result);
  }
  if (myEmbeddersInUse.contains(result)) {
    MavenLog.LOG.warn("embedder " + kind + " is already used");
    return MavenFacadeManager.getInstance().createEmbedder(myProject,alwaysOnline);
  }
  myEmbeddersInUse.add(result);
  return result;
}
