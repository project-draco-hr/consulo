def filectx(repo, req):
    path = cleanpath(repo, req.form['file'][0])
    if ('node' in req.form):
        changeid = req.form['node'][0]
    else:
        changeid = req.form['filenode'][0]
    try:
        fctx = repo[changeid][path]
    except error.RepoError:
        fctx = repo.filectx(path, fileid=changeid)
    return fctx
