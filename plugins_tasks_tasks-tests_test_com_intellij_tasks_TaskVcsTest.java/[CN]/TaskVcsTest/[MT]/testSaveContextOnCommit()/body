{
  Task task=myRepository.findTask("TEST-001");
  assertNotNull(task);
  myManager.activateTask(task,false,true);
  assertEquals(1,myManager.getLocalTasks().length);
  LocalTask localTask=myManager.getActiveTask();
  List<ChangeListInfo> changelists=myManager.getOpenChangelists(localTask);
  ChangeListInfo info=changelists.get(0);
  LocalChangeList changeList=ChangeListManager.getInstance(getProject()).getChangeList(info.id);
  assertNotNull(changeList);
  assertEquals(changeList.getId(),localTask.getAssociatedChangelistId());
  CommitChangeListDialog.commitChanges(getProject(),Collections.<Change>emptyList(),changeList,null,changeList.getName());
  assertEquals(1,myManager.getLocalTasks().length);
  LocalTask associatedTask=myManager.getAssociatedTask(changeList);
  assertNotNull(associatedTask);
}
