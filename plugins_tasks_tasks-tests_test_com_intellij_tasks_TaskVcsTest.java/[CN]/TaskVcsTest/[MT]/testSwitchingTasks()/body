{
  final LocalTaskImpl defaultTask=myManager.getLocalTasks()[0];
  Task task=myRepository.findTask("TEST-001");
  assertNotNull(task);
  myManager.activateTask(task,false,false);
  assertEquals(2,myManager.getLocalTasks().length);
  LocalTask localTask=myManager.getActiveTask();
  assertEquals(task,localTask);
  assertEquals(0,localTask.getChangeLists().size());
  assertEquals(1,defaultTask.getChangeLists().size());
  assertEquals(1,myChangeListManager.getChangeLists().size());
  assertEquals(defaultTask,myManager.getAssociatedTask(myChangeListManager.getChangeLists().get(0)));
  myManager.activateTask(defaultTask,false,false);
  assertEquals(0,localTask.getChangeLists().size());
  assertEquals(1,defaultTask.getChangeLists().size());
  assertEquals(1,myChangeListManager.getChangeLists().size());
  assertEquals(defaultTask,myManager.getAssociatedTask(myChangeListManager.getChangeLists().get(0)));
  myManager.activateTask(localTask,false,true);
  assertEquals(1,localTask.getChangeLists().size());
  assertEquals(1,defaultTask.getChangeLists().size());
  assertEquals(2,myChangeListManager.getChangeLists().size());
  LocalChangeList activeChangeList=myChangeListManager.getDefaultChangeList();
  LocalChangeList anotherChangeList=myChangeListManager.getChangeLists().get(1 - myChangeListManager.getChangeLists().indexOf(activeChangeList));
  assertEquals(localTask,myManager.getAssociatedTask(activeChangeList));
  assertEquals(activeChangeList.getName(),"TEST-001 Summary");
  assertEquals(defaultTask,myManager.getAssociatedTask(anotherChangeList));
  assertEquals(anotherChangeList.getName(),"Default");
  myManager.activateTask(defaultTask,false,false);
  assertEquals(1,localTask.getChangeLists().size());
  assertEquals(1,defaultTask.getChangeLists().size());
  assertEquals(2,myChangeListManager.getChangeLists().size());
  activeChangeList=myChangeListManager.getDefaultChangeList();
  anotherChangeList=myChangeListManager.getChangeLists().get(1 - myChangeListManager.getChangeLists().indexOf(activeChangeList));
  assertEquals(defaultTask,myManager.getAssociatedTask(activeChangeList));
  assertEquals(activeChangeList.getName(),"Default");
  assertEquals(localTask,myManager.getAssociatedTask(anotherChangeList));
  assertEquals(anotherChangeList.getName(),"TEST-001 Summary");
}
