{
  int count=0;
  LineTokenizer lineTokenizer=new LineTokenizer(newText);
  for (int index=oldStartLine; index <= oldEndLine; index++) {
    if (!lineTokenizer.atEnd()) {
      setSegmentAt(mySegments,index,lineTokenizer,offset1,true);
      lineTokenizer.advance();
    }
 else {
      mySegments.remove(index,oldEndLine + 1);
      break;
    }
    count++;
  }
  if (!lineTokenizer.atEnd()) {
    SegmentArrayWithData insertSegments=new SegmentArrayWithData();
    int i=0;
    while (!lineTokenizer.atEnd()) {
      setSegmentAt(insertSegments,i,lineTokenizer,offset1,true);
      lineTokenizer.advance();
      count++;
      i++;
    }
    mySegments.insert(insertSegments,oldEndLine + 1);
  }
  int shift=e.getNewLength() - e.getOldLength();
  mySegments.shiftSegments(oldStartLine + count,shift);
}
