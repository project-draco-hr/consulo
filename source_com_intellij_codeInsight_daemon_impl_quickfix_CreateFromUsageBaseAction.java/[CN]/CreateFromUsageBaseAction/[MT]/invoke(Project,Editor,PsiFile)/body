{
  PsiDocumentManager.getInstance(project).commitAllDocuments();
  PsiElement element=getElement();
  if (LOG.isDebugEnabled()) {
    LOG.debug("CreateFromUsage: element =" + element);
  }
  if (element == null) {
    return;
  }
  PsiClass[] targetClasses=getTargetClasses(element);
  if (targetClasses == null)   return;
  if (targetClasses.length == 1) {
    doInvoke(project,targetClasses[0],editor,file);
  }
 else {
    chooseTargetClass(targetClasses,editor,file);
  }
}
