{
  prefix=new File(prefix).getName();
  File f;
  int i=0;
  do {
    String name=prefix + i + suffix;
    f=new File(directory,name);
    if (!name.equals(f.getName())) {
      throw new IOException("Unable to create temporary file " + f + " for name "+ name);
    }
    i++;
  }
 while (f.exists());
  boolean success=isDirectory ? f.mkdir() : f.createNewFile();
  if (!success) {
    throw new IOException("Unable to create temporary file " + f);
  }
  return f;
}
