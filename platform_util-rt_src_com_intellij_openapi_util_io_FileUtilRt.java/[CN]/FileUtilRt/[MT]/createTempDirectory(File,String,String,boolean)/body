{
  File file=doCreateTempFile(dir,prefix,suffix);
  if (deleteOnExit) {
    file.deleteOnExit();
  }
  if (!file.delete() && file.exists()) {
    throw new IOException("Cannot delete file: " + file);
  }
  if (!file.mkdir() && !file.isDirectory()) {
    throw new IOException("Cannot create directory: " + file);
  }
  return file;
}
