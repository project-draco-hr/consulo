{
  if (location == null) {
    return null;
  }
  final ArrayList<ConfigurationFromContext> configurationsFromContext=new ArrayList<ConfigurationFromContext>();
  for (  RuntimeConfigurationProducer producer : findAllProducers(location,context)) {
    configurationsFromContext.add(new ConfigurationFromContextWrapper(producer));
  }
  for (  RunConfigurationProducer producer : Extensions.getExtensions(RunConfigurationProducer.EP_NAME)) {
    ConfigurationFromContext fromContext=producer.findOrCreateConfigurationFromContext(context);
    if (fromContext != null) {
      configurationsFromContext.add(fromContext);
    }
  }
  if (configurationsFromContext.isEmpty())   return null;
  Collections.sort(configurationsFromContext,ConfigurationFromContext.COMPARATOR);
  if (strict) {
    final ConfigurationFromContext first=configurationsFromContext.get(0);
    for (Iterator<ConfigurationFromContext> it=configurationsFromContext.iterator(); it.hasNext(); ) {
      ConfigurationFromContext producer=it.next();
      if (producer != first && ConfigurationFromContext.COMPARATOR.compare(producer,first) > 0) {
        it.remove();
      }
    }
  }
  return configurationsFromContext;
}
