{
  if (!diffPanel.hasDifferences() && !data.getHints().contains(HINT_ALLOW_NO_DIFFERENCES)) {
    DiffManagerImpl manager=(DiffManagerImpl)DiffManager.getInstance();
    if (!Comparing.equal(manager.getComparisonPolicy(),ComparisonPolicy.DEFAULT)) {
      ComparisonPolicy oldPolicy=manager.getComparisonPolicy();
      manager.setComparisonPolicy(ComparisonPolicy.DEFAULT);
      DiffPanel maybeDiffPanel=DiffManagerImpl.createDiffPanel(data,window);
      manager.setComparisonPolicy(oldPolicy);
      boolean hasDiffs=maybeDiffPanel.hasDifferences();
      maybeDiffPanel.dispose();
      if (hasDiffs)       return false;
    }
    return !askForceOpenDiff(data);
  }
  return false;
}
