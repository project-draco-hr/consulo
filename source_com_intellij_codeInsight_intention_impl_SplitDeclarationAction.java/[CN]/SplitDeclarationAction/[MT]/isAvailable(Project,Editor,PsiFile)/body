{
  int offset=editor.getCaretModel().getOffset();
  PsiElement element=file.findElementAt(offset);
  if (element == null)   return false;
  if (!(element instanceof PsiJavaToken))   return false;
  if (element instanceof PsiCompiledElement)   return false;
  if (!file.getManager().isInProject(file))   return false;
  if (!file.isWritable())   return false;
  PsiDeclarationStatement decl=PsiTreeUtil.getParentOfType(element,PsiDeclarationStatement.class);
  if (decl != null) {
    return isAvaliableOnDeclarationStatement(decl,element);
  }
  PsiField field=PsiTreeUtil.getParentOfType(element,PsiField.class);
  if (field != null && isAvaliableOnField(field)) {
    setText("Split into separate declarations");
    return true;
  }
  return false;
}
