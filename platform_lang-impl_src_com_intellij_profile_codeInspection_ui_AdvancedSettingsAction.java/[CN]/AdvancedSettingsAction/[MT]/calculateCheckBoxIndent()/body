{
  JCheckBox checkBox=new JCheckBox();
  Icon icon=checkBox.getIcon();
  int indent=0;
  if (icon == null) {
    icon=UIManager.getIcon("CheckBox.icon");
  }
  if (UIUtil.isUnderDarcula() || UIUtil.isUnderIntelliJLaF()) {
    icon=EmptyIcon.create(20,18);
  }
  if (icon != null) {
    final Insets i=checkBox.getInsets();
    final Rectangle r=checkBox.getBounds();
    final Rectangle r1=new Rectangle();
    r1.x=i.left;
    r1.y=i.top;
    r1.width=r.width - (i.right + r1.x);
    r1.height=r.height - (i.bottom + r1.y);
    final Rectangle iconRect=new Rectangle();
    SwingUtilities.layoutCompoundLabel(checkBox,checkBox.getFontMetrics(checkBox.getFont()),checkBox.getText(),icon,checkBox.getVerticalAlignment(),checkBox.getHorizontalAlignment(),checkBox.getVerticalTextPosition(),checkBox.getHorizontalTextPosition(),r1,new Rectangle(),iconRect,checkBox.getText() == null ? 0 : checkBox.getIconTextGap());
    indent=iconRect.x;
  }
  return indent + checkBox.getIconTextGap();
}
