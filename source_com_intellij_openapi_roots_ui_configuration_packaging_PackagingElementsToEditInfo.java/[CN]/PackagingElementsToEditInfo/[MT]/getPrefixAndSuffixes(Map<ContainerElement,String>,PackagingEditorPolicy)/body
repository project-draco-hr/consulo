{
  String prefix=null;
  for (  Map.Entry<ContainerElement,String> entry : elementsToPaths.entrySet()) {
    if (!policy.isRelativePathCellEditable(entry.getKey())) {
      return null;
    }
    String path=entry.getValue();
    if (prefix == null) {
      prefix=path;
    }
 else {
      prefix=StringUtil.commonPrefix(prefix,path);
      if (!path.equals(prefix) && !StringUtil.startsWithConcatenationOf(path,prefix,"/")) {
        int i=prefix.lastIndexOf('/');
        prefix=i != -1 ? prefix.substring(0,i) : "";
      }
    }
  }
  if (prefix == null) {
    return null;
  }
  Map<ContainerElement,String> map=new HashMap<ContainerElement,String>();
  for (  Map.Entry<ContainerElement,String> entry : elementsToPaths.entrySet()) {
    String path=entry.getValue();
    map.put(entry.getKey(),path.substring(prefix.length()));
  }
  return Pair.create(prefix,map);
}
