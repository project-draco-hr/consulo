{
  final String activeToolWindowId=ToolWindowManager.getInstance(project).getActiveToolWindowId();
  if (activeToolWindowId != null) {
    SelectInTarget firstTarget=result.get(0);
    if (activeToolWindowId.equals(firstTarget.getToolWindowId())) {
      boolean shouldMoveToBottom=true;
      if (ToolWindowId.PROJECT_VIEW.equals(activeToolWindowId)) {
        final String currentMinorViewId=ProjectView.getInstance(project).getCurrentViewId();
        shouldMoveToBottom=currentMinorViewId != null && currentMinorViewId.equals(firstTarget.getMinorViewId());
      }
      if (shouldMoveToBottom) {
        result.remove(0);
        result.add(firstTarget);
      }
    }
  }
}
