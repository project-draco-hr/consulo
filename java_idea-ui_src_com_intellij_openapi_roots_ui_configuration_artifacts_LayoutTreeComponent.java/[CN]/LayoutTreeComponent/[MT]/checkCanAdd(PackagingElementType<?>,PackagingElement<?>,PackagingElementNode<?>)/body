{
  final Collection<PackagingNodeSource> nodeSources=parentNode.getNodeSources();
  final String elementType=type != null ? type.getPresentableName() : "new element";
  if (parentElement == null || nodeSources.size() > 1) {
    Messages.showErrorDialog(myArtifactsEditor.getMainComponent(),"Cannot add " + elementType + ": the selected node is consisting of several different elements.");
    return false;
  }
  if (nodeSources.size() == 1) {
    final PackagingNodeSource source=nodeSources.iterator().next();
    final Artifact artifact=source.getSourceArtifact();
    if (artifact != null) {
      final int answer=Messages.showYesNoDialog(myArtifactsEditor.getMainComponent(),"The selected node comes from '" + artifact.getName() + "' artifact. Do you want to add "+ elementType+ " into it?","Add Elements",null);
      if (answer != 0) {
        return false;
      }
    }
 else {
      Messages.showErrorDialog(myArtifactsEditor.getMainComponent(),"Cannot add " + elementType + ": the selected node comes from '"+ source.getPresentableName()+ "'");
      return false;
    }
  }
  return true;
}
