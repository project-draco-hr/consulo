{
  PackagingElementNode<?> current=node;
  List<String> dirNames=new ArrayList<String>();
  while (current != null && !(current instanceof ArtifactRootNode)) {
    final PackagingElement<?> packagingElement=current.getFirstElement();
    if (!(packagingElement instanceof DirectoryPackagingElement)) {
      return parentElement;
    }
    dirNames.add(((DirectoryPackagingElement)packagingElement).getDirectoryName());
    current=current.getParentNode();
  }
  if (current == null)   return parentElement;
  final PackagingElement<?> rootElement=current.getElementIfSingle();
  if (!(rootElement instanceof CompositePackagingElement<?>))   return parentElement;
  Collections.reverse(dirNames);
  String path=StringUtil.join(dirNames,"/");
  return PackagingElementFactory.getInstance().getOrCreateDirectory((CompositePackagingElement<?>)rootElement,path);
}
