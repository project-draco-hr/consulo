{
  if (UnitBitSet.MAX_CHARS_IN_WORD <= letters.length() + offset)   return null;
  int unknownLetters=0;
  UnitBitSet bs=new UnitBitSet();
  for (int i=0; i < letters.length(); i++) {
    char letter=letters.charAt(i);
    int index=alphabet.getIndex(letter,force);
    if (index < 0)     unknownLetters++;
    bs.setUnitValue(i + offset,index);
  }
  bs.setUnitValue(0,letters.length());
  bs.setUnitValue(1,bs.getUnitValue(2));
  if (unknownLetters == letters.length())   return WORD_OF_ENTIRELY_UNKNOWN_LETTERS;
  if (unknownLetters > 0)   return null;
  return bs;
}
