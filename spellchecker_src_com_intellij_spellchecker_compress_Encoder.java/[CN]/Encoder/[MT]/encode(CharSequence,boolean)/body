{
  if (UnitBitSet.MAX_CHARS_IN_WORD <= letters.length() + offset)   return null;
  int unknownLetters=0;
  byte[] indices=new byte[letters.length()];
  for (int i=0; i < letters.length(); i++) {
    char letter=letters.charAt(i);
    int index=alphabet.getIndex(letter,force);
    if (index < 0) {
      unknownLetters++;
    }
 else {
      indices[i]=(byte)index;
    }
  }
  if (unknownLetters == letters.length())   return WORD_OF_ENTIRELY_UNKNOWN_LETTERS;
  if (unknownLetters > 0)   return null;
  return new UnitBitSet(indices,alphabet);
}
