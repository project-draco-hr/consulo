{
  if (LOG.isDebugEnabled()) {
    LOG.debug("enter: checkForUpdates()");
  }
  final Document document;
  try {
    document=loadVersionInfo(getUpdateUrl());
    if (document == null)     return null;
  }
 catch (  Throwable t) {
    LOG.debug(t);
    throw new ConnectionException(t);
  }
  final String availBuild=document.getRootElement().getChild(ELEMENT_BUILD).getTextTrim();
  final String availVersion=document.getRootElement().getChild(ELEMENT_VERSION).getTextTrim();
  String ourBuild=ApplicationInfo.getInstance().getBuildNumber().trim();
  if (BUILD_NUMBER_STUB.equals(ourBuild))   ourBuild=Integer.toString(Integer.MAX_VALUE);
  if (LOG.isDebugEnabled()) {
    LOG.debug("build available:'" + availBuild + "' ourBuild='"+ ourBuild+ "' ");
  }
  try {
    final int iAvailBuild=Integer.parseInt(availBuild);
    final int iOurBuild=Integer.parseInt(ourBuild);
    if (iAvailBuild > iOurBuild) {
      return new NewVersion(iAvailBuild,availVersion);
    }
    return null;
  }
 catch (  Throwable t) {
    LOG.debug(t);
    return null;
  }
 finally {
    UpdateSettingsConfigurable.getInstance().LAST_TIME_CHECKED=System.currentTimeMillis();
  }
}
