{
  if (!myExpectedType.isValid())   return;
  final PsiElement element=descriptor.getPsiElement();
  if (!(element instanceof GrExpression))   return;
  final GrExpression expr=(GrExpression)element;
  final GroovyPsiElementFactory factory=GroovyPsiElementFactory.getInstance(project);
  final GrSafeCastExpression cast=(GrSafeCastExpression)factory.createExpressionFromText("foo as String");
  final GrTypeElement typeElement=factory.createTypeElement(myExpectedType);
  cast.getOperand().replaceWithExpression(expr,true);
  cast.getCastTypeElement().replace(typeElement);
  final GrExpression replaced=expr.replaceWithExpression(cast,true);
  GrReferenceAdjuster.shortenReferences(replaced);
}
