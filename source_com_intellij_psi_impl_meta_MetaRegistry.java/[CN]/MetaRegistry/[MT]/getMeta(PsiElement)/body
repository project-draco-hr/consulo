{
  ProgressManager.getInstance().checkCanceled();
  PsiMetaData ret=null;
  SoftReference<CachedValue<PsiMetaData>> value=element.getUserData(META_DATA_KEY);
  if (value == null || (value != NULL && value.get() == null)) {
    for (    final MyBinding binding : ourBindings) {
      try {
        if (isAcceptable(binding.myFilter,element)) {
          final PsiMetaData data=binding.myDataClass.newInstance();
          final CachedValue<PsiMetaData> cachedValue=element.getManager().getCachedValuesManager().createCachedValue(new CachedValueProvider<PsiMetaData>(){
            public Result<PsiMetaData> compute(){
              if (!isAcceptable(binding.myFilter,element)) {
                clearMetaForElement(element);
                final PsiMetaData data1=getMeta(element);
                if (data1 == null)                 return new Result<PsiMetaData>(null);
                return new Result<PsiMetaData>(data1,data1.getDependences());
              }
              data.init(element);
              return new Result<PsiMetaData>(data,data.getDependences());
            }
          }
,false);
          value=new SoftReference<CachedValue<PsiMetaData>>(cachedValue);
          ret=cachedValue.getValue();
          break;
        }
      }
 catch (      IllegalAccessException iae) {
        value=null;
      }
catch (      InstantiationException ie) {
        value=null;
      }
    }
    element.putUserData(META_DATA_KEY,value != null ? value : NULL);
  }
 else   if (value != NULL) {
    ret=value.get().getValue();
  }
  return ret;
}
