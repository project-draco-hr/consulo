{
  myEditor.getFoldingModel().runBatchFoldingOperation(new Runnable(){
    public void run(){
      FoldingModel foldingModel=myEditor.getFoldingModel();
synchronized (myFoldingData) {
        for (        TextRange foldingData : myFoldingData) {
          final int startOffset=foldingData.getStartOffset();
          final int endOffset=foldingData.getEndOffset();
          boolean generatedCodeUnfolded=false;
          FoldRegion[] regions=foldingModel.getAllFoldRegions();
          for (          FoldRegion region : regions) {
            if (region.getPlaceholderText().equals(UIDesignerBundle.message("uidesigner.generated.code.folding.placeholder.text")) && region.isExpanded()) {
              generatedCodeUnfolded=true;
            }
            if (region.getStartOffset() >= startOffset && region.getEndOffset() <= endOffset) {
              foldingModel.removeFoldRegion(region);
            }
          }
          final FoldRegion region=foldingModel.addFoldRegion(startOffset,endOffset,UIDesignerBundle.message("uidesigner.generated.code.folding.placeholder.text"));
          if (region != null && !generatedCodeUnfolded) {
            region.setExpanded(false);
          }
        }
      }
    }
  }
);
}
