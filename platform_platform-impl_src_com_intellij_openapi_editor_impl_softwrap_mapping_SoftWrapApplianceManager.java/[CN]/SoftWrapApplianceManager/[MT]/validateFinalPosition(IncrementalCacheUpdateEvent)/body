{
  if (LOG.isDebugEnabled()) {
    LOG.debug("Soft wrap recalculation done: " + event.toString() + ". "+ (event.getActualEndOffset() - event.getStartOffset())+ " characters processed");
  }
  int endOffsetUpperEstimate=EditorUtil.getNotFoldedLineEndOffset(myEditor,event.getMandatoryEndOffset());
  int line=myEditor.getDocument().getLineNumber(endOffsetUpperEstimate);
  if (line < myEditor.getDocument().getLineCount() - 1) {
    endOffsetUpperEstimate=myEditor.getDocument().getLineStartOffset(line + 1);
  }
  if (event.getActualEndOffset() > endOffsetUpperEstimate) {
    LOG.error("Unexpected error at soft wrap recalculation",new Attachment("softWrapModel.txt",myEditor.getSoftWrapModel().toString()));
  }
}
