{
  if (processOutOfDateFoldRegion(foldRegion)) {
    return false;
  }
  String placeholder=foldRegion.getPlaceholderText();
  if (placeholder.isEmpty()) {
    return true;
  }
  int placeholderWidthInPixels=0;
  for (int i=0; i < placeholder.length(); i++) {
    placeholderWidthInPixels+=myRepresentationHelper.charWidth(placeholder.charAt(i),myContext.fontType);
  }
  int newX=myContext.currentPosition.x + placeholderWidthInPixels;
  notifyListenersOnVisualLineStart(myContext.lineStartPosition);
  if (!myContext.exceedsVisualEdge(newX)) {
    myContext.advance(foldRegion,placeholderWidthInPixels);
    return true;
  }
  myContext.logicalLineData.update(foldRegion.getStartOffset());
  SoftWrap softWrap=registerSoftWrap(myContext.softWrapStartOffset,myContext.tokenStartOffset,myContext.tokenStartOffset,myContext.getSpaceWidth(),myContext.logicalLineData);
  if (softWrap == null) {
    softWrap=registerSoftWrap(myContext.tokenStartOffset,myContext.getSpaceWidth(),myContext.logicalLineData);
  }
  myContext.softWrapStartOffset=softWrap.getStart();
  if (softWrap.getStart() < myContext.tokenStartOffset) {
    revertListeners(softWrap.getStart(),myContext.currentPosition.visualLine);
    for (int j=foldRegion.getStartOffset() - 1; j >= softWrap.getStart(); j--) {
      int pixelsDiff=myOffset2widthInPixels.data[j - myOffset2widthInPixels.anchor];
      int tmpFontType=myOffset2fontType.get(j);
      int columnsDiff=calculateWidthInColumns(myContext.text.charAt(j),pixelsDiff,myContext.getSpaceWidth(tmpFontType));
      myContext.currentPosition.offset--;
      myContext.currentPosition.logicalColumn-=columnsDiff;
      myContext.currentPosition.visualColumn-=columnsDiff;
    }
  }
  notifyListenersOnSoftWrapLineFeed(true);
  myContext.currentPosition.visualColumn=0;
  myContext.currentPosition.softWrapColumnDiff=myContext.currentPosition.visualColumn - myContext.currentPosition.foldingColumnDiff - myContext.currentPosition.logicalColumn;
  myContext.currentPosition.softWrapLinesCurrent++;
  myContext.currentPosition.visualLine++;
  notifyListenersOnSoftWrapLineFeed(false);
  myContext.currentPosition.x=softWrap.getIndentInPixels();
  myContext.currentPosition.visualColumn=softWrap.getIndentInColumns();
  myContext.currentPosition.softWrapColumnDiff+=softWrap.getIndentInColumns();
  for (int j=softWrap.getStart(); j < myContext.tokenStartOffset; j++) {
    char c=myContext.text.charAt(j);
    newX=calculateNewX(c);
    myContext.onNonLineFeedSymbol(c,newX);
  }
  myOffset2fontType.clear();
  myContext.advance(foldRegion,placeholderWidthInPixels);
  return true;
}
