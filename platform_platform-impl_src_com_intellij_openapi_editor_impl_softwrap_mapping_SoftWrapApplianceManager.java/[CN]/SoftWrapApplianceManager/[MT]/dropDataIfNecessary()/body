{
  boolean indentChanged=false;
  IndentType currentIndentType=getIndentToUse();
  boolean useCustomIndent=currentIndentType == IndentType.CUSTOM;
  int currentCustomIndent=myEditor.getSettings().getCustomSoftWrapIndent();
  if (useCustomIndent ^ myCustomIndentUsedLastTime || (useCustomIndent && myCustomIndentValueUsedLastTime != currentCustomIndent)) {
    indentChanged=true;
  }
  myCustomIndentUsedLastTime=useCustomIndent;
  myCustomIndentValueUsedLastTime=currentCustomIndent;
  int currentVisibleAreaWidth=myWidthProvider.getVisibleAreaWidth();
  if (!indentChanged && myVisibleAreaWidth == currentVisibleAreaWidth) {
    return;
  }
  myDirtyRegions.clear();
  myDirtyRegions.add(new DirtyRegion(0,myEditor.getDocument().getTextLength() - 1));
  myStorage.removeAll();
  myVisibleAreaWidth=currentVisibleAreaWidth;
}
