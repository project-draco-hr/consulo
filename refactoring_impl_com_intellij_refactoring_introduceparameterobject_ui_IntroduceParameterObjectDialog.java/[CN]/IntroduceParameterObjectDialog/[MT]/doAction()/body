{
  final List<PsiParameter> params=getParametersToExtract();
  final boolean useExistingClass=useExistingClass();
  final boolean keepMethod=keepMethodAsDelegate();
  final IntroduceParameterObjectProcessor processor;
  if (!useExistingClass) {
    processor=new IntroduceParameterObjectProcessor(getClassName(),getPackageName(),sourceMethod,params,null,keepMethod,isPreviewUsages(),useExistingClass);
  }
 else {
    final String existingClassName=getExistingClassName();
    final List<String> getterNames=new ArrayList<String>();
    final int index=existingClassName.lastIndexOf('.');
    final String packageName=index == -1 ? "" : existingClassName.substring(0,index);
    processor=new IntroduceParameterObjectProcessor(index == -1 ? existingClassName : existingClassName.substring(index + 1),packageName,sourceMethod,params,getterNames,keepMethod,isPreviewUsages(),useExistingClass);
  }
  invokeRefactoring(processor);
}
