def colorbookmarks(orig, ui, repo, *pats, **opts):

    def colorize(orig, s):
        lines = s.split('\n')
        for (i, line) in enumerate(lines):
            if line.startswith(' *'):
                lines[i] = render_effects(line, _bookmark_effects['current'])
        orig('\n'.join(lines))
    oldwrite = extensions.wrapfunction(ui, 'write', colorize)
    try:
        orig(ui, repo, *pats, **opts)
    finally:
        ui.write = oldwrite
