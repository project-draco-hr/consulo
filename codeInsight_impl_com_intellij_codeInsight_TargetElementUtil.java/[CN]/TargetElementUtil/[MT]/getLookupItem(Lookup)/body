{
  LookupItem item=activeLookup.getCurrentItem();
  if (item == null)   return null;
  Object o=item.getObject();
  if (o instanceof PsiClass || o instanceof PsiPackage || o instanceof PsiMethod|| o instanceof PsiVariable|| o instanceof PsiFile) {
    PsiElement element=(PsiElement)o;
    if (!(element instanceof PsiPackage)) {
      if (!isValidElement(element))       return null;
    }
    return element;
  }
 else   if (o instanceof LookupValueWithPsiElement) {
    final PsiElement element=((LookupValueWithPsiElement)o).getElement();
    if (element != null && isValidElement(element))     return element;
  }
  return null;
}
