{
  List<Pair<PsiElement,Unwrapper>> result=new SmartList<Pair<PsiElement,Unwrapper>>();
  int offset=editor.getCaretModel().getOffset();
  PsiElement e1=file.findElementAt(offset);
  if (e1 != null) {
    Language language=e1.getParent().getLanguage();
    if (language != file.getLanguage()) {
      UnwrapDescriptor unwrapDescriptor=LanguageUnwrappers.INSTANCE.forLanguage(language);
      if (unwrapDescriptor != null && !(unwrapDescriptor instanceof XmlUnwrapDescriptor)) {
        result.addAll(unwrapDescriptor.collectUnwrappers(project,editor,file));
      }
    }
  }
  PsiElement tag=PsiTreeUtil.getParentOfType(e1,XmlTag.class);
  while (tag != null) {
    result.add(new Pair<PsiElement,Unwrapper>(tag,new XmlEnclosingTagUnwrapper()));
    tag=PsiTreeUtil.getParentOfType(tag,XmlTag.class);
  }
  return result;
}
