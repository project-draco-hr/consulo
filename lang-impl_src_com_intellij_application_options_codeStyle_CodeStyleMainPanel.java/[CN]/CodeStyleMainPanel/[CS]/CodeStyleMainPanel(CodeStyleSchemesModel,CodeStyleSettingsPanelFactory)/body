{
  super(new BorderLayout());
  myModel=model;
  myFactory=factory;
  final CodeStyleSchemesPanel schemesPanel=new CodeStyleSchemesPanel(model);
  model.addListener(new CodeStyleSettingsListener(){
    public void currentSchemeChanged(    final Object source){
      if (source != schemesPanel) {
        schemesPanel.onSelectedSchemeChanged();
      }
      onCurrentSchemeChanged();
    }
    public void schemeListChanged(){
      schemesPanel.resetSchemesCombo();
    }
    public void currentSettingsChanged(){
      ensureCurrentPanel().onSomethingChanged();
    }
    public void usePerProjectSettingsOptionChanged(){
      schemesPanel.usePerProjectSettingsOptionChanged();
    }
    public void schemeChanged(    final CodeStyleScheme scheme){
      ensurePanel(scheme).resetFromClone();
    }
  }
);
  addWaitCard();
  add(schemesPanel.getPanel(),BorderLayout.NORTH);
  add(mySettingsPanel,BorderLayout.CENTER);
  schemesPanel.resetSchemesCombo();
  schemesPanel.onSelectedSchemeChanged();
  onCurrentSchemeChanged();
}
