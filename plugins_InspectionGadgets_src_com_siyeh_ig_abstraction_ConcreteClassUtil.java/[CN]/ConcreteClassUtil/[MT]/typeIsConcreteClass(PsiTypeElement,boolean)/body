{
  if (typeElement == null) {
    return false;
  }
  final PsiType type=typeElement.getType();
  final PsiType baseType=type.getDeepComponentType();
  if (!(baseType instanceof PsiClassType)) {
    return false;
  }
  final PsiClass aClass=((PsiClassType)baseType).resolve();
  if (aClass == null) {
    return false;
  }
  if (ignoreCastToAbstractClass && aClass.hasModifierProperty(PsiModifier.ABSTRACT)) {
    return false;
  }
  if (aClass.isInterface() || aClass.isEnum() || aClass.isAnnotationType()) {
    return false;
  }
  if (aClass instanceof PsiTypeParameter) {
    return false;
  }
  return !LibraryUtil.classIsInLibrary(aClass);
}
