{
  PsiDocumentManager.getInstance(context.getProject()).commitAllDocuments();
  PsiFile file=context.getFile();
  Object o=item.getObject();
  if (o instanceof PsiClass) {
    PsiClass aClass=(PsiClass)o;
    if (aClass.getQualifiedName() == null)     return;
    final String lookupString=item.getLookupString();
    int length=lookupString.length();
    final int i=lookupString.indexOf('<');
    if (i >= 0)     length=i;
    addImportForClass(aClass,context,length);
    JavaCompletionUtil.shortenReference(file,context.getStartOffset());
  }
 else   if (o instanceof PsiType) {
    PsiType type=((PsiType)o).getDeepComponentType();
    if (type instanceof PsiClassType) {
      PsiClass refClass=((PsiClassType)type).resolve();
      if (refClass != null) {
        int length=refClass.getName().length();
        addImportForClass(refClass,context,length);
      }
    }
  }
 else   if (o instanceof PsiMethod) {
    PsiMethod method=(PsiMethod)o;
    if (method.isConstructor()) {
      PsiClass aClass=method.getContainingClass();
      if (aClass != null) {
        int length=method.getName().length();
        addImportForClass(aClass,context,length);
      }
    }
  }
}
