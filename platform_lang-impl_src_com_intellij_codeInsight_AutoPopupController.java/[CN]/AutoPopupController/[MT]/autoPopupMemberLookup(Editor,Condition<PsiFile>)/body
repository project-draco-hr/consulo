{
  if (ApplicationManager.getApplication().isUnitTestMode() && !CompletionAutoPopupHandler.ourTestingAutopopup) {
    return;
  }
  final CodeInsightSettings settings=CodeInsightSettings.getInstance();
  if (settings.AUTO_POPUP_COMPLETION_LOOKUP) {
    if (PsiUtilBase.getPsiFileInEditor(editor,myProject) == null)     return;
    final Runnable request=new Runnable(){
      public void run(){
        if (!myProject.isDisposed() && !editor.isDisposed()) {
          CompletionAutoPopupHandler.scheduleAutoPopup(editor,condition);
        }
      }
    }
;
    addRequest(request,settings.AUTO_LOOKUP_DELAY);
  }
}
