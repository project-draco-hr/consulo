{
  if (ApplicationManager.getApplication().isUnitTestMode())   return;
  final CodeInsightSettings settings=CodeInsightSettings.getInstance();
  if (settings.AUTO_POPUP_COMPLETION_LOOKUP) {
    final PsiFile file=PsiUtilBase.getPsiFileInEditor(editor,myProject);
    if (file == null)     return;
    final Runnable request=new Runnable(){
      public void run(){
        if (myProject.isDisposed())         return;
        if (editor.isDisposed())         return;
        PsiDocumentManager.getInstance(myProject).commitAllDocuments();
        if (!file.isValid())         return;
        if (condition != null && !condition.value(file))         return;
        new CodeCompletionHandlerBase(CompletionType.BASIC,false,false).invoke(myProject,editor,file);
      }
    }
;
    myAlarm.addRequest(request,settings.AUTO_LOOKUP_DELAY);
  }
}
