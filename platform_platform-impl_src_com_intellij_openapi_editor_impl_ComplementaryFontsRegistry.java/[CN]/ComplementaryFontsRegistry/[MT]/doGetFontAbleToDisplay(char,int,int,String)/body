{
synchronized (lock) {
    if (SystemInfo.isMac && style > 0 && style < 4) {
      Pair<String,Integer>[] replacement=ourStyledFontMap.get(defaultFontFamily);
      if (replacement != null) {
        defaultFontFamily=replacement[style].first;
        style=replacement[style].second;
      }
    }
    if (ourSharedKeyInstance.mySize == size && ourSharedKeyInstance.myStyle == style && ourSharedKeyInstance.myFamilyName != null && ourSharedKeyInstance.myFamilyName.equals(defaultFontFamily) && ourSharedDefaultFont != null && (c < 128 || ourSharedDefaultFont.canDisplay(c))) {
      return ourSharedDefaultFont;
    }
    ourSharedKeyInstance.myFamilyName=defaultFontFamily;
    ourSharedKeyInstance.mySize=size;
    ourSharedKeyInstance.myStyle=style;
    FontInfo defaultFont=ourUsedFonts.get(ourSharedKeyInstance);
    if (defaultFont == null) {
      defaultFont=new FontInfo(defaultFontFamily,size,style);
      ourUsedFonts.put(ourSharedKeyInstance,defaultFont);
      ourSharedKeyInstance=new FontKey("",0,0);
    }
    ourSharedDefaultFont=defaultFont;
    if (c < 128 || defaultFont.canDisplay(c)) {
      return defaultFont;
    }
 else {
      return null;
    }
  }
}
