{
synchronized (lock) {
    if (ourUndisplayableChars.contains(c))     return ourSharedDefaultFont;
    final Collection<FontInfo> descriptors=ourUsedFonts.values();
    for (    FontInfo font : descriptors) {
      if (font.getSize() == size && font.getStyle() == style && font.canDisplay(c)) {
        return font;
      }
    }
    for (int i=0; i < ourFontNames.size(); i++) {
      String name=ourFontNames.get(i);
      FontInfo font=new FontInfo(name,size,style);
      if (font.canDisplay(c)) {
        ourUsedFonts.put(new FontKey(name,size,style),font);
        ourFontNames.remove(i);
        return font;
      }
    }
    ourUndisplayableChars.add(c);
    return ourSharedDefaultFont;
  }
}
