{
  Element newRoot=newDoc.getRootElement();
  ourFileToProblem=new HashMap<String,ArrayList<Element>>();
  List newProblems=newRoot.getChildren("problem");
  for (  final Object o : newProblems) {
    Element newProblem=(Element)o;
    addProblem(newProblem);
  }
  if (oldDoc != null) {
    List oldProblems=oldDoc.getRootElement().getChildren("problem");
    for (    final Object o : oldProblems) {
      Element oldProblem=(Element)o;
      if (!removeIfEquals(oldProblem)) {
        addProblem(oldProblem);
      }
    }
  }
  Element root=new Element("problems");
  Document delta=new Document(root);
  for (  ArrayList<Element> fileList : ourFileToProblem.values()) {
    if (fileList != null) {
      for (      Element element : fileList) {
        root.addContent((Element)element.clone());
      }
    }
  }
  return delta;
}
