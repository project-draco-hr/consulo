{
  UIUtil.invokeLaterIfNeeded(new Runnable(){
    @Override public void run(){
      VirtualFile file=getSelectedFile();
      myActionEnabled=false;
      if (file != null) {
        myActionEnabled=(file.isWritable());
        String lineSeparator=LoadTextUtil.detectLineSeparator(file,true);
        if (lineSeparator == null) {
          lineSeparator="";
        }
        myComponent.resetColor();
        myComponent.setToolTipText(String.format("Line separator: %s%nClick to change",StringUtil.escapeLineBreak(lineSeparator)));
        myComponent.setText(LineSeparator.fromString(lineSeparator).toString());
      }
      if (myActionEnabled) {
        myComponent.setForeground(UIUtil.getActiveTextColor());
      }
 else {
        myComponent.setForeground(UIUtil.getInactiveTextColor());
      }
      if (myStatusBar != null) {
        myStatusBar.updateWidget(ID());
      }
    }
  }
);
}
