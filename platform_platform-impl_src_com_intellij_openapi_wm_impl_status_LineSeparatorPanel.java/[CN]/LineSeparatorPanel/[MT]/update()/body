{
  UIUtil.invokeLaterIfNeeded(new Runnable(){
    @Override public void run(){
      VirtualFile file=getSelectedFile();
      myActionEnabled=false;
      String lineSeparator=null;
      String toolTipText=null;
      String panelText=null;
      if (file != null) {
        myActionEnabled=file.isWritable();
        lineSeparator=LoadTextUtil.detectLineSeparator(file,true);
        if (lineSeparator != null) {
          toolTipText=String.format("Line separator: %s",StringUtil.escapeLineBreak(lineSeparator));
          panelText=LineSeparator.fromString(lineSeparator).toString();
        }
      }
      if (lineSeparator == null) {
        toolTipText="No line separator";
        panelText="n/a";
        myActionEnabled=false;
      }
      myComponent.resetColor();
      String toDoComment;
      if (myActionEnabled) {
        toDoComment="Click to change";
        myComponent.setForeground(UIUtil.getActiveTextColor());
        myComponent.setTextAlignment(Component.LEFT_ALIGNMENT);
      }
 else {
        toDoComment="";
        myComponent.setForeground(UIUtil.getInactiveTextColor());
        myComponent.setTextAlignment(Component.CENTER_ALIGNMENT);
      }
      myComponent.setToolTipText(String.format("%s%n%s",toolTipText,toDoComment));
      myComponent.setText(panelText);
      if (myStatusBar != null) {
        myStatusBar.updateWidget(ID());
      }
    }
  }
);
}
