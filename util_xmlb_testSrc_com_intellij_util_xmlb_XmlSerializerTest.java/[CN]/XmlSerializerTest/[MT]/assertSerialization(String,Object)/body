{
  DocumentBuilderFactory factory=DocumentBuilderFactory.newInstance();
  DocumentBuilder documentBuilder=factory.newDocumentBuilder();
  Document document=documentBuilder.newDocument();
  Element element=XmlSerializer.serialize(bean,document);
  document.appendChild(element);
  TransformerFactory transformerFactory=TransformerFactory.newInstance();
  Transformer transformer=transformerFactory.newTransformer();
  DOMSource source=new DOMSource(element);
  ByteArrayOutputStream byteArrayOutputStream=new ByteArrayOutputStream();
  StreamResult result=new StreamResult(byteArrayOutputStream);
  transformer.transform(source,result);
  String actualString=new String(byteArrayOutputStream.toByteArray());
  if (!expectedText.startsWith(XML_PREFIX)) {
    if (actualString.startsWith(XML_PREFIX))     actualString=actualString.substring(XML_PREFIX.length());
  }
  assertEquals(expectedText,actualString);
}
