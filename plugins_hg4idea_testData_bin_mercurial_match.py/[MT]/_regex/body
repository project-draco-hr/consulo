def _regex(kind, name, tail):
    'convert a pattern into a regular expression'
    if (not name):
        return ''
    if (kind == 're'):
        return name
    elif (kind == 'path'):
        return (('^' + re.escape(name)) + '(?:/|$)')
    elif (kind == 'relglob'):
        return (('(?:|.*/)' + _globre(name)) + tail)
    elif (kind == 'relpath'):
        return (re.escape(name) + '(?:/|$)')
    elif (kind == 'relre'):
        if name.startswith('^'):
            return name
        return ('.*' + name)
    return (_globre(name) + tail)
