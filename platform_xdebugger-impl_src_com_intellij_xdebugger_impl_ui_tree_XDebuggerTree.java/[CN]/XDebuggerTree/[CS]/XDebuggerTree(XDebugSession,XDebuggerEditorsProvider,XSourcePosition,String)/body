{
  mySession=session;
  myProject=session.getProject();
  myEditorsProvider=editorsProvider;
  mySourcePosition=sourcePosition;
  myTreeModel=new DefaultTreeModel(null);
  setModel(myTreeModel);
  setCellRenderer(new XDebuggerTreeRenderer());
  new TreeLinkMouseListener(new XDebuggerTreeRenderer()){
    @Override protected void handleTagClick(    Object tag,    MouseEvent event){
      if (tag instanceof XDebuggerTreeNodeHyperlink) {
        ((XDebuggerTreeNodeHyperlink)tag).onClick(event);
      }
    }
  }
.install(this);
  setRootVisible(false);
  setShowsRootHandles(true);
  addMouseListener(new MouseAdapter(){
    @Override public void mouseClicked(    final MouseEvent e){
      if (e.getClickCount() == 2)       expandIfEllipsis();
    }
  }
);
  addKeyListener(new KeyAdapter(){
    @Override public void keyPressed(    KeyEvent e){
      int key=e.getKeyCode();
      if (key == KeyEvent.VK_ENTER || key == KeyEvent.VK_SPACE || key == KeyEvent.VK_RIGHT) {
        expandIfEllipsis();
      }
    }
  }
);
  new TreeSpeedSearch(this,SPEED_SEARCH_CONVERTER);
  final ActionManager actionManager=ActionManager.getInstance();
  myPopupHandler=new PopupHandler(){
    public void invokePopup(    final Component comp,    final int x,    final int y){
      final ActionGroup group=(ActionGroup)actionManager.getAction(popupActionGroupId);
      ActionPopupMenu popupMenu=actionManager.createActionPopupMenu(ActionPlaces.UNKNOWN,group);
      popupMenu.getComponent().show(comp,x,y);
    }
  }
;
  addMouseListener(myPopupHandler);
  registerShortcuts();
}
