{
  if (getName() == null)   return false;
  if (getModuleFilePath() == null)   return false;
  final File file=new File(getModuleFilePath());
  if (file.exists()) {
    try {
      final Document document=JDOMUtil.loadDocument(file);
      final Element root=document.getRootElement();
      if (!convertModule(current,file,document,root)) {
        return false;
      }
      final Set<String> usedMacros=PathMacrosCollector.getMacroNames(root);
      final Set<String> definedMacros=PathMacros.getInstance().getAllMacroNames();
      usedMacros.remove("$" + PathMacrosImpl.MODULE_DIR_MACRO_NAME + "$");
      usedMacros.removeAll(definedMacros);
      final HashMap<String,String> map=new HashMap<String,String>();
      for (      String v : usedMacros) {
        map.put(v,null);
      }
      if (usedMacros.size() > 0) {
        final boolean ok=ProjectMacrosUtil.showMacrosConfigurationDialog(current,map);
        if (!ok) {
          return false;
        }
      }
    }
 catch (    JDOMException e) {
      Messages.showMessageDialog(e.getMessage(),IdeBundle.message("title.error.reading.file"),Messages.getErrorIcon());
      return false;
    }
catch (    IOException e) {
      Messages.showMessageDialog(e.getMessage(),IdeBundle.message("title.error.reading.file"),Messages.getErrorIcon());
      return false;
    }
  }
 else {
    Messages.showErrorDialog(current,IdeBundle.message("title.module.file.does.not.exist"),CommonBundle.message("title.error"));
    return false;
  }
  return true;
}
