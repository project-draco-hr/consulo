{
  Window root=parent == null ? JOptionPane.getRootFrame() : parent;
  while (root != null) {
    final Container next=root.getParent();
    if (next == null)     break;
    if (next instanceof Window) {
      root=(Window)next;
    }
    final Window nextWindow=SwingUtilities.getWindowAncestor(next);
    if (nextWindow == null)     break;
    root=nextWindow;
  }
  return root;
}
