{
  mxIGraphModel model=state.getView().getGraph().getModel();
  Rectangle bounds=null;
  if (useLabelBounds(state)) {
    bounds=state.getLabelBounds().getRectangle();
    bounds.height+=10;
  }
 else {
    bounds=state.getRectangle();
  }
  if (model.isVertex(state.getCell())) {
    String horizontal=mxUtils.getString(state.getStyle(),mxConstants.STYLE_LABEL_POSITION,mxConstants.ALIGN_CENTER);
    if (horizontal.equals(mxConstants.ALIGN_LEFT)) {
      bounds.x-=state.getWidth();
    }
 else     if (horizontal.equals(mxConstants.ALIGN_RIGHT)) {
      bounds.x+=state.getWidth();
    }
    String vertical=mxUtils.getString(state.getStyle(),mxConstants.STYLE_VERTICAL_LABEL_POSITION,mxConstants.ALIGN_MIDDLE);
    if (vertical.equals(mxConstants.ALIGN_TOP)) {
      bounds.y-=state.getHeight();
    }
 else     if (vertical.equals(mxConstants.ALIGN_BOTTOM)) {
      bounds.y+=state.getHeight();
    }
  }
  bounds.setSize((int)Math.max(bounds.getWidth(),Math.round(minimumWidth * scale)),(int)Math.max(bounds.getHeight(),Math.round(minimumHeight * scale)));
  return bounds;
}
