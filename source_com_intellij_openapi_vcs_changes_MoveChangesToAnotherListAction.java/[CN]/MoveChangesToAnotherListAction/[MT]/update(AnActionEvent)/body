{
  Project project=(Project)e.getDataContext().getData(DataConstants.PROJECT);
  Change[] changes=(Change[])e.getDataContext().getData(DataConstants.CHANGES);
  List<VirtualFile> unversionedFiles=(List<VirtualFile>)e.getDataContext().getData(ChangesListView.UNVERSIONED_FILES_KEY);
  if (project != null && changes == null && unversionedFiles == null) {
    unversionedFiles=new ArrayList<VirtualFile>();
    changes=getChangesForSelectedFiles(project,changes,unversionedFiles,null,e);
  }
  e.getPresentation().setEnabled(project != null && (changes != null && changes.length > 0) || (unversionedFiles != null && unversionedFiles.size() > 0));
}
