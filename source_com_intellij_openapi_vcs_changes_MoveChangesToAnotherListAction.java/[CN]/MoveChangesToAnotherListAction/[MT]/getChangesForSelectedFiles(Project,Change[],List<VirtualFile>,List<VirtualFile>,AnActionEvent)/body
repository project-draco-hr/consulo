{
  if (ProjectLevelVcsManager.getInstance(project).getAllActiveVcss().length == 0) {
    return null;
  }
  VirtualFile[] virtualFiles=(VirtualFile[])e.getDataContext().getData(DataConstants.VIRTUAL_FILE_ARRAY);
  if (virtualFiles != null) {
    List<Change> changesInFiles=new ArrayList<Change>();
    for (    VirtualFile vFile : virtualFiles) {
      if (ChangeListManager.getInstance(project).getStatus(vFile).equals(FileStatus.UNKNOWN)) {
        unversionedFiles.add(vFile);
        if (changedFiles != null)         changedFiles.add(vFile);
      }
 else {
        Change change=ChangeListManager.getInstance(project).getChange(vFile);
        if (change != null) {
          changesInFiles.add(change);
          if (changedFiles != null)           changedFiles.add(vFile);
        }
      }
    }
    if (changesInFiles.size() > 0 || unversionedFiles.size() > 0) {
      changes=changesInFiles.toArray(new Change[changesInFiles.size()]);
    }
  }
  return changes;
}
