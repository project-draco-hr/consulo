{
  ArrayList<IndexedRelevantResource<K,V>> all=new ArrayList<IndexedRelevantResource<K,V>>();
  Collection<K> allKeys=FileBasedIndex.getInstance().getAllKeys(indexId,project);
  for (  K key : allKeys) {
    List<IndexedRelevantResource<K,V>> resources=getResources(indexId,key,module,project,null);
    if (!resources.isEmpty()) {
      if (chooser == null) {
        all.add(resources.get(0));
      }
 else {
        IndexedRelevantResource<K,V> resource=chooser.fun(resources);
        if (resource != null) {
          all.add(resource);
        }
      }
    }
  }
  return all;
}
