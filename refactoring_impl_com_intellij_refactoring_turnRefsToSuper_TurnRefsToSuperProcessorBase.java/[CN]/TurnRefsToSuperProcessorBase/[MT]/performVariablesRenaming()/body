{
  try {
    Map<PsiElement,String> variableRenames=new HashMap<PsiElement,String>();
    for (    Map.Entry<SmartPsiElementPointer,String> entry : myVariablesRenames.entrySet()) {
      variableRenames.put(entry.getKey().getElement(),entry.getValue());
    }
    for (    UsageInfo usage : myVariablesUsages) {
      if (usage instanceof MoveRenameUsageInfo) {
        final MoveRenameUsageInfo renameUsageInfo=((MoveRenameUsageInfo)usage);
        final String newName=variableRenames.get(renameUsageInfo.getUpToDateReferencedElement());
        final PsiReference reference=renameUsageInfo.getReference();
        if (reference != null) {
          reference.handleElementRename(newName);
        }
      }
    }
    for (    Map.Entry<SmartPsiElementPointer,String> entry : myVariablesRenames.entrySet()) {
      final String newName=entry.getValue();
      if (newName != null) {
        final PsiVariable variable=(PsiVariable)entry.getKey().getElement();
        variable.setName(newName);
      }
    }
  }
 catch (  IncorrectOperationException e) {
    LOG.error(e);
  }
}
