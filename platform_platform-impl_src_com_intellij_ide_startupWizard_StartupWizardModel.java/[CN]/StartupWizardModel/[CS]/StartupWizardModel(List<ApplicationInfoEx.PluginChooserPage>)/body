{
  super(ApplicationNamesInfo.getInstance().getFullProductName() + " Initial Configuration Wizard");
  loadDisabledPlugins(new File(PathManager.getConfigPath()));
  for (  ApplicationInfoEx.PluginChooserPage page : pluginChooserPages) {
    if (page.getCategory() == null) {
      myOtherStep=new SelectPluginsStep(page.getTitle(),this,null);
    }
 else {
      addSelectPluginsStep(page.getCategory(),page.getTitle(),page.getDependentPlugin());
    }
  }
  if (myOtherStep != null) {
    add(myOtherStep);
  }
  myAllPlugins=PluginManager.loadDescriptors(null);
  for (  IdeaPluginDescriptor pluginDescriptor : myAllPlugins) {
    if (pluginDescriptor.getPluginId().getIdString().equals("com.intellij")) {
      continue;
    }
    PluginManager.initClassLoader(getClass().getClassLoader(),(IdeaPluginDescriptorImpl)pluginDescriptor);
    SelectPluginsStep step=myStepMap.get(pluginDescriptor.getCategory());
    if (step == null) {
      step=myOtherStep;
    }
    if (step != null) {
      step.addPlugin(pluginDescriptor);
      myPluginToStepMap.put(pluginDescriptor.getPluginId(),step);
      for (      PluginId pluginId : pluginDescriptor.getDependentPluginIds()) {
        if (!ArrayUtil.contains(pluginId,pluginDescriptor.getOptionalDependentPluginIds())) {
          IdeaPluginDescriptor dependee=findPlugin(pluginId);
          if (dependee != null) {
            myBackwardDependencies.putValue(dependee,pluginDescriptor);
          }
        }
      }
    }
  }
  for (  SelectPluginsStep step : myStepMap.values()) {
    step.fillPlugins();
  }
  myOtherStep.fillPlugins();
}
