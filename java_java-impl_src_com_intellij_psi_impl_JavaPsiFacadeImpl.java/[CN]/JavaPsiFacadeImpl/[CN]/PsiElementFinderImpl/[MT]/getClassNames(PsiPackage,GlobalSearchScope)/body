{
  Set<String> names=null;
  for (  PsiDirectory dir : psiPackage.getDirectories(scope)) {
    for (    PsiFile file : dir.getFiles()) {
      FileViewProvider viewProvider=file.getViewProvider();
      if (file instanceof PsiClassOwner && file == viewProvider.getPsi(viewProvider.getBaseLanguage())) {
        Set<String> inFile=file instanceof PsiClassOwnerEx ? ((PsiClassOwnerEx)file).getClassNames() : getClassNames(((PsiClassOwner)file).getClasses());
        if (inFile.isEmpty())         continue;
        if (names == null)         names=new HashSet<String>();
        names.addAll(inFile);
      }
    }
  }
  return names == null ? Collections.<String>emptySet() : names;
}
