{
  final DataContext dataContext=e.getDataContext();
  Project project=DataKeys.PROJECT.getData(dataContext);
  FileEditorManagerEx fileEditorManager=FileEditorManagerEx.getInstanceEx(project);
  VirtualFile selectedFile;
  final EditorWindow window=(EditorWindow)dataContext.getData(DataConstantsEx.EDITOR_WINDOW);
  if (window != null) {
    selectedFile=(VirtualFile)dataContext.getData(DataConstants.VIRTUAL_FILE);
    final VirtualFile[] files=window.getFiles();
    for (int i=0; i < files.length; i++) {
      VirtualFile file=files[i];
      if (file != selectedFile) {
        window.closeFile(file);
      }
    }
    return;
  }
  selectedFile=fileEditorManager.getSelectedFiles()[0];
  VirtualFile[] siblings=fileEditorManager.getSiblings(selectedFile);
  for (int i=0; i < siblings.length; i++) {
    if (selectedFile != siblings[i]) {
      fileEditorManager.closeFile(siblings[i]);
    }
  }
}
