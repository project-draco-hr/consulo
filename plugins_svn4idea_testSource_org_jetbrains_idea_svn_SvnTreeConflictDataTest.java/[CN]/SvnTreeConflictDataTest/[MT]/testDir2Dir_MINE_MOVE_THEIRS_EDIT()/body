{
  final String conflictFile=createConflict(TreeConflictData.DirToDir.MINE_MOVE_THEIRS_EDIT);
  VcsDirtyScopeManager.getInstance(myProject).markEverythingDirty();
  ChangeListManager changeListManager=ChangeListManager.getInstance(myProject);
  changeListManager.ensureUpToDate(false);
  final Change change=changeListManager.getChange(new FilePathImpl(new File(myWorkingCopyDir.getPath(),conflictFile),true));
  Assert.assertTrue(change instanceof ConflictedSvnChange);
  SVNTreeConflictDescription beforeDescription=((ConflictedSvnChange)change).getBeforeDescription();
  Assert.assertNotNull(beforeDescription);
  final SVNTreeConflictDescription afterDescription=((ConflictedSvnChange)change).getAfterDescription();
  Assert.assertNull(afterDescription);
  Assert.assertEquals(SVNOperation.UPDATE,beforeDescription.getOperation());
  Assert.assertEquals(SVNConflictAction.EDIT,beforeDescription.getConflictAction());
  Assert.assertTrue(beforeDescription.isTreeConflict());
  SVNConflictVersion leftVersion=beforeDescription.getSourceLeftVersion();
  Assert.assertNotNull(leftVersion);
  Assert.assertEquals(SVNNodeKind.DIR,leftVersion.getKind());
  final SVNConflictVersion version=beforeDescription.getSourceRightVersion();
  Assert.assertNotNull(version);
  Assert.assertEquals(SVNNodeKind.DIR,version.getKind());
}
