{
  final UsageNode node;
synchronized (lock) {
    UsageNode mergedWith=tryMerge(usage);
    if (mergedWith != null) {
      return mergedWith;
    }
    node=new UsageNode(usage,getBuilder());
    myUsageNodes.add(node);
  }
  if (!getBuilder().isDetachedMode()) {
    UIUtil.invokeLaterIfNeeded(new Runnable(){
      public void run(){
        myTreeModel.insertNodeInto(node,GroupNode.this,getNodeIndex(node));
        incrementUsageCount();
      }
    }
);
  }
  return node;
}
