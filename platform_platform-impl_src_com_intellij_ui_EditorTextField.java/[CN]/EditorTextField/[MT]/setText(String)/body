{
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    @Override public void run(){
      CommandProcessor.getInstance().executeCommand(getProject(),new Runnable(){
        @Override public void run(){
          myDocument.replaceString(0,myDocument.getTextLength(),text);
          if (myEditor != null) {
            final CaretModel caretModel=myEditor.getCaretModel();
            if (caretModel.getOffset() >= myDocument.getTextLength()) {
              caretModel.moveToOffset(myDocument.getTextLength());
            }
          }
        }
      }
,null,null,UndoConfirmationPolicy.DEFAULT,getDocument());
    }
  }
);
}
