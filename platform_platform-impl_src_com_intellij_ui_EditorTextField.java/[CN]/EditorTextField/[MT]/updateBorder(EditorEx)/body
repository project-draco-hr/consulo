{
  if (editor.isOneLineMode() && !Boolean.TRUE.equals(getClientProperty("JComboBox.isTableCellEditor")) && (SwingUtilities.getAncestorOfClass(JTable.class,this) == null || Boolean.TRUE.equals(getClientProperty("JBListTable.isTableCellEditor")))) {
    final Container parent=getParent();
    if (parent instanceof JTable || parent instanceof CellRendererPane)     return;
    if (UIUtil.isUnderAquaLookAndFeel() || UIUtil.isUnderDarkBuildInLaf()) {
      editor.setBorder(UIUtil.isUnderDarkBuildInLaf() ? new DarculaEditorTextFieldBorder() : new MacUIUtil.EditorTextFieldBorder(this));
      editor.addFocusListener(new FocusChangeListener(){
        @Override public void focusGained(        Editor editor){
          repaint();
        }
        @Override public void focusLost(        Editor editor){
          repaint();
        }
      }
);
    }
 else {
      editor.setBorder(BorderFactory.createCompoundBorder(UIUtil.getTextFieldBorder(),JBUI.Borders.empty(2,2,2,2)));
    }
  }
}
