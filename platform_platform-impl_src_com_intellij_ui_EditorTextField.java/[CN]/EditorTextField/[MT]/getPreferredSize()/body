{
  if (super.isPreferredSizeSet()) {
    return super.getPreferredSize();
  }
  boolean toReleaseEditor=false;
  if (myEditor == null && myEnsureWillComputePreferredSize) {
    myEnsureWillComputePreferredSize=false;
    initEditor();
    toReleaseEditor=true;
  }
  Dimension size=new Dimension(100,20);
  if (myEditor != null) {
    final Dimension preferredSize=new Dimension(myEditor.getComponent().getPreferredSize());
    final Insets insets=getInsets();
    if (insets != null) {
      preferredSize.width+=insets.left;
      preferredSize.width+=insets.right;
      preferredSize.height+=insets.top;
      preferredSize.height+=insets.bottom;
    }
    size=preferredSize;
  }
 else   if (myPassivePreferredSize != null) {
    size=myPassivePreferredSize;
  }
  if (toReleaseEditor) {
    releaseEditor();
    myPassivePreferredSize=size;
  }
  return size;
}
