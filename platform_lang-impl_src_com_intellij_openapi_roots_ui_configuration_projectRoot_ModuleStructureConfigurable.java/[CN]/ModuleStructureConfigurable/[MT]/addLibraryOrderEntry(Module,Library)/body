{
  Component parent=WindowManager.getInstance().suggestParentWindow(module.getProject());
  final ModuleEditor moduleEditor=myContext.myModulesConfigurator.getModuleEditor(module);
  LOG.assertTrue(moduleEditor != null,"Current module editor was not initialized");
  final ModifiableRootModel modelProxy=moduleEditor.getModifiableRootModelProxy();
  final OrderEntry[] entries=modelProxy.getOrderEntries();
  for (  OrderEntry entry : entries) {
    if (entry instanceof LibraryOrderEntry && Comparing.strEqual(entry.getPresentableName(),library.getName())) {
      if (Messages.showYesNoDialog(parent,ProjectBundle.message("project.roots.replace.library.entry.message",entry.getPresentableName()),ProjectBundle.message("project.roots.replace.library.entry.title"),Messages.getInformationIcon()) == Messages.YES) {
        modelProxy.removeOrderEntry(entry);
        break;
      }
    }
  }
  modelProxy.addLibraryEntry(library);
  myContext.getDaemonAnalyzer().queueUpdate(new ModuleProjectStructureElement(myContext,module));
  myTree.repaint();
}
