{
  if (ProgramRunnerUtil.getRunner(executor.getId(),configuration) == null) {
    return;
  }
  final List<RunContentDescriptor> descriptorsToStop=new ArrayList<RunContentDescriptor>();
  if (configuration.isSingleton()) {
    descriptorsToStop.addAll(getRunningDescriptors(configuration));
  }
 else   if (currentDescriptor != null) {
    descriptorsToStop.add(currentDescriptor);
  }
  if (!descriptorsToStop.isEmpty()) {
    if ((descriptorsToStop.size() > 1 || currentDescriptor == null || descriptorsToStop.get(0) != currentDescriptor) && !userApprovesStop(project,configuration.getName(),descriptorsToStop.size())) {
      return;
    }
    for (    RunContentDescriptor descriptor : descriptorsToStop) {
      stop(descriptor);
    }
  }
 else {
    ProgramRunnerUtil.executeConfiguration(project,configuration,executor,target,currentDescriptor,true);
    return;
  }
  Runnable runnable=new Runnable(){
    @Override public void run(){
      for (      RunContentDescriptor descriptor : descriptorsToStop) {
        ProcessHandler processHandler=descriptor.getProcessHandler();
        if (processHandler != null && !processHandler.isProcessTerminated()) {
          awaitingTerminationAlarm.addRequest(this,100);
          return;
        }
      }
      ProgramRunnerUtil.executeConfiguration(project,configuration,executor,target,currentDescriptor,true);
    }
  }
;
  awaitingTerminationAlarm.addRequest(runnable,100);
}
