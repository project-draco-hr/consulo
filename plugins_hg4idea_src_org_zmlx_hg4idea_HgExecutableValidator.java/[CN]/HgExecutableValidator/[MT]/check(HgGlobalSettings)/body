{
  HgVersionCommand command=new HgVersionCommand();
  if (command.isValid(globalSettings.getHgExecutable())) {
    return true;
  }
  String previousHgPath=globalSettings.getHgExecutable();
  boolean validHgExecutable;
  HgSetExecutableDialog dialog;
  do {
    dialog=new HgSetExecutableDialog(project);
    dialog.setBadHgPath(previousHgPath);
    dialog.show();
    validHgExecutable=dialog.isOK() && command.isValid(dialog.getNewHgPath());
    previousHgPath=dialog.getNewHgPath();
  }
 while (!validHgExecutable && dialog.isOK());
  if (validHgExecutable) {
    globalSettings.setHgExecutable(dialog.getNewHgPath());
    return true;
  }
  return false;
}
