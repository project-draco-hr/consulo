{
  context.commitDocument();
  PsiExpression expression=PsiTreeUtil.findElementOfClassAtOffset(context.getFile(),offset,PsiExpression.class,false);
  if (expression == null)   return null;
  for (  final ExpectedTypeInfo type : ExpectedTypesProvider.getExpectedTypes(expression,true)) {
    if (type.isInsertExplicitTypeParams()) {
      return type.getType();
    }
  }
  return null;
}
