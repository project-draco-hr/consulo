{
  saveTemplates();
  validateRecentNames();
  Element deletedTemplatesElement=new Element("deleted_templates");
  element.addContent(deletedTemplatesElement);
  myDeletedTemplatesManager.writeExternal(deletedTemplatesElement);
  Element deletedIncludesElement=new Element("deleted_includes");
  element.addContent(deletedIncludesElement);
  myPatternsManager.myDeletedTemplatesManager.writeExternal(deletedIncludesElement);
  Element recentElement=new Element("recent_templates");
  element.addContent(recentElement);
  myRecentList.writeExternal(recentElement);
  Element templatesElement=new Element("templates");
  element.addContent(templatesElement);
  revalidate();
  FileTemplate[] internals=getInternalTemplates();
  for (int i=0; i < internals.length; i++) {
    templatesElement.addContent(createElement(internals[i],true));
  }
  FileTemplate[] allTemplates=getAllTemplates();
  for (int i=0; i < allTemplates.length; i++) {
    FileTemplate fileTemplate=allTemplates[i];
    templatesElement.addContent(createElement(fileTemplate,false));
  }
}
