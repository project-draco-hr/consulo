{
  saveTemplates();
  validateRecentNames();
  Element deletedTemplatesElement=new Element(ELEMENT_DELETED_TEMPLATES);
  element.addContent(deletedTemplatesElement);
  myDeletedTemplatesManager.writeExternal(deletedTemplatesElement);
  Element deletedIncludesElement=new Element(ELEMENT_DELETED_INCLUDES);
  element.addContent(deletedIncludesElement);
  myPatternsManager.myDeletedTemplatesManager.writeExternal(deletedIncludesElement);
  Element recentElement=new Element(ELEMENT_RECENT_TEMPLATES);
  element.addContent(recentElement);
  myRecentList.writeExternal(recentElement);
  Element templatesElement=new Element(ELEMENT_TEMPLATES);
  element.addContent(templatesElement);
  invalidate();
  FileTemplate[] internals=getInternalTemplates();
  for (  FileTemplate internal : internals) {
    templatesElement.addContent(createElement(internal,true));
  }
  FileTemplate[] allTemplates=getAllTemplates();
  for (  FileTemplate fileTemplate : allTemplates) {
    templatesElement.addContent(createElement(fileTemplate,false));
  }
}
