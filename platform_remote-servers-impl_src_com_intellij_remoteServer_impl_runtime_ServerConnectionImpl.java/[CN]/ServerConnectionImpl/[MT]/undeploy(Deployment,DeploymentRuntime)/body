{
  final String deploymentName=deployment.getName();
  myLocalDeployments.put(deploymentName,new DeploymentImpl(deploymentName,DeploymentStatus.UNDEPLOYING,null,null));
  myEventDispatcher.queueDeploymentsChanged(this);
  final LoggingHandlerImpl loggingHandler=myLoggingHandlers.get(deploymentName);
  loggingHandler.printlnSystemMessage("Undeploying '" + deploymentName + "'...");
  runtime.undeploy(new DeploymentRuntime.UndeploymentTaskCallback(){
    @Override public void succeeded(){
      loggingHandler.printlnSystemMessage("'" + deploymentName + "' has been undeployed successfully.");
      myLocalDeployments.remove(deploymentName);
      myLoggingHandlers.remove(deploymentName);
      myEventDispatcher.queueDeploymentsChanged(ServerConnectionImpl.this);
    }
    @Override public void errorOccurred(    @NotNull String errorMessage){
      loggingHandler.printlnSystemMessage("Failed to undeploy '" + deploymentName + "': "+ errorMessage);
      myLocalDeployments.put(deploymentName,new DeploymentImpl(deploymentName,DeploymentStatus.DEPLOYED,errorMessage,runtime));
      myEventDispatcher.queueDeploymentsChanged(ServerConnectionImpl.this);
    }
  }
);
}
