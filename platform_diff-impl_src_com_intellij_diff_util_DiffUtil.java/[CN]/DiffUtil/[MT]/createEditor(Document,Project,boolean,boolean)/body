{
  EditorFactory factory=EditorFactory.getInstance();
  EditorEx editor=(EditorEx)(isViewer ? factory.createViewer(document,project) : factory.createEditor(document,project));
  editor.putUserData(DiffManagerImpl.EDITOR_IS_DIFF_KEY,Boolean.TRUE);
  editor.getSettings().setShowIntentionBulb(false);
  ((EditorMarkupModel)editor.getMarkupModel()).setErrorStripeVisible(true);
  editor.getGutterComponentEx().setShowDefaultGutterPopup(false);
  if (enableFolding) {
    setFoldingModelSupport(editor);
  }
 else {
    editor.getSettings().setFoldingOutlineShown(false);
    editor.getFoldingModel().setFoldingEnabled(false);
  }
  UIUtil.removeScrollBorder(editor.getComponent());
  return editor;
}
