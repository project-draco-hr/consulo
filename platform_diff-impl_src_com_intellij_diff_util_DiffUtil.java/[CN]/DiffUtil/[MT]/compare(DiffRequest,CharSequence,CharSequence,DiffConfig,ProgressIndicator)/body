{
  indicator.checkCanceled();
  DiffUserDataKeysEx.DiffComputer diffComputer=request.getUserData(DiffUserDataKeysEx.CUSTOM_DIFF_COMPUTER);
  List<LineFragment> fragments;
  if (diffComputer != null) {
    fragments=diffComputer.compute(text1,text2,config.policy,config.innerFragments,indicator);
  }
 else {
    if (config.innerFragments) {
      fragments=ComparisonManager.getInstance().compareLinesInner(text1,text2,config.policy,indicator);
    }
 else {
      fragments=ComparisonManager.getInstance().compareLines(text1,text2,config.policy,indicator);
    }
  }
  indicator.checkCanceled();
  return ComparisonManager.getInstance().processBlocks(fragments,text1,text2,config.policy,config.squashFragments,config.trimFragments);
}
