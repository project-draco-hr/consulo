{
  FList<LookupElement> forPreselection=FList.emptyList();
  FList<LookupElement> forSorting=FList.emptyList();
  for (  String string : element.getAllLookupStrings()) {
    for (int len=1; len < string.length(); len++) {
      String prefix=string.substring(0,len);
      for (      LookupElement shorterElement : myElements.get(prefix)) {
        if (myCondition.shouldLift(shorterElement,element)) {
          forPreselection=prependOrReuse(forPreselection,shorterElement);
        }
 else {
          forSorting=prependOrReuse(forSorting,shorterElement);
        }
      }
    }
  }
  if (!forPreselection.isEmpty()) {
    myToLiftForPreselection.put(element,forPreselection);
  }
  if (!forSorting.isEmpty()) {
    myToLiftForSorting.put(element,forSorting);
  }
}
