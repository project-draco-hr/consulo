{
  final Set<LookupElement> toUpdate=new THashSet<LookupElement>(TObjectHashingStrategy.IDENTITY);
  toUpdate.add(element);
  final Set<String> strings=getAllLookupStrings(element);
  for (  String string : strings) {
    if (string.length() == 0)     continue;
    myElements.putValue(string,element);
    mySortedStrings.add(string);
    final NavigableSet<String> after=mySortedStrings.tailSet(string,false);
    for (    String s : after) {
      if (!s.startsWith(string)) {
        break;
      }
      myPrefixes.putValue(s,string);
      toUpdate.addAll(myElements.get(s));
    }
    final char first=string.charAt(0);
    final SortedSet<String> before=mySortedStrings.descendingSet().tailSet(string,false);
    for (    String s : before) {
      if (s.charAt(0) != first) {
        break;
      }
      if (string.startsWith(s)) {
        myPrefixes.putValue(string,s);
      }
    }
  }
  myNext.addElement(element);
  for (  LookupElement lookupElement : toUpdate) {
    recalculateToLift(lookupElement);
  }
}
