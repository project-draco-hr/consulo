{
  if (ApplicationManager.getApplication().isReadAccessAllowed()) {
    try {
      return task.compute();
    }
 catch (    IndexNotReadyException e) {
      if (notification != null) {
        showDumbModeNotification(notification);
      }
      return null;
    }
  }
 else {
    return runReadActionInSmartMode(task);
  }
}
