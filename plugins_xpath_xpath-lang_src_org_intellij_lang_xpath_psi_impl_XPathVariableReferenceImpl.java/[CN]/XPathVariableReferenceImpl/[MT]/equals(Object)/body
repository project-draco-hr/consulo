{
  if (obj == this)   return true;
  if (obj == null)   return false;
  if (obj.getClass() != getClass())   return false;
  final XPathVariableReference ref=(XPathVariableReference)obj;
  final QName name=ContextProvider.getContextProvider(this).getQName(this);
  if (name == null) {
    return Comparing.equal(getReferencedName(),ref.getReferencedName());
  }
  if (!Comparing.equal(name,ContextProvider.getContextProvider(ref).getQName(ref))) {
    return false;
  }
  final XPathVariable variable=resolve();
  return Comparing.equal(variable,ref.resolve());
}
