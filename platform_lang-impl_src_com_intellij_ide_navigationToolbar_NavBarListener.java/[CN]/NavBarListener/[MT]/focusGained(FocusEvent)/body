{
  if (e.getOppositeComponent() == null && shouldFocusEditor) {
    shouldFocusEditor=false;
    ToolWindowManager.getInstance(myPanel.getProject()).activateEditorComponent();
    return;
  }
  myPanel.updateItems();
  final List<NavBarItem> items=myPanel.getItems();
  if (!myPanel.isInFloatingMode() && items.size() > 0) {
    myPanel.setContextComponent(items.get(items.size() - 1));
  }
 else {
    myPanel.setContextComponent(null);
  }
}
