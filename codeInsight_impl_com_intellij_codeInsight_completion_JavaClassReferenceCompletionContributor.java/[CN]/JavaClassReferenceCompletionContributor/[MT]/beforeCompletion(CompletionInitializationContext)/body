{
  final PsiFile file=context.getFile();
  final Project project=context.getProject();
  JavaCompletionUtil.initOffsets(file,project,context.getOffsetMap());
  PsiReference reference=file.findReferenceAt(context.getStartOffset());
  if (reference instanceof PsiMultiReference) {
    for (    final PsiReference psiReference : ((PsiMultiReference)reference).getReferences()) {
      if (psiReference instanceof JavaClassReference) {
        reference=psiReference;
        break;
      }
    }
  }
  if (reference instanceof JavaClassReference) {
    final JavaClassReference classReference=(JavaClassReference)reference;
    if (classReference.getExtendClassNames() != null) {
      final PsiReference[] references=classReference.getJavaClassReferenceSet().getReferences();
      final PsiReference lastReference=references[references.length - 1];
      final int endOffset=lastReference.getRangeInElement().getEndOffset() + lastReference.getElement().getTextRange().getStartOffset();
      context.getOffsetMap().addOffset(CompletionInitializationContext.IDENTIFIER_END_OFFSET,endOffset);
    }
  }
}
