{
  PsiDocumentManager.getInstance(project).commitAllDocuments();
  if (!(file instanceof GroovyFileBase)) {
    String message=RefactoringBundle.getCannotRefactorMessage(GroovyRefactoringBundle.message("only.in.groovy.files"));
    showErrorMessage(project,editor,message);
    return false;
  }
  GrExpression tempExpr=GroovyRefactoringUtil.findElementInRange((GroovyFileBase)file,startOffset,endOffset,GrExpression.class);
  return invokeImpl(project,tempExpr,editor);
}
