{
  new WriteCommandAction(getProject()){
    @Override protected void run(    Result result) throws Throwable {
      final ModifiableRootModel model=ModuleRootManager.getInstance(from).getModifiableModel();
      model.addModuleOrderEntry(to);
      model.commit();
    }
  }
.execute().getResultObject();
}
