{
  final Semaphore semaphore=new Semaphore();
  semaphore.down();
  final ErrorReportingCallback callback=new ErrorReportingCallback(semaphore);
  UIUtil.invokeAndWaitIfNeeded(new Runnable(){
    @Override public void run(){
      try {
        CompilerManager.getInstance(getProject()).make(callback);
      }
 catch (      Exception e) {
        throw new RuntimeException(e);
      }
    }
  }
);
  while (!semaphore.waitFor(100)) {
    if (SwingUtilities.isEventDispatchThread()) {
      UIUtil.dispatchAllInvocationEvents();
    }
  }
  callback.throwException();
  return callback.getMessages();
}
