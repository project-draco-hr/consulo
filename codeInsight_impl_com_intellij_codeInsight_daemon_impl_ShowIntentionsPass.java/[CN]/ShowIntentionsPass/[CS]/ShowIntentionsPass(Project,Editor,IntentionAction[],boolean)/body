{
  super(project,editor.getDocument());
  ApplicationManager.getApplication().assertIsDispatchThread();
  myIsSecondPass=isSecondPass;
  myProject=project;
  myEditor=editor;
  myIntentionActions=intentionActions;
  Rectangle visibleRect=myEditor.getScrollingModel().getVisibleArea();
  LogicalPosition startPosition=myEditor.xyToLogicalPosition(new Point(visibleRect.x,visibleRect.y));
  myStartOffset=myEditor.logicalPositionToOffset(startPosition);
  LogicalPosition endPosition=myEditor.xyToLogicalPosition(new Point(visibleRect.x + visibleRect.width,visibleRect.y + visibleRect.height));
  myEndOffset=myEditor.logicalPositionToOffset(new LogicalPosition(endPosition.line + 1,0));
  myFile=PsiDocumentManager.getInstance(myProject).getPsiFile(myEditor.getDocument());
  LOG.assertTrue(myFile != null);
}
