{
  new WriteCommandAction.Simple(module.getProject()){
    @Override protected void run() throws Throwable {
      final ModuleRootManager rootManager=ModuleRootManager.getInstance(module);
      final ModifiableRootModel rootModel=rootManager.getModifiableModel();
      final ContentEntry contentEntry=rootModel.addContentEntry(vDir);
      contentEntry.addFolder(vDir,testSource ? ContentFolderType.TEST : ContentFolderType.PRODUCTION);
      rootModel.commit();
    }
  }
.execute().throwException();
}
