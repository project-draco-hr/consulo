{
  if (!editor.getCaretModel().supportsMultipleCarets()) {
    return false;
  }
  int caretOffset=getCaretPosition(result,caretShiftFromSelectionStart);
  EditorActionUtil.makePositionVisible(editor,caretOffset);
  Caret newCaret=editor.getCaretModel().addCaret(editor.offsetToVisualPosition(caretOffset));
  if (newCaret == null) {
    return false;
  }
 else {
    int selectionStartOffset=result.getStartOffset();
    int selectionEndOffset=result.getEndOffset();
    EditorActionUtil.makePositionVisible(editor,selectionStartOffset);
    EditorActionUtil.makePositionVisible(editor,selectionEndOffset);
    newCaret.setSelection(selectionStartOffset,selectionEndOffset);
    return true;
  }
}
