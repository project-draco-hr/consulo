{
  Document document=editor.getDocument();
  if (!FileDocumentManager.getInstance().requestWriting(document,project)) {
    return false;
  }
  document.startGuardedBlockChecking();
  boolean toPrompt=model.isPromptOnReplace();
  try {
    doReplace(project,editor,model,document,offset,toPrompt,delegate);
  }
 catch (  ReadOnlyFragmentModificationException e) {
    EditorActionManager.getInstance().getReadonlyFragmentModificationHandler(document).handle(e);
  }
 finally {
    document.stopGuardedBlockChecking();
  }
  return true;
}
