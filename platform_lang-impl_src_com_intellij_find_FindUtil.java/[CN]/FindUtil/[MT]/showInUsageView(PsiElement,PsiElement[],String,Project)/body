{
  if (targets.length == 0)   return null;
  final UsageViewPresentation presentation=new UsageViewPresentation();
  presentation.setCodeUsagesString(title);
  presentation.setTabName(title);
  presentation.setTabText(title);
  final UsageTarget[] usageTargets=sourceElement == null ? UsageTarget.EMPTY_ARRAY : new UsageTarget[]{new PsiElement2UsageTargetAdapter(sourceElement)};
  final PsiElement[] primary=sourceElement == null ? PsiElement.EMPTY_ARRAY : new PsiElement[]{sourceElement};
  final Usage[] usages={UsageInfoToUsageConverter.convert(primary,new UsageInfo(targets[0]))};
  final UsageView view=UsageViewManager.getInstance(project).showUsages(usageTargets,usages,presentation);
  final List<SmartPsiElementPointer> pointers=ContainerUtil.map(targets,new Function<PsiElement,SmartPsiElementPointer>(){
    @Override public SmartPsiElementPointer fun(    PsiElement psiElement){
      return SmartPointerManager.getInstance(project).createSmartPsiElementPointer(psiElement);
    }
  }
);
  targets=PsiElement.EMPTY_ARRAY;
  ProgressManager.getInstance().run(new Task.Backgroundable(project,"Updating Usage View ..."){
    @Override public void run(    @NotNull ProgressIndicator indicator){
      for (      final SmartPsiElementPointer pointer : pointers) {
        if (((UsageViewImpl)view).isDisposed())         break;
        ApplicationManager.getApplication().runReadAction(new Runnable(){
          @Override public void run(){
            final PsiElement target=pointer.getElement();
            if (target != null) {
              view.appendUsage(UsageInfoToUsageConverter.convert(primary,new UsageInfo(target)));
            }
          }
        }
);
      }
    }
  }
);
  return view;
}
