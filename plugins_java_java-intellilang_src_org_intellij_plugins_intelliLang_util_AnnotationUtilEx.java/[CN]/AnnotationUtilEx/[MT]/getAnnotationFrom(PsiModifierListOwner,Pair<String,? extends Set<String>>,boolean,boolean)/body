{
  if (!PsiUtilEx.isLanguageAnnotationTarget(owner))   return PsiAnnotation.EMPTY_ARRAY;
  final PsiAnnotation directAnnotation=inHierarchy ? AnnotationUtil.findAnnotationInHierarchy(owner,annotationName.second) : AnnotationUtil.findAnnotation(owner,annotationName.second);
  if (directAnnotation != null) {
    return new PsiAnnotation[]{directAnnotation};
  }
  if (allowIndirect) {
    final PsiAnnotation[] annotations=getAnnotations(owner,inHierarchy);
    for (    PsiAnnotation annotation : annotations) {
      PsiJavaCodeReferenceElement nameReference=annotation.getNameReferenceElement();
      if (nameReference == null)       continue;
      PsiElement resolved=nameReference.resolve();
      if (resolved instanceof PsiClass) {
        final PsiAnnotation psiAnnotation=AnnotationUtil.findAnnotationInHierarchy((PsiModifierListOwner)resolved,annotationName.second);
        if (psiAnnotation != null) {
          return new PsiAnnotation[]{psiAnnotation,annotation};
        }
      }
    }
  }
  return PsiAnnotation.EMPTY_ARRAY;
}
