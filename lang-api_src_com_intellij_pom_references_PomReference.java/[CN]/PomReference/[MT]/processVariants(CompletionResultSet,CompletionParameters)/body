{
  final LookupElement[] elements=ApplicationManager.getApplication().runReadAction(new Computable<LookupElement[]>(){
    public LookupElement[] compute(){
      return getVariants();
    }
  }
);
  for (  final LookupElement element : elements) {
    result.addElement(element);
  }
}
