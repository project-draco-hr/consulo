{
  if (selectedValue.second instanceof PopupQuickFix) {
    return ((PopupQuickFix)selectedValue.second).getPopupStep();
  }
  if (finalChoice || !myShowSuppresses) {
    return doFinalStep(new Runnable(){
      public void run(){
        CommandProcessor.getInstance().executeCommand(myEditor.getProject(),new Runnable(){
          public void run(){
            selectedValue.second.run();
          }
        }
,selectedValue.second.getName(),null);
      }
    }
);
  }
  if (selectedValue.first.getInspectionId() != null && selectedValue.second.getComponent() != null && !(selectedValue.second instanceof SuppressFix)) {
    ArrayList<ErrorWithFix> suppressList=new ArrayList<ErrorWithFix>();
    buildSuppressFixes(selectedValue.first,suppressList,false);
    return new QuickFixPopupStep(suppressList,false);
  }
  return FINAL_CHOICE;
}
