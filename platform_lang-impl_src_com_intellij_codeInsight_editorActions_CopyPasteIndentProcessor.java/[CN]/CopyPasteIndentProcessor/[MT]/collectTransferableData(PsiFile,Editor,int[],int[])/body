{
  if (!acceptFileType(file.getFileType())) {
    return null;
  }
  if (startOffsets.length != 1) {
    return null;
  }
  Document document=editor.getDocument();
  int selStartLine=document.getLineNumber(startOffsets[0]);
  int selEndLine=document.getLineNumber(endOffsets[0]);
  for (int offset=startOffsets[0] - 1; offset >= document.getLineStartOffset(selStartLine); offset--) {
    if (!Character.isWhitespace(document.getCharsSequence().charAt(offset))) {
      return null;
    }
  }
  int minIndent=Integer.MAX_VALUE;
  int maxIndent=0;
  int tabSize=CodeStyleFacade.getInstance(file.getProject()).getTabSize(file.getFileType());
  for (int line=selStartLine; line <= selEndLine; line++) {
    int start=document.getLineStartOffset(line);
    int end=document.getLineEndOffset(line);
    int indent=getIndent(document.getCharsSequence(),start,end,tabSize);
    if (indent >= 0) {
      minIndent=Math.min(minIndent,indent);
      maxIndent=Math.max(minIndent,indent);
    }
  }
  int firstNonSpaceChar=CharArrayUtil.shiftForward(document.getCharsSequence(),startOffsets[0]," \t");
  int firstLineLeadingSpaces=(firstNonSpaceChar <= document.getLineEndOffset(selStartLine)) ? firstNonSpaceChar - startOffsets[0] : 0;
  return new IndentTransferableData(maxIndent - minIndent,maxIndent,firstLineLeadingSpaces);
}
