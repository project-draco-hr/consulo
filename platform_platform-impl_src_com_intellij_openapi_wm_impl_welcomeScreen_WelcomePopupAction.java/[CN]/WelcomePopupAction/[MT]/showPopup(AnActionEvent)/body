{
  final DefaultActionGroup group=new DefaultActionGroup();
  fillActions(group);
  if (group.getChildrenCount() == 1 && isSilentlyChooseSingleOption()) {
    final AnAction[] children=group.getChildren(null);
    children[0].actionPerformed(e);
    return;
  }
  if (group.getChildrenCount() == 0) {
    group.add(new AnAction(getTextForEmpty()){
      public void actionPerformed(      AnActionEvent e){
        group.setPopup(false);
      }
    }
);
  }
  final DataContext context=e.getDataContext();
  final ListPopup popup=JBPopupFactory.getInstance().createActionGroupPopup(getCaption(),group,context,JBPopupFactory.ActionSelectionAid.ALPHA_NUMBERING,true);
  Component focusedComponent=PlatformDataKeys.CONTEXT_COMPONENT.getData(context);
  if (focusedComponent != null) {
    popup.showUnderneathOf(focusedComponent);
  }
 else {
    Rectangle r;
    int x;
    int y;
    focusedComponent=WindowManagerEx.getInstanceEx().getFocusedComponent((Project)null);
    r=WindowManagerEx.getInstanceEx().getScreenBounds();
    x=r.x + r.width / 2;
    y=r.y + r.height / 2;
    Point point=new Point(x,y);
    SwingUtilities.convertPointToScreen(point,focusedComponent.getParent());
    popup.showInScreenCoordinates(focusedComponent.getParent(),point);
  }
}
