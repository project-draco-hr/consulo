{
  List<MavenProjectsProcessorTask> postTasks=new ArrayList<MavenProjectsProcessorTask>();
  boolean hasChanges=false;
  hasChanges|=deleteIncompatibleModules();
  myProjectsToImportWithChanges=collectProjectsToImport(myProjectsToImportWithChanges);
  mapMavenProjectsToModulesAndNames();
  boolean projectsHaveChanges=doProjectsToImportHaveChanges();
  if (projectsHaveChanges) {
    hasChanges=true;
    importModules(postTasks);
    scheduleRefreshResolvedArtifacts(postTasks);
    configSettings();
  }
  if (projectsHaveChanges || myImportModuleGroupsRequired) {
    hasChanges=true;
    configModuleGroups();
  }
  boolean modulesDeleted=deleteObsoleteModules();
  hasChanges|=modulesDeleted;
  if (hasDependenciesChanges() || modulesDeleted) {
    hasChanges|=removeUnusedProjectLibraries();
  }
  if (hasChanges) {
    myModelsProvider.commit();
  }
 else {
    myModelsProvider.dispose();
  }
  return postTasks;
}
