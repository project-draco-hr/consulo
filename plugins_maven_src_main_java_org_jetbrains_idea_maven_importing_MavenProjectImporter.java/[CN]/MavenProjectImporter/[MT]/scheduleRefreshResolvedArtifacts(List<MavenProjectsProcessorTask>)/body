{
  List<MavenArtifact> artifacts=new ArrayList<MavenArtifact>();
  for (  MavenProject each : myProjectsToImportWithChanges.keySet()) {
    artifacts.addAll(each.getDependencies());
  }
  final Set<File> files=new THashSet<File>();
  for (  MavenArtifact each : artifacts) {
    if (each.isResolved())     files.add(each.getFile());
  }
  if (ApplicationManager.getApplication().isUnitTestMode()) {
    doRefreshFiles(files);
  }
 else {
    postTasks.add(new MavenProjectsProcessorTask(){
      public void perform(      Project project,      MavenEmbeddersManager embeddersManager,      MavenConsole console,      MavenProgressIndicator indicator) throws MavenProcessCanceledException {
        indicator.setText("Refreshing files...");
        doRefreshFiles(files);
      }
    }
);
  }
}
