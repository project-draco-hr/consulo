{
  Set<MavenProject> projects=myProjectsToImport;
  Set<MavenProject> projectsWithNewlyCreatedModules=new THashSet<MavenProject>();
  for (  MavenProject each : projects) {
    if (ensureModuleCreated(each)) {
      projectsWithNewlyCreatedModules.add(each);
    }
  }
  Map<Module,MavenModuleImporter> moduleImporters=new THashMap<Module,MavenModuleImporter>();
  for (  MavenProject each : projects) {
    Module module=myMavenProjectToModule.get(each);
    MavenModuleImporter importer=createModuleImporter(module,each);
    moduleImporters.put(module,importer);
    importer.config(projectsWithNewlyCreatedModules.contains(each));
  }
  for (  MavenProject each : projects) {
    moduleImporters.get(myMavenProjectToModule.get(each)).preConfigFacets();
  }
  for (  MavenProject each : projects) {
    moduleImporters.get(myMavenProjectToModule.get(each)).configFacets(postTasks);
  }
  for (  MavenModuleImporter each : moduleImporters.values()) {
    myRootModelsToCommit.add(each.getRootModel());
  }
  ArrayList<Module> modules=new ArrayList<Module>(myMavenProjectToModule.values());
  MavenProjectsManager.getInstance(myProject).setMavenizedModules(modules,true);
}
