{
  RootEntry root=new RootEntry();
  root.doCreateDirectory(p("entry"),null);
  root.doCreateFile(p("entry/file"),"",null);
  root.doCreateDirectory(p("entry/dir"),null);
  Change c=new DeleteChange(p("entry"));
  c.applyTo(root);
  os.writeChange(c);
  Entry result=((DeleteChange)is.readChange()).getAffectedEntry();
  assertEquals(DirectoryEntry.class,result.getClass());
  assertEquals("entry",result.getName());
  assertEquals(2,result.getChildren().size());
  assertEquals("file",result.getChildren().get(0).getName());
  assertEquals("dir",result.getChildren().get(1).getName());
}
