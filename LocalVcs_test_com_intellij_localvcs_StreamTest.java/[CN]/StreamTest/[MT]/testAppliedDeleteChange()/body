{
  RootEntry root=new RootEntry("");
  root.doCreateDirectory(1,p("/entry"),null);
  root.doCreateFile(2,p("/entry/file"),"",null);
  root.doCreateDirectory(3,p("/entry/dir"),null);
  Change c=new DeleteChange("/entry");
  c.applyTo(root);
  os.writeChange(c);
  Entry result=((DeleteChange)is.readChange()).getAffectedEntry();
  assertEquals(DirectoryEntry.class,result.getClass());
  assertEquals("entry",result.getName());
  assertEquals(2,result.getChildren().size());
  assertEquals(p("entry/file"),result.getChildren().get(0).getPath());
  assertEquals(p("entry/dir"),result.getChildren().get(1).getPath());
}
