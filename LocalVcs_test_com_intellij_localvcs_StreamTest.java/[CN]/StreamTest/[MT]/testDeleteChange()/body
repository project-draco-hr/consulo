{
  RootEntry root=new RootEntry();
  root.createDirectory(1,"entry",null);
  root.createFile(2,"entry/file",null,null);
  root.createDirectory(3,"entry/dir",null);
  Change c=new DeleteChange("entry");
  c.applyTo(root);
  os.writeChange(c);
  Change read=is.readChange();
  assertEquals(DeleteChange.class,read.getClass());
  DeleteChange result=(DeleteChange)read;
  assertEquals(a(idp(1)),result.getAffectedIdPaths());
  assertEquals("entry",result.getPath());
  Entry e=result.getAffectedEntry();
  assertEquals(DirectoryEntry.class,e.getClass());
  assertEquals("entry",e.getName());
  assertEquals(2,e.getChildren().size());
  assertEquals("entry/file",e.getChildren().get(0).getPath());
  assertEquals("entry/dir",e.getChildren().get(1).getPath());
}
