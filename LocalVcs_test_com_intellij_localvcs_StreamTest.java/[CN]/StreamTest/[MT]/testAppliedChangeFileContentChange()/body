{
  RootEntry root=new RootEntry("");
  root.doCreateFile(1,p("/file"),"content",null);
  Change c=new ChangeFileContentChange("/file","new content",null);
  c.applyTo(root);
  os.writeChange(c);
  Change read=is.readChange();
  assertEquals(ChangeFileContentChange.class,read.getClass());
  ChangeFileContentChange result=((ChangeFileContentChange)read);
  assertEquals(p("/file"),result.getPath());
  assertEquals("new content",result.getNewContent());
  assertEquals("content",result.getOldContent());
  assertElements(new IdPath[]{idp(1)},result.getAffectedEntryIdPaths());
}
