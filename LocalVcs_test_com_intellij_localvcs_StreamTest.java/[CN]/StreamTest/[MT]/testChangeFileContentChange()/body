{
  RootEntry root=new RootEntry();
  root.createFile(1,"file","old content",1L);
  Change c=new ChangeFileContentChange("file","new content",2L);
  c.applyTo(root);
  os.writeChange(c);
  Change read=is.readChange();
  assertEquals(ChangeFileContentChange.class,read.getClass());
  ChangeFileContentChange result=(ChangeFileContentChange)read;
  assertEquals("file",result.getPath());
  assertElements(a(idp(1)),result.getAffectedIdPaths());
  assertEquals("new content",result.getNewContent());
  assertEquals(2L,result.getNewTimestamp());
  assertEquals("old content",result.getOldContent());
  assertEquals(1L,result.getOldTimestamp());
}
