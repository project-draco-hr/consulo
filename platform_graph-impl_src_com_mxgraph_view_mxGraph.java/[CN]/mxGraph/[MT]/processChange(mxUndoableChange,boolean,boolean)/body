{
  mxRectangle result=null;
  if (change instanceof mxRootChange) {
    result=(ignoreDirty) ? null : getGraphBounds();
    if (invalidate) {
      clearSelection();
      removeStateForCell(((mxRootChange)change).getPrevious());
      if (isResetViewOnRootChange()) {
        view.setEventsEnabled(false);
        try {
          view.scaleAndTranslate(1,0,0);
        }
  finally {
          view.setEventsEnabled(true);
        }
      }
    }
    fireEvent(new mxEventObject(mxEvent.ROOT));
  }
 else   if (change instanceof mxChildChange) {
    mxChildChange cc=(mxChildChange)change;
    if (!ignoreDirty) {
      if (cc.getParent() != cc.getPrevious()) {
        if (model.isVertex(cc.getParent()) || model.isEdge(cc.getParent())) {
          result=getBoundingBox(cc.getParent(),true,true);
        }
        if (model.isVertex(cc.getPrevious()) || model.isEdge(cc.getPrevious())) {
          if (result != null) {
            result.add(getBoundingBox(cc.getPrevious(),true,true));
          }
 else {
            result=getBoundingBox(cc.getPrevious(),true,true);
          }
        }
      }
      if (result == null) {
        result=getBoundingBox(cc.getChild(),true,true);
      }
    }
    if (invalidate) {
      if (cc.getParent() != null) {
        view.clear(cc.getChild(),false,true);
      }
 else {
        removeStateForCell(cc.getChild());
      }
    }
  }
 else   if (change instanceof mxTerminalChange) {
    Object cell=((mxTerminalChange)change).getCell();
    if (!ignoreDirty) {
      result=getBoundingBox(cell,true);
    }
    if (invalidate) {
      view.invalidate(cell);
    }
  }
 else   if (change instanceof mxValueChange) {
    Object cell=((mxValueChange)change).getCell();
    if (!ignoreDirty) {
      result=getBoundingBox(cell);
    }
    if (invalidate) {
      view.clear(cell,false,false);
    }
  }
 else   if (change instanceof mxStyleChange) {
    Object cell=((mxStyleChange)change).getCell();
    if (!ignoreDirty) {
      result=getBoundingBox(cell,true);
    }
    if (invalidate) {
      view.clear(cell,false,false);
      view.invalidate(cell);
    }
  }
 else   if (change instanceof mxGeometryChange) {
    Object cell=((mxGeometryChange)change).getCell();
    if (!ignoreDirty) {
      result=getBoundingBox(cell,true,true);
    }
    if (invalidate) {
      view.invalidate(cell);
    }
  }
 else   if (change instanceof mxCollapseChange) {
    Object cell=((mxCollapseChange)change).getCell();
    if (!ignoreDirty) {
      result=getBoundingBox(((mxCollapseChange)change).getCell(),true,true);
    }
    if (invalidate) {
      removeStateForCell(cell);
    }
  }
 else   if (change instanceof mxVisibleChange) {
    Object cell=((mxVisibleChange)change).getCell();
    if (!ignoreDirty) {
      result=getBoundingBox(((mxVisibleChange)change).getCell(),true,true);
    }
    if (invalidate) {
      removeStateForCell(cell);
    }
  }
  return result;
}
