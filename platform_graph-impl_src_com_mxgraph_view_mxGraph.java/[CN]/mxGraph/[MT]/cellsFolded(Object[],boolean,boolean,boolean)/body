{
  if (cells != null && cells.length > 0) {
    model.beginUpdate();
    try {
      for (int i=0; i < cells.length; i++) {
        if ((!checkFoldable || isCellFoldable(cells[i],collapse)) && collapse != isCellCollapsed(cells[i])) {
          model.setCollapsed(cells[i],collapse);
          swapBounds(cells[i],collapse);
          if (isExtendParent(cells[i])) {
            extendParent(cells[i]);
          }
          if (recurse) {
            Object[] children=mxGraphModel.getChildren(model,cells[i]);
            cellsFolded(children,collapse,recurse);
          }
        }
      }
      fireEvent(new mxEventObject(mxEvent.CELLS_FOLDED,"cells",cells,"collapse",collapse,"recurse",recurse));
    }
  finally {
      model.endUpdate();
    }
  }
}
