{
  if (element instanceof Element) {
    String link=getLinkForCell(state.getCell());
    if (link != null) {
      String title=getToolTipForCell(state.getCell());
      Element elem=(Element)element;
      if (elem.getNodeName().startsWith("v:")) {
        elem.setAttribute("href",link.toString());
        if (title != null) {
          elem.setAttribute("title",title);
        }
      }
 else       if (elem.getOwnerDocument().getElementsByTagName("svg").getLength() > 0) {
        Element xlink=elem.getOwnerDocument().createElement("a");
        xlink.setAttribute("xlink:href",link.toString());
        elem.getParentNode().replaceChild(xlink,elem);
        xlink.appendChild(elem);
        if (title != null) {
          xlink.setAttribute("xlink:title",title);
        }
        elem=xlink;
      }
 else {
        Element a=elem.getOwnerDocument().createElement("a");
        a.setAttribute("href",link.toString());
        a.setAttribute("style","text-decoration:none;");
        elem.getParentNode().replaceChild(a,elem);
        a.appendChild(elem);
        if (title != null) {
          a.setAttribute("title",title);
        }
        elem=a;
      }
      String target=getTargetForCell(state.getCell());
      if (target != null) {
        elem.setAttribute("target",target);
      }
    }
  }
}
