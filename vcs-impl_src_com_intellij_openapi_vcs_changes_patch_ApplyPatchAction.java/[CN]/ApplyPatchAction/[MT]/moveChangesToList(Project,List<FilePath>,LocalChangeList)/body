{
  ChangeListManager changeListManager=ChangeListManager.getInstance(project);
  if (targetChangeList != changeListManager.getDefaultChangeList()) {
    changeListManager.ensureUpToDate(false);
    List<Change> changes=new ArrayList<Change>();
    for (    FilePath file : files) {
      final Change change=changeListManager.getChange(file);
      if (change != null) {
        changes.add(change);
      }
    }
    changeListManager.moveChangesTo(targetChangeList,changes.toArray(new Change[changes.size()]));
  }
}
