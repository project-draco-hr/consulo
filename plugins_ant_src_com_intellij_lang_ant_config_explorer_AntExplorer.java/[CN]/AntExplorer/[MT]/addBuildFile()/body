{
  final FileChooserDescriptor descriptor=FileChooserDescriptorFactory.createXmlDescriptor();
  descriptor.setTitle(AntBundle.message("select.ant.build.file.dialog.title"));
  descriptor.setDescription(AntBundle.message("select.ant.build.file.dialog.description"));
  final VirtualFile[] files=FileChooser.chooseFiles(myProject,descriptor);
  if (files.length == 0) {
    return;
  }
  final AntConfiguration antConfiguration=AntConfiguration.getInstance(myProject);
  final ArrayList<VirtualFile> ignoredFiles=new ArrayList<VirtualFile>();
  for (  VirtualFile file : files) {
    try {
      antConfiguration.addBuildFile(file);
    }
 catch (    NoPsiFileException e) {
      ignoredFiles.add(e.getFile());
    }
  }
  if (ignoredFiles.size() != 0) {
    String messageText;
    final StringBuilder message=StringBuilderSpinAllocator.alloc();
    try {
      String separator="";
      for (      final VirtualFile virtualFile : ignoredFiles) {
        message.append(separator);
        message.append(virtualFile.getPresentableUrl());
        separator="\n";
      }
      messageText=message.toString();
    }
  finally {
      StringBuilderSpinAllocator.dispose(message);
    }
    Messages.showWarningDialog(myProject,messageText,AntBundle.message("cannot.add.ant.files.dialog.title"));
  }
}
