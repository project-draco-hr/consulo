{
  List<String> shortNames=new ArrayList<String>();
  for (  String fileName : fileNames) {
    shortNames.add(new File(fileName).getName());
  }
  final String CREATE_MISSING_OPTION="Create Missing Files";
  if (fileNames.size() == 2) {
    shortNames.add(CREATE_MISSING_OPTION);
  }
  final JList list=new JBList(ArrayUtil.toStringArray(shortNames));
  list.setCellRenderer(new ColoredListCellRenderer(){
    @Override protected void customizeCellRenderer(    JList list,    Object value,    int index,    boolean selected,    boolean hasFocus){
      String fileName=(String)value;
      if (!fileName.equals(CREATE_MISSING_OPTION)) {
        final FileType fileType=FileTypeManager.getInstance().getFileTypeByFileName(fileName);
        setIcon(fileType.getIcon());
      }
      append(fileName);
    }
  }
);
  PopupChooserBuilder builder=new PopupChooserBuilder(list);
  builder.setItemChoosenCallback(new Runnable(){
    public void run(){
      final int[] indices=list.getSelectedIndices();
      if (ArrayUtil.indexOf(indices,fileNames.size()) >= 0) {
        createMissingFiles(project,fileNames);
      }
 else {
        for (        int index : indices) {
          openFileByIndex(project,fileNames,index);
        }
      }
    }
  }
).createPopup().show(point);
}
