{
  super(project,true);
  myProject=project;
  myParentClass=parentClass;
  myInitializerExpression=initializerExpression;
  myLocalVariable=localVariable;
  myInvokedOnDeclaration=isInvokedOnDeclaration;
  myOccurrences=occurrences;
  myOccurrencesCount=occurrences.length;
  myTargetClass=targetClass;
  myTypeSelectorManager=typeSelectorManager;
  myDestinationClass=null;
  setTitle(IntroduceConstantHandler.REFACTORING_NAME);
  myCodeStyleManager=JavaCodeStyleManager.getInstance(myProject);
  myVPanel=new VisibilityPanel(false,true);
  myVisibilityPanel.add(myVPanel,BorderLayout.CENTER);
  init();
  myVPanel.setVisibility(JavaRefactoringSettings.getInstance().INTRODUCE_CONSTANT_VISIBILITY);
  myIntroduceEnumConstantCb.setEnabled(EnumConstantsUtil.isSuitableForEnumConstant(getSelectedType(),myTargetClass));
  updateVisibilityPanel();
}
