{
  final BaseListPopupStep step=new BaseListPopupStep(title,new String[]{yesText,noText}){
    public PopupStep onChosen(    Object selectedValue){
      if (selectedValue.equals(yesText)) {
        onYes.run();
      }
 else {
        onNo.run();
      }
      return FINAL_CHOICE;
    }
    public void canceled(){
      onNo.run();
    }
    public boolean isMnemonicsNavigationEnabled(){
      return true;
    }
  }
;
  step.setDefaultOptionIndex(defaultOptionIndex);
  if (!ApplicationManagerEx.getApplicationEx().isUnitTestMode()) {
    return new ListPopupImpl(step);
  }
 else {
    return new MockConfirmation(step,yesText);
  }
}
