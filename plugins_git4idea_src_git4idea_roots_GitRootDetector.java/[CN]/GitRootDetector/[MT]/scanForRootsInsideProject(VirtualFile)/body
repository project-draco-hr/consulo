{
  final Collection<VirtualFile> roots=new ArrayList<VirtualFile>();
  VfsUtil.processFilesRecursively(projectDir,new Processor<VirtualFile>(){
    @Override public boolean process(    VirtualFile virtualFile){
      if (virtualFile.isDirectory() && hasGitDir(virtualFile)) {
        roots.add(virtualFile);
      }
      return true;
    }
  }
);
  return roots;
}
