{
  final AtomicReference<VirtualFile> parent=new AtomicReference<VirtualFile>();
  myPlatformFacade.runReadActionAndWaitIfNeeded(new Runnable(){
    @Override public void run(){
      if (myProject.isDisposed()) {
        return;
      }
      VirtualFile par=projectDir.getParent();
      while (par != null) {
        if (hasGitDir(par)) {
          parent.set(par);
          return;
        }
        par=par.getParent();
      }
    }
  }
);
  return parent.get();
}
