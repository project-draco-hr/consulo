{
  @NonNls StringBuilder buffer=new StringBuilder();
  CodeStyleSettings styleSettings=CodeStyleSettingsManager.getSettings(myProject);
  if (styleSettings.INSERT_OVERRIDE_ANNOTATION && PsiUtil.isLanguageLevel5OrHigher(myClass)) {
    buffer.append("@Override\n");
  }
  buffer.append("public int hashCode() {\n");
  if (!mySuperHasHashCode && myHashCodeFields.length == 1) {
    PsiField field=myHashCodeFields[0];
    final String tempName=addTempForOneField(field,buffer);
    buffer.append("return ");
    if (field.getType() instanceof PsiPrimitiveType) {
      addPrimitiveFieldHashCode(buffer,field,tempName);
    }
 else {
      addFieldHashCode(buffer,field,false);
    }
    buffer.append(";\n}");
  }
 else   if (myHashCodeFields.length > 0) {
    CodeStyleSettings settings=CodeStyleSettingsManager.getSettings(myCodeStyleManager.getProject());
    final String resultName=getUniqueLocalVarName(settings.LOCAL_VARIABLE_NAME_PREFIX + RESULT_VARIABLE,myHashCodeFields);
    buffer.append("int ");
    buffer.append(resultName);
    boolean resultAssigned=false;
    boolean resultDeclarationCompleted=false;
    if (mySuperHasHashCode) {
      buffer.append(" = ");
      addSuperHashCode(buffer);
      buffer.append(";\n");
      resultAssigned=true;
      resultDeclarationCompleted=true;
    }
    String tempName=addTempDeclaration(buffer,resultDeclarationCompleted);
    if (tempName != null) {
      resultDeclarationCompleted=true;
    }
    for (    PsiField field : myHashCodeFields) {
      addTempAssignment(field,buffer,tempName);
      if (resultDeclarationCompleted) {
        buffer.append(resultName);
      }
      buffer.append(" = ");
      if (resultAssigned) {
        buffer.append("31*");
        buffer.append(resultName);
        buffer.append(" + ");
      }
      if (field.getType() instanceof PsiPrimitiveType) {
        addPrimitiveFieldHashCode(buffer,field,tempName);
      }
 else {
        addFieldHashCode(buffer,field,resultAssigned);
      }
      buffer.append(";\n");
      resultAssigned=true;
      resultDeclarationCompleted=true;
    }
    buffer.append("return ");
    buffer.append(resultName);
    buffer.append(";\n}");
  }
 else {
    buffer.append("return 0;\n}");
  }
  PsiMethod hashCode=myFactory.createMethodFromText(buffer.toString(),null);
  return (PsiMethod)myCodeStyleManager.reformat(hashCode);
}
