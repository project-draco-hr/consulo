{
  final AsyncResult<String> result=new AsyncResult<String>();
  final ProjectManager pm=ProjectManager.getInstance();
  final Ref<ProjectManagerListener> listener=new Ref<ProjectManagerListener>();
  listener.set(new ProjectManagerAdapter(){
    @Override public void projectOpened(    final Project project){
      StartupManager.getInstance(project).registerPostStartupActivity(new Runnable(){
        @Override public void run(){
          pm.removeProjectManagerListener(listener.get());
          DumbService.getInstance(project).runWhenSmart(new Runnable(){
            @Override public void run(){
              result.setDone("Opened successfully: " + project.getProjectFilePath());
            }
          }
);
        }
      }
);
    }
  }
);
  pm.addProjectManagerListener(listener.get());
  UIUtil.invokeLaterIfNeeded(new Runnable(){
    @Override public void run(){
      try {
        pm.loadAndOpenProject(path);
      }
 catch (      Exception e) {
        context.error(e.getMessage(),context.getCurrentLine());
        result.setRejected();
      }
    }
  }
);
  return result;
}
