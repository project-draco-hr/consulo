def putfile(self, filename, flags, data):
    if ('l' in flags):
        self.wopener.symlink(data, filename)
    else:
        try:
            if os.path.islink(self.wjoin(filename)):
                os.unlink(filename)
        except OSError:
            pass
        self.wopener(filename, 'w').write(data)
        if self.is_exec:
            was_exec = self.is_exec(self.wjoin(filename))
        else:
            was_exec = ('x' not in flags)
        util.set_flags(self.wjoin(filename), False, ('x' in flags))
        if was_exec:
            if ('x' not in flags):
                self.delexec.append(filename)
        elif ('x' in flags):
            self.setexec.append(filename)
