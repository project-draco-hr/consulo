def _getlog(self, paths, start, end, limit=0, discover_changed_paths=True, strict_node_history=False):
    relpaths = []
    for p in paths:
        if (not p.startswith('/')):
            p = ((self.module + '/') + p)
        relpaths.append(p.strip('/'))
    args = [self.baseurl, relpaths, start, end, limit, discover_changed_paths, strict_node_history]
    arg = encodeargs(args)
    hgexe = util.hgexecutable()
    cmd = ('%s debugsvnlog' % util.shellquote(hgexe))
    (stdin, stdout) = util.popen2(cmd)
    stdin.write(arg)
    try:
        stdin.close()
    except IOError:
        raise util.Abort(_('Mercurial failed to run itself, check hg executable is in PATH'))
    return logstream(stdout)
