{
  String[] pathNameComponents=fileName.split("/");
  VirtualFile fileToPatch=patchedDir;
  int lastComponentToFind=isNewFile() ? pathNameComponents.length - 1 : pathNameComponents.length;
  for (int i=skipTopDirs; i < lastComponentToFind; i++) {
    fileToPatch=fileToPatch.findChild(pathNameComponents[i]);
    if (fileToPatch == null) {
      break;
    }
  }
  return fileToPatch;
}
