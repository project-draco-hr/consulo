{
  if (usedFormNames.contains(formName)) {
    Messages.showErrorDialog(myEditor,"Adding this form is not allowed because it would create a loop of form nesting");
    return false;
  }
  final LwRootContainer rootContainer;
  try {
    rootContainer=new PsiNestedFormLoader(myEditor.getModule()).loadForm(formName);
  }
 catch (  Exception e) {
    Messages.showErrorDialog(myEditor,"Error loading nested form: " + e.getMessage());
    return false;
  }
  final Set<String> thisFormNestedForms=new HashSet<String>();
  final Ref<Boolean> iterateResult=new Ref<Boolean>(Boolean.TRUE);
  FormEditingUtil.iterate(rootContainer,new FormEditingUtil.ComponentVisitor(){
    public boolean visit(    final IComponent component){
      if (component instanceof LwNestedForm) {
        LwNestedForm nestedForm=(LwNestedForm)component;
        if (!thisFormNestedForms.contains(nestedForm.getFormFileName())) {
          thisFormNestedForms.add(nestedForm.getFormFileName());
          if (!validateNestedFormLoop(usedFormNames,nestedForm.getFormFileName())) {
            iterateResult.set(Boolean.FALSE);
            return false;
          }
        }
      }
      return true;
    }
  }
);
  return iterateResult.get().booleanValue();
}
