{
  final ILayoutPullParser parser=new XmlParser();
  parser.setFeature(XmlPullParser.FEATURE_PROCESS_NAMESPACES,true);
  parser.setInput(new StringReader(layoutXmlText));
  final Dimension dimension=getDimension();
  if (dimension == null) {
    return null;
  }
  final VersionQualifier versionQualifier=myConfig.getVersionQualifier();
  if (versionQualifier == null) {
    return null;
  }
  final int targetSdkVersion=versionQualifier.getVersion();
  final int minSdkVersion=myMinSdkVersion >= 0 ? myMinSdkVersion : targetSdkVersion;
  final DensityQualifier densityQualifier=myConfig.getDensityQualifier();
  final Density density=densityQualifier != null ? densityQualifier.getValue() : Density.MEDIUM;
  final float xdpi=Float.isNaN(myXdpi) ? density.getDpiValue() : myXdpi;
  final float ydpi=Float.isNaN(myYdpi) ? density.getDpiValue() : myYdpi;
  final RenderResources resolver=myLayoutLib.getRevision() > 0 ? myResourceResolver : myLegacyResourceResolver;
  final SessionParams params=new SessionParams(parser,RenderingMode.NORMAL,this,dimension.width,dimension.height,density,xdpi,ydpi,resolver,myProjectCallback,minSdkVersion,targetSdkVersion,new SimpleLogger(LOG));
  params.setExtendedViewInfoMode(false);
  params.setAppLabel(appLabel);
  params.setTimeout(timeout);
  final ScreenSizeQualifier screenSizeQualifier=myConfig.getScreenSizeQualifier();
  params.setConfigScreenSize(screenSizeQualifier != null ? screenSizeQualifier.getValue() : ScreenSize.NORMAL);
  return myLayoutLib.createSession(params);
}
