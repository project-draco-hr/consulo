{
  String publicId=xmlResourceIdentifier.getLiteralSystemId() != null ? xmlResourceIdentifier.getLiteralSystemId() : xmlResourceIdentifier.getNamespace();
  PsiFile psiFile=resolve(xmlResourceIdentifier.getBaseSystemId(),publicId);
  if (psiFile == null && xmlResourceIdentifier.getBaseSystemId() != null) {
    psiFile=ExternalResourceManager.getInstance().getResourceLocation(xmlResourceIdentifier.getBaseSystemId(),myFile,null);
  }
  if (psiFile == null && xmlResourceIdentifier.getLiteralSystemId() != null && xmlResourceIdentifier.getNamespace() != null) {
    psiFile=resolve(xmlResourceIdentifier.getBaseSystemId(),publicId=xmlResourceIdentifier.getNamespace());
  }
  if (psiFile == null)   return null;
  XMLInputSource source=new XMLInputSource(xmlResourceIdentifier);
  source.setPublicId(publicId);
  source.setCharacterStream(new StringReader(psiFile.getText()));
  return source;
}
