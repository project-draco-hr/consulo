{
  Pattern result=typeNamePattern.getUserData(REGEXP_IN_TYPE_NAME_PATTERN);
  if (result == null) {
    StringBuffer regexp;
    PsiTypeNamePatternElement[] namePatternElements=typeNamePattern.getNamePatternElements();
    regexp=new StringBuffer();
    boolean doubleDot=false;
    for (int i=0; i < namePatternElements.length; i++) {
      if (i > 0 && !doubleDot) {
        regexp.append("\\.");
      }
      PsiTypeNamePatternElement typePatternElement=namePatternElements[i];
      PsiIdPattern pattern=typePatternElement.getPattern();
      if (pattern != null) {
        convertToRegexp(pattern,regexp);
        doubleDot=false;
      }
 else {
        regexp.append("(.*\\.)?");
        doubleDot=true;
      }
    }
    result=Pattern.compile(regexp.toString());
    typeNamePattern.putUserData(REGEXP_IN_TYPE_NAME_PATTERN,result);
  }
  return result;
}
