{
  PsiExpression[] args=argList == null ? PsiExpression.EMPTY_ARRAY : argList.getExpressions();
  final PsiParameter[] parms=method.getParameterList().getParameters();
  if (!method.isVarArgs()) {
    if (args == null || args.length != parms.length) {
      return false;
    }
    for (int i=0; i < args.length; i++) {
      final PsiExpression arg=args[i];
      final PsiType type=arg.getType();
      if (type == null)       return false;
      final PsiType parmType=parms[i].getType();
      final PsiType substitutedParmType=substitutorForMethod.substituteAndCapture(parmType);
      if (!TypeConversionUtil.isAssignable(substitutedParmType,type)) {
        return false;
      }
    }
  }
 else {
    if (args == null || args.length < parms.length - 1) {
      return false;
    }
    PsiParameter lastParameter=parms[parms.length - 1];
    PsiType lastParmType=lastParameter.getType();
    if (!(lastParmType instanceof PsiArrayType))     return false;
    lastParmType=substitutorForMethod.substituteAndCapture(lastParmType);
    if (lastParameter.isVarArgs()) {
      for (int i=0; i < parms.length - 1; i++) {
        PsiParameter parm=parms[i];
        if (parm.isVarArgs())         return false;
        final PsiExpression arg=args[i];
        final PsiType argType=arg.getType();
        if (argType == null)         return false;
        final PsiType parmType=parms[i].getType();
        final PsiType substitutedParmType=substitutorForMethod.substituteAndCapture(parmType);
        if (!TypeConversionUtil.isAssignable(substitutedParmType,argType)) {
          return false;
        }
      }
      if (args.length == parms.length) {
        PsiType lastArgType=args[args.length - 1].getType();
        if (lastArgType != null && TypeConversionUtil.isAssignable(lastParmType,lastArgType))         return true;
      }
      lastParmType=((PsiArrayType)lastParmType).getComponentType();
      for (int i=parms.length - 1; i < args.length; i++) {
        PsiType argType=args[i].getType();
        if (argType == null || !TypeConversionUtil.isAssignable(lastParmType,argType)) {
          return false;
        }
      }
    }
 else {
      return false;
    }
  }
  return true;
}
