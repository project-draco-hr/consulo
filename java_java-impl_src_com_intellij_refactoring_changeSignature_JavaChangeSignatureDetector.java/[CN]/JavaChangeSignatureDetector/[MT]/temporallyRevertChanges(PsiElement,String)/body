{
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    @Override public void run(){
      final PsiFile file=psiElement.getContainingFile();
      final PsiDocumentManager documentManager=PsiDocumentManager.getInstance(psiElement.getProject());
      final Document document=documentManager.getDocument(file);
      if (document != null) {
        final TextRange textRange=psiElement.getTextRange();
        document.replaceString(textRange.getStartOffset(),textRange.getEndOffset(),oldText);
        documentManager.commitDocument(document);
      }
    }
  }
);
}
