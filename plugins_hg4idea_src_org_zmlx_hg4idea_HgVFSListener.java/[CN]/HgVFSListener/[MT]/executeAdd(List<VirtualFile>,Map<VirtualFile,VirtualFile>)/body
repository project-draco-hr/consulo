{
  for (Iterator<Map.Entry<VirtualFile,VirtualFile>> it=copyFromMap.entrySet().iterator(); it.hasNext(); ) {
    final Map.Entry<VirtualFile,VirtualFile> entry=it.next();
    final VirtualFile rootFrom=HgUtil.getHgRootOrNull(myProject,entry.getKey());
    final VirtualFile rootTo=HgUtil.getHgRootOrNull(myProject,entry.getValue());
    if (rootTo == null || !rootTo.equals(rootFrom)) {
      it.remove();
    }
  }
  for (Iterator<VirtualFile> it=addedFiles.iterator(); it.hasNext(); ) {
    if (HgUtil.getHgRootOrNull(myProject,it.next()) == null) {
      it.remove();
    }
  }
  if (!addedFiles.isEmpty() || !copyFromMap.isEmpty()) {
    super.executeAdd(addedFiles,copyFromMap);
  }
}
