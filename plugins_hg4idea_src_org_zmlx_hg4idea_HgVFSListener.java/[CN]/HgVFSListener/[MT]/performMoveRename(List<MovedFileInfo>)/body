{
  (new VcsBackgroundTask<MovedFileInfo>(myProject,HgVcsMessages.message("hg4idea.move.progress"),VcsConfiguration.getInstance(myProject).getAddRemoveOption(),movedFiles){
    protected void process(    final MovedFileInfo file) throws VcsException {
      final FilePath source=VcsUtil.getFilePath(file.myOldPath);
      final FilePath target=VcsUtil.getFilePath(file.myNewPath);
      (new HgMoveCommand(myProject)).execute(new HgFile(VcsUtil.getVcsRootFor(myProject,source),source),new HgFile(VcsUtil.getVcsRootFor(myProject,target),target));
      dirtyScopeManager.fileDirty(source);
      dirtyScopeManager.fileDirty(target);
    }
  }
).queue();
}
