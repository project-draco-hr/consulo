{
  flushCurrentCommand();
  UndoRedo undoRedo;
  while ((undoRedo=createUndoOrRedo(editor,true)) != null) {
    if (!undoRedo.isTransparent())     break;
    undoRedo.execute(true);
    if (!undoRedo.hasMoreActions())     break;
  }
  while ((undoRedo=createUndoOrRedo(editor,isUndo)) != null) {
    undoRedo.execute(false);
    boolean shouldRepeat=undoRedo.isTransparent() && undoRedo.hasMoreActions();
    if (!shouldRepeat)     break;
  }
}
