{
  flushCurrentCommand();
  UndoRedo undoRedo;
  while ((undoRedo=createUndoOrRedo(editor,true)) != null) {
    if (!undoRedo.isTransparent())     break;
    if (!undoRedo.execute(true))     return;
    if (!undoRedo.hasMoreActions())     break;
  }
  while ((undoRedo=createUndoOrRedo(editor,isUndo)) != null) {
    if (!undoRedo.execute(false))     return;
    if (isUndo ? undoRedo.isMerged4Undo() : undoRedo.isMerged4Redo())     continue;
    boolean shouldRepeat=undoRedo.isTransparent() && undoRedo.hasMoreActions();
    if (!shouldRepeat)     break;
  }
}
