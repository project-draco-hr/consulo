{
  flushCurrentCommand();
  UndoRedo undoRedo;
  while ((undoRedo=createUndoOrRedo(editor,true)) != null) {
    if (!undoRedo.isTransparent())     break;
    if (!undoRedo.execute(true,false))     return;
    if (!undoRedo.hasMoreActions())     break;
  }
  boolean isInsideStartFinishGroup=false;
  while ((undoRedo=createUndoOrRedo(editor,isUndo)) != null) {
    if (!undoRedo.execute(false,isInsideStartFinishGroup))     return;
    isInsideStartFinishGroup=undoRedo.myUndoableGroup.isInsideStartFinishGroup(isUndo,isInsideStartFinishGroup);
    if (isInsideStartFinishGroup)     continue;
    boolean shouldRepeat=undoRedo.isTransparent() && undoRedo.hasMoreActions();
    if (!shouldRepeat)     break;
  }
}
