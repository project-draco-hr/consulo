{
  if (hasActions()) {
    if (!myAdditionalAffectedDocuments.isEmpty()) {
      DocumentReference[] refs=myAdditionalAffectedDocuments.toArray(new DocumentReference[myAdditionalAffectedDocuments.size()]);
      myCurrentActions.add(new BasicUndoableAction(refs){
        @Override public void undo(){
        }
        @Override public void redo(){
        }
      }
);
    }
    myManager.getUndoStacksHolder().addToStacks(new UndoableGroup(myCommandName,isGlobal(),myManager,myStateBefore,myStateAfter,myCurrentActions,myUndoConfirmationPolicy,isTransparent(),myValid));
  }
  reset();
}
