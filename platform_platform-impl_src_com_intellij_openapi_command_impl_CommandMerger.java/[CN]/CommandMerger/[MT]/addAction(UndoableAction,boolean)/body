{
  if (!isUndoTransparent)   myHasUndoTransparentsOnly=false;
  if (isUndoTransparent)   myHasUndoTransparents=true;
  myCurrentActions.add(action);
  DocumentReference[] refs=action.getAffectedDocuments();
  if (refs != null) {
    Collections.addAll(myAffectedDocuments,refs);
  }
  myGlobal|=action.isGlobal() || !isUndoTransparent && affectsMultiplePhysicalDocs();
}
