{
  if (!file.isWritable())   return false;
  PsiElement element=file.findElementAt(editor.getCaretModel().getOffset());
  if (element instanceof PsiIdentifier && element.getParent() instanceof PsiReferenceExpression && ((PsiReferenceExpression)element.getParent()).getQualifierExpression() != null) {
    PsiReferenceExpression refExpr=(PsiReferenceExpression)element.getParent();
    PsiElement resolved=refExpr.resolve();
    if (resolved instanceof PsiMember && ((PsiModifierListOwner)resolved).hasModifierProperty(PsiModifier.STATIC)) {
      PsiClass aClass=((PsiMember)resolved).getContainingClass();
      if (aClass != null && !PsiTreeUtil.isAncestor(aClass,element,true)) {
        String qName=aClass.getQualifiedName();
        if (qName != null) {
          qName=qName + "." + refExpr.getReferenceName();
          if (file instanceof PsiJavaFile) {
            if (((PsiJavaFile)file).getImportList().findSingleImportStatement(refExpr.getReferenceName()) == null) {
              String text=MessageFormat.format("Add static import for ''{0}''",new Object[]{qName});
              setText(text);
              return true;
            }
          }
        }
      }
    }
  }
  return false;
}
