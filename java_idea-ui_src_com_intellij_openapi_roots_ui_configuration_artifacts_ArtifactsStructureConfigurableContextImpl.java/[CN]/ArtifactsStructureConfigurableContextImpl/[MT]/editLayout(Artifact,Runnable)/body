{
  final Artifact originalArtifact=getOriginalArtifact(artifact);
  new WriteAction(){
    protected void run(    final Result result){
      final ModifiableArtifact modifiableArtifact=getOrCreateModifiableArtifactModel().getOrCreateModifiableArtifact(originalArtifact);
      if (modifiableArtifact.getRootElement() == originalArtifact.getRootElement()) {
        modifiableArtifact.setRootElement(getOrCreateModifiableRootElement(originalArtifact));
      }
      action.run();
    }
  }
.execute();
  myContext.getDaemonAnalyzer().queueUpdate(getOrCreateArtifactElement(originalArtifact));
}
