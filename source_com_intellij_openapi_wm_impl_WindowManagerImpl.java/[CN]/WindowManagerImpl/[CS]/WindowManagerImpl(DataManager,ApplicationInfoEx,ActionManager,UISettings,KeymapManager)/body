{
  myApplicationInfoEx=applicationInfoEx;
  myDataManager=dataManager;
  myActionManager=actionManager;
  myUiSettings=uiSettings;
  myKeymapManager=keymapManager;
  if (myDataManager instanceof DataManagerImpl) {
    ((DataManagerImpl)myDataManager).setWindowManager(this);
  }
  myCommandProcessor=new CommandProcessor();
  myWindowWatcher=new WindowWatcher();
  final KeyboardFocusManager keyboardFocusManager=KeyboardFocusManager.getCurrentKeyboardFocusManager();
  keyboardFocusManager.addPropertyChangeListener("focusedWindow",myWindowWatcher);
  if (Patches.SUN_BUG_ID_4218084) {
    keyboardFocusManager.addPropertyChangeListener("focusedWindow",new SUN_BUG_ID_4218084_Patch());
  }
  myLayout=new DesktopLayout();
  myProject2Frame=new HashMap<Project,IdeFrame>();
  myDialogsToDispose=new HashMap<Project,Set<JDialog>>();
  myFrameExtendedState=Frame.NORMAL;
  myScreenBounds=new Rectangle();
  final GraphicsEnvironment env=GraphicsEnvironment.getLocalGraphicsEnvironment();
  final GraphicsDevice[] devices=env.getScreenDevices();
  for (int i=0; i < devices.length; i++) {
    final GraphicsDevice device=devices[i];
    myScreenBounds=myScreenBounds.union(device.getDefaultConfiguration().getBounds());
  }
  myActivationListener=new WindowAdapter(){
    public void windowActivated(    WindowEvent e){
      Window activeWindow=e.getWindow();
      if (activeWindow instanceof IdeFrame) {
        proceedDialogDisposalQueue(((IdeFrame)activeWindow).getProject());
      }
    }
  }
;
}
