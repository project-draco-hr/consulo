{
  if (Patches.MAC_AQUA_TABS_HACK && myTabbedPane != null && myTabbedPane.getTabCount() == 0)   return;
  if (MouseEvent.MOUSE_PRESSED == e.getID()) {
    final MenuSelectionManager menuSelectionManager=MenuSelectionManager.defaultManager();
    menuSelectionManager.clearSelectedPath();
    myWindow.setAsCurrentWindow(true);
  }
  if (e.isPopupTrigger()) {
    myTabbedPanePopupHandler.invokePopup(e.getComponent(),e.getX(),e.getY());
    return;
  }
  if (!e.isShiftDown() && (MouseEvent.BUTTON1_MASK & e.getModifiers()) > 0) {
    if (MouseEvent.MOUSE_PRESSED == e.getID()) {
      myLastClickedIndex=getTabIndexAt(e.getX(),e.getY());
    }
    if (MouseEvent.MOUSE_RELEASED == e.getID()) {
      if (myLastClickedIndex != -1) {
        if (e.getClickCount() == 1) {
          if (myLastClickedIndex >= 0 && myLastClickedIndex < getTabCount()) {
            setSelectedIndex(myLastClickedIndex);
          }
          myLastClickedIndex=-1;
        }
 else         if (e.getClickCount() == 2) {
          HideAllToolWindowsAction.performAction(myProject);
        }
 else {
          super.processMouseEvent(e);
        }
      }
 else {
        super.processMouseEvent(e);
      }
    }
 else {
      if (myLastClickedIndex == -1) {
        boolean shouldProcess=true;
        if (Patches.MAC_AQUA_TABS_HACK) {
          shouldProcess=myTabbedPane != null && myTabbedPane.getTabCount() > 0;
        }
        if (e.getID() == MouseEvent.MOUSE_ENTERED && getToolTipText(e) == null) {
          shouldProcess=false;
        }
        if (shouldProcess) {
          super.processMouseEvent(e);
        }
      }
    }
  }
 else   if (e.isShiftDown() && (MouseEvent.BUTTON1_MASK & e.getModifiers()) > 0) {
    if (MouseEvent.MOUSE_RELEASED == e.getID()) {
      final VirtualFile file=getFileAt(e.getX(),e.getY());
      if (file != null) {
        FileEditorManagerEx.getInstanceEx(myProject).closeFile(file,myWindow);
      }
    }
  }
 else   if ((MouseEvent.BUTTON2_MASK & e.getModifiers()) > 0) {
    if (MouseEvent.MOUSE_RELEASED == e.getID()) {
      final VirtualFile file=getFileAt(e.getX(),e.getY());
      if (file != null) {
        FileEditorManagerEx.getInstanceEx(myProject).closeFile(file,myWindow);
      }
    }
  }
 else   if ((MouseEvent.BUTTON3_MASK & e.getModifiers()) > 0 && SystemInfo.isWindows) {
  }
 else {
    super.processMouseEvent(e);
  }
}
