{
  if (commitParentses.size() == 0) {
    throw new IllegalArgumentException("Empty list commitParentses");
  }
  if (isSimpleEndOfGraph()) {
    int startIndex=getLastRowInGraph().getRowIndex() + 1;
    simpleAppend(commitParentses,new MutableNodeRow(graph,startIndex),new HashMap<Hash,MutableNode>());
  }
 else {
    Map<Hash,MutableNode> underdoneNodes=fixUnderdoneNodes(commitParentses.get(0).getHash());
    MutableNodeRow lastRow=getLastRowInGraph();
    graph.getAllRows().remove(graph.getAllRows().size() - 1);
    simpleAppend(commitParentses,lastRow,underdoneNodes);
  }
}
