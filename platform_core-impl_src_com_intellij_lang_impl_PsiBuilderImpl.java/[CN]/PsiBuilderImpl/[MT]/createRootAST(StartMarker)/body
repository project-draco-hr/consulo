{
  final IElementType type=rootMarker.getTokenType();
  @SuppressWarnings("NullableProblems") final TreeElement rootNode=type instanceof ILazyParseableElementType ? ASTFactory.lazy((ILazyParseableElementType)type,null) : createComposite(rootMarker);
  if (myCharTable == null) {
    myCharTable=rootNode instanceof FileElement ? ((FileElement)rootNode).getCharTable() : new CharTableImpl();
  }
  if (!(rootNode instanceof FileElement)) {
    rootNode.putUserData(CharTable.CHAR_TABLE_KEY,myCharTable);
  }
  return rootNode;
}
