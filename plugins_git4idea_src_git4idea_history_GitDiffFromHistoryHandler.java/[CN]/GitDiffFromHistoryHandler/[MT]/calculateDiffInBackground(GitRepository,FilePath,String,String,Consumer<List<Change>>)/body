{
  new Task.Backgroundable(myProject,"Comparing revisions..."){
    private List<Change> myChanges;
    @Override public void run(    @NotNull ProgressIndicator indicator){
      try {
        if (hash1 != null) {
          myChanges=new ArrayList<Change>(GitChangeUtils.getDiff(repository.getProject(),repository.getRoot(),hash1,hash2,Collections.singletonList(path)));
        }
 else {
          myChanges=new ArrayList<Change>(GitChangeUtils.getRevisionChanges(repository.getProject(),repository.getRoot(),hash2,false,true).getChanges());
        }
      }
 catch (      VcsException e) {
        showError(e,"Error during requesting diff for directory");
      }
    }
    @Override public void onSuccess(){
      successHandler.consume(myChanges);
    }
  }
.queue();
}
