{
  if (ApplicationManager.getApplication().isUnitTestMode() || ApplicationManager.getApplication().isDispatchThread()) {
    String ipr=ProjectFileType.DOT_DEFAULT_EXTENSION;
    if (filePath.endsWith(ipr)) {
      VirtualFile projectFile=LocalFileSystem.getInstance().refreshAndFindFileByPath(filePath);
      if (projectFile != null) {
        projectFile.refresh(false,false);
      }
      String iwsPath=filePath.substring(0,filePath.length() - ipr.length()) + WorkspaceFileType.DOT_DEFAULT_EXTENSION;
      VirtualFile wsFile=LocalFileSystem.getInstance().refreshAndFindFileByPath(iwsPath);
      if (wsFile != null) {
        wsFile.refresh(false,false);
      }
    }
 else {
      VirtualFile projectConfigDir=LocalFileSystem.getInstance().refreshAndFindFileByIoFile(new File(filePath,Project.DIRECTORY_STORE_FOLDER));
      if (projectConfigDir != null && projectConfigDir.isDirectory()) {
        projectConfigDir.getChildren();
        if (projectConfigDir instanceof NewVirtualFile) {
          ((NewVirtualFile)projectConfigDir).markDirtyRecursively();
        }
        projectConfigDir.refresh(false,true);
      }
    }
  }
}
