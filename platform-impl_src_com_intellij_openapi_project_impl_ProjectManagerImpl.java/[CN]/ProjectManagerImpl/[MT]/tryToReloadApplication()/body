{
  try {
    final Application app=ApplicationManager.getApplication();
    if (app.isDisposed())     return;
    final HashSet<Pair<VirtualFile,StateStorage>> causes=new HashSet<Pair<VirtualFile,StateStorage>>(myChangedApplicationFiles);
    final boolean[] reloadOk=new boolean[]{false};
    ApplicationManager.getApplication().runWriteAction(new Runnable(){
      public void run(){
        try {
          reloadOk[0]=((ApplicationImpl)app).getStateStore().reload(causes);
        }
 catch (        StateStorage.StateStorageException e) {
          Messages.showWarningDialog(ProjectBundle.message("project.reload.failed",e.getMessage()),ProjectBundle.message("project.reload.failed.title"));
        }
catch (        IOException e) {
          Messages.showWarningDialog(ProjectBundle.message("project.reload.failed",e.getMessage()),ProjectBundle.message("project.reload.failed.title"));
        }
      }
    }
);
  }
  finally {
    myChangedApplicationFiles.clear();
  }
}
