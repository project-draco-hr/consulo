{
  if (isDummy) {
    throw new UnsupportedOperationException("Dummy project is deprecated and shall not be used anymore.");
  }
  final ProjectImpl project=new ProjectImpl(this,filePath,isDefault,isOptimiseTestLoadSpeed,projectName);
  if (additionalPicoContainerComponents != null) {
    project.getPicoContainer().registerComponentInstance(additionalPicoContainerComponents.first,additionalPicoContainerComponents.second);
  }
  ApplicationManager.getApplication().getMessageBus().syncPublisher(ProjectLifecycleListener.TOPIC).beforeProjectLoaded(project);
  try {
    if (template != null) {
      project.getStateStore().loadProjectFromTemplate((ProjectImpl)template);
    }
 else {
      project.getStateStore().load();
    }
  }
 catch (  IOException e) {
    Disposer.dispose(project);
    throw e;
  }
catch (  final StateStorage.StateStorageException e) {
    Disposer.dispose(project);
    throw e;
  }
  project.loadProjectComponents();
  project.init();
  if (projectName != null) {
    ProjectDetailsComponent.getInstance(project).setProjectName(projectName);
  }
  return project;
}
