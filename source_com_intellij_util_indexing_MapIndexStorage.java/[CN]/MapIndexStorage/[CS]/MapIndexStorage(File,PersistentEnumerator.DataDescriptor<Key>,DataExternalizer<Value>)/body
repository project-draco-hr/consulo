{
  myMap=new PersistentHashMap<Key,ValueContainerImpl<Value>>(storageFile,keyDescriptor,new ValueContainerExternalizer<Value>(valueExternalizer));
  myCache=new ObjectCache<Key,ValueContainerImpl<Value>>(1024);
  myCache.addDeletedPairsListener(new ObjectCache.DeletedPairsListener(){
    public void objectRemoved(    final Object key,    final Object value){
      final Key _key=(Key)key;
      if (myCache.isCached(_key) || _key.equals(myKeyBeingRemoved)) {
        return;
      }
      if (myFlushedKeys != null) {
        if (myFlushedKeys.contains(_key)) {
          return;
        }
        myFlushedKeys.add(_key);
      }
      try {
        myMap.put(_key,(ValueContainerImpl<Value>)value);
      }
 catch (      IOException e) {
        LOG.error(e);
      }
    }
  }
);
}
