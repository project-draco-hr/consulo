{
  try {
    final int next=myRecords.getInt(HEADER_FREE_RECORD_OFFSET);
    if (next == 0) {
      final int filelength=(int)myRecords.length();
      LOG.assertTrue(filelength % RECORD_SIZE == 0);
      int result=filelength / RECORD_SIZE;
      cleanRecord(result);
      return result;
    }
 else {
      myRecords.putInt(HEADER_FREE_RECORD_OFFSET,getNextFree(next));
      setNextFree(next,0);
      return next;
    }
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
}
