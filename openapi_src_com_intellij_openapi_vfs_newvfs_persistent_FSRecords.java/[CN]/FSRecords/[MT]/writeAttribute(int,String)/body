{
  try {
    incModCount(id);
    int encodedAttId=getAttributeId(attId);
    final int headPage=myRecords.getInt(id * RECORD_SIZE + ATTREF_OFFSET);
    int att_page=headPage;
    while (att_page != 0) {
      int curPage=att_page;
      final RandomAccessPagedDataInput page=myAttributes.getReader(att_page);
      final int attIdOnPage=page.readInt();
      final int next=page.readInt();
      if (attIdOnPage == encodedAttId) {
        page.close();
        final RecordDataOutput result=myAttributes.getWriter(curPage);
        result.writeInt(encodedAttId);
        result.writeInt(next);
        return result;
      }
      att_page=page.readInt();
      page.close();
    }
    final RecordDataOutput result=myAttributes.createRecord();
    myRecords.putInt(id * RECORD_SIZE + ATTREF_OFFSET,result.getRecordId());
    result.writeInt(encodedAttId);
    result.writeInt(headPage);
    return result;
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
}
