{
  myProject=project;
  myAntProject=new AntProject(BuildProperties.getProjectBuildFileName(myProject),BuildProperties.DEFAULT_TARGET);
  myAntProject.add(new BuildPropertiesImpl(myProject,genOptions),1);
  final StringBuilder alltargetNames=new StringBuilder();
  alltargetNames.append(BuildProperties.TARGET_INIT);
  alltargetNames.append(", ");
  alltargetNames.append(BuildProperties.TARGET_CLEAN);
  final ModuleChunk[] chunks=genOptions.getModuleChunks();
  if (chunks.length > 0) {
    myAntProject.add(new Comment(CompilerBundle.message("generated.ant.build.modules.section.title")),1);
    for (    final ModuleChunk chunk : chunks) {
      myAntProject.add(createModuleBuildGenerator(chunk,genOptions),1);
      final String[] targets=ChunkBuildExtension.getAllTargets(chunk);
      for (      String target : targets) {
        if (alltargetNames.length() > 0) {
          alltargetNames.append(", ");
        }
        alltargetNames.append(target);
      }
    }
  }
  final Target initTarget=new Target(BuildProperties.TARGET_INIT,null,CompilerBundle.message("generated.ant.build.initialization.section.title"),null);
  initTarget.add(new Comment(CompilerBundle.message("generated.ant.build.initialization.section.comment")));
  myAntProject.add(initTarget,1);
  ArtifactsGenerator artifactsGenerator;
  if (ApplicationManagerEx.getApplicationEx().isInternal()) {
    artifactsGenerator=new ArtifactsGenerator(project,genOptions);
  }
 else {
    artifactsGenerator=null;
  }
  myAntProject.add(new CleanProject(genOptions,artifactsGenerator),1);
  if (artifactsGenerator != null) {
    List<Generator> generators=artifactsGenerator.generate();
    for (    Generator generator : generators) {
      myAntProject.add(generator,1);
    }
    if (alltargetNames.length() > 0) {
      alltargetNames.append(", ");
    }
    alltargetNames.append(ArtifactsGenerator.BUILD_ALL_ARTIFACTS_TARGET);
  }
  myAntProject.add(new Target(BuildProperties.TARGET_ALL,alltargetNames.toString(),CompilerBundle.message("generated.ant.build.build.all.target.name"),null),1);
}
