{
  double energy=0.0;
  if (isOptimizeEdgeDistance && isFineTuning) {
    for (int j=0; j < v.length; j++) {
      if (e[i].source != j && e[i].target != j) {
        double distSquare=Line2D.ptSegDistSq(v[e[i].source].x,v[e[i].source].y,v[e[i].target].x,v[e[i].target].y,v[j].x,v[j].y);
        distSquare-=v[j].radiusSquared;
        if (distSquare < minDistanceLimitSquared)         distSquare=minDistanceLimitSquared;
        if (distSquare < maxDistanceLimitSquared) {
          energy+=edgeDistanceCostFactor / distSquare;
        }
      }
    }
  }
  return energy;
}
