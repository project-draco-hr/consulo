{
  double energy=0.0;
  if (isOptimizeEdgeDistance && isFineTuning) {
    int[] edges=v[i].relevantEdges;
    for (int j=0; j < edges.length; j++) {
      double distSquare=Line2D.ptSegDistSq(v[e[edges[j]].source].x,v[e[edges[j]].source].y,v[e[edges[j]].target].x,v[e[edges[j]].target].y,v[i].x,v[i].y);
      distSquare-=v[i].radiusSquared;
      if (distSquare < minDistanceLimitSquared) {
        distSquare=minDistanceLimitSquared;
      }
      if (distSquare < maxDistanceLimitSquared) {
        energy+=edgeDistanceCostFactor / distSquare;
      }
    }
  }
  return energy;
}
