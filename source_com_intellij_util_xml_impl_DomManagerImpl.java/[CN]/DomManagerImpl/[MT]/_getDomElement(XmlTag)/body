{
  if (tag == null)   return null;
  DomInvocationHandler invocationHandler=getCachedElement(tag);
  if (invocationHandler != null && invocationHandler.isValid()) {
    return invocationHandler;
  }
  final XmlTag parentTag=tag.getParentTag();
  if (parentTag == null) {
    final XmlFile xmlFile=(XmlFile)tag.getContainingFile();
    if (xmlFile != null) {
      final DomFileElementImpl element=getCachedElement(xmlFile);
      if (element != null) {
        return element.getRootHandler();
      }
    }
    return null;
  }
  DomInvocationHandler parent=_getDomElement(parentTag);
  if (parent == null)   return null;
  final GenericInfoImpl info=parent.getGenericInfo();
  final String tagName=tag.getName();
  final DomChildrenDescription childDescription;
  if (info.isCollectionChild(tagName)) {
    childDescription=info.getCollectionChildDescription(tagName);
  }
 else {
    childDescription=info.getFixedChildDescription(tagName);
  }
  if (childDescription == null)   return null;
  childDescription.getValues(parent.getProxy());
  return getCachedElement(tag);
}
