{
  Matcher matcher=MACRO_PATTERN.matcher(file);
  while (matcher.find()) {
    String m=matcher.group(1);
    if (!myMacros.containsKey(m)) {
      throw new IllegalArgumentException("Unknown macro: " + m + " in storage file spec: "+ file);
    }
  }
  String expanded=file;
  for (  String macro : myMacros.keySet()) {
    expanded=StringUtil.replace(expanded,macro,myMacros.get(macro));
  }
  return expanded;
}
