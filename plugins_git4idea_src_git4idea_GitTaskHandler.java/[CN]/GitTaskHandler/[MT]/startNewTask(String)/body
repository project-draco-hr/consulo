{
  List<GitRepository> repositories=myRepositoryManager.getRepositories();
  List<GitRepository> problems=ContainerUtil.filter(repositories,new Condition<GitRepository>(){
    @Override public boolean value(    GitRepository repository){
      return repository.getBranches().findLocalBranch(taskName) != null;
    }
  }
);
  MultiMap<String,String> map=new MultiMap<String,String>();
  if (!problems.isEmpty()) {
    if (ApplicationManager.getApplication().isUnitTestMode() || Messages.showDialog(myProject,"<html>The following repositories already have specified branch <b>" + taskName + "</b>:<br>"+ StringUtil.join(problems,"<br>")+ ".<br>"+ "Do you want to checkout existing branch?","Branch Already Exists",new String[]{Messages.YES_BUTTON,Messages.NO_BUTTON},0,Messages.getWarningIcon(),new DialogWrapper.PropertyDoNotAskOption("git.checkout.existing.branch")) == 0) {
      myBrancher.checkout(taskName,problems,null);
      fillMap(taskName,problems,map);
    }
  }
  repositories.removeAll(problems);
  if (!repositories.isEmpty()) {
    myBrancher.checkoutNewBranch(taskName,repositories);
  }
  fillMap(taskName,repositories,map);
  return new TaskInfo(map);
}
