{
  super(new BorderLayout());
  myProject=project;
  myChangeLists=changeLists;
  myChangesTree=new Tree(buildTreeModel()){
    @Override public boolean getScrollableTracksViewportWidth(){
      return true;
    }
    protected void paintComponent(    final Graphics g){
      super.paintComponent(g);
      Graphics2D g2d=(Graphics2D)g;
      final TreeModel model=getModel();
      if (model.getChildCount(model.getRoot()) == 0 && myEmptyText.length() > 0) {
        final Rectangle bounds=getBounds();
        final Rectangle2D stringBounds=g.getFont().getStringBounds(myEmptyText,g2d.getFontRenderContext());
        int x=((bounds.width - (int)stringBounds.getWidth())) / 2;
        g.drawString(myEmptyText,bounds.x + x,bounds.y + 20);
      }
    }
  }
;
  myChangesTree.setRootVisible(false);
  myChangesTree.setShowsRootHandles(true);
  myChangesTree.setCellRenderer(new CommittedChangeListRenderer(project));
  TreeUtil.expandAll(myChangesTree);
  myChangesView=new RepositoryChangesBrowser(project,changeLists);
  myChangesView.getListPanel().setBorder(null);
  myChangesTree.getSelectionModel().addTreeSelectionListener(new TreeSelectionListener(){
    public void valueChanged(    TreeSelectionEvent e){
      updateBySelectionChange();
    }
  }
);
  final TreeLinkMouseListener linkMouseListener=new TreeLinkMouseListener(new CommittedChangeListRenderer(project)){
    @Override protected void handleTagClick(    final Object tag){
      if (tag == MORE_TAG) {
        ChangeListDetailsAction.showDetailsPopup(project,(CommittedChangeList)myLastHitNode.getUserObject());
      }
 else {
        super.handleTagClick(tag);
      }
    }
  }
;
  linkMouseListener.install(myChangesTree);
  myLeftPanel=new JPanel(new BorderLayout());
  myFilterSplitter=new Splitter(false,0.5f);
  myFilterSplitter.setSecondComponent(new JScrollPane(myChangesTree));
  myLeftPanel.add(myFilterSplitter,BorderLayout.CENTER);
  final Splitter splitter=new Splitter(false,0.7f);
  splitter.setFirstComponent(myLeftPanel);
  splitter.setSecondComponent(myChangesView);
  add(splitter,BorderLayout.CENTER);
  mySplitterProportionsData.externalizeFromDimensionService("CommittedChanges.SplitterProportions");
  mySplitterProportionsData.restoreSplitterProportions(this);
  updateBySelectionChange();
  ActionManager.getInstance().getAction("CommittedChanges.Details").registerCustomShortcutSet(new CustomShortcutSet(KeymapManager.getInstance().getActiveKeymap().getShortcuts(IdeActions.ACTION_QUICK_JAVADOC)),this);
  myCopyProvider=new TreeCopyProvider(myChangesTree);
}
