{
  PsiElement[] elements=getValidSelectedElements();
  if (elements == null) {
    return;
  }
  for (int i=0; i < elements.length; i++) {
    PsiElement element=elements[i];
    if (!element.isWritable()) {
      RefactoringMessageUtil.showReadOnlyElementRefactoringMessage(myProject,element);
      return;
    }
  }
  ((CopyPasteManagerEx)CopyPasteManager.getInstance()).setElements(elements,false);
  updateView();
}
