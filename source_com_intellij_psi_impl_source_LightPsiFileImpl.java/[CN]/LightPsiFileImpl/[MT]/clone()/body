{
  final FileViewProvider provider=getViewProvider().clone();
  final LightPsiFileImpl clone=(LightPsiFileImpl)provider.getPsi(getLanguage());
  final Map<Key,Object> copyableMap=getUserData(COPYABLE_USER_MAP_KEY);
  if (copyableMap != null) {
    final Map<Key,Object> mapclone=((THashMap<Key,Object>)copyableMap).clone();
    clone.putUserData(COPYABLE_USER_MAP_KEY,mapclone);
  }
  if (getViewProvider().isEventSystemEnabled()) {
    clone.myOriginalFile=this;
  }
 else   if (myOriginalFile != null) {
    clone.myOriginalFile=myOriginalFile;
  }
  return clone;
}
