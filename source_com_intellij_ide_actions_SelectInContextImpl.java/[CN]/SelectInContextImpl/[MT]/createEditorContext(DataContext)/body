{
  final Project project=(Project)dataContext.getData(DataConstants.PROJECT);
  final FileEditor editor=(FileEditor)dataContext.getData(DataConstants.FILE_EDITOR);
  if (project == null || editor == null) {
    return null;
  }
  VirtualFile file=FileEditorManagerEx.getInstanceEx(project).getFile(editor);
  if (file == null) {
    return null;
  }
  final PsiFile psiFile=PsiManager.getInstance(project).findFile(file);
  if (psiFile == null) {
    return null;
  }
  if (editor instanceof TextEditor) {
    return new SelectInContextProvider(new TextEditorContext((TextEditor)editor,psiFile),new EditorCaretLocation(((TextEditor)editor).getEditor()));
  }
 else {
    return new SelectInContextProvider(new SimpleSelectInContext(psiFile),new ComponentCenterLocation(editor.getComponent()));
  }
}
