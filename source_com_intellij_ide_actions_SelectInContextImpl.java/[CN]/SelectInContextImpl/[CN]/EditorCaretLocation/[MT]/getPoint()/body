{
  Point p;
  Rectangle visibleArea=editor.getScrollingModel().getVisibleArea();
  p=editor.logicalPositionToXY(editor.getCaretModel().getLogicalPosition());
  if (!visibleArea.contains(p)) {
    p=visibleArea.getLocation();
  }
  SwingUtilities.convertPointToScreen(p,editor.getContentComponent());
  return p;
}
