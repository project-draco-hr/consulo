{
  DataContext dataContext=event.getDataContext();
  Project project=CommonDataKeys.PROJECT.getData(dataContext);
  VirtualFile file=PlatformDataKeys.VIRTUAL_FILE.getData(dataContext);
  AntConfiguration antConfiguration=AntConfiguration.getInstance(project);
  try {
    antConfiguration.addBuildFile(file);
    ToolWindowManager.getInstance(project).getToolWindow(ToolWindowId.ANT_BUILD).activate(null);
  }
 catch (  AntNoFileException e) {
    String message=e.getMessage();
    if (message == null || message.length() == 0) {
      message=AntBundle.message("cannot.add.build.files.from.excluded.directories.error.message",e.getFile().getPresentableUrl());
    }
    Messages.showWarningDialog(project,message,AntBundle.message("cannot.add.build.file.dialog.title"));
  }
}
