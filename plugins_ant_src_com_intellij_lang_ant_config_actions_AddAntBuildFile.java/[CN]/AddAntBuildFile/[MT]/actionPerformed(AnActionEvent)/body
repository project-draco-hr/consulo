{
  DataContext dataContext=event.getDataContext();
  Project project=(Project)dataContext.getData(DataConstants.PROJECT);
  VirtualFile file=(VirtualFile)dataContext.getData(DataConstants.VIRTUAL_FILE);
  AntConfiguration antConfiguration=AntConfiguration.getInstance(project);
  try {
    antConfiguration.addBuildFile(file);
    ToolWindowManager.getInstance(project).getToolWindow(ToolWindowId.ANT_BUILD).activate(null);
  }
 catch (  AntNoFileException e) {
    Messages.showWarningDialog(project,AntBundle.message("cannot.add.build.files.from.excluded.directories.error.message",e.getFile().getPresentableUrl()),AntBundle.message("cannot.add.build.file.dialog.title"));
  }
}
