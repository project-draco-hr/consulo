{
  if (extension instanceof CustomImplementationFileBasedIndexExtension) {
    return ((CustomImplementationFileBasedIndexExtension<K,V,FileContent>)extension).createIndexImplementation(indexId,this,storage);
  }
  return new MapReduceIndex<K,V,FileContent>(indexId,extension.getIndexer(),storage);
}
