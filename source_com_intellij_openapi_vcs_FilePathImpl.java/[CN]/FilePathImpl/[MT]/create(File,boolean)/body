{
  if (selectedFile == null) {
    return null;
  }
  LocalFileSystem lfs=LocalFileSystem.getInstance();
  VirtualFile virtualFile=lfs.findFileByIoFile(selectedFile);
  if (virtualFile != null) {
    return new FilePathImpl(virtualFile);
  }
  File parentFile=selectedFile.getParentFile();
  if (parentFile == null) {
    return new FilePathImpl(selectedFile,isDirectory);
  }
  VirtualFile virtualFileParent=lfs.findFileByIoFile(parentFile);
  if (virtualFileParent != null) {
    return new FilePathImpl(virtualFileParent,selectedFile.getName(),isDirectory);
  }
 else {
    return new FilePathImpl(selectedFile,isDirectory);
  }
}
