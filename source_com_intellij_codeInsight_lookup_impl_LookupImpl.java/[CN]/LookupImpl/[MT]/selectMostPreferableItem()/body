{
  if (myItemPreferencePolicy == null) {
    myIndex=-1;
  }
 else {
    myItemPreferencePolicy.setPrefix(myPrefix);
    DefaultListModel model=(DefaultListModel)myList.getModel();
    Object[] items=model.toArray();
    LookupItem prefItem=null;
    int prefItemIndex=-1;
    for (int i=0; i < items.length; i++) {
      LookupItem item=(LookupItem)items[i];
      final Object obj=item.getObject();
      if (obj instanceof PsiElement && !((PsiElement)obj).isValid())       continue;
      if (prefItem == null) {
        prefItem=item;
        prefItemIndex=i;
      }
 else {
        int d=myItemPreferencePolicy.compare(item,prefItem);
        if (d < 0) {
          prefItem=item;
          prefItemIndex=i;
        }
      }
    }
    myIndex=prefItem != null ? prefItemIndex : -1;
  }
  myList.setSelectedIndex(myIndex);
}
