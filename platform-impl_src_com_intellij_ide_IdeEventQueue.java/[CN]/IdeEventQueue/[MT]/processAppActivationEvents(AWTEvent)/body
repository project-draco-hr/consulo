{
  final Application app=ApplicationManager.getApplication();
  if (!(app instanceof ApplicationImpl))   return;
  ApplicationImpl appImpl=(ApplicationImpl)app;
  if (e instanceof WindowEvent) {
    WindowEvent we=(WindowEvent)e;
    if (we.getID() == WindowEvent.WINDOW_GAINED_FOCUS && we.getWindow() != null) {
      if (we.getOppositeWindow() == null && !appImpl.isActive()) {
        appImpl.tryToApplyActivationState(true,we.getWindow());
      }
    }
 else     if (we.getID() == WindowEvent.WINDOW_LOST_FOCUS && we.getWindow() != null) {
      if (we.getOppositeWindow() == null && appImpl.isActive()) {
        appImpl.tryToApplyActivationState(false,we.getWindow());
      }
    }
  }
}
