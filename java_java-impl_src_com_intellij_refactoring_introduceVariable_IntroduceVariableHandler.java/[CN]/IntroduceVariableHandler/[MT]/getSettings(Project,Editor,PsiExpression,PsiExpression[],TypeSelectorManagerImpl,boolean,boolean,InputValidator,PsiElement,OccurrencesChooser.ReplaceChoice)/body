{
  if (replaceChoice != null) {
    return super.getSettings(project,editor,expr,occurrences,typeSelectorManager,declareFinalIfAll,anyAssignmentLHS,validator,anchor,replaceChoice);
  }
  ArrayList<RangeHighlighter> highlighters=new ArrayList<RangeHighlighter>();
  HighlightManager highlightManager=null;
  if (editor != null) {
    highlightManager=HighlightManager.getInstance(project);
    EditorColorsManager colorsManager=EditorColorsManager.getInstance();
    TextAttributes attributes=colorsManager.getGlobalScheme().getAttributes(EditorColors.SEARCH_RESULT_ATTRIBUTES);
    if (occurrences.length > 1) {
      highlightManager.addOccurrenceHighlights(editor,occurrences,attributes,true,highlighters);
    }
  }
  IntroduceVariableDialog dialog=new IntroduceVariableDialog(project,expr,occurrences.length,anyAssignmentLHS,declareFinalIfAll,typeSelectorManager,validator);
  dialog.show();
  if (!dialog.isOK()) {
    if (occurrences.length > 1) {
      WindowManager.getInstance().getStatusBar(project).setInfo(RefactoringBundle.message("press.escape.to.remove.the.highlighting"));
    }
  }
 else {
    if (editor != null) {
      for (      RangeHighlighter highlighter : highlighters) {
        highlightManager.removeSegmentHighlighter(editor,highlighter);
      }
    }
  }
  return dialog;
}
