{
  if (elements == null || elements.length == 0) {
    return null;
  }
  final List<PsiElement> validElements=new ArrayList<PsiElement>(elements.length);
  for (  final PsiElement element : elements) {
    if (element.isValid()) {
      validElements.add(element);
    }
  }
  return validElements.size() == elements.length ? elements : PsiUtilCore.toPsiElementArray(validElements);
}
