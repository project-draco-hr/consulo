{
  PsiFile psiFile=getPsi(language);
  if (psiFile == null) {
    psiFile=getPsi(getBaseLanguage());
    if (psiFile == null) {
      return null;
    }
  }
  PsiElement element=findElementAt(psiFile,offset);
  PsiLanguageInjectionHost injectionHost=TargetElementUtil.findInjectionHost(element);
  if (injectionHost != null) {
    return TargetElementUtil.lookInInjectedPsi(injectionHost,offset);
  }
  return element;
}
