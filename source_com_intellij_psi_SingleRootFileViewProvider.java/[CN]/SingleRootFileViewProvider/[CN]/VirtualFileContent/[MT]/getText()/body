{
  final VirtualFile virtualFile=getVirtualFile();
  if (virtualFile instanceof LightVirtualFile) {
    Document doc=getCachedDocument();
    if (doc != null)     return doc.getCharsSequence();
    return ((LightVirtualFile)virtualFile).getContent();
  }
  final Document document=getDocument();
  if (document == null) {
    return LoadTextUtil.loadText(virtualFile);
  }
 else {
    return document.getCharsSequence();
  }
}
