{
  super.paintComponent(g);
  if (myVisibleInfos.size() == 0)   return;
  final GraphicsConfig config=new GraphicsConfig(g);
  config.setAntialiasing(true);
  Graphics2D g2d=(Graphics2D)g;
  g.setColor(getBackground());
  final Rectangle clip=g.getClipBounds();
  g.fillRect(clip.x,clip.y,clip.width,clip.height);
  final TabInfo selected=getSelectedInfo();
  boolean leftGhostExists=isSingleRow();
  boolean rightGhostExists=isSingleRow();
  if (!isStealthModeEffective() && !isHideTabs()) {
    if (isSingleRow() && mySingleRowLayout.myLastSingRowLayout.lastGhostVisible) {
      paintLastGhost(g2d);
    }
    paintNonSelectedTabs(g2d,leftGhostExists);
    if (isSingleRow() && mySingleRowLayout.myLastSingRowLayout.firstGhostVisible) {
      paintFirstGhost(g2d);
    }
  }
  if (selected == null)   return;
  if (getSelectedLabel() == null)   return;
  final ShapeInfo shapeInfo=computeSelectedLabelShape();
  if (!isHideTabs()) {
    g2d.setColor(getBackground());
    g2d.fill(shapeInfo.fillPath.getShape());
  }
  final int alpha;
  int paintTopY=shapeInfo.labelTopY;
  int paintBottomY=shapeInfo.labelBottomY;
  final boolean paintFocused=myPaintFocus && (myFocused || myActivePopup != null);
  Color bgPreFill=null;
  if (paintFocused) {
    if (getActiveTabFillIn() == null) {
      shapeInfo.from=UIUtil.getFocusedFillColor();
      shapeInfo.to=UIUtil.getFocusedFillColor();
    }
 else {
      bgPreFill=getActiveTabFillIn();
      alpha=255;
      paintBottomY=shapeInfo.labelTopY + shapeInfo.labelPath.deltaY(getArcSize() - 2);
      shapeInfo.from=UIUtil.toAlpha(UIUtil.getFocusedFillColor(),alpha);
      shapeInfo.to=UIUtil.toAlpha(getActiveTabFillIn(),alpha);
    }
  }
 else {
    if (isPaintFocus()) {
      if (getActiveTabFillIn() == null) {
        alpha=150;
        shapeInfo.from=UIUtil.toAlpha(UIUtil.getPanelBackgound().brighter(),alpha);
        shapeInfo.to=UIUtil.toAlpha(UIUtil.getPanelBackgound(),alpha);
      }
 else {
        alpha=255;
        shapeInfo.from=UIUtil.toAlpha(getActiveTabFillIn(),alpha);
        shapeInfo.to=UIUtil.toAlpha(getActiveTabFillIn(),alpha);
      }
    }
 else {
      alpha=255;
      shapeInfo.from=UIUtil.toAlpha(Color.white,alpha);
      shapeInfo.to=UIUtil.toAlpha(Color.white,alpha);
    }
  }
  if (!isHideTabs()) {
    if (bgPreFill != null) {
      g2d.setColor(bgPreFill);
      g2d.fill(shapeInfo.fillPath.getShape());
    }
    final Line2D.Float gradientLine=shapeInfo.fillPath.transformLine(shapeInfo.fillPath.getX(),paintTopY,shapeInfo.fillPath.getX(),paintBottomY);
    g2d.setPaint(new GradientPaint((float)gradientLine.getX1(),(float)gradientLine.getY1(),shapeInfo.fillPath.transformY1(shapeInfo.from,shapeInfo.to),(float)gradientLine.getX2(),(float)gradientLine.getY2(),shapeInfo.fillPath.transformY1(shapeInfo.to,shapeInfo.from)));
    g2d.fill(shapeInfo.fillPath.getShape());
  }
  Color borderColor=UIUtil.getBoundsColor(paintFocused);
  g2d.setColor(borderColor);
  if (!isHideTabs()) {
    g2d.draw(shapeInfo.path.getShape());
  }
  paintBorder(g2d,shapeInfo,borderColor);
  config.setAntialiasing(false);
  if (isSideComponentVertical()) {
    Toolbar toolbarComp=myInfo2Toolbar.get(mySelectedInfo);
    if (!toolbarComp.isEmpty()) {
      Rectangle toolBounds=toolbarComp.getBounds();
      g2d.setColor(CaptionPanel.CNT_ACTIVE_COLOR);
      g.drawLine((int)toolBounds.getMaxX(),toolBounds.y,(int)toolBounds.getMaxX(),(int)toolBounds.getMaxY() - 1);
    }
  }
  config.restore();
}
