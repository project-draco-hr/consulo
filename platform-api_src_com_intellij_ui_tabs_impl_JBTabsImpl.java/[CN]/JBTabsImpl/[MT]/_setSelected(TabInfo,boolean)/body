{
  if (mySelectedInfo != null && mySelectedInfo.equals(info)) {
    if (!requestFocus) {
      return new ActionCallback.Done();
    }
 else {
      return requestFocus(getToFocus());
    }
  }
  if (myRequestFocusOnLastFocusedComponent && mySelectedInfo != null) {
    if (isMyChildIsFocusedNow()) {
      mySelectedInfo.setLastFocusOwner(getFocusOwner());
    }
  }
  TabInfo oldInfo=mySelectedInfo;
  mySelectedInfo=info;
  final TabInfo newInfo=getSelectedInfo();
  if (oldInfo != newInfo) {
    for (    TabsListener eachListener : myTabListeners) {
      eachListener.beforeSelectionChanged(oldInfo,newInfo);
    }
  }
  updateContainer(false,true);
  if (oldInfo != newInfo) {
    for (    TabsListener eachListener : myTabListeners) {
      if (eachListener != null) {
        eachListener.selectionChanged(oldInfo,newInfo);
      }
    }
  }
  if (requestFocus) {
    final JComponent toFocus=getToFocus();
    if (myProject != null && toFocus != null) {
      final ActionCallback result=new ActionCallback();
      requestFocus(toFocus).doWhenProcessed(new Runnable(){
        public void run(){
          if (myDisposed) {
            result.setRejected();
          }
 else {
            removeDeferred().notifyWhenDone(result);
          }
        }
      }
);
      return result;
    }
 else {
      requestFocus();
      return removeDeferred();
    }
  }
 else {
    return removeDeferred();
  }
}
