{
  if (file.getManager().isInProject(file)) {
    return true;
  }
  final VirtualFile vFile=file.getVirtualFile();
  if (vFile != null && vFile.isValid()) {
    ProjectFileIndex projectFileIndex=ProjectRootManager.getInstance(file.getProject()).getFileIndex();
    if (projectFileIndex.isInLibraryClasses(vFile) || projectFileIndex.isInLibrarySource(vFile)) {
      return true;
    }
  }
  return false;
}
