{
  if (!(refInfo instanceof MemberReferenceInfo)) {
    return refInfo.getClassName();
  }
  final int declaringClassName=refInfo.getClassName();
  final Cache cache=getCache();
  if (cache.getClassId(declaringClassName) == Cache.UNKNOWN) {
    return declaringClassName;
  }
  final int classDeclarationId=cache.getClassDeclarationId(declaringClassName);
  final MemberInfo memberInfo=((MemberReferenceInfo)refInfo).getMemberInfo();
  if (memberInfo instanceof FieldInfo) {
    if (cache.findFieldByName(classDeclarationId,memberInfo.getName()) != Cache.UNKNOWN) {
      return declaringClassName;
    }
  }
 else   if (memberInfo instanceof MethodInfo) {
    if (cache.findMethod(classDeclarationId,memberInfo.getName(),memberInfo.getDescriptor()) != Cache.UNKNOWN) {
      return declaringClassName;
    }
  }
  final DeclaringClassFinder finder=new DeclaringClassFinder(memberInfo);
  getCacheNavigator().walkSuperClasses(declaringClassName,finder);
  return finder.getDeclaringClassName();
}
