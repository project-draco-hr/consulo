{
  if (!(refInfo instanceof MemberReferenceInfo)) {
    return refInfo.getClassName();
  }
  final int declaringClassName=refInfo.getClassName();
  if (getCache().getClassId(declaringClassName) == Cache.UNKNOWN) {
    return declaringClassName;
  }
  final int classDeclarationId=getCache().getClassDeclarationId(declaringClassName);
  final MemberInfo memberInfo=((MemberReferenceInfo)refInfo).getMemberInfo();
  if (memberInfo instanceof FieldInfo) {
    if (CacheUtils.findFieldByName(getCache(),classDeclarationId,memberInfo.getName()) != Cache.UNKNOWN) {
      return declaringClassName;
    }
  }
 else   if (memberInfo instanceof MethodInfo) {
    if (CacheUtils.findMethod(getCache(),classDeclarationId,memberInfo.getName(),memberInfo.getDescriptor()) != Cache.UNKNOWN) {
      return declaringClassName;
    }
  }
  final DeclaringClassFinder finder=new DeclaringClassFinder(memberInfo);
  getCacheNavigator().walkSuperClasses(declaringClassName,finder);
  final int className=finder.getDeclaringClassName();
  return className;
}
