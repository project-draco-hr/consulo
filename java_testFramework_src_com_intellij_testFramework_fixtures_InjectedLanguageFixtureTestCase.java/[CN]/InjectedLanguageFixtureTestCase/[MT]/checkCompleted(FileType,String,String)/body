{
  myFixture.configureByText(fileType,text.replaceAll("\\|","<caret>"));
  tuneCompletionFile(myFixture.getFile());
  final LookupElement[] elements=myFixture.completeBasic();
  if (elements != null && elements.length == 1) {
    new WriteCommandAction(getProject()){
      @Override protected void run(      Result result) throws Throwable {
        ((LookupImpl)LookupManager.getInstance(getProject()).getActiveLookup()).finishLookup(Lookup.NORMAL_SELECT_CHAR);
      }
    }
.execute();
  }
 else   if (elements != null && elements.length > 0) {
    fail(Arrays.toString(elements));
  }
  myFixture.checkResult(resultText.replaceAll("\\|","<caret>"));
  FileDocumentManager.getInstance().saveDocument(myFixture.getDocument(myFixture.getFile()));
}
