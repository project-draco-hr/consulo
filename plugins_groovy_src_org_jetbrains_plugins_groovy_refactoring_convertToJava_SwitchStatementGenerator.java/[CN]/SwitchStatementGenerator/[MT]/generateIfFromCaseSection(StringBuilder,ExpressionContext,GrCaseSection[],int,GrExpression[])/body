{
  GenerationUtil.writeStatement(builder,context,null,new StatementWriter(){
    @Override public void writeStatement(    StringBuilder builder,    ExpressionContext context){
      if (caseSections.length == 1) {
        final GrCaseLabel[] labels=caseSections[0].getCaseLabels();
        if (labels.length == 1 && labels[0].isDefault()) {
          builder.append("if(true)");
        }
      }
      GrCaseSection section=caseSections[i];
      final GrCaseLabel[] labels=section.getCaseLabels();
      final boolean isCase=labels.length > 1 || !labels[0].isDefault();
      if (isCase) {
        builder.append("if (");
        for (        GrCaseLabel label : labels) {
          if (label.isDefault()) {
            builder.append("true");
          }
 else {
            GenerationUtil.invokeMethodByName(label.getValue(),"isCase",args,GrNamedArgument.EMPTY_ARRAY,GrClosableBlock.EMPTY_ARRAY,new ExpressionGenerator(builder,context),section);
          }
          builder.append("||");
        }
        builder.delete(builder.length() - 2,builder.length());
        builder.append(") ");
      }
      builder.append("{\n");
      final ExpressionContext extended=context.extend();
      CodeBlockGenerator generator=new CodeBlockGenerator(builder,extended);
      Outer:       for (int j=i; j < caseSections.length; j++) {
        section=caseSections[j];
        final GrStatement[] statements=section.getStatements();
        for (        GrStatement statement : statements) {
          if (statement instanceof GrBreakStatement && ((GrBreakStatement)statement).getLabelIdentifier() == null) {
            break Outer;
          }
          statement.accept(generator);
          builder.append("\n");
        }
      }
      builder.append('}');
      if (isCase && i + 1 < caseSections.length) {
        builder.append("\nelse ");
        StringBuilder elseBuilder=new StringBuilder();
        final ExpressionContext elseContext=context.extend();
        generateIfFromCaseSection(elseBuilder,elseContext,caseSections,i + 1,args);
        GenerationUtil.insertStatementFromContextBefore(builder,elseContext);
        builder.append(elseBuilder);
      }
      if (context.myStatements.size() > 0) {
        context.setInsertCurlyBrackets();
      }
    }
  }
);
}
