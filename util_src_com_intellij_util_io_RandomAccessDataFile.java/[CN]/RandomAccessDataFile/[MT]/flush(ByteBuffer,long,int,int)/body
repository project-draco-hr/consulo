{
  if (fileOffset + length > mySize) {
    length=(int)(mySize - fileOffset);
  }
  final RandomAccessFile file=getFile();
  try {
synchronized (file) {
      seek(file,fileOffset);
      totalWrites++;
      totalWriteBytes+=length;
      if (DEBUG) {
        log.write("Write at: \t" + fileOffset + "\t len: "+ length+ ", size: "+ mySize+ ", filesize: "+ file.length()+ "\n");
      }
      file.write(buf.array(),bufOffset,length);
      lastSeek+=length;
    }
  }
  finally {
    releaseFile();
  }
}
