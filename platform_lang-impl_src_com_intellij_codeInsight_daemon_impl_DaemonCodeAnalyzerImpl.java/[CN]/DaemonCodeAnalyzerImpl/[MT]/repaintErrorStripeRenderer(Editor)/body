{
  if (!myProject.isInitialized())   return;
  final Document document=editor.getDocument();
  final PsiFile psiFile=PsiDocumentManager.getInstance(myProject).getPsiFile(document);
  final EditorMarkupModel markup=(EditorMarkupModel)editor.getMarkupModel();
  markup.setErrorPanelPopupHandler(new DaemonEditorPopup(psiFile));
  markup.setErrorStripTooltipRendererProvider(new DaemonTooltipRendererProvider(myProject));
  markup.setMinMarkHeight(DaemonCodeAnalyzerSettings.getInstance().ERROR_STRIPE_MARK_MIN_HEIGHT);
  TrafficLightRenderer.setOrRefreshErrorStripeRenderer(markup,myProject,document,psiFile);
}
