{
  @SuppressWarnings("IOResourceOpenedButNotSafelyClosed") DataOutputStream dataOut=new DataOutputStream(out);
  try {
    dataOut.writeInt(myActions.size());
    for (    PatchAction each : myActions) {
      int key;
      Class clazz=each.getClass();
      if (clazz == CreateAction.class) {
        key=CREATE_ACTION_KEY;
      }
 else       if (clazz == UpdateAction.class) {
        key=UPDATE_ACTION_KEY;
      }
 else       if (clazz == UpdateZipAction.class) {
        key=UPDATE_ZIP_ACTION_KEY;
      }
 else       if (clazz == DeleteAction.class) {
        key=DELETE_ACTION_KEY;
      }
 else {
        throw new RuntimeException("Unknown action " + each);
      }
      dataOut.writeInt(key);
      each.write(dataOut);
    }
  }
  finally {
    dataOut.flush();
  }
}
