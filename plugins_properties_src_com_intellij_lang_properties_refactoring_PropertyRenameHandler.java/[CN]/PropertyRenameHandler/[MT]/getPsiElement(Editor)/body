{
  final PsiReference reference=TargetElementUtilBase.findReference(editor);
  if (reference instanceof PropertyReferenceBase) {
    final ResolveResult[] resolveResults=((PropertyReferenceBase)reference).multiResolve(false);
    return resolveResults.length > 0 ? resolveResults[0].getElement() : null;
  }
 else   if (reference instanceof PsiMultiReference) {
    final PsiReference[] references=((PsiMultiReference)reference).getReferences();
    for (    PsiReference psiReference : references) {
      if (psiReference instanceof PropertyReferenceBase) {
        final ResolveResult[] resolveResults=((PropertyReferenceBase)psiReference).multiResolve(false);
        if (resolveResults.length > 0)         return resolveResults[0].getElement();
      }
    }
  }
  return null;
}
