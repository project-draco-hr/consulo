{
  Class<?> type=obj.getClass();
  while (type != null) {
    Field[] fields=type.getDeclaredFields();
    for (int i=0; i < fields.length; i++) {
      Field f=fields[i];
      if ((f.getModifiers() & Modifier.TRANSIENT) != Modifier.TRANSIENT) {
        String fieldname=f.getName();
        Object value=getFieldValue(obj,fieldname);
        encodeValue(enc,obj,fieldname,value,node);
      }
    }
    type=type.getSuperclass();
  }
}
