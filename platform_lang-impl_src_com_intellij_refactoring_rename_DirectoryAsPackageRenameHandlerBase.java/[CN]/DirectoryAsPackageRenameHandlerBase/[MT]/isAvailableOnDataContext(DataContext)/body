{
  PsiElement element=adjustForRename(dataContext,PsiElementRenameHandler.getElement(dataContext));
  if (element instanceof PsiDirectory) {
    final VirtualFile virtualFile=((PsiDirectory)element).getVirtualFile();
    final Project project=element.getProject();
    if (Comparing.equal(project.getBaseDir(),virtualFile))     return false;
    if (ProjectRootManager.getInstance(project).getFileIndex().isInContent(virtualFile)) {
      return true;
    }
  }
  return false;
}
