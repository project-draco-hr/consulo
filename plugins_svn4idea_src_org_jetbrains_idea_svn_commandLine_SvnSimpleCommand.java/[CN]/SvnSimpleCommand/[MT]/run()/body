{
  addListener(new ProcessEventListener(){
    @Override public void processTerminated(    int exitCode){
    }
    @Override public void startFailed(    Throwable exception){
synchronized (myDataLock) {
        myException=new VcsException("Process failed to start (" + myCommandLine.getCommandLineString() + "): "+ exception.toString(),exception);
      }
    }
  }
);
  start();
  waitFor();
synchronized (myDataLock) {
    if (myException != null)     throw myException;
    final int code=getExitCode();
    if (code == 0) {
      return myStdout.toString();
    }
 else {
      String msg=myStderr.toString();
      if (msg.length() == 0) {
        msg=getStdout().toString();
      }
      if (msg.length() == 0) {
        msg="Svn process exited with error code: " + code;
      }
      throw new VcsException(msg);
    }
  }
}
