{
  final VcsException[] ex=new VcsException[1];
  final String[] result=new String[1];
  addListener(new ProcessEventListener(){
    @Override public void processTerminated(    int exitCode){
      try {
        if (exitCode == 0) {
          result[0]=getStdout().toString();
        }
 else {
          String msg=getStderr().toString();
          if (msg.length() == 0) {
            msg=getStdout().toString();
          }
          if (msg.length() == 0) {
            msg="Svn process exited with error code: " + exitCode;
          }
          ex[0]=new VcsException(msg);
        }
      }
 catch (      Throwable t) {
        ex[0]=new VcsException(t.toString(),t);
      }
    }
    @Override public void startFailed(    Throwable exception){
      ex[0]=new VcsException("Process failed to start (" + myCommandLine.getCommandLineString() + "): "+ exception.toString(),exception);
    }
  }
);
  start();
  if (myProcess != null) {
    waitFor();
  }
  if (ex[0] != null) {
    SvnVcs.getInstance(myProject).checkCommandLineVersion();
    throw ex[0];
  }
  if (result[0] == null) {
    throw new VcsException("Svn command returned null: " + myCommandLine.getCommandLineString());
  }
  return result[0];
}
