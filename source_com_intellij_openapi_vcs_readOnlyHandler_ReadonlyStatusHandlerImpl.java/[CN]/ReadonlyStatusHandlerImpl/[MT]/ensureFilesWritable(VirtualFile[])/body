{
  long[] modificationStamps=new long[files.length];
  for (int i=0; i < files.length; i++) {
    modificationStamps[i]=files[i].getModificationStamp();
  }
  final FileInfo[] fileInfos=createFileInfos(files);
  if (files.length == 0)   return new OperationStatus(VirtualFile.EMPTY_ARRAY,VirtualFile.EMPTY_ARRAY);
  if (ApplicationManager.getApplication().isUnitTestMode()) {
    return createResultStatus(files,modificationStamps);
  }
  Runnable handleAction=new Runnable(){
    public void run(){
      if (SHOW_DIALOG) {
        new HandleReadOnlyStatusDialog(myProject,fileInfos).show();
      }
 else {
        for (int i=0; i < fileInfos.length; i++) {
          fileInfos[i].handle();
        }
      }
    }
  }
;
  ApplicationManager.getApplication().assertIsDispatchThread();
  int savedEventCount=IdeEventQueue.getInstance().getEventCount();
  handleAction.run();
  IdeEventQueue.getInstance().setEventCount(savedEventCount);
  return createResultStatus(files,modificationStamps);
}
