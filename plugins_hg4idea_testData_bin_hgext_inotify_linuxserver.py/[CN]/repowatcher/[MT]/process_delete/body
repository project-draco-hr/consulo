def process_delete(self, wpath, evt):
    if self.ui.debugflag:
        self.ui.note((_('%s event: deleted %s\n') % (self.event_time(), wpath)))
    if (evt.mask & inotify.IN_ISDIR):
        tree = self.tree.dir(wpath)
        todelete = [wfn for (wfn, ignore) in tree.walk('?')]
        for fn in todelete:
            self.deletefile(fn, '?')
        self.scan(wpath)
    else:
        self.deleted(wpath)
