{
  setPrefix(prefix);
  myProximityComparator=new PsiProximityComparator(position,manager.getProject());
  myPosition=position;
  myPrefixCapitals=capitalsOnly(prefix);
  myCodeStyleManager=manager.getCodeStyleManager();
  if (expectedInfos != null) {
    final Map<PsiType,ExpectedTypeInfo> map=new HashMap<PsiType,ExpectedTypeInfo>(expectedInfos.length);
    for (    final ExpectedTypeInfo expectedInfo : expectedInfos) {
      if (!map.containsKey(expectedInfo.getType())) {
        map.put(expectedInfo.getType(),expectedInfo);
      }
    }
    myExpectedInfos=map.values().toArray(new ExpectedTypeInfo[map.size()]);
  }
 else   myExpectedInfos=null;
synchronized (myItemToIndexMap) {
    for (int i=0; i < allItems.length; i++) {
      myItemToIndexMap.put(allItems[i],i + 1);
    }
  }
}
