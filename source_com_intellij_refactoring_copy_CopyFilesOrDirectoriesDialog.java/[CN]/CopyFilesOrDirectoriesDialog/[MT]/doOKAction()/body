{
  if (myShowNewNameField) {
    String newName=getNewName();
    if (newName.length() == 0) {
      Messages.showMessageDialog(myProject,"No new name specified","Error",Messages.getErrorIcon());
      return;
    }
  }
  if (myShowDirectoryField) {
    final String targetDirectoryName=myTargetDirectoryField.getText();
    if (targetDirectoryName.length() == 0) {
      Messages.showMessageDialog(myProject,"No target directory specified","Error",Messages.getErrorIcon());
      return;
    }
    CommandProcessor.getInstance().executeCommand(myProject,new Runnable(){
      public void run(){
        ApplicationManager.getApplication().runWriteAction(new Runnable(){
          public void run(){
            try {
              myTargetDirectory=DirectoryUtil.mkdirs(PsiManager.getInstance(myProject),targetDirectoryName.replace(File.separatorChar,'/'));
            }
 catch (            IncorrectOperationException e) {
            }
          }
        }
);
      }
    }
,"Create directory",null);
    if (myTargetDirectory == null) {
      Messages.showMessageDialog(myProject,"Cannot create directory","Error",Messages.getErrorIcon());
      return;
    }
  }
  super.doOKAction();
}
