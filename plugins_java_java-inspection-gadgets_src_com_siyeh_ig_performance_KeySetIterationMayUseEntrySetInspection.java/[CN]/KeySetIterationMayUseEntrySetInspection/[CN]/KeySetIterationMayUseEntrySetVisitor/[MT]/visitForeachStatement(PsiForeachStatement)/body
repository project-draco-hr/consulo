{
  super.visitForeachStatement(statement);
  final PsiExpression iteratedValue=statement.getIteratedValue();
  if (iteratedValue == null) {
    return;
  }
  final PsiExpression iteratedExpression;
  if (iteratedValue instanceof PsiReferenceExpression) {
    final PsiReferenceExpression referenceExpression=(PsiReferenceExpression)iteratedValue;
    final PsiElement target=referenceExpression.resolve();
    if (!(target instanceof PsiLocalVariable)) {
      return;
    }
    final PsiVariable variable=(PsiVariable)target;
    final PsiMethod containingMethod=PsiTreeUtil.getParentOfType(variable,PsiMethod.class);
    if (VariableAccessUtils.variableIsAssignedAtPoint(variable,containingMethod,statement)) {
      return;
    }
    iteratedExpression=variable.getInitializer();
  }
 else {
    iteratedExpression=iteratedValue;
  }
  final PsiParameter parameter=statement.getIterationParameter();
  if (!isMapKeySetIteration(iteratedExpression,parameter,statement.getBody())) {
    return;
  }
  registerError(iteratedValue);
}
