{
  initRunnableSupport();
synchronized (RUNNABLE_LOCK) {
    ourCurrentRunnableCount++;
    ourMainThreadRunnables.put(String.valueOf(ourCurrentRunnableCount),new RunnableInfo(runnable,withAutoreleasePool));
  }
  final ID ideaRunnable=getObjcClass("IdeaRunnable");
  final ID runnableObject=invoke(invoke(ideaRunnable,"alloc"),"init");
  invoke(runnableObject,"performSelectorOnMainThread:withObject:waitUntilDone:",createSelector("run:"),nsString(String.valueOf(ourCurrentRunnableCount)),Boolean.valueOf(waitUntilDone));
  invoke(runnableObject,"release");
}
