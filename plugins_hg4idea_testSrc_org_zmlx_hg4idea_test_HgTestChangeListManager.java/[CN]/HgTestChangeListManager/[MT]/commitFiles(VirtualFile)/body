{
  ensureUpToDate();
  final List<Change> changes=new ArrayList<Change>(files.length);
  for (  VirtualFile f : files) {
    changes.addAll(peer.getChangesIn(f));
  }
  final LocalChangeList list=peer.getDefaultChangeList();
  assertNotNull(list);
  list.setComment("A comment to a commit");
  Assert.assertTrue(peer.commitChangesSynchronouslyWithResult(list,changes));
  ensureUpToDate();
}
