{
  for (  JpsModule module : modules) {
    final JpsAndroidModuleExtension extension=AndroidJpsUtil.getExtension(module);
    if (extension == null) {
      continue;
    }
    final List<String> resourceDirs=new ArrayList<String>();
    final List<String> assetsDirs=new ArrayList<String>();
    final File resourceDir=extension.getResourceDir();
    if (resourceDir != null) {
      resourceDirs.add(resourceDir.getPath());
    }
    final File assetsDir=extension.getAssetsDir();
    if (assetsDir != null) {
      assetsDirs.add(assetsDir.getPath());
    }
    final File manifestFile=AndroidJpsUtil.getManifestFileForCompilationPath(extension);
    if (manifestFile != null) {
      manifestFiles.put(module,manifestFile);
    }
    for (    JpsAndroidModuleExtension libExtension : AndroidJpsUtil.getAllAndroidDependencies(module,true)) {
      final File libResDir=libExtension.getResourceDir();
      if (libResDir != null) {
        resourceDirs.add(libResDir.getPath());
      }
      final File libAssetsDir=libExtension.getAssetsDir();
      if (libAssetsDir != null && extension.isIncludeAssetsFromLibraries()) {
        assetsDirs.add(libAssetsDir.getPath());
      }
    }
    resourcesStates.put(module,new AndroidFileSetState(resourceDirs,Condition.TRUE,true));
    assetsStates.put(module,new AndroidFileSetState(assetsDirs,Condition.TRUE,true));
  }
}
