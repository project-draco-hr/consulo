{
  final AndroidFileSetState moduleState=module2state.get(module);
  final AndroidFileSetState savedState=storage.getState(module.getName());
  if (savedState == null || !savedState.equalsTo(moduleState)) {
    return false;
  }
  if (withDependencies) {
    for (    JpsAndroidModuleExtension libExtension : AndroidJpsUtil.getAllAndroidDependencies(module,true)) {
      final JpsModule libModule=libExtension.getModule();
      final AndroidFileSetState currentLibState=module2state.get(libModule);
      final AndroidFileSetState savedLibState=storage.getState(libModule.getName());
      if (savedLibState == null || !savedLibState.equalsTo(currentLibState)) {
        return false;
      }
    }
  }
  return true;
}
