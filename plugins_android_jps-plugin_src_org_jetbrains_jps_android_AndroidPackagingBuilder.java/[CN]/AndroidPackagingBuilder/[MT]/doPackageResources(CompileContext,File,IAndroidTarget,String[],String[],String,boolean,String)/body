{
  try {
    final String outputPath=releasePackage ? outputFilePath + RELEASE_SUFFIX : outputFilePath;
    final IgnoredFilePatterns ignoredFilePatterns=context.getProject().getIgnoredFilePatterns();
    final Map<AndroidCompilerMessageKind,List<String>> messages=AndroidApt.packageResources(target,-1,manifestFile.getPath(),resourceDirPaths,assetsDirPaths,outputPath,null,!releasePackage,0,new FileFilter(){
      @Override public boolean accept(      File pathname){
        return !ignoredFilePatterns.isIgnored(PathUtil.getFileName(pathname.getPath()));
      }
    }
);
    AndroidJpsUtil.addMessages(context,messages,BUILDER_NAME,moduleName);
    return messages.get(AndroidCompilerMessageKind.ERROR).size() == 0;
  }
 catch (  final IOException e) {
    AndroidJpsUtil.reportExceptionError(context,null,e,BUILDER_NAME);
    return false;
  }
}
