{
  final JpsModule module=extension.getModule();
  try {
    context.processMessage(new ProgressMessage(AndroidJpsBundle.message("android.jps.progress.packaging.resources",module.getName())));
    final ArrayList<String> assetsDirPaths=new ArrayList<String>();
    collectAssetDirs(extension,assetsDirPaths);
    File outputDir=AndroidJpsUtil.getDirectoryForIntermediateArtifacts(context,module);
    outputDir=AndroidJpsUtil.createDirIfNotExist(outputDir,context,BUILDER_NAME);
    if (outputDir == null) {
      return false;
    }
    final AndroidPlatform platform=AndroidJpsUtil.getAndroidPlatform(module,context,BUILDER_NAME);
    if (platform == null) {
      return false;
    }
    final IAndroidTarget target=platform.getTarget();
    final String outputFilePath=getPackagedResourcesFile(module,outputDir).getPath();
    final String[] resourceDirPaths=AndroidJpsUtil.collectResourceDirsForCompilation(extension,true,context);
    return doPackageResources(context,manifestFile,target,resourceDirPaths,ArrayUtil.toStringArray(assetsDirPaths),outputFilePath,AndroidJpsUtil.isReleaseBuild(context),module.getName());
  }
 catch (  IOException e) {
    AndroidJpsUtil.reportExceptionError(context,null,e,BUILDER_NAME);
    return false;
  }
}
