{
  mxLightweightLabel textRenderer=mxLightweightLabel.getSharedInstance();
  if (textRenderer != null) {
    textRenderer.setText(createHtmlDocument(style,markup));
    Dimension size=textRenderer.getPreferredSize();
    if (wrapWidth > 0) {
      textRenderer.setText(createHtmlDocument(style,markup,1,(int)Math.ceil(wrapWidth * mxConstants.PX_PER_PIXEL - mxConstants.LABEL_INSET * scale)));
      Dimension size2=textRenderer.getPreferredSize();
      if (size2.width < size.width) {
        size=size2;
      }
    }
    return new mxRectangle(0,0,size.width * scale,size.height * scale);
  }
 else {
    return getSizeForString(markup,getFont(style),scale);
  }
}
