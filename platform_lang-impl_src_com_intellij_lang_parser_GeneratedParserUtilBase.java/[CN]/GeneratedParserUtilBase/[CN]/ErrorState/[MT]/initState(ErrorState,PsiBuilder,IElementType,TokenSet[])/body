{
  state.extendsSets=extendsSets;
  PsiFile file=builder.getUserDataUnprotected(FileContextUtil.CONTAINING_FILE_KEY);
  state.completionState=file == null ? null : file.getUserData(COMPLETION_STATE_KEY);
  Language language=file == null ? root.getLanguage() : file.getLanguage();
  state.caseSensitive=language.isCaseSensitive();
  PairedBraceMatcher matcher=LanguageBraceMatching.INSTANCE.forLanguage(language);
  state.braces=matcher == null ? null : matcher.getPairs();
  if (state.braces != null && state.braces.length == 0)   state.braces=null;
}
