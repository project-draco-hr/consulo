{
  if (myDocumentWindow.getTextLength() == 0)   return 0;
  CharSequence text=myDocumentWindow.getCharsSequence();
  int start=myDocumentWindow.getLineStartOffset(lineIndex);
  if (offset == 0)   return 0;
  int end=myDocumentWindow.getLineEndOffset(lineIndex);
  if (offset > end - start)   offset=end - start;
  return EditorUtil.calcColumnNumber(this,text,start,start + offset,myDelegate.getTabSize());
}
