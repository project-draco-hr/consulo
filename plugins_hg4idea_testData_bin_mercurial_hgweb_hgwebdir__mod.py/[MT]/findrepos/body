def findrepos(paths):
    repos = []
    for (prefix, root) in cleannames(paths):
        (roothead, roottail) = os.path.split(root)
        try:
            recurse = {'*': False, '**': True, }[roottail]
        except KeyError:
            repos.append((prefix, root))
            continue
        roothead = os.path.normpath(roothead)
        for path in util.walkrepos(roothead, followsym=True, recurse=recurse):
            path = os.path.normpath(path)
            name = util.pconvert(path[len(roothead):]).strip('/')
            if prefix:
                name = ((prefix + '/') + name)
            repos.append((name, path))
    return repos
