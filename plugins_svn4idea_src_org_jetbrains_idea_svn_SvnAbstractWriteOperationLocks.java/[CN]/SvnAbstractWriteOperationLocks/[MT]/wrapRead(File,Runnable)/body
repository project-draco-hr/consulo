{
  final WorkingCopy copy=getCopy(file,file.isDirectory());
  if (!copy.is17Copy()) {
    runnable.run();
    return;
  }
  final File root=copy.getFile();
  SqlJetDb open=null;
  final boolean run[]=new boolean[1];
  run[0]=false;
  try {
    open=SqlJetDb.open(SvnUtil.getWcDb(root),false);
    open.setBusyHandler(ourBusyHandler);
    try {
      final SqlJetDb finalOpen=open;
      open.runReadTransaction(new ISqlJetTransaction(){
        @Override public Object run(        SqlJetDb db) throws SqlJetException {
          run[0]=true;
          runnable.run();
          return null;
        }
      }
);
    }
  finally {
      open.rollback();
    }
  }
 catch (  SqlJetException e) {
    LOG.info(e);
    if (!run[0]) {
      runnable.run();
    }
  }
 finally {
    if (open != null) {
      try {
        open.close();
      }
 catch (      SqlJetException e) {
        LOG.info(e);
      }
    }
  }
}
