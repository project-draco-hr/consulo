{
  if (first == null)   return;
  while (first != last && first instanceof PsiWhiteSpace) {
    first=first.getNextSibling();
  }
  while (last != first && last instanceof PsiWhiteSpace) {
    last=last.getPrevSibling();
  }
  if (first == last && last instanceof PsiWhiteSpace)   return;
  PsiElement toExtract=first;
  if (myIsEffective) {
    toExtract=from.getParent().addRangeBefore(first,last,from);
  }
  do {
    addElementToExtract(toExtract);
    toExtract=toExtract.getNextSibling();
    first=first.getNextSibling();
  }
 while (first != null && first.getPrevSibling() != last);
}
