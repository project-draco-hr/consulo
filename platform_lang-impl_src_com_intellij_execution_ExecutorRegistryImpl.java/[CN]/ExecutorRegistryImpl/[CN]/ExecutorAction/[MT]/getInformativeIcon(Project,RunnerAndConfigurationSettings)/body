{
  final ExecutionManagerImpl executionManager=ExecutionManagerImpl.getInstance(project);
  List<RunContentDescriptor> runningDescriptors=executionManager.getRunningDescriptors(new Condition<RunnerAndConfigurationSettings>(){
    @Override public boolean value(    RunnerAndConfigurationSettings s){
      return s == selectedConfiguration;
    }
  }
);
  runningDescriptors=ContainerUtil.filter(runningDescriptors,new Condition<RunContentDescriptor>(){
    @Override public boolean value(    RunContentDescriptor descriptor){
      RunContentDescriptor contentDescriptor=executionManager.getContentManager().findContentDescriptor(myExecutor,descriptor.getProcessHandler());
      return contentDescriptor != null && executionManager.getExecutors(contentDescriptor).contains(myExecutor);
    }
  }
);
  if (!runningDescriptors.isEmpty() && DefaultRunExecutor.EXECUTOR_ID.equals(myExecutor.getId()) && selectedConfiguration.isSingleton()) {
    return AllIcons.Actions.Restart;
  }
  if (runningDescriptors.isEmpty()) {
    return myExecutor.getIcon();
  }
  if (runningDescriptors.size() == 1) {
    return ExecutionUtil.getLiveIndicator(myExecutor.getIcon());
  }
 else {
    return IconUtil.addText(myExecutor.getIcon(),String.valueOf(runningDescriptors.size()));
  }
}
