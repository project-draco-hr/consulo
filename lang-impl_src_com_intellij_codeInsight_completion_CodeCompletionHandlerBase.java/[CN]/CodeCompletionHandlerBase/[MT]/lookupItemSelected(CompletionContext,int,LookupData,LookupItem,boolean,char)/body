{
  final InsertHandler handler=item.getInsertHandler() != null ? item.getInsertHandler() : new DefaultInsertHandler();
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    public void run(){
      PsiDocumentManager.getInstance(context.project).commitAllDocuments();
      context.setPrefix(data.prefix);
      final PsiElement position=context.file.findElementAt(context.getStartOffset() - context.getPrefix().length() + item.getLookupString().length() - 1);
      analyseItem(item,position,context);
      handler.handleInsert(context,startOffset,data,item,signatureSelected,completionChar);
    }
  }
);
}
