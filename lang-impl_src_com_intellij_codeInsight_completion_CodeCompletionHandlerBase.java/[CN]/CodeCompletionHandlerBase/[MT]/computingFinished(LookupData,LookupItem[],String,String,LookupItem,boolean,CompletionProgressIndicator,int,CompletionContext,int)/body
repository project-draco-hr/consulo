{
  ProgressManager.getInstance().checkCanceled();
  invokeAndWait(new Runnable(){
    public void run(){
      if (indicator.isCanceled())       return;
      if (item != null) {
        indicator.closeAndFinish();
        handleSingleItem(offset2,context,data,prefix,uniqueText,item);
      }
 else {
        handleMultipleItems(offset1,context,items,prefix,indicator.getLookup());
      }
    }
  }
,context.editor);
}
