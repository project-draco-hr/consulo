{
  final VirtualFile file=getSelectedFile();
  Pair<String,Boolean> result=ChooseFileEncodingAction.update(file);
  String text;
  if (file != null) {
    Charset charset=ChooseFileEncodingAction.charsetFromContent(file);
    if (charset == null)     charset=file.getCharset();
    text=charset.displayName();
    actionEnabled=result.second;
  }
 else {
    text="";
    actionEnabled=false;
  }
  myComponent.setToolTipText(result.first);
  myComponent.setText(text);
  myStatusBar.updateWidget(ID());
}
