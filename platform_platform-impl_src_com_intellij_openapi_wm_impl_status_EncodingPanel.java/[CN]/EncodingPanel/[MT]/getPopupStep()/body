{
  final DataContext parent=DataManager.getInstance().getDataContext((Component)myStatusBar);
  final DataContext dataContext=SimpleDataContext.getSimpleContext(PlatformDataKeys.VIRTUAL_FILE.getName(),getSelectedFile(),SimpleDataContext.getSimpleContext(PlatformDataKeys.PROJECT.getName(),getProject(),parent));
  return JBPopupFactory.getInstance().createActionGroupPopup(null,new ChooseFileEncodingAction(getSelectedFile()){
    @Override protected void chosen(    VirtualFile virtualFile,    Charset charset){
      if (virtualFile != null) {
        EncodingManager.getInstance().setEncoding(virtualFile,charset);
        EncodingPanel.this.update();
      }
    }
  }
.createGroup(false),dataContext,false,false,false,null,30,null);
}
