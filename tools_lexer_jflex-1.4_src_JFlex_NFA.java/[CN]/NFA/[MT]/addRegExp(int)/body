{
  if (Options.DEBUG)   Out.debug("Adding nfa for regexp " + regExpNum + " :"+ Out.NL+ regExps.getRegExp(regExpNum));
  IntPair nfa=insertNFA(regExps.getRegExp(regExpNum));
  Enumeration lexStates=regExps.getStates(regExpNum).elements();
  if (!lexStates.hasMoreElements())   lexStates=scanner.states.getInclusiveStates();
  while (lexStates.hasMoreElements()) {
    int stateNum=((Integer)lexStates.nextElement()).intValue();
    if (!regExps.isBOL(regExpNum))     addEpsilonTransition(2 * stateNum,nfa.start);
    addEpsilonTransition(2 * stateNum + 1,nfa.start);
  }
  if (regExps.getLookAhead(regExpNum) != null) {
    IntPair look=insertNFA(regExps.getLookAhead(regExpNum));
    addEpsilonTransition(nfa.end,look.start);
    Action a=regExps.getAction(regExpNum);
    a.setLookAction(true);
    isPushback[nfa.end]=true;
    action[look.end]=a;
    isFinal[look.end]=true;
  }
 else {
    action[nfa.end]=regExps.getAction(regExpNum);
    isFinal[nfa.end]=true;
  }
}
