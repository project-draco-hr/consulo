{
  if (lookAhead.type == sym.BAR) {
    RegExp2 r=(RegExp2)lookAhead;
    insertLookAheadChoices(baseEnd,a,r.r1);
    insertLookAheadChoices(baseEnd,a,r.r2);
  }
 else   if (lookAhead.type == sym.MACROUSE) {
    RegExp1 r=(RegExp1)lookAhead;
    insertLookAheadChoices(baseEnd,a,macros.getDefinition((String)r.content));
  }
 else {
    int len=SemCheck.length(lookAhead);
    if (len >= 0) {
      IntPair look=insertNFA(lookAhead);
      addEpsilonTransition(baseEnd,look.start);
      Action x=a.copyChoice(len);
      action[look.end]=x;
      isFinal[look.end]=true;
      scanner.actions.add(x);
    }
 else {
      throw new Error("When inserting lookahead expression: unkown expression type " + lookAhead.type + " in "+ lookAhead);
    }
  }
}
