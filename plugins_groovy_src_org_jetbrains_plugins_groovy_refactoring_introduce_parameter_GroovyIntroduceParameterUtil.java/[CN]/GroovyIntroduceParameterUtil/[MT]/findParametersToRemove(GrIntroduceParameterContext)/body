{
  TObjectIntHashMap<GrParameter> toRemove=new TObjectIntHashMap<GrParameter>();
  if (context.getVar() == null) {
    final GrParametersOwner parametersOwner=context.getToReplaceIn();
    final GrParameter[] parameters=parametersOwner.getParameters();
    final GrExpression expr=context.getExpression();
    for (int i=0; i < parameters.length; i++) {
      GrParameter parameter=parameters[i];
      final boolean shouldRemove=ReferencesSearch.search(parameter).forEach(new Processor<PsiReference>(){
        @Override public boolean process(        PsiReference ref){
          final PsiElement element=ref.getElement();
          if (element == null)           return false;
          return PsiTreeUtil.isAncestor(expr,element,false);
        }
      }
);
      if (shouldRemove) {
        toRemove.put(parameter,i);
      }
    }
  }
  return toRemove;
}
