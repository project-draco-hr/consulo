{
  final XBreakpointManager breakpointManager=XDebuggerManager.getInstance(project).getBreakpointManager();
  final XLightBreakpointPropertiesPanel propertiesPanel=new XLightBreakpointPropertiesPanel(project,breakpointManager,breakpoint,showAllOptions);
  final JComponent mainPanel=propertiesPanel.getMainPanel();
  final Balloon balloon=JBPopupFactory.getInstance().createDialogBalloonBuilder(mainPanel,breakpoint.getType().getDisplayText(breakpoint)).setHideOnClickOutside(true).createBalloon();
  final XBreakpointListener<XBreakpoint<?>> breakpointListener=new XBreakpointListener<XBreakpoint<?>>(){
    @Override public void breakpointAdded(    @NotNull XBreakpoint<?> breakpoint1){
    }
    @Override public void breakpointRemoved(    @NotNull XBreakpoint<?> breakpoint1){
      if (breakpoint1.equals(breakpoint)) {
        balloon.hide();
      }
    }
    @Override public void breakpointChanged(    @NotNull XBreakpoint<?> breakpoint1){
      if (breakpoint1.equals(breakpoint)) {
        balloon.hide();
      }
    }
  }
;
  breakpointManager.addBreakpointListener(breakpointListener);
  balloon.addListener(new JBPopupListener(){
    @Override public void beforeShown(    LightweightWindowEvent event){
    }
    @Override public void onClosed(    LightweightWindowEvent event){
      propertiesPanel.saveProperties();
      breakpointManager.removeBreakpointListener(breakpointListener);
    }
  }
);
  propertiesPanel.setDelegate(new XLightBreakpointPropertiesPanel.Delegate(){
    @Override public void showMoreOptions(){
      balloon.hide();
      showBreakpointEditorBalloon(project,point,component,true,breakpoint);
    }
  }
);
  propertiesPanel.loadProperties();
  if (point == null) {
    balloon.showInCenterOf(component);
  }
 else {
    balloon.show(new RelativePoint(component,point),Balloon.Position.atRight);
  }
  ApplicationManager.getApplication().invokeLater(new Runnable(){
    @Override public void run(){
      IdeFocusManager.findInstance().requestFocus(mainPanel,true);
    }
  }
);
}
