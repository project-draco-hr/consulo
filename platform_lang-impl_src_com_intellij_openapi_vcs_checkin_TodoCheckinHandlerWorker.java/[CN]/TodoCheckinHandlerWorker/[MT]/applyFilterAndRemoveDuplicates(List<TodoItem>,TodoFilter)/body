{
  TodoItem previous=null;
  for (Iterator<TodoItem> iterator=todoItems.iterator(); iterator.hasNext(); ) {
    final TodoItem next=iterator.next();
    if (filter != null && !filter.contains(next.getPattern())) {
      iterator.remove();
      continue;
    }
    if (previous != null && next.getTextRange().equals(previous.getTextRange())) {
      iterator.remove();
    }
 else {
      previous=next;
    }
  }
}
