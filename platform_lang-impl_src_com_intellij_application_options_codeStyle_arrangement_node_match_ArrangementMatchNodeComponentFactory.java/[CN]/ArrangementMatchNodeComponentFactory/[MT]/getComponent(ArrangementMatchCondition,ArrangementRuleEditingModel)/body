{
  final Ref<ArrangementMatchNodeComponent> ref=new Ref<ArrangementMatchNodeComponent>();
  node.invite(new ArrangementMatchConditionVisitor(){
    @Override public void visit(    @NotNull ArrangementAtomMatchCondition condition){
      ArrangementMatchNodeComponent component;
      if (myGroupingConditions.contains(condition)) {
        component=new ArrangementGroupingMatchNodeComponent(myDisplayManager,condition);
      }
 else {
        component=new ArrangementAtomMatchNodeComponent(myDisplayManager,myColorsProvider,condition,prepareRemoveCallback(condition,model));
      }
      ref.set(component);
    }
    @Override public void visit(    @NotNull ArrangementCompositeMatchCondition condition){
switch (condition.getOperator()) {
case AND:
        ref.set(new ArrangementAndMatchNodeComponent(condition,ArrangementMatchNodeComponentFactory.this,myDisplayManager,model));
      break;
case OR:
  }
}
}
);
return ref.get();
}
