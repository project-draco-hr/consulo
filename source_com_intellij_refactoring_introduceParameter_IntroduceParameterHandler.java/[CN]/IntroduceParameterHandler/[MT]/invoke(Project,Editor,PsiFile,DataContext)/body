{
  PsiDocumentManager.getInstance(project).commitAllDocuments();
  editor.getScrollingModel().scrollToCaret(ScrollType.MAKE_VISIBLE);
  ElementToWorkOn elementToWorkOn=ElementToWorkOn.getElementToWorkOn(editor,file,REFACTORING_NAME,HelpID.INTRODUCE_PARAMETER,project);
  if (elementToWorkOn == null)   return;
  final PsiExpression expr=elementToWorkOn.getExpression();
  final PsiLocalVariable localVar=elementToWorkOn.getLocalVariable();
  final boolean isInvokedOnDeclaration=elementToWorkOn.isInvokedOnDeclaration();
  if (invoke(editor,project,expr,localVar,isInvokedOnDeclaration)) {
    editor.getSelectionModel().removeSelection();
  }
}
