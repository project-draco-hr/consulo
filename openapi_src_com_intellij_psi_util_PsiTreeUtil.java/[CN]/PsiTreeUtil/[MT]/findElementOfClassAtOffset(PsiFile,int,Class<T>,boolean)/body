{
  final PsiFile[] psiRoots=file.getPsiRoots();
  T result=null;
  for (int i=0; i < psiRoots.length; i++) {
    PsiFile root=psiRoots[i];
    final PsiElement elementAt=root.findElementAt(offset);
    if (elementAt != null) {
      final T parent=getParentOfType(elementAt,clazz);
      if (parent != null) {
        final TextRange range=parent.getTextRange();
        if (!strictStart || range.getStartOffset() == offset) {
          if (result == null || result.getTextRange().getEndOffset() > range.getEndOffset()) {
            result=parent;
          }
        }
      }
    }
  }
  return result;
}
