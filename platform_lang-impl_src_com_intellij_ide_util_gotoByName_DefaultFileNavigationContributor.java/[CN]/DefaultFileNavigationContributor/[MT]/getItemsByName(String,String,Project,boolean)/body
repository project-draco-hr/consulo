{
  final boolean includeDirs=pattern.endsWith("/") || pattern.endsWith("\\");
  GlobalSearchScope scope=includeNonProjectItems ? ProjectScope.getAllScope(project) : ProjectScope.getProjectScope(project);
  PsiFileSystemItem[] items=FilenameIndex.getFilesByName(project,name,scope,includeDirs);
  if (items.length == 0 && includeNonProjectItems && !includeDirs) {
    items=FilenameIndex.getFilesByName(project,name,scope,true);
  }
  return items;
}
