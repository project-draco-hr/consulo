{
  WhiteSpaceFormattingStrategy strategy=myWhiteSpaceStrategy;
  PsiElement injectedElement=myFile != null ? InjectedLanguageUtil.findElementAtNoCommit(myFile,startOffset) : null;
  if (injectedElement != null) {
    Language injectedLanguage=injectedElement.getLanguage();
    if (!injectedLanguage.equals(myFile.getLanguage())) {
      WhiteSpaceFormattingStrategy localStrategy=WhiteSpaceFormattingStrategyFactory.getStrategy(injectedLanguage);
      if (localStrategy != null)       strategy=localStrategy;
    }
  }
  return strategy.check(myDocument.getCharsSequence(),startOffset,endOffset) >= endOffset;
}
