def parents(self):
    'return parent filectxs, following copies if necessary'

    def filenode(ctx, path):
        return ctx._manifest.get(path, nullid)
    path = self._path
    fl = self._filelog
    pcl = self._changectx._parents
    renamed = self.renamed()
    if renamed:
        pl = [(renamed + (None,))]
    else:
        pl = [(path, filenode(pcl[0], path), fl)]
    for pc in pcl[1:]:
        pl.append((path, filenode(pc, path), fl))
    return [filectx(self._repo, p, fileid=n, filelog=l) for (p, n, l) in pl if (n != nullid)]
