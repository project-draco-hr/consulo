def __init__(self, repo, changeid=''):
    'changeid is a revision number, node, or tag'
    if (changeid == ''):
        changeid = '.'
    self._repo = repo
    if isinstance(changeid, (long, int)):
        self._rev = changeid
        self._node = self._repo.changelog.node(changeid)
    else:
        self._node = self._repo.lookup(changeid)
        self._rev = self._repo.changelog.rev(self._node)
