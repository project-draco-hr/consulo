{
  final Map<String,String> buildTestParams=buildTestParameters();
  try {
    if (buildTestParams.isEmpty()) {
      String path=new File(myData.getSuiteName()).getAbsolutePath() + "\n";
      FileUtil.writeToFile(myTempFile,path.getBytes(CharsetToolkit.UTF8_CHARSET),true);
      return;
    }
    final Parser parser=new Parser(myData.getSuiteName());
    parser.setLoadClasses(false);
    final Collection<XmlSuite> suites=parser.parse();
    for (    XmlSuite suite : suites) {
      Map<String,String> params=suite.getParameters();
      params.putAll(buildTestParams);
      final String fileId=FileUtil.sanitizeFileName(myProject.getName() + '_' + suite.getName()+ '_'+ Integer.toHexString(suite.getName().hashCode())+ ".xml");
      final File suiteFile=new File(PathManager.getSystemPath(),fileId);
      FileWriter fileWriter=new FileWriter(suiteFile);
      try {
        fileWriter.write(suite.toXml());
      }
  finally {
        fileWriter.close();
      }
      String path=suiteFile.getAbsolutePath() + "\n";
      FileUtil.writeToFile(myTempFile,path.getBytes(CharsetToolkit.UTF8_CHARSET),true);
    }
  }
 catch (  Exception e) {
    throw new CantRunException("Unable to parse suite: " + e.getMessage());
  }
}
