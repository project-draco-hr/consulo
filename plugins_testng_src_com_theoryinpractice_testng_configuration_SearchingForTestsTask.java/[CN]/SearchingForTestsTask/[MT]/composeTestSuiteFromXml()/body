{
  final Map<String,String> buildTestParams=buildTestParameters();
  try {
    if (buildTestParams.isEmpty()) {
      String path=new File(myData.getSuiteName()).getAbsolutePath() + "\n";
      FileUtil.writeToFile(myTempFile,path.getBytes(),true);
      return;
    }
    Collection<XmlSuite> suites;
    FileInputStream in=new FileInputStream(myData.getSuiteName());
    try {
      suites=new Parser(in).parse();
    }
  finally {
      in.close();
    }
    for (    XmlSuite suite : suites) {
      Map<String,String> params=suite.getParameters();
      params.putAll(buildTestParams);
      final String fileId=(myProject.getName() + '_' + suite.getName()+ '_'+ Integer.toHexString(suite.getName().hashCode())+ ".xml").replace(' ','_');
      final File suiteFile=new File(PathManager.getSystemPath(),fileId);
      FileWriter fileWriter=new FileWriter(suiteFile);
      try {
        fileWriter.write(suite.toXml());
      }
  finally {
        fileWriter.close();
      }
      String path=suiteFile.getAbsolutePath() + "\n";
      FileUtil.writeToFile(myTempFile,path.getBytes(),true);
    }
  }
 catch (  Exception e) {
    throw new CantRunException("Unable to parse suite: " + e.getMessage());
  }
}
