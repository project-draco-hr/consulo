{
  boolean wasAutodetectedAsText=fileType == PlainTextFileType.INSTANCE;
  boolean wasAutodetectedAsBinary=fileType == UnknownFileType.INSTANCE;
  int flags=BitUtil.set(0,AUTO_DETECTED_AS_TEXT_MASK,wasAutodetectedAsText);
  flags=BitUtil.set(flags,AUTO_DETECTED_AS_BINARY_MASK,wasAutodetectedAsBinary);
  writeFlagsToCache(file,flags);
  if (file instanceof VirtualFileWithId) {
    int id=Math.abs(((VirtualFileWithId)file).getId());
    flags=AUTO_DETECT_WAS_RUN_MASK | ATTRIBUTES_WERE_LOADED_MASK;
    flags=BitUtil.set(flags,AUTO_DETECTED_AS_TEXT_MASK,wasAutodetectedAsText);
    flags=BitUtil.set(flags,AUTO_DETECTED_AS_BINARY_MASK,wasAutodetectedAsBinary);
    packedFlags.set(id,flags);
    if (wasAutodetectedAsText || wasAutodetectedAsBinary) {
      file.putUserData(DETECTED_FROM_CONTENT_FILE_TYPE_KEY,null);
      return;
    }
  }
  file.putUserData(DETECTED_FROM_CONTENT_FILE_TYPE_KEY,fileType);
}
