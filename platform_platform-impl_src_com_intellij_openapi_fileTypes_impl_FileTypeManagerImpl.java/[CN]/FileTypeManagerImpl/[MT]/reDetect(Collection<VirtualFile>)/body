{
  final List<VirtualFile> changed=new ArrayList<VirtualFile>();
  for (  VirtualFile file : files) {
    if (wasAutoDetectedBefore(file) && isDetectable(file)) {
      FileType before=file.getFileType();
      FileType after=detectFromContent(file);
      if (before != after) {
        changed.add(file);
        LOG.debug(file + " type was re-detected. Was: " + before+ "; now: "+ after);
      }
    }
  }
  if (!changed.isEmpty()) {
    ApplicationManager.getApplication().invokeLater(new Runnable(){
      @Override public void run(){
        FileContentUtilCore.reparseFiles(changed);
      }
    }
,ApplicationManager.getApplication().getDisposed());
  }
}
