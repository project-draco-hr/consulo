{
  final Editor editor=consoleView.myEditor;
  if (IncrementalSearchHandler.isHintVisible(editor)) {
    getDefaultActionHandler().execute(editor,context);
    return;
  }
  final Document document=editor.getDocument();
  final int length=document.getTextLength();
  if (length == 0) {
    return;
  }
synchronized (consoleView.LOCK) {
    if (consoleView.myTokens.isEmpty())     return;
    final TokenInfo info=consoleView.myTokens.get(consoleView.myTokens.size() - 1);
    if (info.contentType != ConsoleViewContentType.USER_INPUT)     return;
    if (consoleView.myDeferredUserInput.length() == 0)     return;
    consoleView.myDeferredUserInput.setLength(consoleView.myDeferredUserInput.length() - 1);
    info.endOffset-=1;
    if (info.startOffset == info.endOffset) {
      consoleView.myTokens.remove(consoleView.myTokens.size() - 1);
    }
    consoleView.myContentSize--;
  }
  ApplicationManager.getApplication().runWriteAction(new DocumentRunnable(document,consoleView.myProject){
    public void run(){
      document.deleteString(length - 1,length);
      editor.getCaretModel().moveToOffset(length - 1);
      editor.getScrollingModel().scrollToCaret(ScrollType.RELATIVE);
      editor.getSelectionModel().removeSelection();
    }
  }
);
}
