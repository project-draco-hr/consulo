{
  assertIsDispatchThread();
  final Document document;
synchronized (LOCK) {
    myContentSize=0;
    if (USE_CYCLIC_BUFFER) {
      myDeferredOutput=new StringBuffer(Math.min(myDeferredOutput.length(),CYCLIC_BUFFER_SIZE));
    }
 else {
      myDeferredOutput=new StringBuffer();
    }
    myDeferredTypes.clear();
    myDeferredUserInput=new StringBuffer();
    myHyperlinks.clear();
    myTokens.clear();
    if (myEditor == null)     return;
    myEditor.getMarkupModel().removeAllHighlighters();
    document=myEditor.getDocument();
  }
  ApplicationManager.getApplication().runWriteAction(new DocumentRunnable(document,myProject){
    public void run(){
      CommandProcessor.getInstance().executeCommand(myProject,new Runnable(){
        public void run(){
          document.deleteString(0,document.getTextLength());
        }
      }
,null,document);
    }
  }
);
}
