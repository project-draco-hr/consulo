{
  final ArrayList<Block> result=new ArrayList<Block>();
  ArrayList<Block> elementsExceptKeyword=new ArrayList<Block>();
  myChildAlignment=createChildAlignment();
  myChildIndent=Indent.getContinuationIndent(myIndentSettings.USE_RELATIVE_INDENTS);
  myUseChildAttributes=true;
  Wrap childWrap=createChildWrap();
  ASTNode child=myNode.getFirstChildNode();
  Alignment alignment=alignList() ? Alignment.createAlignment() : null;
  while (child != null) {
    if (!FormatterUtil.containsWhiteSpacesOnly(child) && child.getTextLength() > 0) {
      if (ElementType.KEYWORD_BIT_SET.contains(child.getElementType())) {
        if (!elementsExceptKeyword.isEmpty()) {
          result.add(new SyntheticCodeBlock(elementsExceptKeyword,null,mySettings,Indent.getNoneIndent(),null));
          elementsExceptKeyword=new ArrayList<Block>();
        }
        result.add(createJavaBlock(child,mySettings,myChildIndent,arrangeChildWrap(child,childWrap),alignment));
      }
 else {
        if (myAlignmentStrategy != null) {
          Alignment candidate=myAlignmentStrategy.getAlignment(child.getElementType());
          if (candidate != null) {
            alignment=myChildAlignment=candidate;
          }
        }
        processChild(elementsExceptKeyword,child,myChildAlignment,childWrap,myChildIndent);
      }
    }
    child=child.getTreeNext();
  }
  if (!elementsExceptKeyword.isEmpty()) {
    result.add(new SyntheticCodeBlock(elementsExceptKeyword,alignment,mySettings,Indent.getNoneIndent(),null));
  }
  return result;
}
