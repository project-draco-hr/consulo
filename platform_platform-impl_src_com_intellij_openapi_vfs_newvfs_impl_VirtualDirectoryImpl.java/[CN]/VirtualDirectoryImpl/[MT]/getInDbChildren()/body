{
  if (myChildren instanceof VirtualFile[]) {
    return Arrays.asList((VirtualFile[])myChildren);
  }
  if (!ourPersistence.wereChildrenAccessed(this)) {
    return Collections.emptyList();
  }
  if (ourPersistence.areChildrenLoaded(this)) {
    return Arrays.asList(getChildren());
  }
  final String[] names=ourPersistence.listPersisted(this);
  for (  String name : names) {
    findChild(name,false,false);
  }
  return new ArrayList<VirtualFile>(ensureAsMap().values());
}
