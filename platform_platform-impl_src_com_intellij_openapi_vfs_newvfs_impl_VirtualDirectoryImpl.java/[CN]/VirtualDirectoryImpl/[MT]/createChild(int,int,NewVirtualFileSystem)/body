{
  VirtualFileSystemEntry child;
  final int attributes=ourPersistence.getFileAttributes(id);
  if (PersistentFS.isDirectory(attributes)) {
    child=new VirtualDirectoryImpl(nameId,this,delegate,id,attributes);
  }
 else {
    child=new VirtualFileImpl(nameId,this,id,attributes);
    assertAccessInTests(child,delegate);
  }
  if (delegate.markNewFilesAsDirty()) {
    child.markDirty();
  }
  return child;
}
