{
  final VirtualFileSystemEntry child;
  final NewVirtualFileSystem fs=getFileSystem();
  if (PersistentFS.isDirectory(id)) {
    child=ALT_SYMLINK_HANDLING && PersistentFS.isSymLink(id) ? new SymlinkDirectory(name,this,fs,id) : new VirtualDirectoryImpl(name,this,fs,id);
  }
 else {
    child=new VirtualFileImpl(name,this,id);
    assertAccessInTests(child);
  }
  if (fs.markNewFilesAsDirty()) {
    child.markDirty();
  }
  return child;
}
