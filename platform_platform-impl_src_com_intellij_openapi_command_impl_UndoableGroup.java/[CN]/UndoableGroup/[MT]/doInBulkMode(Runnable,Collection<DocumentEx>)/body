{
  Runnable runnable=action;
  for (  final DocumentEx document : documents) {
    final Runnable oldRunnable=runnable;
    runnable=new Runnable(){
      @Override public void run(){
        doInBulkMode(oldRunnable,document);
      }
    }
;
  }
  runnable.run();
}
