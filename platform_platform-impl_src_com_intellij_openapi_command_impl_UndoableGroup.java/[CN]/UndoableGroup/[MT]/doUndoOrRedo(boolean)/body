{
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    public void run(){
      try {
        for (        UndoableAction each : isUndo ? ContainerUtil.iterateBackward(myActions) : myActions) {
          if (isUndo) {
            each.undo();
          }
 else {
            each.redo();
          }
        }
      }
 catch (      UnexpectedUndoException e) {
        reportUndoProblem(e,isUndo);
      }
    }
  }
);
  commitAllDocuments();
}
