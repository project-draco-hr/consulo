{
  LocalHistoryAction action;
  if (myProject != null && isGlobal()) {
    String actionName=CommonBundle.message(isUndo ? "local.vcs.action.name.undo.command" : "local.vcs.action.name.redo.command",myCommandName);
    action=LocalHistory.getInstance().startAction(actionName);
  }
 else {
    action=LocalHistoryAction.NULL;
  }
  try {
    doUndoOrRedo(isUndo);
  }
  finally {
    action.finish();
  }
}
