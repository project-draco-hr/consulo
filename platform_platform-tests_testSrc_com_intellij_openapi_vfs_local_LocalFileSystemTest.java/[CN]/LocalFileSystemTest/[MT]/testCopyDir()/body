{
  File fromDir=createTempDirectory();
  File toDir=createTempDirectory();
  VirtualFile fromVDir=myFS.findFileByPath(fromDir.getPath().replace(File.separatorChar,'/'));
  VirtualFile toVDir=myFS.findFileByPath(toDir.getPath().replace(File.separatorChar,'/'));
  assertNotNull(fromVDir);
  assertNotNull(toVDir);
  final VirtualFile dirToCopy=fromVDir.createChildDirectory(this,"dir");
  final VirtualFile file=dirToCopy.createChildData(this,"temp_file");
  file.setBinaryContent(new byte[]{0,1,2,3});
  final String newName="dir";
  final VirtualFile dirCopy=dirToCopy.copy(this,toVDir,newName);
  assertEquals(newName,dirCopy.getName());
  PlatformTestUtil.assertDirectoriesEqual(toVDir,fromVDir);
}
