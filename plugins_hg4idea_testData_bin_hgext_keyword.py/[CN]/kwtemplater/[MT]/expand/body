def expand(self, path, node, data):
    'Returns data with keywords expanded.'
    if ((not self.restrict) and self.match(path) and (not util.binary(data))):
        ctx = self.repo.filectx(path, fileid=node).changectx()
        return self.substitute(data, path, ctx, self.re_kw.sub)
    return data
