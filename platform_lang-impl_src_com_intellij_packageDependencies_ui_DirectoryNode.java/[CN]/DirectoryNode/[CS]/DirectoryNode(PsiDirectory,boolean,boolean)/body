{
  super(aDirectory.getProject());
  myDirectory=aDirectory;
  VirtualFile directory=myDirectory.getVirtualFile();
  final ProjectFileIndex index=ProjectRootManager.getInstance(myDirectory.getProject()).getFileIndex();
  String dirName=aDirectory.getName();
  if (showFQName) {
    final VirtualFile contentRoot=index.getContentRootForFile(directory);
    if (contentRoot != null) {
      if (directory == contentRoot) {
        myFQName=dirName;
      }
 else {
        final VirtualFile sourceRoot=index.getSourceRootForFile(directory);
        if (directory == sourceRoot) {
          myFQName=dirName;
        }
 else         if (sourceRoot != null) {
          myFQName=VfsUtil.getRelativePath(directory,sourceRoot,'/');
        }
 else {
          myFQName=VfsUtil.getRelativePath(directory,contentRoot,'/');
        }
      }
    }
 else {
      myFQName=FilePatternPackageSet.getLibRelativePath(directory,index);
    }
    dirName=myFQName;
  }
  myDirName=dirName;
  myCompactPackages=compactPackages;
}
