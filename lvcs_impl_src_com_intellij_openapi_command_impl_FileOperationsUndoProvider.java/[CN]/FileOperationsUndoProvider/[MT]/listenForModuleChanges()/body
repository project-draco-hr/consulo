{
  myBusConnection.subscribe(ProjectTopics.PROJECT_ROOTS,new ModuleRootListener(){
    public void beforeRootsChange(    final ModuleRootEvent event){
    }
    public void rootsChanged(    final ModuleRootEvent event){
      if (!event.isCausedByDumbnessChange()) {
        ((UndoManagerImpl)UndoManager.getInstance(myProject)).invalidateAllComplexCommands();
      }
    }
  }
);
}
