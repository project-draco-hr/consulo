{
  myActionManager=actionManager;
  myTimerListener=new MyTimerListener();
  myVisibleActions=new ArrayList<AnAction>();
  myNewVisibleActions=new ArrayList<AnAction>();
  myPresentationFactory=new MenuItemPresentationFactory();
  myDataManager=dataManager;
  if (WindowManagerImpl.isFloatingMenuBarSupported()) {
    myAnimator=new MyAnimator();
    Toolkit.getDefaultToolkit().addAWTEventListener(new MyAWTEventListener(),AWTEvent.MOUSE_MOTION_EVENT_MASK | AWTEvent.MOUSE_EVENT_MASK);
    myActivationWatcher=new Timer(100,new MyActionListener());
    myClockPanel=new ClockPanel();
    add(myClockPanel);
    addPropertyChangeListener(WindowManagerImpl.FULL_SCREEN,new PropertyChangeListener(){
      @Override public void propertyChange(      PropertyChangeEvent evt){
        updateState();
      }
    }
);
    addMouseListener(new MyMouseListener());
  }
 else {
    myAnimator=null;
    myActivationWatcher=null;
    myClockPanel=null;
  }
}
