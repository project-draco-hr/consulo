{
  myNewVisibleActions.clear();
  if (!myDisabled) {
    DataContext dataContext=((DataManagerImpl)myDataManager).getDataContextTest(this);
    expandActionGroup(dataContext,myNewVisibleActions,myActionManager);
  }
  if (!myNewVisibleActions.equals(myVisibleActions)) {
    final boolean changeBarVisibility=myNewVisibleActions.isEmpty() || myVisibleActions.isEmpty();
    final List<AnAction> temp=myVisibleActions;
    myVisibleActions=myNewVisibleActions;
    myNewVisibleActions=temp;
    removeAll();
    final boolean enableMnemonics=!UISettings.getInstance().DISABLE_MNEMONICS;
    for (    final AnAction action : myVisibleActions) {
      add(new ActionMenu(null,ActionPlaces.MAIN_MENU,(ActionGroup)action,myPresentationFactory,enableMnemonics,true));
    }
    fixMenuBackground();
    updateMnemonicsVisibility();
    if (myClockPanel != null) {
      add(myClockPanel);
    }
    validate();
    if (changeBarVisibility) {
      invalidate();
      final JFrame frame=(JFrame)SwingUtilities.getAncestorOfClass(JFrame.class,this);
      if (frame != null) {
        frame.validate();
      }
    }
  }
}
