{
  context.addBuildListener(new BuildListener(){
    @Override public void filesGenerated(    Collection<Pair<String,String>> paths){
      BuildFSState fsState=context.getProjectDescriptor().fsState;
      ArtifactRootsIndex rootsIndex=context.getProjectDescriptor().getArtifactRootsIndex();
      for (      Pair<String,String> pair : paths) {
        File file=new File(pair.getFirst(),pair.getSecond());
        for (        ArtifactRootDescriptor descriptor : rootsIndex.getDescriptors(file)) {
          fsState.markRecompile(descriptor,FileUtil.toSystemIndependentName(file.getAbsolutePath()));
        }
      }
    }
    @Override public void filesDeleted(    Collection<String> paths){
      BuildFSState state=context.getProjectDescriptor().fsState;
      ArtifactRootsIndex index=context.getProjectDescriptor().getArtifactRootsIndex();
      for (      String path : paths) {
        File file=new File(FileUtil.toSystemDependentName(path));
        for (        ArtifactRootDescriptor descriptor : index.getDescriptors(file)) {
          state.registerDeleted(descriptor.getArtifactName(),path);
        }
      }
    }
  }
);
}
