{
  final boolean isRaw=PsiUtil.isRawSubstitutor(method,substitutor);
  final PsiTypeParameterList typeParameterList=method.getTypeParameterList();
  PsiTypeParameter[] methodTypeParameters=typeParameterList != null ? typeParameterList.getTypeParameters() : PsiTypeParameter.EMPTY_ARRAY;
  final PsiParameter[] parameters=method.getParameterList().getParameters();
  PsiType[] parameterTypes=new PsiType[parameters.length];
  for (int i=0; i < parameterTypes.length; i++) {
    parameterTypes[i]=parameters[i].getType();
  }
  if (isRaw) {
    for (int i=0; i < methodTypeParameters.length; i++) {
      substitutor=substitutor.put(methodTypeParameters[i],null);
    }
    methodTypeParameters=PsiTypeParameter.EMPTY_ARRAY;
    for (int i=0; i < parameterTypes.length; i++) {
      parameterTypes[i]=TypeConversionUtil.erasure(parameterTypes[i]);
    }
  }
  return new MethodSignatureBackedByPsiMethod(method,substitutor,isRaw,parameterTypes,methodTypeParameters);
}
