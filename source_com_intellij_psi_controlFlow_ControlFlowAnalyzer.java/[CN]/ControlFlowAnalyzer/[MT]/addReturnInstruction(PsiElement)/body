{
  BranchingInstruction instruction;
  final PsiElement finallyBlock=findEnclosingFinallyBlockElement(statement,null);
  final int finallyStartOffset=finallyBlock == null ? -1 : myCurrentFlow.getStartOffset(finallyBlock);
  if (finallyBlock != null && finallyStartOffset != -1) {
    instruction=new GoToInstruction(2,ControlFlow.JUMP_ROLE_GOTO_END,true);
    myCurrentFlow.addInstruction(instruction);
    addElementOffsetLater(finallyBlock,false);
  }
 else {
    instruction=new GoToInstruction(0,ControlFlow.JUMP_ROLE_GOTO_END,true);
    myCurrentFlow.addInstruction(instruction);
    if (myFinallyBlocks.isEmpty()) {
      addElementOffsetLater(myCodeFragment,false);
    }
 else {
      instruction.offset=-4;
      addElementOffsetLater(myFinallyBlocks.get(myFinallyBlocks.size() - 1),true);
    }
  }
}
