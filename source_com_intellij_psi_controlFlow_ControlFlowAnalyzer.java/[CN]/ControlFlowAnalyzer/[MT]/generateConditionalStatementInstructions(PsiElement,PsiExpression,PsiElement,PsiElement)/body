{
  if (thenBranch == null) {
    myStartStatementStack.pushStatement(statement,false);
  }
 else {
    myStartStatementStack.pushStatement(thenBranch,true);
  }
  if (elseBranch == null)   myEndStatementStack.pushStatement(statement,false);
 else   myEndStatementStack.pushStatement(elseBranch,true);
  myEndJumpRoles.add(elseBranch == null ? ControlFlow.JUMP_ROLE_GOTO_END : ControlFlow.JUMP_ROLE_GOTO_ELSE);
  myStartJumpRoles.add(thenBranch == null ? ControlFlow.JUMP_ROLE_GOTO_END : ControlFlow.JUMP_ROLE_GOTO_THEN);
  if (conditionExpression != null) {
    conditionExpression.accept(this);
  }
  boolean generateElseFlow=true;
  boolean generateThenFlow=true;
  boolean generateConditionalJump=true;
  if (myEvaluateConstantIfConfition) {
    final Object value=statement.getManager().getConstantEvaluationHelper().computeConstantExpression(conditionExpression);
    if (value instanceof Boolean) {
      boolean condition=((Boolean)value).booleanValue();
      generateThenFlow=condition;
      generateElseFlow=!condition;
      generateConditionalJump=false;
      myCurrentFlow.setConstantConditionOccurred(true);
    }
  }
  if (generateConditionalJump) {
    Instruction instruction=new ConditionalGoToInstruction(0,elseBranch == null ? ControlFlow.JUMP_ROLE_GOTO_END : ControlFlow.JUMP_ROLE_GOTO_ELSE);
    myCurrentFlow.addInstruction(instruction);
    if (elseBranch != null) {
      addElementOffsetLater(elseBranch,true);
    }
 else {
      addElementOffsetLater(statement,false);
    }
  }
  if (thenBranch != null && generateThenFlow) {
    thenBranch.accept(this);
  }
  if (elseBranch != null && generateElseFlow) {
    if (generateThenFlow) {
      Instruction instruction=new GoToInstruction(0);
      myCurrentFlow.addInstruction(instruction);
      addElementOffsetLater(statement,false);
    }
    elseBranch.accept(this);
  }
  myStartJumpRoles.remove(myStartJumpRoles.size() - 1);
  myEndJumpRoles.remove(myEndJumpRoles.size() - 1);
  myStartStatementStack.popStatement();
  myEndStatementStack.popStatement();
}
