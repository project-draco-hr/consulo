{
  final HashSet<Library> libraries=new HashSet<Library>();
  libraries.addAll(Arrays.asList(LibraryTablesRegistrar.getInstance().getLibraryTable().getLibraries()));
  libraries.addAll(Arrays.asList(LibraryTablesRegistrar.getInstance().getLibraryTable(context.getProject()).getLibraries()));
  ArtifactUtil.processPackagingElements(artifact,LIBRARY_ELEMENT_TYPE,new Processor<LibraryPackagingElement>(){
    public boolean process(    LibraryPackagingElement libraryPackagingElement){
      libraries.remove(libraryPackagingElement.findLibrary(context));
      return true;
    }
  }
,context,true);
  return new ArrayList<Library>(libraries);
}
