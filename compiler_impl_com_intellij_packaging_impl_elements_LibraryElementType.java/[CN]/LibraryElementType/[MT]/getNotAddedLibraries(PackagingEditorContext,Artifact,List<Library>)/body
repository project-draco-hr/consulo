{
  final Set<VirtualFile> roots=new HashSet<VirtualFile>();
  ArtifactUtil.processPackagingElements(artifact,PackagingElementFactoryImpl.FILE_COPY_ELEMENT_TYPE,new Processor<FileCopyPackagingElement>(){
    public boolean process(    FileCopyPackagingElement fileCopyPackagingElement){
      final String url=VfsUtil.getUrlForLibraryRoot(new File(FileUtil.toSystemDependentName(fileCopyPackagingElement.getFilePath())));
      final VirtualFile root=VirtualFileManager.getInstance().findFileByUrl(url);
      if (root != null) {
        roots.add(root);
      }
      return true;
    }
  }
,context,true);
  final List<Library> result=new ArrayList<Library>();
  for (  Library library : librariesList) {
    if (!roots.containsAll(Arrays.asList(library.getFiles(OrderRootType.CLASSES)))) {
      result.add(library);
    }
  }
  return result;
}
