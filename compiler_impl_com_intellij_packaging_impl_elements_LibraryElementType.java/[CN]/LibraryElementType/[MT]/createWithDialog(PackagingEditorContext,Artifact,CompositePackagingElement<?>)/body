{
  List<Library> libraries=new ArrayList<Library>();
  libraries.addAll(Arrays.asList(LibraryTablesRegistrar.getInstance().getLibraryTable().getLibraries()));
  libraries.addAll(Arrays.asList(LibraryTablesRegistrar.getInstance().getLibraryTable(context.getProject()).getLibraries()));
  ChooseLibrariesDialog dialog=new ChooseLibrariesDialog(context.getProject(),getNotAddedLibraries(context,artifact,libraries),ProjectBundle.message("dialog.title.packaging.choose.library"),"");
  dialog.show();
  final List<Library> selected=dialog.getChosenElements();
  final List<LibraryPackagingElement> elements=new ArrayList<LibraryPackagingElement>();
  if (dialog.isOK()) {
    for (    Library library : selected) {
      elements.add(new LibraryPackagingElement(library.getTable().getTableLevel(),library.getName()));
    }
  }
  return elements;
}
