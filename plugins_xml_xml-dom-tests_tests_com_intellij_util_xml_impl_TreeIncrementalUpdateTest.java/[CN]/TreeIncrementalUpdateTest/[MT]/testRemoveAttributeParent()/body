{
  final XmlFile file=(XmlFile)createFile("file.xml","<?xml version='1.0' encoding='UTF-8'?>\n" + "<!DOCTYPE ejb-jar PUBLIC \"-//Sun Microsystems, Inc.//DTD Enterprise JavaBeans 2.0//EN\" \"http://java.sun.com/dtd/ejb-jar_2_0.dtd\">\n" + "<a>\n"+ " <child-element xxx=\"239\"/>\n"+ "</a>");
  final DomFileElementImpl<MyElement> fileElement=getDomManager().getFileElement(file,MyElement.class,"a");
  myCallRegistry.clear();
  final MyElement rootElement=fileElement.getRootElement();
  final MyElement oldLeaf=rootElement.getChildElements().get(0);
  final GenericAttributeValue<String> xxx=oldLeaf.getXxx();
  final XmlTag oldLeafTag=oldLeaf.getXmlTag();
  new WriteCommandAction(getProject()){
    @Override protected void run(    Result result) throws Throwable {
      oldLeafTag.delete();
    }
  }
.execute();
  assertFalse(oldLeaf.isValid());
  assertFalse(xxx.isValid());
}
