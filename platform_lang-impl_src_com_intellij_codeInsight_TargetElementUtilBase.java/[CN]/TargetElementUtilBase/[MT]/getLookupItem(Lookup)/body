{
  LookupElement item=activeLookup.getCurrentItem();
  if (item == null)   return null;
  Object o=item.getObject();
  if (o instanceof PsiElement) {
    PsiElement element=(PsiElement)o;
    if (!(element instanceof PsiDirectoryContainer)) {
      if (!isValidElement(element))       return null;
    }
    return element;
  }
 else   if (o instanceof LookupValueWithPsiElement) {
    final PsiElement element=((LookupValueWithPsiElement)o).getElement();
    if (element != null && isValidElement(element))     return element;
  }
  return null;
}
