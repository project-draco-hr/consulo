{
  PsiClassType.ClassResolveResult classResolveResult=type.resolveGenerics();
  PsiClass aClass=classResolveResult.getElement();
  if (aClass == null) {
    return JavaResolveResult.EMPTY_ARRAY;
  }
  final MethodResolverProcessor processor;
  PsiSubstitutor substitutor=classResolveResult.getSubstitutor();
  if (argumentList.getParent() instanceof PsiAnonymousClass) {
    final PsiAnonymousClass anonymous=(PsiAnonymousClass)argumentList.getParent();
    processor=new MethodResolverProcessor(anonymous,argumentList,place);
    aClass=anonymous.getBaseClassType().resolve();
    if (aClass == null)     return JavaResolveResult.EMPTY_ARRAY;
    substitutor=substitutor.putAll(TypeConversionUtil.getSuperClassSubstitutor(aClass,anonymous,substitutor));
  }
 else {
    final PsiType alreadyThere=OUR_CONSTRUCTORS.get().put(argumentList,type);
    try {
      processor=new MethodResolverProcessor(aClass,argumentList,place);
    }
  finally {
      if (alreadyThere == null)       OUR_CONSTRUCTORS.get().remove(argumentList);
    }
  }
  ResolveState state=ResolveState.initial().put(PsiSubstitutor.KEY,substitutor);
  for (  PsiMethod constructor : aClass.getConstructors()) {
    if (!processor.execute(constructor,state))     break;
  }
  return processor.getResult();
}
