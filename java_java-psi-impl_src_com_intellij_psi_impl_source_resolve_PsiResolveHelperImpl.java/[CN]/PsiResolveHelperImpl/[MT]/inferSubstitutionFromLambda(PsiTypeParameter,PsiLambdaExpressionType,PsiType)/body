{
  final PsiLambdaExpression lambdaExpression=arg.getExpression();
  if (PsiUtil.getLanguageLevel(lambdaExpression).isAtLeast(LanguageLevel.JDK_1_8)) {
    final PsiElement parent=skipParenthesizedExprUp(lambdaExpression.getParent());
    if (parent instanceof PsiExpressionList) {
      final PsiExpressionList expressionList=(PsiExpressionList)parent;
      final Map<PsiElement,PsiMethod> methodMap=MethodCandidateInfo.CURRENT_CANDIDATE.get();
      final PsiMethod method=methodMap != null ? methodMap.get(expressionList) : null;
      if (method != null) {
        final int i=LambdaUtil.getLambdaIdx(expressionList,lambdaExpression);
        if (i < 0)         return null;
        final PsiParameter[] parameters=method.getParameterList().getParameters();
        if (parameters.length <= i)         return null;
        return inferConstraintFromFunctionalInterfaceMethod(typeParam,lambdaExpression,parameters[i].getType(),lowerBound);
      }
    }
 else {
      return inferConstraintFromFunctionalInterfaceMethod(typeParam,lambdaExpression,lambdaExpression.getFunctionalInterfaceType(),lowerBound);
    }
  }
  return null;
}
