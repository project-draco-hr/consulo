{
  TestFrameworkDescriptor descriptor=findDescriptor(targetClass);
  String templateName=FileUtil.getNameWithoutExtension(descriptor.getTestMethodFileTemplateDescriptor().getFileName());
  FileTemplate fileTemplate=FileTemplateManager.getInstance().getTemplate(templateName);
  Template template=TemplateManager.getInstance(project).createTemplate("","");
  String templateText=fileTemplate.getText();
  int index=templateText.indexOf("${NAME}");
  if (index == -1) {
    template.addTextSegment(templateText);
  }
 else {
    String nameString="Name";
    if (index > 0) {
      if (Character.isWhitespace(templateText.charAt(index - 1))) {
        nameString=nameString.toLowerCase();
      }
    }
    template.addTextSegment(templateText.substring(0,index));
    Expression name=new ConstantNode(nameString);
    template.addVariable("",name,name,true);
    template.addTextSegment(templateText.substring(index + "${NAME}".length(),templateText.length()));
  }
  return template;
}
