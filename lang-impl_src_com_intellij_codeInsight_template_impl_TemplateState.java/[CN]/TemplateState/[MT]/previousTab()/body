{
  if (isFinished()) {
    return;
  }
  myDocumentChangesTerminateTemplate=false;
  int previousVariableNumber=getPreviousVariableNumber(myCurrentVariableNumber);
  if (previousVariableNumber >= 0) {
    focusCurrentHighlighter(false);
    calcResults(false);
    doReformat();
    setCurrentVariableNumber(previousVariableNumber);
    focusCurrentExpression();
  }
}
