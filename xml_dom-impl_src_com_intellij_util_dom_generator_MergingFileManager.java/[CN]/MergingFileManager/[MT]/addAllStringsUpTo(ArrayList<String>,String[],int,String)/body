{
  String str;
  do {
    str=startIdx < lines.length ? lines[startIdx] : upTo;
    if (merged != null)     merged.add(str);
    startIdx++;
  }
 while (!str.trim().endsWith(upTo) && startIdx < lines.length);
  return startIdx;
}
