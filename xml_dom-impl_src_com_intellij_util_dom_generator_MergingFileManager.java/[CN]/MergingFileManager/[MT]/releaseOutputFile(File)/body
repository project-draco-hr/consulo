{
  int idx=outFile.getName().indexOf(".tmp.");
  File target=outFile;
  if (idx > -1) {
    target=new File(outFile.getParentFile(),outFile.getName().substring(0,idx));
    String[] curLines=loadFile(outFile);
    String[] prevLines=loadFile(target);
    String[] mergedLines=mergeLines(curLines,prevLines);
    if (mergedLines != prevLines) {
      if (mergedLines == curLines) {
        if (target.exists() && !target.delete()) {
          Util.logerr("file replace failed: " + target);
          outFile.delete();
        }
 else {
          outFile.renameTo(target);
          Util.logwarn("file replaced: " + target);
        }
      }
 else {
        outFile.delete();
        if (target.exists() && !target.delete()) {
          Util.logerr("file replace failed: " + target);
        }
 else {
          writeFile(target,mergedLines);
          Util.logwarn("file merged: " + target);
        }
      }
    }
 else {
      outFile.delete();
    }
  }
  return target;
}
