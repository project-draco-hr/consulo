{
  final String key=getKeyText();
  Collection<Property> properties;
  if (myBundleName != null) {
    final PropertiesFile propertiesFile=I18nUtil.propertiesFileByBundleName(myElement,myBundleName);
    if (propertiesFile != null) {
      properties=propertiesFile.findPropertiesByKey(key);
    }
 else {
      properties=new ArrayList<Property>();
    }
  }
 else {
    properties=PropertiesUtil.findPropertiesByKey(getElement().getProject(),key);
  }
  final ResolveResult[] result=new ResolveResult[properties.size()];
  int i=0;
  for (  Property property : properties) {
    result[i++]=new PsiElementResolveResult(property);
  }
  return result;
}
