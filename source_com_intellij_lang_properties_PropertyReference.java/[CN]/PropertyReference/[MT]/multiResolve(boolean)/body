{
  final String key=getKeyText();
  Collection<Property> properties;
  if (myBundleName == null) {
    properties=PropertiesUtil.findPropertiesByKey(getElement().getProject(),key);
  }
 else {
    final List<PropertiesFile> propertiesFiles=I18nUtil.propertiesFilesByBundleName(myElement,myBundleName);
    properties=new ArrayList<Property>();
    for (    PropertiesFile propertiesFile : propertiesFiles) {
      properties.addAll(propertiesFile.findPropertiesByKey(key));
    }
  }
  final ResolveResult[] result=new ResolveResult[properties.size()];
  int i=0;
  for (  Property property : properties) {
    result[i++]=new PsiElementResolveResult(property);
  }
  return result;
}
