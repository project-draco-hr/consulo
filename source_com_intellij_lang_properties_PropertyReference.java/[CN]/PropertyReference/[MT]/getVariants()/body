{
  Collection<VirtualFile> allPropertiesFiles=PropertiesFilesManager.getInstance().getAllPropertiesFiles();
  Set<Object> variants=new THashSet<Object>();
  if (myBundleName != null) {
    PropertiesFile propFile=I18nUtil.propertiesFileByBundleName(myElement,myBundleName);
    addVariantsFromFile(propFile,variants);
  }
 else {
    PsiManager psiManager=myElement.getManager();
    for (    VirtualFile file : allPropertiesFiles) {
      if (!file.isValid())       continue;
      PropertiesFile propertiesFile=(PropertiesFile)psiManager.findFile(file);
      addVariantsFromFile(propertiesFile,variants);
    }
  }
  return variants.toArray(new Object[variants.size()]);
}
