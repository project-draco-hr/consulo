{
  final PsiDirectory[] directories=aPackage.getDirectories();
  for (int i=0; i < directories.length; i++) {
    PsiDirectory directory=directories[i];
    if (VfsUtil.isAncestor(sourceRoot,directory.getVirtualFile(),false)) {
      return directory;
    }
  }
  String qNameToCreate=qNameToCreateInSourceRoot(aPackage,sourceRoot);
  final String[] shortNames=qNameToCreate.split("\\.");
  PsiDirectory current=aPackage.getManager().findDirectory(sourceRoot);
  LOG.assertTrue(current != null);
  for (int i=0; i < shortNames.length; i++) {
    String shortName=shortNames[i];
    PsiDirectory subdirectory=current.findSubdirectory(shortName);
    if (subdirectory == null) {
      subdirectory=current.createSubdirectory(shortName);
    }
    current=subdirectory;
  }
  return current;
}
