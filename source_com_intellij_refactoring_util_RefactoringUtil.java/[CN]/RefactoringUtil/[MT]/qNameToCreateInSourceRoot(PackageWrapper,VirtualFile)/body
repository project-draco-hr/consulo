{
  String targetQName=aPackage.getQualifiedName();
  String sourceRootPackage=ProjectRootManager.getInstance(aPackage.getManager().getProject()).getFileIndex().getPackageNameByDirectory(sourceRoot);
  if (sourceRootPackage == null || !targetQName.startsWith(sourceRootPackage)) {
    throw new IncorrectOperationException("Cannot create package '" + targetQName + "' in source folder "+ sourceRoot.getPresentableUrl());
  }
  String result=targetQName.substring(sourceRootPackage.length());
  if (StringUtil.startsWithChar(result,'.'))   result=result.substring(1);
  return result;
}
