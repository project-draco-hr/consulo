{
  Set<T> result=new HashSet<T>();
  final Set<T> vertices=graph.getVertices();
  boolean anyChanged;
  do {
    anyChanged=false;
    for (Iterator<T> iterator=vertices.iterator(); iterator.hasNext(); ) {
      T currentVertex=iterator.next();
      if (!result.contains(currentVertex)) {
        if (!initialRelation.value(currentVertex)) {
          Set<T> targets=graph.getTargets(currentVertex);
          for (Iterator<T> targetsIterator=targets.iterator(); targetsIterator.hasNext(); ) {
            T currentTarget=targetsIterator.next();
            if (result.contains(currentTarget) || initialRelation.value(currentTarget)) {
              result.add(currentVertex);
              anyChanged=true;
              break;
            }
          }
        }
 else {
          result.add(currentVertex);
        }
      }
    }
  }
 while (anyChanged);
  return result;
}
