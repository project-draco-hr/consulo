{
  final PsiManager manager=occurrence.getManager();
  final String fieldName=newField.getName();
  final PsiVariable psiVariable=manager.getResolveHelper().resolveReferencedVariable(fieldName,occurrence);
  final PsiElementFactory factory=manager.getElementFactory();
  if (psiVariable != null && psiVariable.equals(newField)) {
    return occurrence.replace(factory.createExpressionFromText(fieldName,null));
  }
 else {
    final PsiReferenceExpression ref=(PsiReferenceExpression)factory.createExpressionFromText("this." + fieldName,null);
    if (newField.hasModifierProperty(PsiModifier.STATIC)) {
      final PsiReferenceExpression referenceExpression=factory.createReferenceExpression(destinationClass);
      ref.getQualifierExpression().replace(referenceExpression);
    }
    return occurrence.replace(ref);
  }
}
