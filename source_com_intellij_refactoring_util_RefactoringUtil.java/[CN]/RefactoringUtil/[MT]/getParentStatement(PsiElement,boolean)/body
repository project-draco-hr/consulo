{
  PsiElement parent=place;
  while (true) {
    if (parent instanceof PsiStatement)     break;
    if (parent instanceof JspExpression)     break;
    parent=parent.getParent();
    if (parent == null)     return null;
  }
  PsiElement parentStatement=parent;
  parent=parentStatement instanceof PsiStatement ? parentStatement : parentStatement.getParent();
  while (parent instanceof PsiStatement) {
    if (!skipScopingStatements && ((parent instanceof PsiForStatement && parentStatement == ((PsiForStatement)parent).getBody()) || (parent instanceof PsiForeachStatement && parentStatement == ((PsiForeachStatement)parent).getBody()) || (parent instanceof PsiWhileStatement && parentStatement == ((PsiWhileStatement)parent).getBody())|| (parent instanceof PsiIfStatement && (parentStatement == ((PsiIfStatement)parent).getThenBranch() || parentStatement == ((PsiIfStatement)parent).getElseBranch())))) {
      return parentStatement;
    }
    parentStatement=parent;
    parent=parent.getParent();
  }
  return parentStatement;
}
