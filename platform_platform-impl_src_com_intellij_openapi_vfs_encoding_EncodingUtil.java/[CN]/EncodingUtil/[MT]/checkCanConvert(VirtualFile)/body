{
  if (virtualFile.isDirectory()) {
    return "file is a directory";
  }
  String failReason=null;
  Charset charsetFromContent=((EncodingManagerImpl)EncodingManager.getInstance()).computeCharsetFromContent(virtualFile);
  if (charsetFromContent != null) {
    failReason="Encoding is hard-coded in the text";
  }
 else {
    Pair<Charset,String> check=checkHardcodedCharsetFileType(virtualFile);
    if (check.second != null) {
      failReason=check.second;
    }
  }
  if (failReason != null) {
    return failReason;
  }
  return null;
}
