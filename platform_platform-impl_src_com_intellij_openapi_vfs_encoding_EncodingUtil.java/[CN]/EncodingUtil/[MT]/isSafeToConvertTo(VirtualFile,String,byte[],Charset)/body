{
  try {
    String lineSeparator=FileDocumentManager.getInstance().getLineSeparator(virtualFile,null);
    String textToSave=lineSeparator.equals("\n") ? text : StringUtil.convertLineSeparators(text,lineSeparator);
    Pair<Charset,byte[]> chosen=LoadTextUtil.chooseMostlyHarmlessCharset(virtualFile.getCharset(),charset,textToSave);
    byte[] saved=chosen.second;
    CharSequence textLoadedBack=LoadTextUtil.getTextByBinaryPresentation(saved,charset);
    return !text.equals(textLoadedBack.toString()) ? Magic8.NO_WAY : Arrays.equals(saved,bytesOnDisk) ? Magic8.ABSOLUTELY : Magic8.WELL_IF_YOU_INSIST;
  }
 catch (  UnsupportedOperationException e) {
    return Magic8.NO_WAY;
  }
}
