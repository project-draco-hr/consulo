{
  JpsJavaDependenciesEnumerator enumerator=JpsJavaExtensionService.dependencies(myModule).compileOnly();
  if (!isTests()) {
    enumerator.productionOnly();
  }
  final ArrayList<BuildTarget<?>> dependencies=new ArrayList<BuildTarget<?>>();
  enumerator.processModules(new Consumer<JpsModule>(){
    @Override public void consume(    JpsModule module){
      dependencies.add(new ModuleBuildTarget(module,myTargetType));
    }
  }
);
  if (isTests()) {
    dependencies.add(new ModuleBuildTarget(myModule,JavaModuleBuildTargetType.PRODUCTION));
  }
  dependencies.trimToSize();
  return dependencies;
}
