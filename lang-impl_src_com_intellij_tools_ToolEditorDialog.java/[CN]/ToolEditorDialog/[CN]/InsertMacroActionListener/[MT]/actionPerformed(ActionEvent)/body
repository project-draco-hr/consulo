{
  MacrosDialog dialog=new MacrosDialog(myProject);
  dialog.show();
  if (dialog.isOK() && dialog.getSelectedMacro() != null) {
    String macro=dialog.getSelectedMacro().getName();
    int position=myTextField.getCaretPosition();
    try {
      myTextField.getDocument().insertString(position,"$" + macro + "$",null);
      myTextField.setCaretPosition(position + macro.length() + 2);
    }
 catch (    BadLocationException ex) {
    }
    myTextField.requestFocus();
  }
}
