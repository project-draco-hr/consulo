{
  final MavenProjectsManager manager=MavenProjectsManager.getInstance(project);
  final MavenEmbedder e=EmbedderFactory.createEmbedderForExecute(MavenCore.getInstance(project).getState());
  try {
    MavenProgress.run(project,ProjectBundle.message("maven.downloading"),new MavenProgress.MavenTask(){
      public void run(      MavenProgress p) throws MavenException, CanceledException {
        new MavenArtifactDownloader(manager.getArtifactSettings(),e,p).download(project,manager.getExistingProjects(),true);
      }
    }
);
  }
  finally {
    EmbedderFactory.releaseEmbedder(e);
  }
  VirtualFileManager.getInstance().refresh(false);
}
