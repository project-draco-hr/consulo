{
  final Map<MavenId,Set<ArtifactRepository>> repositoryArtifacts=new TreeMap<MavenId,Set<ArtifactRepository>>();
  for (  MavenProject mavenProject : mavenProjects) {
    Collection<Artifact> artifacts=projectsManager.getArtifacts(mavenProject);
    if (artifacts != null) {
      final List remoteRepositories=mavenProject.getRemoteArtifactRepositories();
      for (      Artifact artifact : artifacts) {
        if (artifact.getType().equalsIgnoreCase(Constants.JAR_TYPE) && !artifact.getScope().equalsIgnoreCase(Artifact.SCOPE_SYSTEM)) {
          MavenId id=new MavenId(artifact);
          if (!mappedToModules.contains(id)) {
            Set<ArtifactRepository> repos=repositoryArtifacts.get(id);
            if (repos == null) {
              repos=new HashSet<ArtifactRepository>();
              repositoryArtifacts.put(id,repos);
            }
            repos.addAll(remoteRepositories);
          }
        }
      }
    }
  }
  return repositoryArtifacts;
}
