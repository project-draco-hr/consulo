{
  Map<MavenId,Set<ArtifactRepository>> result=new TreeMap<MavenId,Set<ArtifactRepository>>();
  for (  MavenProject mavenProject : mavenProjects) {
    Collection<Artifact> artifacts=mavenProject.getArtifacts();
    if (artifacts != null) {
      List remoteRepositories=mavenProject.getRemoteArtifactRepositories();
      for (      Artifact artifact : artifacts) {
        if (artifact.getType().equalsIgnoreCase(Constants.JAR_TYPE) && !artifact.getScope().equalsIgnoreCase(Artifact.SCOPE_SYSTEM)) {
          MavenId id=new MavenId(artifact);
          if (!mappedToModules.contains(id)) {
            Set<ArtifactRepository> repos=result.get(id);
            if (repos == null) {
              repos=new HashSet<ArtifactRepository>();
              result.put(id,repos);
            }
            repos.addAll(remoteRepositories);
          }
        }
      }
    }
  }
  return result;
}
