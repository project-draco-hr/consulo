{
  List<File> downloadedFiles=new ArrayList<File>();
  try {
    List<MavenExtraArtifactType> types=new ArrayList<MavenExtraArtifactType>(2);
    if (downloadSources)     types.add(MavenExtraArtifactType.SOURCES);
    if (downloadDocs)     types.add(MavenExtraArtifactType.DOCS);
    Map<MavenId,DownloadData> artifacts=collectArtifactsToDownload(types);
    download(artifacts,downloadedFiles);
  }
  finally {
    scheduleFilesRefresh(downloadedFiles);
  }
}
