{
  initVelocity();
  StringWriter stringWriter=new StringWriter();
  try {
    Velocity.evaluate(context,stringWriter,"",templateContent);
  }
 catch (  VelocityException e) {
    ApplicationManager.getApplication().invokeLater(new Runnable(){
      public void run(){
        Messages.showErrorDialog("Error parsing file template","Velocity Error");
      }
    }
);
  }
  return stringWriter.toString();
}
