{
  if (editor == null) {
    return;
  }
  LOG.debug("enter RearrangerActionHandler.execute()");
  final PsiFile psiFile=getFile(editor,context);
  if (psiFile == null) {
    return;
  }
  final Project project=PlatformDataKeys.PROJECT.getData(context);
  final Document document=editor.getDocument();
  LOG.debug("suggested tool window = " + WindowManager.getInstance().suggestParentWindow(project));
  LOG.debug("drag source image supported = " + DragSource.isDragImageSupported());
  if (!psiFile.getName().endsWith(".java")) {
    LOG.debug("not a .java file -- skipping " + psiFile.getName());
    return;
  }
  if (!psiFile.isWritable()) {
    LOG.debug("not a writable .java file -- skipping " + psiFile.getName());
    return;
  }
  rightMargin=editor.getSettings().getRightMargin(project);
  tabSize=editor.getSettings().getTabSize(project);
  LOG.debug("right margin=" + rightMargin + ", tabSize="+ tabSize);
  final Application application=ApplicationManager.getApplication();
  application.runWriteAction(new Runnable(){
    public void run(){
      final Rearranger rearranger=ServiceManager.getService(Rearranger.class);
      final RearrangerSettings settings=rearranger.getSettings();
      runWriteActionRearrangement(project,document,psiFile,settings);
    }
  }
);
}
