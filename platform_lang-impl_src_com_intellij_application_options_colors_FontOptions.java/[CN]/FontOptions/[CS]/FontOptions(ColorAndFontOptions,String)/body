{
  super(new VerticalFlowLayout(VerticalFlowLayout.TOP,true,false));
  Insets borderInsets=JBUI.insets(IdeBorderFactory.TITLED_BORDER_TOP_INSET,IdeBorderFactory.TITLED_BORDER_LEFT_INSET,0,IdeBorderFactory.TITLED_BORDER_RIGHT_INSET);
  setBorder(IdeBorderFactory.createTitledBorder(title,false,borderInsets));
  myOptions=options;
  add(myOnlyMonospacedCheckBox);
  JPanel primaryFontPanel=new JPanel(new HorizontalLayout(JBUI.scale(5)));
  primaryFontPanel.setBorder(JBUI.Borders.emptyLeft(20));
  add(primaryFontPanel);
  primaryFontPanel.add(LabeledComponent.left(myPrimaryCombo,ApplicationBundle.message("primary.font")));
  primaryFontPanel.add(LabeledComponent.left(myEditorFontSizeField,ApplicationBundle.message("editbox.font.size")));
  primaryFontPanel.add(LabeledComponent.left(myLineSpacingField,ApplicationBundle.message("editbox.line.spacing")));
  add(new JLabel(ApplicationBundle.message("label.fallback.fonts.list.description"),MessageType.INFO.getDefaultIcon(),SwingConstants.LEFT));
  JPanel secondFontPanel=new JPanel(new HorizontalLayout(JBUI.scale(5)));
  add(secondFontPanel);
  secondFontPanel.add(myUseSecondaryFontCheckbox);
  secondFontPanel.add(mySecondaryCombo);
  JPanel ligaturesPanel=new JPanel(new HorizontalLayout(JBUI.scale(5)));
  myEnableLigaturesCheckbox.setBorder(null);
  ligaturesPanel.add(myEnableLigaturesCheckbox);
  myLigaturesInfoLinkLabel=new LinkLabel<>(ApplicationBundle.message("ligatures.more.info"),null,new LinkListener<String>(){
    @Override public void linkSelected(    LinkLabel aSource,    String aLinkData){
      BrowserUtil.browse(HELP_URL);
    }
  }
);
  myLigaturesInfoLinkLabel.setBorder(JBUI.Borders.emptyLeft(5));
  ligaturesPanel.add(myLigaturesInfoLinkLabel);
  add(ligaturesPanel);
  myOnlyMonospacedCheckBox.setBorder(null);
  myUseSecondaryFontCheckbox.setBorder(null);
  mySecondaryCombo.setEnabled(false);
  myOnlyMonospacedCheckBox.setSelected(EditorColorsManager.getInstance().isUseOnlyMonospacedFonts());
  myOnlyMonospacedCheckBox.addActionListener(new ActionListener(){
    @Override public void actionPerformed(    ActionEvent e){
      EditorColorsManager.getInstance().setUseOnlyMonospacedFonts(myOnlyMonospacedCheckBox.isSelected());
      myPrimaryCombo.setMonospacedOnly(myOnlyMonospacedCheckBox.isSelected());
      mySecondaryCombo.setMonospacedOnly(myOnlyMonospacedCheckBox.isSelected());
    }
  }
);
  myPrimaryCombo.setMonospacedOnly(myOnlyMonospacedCheckBox.isSelected());
  myPrimaryCombo.setRenderer(RENDERER);
  mySecondaryCombo.setMonospacedOnly(myOnlyMonospacedCheckBox.isSelected());
  mySecondaryCombo.setRenderer(RENDERER);
  myUseSecondaryFontCheckbox.addActionListener(new ActionListener(){
    @Override public void actionPerformed(    ActionEvent e){
      mySecondaryCombo.setEnabled(myUseSecondaryFontCheckbox.isSelected());
      FontOptions.this.syncFontFamilies();
    }
  }
);
  ItemListener itemListener=new ItemListener(){
    @Override public void itemStateChanged(    ItemEvent e){
      if (e.getStateChange() == ItemEvent.SELECTED) {
        FontOptions.this.syncFontFamilies();
      }
    }
  }
;
  myPrimaryCombo.addItemListener(itemListener);
  mySecondaryCombo.addItemListener(itemListener);
  ActionListener actionListener=new ActionListener(){
    @Override public void actionPerformed(    ActionEvent e){
      FontOptions.this.syncFontFamilies();
    }
  }
;
  myPrimaryCombo.addActionListener(actionListener);
  mySecondaryCombo.addActionListener(actionListener);
  myEditorFontSizeField.getDocument().addDocumentListener(new DocumentAdapter(){
    @Override public void textChanged(    DocumentEvent event){
      if (myIsInSchemeChange || !SwingUtilities.isEventDispatchThread())       return;
      String selectedFont=myPrimaryCombo.getFontName();
      if (selectedFont != null) {
        FontPreferences fontPreferences=getFontPreferences();
        fontPreferences.register(selectedFont,getFontSizeFromField());
      }
      updateDescription(true);
    }
  }
);
  myEditorFontSizeField.addKeyListener(new KeyAdapter(){
    @Override public void keyPressed(    KeyEvent e){
      if (e.getKeyCode() != KeyEvent.VK_UP && e.getKeyCode() != KeyEvent.VK_DOWN)       return;
      boolean up=e.getKeyCode() == KeyEvent.VK_UP;
      try {
        int value=Integer.parseInt(myEditorFontSizeField.getText());
        value+=(up ? 1 : -1);
        value=Math.min(OptionsConstants.MAX_EDITOR_FONT_SIZE,Math.max(OptionsConstants.MIN_EDITOR_FONT_SIZE,value));
        myEditorFontSizeField.setText(String.valueOf(value));
      }
 catch (      NumberFormatException ignored) {
      }
    }
  }
);
  myLineSpacingField.getDocument().addDocumentListener(new DocumentAdapter(){
    @Override public void textChanged(    DocumentEvent event){
      if (myIsInSchemeChange)       return;
      float lineSpacing=getLineSpacingFromField();
      if (getLineSpacing() != lineSpacing) {
        setCurrentLineSpacing(lineSpacing);
      }
      updateDescription(true);
    }
  }
);
  myLineSpacingField.addKeyListener(new KeyAdapter(){
    @Override public void keyPressed(    KeyEvent e){
      if (e.getKeyCode() != KeyEvent.VK_UP && e.getKeyCode() != KeyEvent.VK_DOWN)       return;
      boolean up=e.getKeyCode() == KeyEvent.VK_UP;
      try {
        float value=Float.parseFloat(myLineSpacingField.getText());
        value+=(up ? 1 : -1) * .1F;
        value=Math.min(OptionsConstants.MAX_EDITOR_LINE_SPACING,Math.max(OptionsConstants.MIN_EDITOR_LINE_SPACING,value));
        myLineSpacingField.setText(String.format(Locale.ENGLISH,"%.1f",value));
      }
 catch (      NumberFormatException ignored) {
      }
    }
  }
);
  myEnableLigaturesCheckbox.addActionListener(new ActionListener(){
    @Override public void actionPerformed(    ActionEvent e){
      FontOptions.this.getFontPreferences().setUseLigatures(myEnableLigaturesCheckbox.isSelected());
    }
  }
);
}
