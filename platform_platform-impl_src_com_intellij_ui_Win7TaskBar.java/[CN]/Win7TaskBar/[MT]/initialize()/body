{
  if (ApplicationManager.getApplication().isUnitTestMode()) {
    return;
  }
  Ole32 ole32=Ole32.INSTANCE;
  ole32.CoInitializeEx(Pointer.NULL,0);
  Guid.GUID CLSID_TaskbarList=Ole32Util.getGUIDFromString("{56FDF344-FD6D-11d0-958A-006097C9A090}");
  Guid.GUID IID_ITaskbarList3=Ole32Util.getGUIDFromString("{EA1AFB91-9E28-4B86-90E9-9E9F8A5EEFAF}");
  PointerByReference p=new PointerByReference();
  WinNT.HRESULT hr=ole32.CoCreateInstance(CLSID_TaskbarList,Pointer.NULL,ObjBase.CLSCTX_ALL,IID_ITaskbarList3,p);
  if (!W32Errors.S_OK.equals(hr)) {
    LOG.error("Win7TaskBar CoCreateInstance(IID_ITaskbarList3) hResult: " + hr);
    ourInitialized=false;
    return;
  }
  myInterfacePointer=p.getValue();
  Pointer vTablePointer=myInterfacePointer.getPointer(0);
  Pointer[] vTable=new Pointer[TaskBarList_Methods];
  vTablePointer.read(0,vTable,0,vTable.length);
  mySetProgressValue=Function.getFunction(vTable[TaskBarList_SetProgressValue],Function.ALT_CONVENTION);
  mySetProgressState=Function.getFunction(vTable[TaskBarList_SetProgressState],Function.ALT_CONVENTION);
  mySetOverlayIcon=Function.getFunction(vTable[TaskBarList_SetOverlayIcon],Function.ALT_CONVENTION);
}
