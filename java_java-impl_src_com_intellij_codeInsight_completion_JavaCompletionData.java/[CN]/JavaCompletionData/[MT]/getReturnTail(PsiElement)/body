{
  PsiElement scope=position;
  while (true) {
    if (scope instanceof PsiFile || scope instanceof PsiClassInitializer) {
      return TailType.NONE;
    }
    if (scope instanceof PsiMethod) {
      final PsiMethod method=(PsiMethod)scope;
      if (method.isConstructor() || PsiType.VOID.equals(method.getReturnType())) {
        return TailType.SEMICOLON;
      }
      return TailType.INSERT_SPACE;
    }
    scope=scope.getParent();
  }
}
