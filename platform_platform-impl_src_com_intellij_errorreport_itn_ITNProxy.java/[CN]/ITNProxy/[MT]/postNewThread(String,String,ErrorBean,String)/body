{
  @NonNls List<Pair<String,String>> params=createParametersFor(login,password,error,compilationTimestamp,ApplicationManager.getApplication(),(ApplicationInfoEx)ApplicationInfo.getInstance(),ApplicationNamesInfo.getInstance(),UpdateSettings.getInstance());
  HttpURLConnection connection=post(new URL(WebServiceApi.ERROR_REPORTER_API.buildUrl("createReport")),join(params));
  int responseCode=connection.getResponseCode();
  if (responseCode != HttpURLConnection.HTTP_OK) {
    throw new InternalEAPException(DiagnosticBundle.message("error.http.result.code",responseCode));
  }
  String reply;
  InputStream is=new BufferedInputStream(connection.getInputStream());
  try {
    reply=readFrom(is);
  }
  finally {
    is.close();
  }
  if ("unauthorized".equals(reply)) {
    throw new NoSuchEAPUserException(login);
  }
  if (reply.startsWith("update ")) {
    throw new UpdateAvailableException(reply.substring(7));
  }
  if (reply.startsWith("message ")) {
    throw new InternalEAPException(reply.substring(8));
  }
  try {
    return Integer.valueOf(reply.trim()).intValue();
  }
 catch (  NumberFormatException ex) {
    throw new InternalEAPException(DiagnosticBundle.message("error.itn.returns.wrong.data"));
  }
}
