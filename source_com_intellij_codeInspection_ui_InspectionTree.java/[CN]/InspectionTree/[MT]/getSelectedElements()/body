{
  TreePath[] selectionPaths=getSelectionPaths();
  if (selectionPaths != null) {
    final InspectionTool selectedTool=getSelectedTool();
    if (selectedTool == null)     return EMPTY_ELEMENTS_ARRAY;
    Set<RefElement> result=new HashSet<RefElement>();
    for (    TreePath selectionPath : selectionPaths) {
      final InspectionTreeNode node=(InspectionTreeNode)selectionPath.getLastPathComponent();
      addElementsInNode(node,result);
    }
    return result.toArray(new RefElement[result.size()]);
  }
  return EMPTY_ELEMENTS_ARRAY;
}
