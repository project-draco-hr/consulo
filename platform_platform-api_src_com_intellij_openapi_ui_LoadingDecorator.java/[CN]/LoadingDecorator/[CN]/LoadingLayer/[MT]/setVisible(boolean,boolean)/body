{
  if (myVisible == visible)   return;
  if (myVisible && !visible && myCurrentAlpha != -1)   return;
  myVisible=visible;
  if (myVisible) {
    setVisible(myVisible);
    myCurrentAlpha=-1;
  }
  if (myVisible) {
    if (takeSnapshot && getWidth() > 0 && getHeight() > 0) {
      mySnapshot=new BufferedImage(getWidth(),getHeight(),BufferedImage.TYPE_INT_RGB);
      final Graphics2D g=mySnapshot.createGraphics();
      myPane.paint(g);
      final Component opaque=UIUtil.findNearestOpaque(this);
      mySnapshotBg=opaque != null ? opaque.getBackground() : UIUtil.getPanelBackgound();
      g.dispose();
    }
    myProgress.resume();
  }
 else {
    disposeSnapshot();
    myProgress.suspend();
    myFadeOutAnimator.reset();
    myFadeOutAnimator.resume();
  }
}
