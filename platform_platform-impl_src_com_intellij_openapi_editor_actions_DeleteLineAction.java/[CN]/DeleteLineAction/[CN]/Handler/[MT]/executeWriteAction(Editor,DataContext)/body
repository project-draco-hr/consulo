{
  CommandProcessor.getInstance().setCurrentCommandGroupId(EditorActionUtil.DELETE_COMMAND_GROUP);
  SelectionModel selectionModel=editor.getSelectionModel();
  if (selectionModel.hasSelection()) {
    Document document=editor.getDocument();
    int selectionStart=selectionModel.getSelectionStart();
    int selectionEnd=selectionModel.getSelectionEnd();
    selectionModel.removeSelection();
    int lineStartOffset=document.getLineStartOffset(document.getLineNumber(selectionStart));
    int nextLineStartOffset=Math.min(document.getTextLength(),document.getLineStartOffset(document.getLineNumber(selectionEnd) + 1));
    document.deleteString(lineStartOffset,nextLineStartOffset);
    return;
  }
  deleteLineAtCaret(editor);
}
