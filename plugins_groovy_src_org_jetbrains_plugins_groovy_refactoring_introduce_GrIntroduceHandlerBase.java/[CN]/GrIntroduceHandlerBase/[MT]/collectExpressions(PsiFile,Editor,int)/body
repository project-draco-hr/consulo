{
  int correctedOffset=correctOffset(editor,offset);
  final PsiElement elementAtCaret=file.findElementAt(correctedOffset);
  final List<GrExpression> expressions=new ArrayList<GrExpression>();
  for (GrExpression expression=PsiTreeUtil.getParentOfType(elementAtCaret,GrExpression.class); expression != null; expression=PsiTreeUtil.getParentOfType(expression,GrExpression.class)) {
    if (expressions.contains(expression) || expression instanceof GrParenthesizedExpression)     continue;
    if (expression instanceof GrSuperReferenceExpression || expression.getType() == PsiType.VOID)     continue;
    if (expression instanceof GrApplicationStatement)     continue;
    if (expression instanceof GrReferenceExpression && (expression.getParent() instanceof GrMethodCall && ((GrReferenceExpression)expression).resolve() instanceof PsiMethod || ((GrReferenceExpression)expression).resolve() instanceof PsiClass)) {
      continue;
    }
    if (expression instanceof GrAssignmentExpression)     continue;
    expressions.add(expression);
  }
  return expressions;
}
