{
  final JavaDocInfoComponent component=new JavaDocInfoComponent(this);
  final PopupUpdateProcessor updateProcessor=new PopupUpdateProcessor(new Condition<PsiElement>(){
    public boolean value(    final PsiElement element){
      showJavaDocInfo(element);
      return false;
    }
  }
);
  final JBPopup hint=JBPopupFactory.getInstance().createComponentPopupBuilder(component,component).setRequestFocusCondition(getProject(element),NotLookupOrSearchCondition.INSTANCE).setProject(myProject).addListener(updateProcessor).addUserData(updateProcessor).setForceHeavyweight(true).setDimensionServiceKey(myProject,JAVADOC_LOCATION_AND_SIZE,false).setResizable(true).setMovable(true).setTitle(getTitle(element)).setCancelCallback(new Computable<Boolean>(){
    public Boolean compute(){
      if (fromQuickSearch()) {
        ((ChooseByNameBase.JPanelProvider)myPreviouslyFocused.getParent()).unregisterHint();
      }
      Disposer.dispose(component);
      myEditor=null;
      myPreviouslyFocused=null;
      return Boolean.TRUE;
    }
  }
).createPopup();
  JBPopupImpl oldHint=(JBPopupImpl)getDocInfoHint();
  if (oldHint != null) {
    JavaDocInfoComponent oldComponent=(JavaDocInfoComponent)oldHint.getComponent();
    PsiElement element1=oldComponent.getElement();
    if (Comparing.equal(element,element1)) {
      return oldHint;
    }
    oldHint.cancel();
  }
  component.setHint(hint);
  fetchDocInfo(getDefaultProvider(element),component);
  myDocInfoHintRef=new WeakReference<JBPopup>(hint);
  myPreviouslyFocused=WindowManagerEx.getInstanceEx().getFocusedComponent(getProject(element));
  if (fromQuickSearch()) {
    ((ChooseByNameBase.JPanelProvider)myPreviouslyFocused.getParent()).registerHint(hint);
  }
  return hint;
}
