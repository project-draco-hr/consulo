{
  TemplateSettings templateSettings=TemplateSettings.getInstance();
  String defaultShortcut="";
  if (templateSettings.getDefaultShortcutChar() == TemplateSettings.ENTER_CHAR) {
    defaultShortcut=CodeInsightBundle.message("template.shortcut.enter");
  }
  if (templateSettings.getDefaultShortcutChar() == TemplateSettings.TAB_CHAR) {
    defaultShortcut=CodeInsightBundle.message("template.shortcut.tab");
  }
  if (templateSettings.getDefaultShortcutChar() == TemplateSettings.SPACE_CHAR) {
    defaultShortcut=CodeInsightBundle.message("template.shortcut.space");
  }
  Map<TemplateOptionalProcessor,Boolean> options=template.createOptions();
  Map<TemplateContextType,Boolean> context=template.createContext();
  EditTemplateDialog dialog=new EditTemplateDialog(component,CodeInsightBundle.message("dialog.edit.live.template.title"),template,templateSettings.getTemplateGroups(),defaultShortcut,options,context,newTemplate);
  dialog.show();
  if (!dialog.isOK()) {
    return true;
  }
  dialog.apply();
  template.applyOptions(options);
  template.applyContext(context);
  templateSettings.setLastSelectedTemplateKey(template.getKey());
  return false;
}
