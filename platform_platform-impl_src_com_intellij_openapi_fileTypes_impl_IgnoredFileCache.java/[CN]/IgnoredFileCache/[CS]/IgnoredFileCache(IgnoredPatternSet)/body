{
  myIgnoredPatterns=ignoredPatterns;
  MessageBusConnection connect=ApplicationManager.getApplication().getMessageBus().connect();
  connect.subscribe(VirtualFileManager.VFS_CHANGES,new BulkFileListener(){
    @Override public void before(    @NotNull List<? extends VFileEvent> events){
      myVfsEventNesting++;
      clearCacheForChangedFiles(events);
    }
    @Override public void after(    @NotNull List<? extends VFileEvent> events){
      clearCacheForChangedFiles(events);
      myVfsEventNesting--;
    }
    private void clearCacheForChangedFiles(    @NotNull List<? extends VFileEvent> events){
      for (      final VFileEvent event : events) {
        VirtualFile file=event.getFile();
        if (file instanceof NewVirtualFile && event instanceof VFilePropertyChangeEvent) {
          int id=((NewVirtualFile)file).getId();
          if (id >= 0) {
            myCheckedIds.clear(id);
            myIgnoredIds.remove(id);
          }
        }
      }
    }
  }
);
}
