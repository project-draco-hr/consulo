{
  IdeaPluginDescriptor[] myInstalledPlugins=ApplicationManager.getApplication().getPlugins();
  if (myInstalledPlugins == null || myInstalledPlugins.length == 0) {
    addListItemToPlugins(installedPluginsPanel,makeItalic(UIBundle.message("welcome.screen.plugins.panel.no.plugins.currently.installed.message.text")));
    addListItemToPlugins(bundledPluginsPanel,makeItalic(UIBundle.message("welcome.screen.plugins.panel.all.bundled.plugins.were.uninstalled.message.text")));
  }
 else {
    final Comparator<IdeaPluginDescriptor> pluginsComparator=new Comparator<IdeaPluginDescriptor>(){
      public int compare(      final IdeaPluginDescriptor o1,      final IdeaPluginDescriptor o2){
        final boolean e1=((IdeaPluginDescriptorImpl)o1).isEnabled();
        final boolean e2=((IdeaPluginDescriptorImpl)o2).isEnabled();
        if (e1 && !e2)         return -1;
        if (!e1 && e2)         return 1;
        return o1.getName().compareTo(o2.getName());
      }
    }
;
    Arrays.sort(myInstalledPlugins,pluginsComparator);
    int embeddedPlugins=0;
    int installedPlugins=0;
    String preinstalledPrefix=PathManager.getPreinstalledPluginsPath();
    for (    IdeaPluginDescriptor plugin : myInstalledPlugins) {
      if (plugin.getName().equals("IDEA CORE")) {
        continue;
      }
      if (plugin.getPath().getAbsolutePath().startsWith(preinstalledPrefix)) {
        embeddedPlugins++;
        addListItemToPlugins(bundledPluginsPanel,(IdeaPluginDescriptorImpl)plugin);
      }
 else {
        installedPlugins++;
        addListItemToPlugins(installedPluginsPanel,(IdeaPluginDescriptorImpl)plugin);
      }
    }
    if (embeddedPlugins == 0) {
      addListItemToPlugins(bundledPluginsPanel,makeItalic(UIBundle.message("welcome.screen.plugins.panel.all.bundled.plugins.were.uninstalled.message.text")));
    }
    if (installedPlugins == 0) {
      addListItemToPlugins(installedPluginsPanel,makeItalic(UIBundle.message("welcome.screen.plugins.panel.no.plugins.currently.installed.message.text")));
    }
  }
}
