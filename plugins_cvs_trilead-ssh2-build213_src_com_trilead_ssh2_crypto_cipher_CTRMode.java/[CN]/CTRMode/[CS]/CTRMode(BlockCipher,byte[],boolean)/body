{
  bc=tc;
  blockSize=bc.getBlockSize();
  doEncrypt=doEnc;
  if (blockSize != iv.length)   throw new IllegalArgumentException("IV must be " + blockSize + " bytes long! (currently "+ iv.length+ ")");
  X=new byte[blockSize];
  Xenc=new byte[blockSize];
  System.arraycopy(iv,0,X,0,blockSize);
}
