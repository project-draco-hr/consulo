{
  final PsiElement ifKeyword=descriptor.getPsiElement();
  final PsiIfStatement ifStatement=(PsiIfStatement)ifKeyword.getParent();
  final PsiExpression condition=ifStatement.getCondition();
  final PsiStatement thenBranch=ifStatement.getThenBranch();
  final String text="if(" + condition.getText() + ')'+ thenBranch.getText();
  final PsiStatement elseBranch=ifStatement.getElseBranch();
  if (elseBranch instanceof PsiBlockStatement) {
    final PsiBlockStatement elseBlock=(PsiBlockStatement)elseBranch;
    final PsiCodeBlock block=elseBlock.getCodeBlock();
    final PsiElement[] children=block.getChildren();
    if (children.length > 2) {
      final PsiElement containingElement=ifStatement.getParent();
      final PsiElement added=containingElement.addRangeAfter(children[1],children[children.length - 2],ifStatement);
      final CodeStyleManager codeStyleManager=CodeStyleManager.getInstance(project);
      codeStyleManager.reformat(added);
    }
  }
 else {
    final PsiElement containingElement=ifStatement.getParent();
    final PsiElement added=containingElement.addAfter(elseBranch,ifStatement);
    final CodeStyleManager codeStyleManager=CodeStyleManager.getInstance(project);
    codeStyleManager.reformat(added);
  }
  replaceStatement(ifStatement,text);
}
