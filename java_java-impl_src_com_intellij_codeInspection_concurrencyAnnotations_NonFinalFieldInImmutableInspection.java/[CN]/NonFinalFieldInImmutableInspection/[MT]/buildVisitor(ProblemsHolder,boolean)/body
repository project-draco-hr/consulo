{
  return new JavaElementVisitor(){
    @Override public void visitField(    PsiField field){
      super.visitField(field);
      if (field.hasModifierProperty(PsiModifier.FINAL)) {
        return;
      }
      final PsiClass containingClass=field.getContainingClass();
      if (containingClass != null) {
        if (!JCiPUtil.isImmutable(containingClass)) {
          return;
        }
        holder.registerProblem(field,"Non-final field #ref in @Immutable class  #loc");
      }
    }
  }
;
}
