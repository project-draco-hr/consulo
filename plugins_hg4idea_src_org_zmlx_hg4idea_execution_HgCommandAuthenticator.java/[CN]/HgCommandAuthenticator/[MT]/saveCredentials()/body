{
  if (myRunnable == null)   return;
  final PasswordSafeImpl passwordSafe=(PasswordSafeImpl)PasswordSafe.getInstance();
  final String url=stripSchemaFromUrl(myRunnable.getURL());
  final String key=keyForUrlAndLogin(url,myRunnable.getUserName());
  final PasswordSafeProvider provider=myRunnable.isRememberPassword() ? passwordSafe.getMasterKeyProvider() : passwordSafe.getMemoryProvider();
  try {
    provider.storePassword(myProject,HgCommandAuthenticator.class,key,myRunnable.getPassword());
    final HgVcs vcs=HgVcs.getInstance(myProject);
    if (vcs != null) {
      vcs.getGlobalSettings().addRememberedUrl(url,myRunnable.getUserName());
    }
  }
 catch (  PasswordSafeException e) {
    LOG.info("Couldn't store the password for key [" + key + "]",e);
  }
}
