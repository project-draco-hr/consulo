{
  ApplicationEx application=ApplicationManagerEx.getApplicationEx();
  if (application == null || !application.isLoaded()) {
    AppInit.initApplication();
    while (true) {
      application=ApplicationManagerEx.getApplicationEx();
      if (application != null && application.isLoaded()) {
        break;
      }
      TimeoutUtil.sleep(500L);
    }
  }
  final WGwtModalWindowImpl modalWindow=new WGwtModalWindowImpl();
  modalWindow.setSize(new Size(777,460));
  List<String> projectList=new ArrayList<String>();
  projectList.add("R:/_github.com/consulo/mssdw");
  final Ref<String> selected=Ref.create();
  WGwtListBoxImpl<String> listBox=new WGwtListBoxImpl<String>(new ImmutableListModel<String>(projectList));
  listBox.addValueListener(new ValueComponent.ValueListener<String>(){
    @Override public void valueChanged(    @NotNull ValueComponent.ValueEvent<String> event){
      selected.set(event.getValue());
      modalWindow.hide(true);
    }
  }
);
  modalWindow.setContent(Layouts.horizontalSplit().setFirstComponent(listBox).setSecondComponent(Components.label("Choose project")));
  modalWindow.show(new Runnable(){
    @Override public void run(){
      final String projectPath=selected.get();
      System.out.println(projectPath + " selected");
      final Project project=getOrLoadProject(projectPath);
      if (project == null) {
        System.out.println("project is null");
        return;
      }
      buildContent(window,project);
    }
  }
);
}
