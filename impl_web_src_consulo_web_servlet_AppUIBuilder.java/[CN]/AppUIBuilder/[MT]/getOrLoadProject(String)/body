{
  final VirtualFile fileByPath=LocalFileSystem.getInstance().findFileByPath(path);
  if (fileByPath == null) {
    return null;
  }
  try {
    final Project project;
    ProjectManagerEx projectManager=ProjectManagerEx.getInstanceEx();
    Project[] openProjects=projectManager.getOpenProjects();
    for (    Project temp : openProjects) {
      if (fileByPath.equals(temp.getBaseDir())) {
        return temp;
      }
    }
    project=projectManager.loadProject(path);
    if (project == null) {
      return null;
    }
    projectManager.openTestProject(project);
    final StartupManagerImpl startupManager=(StartupManagerImpl)StartupManager.getInstance(project);
    startupManager.runStartupActivities();
    startupManager.startCacheUpdate();
    return project;
  }
 catch (  Exception e) {
    e.getMessage();
  }
  return null;
}
