{
  String methodName=null;
  int index=suiteClassName.indexOf(',');
  if (index != -1) {
    methodName=suiteClassName.substring(index + 1);
    suiteClassName=suiteClassName.substring(0,index);
  }
  Class testClass=loadTestClass(runner,suiteClassName);
  if (testClass == null)   return null;
  Test test=null;
  if (methodName == null) {
    if (test == null) {
      try {
        Method suiteMethod=testClass.getMethod(BaseTestRunner.SUITE_METHODNAME,new Class[0]);
        if (!Modifier.isStatic(suiteMethod.getModifiers())) {
          String message=MessageFormat.format(ourBundle.getString("junit.suite.must.be.static"),new Object[]{testClass.getName()});
          System.err.println(message);
          return null;
        }
        try {
          test=(Test)suiteMethod.invoke(null,new Class[0]);
          test=new SuiteMethodWrapper(test,suiteClassName);
        }
 catch (        final InvocationTargetException e) {
          final String message=MessageFormat.format(ourBundle.getString("junit.failed.to.invoke.suite"),new Object[]{testClass + " " + e.getTargetException().toString()});
          runner.clearStatus();
          return new FailedTestCase(testClass,BaseTestRunner.SUITE_METHODNAME,message,e);
        }
catch (        IllegalAccessException e) {
          String message=MessageFormat.format(ourBundle.getString("junit.failed.to.invoke.suite"),new Object[]{testClass + " " + e.toString()});
          return new FailedTestCase(testClass,BaseTestRunner.SUITE_METHODNAME,message,e);
        }
      }
 catch (      Throwable e) {
        runner.clearStatus();
        test=new TestSuite(testClass);
      }
    }
  }
 else {
    test=createMethodSuite(runner,testClass,methodName);
  }
  return test;
}
