{
  final GrExpression lop=binaryExpression.getLeftOperand();
  PsiType lType=lop == null ? null : lop.getType();
  final GrExpression rop=binaryExpression.getRightOperand();
  PsiType rType=rop == null ? null : rop.getType();
  if (lType == null || rType == null)   return null;
  String lCanonical=lType.getCanonicalText();
  String rCanonical=rType.getCanonicalText();
  if (TYPE_TO_RANK.containsKey(lCanonical) && TYPE_TO_RANK.containsKey(rCanonical)) {
    int lRank=TYPE_TO_RANK.get(lCanonical);
    int rRank=TYPE_TO_RANK.get(rCanonical);
    int resultRank=Math.max(lRank,rRank);
    return binaryExpression.getManager().getElementFactory().createTypeByFQClassName(RANK_TO_TYPE.get(resultRank),binaryExpression.getResolveScope());
  }
  return getOverloadedOperatorType(lType,binaryExpression.getOperationTokenType(),binaryExpression,new PsiType[]{rType});
}
