{
  ApplicationManager.getApplication().assertIsDispatchThread();
  if (project != null && project.isDisposed())   return null;
  if (CommandLog.LOG.isDebugEnabled()) {
    CommandLog.LOG.debug("startCommand: name = " + name + ", groupId = "+ groupId);
  }
  if (myCurrentCommand != null) {
    return null;
  }
  Document document=groupId instanceof Ref && ((Ref)groupId).get() instanceof Document ? (Document)((Ref)groupId).get() : null;
  myCurrentCommand=new CommandDescriptor(EmptyRunnable.INSTANCE,project,name,groupId,undoConfirmationPolicy,document);
  fireCommandStarted();
  return myCurrentCommand;
}
