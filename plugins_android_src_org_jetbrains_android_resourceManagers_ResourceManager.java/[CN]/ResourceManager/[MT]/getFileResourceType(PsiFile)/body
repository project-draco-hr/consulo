{
  return ApplicationManager.getApplication().runReadAction(new Computable<String>(){
    @Nullable @Override public String compute(){
      PsiDirectory dir=file.getContainingDirectory();
      if (dir == null)       return null;
      PsiDirectory possibleResDir=dir.getParentDirectory();
      if (possibleResDir == null || !isResourceDir(possibleResDir.getVirtualFile())) {
        return null;
      }
      String type=AndroidResourceUtil.getResourceTypeByDirName(dir.getName());
      if (type == null)       return null;
      return type;
    }
  }
);
}
