{
  PsiFile file=session.getFile();
  Project project=file.getProject();
  PsiClass event=JavaPsiFacade.getInstance(project).findClass("java.awt.event.InputEvent",GlobalSearchScope.allScope(project));
  PsiMethod[] methods=event == null ? null : event.findMethodsByName("getModifiers",false);
  PsiMethod getModifiers=methods == null || methods.length != 1 ? null : methods[0];
  PsiAnnotation annotation=getModifiers == null ? null : ExternalAnnotationsManager.getInstance(project).findExternalAnnotation(getModifiers,MagicConstant.class.getName());
  if (annotation != null)   return;
  ProjectFileIndex fileIndex=ProjectRootManager.getInstance(project).getFileIndex();
  final Module module=fileIndex.getModuleForFile(file.getVirtualFile());
  if (module == null) {
    return;
  }
  if (!ApplicationManager.getApplication().isUnitTestMode()) {
    ApplicationManager.getApplication().invokeLater(new Runnable(){
      @Override public void run(){
        ApplicationManager.getApplication().runWriteAction(new Runnable(){
          public void run(){
            attachJdkAnnotations(module);
          }
        }
);
      }
    }
,ModalityState.NON_MODAL,module.getDisposed());
  }
}
