{
  FileType fileType=myHelper.getFileType();
  if (useNewFormatter(fileType)) {
    PseudoTextBuilder pseudoTextBuilder=fileType.getPseudoTextBuilder();
    if (pseudoTextBuilder == null) {
      return element;
    }
 else {
      PseudoText pseudoText=pseudoTextBuilder.build(myHelper.getProject(),mySettings,SourceTreeToPsiMap.treeElementToPsi(element),startOffset,endOffset);
      GeneralCodeFormatter.createSimpleInstance(pseudoText,mySettings,fileType).format();
      formatComments(element,startOffset,endOffset);
      return element;
    }
  }
  final TextRange range=element.getTextRange();
  final int elementStartOffset=range.getStartOffset();
  return processRange(element,new int[]{startOffset - elementStartOffset,endOffset - elementStartOffset});
}
