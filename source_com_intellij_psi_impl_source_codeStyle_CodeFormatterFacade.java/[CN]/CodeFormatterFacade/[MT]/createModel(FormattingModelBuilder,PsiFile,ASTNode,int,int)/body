{
  FormattingModel baseModel=builder.createModel(containingFile,mySettings);
  if (baseModel instanceof PsiBasedFormattingModel) {
    ASTNode fileElement=findSuitableTreeElement(element,containingFile,startOffset,endOffset);
    return new PsiBasedFormattingModel(fileElement,containingFile.getProject(),baseModel.getDocumentModel(),baseModel.getRootBlock());
  }
 else {
    return baseModel;
  }
}
