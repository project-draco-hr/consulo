{
  Group pluginsGroup=new Group(KeyMapBundle.message("plugins.group.title"),null,null);
  final KeymapManagerEx keymapManager=KeymapManagerEx.getInstanceEx();
  ActionManagerEx managerEx=ActionManagerEx.getInstanceEx();
  final IdeaPluginDescriptor[] plugins=ApplicationManager.getApplication().getPlugins();
  Arrays.sort(plugins,new Comparator<IdeaPluginDescriptor>(){
    public int compare(    IdeaPluginDescriptor o1,    IdeaPluginDescriptor o2){
      return o1.getName().compareTo(o2.getName());
    }
  }
);
  for (  IdeaPluginDescriptor plugin : plugins) {
    Group pluginGroup;
    if (plugin.getName().equals("IDEA CORE")) {
      continue;
    }
 else {
      pluginGroup=new Group(plugin.getName(),null,null);
    }
    final String[] pluginActions=managerEx.getPluginActions(plugin.getPluginId());
    if (pluginActions == null || pluginActions.length == 0) {
      continue;
    }
    Arrays.sort(pluginActions,new Comparator<String>(){
      public int compare(      String o1,      String o2){
        return getTextToCompare(o1).compareTo(getTextToCompare(o2));
      }
    }
);
    for (    String pluginAction : pluginActions) {
      if (keymapManager.getBoundActions().contains(pluginAction))       continue;
      final AnAction anAction=managerEx.getActionOrStub(pluginAction);
      if (filtered == null || filtered.value(anAction)) {
        pluginGroup.addActionId(pluginAction);
      }
    }
    if (pluginGroup.getSize() > 0 && pluginGroup != otherGroup) {
      pluginsGroup.addGroup(pluginGroup);
    }
  }
  return pluginsGroup;
}
