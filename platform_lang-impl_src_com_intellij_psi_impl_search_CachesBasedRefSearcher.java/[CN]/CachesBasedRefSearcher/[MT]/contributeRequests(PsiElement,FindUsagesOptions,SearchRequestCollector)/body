{
  final boolean ignoreAccessScope=false;
  final SearchScope scope=options.searchScope;
  contributeSearchTargets(refElement,options,collector,ignoreAccessScope,scope);
  collector.searchCustom(new Processor<Processor<PsiReference>>(){
    public boolean process(    Processor<PsiReference> consumer){
      ourProcessing.set(true);
      try {
        return ReferencesSearch.search(refElement,scope,ignoreAccessScope).forEach(consumer);
      }
  finally {
        ourProcessing.set(null);
      }
    }
  }
);
}
