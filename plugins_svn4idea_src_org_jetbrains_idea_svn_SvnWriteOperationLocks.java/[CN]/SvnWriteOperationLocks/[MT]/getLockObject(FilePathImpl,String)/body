{
  final boolean directory=file.isDirectory();
  final VirtualFile root=myVcsManager.getVcsRootFor(file);
  if (root == null) {
    throw new SVNException(SVNErrorMessage.create(directory ? SVNErrorCode.WC_NOT_WORKING_COPY : SVNErrorCode.WC_NOT_FILE));
  }
  Lock lock;
synchronized (myLock) {
    lock=myLockMap.get(path);
    if (lock == null) {
      lock=new ReentrantLock();
      myLockMap.put(path,lock);
    }
  }
  return lock;
}
