{
  final ProgressIndicator progressIndicator=ProgressManager.getInstance().getProgressIndicator();
  if (progressIndicator != null)   progressIndicator.startNonCancelableSection();
  final PsiDocumentManagerImpl manager=(PsiDocumentManagerImpl)PsiDocumentManager.getInstance(myPomProject.getPsiProject());
  final PsiToDocumentSynchronizer synchronizer=manager.getSynchronizer();
  Document document=null;
  try {
synchronized (PsiLock.LOCK) {
      if (transaction.getChangeScope().getContainingFile() != null) {
        document=manager.getDocument(transaction.getChangeScope().getContainingFile());
      }
      myBlockedAspects.push(aspect);
      if (document != null)       synchronizer.startTransaction(document,transaction.getChangeScope());
      final PomModelEvent event;
      try {
        event=transaction.run();
        if (event == null)         return;
      }
 catch (      IncorrectOperationException ioe) {
        return;
      }
 finally {
        myBlockedAspects.pop();
      }
      final List<PomModelAspect> dependants=getAllDependants(aspect);
{
        final Iterator<PomModelAspect> depsIter=dependants.iterator();
        while (depsIter.hasNext()) {
          final PomModelAspect modelAspect=depsIter.next();
          if (myBlockedAspects.contains(modelAspect))           continue;
          modelAspect.update(event);
        }
      }
{
        final PomModelListener[] listeners=getListeners();
        for (int i=0; i < listeners.length; i++)         listeners[i].modelChanged(event);
      }
    }
  }
  finally {
    if (document != null)     synchronizer.commitTransaction(document);
    if (progressIndicator != null)     progressIndicator.finishNonCancelableSection();
  }
}
