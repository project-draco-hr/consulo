def flagfunc(self, fallback):
    if self._checklink:
        if self._checkexec:

            def f(x):
                p = self._join(x)
                if os.path.islink(p):
                    return 'l'
                if util.is_exec(p):
                    return 'x'
                return ''
            return f

        def f(x):
            if os.path.islink(self._join(x)):
                return 'l'
            if ('x' in fallback(x)):
                return 'x'
            return ''
        return f
    if self._checkexec:

        def f(x):
            if ('l' in fallback(x)):
                return 'l'
            if util.is_exec(self._join(x)):
                return 'x'
            return ''
        return f
    return fallback
