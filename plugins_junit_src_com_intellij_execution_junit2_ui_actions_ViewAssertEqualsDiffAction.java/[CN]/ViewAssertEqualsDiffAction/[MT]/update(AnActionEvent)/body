{
  final Presentation presentation=e.getPresentation();
  final boolean enabled;
  final DataContext dataContext=e.getDataContext();
  if (PlatformDataKeys.PROJECT.getData(dataContext) == null) {
    enabled=false;
  }
 else {
    final AbstractTestProxy test=AbstractTestProxy.DATA_KEY.getData(dataContext);
    if (test instanceof TestProxy) {
      final TestState state=((TestProxy)test).getState();
      enabled=state instanceof ComparisonFailureState;
    }
 else {
      enabled=false;
    }
  }
  presentation.setEnabled(enabled);
  presentation.setVisible(enabled);
}
