{
  final Presentation presentation=e.getPresentation();
  final boolean enabled;
  final DataContext dataContext=e.getDataContext();
  if (dataContext.getData(DataConstants.PROJECT) == null)   enabled=false;
 else {
    final AbstractTestProxy test=(AbstractTestProxy)dataContext.getData(AbstractTestProxy.DATA_CONSTANT);
    if (test instanceof TestProxy) {
      final TestState state=((TestProxy)test).getState();
      enabled=state instanceof ComparisonFailureState;
    }
 else {
      enabled=false;
    }
  }
  presentation.setEnabled(enabled);
  presentation.setVisible(enabled);
}
