{
  if (windowTitle == null)   windowTitle=getBadPatchTitle(file);
  if (localTitle == null)   localTitle=VcsBundle.message("patch.apply.conflict.local.version");
  if (patchedTitle == null)   patchedTitle="Patched (with problems)";
  FileType fileType=file != null ? file.getFileType() : null;
  final DiffContentFactory contentFactory=DiffContentFactory.getInstance();
  DocumentContent leftContent=file != null ? contentFactory.createDocument(project,file) : null;
  if (leftContent == null)   leftContent=contentFactory.create(localContent,fileType);
  DocumentContent rightContent=contentFactory.create(patchedContent,fileType);
  final DiffRequest request=new SimpleDiffRequest(windowTitle,leftContent,rightContent,localTitle,patchedTitle);
  DiffUtil.addNotification(new ApplyPatchMergeTool.DiffIsApproximateNotification(),request);
  return request;
}
