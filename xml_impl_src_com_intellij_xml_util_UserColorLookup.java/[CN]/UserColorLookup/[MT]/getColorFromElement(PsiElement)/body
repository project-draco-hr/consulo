{
  Color myColorAtCaret=null;
  if (!(element instanceof XmlToken))   return null;
  final String text=element.getText();
  if (text.length() > 0 && text.charAt(0) == '#') {
    myColorAtCaret=decodeColor(text);
  }
 else {
    final String hexCodeForColorName=ColorSampleLookupValue.getHexCodeForColorName(text);
    if (hexCodeForColorName != null)     myColorAtCaret=decodeColor(hexCodeForColorName);
  }
  return myColorAtCaret;
}
