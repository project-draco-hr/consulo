{
  DirectoryEntry root=new DirectoryEntry(null,"root");
  DirectoryEntry dir=new DirectoryEntry(33,"dir");
  FileEntry child=new FileEntry(44,"child",null);
  root.addChild(root);
  dir.addChild(child);
  Entry renamed=dir.renamed("new dir");
  assertNull(renamed.getParent());
  assertEquals(p("new dir"),renamed.getPath());
  List<Entry> newChildren=renamed.getChildren();
  assertEquals(1,renamed.getChildren().size());
  assertEquals(44,newChildren.get(0).getId());
  assertSame(dir,child.getParent());
  assertSame(renamed,newChildren.get(0).getParent());
}
