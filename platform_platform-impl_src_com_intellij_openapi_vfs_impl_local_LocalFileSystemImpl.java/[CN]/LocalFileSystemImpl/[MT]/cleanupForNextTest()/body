{
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    public void run(){
      FileDocumentManager.getInstance().saveAllDocuments();
      refresh(false);
    }
  }
);
  ((PersistentFS)ManagingFS.getInstance()).clearIdCache();
  final VirtualFile[] roots=ManagingFS.getInstance().getRoots(this);
  for (  VirtualFile root : roots) {
    if (root instanceof VirtualDirectoryImpl) {
      final VirtualDirectoryImpl directory=(VirtualDirectoryImpl)root;
      directory.cleanupCachedChildren();
    }
  }
  myRootsToWatch.clear();
  final File file=new File(FileUtil.getTempDirectory());
  String path=file.getCanonicalPath().replace(File.separatorChar,'/');
  addRootToWatch(path,true);
}
