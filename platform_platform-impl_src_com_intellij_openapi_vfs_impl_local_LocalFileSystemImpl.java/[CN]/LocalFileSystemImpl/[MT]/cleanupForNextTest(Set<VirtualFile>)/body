{
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    @Override public void run(){
      FileDocumentManager.getInstance().saveAllDocuments();
    }
  }
);
  ((PersistentFS)ManagingFS.getInstance()).clearIdCache();
  for (  VirtualFile root : ManagingFS.getInstance().getRoots(this)) {
    if (root instanceof VirtualDirectoryImpl) {
      ((VirtualDirectoryImpl)root).cleanupCachedChildren(survivors);
    }
  }
  myRootsToWatch.clear();
}
