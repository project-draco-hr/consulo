{
  Runnable heavyRefresh=new Runnable(){
    @Override public void run(){
      for (      VirtualFile root : ManagingFS.getInstance().getRoots(LocalFileSystemImpl.this)) {
        ((NewVirtualFile)root).markDirtyRecursively();
      }
      refresh(asynchronous);
    }
  }
;
  if (asynchronous && myWatcher.isOperational()) {
    RefreshQueue.getInstance().refresh(true,true,heavyRefresh,ManagingFS.getInstance().getRoots(this));
  }
 else {
    heavyRefresh.run();
  }
}
