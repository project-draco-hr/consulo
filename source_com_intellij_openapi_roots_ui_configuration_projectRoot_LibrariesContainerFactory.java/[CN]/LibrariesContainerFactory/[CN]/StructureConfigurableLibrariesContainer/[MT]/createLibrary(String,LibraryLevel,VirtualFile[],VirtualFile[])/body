{
  LibraryTableModifiableModelProvider provider;
  if (level == LibraryLevel.PROJECT) {
    provider=myContext.getProjectLibrariesProvider(false);
  }
 else {
    provider=myContext.getGlobalLibrariesProvider(false);
  }
  LibraryTable.ModifiableModel model=provider.getModifiableModel();
  Library library=model.createLibrary(getUniqueLibraryName(name,model));
  LibraryEditor libraryEditor=((LibrariesModifiableModel)model).getLibraryEditor(library);
  for (  VirtualFile root : classRoots) {
    libraryEditor.addRoot(root,OrderRootType.CLASSES);
  }
  for (  VirtualFile source : sourceRoots) {
    libraryEditor.addRoot(source,OrderRootType.SOURCES);
  }
  return library;
}
