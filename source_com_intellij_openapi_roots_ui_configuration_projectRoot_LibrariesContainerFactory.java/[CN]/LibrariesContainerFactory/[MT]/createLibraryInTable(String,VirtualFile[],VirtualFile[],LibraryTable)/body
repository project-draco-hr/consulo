{
  LibraryTable.ModifiableModel modifiableModel=table.getModifiableModel();
  Library library=modifiableModel.createLibrary(getUniqueLibraryName(name,modifiableModel));
  final Library.ModifiableModel model=library.getModifiableModel();
  for (  VirtualFile root : roots) {
    model.addRoot(root,OrderRootType.CLASSES);
  }
  for (  VirtualFile root : sources) {
    model.addRoot(root,OrderRootType.SOURCES);
  }
  model.commit();
  modifiableModel.commit();
  return library;
}
