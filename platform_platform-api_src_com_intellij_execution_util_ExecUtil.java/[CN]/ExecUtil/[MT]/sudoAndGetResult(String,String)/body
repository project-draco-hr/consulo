{
  if (SystemInfo.isMac) {
    final String script="do shell script \"" + scriptPath + "\" with administrator privileges";
    Runtime runtime=Runtime.getRuntime();
    String[] args={getOsascriptPath(),"-e",script};
    runtime.exec(args);
    return 0;
  }
 else   if (SystemInfo.isKDE) {
    return execAndGetResult("kdesudo","--comment",prompt,scriptPath);
  }
 else   if (SystemInfo.isGnome) {
    return execAndGetResult("gksudo","--message",prompt,scriptPath);
  }
 else   if (SystemInfo.isUnix) {
    final File sudo=createTempExecutableScript("sudo",".sh","#!/bin/sh\n" + "echo \"" + prompt + "\"\n"+ "echo\n"+ "sudo \""+ scriptPath+ "\"\n"+ "STATUS=$?"+ "echo\n"+ "read -p \"Press Enter to close this window...\" TEMP\n"+ "exit $STATUS\n");
    return execAndGetResult("xterm","-T","Install","-e",sudo.getAbsolutePath());
  }
 else {
    throw new UnsupportedOperationException("Unsupported OS/desktop: " + SystemInfo.OS_NAME + '/'+ SystemInfo.SUN_DESKTOP);
  }
}
