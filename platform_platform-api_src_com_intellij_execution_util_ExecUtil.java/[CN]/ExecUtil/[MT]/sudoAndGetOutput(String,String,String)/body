{
  if (SystemInfo.isMac) {
    final String script="do shell script \"" + scriptPath + "\" with administrator privileges";
    Runtime runtime=Runtime.getRuntime();
    String[] args={getOsascriptPath(),"-e",script};
    if (workDir != null)     runtime.exec(args,ArrayUtil.EMPTY_STRING_ARRAY,new File(workDir));
 else     runtime.exec(args);
    return new ProcessOutput(0);
  }
 else   if (SystemInfo.isKDE) {
    return execAndGetOutput(Lists.<String>newArrayList("kdesudo","--comment",prompt,scriptPath),workDir);
  }
 else   if (SystemInfo.isGnome) {
    return execAndGetOutput(Lists.<String>newArrayList("gksudo","--message",prompt,scriptPath),workDir);
  }
 else   if (SystemInfo.isUnix) {
    final File sudo=createTempExecutableScript("sudo",".sh","#!/bin/sh\n" + "echo \"" + prompt + "\"\n"+ "echo\n"+ "sudo \""+ scriptPath+ "\"\n"+ "STATUS=$?"+ "echo\n"+ "read -p \"Press Enter to close this window...\" TEMP\n"+ "exit $STATUS\n");
    return execAndGetOutput(Lists.<String>newArrayList("xterm","-T","Install","-e",sudo.getAbsolutePath()),workDir);
  }
 else {
    throw new UnsupportedOperationException("Unsupported OS/desktop: " + SystemInfo.OS_NAME + '/'+ SystemInfo.SUN_DESKTOP);
  }
}
