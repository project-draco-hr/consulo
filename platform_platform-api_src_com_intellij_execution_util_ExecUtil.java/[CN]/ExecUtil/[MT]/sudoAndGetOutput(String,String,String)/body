{
  if (SystemInfo.isMac) {
    final String script="do shell script \"" + scriptPath + "\" with administrator privileges";
    return execAndGetOutput(Arrays.asList(getOsascriptPath(),"-e",script),workDir);
  }
 else   if (SystemInfo.isKDE) {
    return execAndGetOutput(Arrays.asList("kdesudo","--comment",prompt,scriptPath),workDir);
  }
 else   if (SystemInfo.isGnome) {
    return execAndGetOutput(Arrays.asList("gksudo","--message",prompt,scriptPath),workDir);
  }
 else   if (SystemInfo.isUnix) {
    final File sudo=createTempExecutableScript("sudo",".sh","#!/bin/sh\n" + "echo \"" + prompt + "\"\n"+ "echo\n"+ "sudo \""+ scriptPath+ "\"\n"+ "STATUS=$?"+ "echo\n"+ "read -p \"Press Enter to close this window...\" TEMP\n"+ "exit $STATUS\n");
    return execAndGetOutput(Arrays.asList("xterm","-T","Install","-e",sudo.getAbsolutePath()),workDir);
  }
 else {
    throw new UnsupportedOperationException("Unsupported OS/desktop: " + SystemInfo.OS_NAME + '/'+ SystemInfo.SUN_DESKTOP);
  }
}
