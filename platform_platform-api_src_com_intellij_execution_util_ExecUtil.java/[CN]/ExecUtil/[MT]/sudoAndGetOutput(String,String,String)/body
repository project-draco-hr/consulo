{
  if (SystemInfo.isMac) {
    final String script="do shell script \"" + scriptPath + "\" with administrator privileges";
    return execAndGetOutput(Arrays.asList(getOsascriptPath(),"-e",script),workDir);
  }
 else   if ("root".equals(System.getenv("USER"))) {
    return execAndGetOutput(Collections.singletonList(scriptPath),workDir);
  }
 else   if (hasKdeSudo.getValue()) {
    return execAndGetOutput(Arrays.asList("kdesudo","--comment",prompt,scriptPath),workDir);
  }
 else   if (hasGkSudo.getValue()) {
    return execAndGetOutput(Arrays.asList("gksudo","--message",prompt,scriptPath),workDir);
  }
 else   if (SystemInfo.isUnix && hasTerminalApp()) {
    final File sudo=createTempExecutableScript("sudo",".sh","#!/bin/sh\n" + "echo \"" + prompt + "\"\n"+ "echo\n"+ "sudo \""+ scriptPath+ "\"\n"+ "STATUS=$?"+ "echo\n"+ "read -p \"Press Enter to close this window...\" TEMP\n"+ "exit $STATUS\n");
    return execAndGetOutput(getTerminalCommand("Install",sudo.getAbsolutePath()),workDir);
  }
  throw new UnsupportedSystemException();
}
