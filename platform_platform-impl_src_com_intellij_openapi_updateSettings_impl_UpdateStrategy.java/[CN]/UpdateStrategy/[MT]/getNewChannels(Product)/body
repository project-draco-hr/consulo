{
  List<String> knownChannels=updateSettings.getKnownChannelsIds() != null ? updateSettings.getKnownChannelsIds() : Collections.<String>emptyList();
  UpdateChannel versionUpgradeChannel=null;
  List<UpdateChannel> newChannels=new ArrayList<UpdateChannel>();
  final List<UpdateChannel> loadedChannels=product.getChannels();
  for (  UpdateChannel channel : loadedChannels) {
    if (knownChannels.contains(channel.getId()) || !isInteresting(channel)) {
      continue;
    }
    newChannels.add(channel);
    if (isNewer(channel)) {
      versionUpgradeChannel=channel;
    }
  }
  return new Pair<List<UpdateChannel>,UpdateChannel>(newChannels.size() > 0 ? newChannels : null,versionUpgradeChannel);
}
