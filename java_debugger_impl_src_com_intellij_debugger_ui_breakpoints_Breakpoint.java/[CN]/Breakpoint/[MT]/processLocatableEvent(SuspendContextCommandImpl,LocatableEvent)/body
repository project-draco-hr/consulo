{
  final SuspendContextImpl context=action.getSuspendContext();
  if (!isValid()) {
    context.getDebugProcess().getRequestsManager().deleteRequest(this);
    return false;
  }
  final String[] title=new String[]{DebuggerBundle.message("title.error.evaluating.breakpoint.condition")};
  try {
    final StackFrameProxyImpl frameProxy=context.getThread().frame(0);
    if (frameProxy == null) {
      return false;
    }
    final EvaluationContextImpl evaluationContext=new EvaluationContextImpl(action.getSuspendContext(),frameProxy,getThisObject(context,event));
    if (!evaluateCondition(evaluationContext,event)) {
      return false;
    }
    title[0]=DebuggerBundle.message("title.error.evaluating.breakpoint.action");
    runAction(evaluationContext,event);
  }
 catch (  final EvaluateException ex) {
    if (ApplicationManager.getApplication().isUnitTestMode()) {
      System.out.println(ex.getMessage());
      return false;
    }
    throw new EventProcessingException(title[0],ex.getMessage(),ex);
  }
  return true;
}
