{
  PsiManager manager=PsiManager.getInstance(myRef.getProject());
  PsiShortNamesCache cache=JavaPsiFacade.getInstance(manager.getProject()).getShortNamesCache();
  String name=myRef.getReferenceName();
  GlobalSearchScope scope=myRef.getResolveScope();
  if (name == null) {
    return Collections.emptyList();
  }
  final PsiReferenceParameterList refParameters=myRef.getParameterList();
  boolean referenceHasTypeParameters=refParameters != null && refParameters.getTypeParameterElements().length > 0;
  PsiClass[] classes=cache.getClassesByName(name,scope);
  if (classes.length == 0)   return Collections.emptyList();
  ArrayList<PsiClass> classList=new ArrayList<PsiClass>(classes.length);
  boolean isAnnotationReference=myRef.getParent() instanceof PsiAnnotation;
  for (  PsiClass aClass : classes) {
    if (isAnnotationReference && !aClass.isAnnotationType())     continue;
    if (JavaCompletionUtil.isInExcludedPackage(aClass))     continue;
    if (referenceHasTypeParameters && !aClass.hasTypeParameters())     continue;
    PsiFile file=aClass.getContainingFile();
    if (file instanceof PsiJavaFile && ((PsiJavaFile)file).getPackageName().length() == 0) {
      continue;
    }
    String qName=aClass.getQualifiedName();
    if (qName != null) {
      if (qName.endsWith(name)) {
        if (aClass.hasModifierProperty(PsiModifier.PUBLIC)) {
          classList.add(aClass);
        }
      }
    }
  }
  return classList;
}
