{
  LOG.assertTrue(!myProject2Frame.containsKey(project));
  final IdeFrameImpl frame;
  if (myProject2Frame.containsKey(null)) {
    frame=getDefaultEmptyIdeFrame();
    myProject2Frame.remove(null);
    myProject2Frame.put(project,frame);
    frame.setProject(project);
  }
 else {
    frame=new IdeFrameImpl(ApplicationInfoEx.getInstanceEx(),myActionManager,myUiSettings,myDataManager,ApplicationManager.getApplication());
    final Rectangle bounds=ProjectFrameBounds.getInstance(project).getBounds();
    if (bounds != null) {
      myFrameBounds=bounds;
    }
    if (myFrameBounds != null) {
      fixForOracleBug8007219(frame);
      frame.setBounds(myFrameBounds);
    }
    frame.setProject(project);
    myProject2Frame.put(project,frame);
    frame.setExtendedState(myFrameExtendedState);
    frame.setVisible(true);
  }
  frame.addWindowListener(myActivationListener);
  frame.addComponentListener(new ComponentAdapter(){
    @Override public void componentMoved(    @NotNull ComponentEvent e){
      updateFrameBounds(frame);
    }
  }
);
  myEventDispatcher.getMulticaster().frameCreated(frame);
  return frame;
}
