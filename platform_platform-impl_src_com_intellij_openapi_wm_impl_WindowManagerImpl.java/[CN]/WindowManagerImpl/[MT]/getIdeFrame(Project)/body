{
  if (project != null) {
    return getFrame(project);
  }
  final Window window=KeyboardFocusManager.getCurrentKeyboardFocusManager().getActiveWindow();
  final Component parent=UIUtil.findUltimateParent(window);
  if (parent instanceof IdeFrame)   return (IdeFrame)parent;
  final Frame[] frames=Frame.getFrames();
  for (  Frame each : frames) {
    if (each instanceof IdeFrame) {
      return (IdeFrame)each;
    }
  }
  return null;
}
