{
  OrderEnumerator base=OrderEnumerator.orderEntries(module);
  if (forOtherModules && (type == OrderRootType.COMPILATION_CLASSES || type == OrderRootType.PRODUCTION_COMPILATION_CLASSES || type == OrderRootType.CLASSES || type == OrderRootType.SOURCES)) {
    base=base.exportedOnly();
  }
  if (type == OrderRootType.CLASSES_AND_OUTPUT) {
    return base.compileOnly().recursively().classes();
  }
  if (type == OrderRootType.COMPILATION_CLASSES) {
    return base.recursively().exportedOnly().classes();
  }
  if (type == OrderRootType.PRODUCTION_COMPILATION_CLASSES) {
    return base.compileOnly().productionOnly().recursively().exportedOnly().classes();
  }
  if (type == OrderRootType.CLASSES) {
    return base.withoutModuleSourceEntries().recursively().exportedOnly().classes();
  }
  if (type == OrderRootType.SOURCES) {
    return base.recursively().exportedOnly().sources();
  }
  if (type.collectFromDependentModules()) {
    return base.recursively().roots(type);
  }
  return base.roots(type);
}
