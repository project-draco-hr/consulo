{
  int col=-1;
  int line=-1;
  if (myEditor != null) {
    col=myEditor.getCaretModel().getLogicalPosition().column;
    line=myEditor.getCaretModel().getLogicalPosition().line;
    LogicalPosition pos=new LogicalPosition(0,0);
    myEditor.getCaretModel().moveToLogicalPosition(pos);
  }
  LocalHistoryAction a=LocalHistory.getInstance().startAction(getCommandName());
  try {
    doRefactoring(usages);
  }
  finally {
    a.finish();
  }
  if (myEditor != null) {
    LogicalPosition pos=new LogicalPosition(line,col);
    myEditor.getCaretModel().moveToLogicalPosition(pos);
  }
}
