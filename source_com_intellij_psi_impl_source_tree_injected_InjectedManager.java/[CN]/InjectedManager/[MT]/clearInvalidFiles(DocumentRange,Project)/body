{
  Iterator<VirtualFileDelegate> iterator=cachedFiles.iterator();
  while (iterator.hasNext()) {
    VirtualFileDelegate cachedFile=iterator.next();
    PsiFile cached=((PsiManagerEx)PsiManager.getInstance(project)).getFileManager().getCachedPsiFile(cachedFile);
    if (cached == null || cached.getContext() == null || !cached.getContext().isValid()) {
      iterator.remove();
      continue;
    }
    Document cachedDocument=PsiDocumentManager.getInstance(project).getCachedDocument(cached);
    if (!(cachedDocument instanceof DocumentRange)) {
      iterator.remove();
      continue;
    }
    DocumentRange cachedDocumentRange=(DocumentRange)cachedDocument;
    if (documentRange.equalsTo(cachedDocumentRange)) {
      InjectedLanguageUtil.clearCaches(cached,cachedDocumentRange);
      iterator.remove();
    }
  }
}
