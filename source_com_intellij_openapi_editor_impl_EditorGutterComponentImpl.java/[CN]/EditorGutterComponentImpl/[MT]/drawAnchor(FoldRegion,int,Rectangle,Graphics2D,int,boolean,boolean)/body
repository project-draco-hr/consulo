{
  if (foldRange.isValid()) {
    VisualPosition foldStart=offsetToLineStartPosition(foldRange.getStartOffset());
    int y=myEditor.visibleLineNumberToYPosition(foldStart.line) + myEditor.getLineHeight() - myEditor.getDescent() - width;
    int height=width + 2;
    if (!foldRange.isExpanded()) {
      if (y <= clip.y + clip.height && y + height >= clip.y) {
        drawSquareWithPlus(g,anchorX,y,width,active,paintBackground);
      }
    }
 else {
      VisualPosition foldEnd=offsetToLineStartPosition(foldRange.getEndOffset());
      if (foldStart.line == foldEnd.line) {
        drawSquareWithMinus(g,anchorX,y,width,active,paintBackground);
      }
 else {
        int endY=myEditor.visibleLineNumberToYPosition(foldEnd.line) + myEditor.getLineHeight() - myEditor.getDescent();
        if (y <= clip.y + clip.height && y + height >= clip.y) {
          drawDirectedBox(g,anchorX,y,width,height,width - 2,active,paintBackground);
        }
        if (endY - height <= clip.y + clip.height && endY >= clip.y) {
          drawDirectedBox(g,anchorX,endY,width,-height,-width + 2,active,paintBackground);
        }
      }
    }
  }
}
