{
  if (!isFoldingOutlineShown())   return;
  Rectangle clip=g.getClipBounds();
  drawDottedLine(g,getWhitespaceSeparatorOffset(),clip.y,clip.y + clip.height);
  int anchorX=getFoldingAreaOffset();
  int width=getFoldingAnchorWidth();
  FoldRegion[] visibleFoldRegions=((FoldingModelImpl)myEditor.getFoldingModel()).fetchVisible();
  int firstVisibleOffset=myEditor.logicalPositionToOffset(myEditor.xyToLogicalPosition(new Point(0,clip.y - myEditor.getLineHeight())));
  int lastVisibleOffset=myEditor.logicalPositionToOffset(myEditor.xyToLogicalPosition(new Point(0,clip.y + clip.height + myEditor.getLineHeight())));
  if (myActiveFoldRegion != null) {
    drawFoldingLines(myActiveFoldRegion,clip,width,anchorX,g);
  }
  for (int j=0; j < visibleFoldRegions.length; j++) {
    FoldRegion visibleFoldRegion=visibleFoldRegions[j];
    if (visibleFoldRegion.getStartOffset() > lastVisibleOffset)     continue;
    if (visibleFoldRegion.getEndOffset() < firstVisibleOffset)     continue;
    drawAnchor(visibleFoldRegion,width,clip,g,anchorX,false,true);
  }
}
