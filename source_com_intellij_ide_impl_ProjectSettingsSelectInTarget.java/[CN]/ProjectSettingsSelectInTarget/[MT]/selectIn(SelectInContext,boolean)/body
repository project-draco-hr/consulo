{
  final Project project=context.getProject();
  VirtualFile file=context.getVirtualFile();
  final ProjectFileIndex fileIndex=ProjectRootManager.getInstance(project).getFileIndex();
  final Module module=fileIndex.getModuleForFile(file);
  if (module != null) {
    final Facet facet=findFacet(project,file,fileIndex);
    ApplicationManager.getApplication().invokeLater(new Runnable(){
      public void run(){
        if (facet != null) {
          ModulesConfigurator.showFacetSettingsDialog(facet,null);
        }
 else {
          ModulesConfigurator.showDialog(project,module.getName(),null,false);
        }
      }
    }
);
    return;
  }
  final LibraryOrderEntry libraryOrderEntry=findLibrary(file,fileIndex);
  if (libraryOrderEntry != null) {
    ApplicationManager.getApplication().invokeLater(new Runnable(){
      public void run(){
        ModulesConfigurator.showLibrarySettings(project,libraryOrderEntry);
      }
    }
);
    return;
  }
  final Sdk jdk=findJdk(file,fileIndex);
  if (jdk != null) {
    ApplicationManager.getApplication().invokeLater(new Runnable(){
      public void run(){
        ModulesConfigurator.showSdkSettings(project,jdk);
      }
    }
);
  }
}
