{
  final String path1=args[1];
  final String path2=args[2];
  final VirtualFile file1=findFile(path1);
  final VirtualFile file2=findFile(path2);
  final boolean areDirs=areDirs(file1,file2);
  final boolean areJars=areJars(file1,file2);
  if (areDirs || areJars) {
    final DirDiffManager diffManager=DirDiffManager.getInstance(ProjectManager.getInstance().getDefaultProject());
    final DiffElement d1=diffManager.createDiffElement(file1);
    final DiffElement d2=diffManager.createDiffElement(file2);
    if (d1 == null) {
      throw new OperationFailedException(DiffBundle.message("cannot.create.diff.error",path1));
    }
    if (d2 == null) {
      throw new OperationFailedException(DiffBundle.message("cannot.create.diff.error",path1));
    }
 else     if (!diffManager.canShow(d1,d2)) {
      throw new OperationFailedException(DiffBundle.message("cannot.compare.error",path1,path2));
    }
    final DirDiffSettings settings=new DirDiffSettings();
    settings.showInFrame=false;
    diffManager.showDiff(d1,d2,settings,null);
  }
 else {
    file1.refresh(false,false);
    file2.refresh(false,false);
    if (file1.getFileType() == UnknownFileType.INSTANCE) {
      throw new OperationFailedException(DiffBundle.message("unknown.file.type.error",path1));
    }
 else     if (file2.getFileType() == UnknownFileType.INSTANCE) {
      throw new OperationFailedException(DiffBundle.message("unknown.file.type.error",path2));
    }
    SimpleDiffRequest request=SimpleDiffRequest.compareFiles(file1,file2,ProjectManager.getInstance().getDefaultProject());
    request.addHint(DiffTool.HINT_SHOW_MODAL_DIALOG);
    DiffManager.getInstance().getIdeaDiffTool().show(request);
  }
}
