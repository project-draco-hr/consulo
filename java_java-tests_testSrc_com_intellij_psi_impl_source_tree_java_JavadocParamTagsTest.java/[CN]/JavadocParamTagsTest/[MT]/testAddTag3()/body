{
  CommandProcessor.getInstance().executeCommand(getProject(),new Runnable(){
    public void run(){
      ApplicationManager.getApplication().runWriteAction(new Runnable(){
        public void run(){
          final PsiElementFactory factory=getFactory();
          final PsiJavaFile psiFile;
          try {
            psiFile=(PsiJavaFile)createPseudoPhysicalFile("aaa.java","class A {/**\n" + " * Javadoc\n" + " * @param p1\n"+ " * @param p3\n"+ " */\n"+ "void m();}");
            final PsiClass psiClass=psiFile.getClasses()[0];
            final PsiMethod method=psiClass.getMethods()[0];
            PsiDocComment docComment=method.getDocComment();
            assertNotNull(docComment);
            final PsiDocTag[] tags=docComment.getTags();
            final PsiDocTag tag2=factory.createParamTag("p2","");
            docComment.addAfter(tag2,tags[0]);
            docComment=CodeInsightUtilBase.forcePsiPostprocessAndRestoreElement(docComment);
            assertEquals("/**\n" + " * Javadoc\n" + " * @param p1\n"+ " * @param p2\n"+ " * @param p3\n"+ " */",docComment.getText());
          }
 catch (          IncorrectOperationException e) {
          }
        }
      }
);
    }
  }
,"",null);
}
