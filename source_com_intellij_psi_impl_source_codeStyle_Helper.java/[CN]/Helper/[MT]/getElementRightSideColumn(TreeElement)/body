{
  int len=0;
  do {
    String text=elem.getText();
    int idx=text.lastIndexOf('\n');
    if (idx >= 0) {
      len+=text.length() - idx;
      return len;
    }
    len+=text.length();
    do {
      TreeElement prev=elem.getTreePrev();
      if (prev != null) {
        elem=prev;
        break;
      }
      elem=elem.getTreeParent();
    }
 while (elem != null);
  }
 while (elem != null);
  return len;
}
