{
  boolean needRefreshVFS=false;
  for (  final FilePath file : myDirtyFiles) {
    if (file.getVirtualFile() == null) {
      needRefreshVFS=true;
    }
  }
  if (needRefreshVFS) {
    ApplicationManager.getApplication().invokeAndWait(new Runnable(){
      public void run(){
        ApplicationManager.getApplication().runWriteAction(new Runnable(){
          public void run(){
            for (            final FilePath file : myDirtyFiles) {
              if (file.getVirtualFile() == null) {
                VirtualFile vFile=LocalFileSystem.getInstance().refreshAndFindFileByIoFile(file.getIOFile());
                if (vFile != null) {
                  file.refresh();
                  if (file.isDirectory())                   vFile.refresh(false,true);
                }
              }
            }
          }
        }
);
      }
    }
,ModalityState.defaultModalityState());
  }
}
