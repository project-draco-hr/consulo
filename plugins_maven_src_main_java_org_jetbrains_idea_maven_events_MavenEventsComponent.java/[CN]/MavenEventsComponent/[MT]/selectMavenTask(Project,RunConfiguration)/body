{
  if (myTaskSelector == null) {
    return null;
  }
  final MavenTask mavenTask=myState.getTask(runConfiguration.getType(),runConfiguration.getName());
  if (!myTaskSelector.select(project,mavenTask != null ? mavenTask.pomPath : null,mavenTask != null ? mavenTask.goal : null,EventsBundle.message("maven.event.select.goal.title"))) {
    return mavenTask;
  }
  final String pomPath=myTaskSelector.getSelectedPomPath();
  if (pomPath != null) {
    final MavenTask newMavenTask=new MavenTask(pomPath,myTaskSelector.getSelectedGoal());
    if (!myState.isAssignedForType(runConfiguration.getType(),newMavenTask)) {
      myState.assignTask(runConfiguration.getType(),runConfiguration.getName(),newMavenTask);
      updateTaskShortcuts(newMavenTask);
    }
    return newMavenTask;
  }
  myState.clearAssignment(runConfiguration.getType(),runConfiguration.getName());
  updateShortcuts(null);
  return null;
}
