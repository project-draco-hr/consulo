{
  if (!withChildren || domElement == null || !domElement.isValid())   return getProblems(domElement);
  final Set<DomElementProblemDescriptor> problems=new HashSet<DomElementProblemDescriptor>();
  domElement.accept(new DomElementVisitor(){
    public void visitDomElement(    DomElement element){
      problems.addAll(getProblems(element,includeXmlProblems));
      element.acceptChildren(this);
    }
  }
);
  return new ArrayList<DomElementProblemDescriptor>(problems);
}
