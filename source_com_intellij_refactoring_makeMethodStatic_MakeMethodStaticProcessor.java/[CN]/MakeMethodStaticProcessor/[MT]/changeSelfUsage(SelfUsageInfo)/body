{
  PsiElement parent=usageInfo.getElement().getParent();
  LOG.assertTrue(parent instanceof PsiMethodCallExpression);
  PsiMethodCallExpression methodCall=(PsiMethodCallExpression)parent;
  PsiElementFactory factory=methodCall.getManager().getElementFactory();
  PsiExpressionList args=methodCall.getArgumentList();
  PsiElement addParameterAfter=null;
  if (mySettings.isMakeClassParameter()) {
    PsiElement arg=factory.createExpressionFromText(mySettings.getClassParameterName(),null);
    addParameterAfter=args.addAfter(arg,null);
  }
  if (mySettings.isMakeFieldParameters()) {
    List parameters=mySettings.getParameterOrderList();
    for (Iterator iterator=parameters.iterator(); iterator.hasNext(); ) {
      Settings.FieldParameter fieldParameter=(Settings.FieldParameter)iterator.next();
      PsiElement arg=factory.createExpressionFromText(fieldParameter.name,null);
      if (addParameterAfter == null) {
        addParameterAfter=args.addAfter(arg,null);
      }
 else {
        addParameterAfter=args.addAfter(arg,addParameterAfter);
      }
    }
  }
}
