{
  final ClsStubBuilderFactory[] factories=Extensions.getExtensions(ClsStubBuilderFactory.EP_NAME);
  for (  ClsStubBuilderFactory factory : factories) {
    if (factory.canBeProcessed(vFile,bytes)) {
      return factory.buildFileStub(vFile,bytes);
    }
  }
  final PsiJavaFileStubImpl file=new PsiJavaFileStubImpl("do.not.know.yet",true);
  try {
    final PsiClassStub result=buildClass(vFile,bytes,file,0);
    if (result == null)     return null;
    file.setPackageName(getPackageName(result));
  }
 catch (  Exception e) {
    throw new ClsFormatException();
  }
  return file;
}
