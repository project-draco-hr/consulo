{
  if (targetNode instanceof DefaultMutableTreeNode) {
    final Object userObject=((DefaultMutableTreeNode)targetNode).getUserObject();
    if (userObject instanceof DropTargetNode && ((DropTargetNode)userObject).canDrop(sourceNodes)) {
      ((DropTargetNode)userObject).drop(sourceNodes);
    }
  }
  final PsiElement[] sourceElements=getPsiElements(sourceNodes);
  final PsiElement targetElement=getPsiElement(targetNode);
  if (targetElement == null)   return;
  final DataContext dataContext=DataManager.getInstance().getDataContext(myTree);
  getActionHandler(dataContext).invoke(myProject,sourceElements,new DataContext(){
    @Nullable public Object getData(    @NonNls String dataId){
      if (dataId.equals(DataConstantsEx.TARGET_PSI_ELEMENT)) {
        return targetElement;
      }
 else {
        return dataContext.getData(dataId);
      }
    }
  }
);
}
