{
  final int flags=0xFF & record.readByte();
  if (flags == NULL_FLAGS) {
    return NULL;
  }
  final int frequentIndex=0xF & flags;
  byte arrayCount=(flags & 0x20) != 0 ? record.readByte() : 0;
  boolean isEllipsis=(flags & 0x40) != 0;
  StringRef text;
  if (frequentIndex == 0) {
    text=record.readName();
  }
 else {
    text=StringRef.fromString(ourIndexFrequentType.get(frequentIndex));
  }
  boolean annotationsArePresent=(flags & 0x10) != 0;
  List<PsiAnnotationStub> annotationStubs;
  if (annotationsArePresent) {
    int size=0xFF & record.readByte();
    annotationStubs=new ArrayList<PsiAnnotationStub>(size);
    for (int i=0; i < size; i++) {
      PsiAnnotationStub annotationStub=JavaStubElementTypes.ANNOTATION.deserialize(record,parentStub);
      annotationStubs.add(annotationStub);
    }
  }
 else {
    annotationStubs=Collections.emptyList();
  }
  return new TypeInfo(text,arrayCount,isEllipsis,annotationStubs);
}
