{
  return new IntentionAction(){
    @NotNull public String getText(){
      return GroovyInspectionBundle.message("optimize.all.imports");
    }
    @NotNull public String getFamilyName(){
      return GroovyInspectionBundle.message("optimize.imports");
    }
    public boolean isAvailable(    @NotNull Project project,    Editor editor,    PsiFile file){
      return true;
    }
    public void invoke(    @NotNull final Project project,    Editor editor,    PsiFile file) throws IncorrectOperationException {
      GroovyImportOptimizer optimizer=new GroovyImportOptimizer();
      final Runnable runnable=optimizer.processFile(file);
      try {
        ActionRunner.runInsideWriteAction(new ActionRunner.InterruptibleRunnable(){
          public void run(){
            CommandProcessor.getInstance().executeCommand(project,runnable,"optimize imports",this);
          }
        }
);
      }
 catch (      Exception e) {
        LOG.error(e);
      }
    }
    public boolean startInWriteAction(){
      return true;
    }
  }
;
}
