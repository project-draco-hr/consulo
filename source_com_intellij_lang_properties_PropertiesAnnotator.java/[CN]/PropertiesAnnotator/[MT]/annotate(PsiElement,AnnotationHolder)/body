{
  if (!(element instanceof Property))   return;
  final Property origProperty=(Property)element;
  PropertiesFile propertiesFile=(PropertiesFile)element.getContainingFile();
  final Property[] allProperties=propertiesFile.getProperties();
  int dupProperties=0;
  for (int i=0; i < allProperties.length; i++) {
    Property property=allProperties[i];
    if (property == element)     continue;
    if (Comparing.strEqual(property.getKey(),origProperty.getKey())) {
      dupProperties++;
      if (dupProperties > 0)       break;
    }
  }
  if (dupProperties > 0) {
    Annotation annotation=holder.createErrorAnnotation(((PropertyImpl)origProperty).getKeyNode(),"Duplicate property key");
    annotation.registerFix(new RemovePropertyFix(origProperty));
  }
}
