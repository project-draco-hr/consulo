{
  PsiElement result;
  while (true) {
    result=before ? element.getPrevSibling() : element.getNextSibling();
    if (result == null) {
      result=element.getParent();
      if (result instanceof PsiFile) {
        result=null;
      }
      if (result == null) {
        break;
      }
 else {
        element=result;
      }
    }
 else {
      break;
    }
  }
  while (result != null && result.getChildren().length != 0) {
    result=result.getChildren()[before ? result.getChildren().length - 1 : 0];
  }
  return result;
}
