{
  OT oldNode=myOldTree.prepareForGetChildren(oldN);
  NT newNode=myNewTree.prepareForGetChildren(newN);
  if (level >= myNewChildrenLists.size()) {
    myNewChildrenLists.add(new Ref<NT[]>());
    myOldChildrenLists.add(new Ref<OT[]>());
  }
  final Ref<OT[]> oldChildrenR=myOldChildrenLists.get(level);
  int oldSize=myOldTree.getChildren(oldNode,oldChildrenR);
  final OT[] oldChildren=oldChildrenR.get();
  final Ref<NT[]> newChildrenR=myNewChildrenLists.get(level);
  int newSize=myNewTree.getChildren(newNode,newChildrenR);
  final NT[] newChildren=newChildrenR.get();
  compareLevel(level,oldNode,oldSize,oldChildren,newNode,newSize,newChildren);
  disposeLevel(oldChildren,oldSize,newChildren,newSize);
}
