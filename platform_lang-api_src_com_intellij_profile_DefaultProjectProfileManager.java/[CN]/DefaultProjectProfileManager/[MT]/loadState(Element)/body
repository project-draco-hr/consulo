{
  myProfiles.clear();
  XmlSerializer.deserializeInto(this,state);
  for (  Element o : state.getChildren(PROFILE)) {
    Profile profile=myApplicationProfileManager.createProfile();
    profile.setProfileManager(this);
    try {
      profile.readExternal(o);
    }
 catch (    InvalidDataException e) {
      LOG.error(e);
    }
    profile.setProjectLevel(true);
    myProfiles.put(profile.getName(),profile);
  }
  if (state.getChild("version") == null || !Comparing.strEqual(state.getChild("version").getAttributeValue("value"),VERSION)) {
    boolean toConvert=true;
    for (    Element o : state.getChildren("option")) {
      if (Comparing.strEqual(o.getAttributeValue("name"),"USE_PROJECT_LEVEL_SETTINGS")) {
        toConvert=Boolean.parseBoolean(o.getAttributeValue("value"));
        break;
      }
    }
    if (toConvert) {
      convert(state);
    }
  }
}
