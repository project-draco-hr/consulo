{
  final List<Artifact> artifacts=artifact != null ? Collections.singletonList(artifact) : ArtifactUtil.getArtifactWithOutputPaths(project);
  final CompileScope scope=ArtifactCompileScope.createArtifactsScope(project,artifacts);
  ArtifactsWorkspaceSettings.getInstance(project).setArtifactsToBuild(ContainerUtil.createMaybeSingletonList(artifact));
  if (!rebuild) {
    CompilerManager.getInstance(project).make(scope,null);
  }
 else {
    CompilerManager.getInstance(project).compile(scope,null);
  }
}
