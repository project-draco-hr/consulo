{
  final int[] curOffset={0};
  root.acceptTree(new RecursiveTreeElementWalkingVisitor(){
    @Override public void visitLeaf(    LeafElement leaf){
      matchText(leaf);
    }
    private void matchText(    TreeElement leaf){
      curOffset[0]=leaf.textMatches(text,curOffset[0]);
      if (curOffset[0] < 0) {
        stopWalking();
      }
    }
    @Override public void visitComposite(    CompositeElement composite){
      myIndicator.checkCanceled();
      if (composite instanceof LazyParseableElement && !((LazyParseableElement)composite).isParsed()) {
        matchText(composite);
      }
 else {
        super.visitComposite(composite);
      }
    }
  }
);
  return curOffset[0] == text.length();
}
