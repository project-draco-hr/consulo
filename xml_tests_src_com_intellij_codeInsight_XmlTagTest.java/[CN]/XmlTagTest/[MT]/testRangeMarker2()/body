{
  final XmlTag root=createTag("file.xhtml","<a>1<b>234</b>567</a>");
  final XmlTag tag=root.findFirstSubTag("b");
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    @Override public void run(){
      CommandProcessor.getInstance().executeCommand(getProject(),new Runnable(){
        @Override public void run(){
          Document document=PsiDocumentManager.getInstance(getProject()).getDocument(root.getContainingFile());
          XmlTagChild child=tag.getValue().getChildren()[0];
          assertTrue(child instanceof XmlText && child.getText().equals("234"));
          try {
            tag.getParent().addBefore(child,tag);
            assertEquals(7,tag.getTextOffset());
            RangeMarker marker=document.createRangeMarker(4,7);
            tag.delete();
            assertEquals(4,marker.getStartOffset());
            assertEquals(7,marker.getEndOffset());
          }
 catch (          IncorrectOperationException e) {
          }
        }
      }
,"",null);
    }
  }
);
}
