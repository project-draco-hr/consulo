{
  String text=toDisplay(tagText);
  XmlTag tag=XmlElementFactory.getInstance(getProject()).createTagFromText("<a>" + tagText + "</a>");
  final PsiElement[] children=tag.getValue().getTextElements();
  assertEquals(1,children.length);
  final XmlText xmlText=(XmlText)children[0];
  assertEquals(tagText,xmlText.getText());
  for (int i=0; i <= text.length(); i++) {
    final int physical=xmlText.displayToPhysical(i);
    final int display=xmlText.physicalToDisplay(physical);
    assertEquals("Coords mapping failed for: '" + tagText + "' - "+ physical,display,i);
  }
  assertEquals("Coords mapping failed for: '" + tagText + "'",0,xmlText.physicalToDisplay(0));
  assertEquals(tagText.length(),xmlText.displayToPhysical(text.length()));
  assertEquals(text.length(),xmlText.physicalToDisplay(tagText.length()));
}
