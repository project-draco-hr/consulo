{
  String packageName=clsFile.getPackageName();
  PsiClass[] classes=clsFile.getClasses();
  if (classes.length == 0)   return clsFile;
  String sourceFileName=((ClsClassImpl)classes[0]).getSourceFileName();
  String relativeFilePath=packageName.length() == 0 ? sourceFileName : packageName.replace('.','/') + '/' + sourceFileName;
  final VirtualFile vFile=clsFile.getContainingFile().getVirtualFile();
  ProjectFileIndex projectFileIndex=ProjectFileIndex.SERVICE.getInstance(clsFile.getProject());
  final List<OrderEntry> orderEntries=projectFileIndex.getOrderEntriesForFile(vFile);
  for (  OrderEntry orderEntry : orderEntries) {
    VirtualFile[] files=orderEntry.getFiles(OrderRootType.SOURCES);
    for (    VirtualFile file : files) {
      VirtualFile source=file.findFileByRelativePath(relativeFilePath);
      if (source != null) {
        PsiFile psiSource=clsFile.getManager().findFile(source);
        if (psiSource instanceof PsiClassOwner) {
          return psiSource;
        }
      }
    }
  }
  return clsFile;
}
