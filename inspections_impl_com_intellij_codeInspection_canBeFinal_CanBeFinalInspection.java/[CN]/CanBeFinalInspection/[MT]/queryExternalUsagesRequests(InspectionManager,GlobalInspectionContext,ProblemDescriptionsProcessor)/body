{
  for (  SmartRefElementPointer entryPoint : globalContext.getRefManager().getEntryPointsManager().getEntryPoints()) {
    final RefEntity refElement=entryPoint.getRefElement();
    if (refElement != null) {
      problemsProcessor.ignoreElement(refElement);
    }
  }
  globalContext.getRefManager().iterate(new RefVisitor(){
    @Override public void visitElement(    RefEntity refEntity){
      if (problemsProcessor.getDescriptions(refEntity) == null)       return;
      refEntity.accept(new RefVisitor(){
        @Override public void visitMethod(        final RefMethod refMethod){
          if (!refMethod.isStatic() && !PsiModifier.PRIVATE.equals(refMethod.getAccessModifier()) && !(refMethod instanceof RefImplicitConstructor)) {
            globalContext.enqueueDerivedMethodsProcessor(refMethod,new GlobalInspectionContextImpl.DerivedMethodsProcessor(){
              public boolean process(              PsiMethod derivedMethod){
                ((RefElementImpl)refMethod).setFlag(false,CanBeFinalAnnotator.CAN_BE_FINAL_MASK);
                problemsProcessor.ignoreElement(refMethod);
                return false;
              }
            }
);
          }
        }
        @Override public void visitClass(        final RefClass refClass){
          if (!refClass.isAnonymous()) {
            globalContext.enqueueDerivedClassesProcessor(refClass,new GlobalInspectionContextImpl.DerivedClassesProcessor(){
              public boolean process(              PsiClass inheritor){
                ((RefClassImpl)refClass).setFlag(false,CanBeFinalAnnotator.CAN_BE_FINAL_MASK);
                problemsProcessor.ignoreElement(refClass);
                return false;
              }
            }
);
          }
        }
        @Override public void visitField(        final RefField refField){
          globalContext.enqueueFieldUsagesProcessor(refField,new GlobalInspectionContextImpl.UsagesProcessor(){
            public boolean process(            PsiReference psiReference){
              PsiElement expression=psiReference.getElement();
              if (expression instanceof PsiReferenceExpression && PsiUtil.isAccessedForWriting((PsiExpression)expression)) {
                ((RefFieldImpl)refField).setFlag(false,CanBeFinalAnnotator.CAN_BE_FINAL_MASK);
                problemsProcessor.ignoreElement(refField);
                return false;
              }
              return true;
            }
          }
);
        }
      }
);
    }
  }
);
  return false;
}
