{
  if (ApplicationManager.getApplication().isUnitTestMode()) {
    doInitProjectIndices(p);
  }
  MavenProjectsManager.Listener l=new MavenProjectsManager.Listener(){
    public void activate(){
      doInitProjectIndices(p);
    }
    public void profilesChanged(    List<String> profiles){
    }
    public void setIgnored(    VirtualFile file,    boolean on){
    }
    public void projectAdded(    MavenProjectModel n){
      if (!myMavenProjectIndices.containsKey(p))       return;
      addArtifact(myMavenProjectIndices.get(p),n.getMavenId());
    }
    public void projectRemoved(    MavenProjectModel n){
      if (!myMavenProjectIndices.containsKey(p))       return;
      myMavenProjectIndices.get(p).removeArtifact(n.getMavenId());
    }
    public void beforeProjectUpdate(    MavenProjectModel n){
      projectRemoved(n);
    }
    public void projectUpdated(    MavenProjectModel n){
      projectAdded(n);
    }
  }
;
  MavenProjectsManager.getInstance(p).addListener(l);
  myMavenProjectListeners.put(p,l);
}
