{
  if (file == null)   return null;
  final VirtualFile[] result=new VirtualFile[1];
  ApplicationManager.getApplication().runReadAction(new Runnable(){
    public void run(){
      result[0]=LocalFileSystem.getInstance().findFileByPath(file.getAbsolutePath().replace(File.separatorChar,'/'));
    }
  }
);
  if (result[0] != null)   return result[0];
  ApplicationManager.getApplication().runReadAction(new Runnable(){
    public void run(){
      result[0]=LocalFileSystem.getInstance().findFileByIoFile(file);
    }
  }
);
  return result[0];
}
