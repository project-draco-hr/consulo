{
  if (nodeDescriptor instanceof AbstractTreeNode) {
    Object value;
    if (nodeDescriptor instanceof NodeDescriptorProvidingKey)     value=((NodeDescriptorProvidingKey)nodeDescriptor).getKey();
 else     value=((AbstractTreeNode)nodeDescriptor).getValue();
    if (value instanceof PsiElement && ((PsiElement)value).isValid()) {
      return value.toString();
    }
  }
  return nodeDescriptor.toString();
}
