{
  if (!isValid())   return;
  DocumentEventImpl event=(DocumentEventImpl)e;
  if (event.isWholeTextReplaced()) {
    myLine=event.translateLineViaDiff(myLine);
    if (myLine < 0 || myLine >= getDocument().getLineCount()) {
      invalidate();
    }
 else {
      myStart=MarkupModelImpl.getFirstNonspaceCharOffset(getDocument(),myLine);
      myEnd=myStart;
    }
  }
 else {
    super.documentChanged(e);
    if (isValid()) {
      myLine=getDocument().getLineNumber(myStart);
    }
  }
}
