{
  final OffsetKey castInsertion=OffsetKey.create("castInsertion",false);
  context.getOffsetMap().addOffset(castInsertion,context.getStartOffset());
  super.handleInsert(context);
  final int newStart=context.getOffsetMap().getOffset(castInsertion);
  final CodeStyleSettings settings=CodeStyleSettingsManager.getSettings(context.getProject());
  String spaceWithin=settings.SPACE_WITHIN_CAST_PARENTHESES ? " " : "";
  String spaceAfter=settings.SPACE_AFTER_TYPE_CAST ? " " : "";
  context.getEditor().getDocument().insertString(newStart,"(" + spaceWithin + spaceWithin+ ")"+ spaceAfter);
  emulateInsertion(context,("(" + spaceWithin).length() + newStart,myCastItem);
}
