{
  final PathMacrosCollector collector=new PathMacrosCollector();
  collector.substitute(root,true,false,filter,recursiveFilter);
  final HashSet<String> result=new HashSet<String>(collector.myMacroMap.keySet());
  result.removeAll(ourSystemMacroNames);
  result.removeAll(PathMacrosImpl.getToolMacroNames());
  result.removeAll(PathMacros.getInstance().getIgnoredMacroNames());
  return result;
}
