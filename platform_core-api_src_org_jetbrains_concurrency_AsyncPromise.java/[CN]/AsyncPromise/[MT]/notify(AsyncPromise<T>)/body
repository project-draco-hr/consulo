{
  LOG.assertTrue(child != this);
switch (state) {
case PENDING:
    break;
case FULFILLED:
  child.setResult((T)result);
return;
case REJECTED:
child.setError((Throwable)result);
return;
}
addHandlers(new Consumer<T>(){
@Override public void consume(T result){
try {
child.setResult(result);
}
 catch (Throwable e) {
child.setError(e);
}
}
}
,new Consumer<Throwable>(){
@Override public void consume(Throwable error){
child.setError(error);
}
}
);
}
