{
  MessageBusConnection connection=myProject.getMessageBus().connect(myProject);
  connection.subscribe(ProjectTopics.PROJECT_ROOTS,new ModuleRootListener(){
    public void beforeRootsChange(    ModuleRootEvent event){
    }
    public void rootsChanged(    ModuleRootEvent event){
      ApplicationManager.getApplication().invokeLater(new Runnable(){
        public void run(){
          if (myProject.isDisposed() || !DirectoryIndex.getInstance(myProject).isInitialized())           return;
          VcsDirtyScopeManager.getInstance(myProject).markEverythingDirty();
        }
      }
,ModalityState.NON_MODAL);
    }
  }
);
  final WolfTheProblemSolver.ProblemListener myProblemListener=new MyProblemListener();
  WolfTheProblemSolver.getInstance(myProject).addProblemListener(myProblemListener,myProject);
}
