{
  Document document=editor.getDocument();
  CharSequence chars=document.getCharsSequence();
  endOffset=CharArrayUtil.shiftBackward(chars,endOffset - 1,"\n\r") + 1;
  PsiDocumentManager.getInstance(project).commitAllDocuments();
  PsiFile file=PsiDocumentManager.getInstance(project).getPsiFile(document);
  CodeStyleManager codeStyleManager=CodeStyleManager.getInstance(project);
  try {
    codeStyleManager.adjustLineIndent(file,new TextRange(startOffset,endOffset));
  }
 catch (  IncorrectOperationException e) {
    LOG.error(e);
  }
}
