{
  if (disposed) {
    throw new MyException("Punching the dead horse: URL=" + toString(),getUserData(CREATE_TRACE),getUserData(KILL_TRACE));
  }
  if (--useCount == 0) {
    if (TRACE_CREATION) {
      putUserData(KILL_TRACE,new Throwable());
    }
    disposed=true;
    final Pair<VirtualFile,String> pair=myFileAndUrl;
    VirtualFile file=pair.first;
    if (file != null) {
      ((VirtualFilePointerManagerImpl)VirtualFilePointerManager.getInstance()).clearPointerCaches(file.getUrl(),myListener);
    }
    String url=pair.second;
    if (url != null && (file == null || !FileUtil.pathsEqual(url,file.getUrl()))) {
      ((VirtualFilePointerManagerImpl)VirtualFilePointerManager.getInstance()).clearPointerCaches(url,myListener);
    }
  }
}
