{
  if (disposed)   return null;
  long lastUpdated=myLastUpdated;
  Pair<VirtualFile,String> fileAndUrl=myFileAndUrl;
  VirtualFile file=fileAndUrl.first;
  String url=fileAndUrl.second;
  long fsModCount=myVirtualFileManager.getModificationCount();
  if (lastUpdated == fsModCount)   return fileAndUrl;
  if (file != null && !file.isValid()) {
    if (url == null) {
      url=file.getUrl();
    }
    file=null;
  }
  if (file == null) {
    LOG.assertTrue(url != null,"Both file & URL are null");
    file=myVirtualFileManager.findFileByUrl(url);
    if (file != null && url.equals(file.getUrl())) {
      url=null;
    }
  }
  if (file != null && !file.exists()) {
    if (url == null) {
      url=file.getUrl();
    }
    file=null;
  }
  Pair<VirtualFile,String> result=Pair.create(file,url);
  myFileAndUrl=result;
  myLastUpdated=fsModCount;
  return result;
}
