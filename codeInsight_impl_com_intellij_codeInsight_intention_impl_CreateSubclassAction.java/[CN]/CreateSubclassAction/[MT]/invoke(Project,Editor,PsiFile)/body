{
  PsiElement element=file.findElementAt(editor.getCaretModel().getOffset());
  final PsiClass psiClass=PsiTreeUtil.getParentOfType(element,PsiClass.class);
  PsiDirectory sourceDir=file.getContainingDirectory();
  final PsiPackage aPackage=JavaDirectoryService.getInstance().getPackage(sourceDir);
  final CreateClassDialog dialog=new CreateClassDialog(project,myText,psiClass.getName() + IMPL_SUFFIX,aPackage != null ? aPackage.getQualifiedName() : "",CreateClassKind.CLASS,true,ModuleUtil.findModuleForPsiElement(file));
  dialog.show();
  if (!dialog.isOK())   return;
  final PsiDirectory targetDirectory=dialog.getTargetDirectory();
  if (targetDirectory == null)   return;
  createSubclass(psiClass,targetDirectory,dialog.getClassName());
}
