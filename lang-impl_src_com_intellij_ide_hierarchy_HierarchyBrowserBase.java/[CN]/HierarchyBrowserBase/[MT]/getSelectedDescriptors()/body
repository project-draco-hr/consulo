{
  final JTree tree=getCurrentTree();
  if (tree == null) {
    return EMPTY_DESCRIPTORS;
  }
  final TreePath[] paths=tree.getSelectionPaths();
  if (paths == null || paths.length == 0) {
    return EMPTY_DESCRIPTORS;
  }
  final ArrayList<HierarchyNodeDescriptor> list=new ArrayList<HierarchyNodeDescriptor>(paths.length);
  for (  final TreePath path : paths) {
    final Object lastPathComponent=path.getLastPathComponent();
    if (lastPathComponent instanceof DefaultMutableTreeNode) {
      final DefaultMutableTreeNode node=(DefaultMutableTreeNode)lastPathComponent;
      HierarchyNodeDescriptor descriptor=getDescriptor(node);
      if (descriptor != null) {
        list.add(descriptor);
      }
    }
  }
  return list.toArray(new HierarchyNodeDescriptor[list.size()]);
}
