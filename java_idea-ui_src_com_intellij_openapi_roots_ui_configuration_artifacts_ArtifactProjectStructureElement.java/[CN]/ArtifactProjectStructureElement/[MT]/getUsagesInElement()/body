{
  final Artifact artifact=myArtifactsStructureContext.getArtifactModel().getArtifactByOriginal(myOriginalArtifact);
  final List<ProjectStructureElementUsage> usages=new ArrayList<ProjectStructureElementUsage>();
  ArtifactUtil.processPackagingElements(myArtifactsStructureContext.getRootElement(artifact),null,new PackagingElementProcessor<PackagingElement<?>>(){
    @Override public boolean process(    @NotNull PackagingElement<?> packagingElement,    @NotNull PackagingElementPath path){
      if (packagingElement instanceof ModuleOutputPackagingElement) {
        final Module module=((ModuleOutputPackagingElement)packagingElement).findModule(myArtifactsStructureContext);
        if (module != null) {
          usages.add(createUsage(packagingElement,path,new ModuleProjectStructureElement(myContext,module)));
        }
      }
 else       if (packagingElement instanceof LibraryPackagingElement) {
        final Library library=((LibraryPackagingElement)packagingElement).findLibrary(myArtifactsStructureContext);
        if (library != null) {
          usages.add(createUsage(packagingElement,path,new LibraryProjectStructureElement(ArtifactProjectStructureElement.this.myContext,library)));
        }
      }
 else       if (packagingElement instanceof ArtifactPackagingElement) {
        final Artifact usedArtifact=((ArtifactPackagingElement)packagingElement).findArtifact(myArtifactsStructureContext);
        if (usedArtifact != null) {
          final ArtifactProjectStructureElement artifactElement=myArtifactsStructureContext.getOrCreateArtifactElement(usedArtifact);
          usages.add(createUsage(packagingElement,path,artifactElement));
        }
      }
      return true;
    }
  }
,myArtifactsStructureContext,false,artifact.getArtifactType());
  return usages;
}
