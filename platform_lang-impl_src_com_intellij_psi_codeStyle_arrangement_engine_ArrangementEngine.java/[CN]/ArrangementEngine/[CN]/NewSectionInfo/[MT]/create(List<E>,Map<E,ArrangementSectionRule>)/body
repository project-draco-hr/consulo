{
  final NewSectionInfo<E> info=new NewSectionInfo<E>();
  boolean sectionIsOpen=false;
  ArrangementSectionRule prevSection=null;
  E prev=null;
  for (  E e : arranged) {
    final ArrangementSectionRule section=entryToSection.get(e);
    if (section != prevSection) {
      closeSection(prevSection,prev,info,sectionIsOpen);
      sectionIsOpen=false;
      if (section != null) {
        final String startComment=section.getStartComment();
        if (StringUtil.isNotEmpty(startComment) && !isSectionEntry(e,startComment)) {
          sectionIsOpen=true;
          info.addSectionStart(e,startComment);
        }
      }
      prevSection=section;
    }
    prev=e;
  }
  closeSection(prevSection,prev,info,sectionIsOpen);
  return info;
}
