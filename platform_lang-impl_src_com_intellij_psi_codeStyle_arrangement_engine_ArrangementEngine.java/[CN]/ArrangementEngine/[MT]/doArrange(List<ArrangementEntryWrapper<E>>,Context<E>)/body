{
  if (wrappers.isEmpty()) {
    return;
  }
  Map<E,ArrangementEntryWrapper<E>> map=new LinkedHashMap<E,ArrangementEntryWrapper<E>>();
  for (  ArrangementEntryWrapper<E> wrapper : wrappers) {
    map.put(wrapper.getEntry(),wrapper);
  }
  List<E> arranged=arrange(map.keySet(),context.rules);
  context.changer.prepare(wrappers,context);
  for (int i=arranged.size() - 1; i >= 0; i--) {
    ArrangementEntryWrapper<E> arrangedWrapper=map.get(arranged.get(i));
    ArrangementEntryWrapper<E> initialWrapper=wrappers.get(i);
    context.changer.replace(arrangedWrapper,initialWrapper,i > 0 ? map.get(arranged.get(i - 1)) : null,context);
  }
}
