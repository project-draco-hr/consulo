{
  final Presentation presentation=e.getPresentation();
  CaptionSelection selection=(CaptionSelection)e.getDataContext().getData(CaptionSelection.class.getName());
  if (selection == null) {
    presentation.setEnabled(false);
  }
 else {
    presentation.setEnabled(selection.getContainer() != null);
    if (!selection.isRow()) {
      presentation.setText(UIDesignerBundle.message("action.insert.column.before.this"));
      presentation.setIcon(IconLoader.getIcon("/com/intellij/uiDesigner/icons/insertColumnLeft.png"));
    }
 else {
      presentation.setText(UIDesignerBundle.message("action.insert.row.before.this"));
      presentation.setIcon(IconLoader.getIcon("/com/intellij/uiDesigner/icons/insertRowAbove.png"));
    }
  }
}
