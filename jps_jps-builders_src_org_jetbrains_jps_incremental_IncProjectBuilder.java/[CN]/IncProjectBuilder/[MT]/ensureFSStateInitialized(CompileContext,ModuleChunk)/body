{
  final ProjectDescriptor pd=context.getProjectDescriptor();
  final Timestamps timestamps=pd.timestamps.getStorage();
  for (  Module module : chunk.getModules()) {
    if (context.isProjectRebuild()) {
      FSOperations.markDirtyFiles(context,module,timestamps,true,context.isCompilingTests() ? FSOperations.DirtyMarkScope.TESTS : FSOperations.DirtyMarkScope.PRODUCTION,null);
      updateOutputRootsLayout(context,module);
    }
 else {
      if (context.isMake()) {
        if (pd.fsState.markInitialScanPerformed(module.getName(),context.isCompilingTests())) {
          initModuleFSState(context,module);
          updateOutputRootsLayout(context,module);
        }
      }
 else {
        if (context.getScope().isRecompilationForced(module.getName())) {
          FSOperations.markDirtyFiles(context,module,timestamps,true,context.isCompilingTests() ? FSOperations.DirtyMarkScope.TESTS : FSOperations.DirtyMarkScope.PRODUCTION,null);
          updateOutputRootsLayout(context,module);
        }
      }
    }
  }
}
