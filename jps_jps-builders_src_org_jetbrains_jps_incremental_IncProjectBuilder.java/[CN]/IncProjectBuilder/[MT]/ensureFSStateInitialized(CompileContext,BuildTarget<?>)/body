{
  final ProjectDescriptor pd=context.getProjectDescriptor();
  final Timestamps timestamps=pd.timestamps.getStorage();
  final BuildTargetConfiguration configuration=pd.getTargetsState().getTargetConfiguration(target);
  if (context.isProjectRebuild() || configuration.isTargetDirty() || context.getScope().isRecompilationForced(target)) {
    FSOperations.markDirtyFiles(context,target,timestamps,true,null,Collections.<File>emptySet());
    configuration.save();
  }
 else   if (context.isMake()) {
    if (pd.fsState.markInitialScanPerformed(target)) {
      FSOperations.markDirtyFiles(context,target,timestamps,false,null,Collections.<File>emptySet());
    }
  }
}
