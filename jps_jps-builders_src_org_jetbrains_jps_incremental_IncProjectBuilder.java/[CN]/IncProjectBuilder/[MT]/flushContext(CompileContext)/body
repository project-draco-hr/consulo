{
  if (context != null) {
    context.getProjectDescriptor().timestamps.getStorage().force();
    context.getDataManager().flush(false);
  }
  final ExternalJavacDescriptor descriptor=ExternalJavacDescriptor.KEY.get(context);
  if (descriptor != null) {
    try {
      final RequestFuture future=descriptor.client.sendShutdownRequest();
      future.waitFor(500L,TimeUnit.MILLISECONDS);
    }
  finally {
      descriptor.process.destroyProcess();
    }
    ExternalJavacDescriptor.KEY.set(context,null);
  }
  cleanupJavacNameTable();
}
