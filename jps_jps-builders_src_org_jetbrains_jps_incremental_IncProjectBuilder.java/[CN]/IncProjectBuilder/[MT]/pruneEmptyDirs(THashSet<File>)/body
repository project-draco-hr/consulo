{
  THashSet<File> additionalDirs=null;
  THashSet<File> toDelete=dirsToDelete;
  while (toDelete != null) {
    for (    File file : toDelete) {
      final boolean deleted=file.delete();
      if (deleted) {
        final File parentFile=file.getParentFile();
        if (parentFile != null) {
          if (additionalDirs == null) {
            additionalDirs=new THashSet<File>(FileUtil.FILE_HASHING_STRATEGY);
          }
          additionalDirs.add(parentFile);
        }
      }
    }
    toDelete=additionalDirs;
    additionalDirs=null;
  }
}
