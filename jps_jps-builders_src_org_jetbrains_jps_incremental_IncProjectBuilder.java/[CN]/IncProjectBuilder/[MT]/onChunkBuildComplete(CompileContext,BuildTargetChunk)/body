{
  final ProjectDescriptor pd=context.getProjectDescriptor();
  final BuildFSState fsState=pd.fsState;
  fsState.clearContextRoundData(context);
  fsState.clearContextChunk(context);
  if (!Utils.errorsDetected(context) && !context.getCancelStatus().isCanceled()) {
    boolean marked=false;
    for (    BuildTarget<?> target : chunk.getTargets()) {
      if (context.isMake() && target instanceof ModuleBuildTarget) {
        context.clearNonIncrementalMark((ModuleBuildTarget)target);
      }
      if (context.isProjectRebuild()) {
        fsState.markInitialScanPerformed(target);
      }
      final Timestamps timestamps=pd.timestamps.getStorage();
      for (      BuildRootDescriptor rd : pd.getBuildRootIndex().getTargetRoots(target,context)) {
        marked|=fsState.markAllUpToDate(context,rd,timestamps);
      }
    }
    if (marked) {
      context.processMessage(UptoDateFilesSavedEvent.INSTANCE);
    }
  }
}
