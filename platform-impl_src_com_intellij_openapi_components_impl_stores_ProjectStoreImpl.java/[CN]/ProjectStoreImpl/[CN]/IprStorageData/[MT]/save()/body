{
  final Element root=super.save();
  root.removeChildren(USED_MACROS_ELEMENT_NAME);
  if (!myUsedMacros.isEmpty()) {
    Element usedMacrosElement=new Element(USED_MACROS_ELEMENT_NAME);
    for (    String usedMacro : myUsedMacros.keySet()) {
      Element macroElement=new Element(ELEMENT_MACRO);
      macroElement.setAttribute(NAME_ATTR,usedMacro);
      final String description=myUsedMacros.get(usedMacro);
      if (description != null && description.trim().length() > 0) {
        macroElement.setAttribute(DESCRIPTION_ATTR,description);
      }
      usedMacrosElement.addContent(macroElement);
    }
    root.addContent(usedMacrosElement);
  }
  return root;
}
