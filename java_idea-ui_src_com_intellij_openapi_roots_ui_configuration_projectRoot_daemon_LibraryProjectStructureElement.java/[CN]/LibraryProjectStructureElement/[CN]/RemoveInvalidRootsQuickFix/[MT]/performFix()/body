{
  final LibraryTable.ModifiableModel libraryTable=myContext.getModifiableLibraryTable(myLibrary.getTable());
  if (libraryTable instanceof LibrariesModifiableModel) {
    for (    OrderRootType rootType : myInvalidRoots.keySet()) {
      for (      String invalidRoot : myInvalidRoots.get(rootType)) {
        final ExistingLibraryEditor libraryEditor=((LibrariesModifiableModel)libraryTable).getLibraryEditor(myLibrary);
        libraryEditor.removeRoot(invalidRoot,rootType);
      }
    }
    myContext.getDaemonAnalyzer().queueUpdate(LibraryProjectStructureElement.this);
    final ProjectStructureConfigurable structureConfigurable=ProjectStructureConfigurable.getInstance(myContext.getProject());
    createPlace().navigate().doWhenDone(new Runnable(){
      @Override public void run(){
        final NamedConfigurable configurable=structureConfigurable.getConfigurableFor(myLibrary).getSelectedConfugurable();
        if (configurable instanceof LibraryConfigurable) {
          ((LibraryConfigurable)configurable).updateComponent();
        }
      }
    }
);
  }
}
