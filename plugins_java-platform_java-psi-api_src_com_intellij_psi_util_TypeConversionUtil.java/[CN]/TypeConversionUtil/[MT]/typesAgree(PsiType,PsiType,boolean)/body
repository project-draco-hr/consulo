{
  if (typeLeft instanceof PsiWildcardType) {
    final PsiWildcardType leftWildcard=(PsiWildcardType)typeLeft;
    final PsiType leftBound=leftWildcard.getBound();
    if (leftBound == null)     return true;
    if (leftBound.equalsToText(CommonClassNames.JAVA_LANG_OBJECT)) {
      if (!leftWildcard.isSuper())       return true;
      if (typeRight.equalsToText(CommonClassNames.JAVA_LANG_OBJECT))       return true;
    }
    if (typeRight instanceof PsiWildcardType) {
      final PsiWildcardType rightWildcard=(PsiWildcardType)typeRight;
      if (leftWildcard.isExtends()) {
        return rightWildcard.isExtends() && isAssignable(leftBound,rightWildcard.getBound(),allowUncheckedConversion);
      }
 else {
        if (rightWildcard.isSuper()) {
          final Boolean assignable=ourGuard.doPreventingRecursion(rightWildcard,true,new NotNullComputable<Boolean>(){
            @Override public Boolean compute(){
              return isAssignable(rightWildcard.getBound(),leftBound,allowUncheckedConversion);
            }
          }
);
          if (assignable != null && assignable.booleanValue()) {
            return true;
          }
        }
        return false;
      }
    }
 else {
      boolean effectiveAllowUncheckedConversion=allowUncheckedConversion;
      if (typeRight instanceof PsiCapturedWildcardType) {
        effectiveAllowUncheckedConversion=false;
        final PsiClass psiClass=PsiUtil.resolveClassInType(((PsiCapturedWildcardType)typeRight).getWildcard().getBound());
        if (psiClass != null && !psiClass.hasTypeParameters()) {
          effectiveAllowUncheckedConversion=allowUncheckedConversion;
        }
      }
      if (leftWildcard.isExtends()) {
        return isAssignable(leftBound,typeRight,effectiveAllowUncheckedConversion && !containsWildcards(leftBound));
      }
 else {
        return isAssignable(typeRight,leftBound,effectiveAllowUncheckedConversion && !containsWildcards(leftBound));
      }
    }
  }
 else {
    return typeLeft.equals(typeRight);
  }
}
