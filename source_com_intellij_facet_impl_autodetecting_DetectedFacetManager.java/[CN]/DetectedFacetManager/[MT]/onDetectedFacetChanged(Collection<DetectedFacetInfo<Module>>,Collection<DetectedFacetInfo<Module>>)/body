{
  if (!myUIInitialized)   return;
  if (!ApplicationManager.getApplication().isHeadlessEnvironment()) {
    final boolean stopBlinking=myDetectedFacetSet.getAllDetectedFacets().isEmpty();
    Runnable runnable=new Runnable(){
      public void run(){
        if (isDisposed())         return;
        if (!removed.isEmpty() && myNotificationPopup != null) {
          myNotificationPopup.cancel();
        }
        myPendingNewFacets.addAll(added);
        queueNotificationPopup();
        if (stopBlinking) {
          myAttentionComponent.stopBlinking();
        }
        if (!added.isEmpty()) {
          myAttentionComponent.startBlinking();
        }
      }
    }
;
    if (ApplicationManager.getApplication().isDispatchThread() && ApplicationManager.getApplication().getCurrentModalityState() == ModalityState.NON_MODAL) {
      runnable.run();
    }
 else {
      ApplicationManager.getApplication().invokeLater(runnable,ModalityState.NON_MODAL);
    }
  }
}
