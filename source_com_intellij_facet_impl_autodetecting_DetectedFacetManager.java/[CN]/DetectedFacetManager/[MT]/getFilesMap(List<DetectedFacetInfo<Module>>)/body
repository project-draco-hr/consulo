{
  HashMap<DetectedFacetInfo<Module>,List<VirtualFile>> filesMap=new HashMap<DetectedFacetInfo<Module>,List<VirtualFile>>();
  Iterator<DetectedFacetInfo<Module>> iterator=detectedFacets.iterator();
  while (iterator.hasNext()) {
    DetectedFacetInfo<Module> detected=iterator.next();
    Set<String> urls=myAutodetectingManager.getFileIndex().getFiles(detected.getId());
    List<VirtualFile> files=new ArrayList<VirtualFile>();
    if (urls != null) {
      for (      String url : urls) {
        VirtualFile file=VirtualFileManager.getInstance().findFileByUrl(url);
        if (file != null) {
          files.add(file);
        }
      }
    }
    if (!files.isEmpty()) {
      filesMap.put(detected,files);
    }
 else {
      iterator.remove();
    }
  }
  return filesMap;
}
