{
  Map<String,Set<String>> artifactIdsMap=new HashMap<String,Set<String>>();
  Map<String,Set<String>> versionsMap=new HashMap<String,Set<String>>();
  IndexReader r=context.getIndexReader();
  int total=r.numDocs();
  for (int i=0; i < total; i++) {
    progress.setFraction(i / total);
    if (r.isDeleted(i))     continue;
    Document doc=r.document(i);
    String uinfo=doc.get(ArtifactInfo.UINFO);
    if (uinfo == null)     continue;
    List<String> parts=StringUtil.split(uinfo,"|");
    String groupId=parts.get(0);
    String artifactId=parts.get(1);
    String version=parts.get(2);
    data.groupIds.add(groupId);
    data.artifactIds.add(groupId + ":" + artifactId);
    data.versions.add(groupId + ":" + artifactId+ ":"+ version);
    getOrCreate(artifactIdsMap,groupId).add(artifactId);
    getOrCreate(versionsMap,groupId + ":" + artifactId).add(version);
  }
  persist(artifactIdsMap,data.artifactIdsMap);
  persist(versionsMap,data.versionsMap);
}
