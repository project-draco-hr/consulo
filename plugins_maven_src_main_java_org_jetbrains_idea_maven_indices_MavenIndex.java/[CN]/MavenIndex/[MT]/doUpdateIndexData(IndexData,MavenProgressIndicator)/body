{
  Set<String> groups=new THashSet<String>();
  Set<String> groupsWithArtifacts=new THashSet<String>();
  Set<String> groupsWithArtifactsWithVersions=new THashSet<String>();
  Map<String,Set<String>> groupToArtifactMap=new THashMap<String,Set<String>>();
  Map<String,Set<String>> groupWithArtifactToVersionMap=new THashMap<String,Set<String>>();
  List<MavenId> artifacts=data.getAllArtifacts();
  int total=artifacts.size();
  for (int i=0; i < total; i++) {
    progress.setFraction(i / total);
    MavenId each=artifacts.get(i);
    String groupId=each.getGroupId();
    String artifactId=each.getArtifactId();
    String version=each.getVersion();
    groups.add(groupId);
    groupsWithArtifacts.add(groupId + ":" + artifactId);
    groupsWithArtifactsWithVersions.add(groupId + ":" + artifactId+ ":"+ version);
    getOrCreate(groupToArtifactMap,groupId).add(artifactId);
    getOrCreate(groupWithArtifactToVersionMap,groupId + ":" + artifactId).add(version);
  }
  persist(groups,data.groups);
  persist(groupsWithArtifacts,data.groupsWithArtifacts);
  persist(groupsWithArtifactsWithVersions,data.groupsWithArtifactsWithVersions);
  persist(groupToArtifactMap,data.groupToArtifactMap);
  persist(groupWithArtifactToVersionMap,data.groupWithArtifactToVersionMap);
}
