{
  Set<String> groups=new THashSet<String>();
  Set<String> groupsWithArtifacts=new THashSet<String>();
  Set<String> groupsWithArtifactsWithVersions=new THashSet<String>();
  Map<String,Set<String>> groupToArtifactMap=new THashMap<String,Set<String>>();
  Map<String,Set<String>> groupWithArtifactToVersionMap=new THashMap<String,Set<String>>();
  IndexReader r=data.context.getIndexReader();
  int total=r.numDocs();
  for (int i=0; i < total; i++) {
    progress.setFraction(i / total);
    if (r.isDeleted(i))     continue;
    Document doc=r.document(i);
    String uinfo=doc.get(ArtifactInfo.UINFO);
    if (uinfo == null)     continue;
    List<String> parts=StringUtil.split(uinfo,"|");
    String groupId=parts.get(0);
    String artifactId=parts.get(1);
    String version=parts.get(2);
    if (groupId == null || artifactId == null || version == null)     continue;
    groups.add(groupId);
    groupsWithArtifacts.add(groupId + ":" + artifactId);
    groupsWithArtifactsWithVersions.add(groupId + ":" + artifactId+ ":"+ version);
    getOrCreate(groupToArtifactMap,groupId).add(artifactId);
    getOrCreate(groupWithArtifactToVersionMap,groupId + ":" + artifactId).add(version);
  }
  persist(groups,data.groups);
  persist(groupsWithArtifacts,data.groupsWithArtifacts);
  persist(groupsWithArtifactsWithVersions,data.groupsWithArtifactsWithVersions);
  persist(groupToArtifactMap,data.groupToArtifactMap);
  persist(groupWithArtifactToVersionMap,data.groupWithArtifactToVersionMap);
}
