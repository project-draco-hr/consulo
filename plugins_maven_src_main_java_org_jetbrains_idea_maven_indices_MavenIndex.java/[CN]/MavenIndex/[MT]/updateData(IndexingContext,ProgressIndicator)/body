{
  progress.setText2("Updating caches...");
  String newDataDir=findAvailableDataDir();
  IndexData newData=openData(newDataDir);
  try {
    doUpdateIndexData(context,newData,progress);
    newData.flush();
  }
 catch (  Throwable e) {
    newData.close();
    FileUtil.delete(getDataDir(newDataDir));
    if (e instanceof IOException)     throw (IOException)e;
    throw new RuntimeException(e);
  }
synchronized (this) {
    IndexData oldData=myData;
    String oldDataDir=myDataDirName;
    myData=newData;
    myDataDirName=newDataDir;
    oldData.close();
    FileUtil.delete(getDataDir(oldDataDir));
  }
}
