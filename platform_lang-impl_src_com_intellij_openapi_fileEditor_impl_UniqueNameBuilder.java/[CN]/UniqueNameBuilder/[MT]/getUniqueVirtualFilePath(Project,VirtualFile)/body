{
  final PsiFile[] filesWithSameName=FilenameIndex.getFilesByName(project,file.getName(),ProjectScope.getProjectScope(project));
  if (filesWithSameName.length > 1) {
    String path=project.getBasePath();
    path=path == null ? "" : FileUtil.toSystemIndependentName(path);
    UniqueNameBuilder<VirtualFile> builder=new UniqueNameBuilder<VirtualFile>(path,File.separator,25);
    for (    PsiFile psiFile : filesWithSameName) {
      final VirtualFile virtualFile=psiFile.getVirtualFile();
      if (virtualFile != null) {
        builder.addPath(virtualFile,virtualFile.getPath());
      }
    }
    return builder.getShortPath(file);
  }
  return null;
}
