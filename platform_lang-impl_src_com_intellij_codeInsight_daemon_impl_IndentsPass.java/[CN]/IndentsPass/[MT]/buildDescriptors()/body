{
  if (!myEditor.getSettings().isIndentGuidesShown())   return Collections.emptyList();
  int[] lineIndents=calcIndents(myDocument);
  List<IndentGuideDescriptor> descriptors=new ArrayList<IndentGuideDescriptor>();
  IntStack lines=new IntStack();
  IntStack indents=new IntStack();
  lines.push(0);
  indents.push(0);
  for (int line=1; line < lineIndents.length; line++) {
    int curIndent=lineIndents[line];
    while (!indents.empty() && curIndent <= indents.peek()) {
      final int level=indents.pop();
      int startLine=lines.pop();
      descriptors.add(new IndentGuideDescriptor(level,startLine,line));
    }
    int prevLine=line - 1;
    int prevIndent=lineIndents[prevLine];
    if (curIndent - prevIndent > 1) {
      lines.push(prevLine);
      indents.push(prevIndent);
    }
  }
  while (!indents.empty()) {
    final int level=indents.pop();
    if (level > 0) {
      int startLine=lines.pop();
      descriptors.add(new IndentGuideDescriptor(level,startLine,myDocument.getLineCount()));
    }
  }
  return descriptors;
}
