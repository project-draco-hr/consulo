{
  final Long stamp=myEditor.getUserData(LAST_TIME_INDENTS_BUILT);
  if (stamp != null && stamp.longValue() == nowStamp())   return;
  myDescriptors=buildDescriptors();
  ArrayList<TextRange> ranges=new ArrayList<TextRange>();
  for (  IndentGuideDescriptor descriptor : myDescriptors) {
    ProgressManager.checkCanceled();
    int endOffset=descriptor.endLine < myDocument.getLineCount() ? myDocument.getLineStartOffset(descriptor.endLine) : myDocument.getTextLength();
    ranges.add(new TextRange(myDocument.getLineStartOffset(descriptor.startLine),endOffset));
  }
  Collections.sort(ranges,RANGE_COMPARATOR);
  myRanges=ranges;
}
