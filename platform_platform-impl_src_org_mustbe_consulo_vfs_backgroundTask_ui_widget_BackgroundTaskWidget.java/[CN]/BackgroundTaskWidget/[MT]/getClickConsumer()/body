{
  return new Consumer<MouseEvent>(){
    @Override public void consume(    MouseEvent mouseEvent){
      if (myVirtualFile == null) {
        return;
      }
      DefaultActionGroup group=new DefaultActionGroup();
      group.add(new DumbAwareAction("Force Run",null,AllIcons.Actions.Resume){
        @RequiredDispatchThread @Override public void actionPerformed(        @NotNull AnActionEvent e){
          BackgroundTaskByVfsChangeManager.getInstance(myProject).runTasks(myVirtualFile);
        }
        @RequiredDispatchThread @Override public void update(        @NotNull AnActionEvent e){
          e.getPresentation().setEnabled(!BackgroundTaskByVfsChangeManager.getInstance(myProject).findEnabledTasks(myVirtualFile).isEmpty());
        }
      }
);
      group.add(new DumbAwareAction("Manage",null,AllIcons.General.Settings){
        @RequiredDispatchThread @Override public void actionPerformed(        @NotNull AnActionEvent e){
          BackgroundTaskByVfsChangeManager.getInstance(myProject).openManageDialog(myVirtualFile);
        }
      }
);
      ListPopup choose=JBPopupFactory.getInstance().createActionGroupPopup(getTooltipText(),group,DataManager.getInstance().getDataContext(mouseEvent.getComponent()),null,true);
      Dimension dimension=choose.getContent().getPreferredSize();
      Point at=new Point(0,-dimension.height);
      choose.show(new RelativePoint(mouseEvent.getComponent(),at));
    }
  }
;
}
