{
  final Descriptor descriptor=toolNode.getDescriptor();
  Project project=myProjectProfileManager.getProject();
  if (descriptor != null) {
    final HighlightDisplayKey key=descriptor.getKey();
    final String toolShortName=key.toString();
    if (toolNode.isChecked()) {
      if (toolNode.getScope(project) != null) {
        if (toolNode.isByDefault()) {
          mySelectedProfile.enableToolByDefault(toolShortName,project);
        }
 else {
          mySelectedProfile.enableTool(toolShortName,toolNode.getScope(project),project);
        }
      }
 else {
        mySelectedProfile.enableTool(toolShortName,project);
      }
    }
 else {
      if (toolNode.getScope(project) != null) {
        if (toolNode.isByDefault()) {
          mySelectedProfile.disableToolByDefault(toolShortName,project);
        }
 else {
          mySelectedProfile.disableTool(toolShortName,toolNode.getScope(project),project);
        }
      }
 else       if (toolNode.getChildCount() == 0) {
        mySelectedProfile.disableTool(toolShortName,project);
      }
    }
    toolNode.dropCache();
    updateUpHierarchy(toolNode,(InspectionConfigTreeNode)toolNode.getParent());
  }
  final TreePath path=new TreePath(toolNode.getPath());
  if (Comparing.equal(myTree.getSelectionPath(),path)) {
    updateOptionsAndDescriptionPanel(path);
  }
}
