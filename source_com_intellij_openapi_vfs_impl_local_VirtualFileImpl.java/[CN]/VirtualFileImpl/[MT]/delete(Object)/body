{
  LOG.assertTrue(isValid());
  PhysicalFile physicalFile=getPhysicalFile();
  VirtualFileImpl parent=(VirtualFileImpl)getParent();
  if (parent == null) {
    throw new IOException("Cannot delete root file " + physicalFile.getPath() + ".");
  }
  myFileSystem.fireBeforeFileDeletion(requestor,this);
  boolean isDirectory=isDirectory();
  if (!myFileSystem.auxDelete(this)) {
    delete(physicalFile);
  }
  parent.removeChild(this);
  myFileSystem.fireFileDeleted(requestor,this,myName,isDirectory,parent);
}
