{
  if (getParent() == null) {
    return;
  }
  if (myName.equals(newName)) {
    return;
  }
  if (isInvalidName(newName)) {
    throw new IOException("Invalid file name: \"" + newName + "\"");
  }
  myFileSystem.fireBeforePropertyChange(requestor,this,PROP_NAME,myName,newName);
  String oldName=myName;
  if (myFileSystem.auxRename(this,newName)) {
    setName(newName);
  }
 else {
    PhysicalFile file=getPhysicalFile();
    setName(newName);
    PhysicalFile newFile=getPhysicalFile();
    if (!file.renameTo(newFile)) {
      setName(file.getName());
      throw new IOException("Cannot rename file " + file.getPath() + " to "+ newFile.getPath()+ ".");
    }
  }
  myFileSystem.firePropertyChanged(requestor,this,PROP_NAME,oldName,myName);
}
