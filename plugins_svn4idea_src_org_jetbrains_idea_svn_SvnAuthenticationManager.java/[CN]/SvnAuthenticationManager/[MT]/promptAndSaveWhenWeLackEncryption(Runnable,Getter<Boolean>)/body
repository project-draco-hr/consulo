{
  final Boolean[] saveOnce=new Boolean[1];
  final Runnable actualSave=new Runnable(){
    @Override public void run(){
      final Thread currentThread=Thread.currentThread();
      myPlainTextAllowed.put(currentThread,Boolean.TRUE.equals(saveOnce[0]));
      try {
        saveRunnable.run();
      }
  finally {
        myPlainTextAllowed.remove(currentThread);
      }
    }
  }
;
  if (myInteraction.promptInAwt()) {
    new AbstractCalledLater(myProject,getCurrent()){
      @Override public void run(){
        saveOnce[0]=Boolean.TRUE.equals(prompt.get());
        ApplicationManager.getApplication().executeOnPooledThread(actualSave);
      }
    }
.callMe();
  }
 else {
    saveOnce[0]=Boolean.TRUE.equals(prompt.get());
    actualSave.run();
  }
}
