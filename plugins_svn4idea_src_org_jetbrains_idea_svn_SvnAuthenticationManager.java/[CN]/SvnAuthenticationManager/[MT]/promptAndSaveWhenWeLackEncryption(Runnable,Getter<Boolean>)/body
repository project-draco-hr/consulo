{
  final Runnable actualSave=new Runnable(){
    @Override public void run(){
      final Thread currentThread=Thread.currentThread();
      myPlainTextAllowed.add(currentThread);
      try {
        saveRunnable.run();
      }
  finally {
        myPlainTextAllowed.remove(currentThread);
      }
    }
  }
;
  if (myInteraction.promptInAwt()) {
    new AbstractCalledLater(myProject,getCurrent()){
      @Override public void run(){
        final boolean saveOnce=Boolean.TRUE.equals(prompt.get());
        if (saveOnce) {
          ApplicationManager.getApplication().executeOnPooledThread(actualSave);
        }
 else {
        }
      }
    }
.callMe();
  }
 else {
    final boolean saveOnce=Boolean.TRUE.equals(prompt.get());
    if (saveOnce) {
      actualSave.run();
    }
  }
}
