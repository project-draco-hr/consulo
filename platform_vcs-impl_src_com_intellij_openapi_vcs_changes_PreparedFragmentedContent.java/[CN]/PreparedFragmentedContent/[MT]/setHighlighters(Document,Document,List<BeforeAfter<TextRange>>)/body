{
  EditorHighlighterFactory editorHighlighterFactory=EditorHighlighterFactory.getInstance();
  final SyntaxHighlighter syntaxHighlighter=SyntaxHighlighter.PROVIDER.create(myFileType,myProject,null);
  final EditorHighlighter highlighter=editorHighlighterFactory.createEditorHighlighter(syntaxHighlighter,EditorColorsManager.getInstance().getGlobalScheme());
  highlighter.setEditor(new LightHighlighterClient(oldDocument,myProject));
  highlighter.setText(oldDocument.getText());
  HighlighterIterator iterator=highlighter.createIterator(ranges.get(0).getBefore().getStartOffset());
  FragmentedEditorHighlighter beforeHighlighter=new FragmentedEditorHighlighter(iterator,getBeforeFragments());
  setBeforeHighlighter(beforeHighlighter);
  final EditorHighlighter highlighter1=editorHighlighterFactory.createEditorHighlighter(syntaxHighlighter,EditorColorsManager.getInstance().getGlobalScheme());
  highlighter1.setEditor(new LightHighlighterClient(document,myProject));
  highlighter1.setText(document.getText());
  HighlighterIterator iterator1=highlighter1.createIterator(ranges.get(0).getAfter().getStartOffset());
  FragmentedEditorHighlighter afterHighlighter=new FragmentedEditorHighlighter(iterator1,getAfterFragments());
  setAfterHighlighter(afterHighlighter);
}
