{
  if (dir.isDirectory()) {
    if (FileTypeManager.getInstance().isFileIgnored(dir)) {
      return null;
    }
    for (    final Map.Entry<String,Collection<VirtualFile>> entry : myPackagePrefixRoots.entrySet()) {
      if (entry.getValue().contains(dir)) {
        return entry.getKey();
      }
    }
    final VirtualFile parent=dir.getParent();
    if (parent != null) {
      return getPackageNameForSubdir(getPackageName(parent),dir.getName());
    }
  }
  return null;
}
