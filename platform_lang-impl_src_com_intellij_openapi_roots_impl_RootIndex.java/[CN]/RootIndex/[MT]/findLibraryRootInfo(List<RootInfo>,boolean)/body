{
  Set<Library> excludedFromLibraries=ContainerUtil.newHashSet();
  for (  RootInfo info : hierarchy) {
    excludedFromLibraries.addAll(info.excludedFromLibraries);
    if (source && !info.libSourceRootEntries.isEmpty() && (info.sourceOfLibraries.isEmpty() || !excludedFromLibraries.containsAll(info.sourceOfLibraries))) {
      return info;
    }
 else     if (!source && !info.libClassRootEntries.isEmpty() && (info.classOfLibraries.isEmpty() || !excludedFromLibraries.containsAll(info.classOfLibraries))) {
      return info;
    }
  }
  return null;
}
