{
  final RootInfo info=buildRootInfo(project);
  Set<VirtualFile> allRoots=info.getAllRoots();
  for (  VirtualFile root : allRoots) {
    List<VirtualFile> hierarchy=getHierarchy(root,allRoots);
    Pair<DirectoryInfo,String> pair=hierarchy == null ? new Pair<DirectoryInfo,String>(null,null) : info.calcDirectoryInfo(root,hierarchy);
    cacheInfos(root,root,pair.first);
    myPackagePrefixRoots.putValue(pair.second,root);
    if (info.shouldMarkAsProjectExcluded(root,hierarchy)) {
      myProjectExcludedRoots.add(root);
    }
  }
}
