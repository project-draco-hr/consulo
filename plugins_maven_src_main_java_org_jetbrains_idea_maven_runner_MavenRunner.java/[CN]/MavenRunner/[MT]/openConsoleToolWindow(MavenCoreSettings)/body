{
  if (ApplicationManager.getApplication().isUnitTestMode()) {
    return new TestConsoleAdapter();
  }
  if (myMavenOutputWindowPanel == null) {
    myMavenOutputWindowPanel=new MavenRunnerOutputPanel();
    Disposer.register(myProject,myMavenOutputWindowPanel);
  }
  if (!isToolWindowOpen()) {
    ToolWindowManager.getInstance(myProject).registerToolWindow(OUTPUT_TOOL_WINDOW_ID,myMavenOutputWindowPanel.getRootComponent(),ToolWindowAnchor.BOTTOM).show(null);
  }
  ConsoleView consoleView=createConsoleView();
  myMavenOutputWindowPanel.attachConsole(consoleView);
  return new ConsoleAdapterImpl(consoleView,coreSettings.getOutputLevel(),coreSettings.isPrintErrorStackTraces());
}
