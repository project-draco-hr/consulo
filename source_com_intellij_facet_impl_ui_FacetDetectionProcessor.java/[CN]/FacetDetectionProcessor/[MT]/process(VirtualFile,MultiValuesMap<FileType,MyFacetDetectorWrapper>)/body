{
  if (myProgressIndicator.isCanceled())   return;
  if (file.isDirectory()) {
    file.getChildren();
    file.refresh(false,false);
    VirtualFile[] children=file.getChildren();
    for (    VirtualFile child : children) {
      process(child,detectorsMap);
    }
    return;
  }
  myProgressIndicator.setText2(file.getPresentableUrl());
  FileType fileType=myFileTypeManager.getFileTypeByFile(file);
  Collection<MyFacetDetectorWrapper> detectors=detectorsMap.get(fileType);
  if (detectors == null)   return;
  for (  MyFacetDetectorWrapper detector : detectors) {
    detector.detectFacet(file);
  }
}
