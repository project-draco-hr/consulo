{
  myFacetType=facetType;
  int level=0;
  FacetTypeId<?> typeId=facetType.getUnderlyingFacetType();
  Set<FacetTypeId> parentTypes=new HashSet<FacetTypeId>();
  parentTypes.add(facetType.getId());
  while (typeId != null) {
    level++;
    FacetType<?,?> underlying=FacetTypeRegistry.getInstance().findFacetType(typeId);
    LOG.assertTrue(underlying != null,"Cannot find underlying facet type by id: " + typeId + " (for facet "+ facetType.getId()+ ")");
    typeId=underlying.getUnderlyingFacetType();
    if (!parentTypes.add(typeId)) {
      LOG.error("Circular dependency between facets: " + parentTypes);
      break;
    }
  }
  myLevel=level;
}
