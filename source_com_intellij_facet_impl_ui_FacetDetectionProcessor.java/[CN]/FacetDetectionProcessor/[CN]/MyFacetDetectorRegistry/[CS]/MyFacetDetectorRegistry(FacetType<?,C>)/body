{
  myFacetType=facetType;
  myLevel=0;
  FacetTypeId<?> typeId=facetType.getUnderlyingFacetType();
  Set<FacetTypeId> parentTypes=new HashSet<FacetTypeId>();
  parentTypes.add(facetType.getId());
  while (typeId != null) {
    myLevel++;
    FacetType<?,?> underlying=FacetTypeRegistry.getInstance().findFacetType(typeId);
    LOG.assertTrue(underlying != null,"Cannot find facet type by id: " + typeId);
    typeId=underlying.getUnderlyingFacetType();
    if (!parentTypes.add(typeId)) {
      LOG.error("Circular dependency between facets: " + parentTypes);
    }
  }
}
