{
  FontMetrics defFontMetrics=getFontMetrics(getFont());
  int width=getTextOffset();
  if (myText.length() != 0) {
    if (myHighlightedRegions.size() == 0) {
      width+=defFontMetrics.stringWidth(myText);
    }
 else {
      int endIndex=0;
      for (      HighlightedRegion hRegion : myHighlightedRegions) {
        width+=defFontMetrics.stringWidth(myText.substring(endIndex,hRegion.startOffset));
        endIndex=hRegion.endOffset;
        String text=getRegionText(hRegion);
        FontMetrics fontMetrics=myFontMetrics.get(hRegion.textAttributes.getFontType());
        width+=fontMetrics.stringWidth(text);
      }
      width+=defFontMetrics.stringWidth(myText.substring(endIndex,myText.length()));
    }
  }
  int height=defFontMetrics.getHeight() + defFontMetrics.getLeading();
  if (myIcon != null) {
    height=Math.max(myIcon.getIconHeight() + defFontMetrics.getLeading(),height);
  }
  return new Dimension(width + 2,height);
}
