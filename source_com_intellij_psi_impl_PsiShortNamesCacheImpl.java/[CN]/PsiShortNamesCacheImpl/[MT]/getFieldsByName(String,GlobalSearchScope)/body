{
synchronized (PsiLock.LOCK) {
    VirtualFileFilter filter=getRepositoryIndex().rootFilterBySearchScope(scope);
    long[] fieldIds=getRepositoryIndex().getFieldsByName(name,filter);
    if (fieldIds.length == 0)     return PsiField.EMPTY_ARRAY;
    ArrayList<PsiElement> list=new ArrayList<PsiElement>();
    addElementsByIds(list,fieldIds,scope);
    return list.toArray(new PsiField[list.size()]);
  }
}
