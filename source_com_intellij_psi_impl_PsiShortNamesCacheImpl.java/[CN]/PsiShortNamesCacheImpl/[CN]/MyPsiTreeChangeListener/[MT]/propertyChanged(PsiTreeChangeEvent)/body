{
  if (!myInitialized)   return;
  String propertyName=event.getPropertyName();
  if (PsiTreeChangeEvent.PROP_FILE_NAME.equals(propertyName)) {
    PsiFile file=(PsiFile)event.getElement();
    String oldName=(String)event.getOldValue();
    releaseFile(file,oldName);
    VirtualFile vFile=file.getVirtualFile();
    if (myProjectFileIndex.isInContent(vFile)) {
      cacheFile(file);
    }
  }
 else   if (propertyName.equals(PsiTreeChangeEvent.PROP_ROOTS)) {
    myInitialized=false;
  }
 else   if (propertyName.equals(PsiTreeChangeEvent.PROP_FILE_TYPES)) {
    myInitialized=false;
  }
}
