{
  final ConfigFile[] deploymentDescriptors=getDeploymentDescriptors();
  ApplicationManager.getApplication().runReadAction(new Runnable(){
    public void run(){
      for (      ConfigFile descriptor : deploymentDescriptors) {
        VirtualFile virtualFile=descriptor.getVirtualFile();
        if (virtualFile != null) {
          ConfigFileMetaData metaData=descriptor.getMetaData();
          final File file=VfsUtil.virtualToIoFile(virtualFile);
          final String fileName;
          if (metaData.isFileNameFixed()) {
            fileName=metaData.getFileName();
          }
 else {
            fileName=virtualFile.getName();
          }
          instructions.addFileCopyInstruction(file,false,myModule,metaData.getDirectoryPath() + "/" + fileName,null);
        }
      }
      final CustomConfigFile[] customDescriptors=getCustomDescriptors();
      for (      CustomConfigFile descriptor : customDescriptors) {
        final String url=descriptor.getUrl();
        final VirtualFile virtualFile=VirtualFileManager.getInstance().findFileByUrl(url);
        if (virtualFile != null) {
          File file=VfsUtil.virtualToIoFile(virtualFile);
          instructions.addFileCopyInstruction(file,false,myModule,descriptor.getOutputDirectoryPath() + "/" + virtualFile.getName(),null);
        }
      }
    }
  }
);
}
