{
  if (!dir.isDirectory()) {
    return;
  }
  FileTypeManager typeManager=FileTypeManager.getInstance();
  if (typeManager.isFileIgnored(dir.getName())) {
    return;
  }
  final ProgressIndicator progressIndicator=ProgressManager.getInstance().getProgressIndicator();
  if (progressIndicator != null) {
    if (progressIndicator.isCanceled()) {
      return;
    }
    progressIndicator.setText2(dir.getPath());
  }
  VirtualFile[] list=dir.getChildren();
  if (list == null || list.length == 0) {
    return;
  }
  for (  VirtualFile child : list) {
    if (!child.isDirectory()) {
      FileType type=typeManager.getFileTypeByFileName(child.getName());
      if (StdFileTypes.JAVA == type) {
        if (progressIndicator != null && progressIndicator.isCanceled()) {
          return;
        }
        VirtualFile root=suggestRootForJavaFile(child);
        if (root != null) {
          foundDirectories.add(root);
          throw new PathFoundException(root);
        }
 else {
          return;
        }
      }
    }
  }
  for (  VirtualFile child : list) {
    if (child.isDirectory()) {
      try {
        suggestRootsImpl(child,foundDirectories);
      }
 catch (      PathFoundException found) {
        if (!found.myDirectory.equals(child)) {
          throw found;
        }
      }
    }
  }
}
