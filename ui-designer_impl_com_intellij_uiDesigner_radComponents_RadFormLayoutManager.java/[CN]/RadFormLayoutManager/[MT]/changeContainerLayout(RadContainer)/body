{
  if (container.getLayout() instanceof GridLayoutManager) {
    GridLayoutManager grid=(GridLayoutManager)container.getLayout();
    RowSpec[] rowSpecs=new RowSpec[grid.getRowCount() * 2 - 1];
    ColumnSpec[] colSpecs=new ColumnSpec[grid.getColumnCount() * 2 - 1];
    for (int i=0; i < grid.getRowCount(); i++) {
      rowSpecs[i * 2]=grid.willGrow(true,i) ? new RowSpec(ENCODED_FORMSPEC_GROW) : FormFactory.DEFAULT_ROWSPEC;
      if (i * 2 + 1 < rowSpecs.length) {
        rowSpecs[i * 2 + 1]=FormFactory.RELATED_GAP_ROWSPEC;
      }
    }
    for (int i=0; i < grid.getColumnCount(); i++) {
      colSpecs[i * 2]=grid.willGrow(false,i) ? new ColumnSpec(ENCODED_FORMSPEC_GROW) : FormFactory.DEFAULT_COLSPEC;
      if (i * 2 + 1 < colSpecs.length) {
        colSpecs[i * 2 + 1]=FormFactory.RELATED_GAP_COLSPEC;
      }
    }
    List<RadComponent> contents=new ArrayList<RadComponent>();
    for (int i=container.getComponentCount() - 1; i >= 0; i--) {
      final RadComponent component=container.getComponent(i);
      if (!(component instanceof RadHSpacer) && !(component instanceof RadVSpacer)) {
        contents.add(0,component);
      }
      container.removeComponent(component);
    }
    container.setLayoutManager(this,new FormLayout(colSpecs,rowSpecs));
    for (    RadComponent c : contents) {
      GridConstraints gc=c.getConstraints();
      gc.setRow(gc.getRow() * 2);
      gc.setColumn(gc.getColumn() * 2);
      container.addComponent(c);
    }
  }
 else   if (container.getComponentCount() == 0) {
    container.setLayoutManager(this,new FormLayout(ENCODED_FORMSPEC_GROW,ENCODED_FORMSPEC_GROW));
  }
 else {
    throw new IncorrectOperationException("Cannot change from " + container.getLayout() + " to grid layout");
  }
}
