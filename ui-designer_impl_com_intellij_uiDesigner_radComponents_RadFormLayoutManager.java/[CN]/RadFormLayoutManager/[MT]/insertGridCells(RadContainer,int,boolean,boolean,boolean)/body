{
  FormLayout formLayout=(FormLayout)grid.getLayout();
  int index=isBefore ? cellIndex + 1 : cellIndex + 2;
  if (isRow) {
    insertOrAppendRow(formLayout,index,FormFactory.RELATED_GAP_ROWSPEC);
    if (!isBefore)     index++;
    insertOrAppendRow(formLayout,index,grow ? new RowSpec(ENCODED_FORMSPEC_GROW) : FormFactory.DEFAULT_ROWSPEC);
  }
 else {
    insertOrAppendColumn(formLayout,index,FormFactory.RELATED_GAP_COLSPEC);
    if (!isBefore)     index++;
    insertOrAppendColumn(formLayout,index,grow ? new ColumnSpec(ENCODED_FORMSPEC_GROW) : FormFactory.DEFAULT_COLSPEC);
  }
  updateGridConstraintsFromCellConstraints(grid);
  return 2;
}
