{
  String fileTypeName=typeElement.getAttributeValue(ATTRIBUTE_NAME);
  String fileTypeDescr=typeElement.getAttributeValue(ATTRIBUTE_DESCRIPTION);
  String iconPath=typeElement.getAttributeValue(ATTRIBUTE_ICON);
  String extensionsStr=typeElement.getAttributeValue(ATTRIBUTE_EXTENSIONS);
  SyntaxTable table=null;
  Element element=typeElement.getChild(ELEMENT_HIGHLIGHTING);
  if (element != null) {
    table=readSyntaxTable(element);
  }
  FileType type=getFileTypeByName(fileTypeName);
  List<FileNameMatcher> exts=parse(extensionsStr);
  if (type != null) {
    if (extensionsStr != null) {
      removeAllAssociations(type);
      for (      FileNameMatcher ext : exts) {
        associate(type,ext,false);
      }
    }
    if (table != null && type instanceof CustomFileType) {
      ((CustomFileType)type).setSyntaxTable(table);
    }
  }
 else {
    if (table != null) {
      type=new CustomFileType(table);
      ((CustomFileType)type).initSupport();
    }
 else {
      type=new UserBinaryFileType();
    }
    registerFileTypeWithoutNotification(type,exts);
  }
  if (type instanceof UserFileType) {
    UserFileType ft=(UserFileType)type;
    if (iconPath != null && !"".equals(iconPath.trim())) {
      Icon icon=IconLoader.getIcon(iconPath);
      if (icon != null)       ft.setIcon(icon);
    }
    if (fileTypeDescr != null)     ft.setDescription(fileTypeDescr);
    if (fileTypeName != null)     ft.setName(fileTypeName);
  }
  if (isDefaults) {
    myDefaultTypes.add(type);
    if (table != null) {
      myDefaultTables.put(type,table);
    }
  }
  return type;
}
