{
  Color color=UIUtil.getListForeground();
  SimpleTextAttributes attributes=null;
  String locationString=null;
  if (value instanceof NodeDescriptor) {
    final NodeDescriptor descriptor=(NodeDescriptor)value;
    setIcon(descriptor.getClosedIcon());
    final Color elementColor=descriptor.getColor();
    if (elementColor != null) {
      color=elementColor;
    }
    if (descriptor instanceof AbstractTreeNode) {
      final AbstractTreeNode treeNode=(AbstractTreeNode)descriptor;
      final TextAttributesKey attributesKey=treeNode.getAttributesKey();
      if (attributesKey != null) {
        final TextAttributes textAttributes=EditorColorsManager.getInstance().getGlobalScheme().getAttributes(attributesKey);
        if (textAttributes != null)         attributes=SimpleTextAttributes.fromTextAttributes(textAttributes);
      }
      locationString=treeNode.getLocationString();
    }
  }
  if (attributes == null)   attributes=new SimpleTextAttributes(Font.PLAIN,color);
  final String text=value.toString();
  append(text != null ? text : "",attributes);
  if (locationString != null && locationString.length() > 0) {
    append(" (" + locationString + ")",SimpleTextAttributes.GRAY_ATTRIBUTES);
  }
}
