{
  final Component focusOwner=IdeFocusManager.getGlobalInstance().getFocusOwner();
  if (focusOwner != null) {
    final Window window=focusOwner instanceof JFrame ? (Window)focusOwner : SwingUtilities.getWindowAncestor(focusOwner);
    if (window instanceof JFrame) {
      return (Frame)window;
    }
  }
  return null;
}
