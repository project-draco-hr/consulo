{
  if (graphComponent.isEnabled() && isEnabled() && !e.isConsumed()&& current != null) {
    mxGraph graph=graphComponent.getGraph();
    double scale=graph.getView().getScale();
    mxPoint tr=graph.getView().getTranslate();
    current.setX(current.getX() / scale - tr.getX());
    current.setY(current.getY() / scale - tr.getY());
    current.setWidth(current.getWidth() / scale);
    current.setHeight(current.getHeight() / scale);
    Object cell=insertCell(current);
    eventSource.fireEvent(new mxEventObject(mxEvent.INSERT,"cell",cell));
    e.consume();
  }
  reset();
}
