{
  final Editor editor=PlatformDataKeys.EDITOR.getData(e.getDataContext());
  if (editor == null)   return;
  final PsiFile psiFile=HandlerUtils.getPsiFile(editor,e.getDataContext());
  if (!(psiFile instanceof GroovyFile))   return;
  int offset=editor.getCaretModel().getOffset();
  List<GrExpression> expressions=GrIntroduceHandlerBase.collectExpressions(psiFile,editor,offset);
  if (expressions.size() == 1) {
    passInner(expressions.get(0));
  }
 else {
    IntroduceTargetChooser.showChooser(editor,expressions,new Pass<GrExpression>(){
      @Override public void pass(      GrExpression grExpression){
        passInner(grExpression);
      }
    }
,new Function<GrExpression,String>(){
      @Override public String fun(      GrExpression grExpression){
        return grExpression.getText();
      }
    }
);
  }
}
