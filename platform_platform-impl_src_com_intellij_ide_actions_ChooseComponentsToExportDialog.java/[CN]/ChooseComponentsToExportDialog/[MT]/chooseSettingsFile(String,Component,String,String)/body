{
  FileChooserDescriptor chooserDescriptor=FileChooserDescriptorFactory.createSingleLocalFileDescriptor();
  chooserDescriptor.setDescription(description);
  chooserDescriptor.setHideIgnored(false);
  chooserDescriptor.setTitle(title);
  VirtualFile initialDir;
  if (oldPath != null) {
    final File oldFile=new File(oldPath);
    initialDir=LocalFileSystem.getInstance().findFileByIoFile(oldFile);
    if (initialDir == null && oldFile.getParentFile() != null) {
      initialDir=LocalFileSystem.getInstance().findFileByIoFile(oldFile.getParentFile());
    }
  }
 else {
    initialDir=null;
  }
  final VirtualFile file=FileChooser.chooseFile(chooserDescriptor,parent,null,initialDir);
  if (file == null) {
    return null;
  }
  String path;
  if (file.isDirectory()) {
    String defaultName=new File(DEFAULT_PATH).getName();
    path=file.getPath() + "/" + defaultName;
  }
 else {
    path=file.getPath();
  }
  return path;
}
