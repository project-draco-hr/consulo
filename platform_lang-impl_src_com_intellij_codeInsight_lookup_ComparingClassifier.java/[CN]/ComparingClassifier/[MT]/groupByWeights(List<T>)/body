{
  TreeMap<Comparable,List<T>> map=new TreeMap<Comparable,List<T>>();
  for (  T t : source) {
    final Comparable weight=getWeight(t);
    List<T> list=map.get(weight);
    if (list == null) {
      map.put(weight,list=new SmartList<T>());
    }
    list.add(t);
  }
  return map;
}
