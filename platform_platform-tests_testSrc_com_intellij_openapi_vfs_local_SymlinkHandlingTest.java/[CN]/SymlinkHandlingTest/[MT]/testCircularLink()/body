{
  final File upDir=createTempDirectory(myTempDir,"sub.",".dir");
  final File upLinkFile=IoTestUtil.createSymLink(upDir.getPath(),upDir.getPath() + "/up_link");
  final VirtualFile upLinkVFile=refreshAndFind(upLinkFile);
  assertNotNull(upLinkVFile);
  assertTrue(upLinkVFile.isSymLink());
  assertTrue(upLinkVFile.isDirectory());
  assertPathsEqual(upDir.getPath(),upLinkVFile.getCanonicalPath());
  assertVisitedPaths(upDir.getPath(),upLinkVFile.getPath());
  final File repeatedLinksFile=new File(upDir.getPath() + StringUtil.repeat(File.separator + upLinkFile.getName(),4));
  assertTrue(repeatedLinksFile.getPath(),repeatedLinksFile.isDirectory());
  final VirtualFile repeatedLinksVFile=refreshAndFind(repeatedLinksFile);
  assertNotNull(repeatedLinksFile.getPath(),repeatedLinksVFile);
  assertTrue(repeatedLinksVFile.isSymLink());
  assertTrue(repeatedLinksVFile.isDirectory());
  assertPathsEqual(upDir.getPath(),repeatedLinksVFile.getCanonicalPath());
  assertEquals(upLinkVFile.getCanonicalFile(),repeatedLinksVFile.getCanonicalFile());
}
