{
  final File upDir=createTempDirectory(myTempDir,"sub.",".dir");
  final File upLinkFile=createTempLink(upDir.getPath(),upDir.getPath() + "/up_link");
  final VirtualFile upLinkVFile=refreshAndFind(upLinkFile);
  assertNotNull(upLinkVFile);
  assertTrue(upLinkVFile.isSymLink());
  assertTrue(upLinkVFile.isDirectory());
  assertEquals(upDir.getPath(),upLinkVFile.getCanonicalPath());
  assertVisitedPaths(upDir.getPath(),upLinkVFile.getPath());
  final File nestedLinksFile=new File(upDir.getPath() + StringUtil.repeat(File.separator + upLinkFile.getName(),4));
  assertTrue(nestedLinksFile.getPath(),nestedLinksFile.isDirectory());
  final VirtualFile nestedLinksVFile=refreshAndFind(nestedLinksFile);
  assertNotNull(nestedLinksFile.getPath(),nestedLinksVFile);
  assertEquals(upLinkVFile.getCanonicalFile(),nestedLinksVFile.getCanonicalFile());
}
