{
  final File targetDir1=createTempDirectory(myTempDir,"target1.",".dir");
  final File targetDir2=createTempDirectory(myTempDir,"target2.",".dir");
  assertTrue(new File(targetDir1,"child1.txt").createNewFile());
  assertTrue(new File(targetDir2,"child11.txt").createNewFile());
  assertTrue(new File(targetDir2,"child12.txt").createNewFile());
  final File link=IoTestUtil.createSymLink(targetDir1.getPath(),myTempDir + "/link");
  final VirtualFile vLink1=refreshAndFind(link);
  assertTrue("link=" + link + ", vLink="+ vLink1,vLink1 != null && vLink1.isDirectory() && vLink1.isSymLink());
  assertEquals(1,vLink1.getChildren().length);
  assertTrue(link.toString(),link.delete());
  IoTestUtil.createSymLink(targetDir2.getPath(),myTempDir + "/" + link.getName());
  refresh();
  assertFalse(vLink1.isValid());
  final VirtualFile vLink2=myFileSystem.findFileByIoFile(link);
  assertTrue("link=" + link + ", vLink="+ vLink2,vLink2 != null && vLink2.isDirectory() && vLink2.isSymLink());
  assertEquals(2,vLink2.getChildren().length);
}
