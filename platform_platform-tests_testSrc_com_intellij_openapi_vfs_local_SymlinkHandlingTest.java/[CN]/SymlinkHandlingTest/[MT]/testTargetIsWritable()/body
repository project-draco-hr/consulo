{
  File targetFile=createTestFile(myTempDir,"target.txt");
  File linkFile=createSymLink(targetFile.getPath(),myTempDir + "/link");
  VirtualFile linkVFile=refreshAndFind(linkFile);
  assertTrue("link=" + linkFile + ", vLink="+ linkVFile,linkVFile != null && !linkVFile.isDirectory() && linkVFile.isSymLink());
  setWritableAndCheck(targetFile,true);
  refresh();
  assertTrue(linkVFile.getPath(),linkVFile.isWritable());
  setWritableAndCheck(targetFile,false);
  refresh();
  assertFalse(linkVFile.getPath(),linkVFile.isWritable());
  File targetDir=createTestDir(myTempDir,"target");
  File linkDir=createSymLink(targetDir.getPath(),myTempDir + "/linkDir");
  VirtualFile linkVDir=refreshAndFind(linkDir);
  assertTrue("link=" + linkDir + ", vLink="+ linkVDir,linkVDir != null && linkVDir.isDirectory() && linkVDir.isSymLink());
  if (!SystemInfo.isWindows) {
    setWritableAndCheck(targetDir,true);
    refresh();
    assertTrue(linkVDir.getPath(),linkVDir.isWritable());
    setWritableAndCheck(targetDir,false);
    refresh();
    assertFalse(linkVDir.getPath(),linkVDir.isWritable());
  }
 else {
    assertEquals(linkVDir.getPath(),targetDir.canWrite(),linkVDir.isWritable());
  }
}
