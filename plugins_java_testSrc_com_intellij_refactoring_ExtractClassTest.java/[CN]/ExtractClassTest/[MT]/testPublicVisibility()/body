{
  doTest(new PerformAction(){
    @Override public void performAction(    final VirtualFile rootDir,    final VirtualFile rootAfter) throws Exception {
      PsiClass aClass=myJavaFacade.findClass("Test",GlobalSearchScope.projectScope(myProject));
      assertNotNull("Class Test not found",aClass);
      final ArrayList<PsiMethod> methods=new ArrayList<PsiMethod>();
      methods.add(aClass.findMethodsByName("foos",false)[0]);
      final ArrayList<PsiField> fields=new ArrayList<PsiField>();
      fields.add(aClass.findFieldByName("myT",false));
      final ExtractClassProcessor processor=new ExtractClassProcessor(aClass,fields,methods,new ArrayList<PsiClass>(),"",null,"Extracted",PsiModifier.PUBLIC,false,Collections.<MemberInfo>emptyList());
      processor.run();
      LocalFileSystem.getInstance().refresh(false);
      FileDocumentManager.getInstance().saveAllDocuments();
    }
  }
);
}
