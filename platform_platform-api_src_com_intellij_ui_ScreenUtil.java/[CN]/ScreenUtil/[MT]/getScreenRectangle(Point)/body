{
  double distance=-1;
  Rectangle answer=null;
  Rectangle[] allScreenBounds=getAllScreenBounds();
  for (  Rectangle rect : allScreenBounds) {
    if (rect.contains(p)) {
      return rect;
    }
    final double d=findNearestPointOnBorder(rect,p).distance(p.x,p.y);
    if (answer == null || distance > d) {
      distance=d;
      answer=rect;
    }
  }
  if (answer == null) {
    throw new IllegalStateException("It's impossible to determine target graphics environment for point (" + p.x + ","+ p.y+ ")");
  }
  return answer;
}
