{
  final JavaParameters params=createJavaParameters(module,forCreation,false,true,jvmParams,command);
  addJavaHome(params,module);
  final GeneralCommandLine commandLine=createCommandLine(params);
  final VirtualFile griffonHome=getSdkRoot(module);
  if (griffonHome != null) {
    commandLine.getEnvironment().put(getSdkHomePropertyName(),FileUtil.toSystemDependentName(griffonHome.getPath()));
  }
  final VirtualFile root=findAppRoot(module);
  final File ioRoot=root != null ? VfsUtilCore.virtualToIoFile(root) : new File(module.getModuleDirPath());
  commandLine.setWorkDirectory(forCreation ? ioRoot.getParentFile() : ioRoot);
  return commandLine;
}
