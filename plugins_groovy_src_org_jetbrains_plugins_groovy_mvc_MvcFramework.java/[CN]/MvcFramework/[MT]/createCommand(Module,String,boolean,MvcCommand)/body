{
  final JavaParameters params=createJavaParameters(module,forCreation,false,true,jvmParams,command);
  addJavaHome(params,module);
  final GeneralCommandLine commandLine=createCommandLine(params);
  final VirtualFile griffonHome=getSdkRoot(module);
  if (griffonHome != null) {
    commandLine.setEnvParams(Collections.singletonMap(getSdkHomePropertyName(),FileUtil.toSystemDependentName(griffonHome.getPath())));
  }
  final VirtualFile root=findAppRoot(module);
  final File ioRoot=root != null ? VfsUtil.virtualToIoFile(root) : new File(module.getModuleFilePath()).getParentFile();
  commandLine.setWorkDirectory(forCreation ? ioRoot.getParentFile() : ioRoot);
  return commandLine;
}
