{
  if (findAppRoot(module) == null && module.getUserData(CREATE_APP_STRUCTURE) == Boolean.TRUE) {
    while (ModuleUtilCore.getSdk(module,JavaModuleExtensionImpl.class) == null) {
      if (Messages.showYesNoDialog(module.getProject(),"Cannot generate " + getDisplayName() + " project structure because JDK is not specified for module \""+ module.getName()+ "\".\n"+ getDisplayName()+ " project will not be created if you don't specify JDK.\nDo you want to specify JDK?","Error",Messages.getErrorIcon()) == 1) {
        return;
      }
      ProjectSettingsService.getInstance(module.getProject()).showModuleConfigurationDialog(module.getName(),ClasspathEditor.NAME);
    }
    module.putUserData(CREATE_APP_STRUCTURE,null);
    final GeneralCommandLine commandLine=getCreationCommandLine(module);
    if (commandLine == null)     return;
    MvcConsole.executeProcess(module,commandLine,new Runnable(){
      public void run(){
        VirtualFile root=findAppRoot(module);
        if (root == null)         return;
        PsiDirectory psiDir=PsiManager.getInstance(module.getProject()).findDirectory(root);
        IdeView ide=LangDataKeys.IDE_VIEW.getData(DataManager.getInstance().getDataContext());
        if (ide != null)         ide.selectElement(psiDir);
      }
    }
,true);
  }
}
