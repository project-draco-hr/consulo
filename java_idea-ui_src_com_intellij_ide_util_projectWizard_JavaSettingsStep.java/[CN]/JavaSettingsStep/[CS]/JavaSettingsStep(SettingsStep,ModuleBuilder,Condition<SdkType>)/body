{
  myModuleBuilder=moduleBuilder;
  myWizardContext=settingsStep.getContext();
  ProjectSdksModel model=new ProjectSdksModel();
  Project project=myWizardContext.getProject();
  model.reset(project,sdkFilter);
  myJdkComboBox=new JdkComboBox(model,sdkFilter);
  JButton button=new JButton("\u001BNew...");
  myJdkComboBox.setSetupButton(button,project,model,project == null ? new JdkComboBox.NoneJdkComboBoxItem() : new JdkComboBox.ProjectJdkComboBoxItem(),null,false);
  JPanel jdkPanel=new JPanel(new BorderLayout(SystemInfo.isMac ? 0 : 2,0));
  jdkPanel.add(myJdkComboBox);
  jdkPanel.add(button,BorderLayout.EAST);
  settingsStep.addSettingsField("Project \u001BSDK:",jdkPanel);
  if (moduleBuilder instanceof JavaModuleBuilder) {
    ComponentWithBrowseButton.BrowseFolderActionListener<JTextField> listener=new ComponentWithBrowseButton.BrowseFolderActionListener<JTextField>(IdeBundle.message("prompt.select.source.directory"),null,mySourcePath,project,BrowseFilesListener.SINGLE_DIRECTORY_DESCRIPTOR,TextComponentAccessor.TEXT_FIELD_WHOLE_TEXT){
      @Override protected void onFileChoosen(      VirtualFile chosenFile){
        String contentEntryPath=myModuleBuilder.getContentEntryPath();
        String path=chosenFile.getPath();
        if (contentEntryPath != null) {
          int i=StringUtil.commonPrefixLength(contentEntryPath,path);
          mySourcePath.setText(path.substring(i));
        }
 else {
          mySourcePath.setText(path);
        }
      }
    }
;
    mySourcePath.addBrowseFolderListener(project,listener);
    myCreateSourceRoot.addActionListener(new ActionListener(){
      @Override public void actionPerformed(      ActionEvent e){
        mySourcePath.setEnabled(myCreateSourceRoot.isSelected());
      }
    }
);
    settingsStep.addExpertPanel(myPanel);
  }
}
