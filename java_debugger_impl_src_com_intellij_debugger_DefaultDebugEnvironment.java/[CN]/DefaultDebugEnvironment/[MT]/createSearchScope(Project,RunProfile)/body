{
  Module[] modules=null;
  if (runProfile instanceof ModuleRunProfile) {
    modules=((ModuleRunProfile)runProfile).getModules();
  }
  if (modules == null || modules.length == 0) {
    return GlobalSearchScope.allScope(project);
  }
 else {
    GlobalSearchScope scope=GlobalSearchScope.moduleRuntimeScope(modules[0],true);
    for (int idx=1; idx < modules.length; idx++) {
      Module module=modules[idx];
      scope=scope.uniteWith(GlobalSearchScope.moduleRuntimeScope(module,true));
    }
    return scope;
  }
}
