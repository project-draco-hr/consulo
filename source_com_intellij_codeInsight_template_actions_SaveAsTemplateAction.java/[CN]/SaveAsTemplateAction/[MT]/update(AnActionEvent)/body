{
  DataContext dataContext=e.getDataContext();
  Editor editor=(Editor)dataContext.getData(DataConstants.EDITOR);
  PsiFile file=(PsiFile)dataContext.getData(DataConstants.PSI_FILE);
  if (file == null || editor == null) {
    e.getPresentation().setEnabled(false);
  }
 else {
    e.getPresentation().setEnabled(editor.getSelectionModel().hasSelection());
  }
}
