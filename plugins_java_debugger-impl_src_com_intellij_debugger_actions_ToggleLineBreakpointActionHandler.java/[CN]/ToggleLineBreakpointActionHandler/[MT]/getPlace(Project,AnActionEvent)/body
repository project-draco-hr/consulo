{
  Editor editor=event.getData(PlatformDataKeys.EDITOR);
  if (editor == null) {
    editor=FileEditorManager.getInstance(project).getSelectedTextEditor();
  }
  if (editor != null) {
    final Document document=editor.getDocument();
    PsiFile file=PsiDocumentManager.getInstance(project).getPsiFile(document);
    if (file != null) {
      final Editor editor1=editor;
      return new PlaceInDocument(){
        public Document getDocument(){
          return document;
        }
        public int getOffset(){
          return editor1.getCaretModel().getOffset();
        }
      }
;
    }
  }
  return null;
}
