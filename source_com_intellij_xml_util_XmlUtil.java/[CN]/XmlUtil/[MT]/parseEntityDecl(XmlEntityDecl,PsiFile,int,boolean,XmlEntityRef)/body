{
  if (!cacheValue)   return entityDecl.parse(targetFile,type,entityRef);
  CachedValue value=entityRef.getUserData(PARSED_DECL_KEY);
  if (value == null) {
    value=entityDecl.getManager().getCachedValuesManager().createCachedValue(new CachedValueProvider(){
      public CachedValueProvider.Result compute(){
        final PsiElement res=entityDecl.parse(targetFile,type,entityRef);
        if (res == null)         return new Result(res,new Object[]{targetFile});
        return new CachedValueProvider.Result(res,new Object[]{res.getUserData(XmlElement.DEPENDING_ELEMENT),entityDecl,targetFile,entityRef});
      }
    }
,false);
    entityRef.putUserData(PARSED_DECL_KEY,value);
  }
  return (PsiElement)value.getValue();
}
