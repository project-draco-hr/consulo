{
  final PsiElement userData=responsibleElement.getUserData(XmlElement.DEPENDING_ELEMENT);
  if (userData instanceof XmlFile) {
    final String name=_element.getName();
    if (_element instanceof XmlEntityDecl) {
      final XmlEntityDecl cachedEntity=XmlEntityRefImpl.getCachedEntity((PsiFile)userData,name);
      if (cachedEntity != null)       return cachedEntity;
    }
    final PsiNamedElement[] result=new PsiNamedElement[1];
    processXmlElements((XmlFile)userData,new PsiElementProcessor(){
      public boolean execute(      final PsiElement element){
        if (element instanceof PsiNamedElement && name.equals(((PsiNamedElement)element).getName()) && _element.getClass().isInstance(element)) {
          result[0]=(PsiNamedElement)element;
          return false;
        }
        return true;
      }
    }
,true);
    return result[0];
  }
  return null;
}
