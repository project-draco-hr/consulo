{
  final StringBuffer buffer=new StringBuffer();
  final Map<String,List<String>> tags=new HashMap<String,List<String>>();
  final Map<String,List<MyAttributeInfo>> attributes=new HashMap<String,List<MyAttributeInfo>>();
  final XmlTag rootTag=doc.getRootTag();
  computeTag(rootTag,tags,attributes);
  for (PsiElement element=rootTag != null ? rootTag.getNextSibling() : null; element != null; element=element.getNextSibling()) {
    if (element instanceof XmlTag) {
      computeTag((XmlTag)element,tags,attributes);
    }
  }
  final Iterator<String> iter=tags.keySet().iterator();
  while (iter.hasNext()) {
    final String tagName=iter.next();
    buffer.append(generateElementDTD(tagName,tags.get(tagName),attributes.get(tagName)));
  }
  return buffer.toString();
}
