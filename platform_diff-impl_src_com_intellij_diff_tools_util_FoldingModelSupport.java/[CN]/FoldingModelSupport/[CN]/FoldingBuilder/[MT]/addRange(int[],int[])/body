{
  List<FoldedBlock> result=new ArrayList<FoldedBlock>(3);
  int[] rangeStarts=new int[myCount];
  int[] rangeEnds=new int[myCount];
  for (int number=0; ; number++) {
    int shift=getRangeShift(mySettings.range,number);
    if (shift == -1)     break;
    for (int i=0; i < myCount; i++) {
      rangeStarts[i]=bound(starts[i] + shift,i);
      rangeEnds[i]=bound(ends[i] - shift,i);
    }
    ContainerUtil.addAllNotNull(result,createRange(rangeStarts,rangeEnds,myExpandSuggester.isExpanded(rangeStarts,rangeEnds)));
  }
  if (result.size() > 0) {
    FoldedBlock[] block=ContainerUtil.toArray(result,new FoldedBlock[result.size()]);
    for (    FoldedBlock folding : block) {
      folding.installHighlighter(block);
    }
    myFoldings.add(block);
  }
}
