{
  if (myParentProject == null)   return;
  new WriteCommandAction.Simple(project,myCommandName){
    protected void run() throws Throwable {
      MavenDomProjectModel model=MavenDomUtil.getMavenDomProjectModel(project,pom);
      if (model == null)       return;
      MavenDomUtil.updateMavenParent(model,myParentProject);
      if (myInheritGroupId) {
        XmlElement el=model.getGroupId().getXmlElement();
        if (el != null)         el.delete();
      }
      if (myInheritVersion) {
        XmlElement el=model.getVersion().getXmlElement();
        if (el != null)         el.delete();
      }
      CodeStyleManager.getInstance(project).reformat(getPsiFile(project,pom));
      pom.putUserData(MavenProjectsManagerWatcher.FORCE_IMPORT_AND_RESOLVE_ON_REFRESH,Boolean.TRUE);
      try {
        Document doc=FileDocumentManager.getInstance().getDocument(pom);
        PsiDocumentManager.getInstance(project).doPostponedOperationsAndUnblockDocument(doc);
        FileDocumentManager.getInstance().saveDocument(doc);
      }
  finally {
        pom.putUserData(MavenProjectsManagerWatcher.FORCE_IMPORT_AND_RESOLVE_ON_REFRESH,null);
      }
    }
  }
.execute();
}
