{
  LOG.assertTrue(elements.length >= 1 && elements[0] instanceof PsiExpression,"incorrect invoke() parameters");
  final PsiElement tempExpr=elements[0];
  final Editor editor;
  if (dataContext != null) {
    final Editor editorFromDC=DataKeys.EDITOR.getData(dataContext);
    final PsiFile cachedPsiFile=PsiDocumentManager.getInstance(project).getCachedPsiFile(editorFromDC.getDocument());
    if (cachedPsiFile != null && PsiTreeUtil.isAncestor(cachedPsiFile,tempExpr,false)) {
      editor=editorFromDC;
    }
 else {
      editor=null;
    }
  }
 else {
    editor=null;
  }
  if (tempExpr instanceof PsiExpression) {
    invokeImpl(project,(PsiExpression)tempExpr,editor);
  }
 else   if (tempExpr instanceof PsiLocalVariable) {
    invokeImpl(project,(PsiLocalVariable)tempExpr,editor);
  }
 else {
    LOG.assertTrue(false,"elements[0] should be PsiExpression or PsiLocalVariable");
  }
}
