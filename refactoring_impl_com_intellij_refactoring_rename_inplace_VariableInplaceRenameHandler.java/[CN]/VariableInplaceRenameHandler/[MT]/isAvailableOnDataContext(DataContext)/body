{
  final PsiElement element=PsiElementRenameHandler.getElement(dataContext);
  final Editor editor=PlatformDataKeys.EDITOR.getData(dataContext);
  final PsiFile file=LangDataKeys.PSI_FILE.getData(dataContext);
  if (editor == null || file == null)   return false;
  if (ourPreventInlineRenameFlag.get() != null || dataContext.getData(INVOKING_DEFAULT) != null) {
    return false;
  }
  final PsiElement nameSuggestionContext=file.findElementAt(editor.getCaretModel().getOffset());
  final RefactoringSupportProvider supportProvider=element != null ? LanguageRefactoringSupport.INSTANCE.forLanguage(element.getLanguage()) : null;
  return supportProvider != null && editor.getSettings().isVariableInplaceRenameEnabled() && supportProvider.doInplaceRenameFor(element,nameSuggestionContext);
}
