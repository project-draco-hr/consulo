{
  if (!isAvailableOnDataContext(dataContext)) {
    LOG.error("Recursive invokation");
    RenameHandlerRegistry.getInstance().getRenameHandler(dataContext).invoke(elementToRename.getProject(),editor,elementToRename.getContainingFile(),dataContext);
    return;
  }
  final boolean startedRename=new VariableInplaceRenamer((PsiNameIdentifierOwner)elementToRename,editor).performInplaceRename();
  if (!startedRename) {
    try {
      DataContext ourDataContext=dataContext;
      if (false) {
        ourDataContext=new DataContext(){
          public Object getData(          @NonNls final String dataId){
            if (INVOKING_DEFAULT.equals(dataId)) {
              return Boolean.TRUE;
            }
            return dataContext.getData(dataId);
          }
        }
;
      }
      ourPreventInlineRenameFlag.set(Boolean.TRUE);
      RenameHandlerRegistry.getInstance().getRenameHandler(ourDataContext).invoke(elementToRename.getProject(),editor,elementToRename.getContainingFile(),ourDataContext);
    }
  finally {
      ourPreventInlineRenameFlag.set(null);
    }
  }
}
