{
  final boolean startedRename=new VariableInplaceRenamer((PsiNameIdentifierOwner)elementToRename,editor).performInplaceRename();
  if (!startedRename) {
    final DataContext ourDataContext=new DataContext(){
      boolean myRecursionGuard;
      public Object getData(      @NonNls final String dataId){
        if (INVOKING_DEFAULT.equals(dataId)) {
          return Boolean.TRUE;
        }
        if (myRecursionGuard)         return null;
        try {
          myRecursionGuard=true;
          return dataContext.getData(dataId);
        }
  finally {
          myRecursionGuard=false;
        }
      }
    }
;
    RenameHandlerRegistry.getInstance().getRenameHandler(ourDataContext).invoke(elementToRename.getProject(),editor,elementToRename.getContainingFile(),ourDataContext);
  }
}
