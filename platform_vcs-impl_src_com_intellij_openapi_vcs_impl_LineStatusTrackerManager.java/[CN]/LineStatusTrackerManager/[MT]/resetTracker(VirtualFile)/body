{
  if ((!myProject.isOpen()) || myProject.isDisposed())   return;
  final Document document=FileDocumentManager.getInstance().getCachedDocument(virtualFile);
  if (document == null) {
    log("Skipping resetTracker() because no cached document for " + virtualFile.getPath());
    return;
  }
  log("resetting tracker for file " + virtualFile.getPath());
  final LineStatusTracker tracker=myLineStatusTrackers.get(document);
  final boolean editorOpened=myFileEditorManager.isFileOpen(virtualFile);
  final boolean shouldBeInstalled=shouldBeInstalled(virtualFile) && editorOpened;
  if (tracker == null && (!shouldBeInstalled))   return;
  myApplication.runWriteAction(new Runnable(){
    @Override public void run(){
      if (tracker != null) {
        if (!shouldBeInstalled) {
          releaseTracker(document);
          return;
        }
 else         if ((LineStatusTracker.BaseLoadState.LOADING == tracker.getBaseLoaded())) {
          return;
        }
 else {
          tracker.resetForBaseRevisionLoad();
          startAlarm(document,virtualFile);
        }
      }
 else       if (shouldBeInstalled) {
        installTracker(virtualFile,document);
      }
    }
  }
);
}
