{
  if ((!myProject.isOpen()) || myProject.isDisposed())   return;
  if (!myVirtualFile.isValid()) {
    log("installTracker() for file " + myVirtualFile.getPath() + " failed: virtual file not valid");
    reportTrackerBaseLoadFailed();
    return;
  }
  final VcsRevisionNumber baseRevision=myStatusProvider.getBaseRevision(myVirtualFile);
  if (baseRevision == null) {
    log("installTracker() for file " + myVirtualFile.getPath() + " failed: null returned for base revision number");
    reportTrackerBaseLoadFailed();
    return;
  }
  final LineStatusTracker.RevisionPack revisionPack=new LineStatusTracker.RevisionPack(myLoadCounter,baseRevision);
  ++myLoadCounter;
synchronized (myLock) {
    final LineStatusTracker tracker=myLineStatusTrackers.get(myDocument);
    if (tracker != null && tracker.canUseBaseRevision(revisionPack)) {
      nonModalAliveInvokeLater(new Runnable(){
        @Override public void run(){
          log("installTracker() for file " + myVirtualFile.getPath() + " base revision number already in tracker");
          tracker.useCachedBaseRevision(revisionPack);
        }
      }
);
      return;
    }
  }
  final String lastUpToDateContent=myStatusProvider.getBaseVersionContent(myVirtualFile);
  if (lastUpToDateContent == null) {
    log("installTracker() for file " + myVirtualFile.getPath() + " failed: no up to date content");
    reportTrackerBaseLoadFailed();
    return;
  }
  final String converted=StringUtil.convertLineSeparators(lastUpToDateContent);
  final Runnable runnable=new Runnable(){
    public void run(){
synchronized (myLock) {
        log("initializing tracker for file " + myVirtualFile.getPath());
        final LineStatusTracker tracker=myLineStatusTrackers.get(myDocument);
        if (tracker != null) {
          tracker.initialize(converted,revisionPack);
        }
      }
    }
  }
;
  nonModalAliveInvokeLater(runnable);
}
