{
  if (!dir.isDirectory()) {
    return;
  }
  FileTypeManager typeManager=FileTypeManager.getInstance();
  if (typeManager.isFileIgnored(dir.getName())) {
    return;
  }
  final ProgressIndicator progressIndicator=ProgressManager.getInstance().getProgressIndicator();
  if (progressIndicator != null) {
    if (progressIndicator.isCanceled()) {
      return;
    }
    progressIndicator.setText2(dir.getPath());
  }
  File[] list=dir.listFiles();
  if (list == null || list.length == 0) {
    return;
  }
  for (  File child : list) {
    if (child.isFile()) {
      FileType type=typeManager.getFileTypeByFileName(child.getName());
      if (StdFileTypes.JAVA == type) {
        if (progressIndicator != null && progressIndicator.isCanceled()) {
          return;
        }
        Pair<File,String> root=suggestRootForJavaFile(child);
        if (root != null) {
          String packagePrefix=getPackagePrefix(base,root);
          if (packagePrefix == null) {
            foundDirectories.add(root);
          }
 else {
            foundDirectories.add(Pair.create(base,packagePrefix));
          }
          throw new PathFound(root.getFirst());
        }
 else {
          return;
        }
      }
    }
  }
  for (  File child : list) {
    if (child.isDirectory()) {
      try {
        suggestRootsImpl(base,child,foundDirectories);
      }
 catch (      PathFound found) {
        if (!found.myDirectory.equals(child)) {
          throw found;
        }
      }
    }
  }
}
