{
  final VcsKey gitKey=GitVcs.getKey();
  for (  FilePath filePath : myDirty) {
    final VirtualFile vf=filePath.getVirtualFile();
    if (vf != null) {
      if ((myAddGate.getStatus(vf) == null) && myFileDocumentManager.isFileModified(vf)) {
        final VirtualFile root=myVcsManager.getVcsRootFor(vf);
        if (root != null) {
          final GitRevisionNumber beforeRevisionNumber=GitChangeUtils.loadRevision(myProject,root,"HEAD");
          builder.processChange(new Change(GitContentRevision.createRevision(vf,beforeRevisionNumber,myProject),GitContentRevision.createRevision(vf,null,myProject),FileStatus.MODIFIED),gitKey);
        }
      }
    }
  }
}
