{
  final Document doc=editor.getDocument();
  if (doc.getLineCount() == 0)   return;
  int caretOffset=editor.getCaretModel().getOffset();
  final int lineNumber=doc.getLineNumber(caretOffset);
  int lineEndOffset=doc.getLineEndOffset(lineNumber);
  if (caretOffset >= lineEndOffset) {
    DeleteLineAction.deleteLineAtCaret(editor);
    return;
  }
  copyToClipboard(doc,caretOffset,lineEndOffset,dataContext,editor);
  final int lineStartOffset=doc.getLineStartOffset(lineNumber);
  if (StringUtil.isEmptyOrSpaces(doc.getCharsSequence().subSequence(lineStartOffset,lineEndOffset).toString())) {
    DeleteLineAction.deleteLineAtCaret(editor);
  }
 else {
    doc.deleteString(caretOffset,lineEndOffset);
  }
}
