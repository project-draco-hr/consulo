{
  final TreePath[] paths=getSelectionPaths();
  if (paths == null)   return null;
  InspectionTool tool=null;
  for (  TreePath path : paths) {
    Object[] nodes=path.getPath();
    for (int j=nodes.length - 1; j >= 0; j--) {
      Object node=nodes[j];
      if (node instanceof InspectionNode) {
        if (tool == null) {
          tool=((InspectionNode)node).getTool();
        }
 else         if (tool != ((InspectionNode)node).getTool()) {
          return null;
        }
        break;
      }
    }
  }
  return tool;
}
