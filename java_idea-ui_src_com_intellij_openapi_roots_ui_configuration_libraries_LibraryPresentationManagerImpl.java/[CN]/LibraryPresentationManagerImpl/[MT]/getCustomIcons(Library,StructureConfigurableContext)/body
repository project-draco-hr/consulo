{
  final VirtualFile[] files=getLibraryFiles(library,context);
  final List<Icon> icons=new SmartList<Icon>();
  LibraryDetectionManager.getInstance().processProperties(Arrays.asList(files),new LibraryDetectionManager.LibraryPropertiesProcessor(){
    @Override public <P extends LibraryProperties>boolean processProperties(    @NotNull LibraryKind<P> kind,    @NotNull P properties){
      final LibraryPresentationProvider<P> provider=getPresentationProvider(kind);
      if (provider != null) {
        ContainerUtil.addIfNotNull(icons,provider.getIcon());
      }
      return true;
    }
  }
);
  return icons;
}
