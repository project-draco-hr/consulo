{
  final List<LibraryKind<?>> result=new SmartList<LibraryKind<?>>();
  final VirtualFile[] files=getLibraryFiles(library,context);
  LibraryDetectionManager.getInstance().processProperties(Arrays.asList(files),new LibraryDetectionManager.LibraryPropertiesProcessor(){
    @Override public <P extends LibraryProperties>boolean processProperties(    @NotNull LibraryKind<P> kind,    @NotNull P properties){
      result.add(kind);
      return true;
    }
  }
);
  return result;
}
