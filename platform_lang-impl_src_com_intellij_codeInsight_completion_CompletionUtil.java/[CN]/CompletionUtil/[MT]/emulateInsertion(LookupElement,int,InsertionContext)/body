{
  context.getOffsetMap().addOffset(CompletionInitializationContext.START_OFFSET,offset);
  context.getOffsetMap().addOffset(CompletionInitializationContext.IDENTIFIER_END_OFFSET,offset);
  context.getOffsetMap().addOffset(CompletionInitializationContext.SELECTION_END_OFFSET,offset);
  context.setTailOffset(offset);
  final Editor editor=context.getEditor();
  final Document document=editor.getDocument();
  final String lookupString=item.getLookupString();
  document.insertString(offset,lookupString);
  editor.getCaretModel().moveToOffset(context.getTailOffset());
  PsiDocumentManager.getInstance(context.getProject()).commitDocument(document);
  item.handleInsert(context);
}
