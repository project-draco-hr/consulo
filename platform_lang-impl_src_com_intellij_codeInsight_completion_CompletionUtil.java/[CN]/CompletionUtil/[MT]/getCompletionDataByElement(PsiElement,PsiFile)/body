{
  if (position == null)   return null;
  PsiElement parent=position.getParent();
  Language language=parent == null ? position.getLanguage() : parent.getLanguage();
  final FileType fileType=language.getAssociatedFileType();
  if (fileType != null) {
    final CompletionData mainData=getCompletionDataByFileType(fileType);
    if (mainData != null) {
      return mainData;
    }
  }
  final CompletionData mainData=getCompletionDataByFileType(originalFile.getFileType());
  return mainData != null ? mainData : ourGenericCompletionData;
}
