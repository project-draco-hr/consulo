{
  int valueHashCode=-1;
  int stripe=-1;
  if (myHashcodeToIdCache != null && value != null) {
    valueHashCode=myDataDescriptor.getHashCode(value);
    stripe=Math.abs(valueHashCode) & STRIPE_MASK;
    Integer cachedId;
    myStripeLocks[stripe].lock();
    try {
      cachedId=myHashcodeToIdCache[stripe].get(valueHashCode);
    }
  finally {
      myStripeLocks[stripe].unlock();
    }
    if (cachedId != null) {
      int stripe2=idStripe(cachedId.intValue());
      myStripeLocks[stripe2].lock();
      try {
        Data s=myIdToStringCache[stripe2].get(cachedId);
        if (s != null && myDataDescriptor.isEqual(value,s))         return cachedId.intValue();
      }
  finally {
        myStripeLocks[stripe2].unlock();
      }
    }
  }
  int enumerate=myBase.enumerate(value);
  if (stripe != -1) {
    Integer enumeratedInteger;
    myStripeLocks[stripe].lock();
    try {
      enumeratedInteger=enumerate;
      myHashcodeToIdCache[stripe].put(valueHashCode,enumeratedInteger);
    }
  finally {
      myStripeLocks[stripe].unlock();
    }
    int stripe2=idStripe(enumerate);
    myStripeLocks[stripe2].lock();
    try {
      myIdToStringCache[stripe2].put(enumeratedInteger,value);
    }
  finally {
      myStripeLocks[stripe2].unlock();
    }
  }
  return enumerate;
}
