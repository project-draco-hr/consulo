{
  final String documentText=editor.getDocument().getText();
  final int caret=editor.getCaretModel().getOffset();
  final int selStart=editor.getSelectionModel().getSelectionStart();
  final int selEnd=editor.getSelectionModel().getSelectionEnd();
  return new Runnable(){
    @Override public void run(){
      DocumentEx document=(DocumentEx)editor.getDocument();
      document.replaceString(0,editor.getCaretModel().getOffset(),documentText.substring(0,caret));
      document.replaceString(caret,document.getTextLength(),documentText.substring(caret));
      editor.getSelectionModel().setSelection(selStart,selEnd);
    }
  }
;
}
