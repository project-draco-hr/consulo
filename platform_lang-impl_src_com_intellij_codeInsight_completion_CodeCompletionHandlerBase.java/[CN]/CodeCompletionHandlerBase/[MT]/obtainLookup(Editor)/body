{
  LookupImpl existing=(LookupImpl)LookupManager.getActiveLookup(editor);
  if (existing != null) {
    existing.markReused();
    if (myFocusLookup) {
      existing.setFocused(true);
    }
    return existing;
  }
  LookupImpl lookup=(LookupImpl)LookupManager.getInstance(editor.getProject()).createLookup(editor,LookupElement.EMPTY_ARRAY,"",LookupArranger.DEFAULT);
  if (editor.isOneLineMode()) {
    lookup.setForceShowAsPopup(true);
    lookup.setCancelOnClickOutside(true);
    lookup.setCancelOnOtherWindowOpen(true);
    lookup.setResizable(false);
    lookup.setForceLightweightPopup(false);
  }
  lookup.setFocused(myFocusLookup);
  return lookup;
}
