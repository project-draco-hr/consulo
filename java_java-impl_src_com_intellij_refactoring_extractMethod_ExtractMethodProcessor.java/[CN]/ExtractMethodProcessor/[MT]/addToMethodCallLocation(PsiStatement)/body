{
  if (myEnclosingBlockStatement == null) {
    PsiElement containingStatement=PsiTreeUtil.getParentOfType(myExpression != null ? myExpression : myElements[0],PsiStatement.class,false);
    if (containingStatement == null) {
      containingStatement=PsiTreeUtil.getParentOfType(myExpression != null ? myExpression : myElements[0],PsiComment.class,false);
    }
    return containingStatement.getParent().addBefore(statement,containingStatement);
  }
 else {
    return myEnclosingBlockStatement.getParent().addBefore(statement,myEnclosingBlockStatement);
  }
}
