{
  final PsiExpression condition=statement.getCondition();
  final LanguageLevel languageLevel=PsiUtil.getLanguageLevel(statement);
  final PsiExpression possibleSwitchExpression=determinePossibleSwitchExpressions(condition,languageLevel);
  if (possibleSwitchExpression == null) {
    return null;
  }
  if (SideEffectChecker.mayHaveSideEffects(possibleSwitchExpression)) {
    return null;
  }
  while (true) {
    final PsiExpression caseCondition=statement.getCondition();
    if (!canBeMadeIntoCase(caseCondition,possibleSwitchExpression,languageLevel)) {
      break;
    }
    final PsiStatement elseBranch=statement.getElseBranch();
    if (!(elseBranch instanceof PsiIfStatement)) {
      return possibleSwitchExpression;
    }
    statement=(PsiIfStatement)elseBranch;
  }
  return null;
}
