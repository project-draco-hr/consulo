{
  ArrayList<UsageInfo> usages=new ArrayList<UsageInfo>();
  final PsiClass[] inheritors=ClassInheritorsSearch.search(myClass,myClass.getUseScope(),true).toArray(PsiClass.EMPTY_ARRAY);
  myClassInheritors=new HashSet<PsiClass>();
  myClassInheritors.add(myClass);
  addAll(myClassInheritors,inheritors);
{
    ClassReferenceScanner scanner=new ClassReferenceSearchingScanner(myClass);
    final MyClassInstanceReferenceVisitor instanceReferenceVisitor=new MyClassInstanceReferenceVisitor(myClass,usages);
    scanner.processReferences(new ClassInstanceScanner(myClass,instanceReferenceVisitor));
    MyClassMemberReferencesVisitor visitor=new MyClassMemberReferencesVisitor(usages,instanceReferenceVisitor);
    myClass.accept(visitor);
    myClassImplementedInterfaces=instanceReferenceVisitor.getImplementedInterfaces();
  }
  for (  PsiClass inheritor : inheritors) {
    processClass(inheritor,usages);
  }
  return usages.toArray(new UsageInfo[usages.size()]);
}
