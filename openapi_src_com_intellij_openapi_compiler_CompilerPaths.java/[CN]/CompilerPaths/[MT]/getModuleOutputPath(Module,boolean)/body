{
  final ModuleRootManager moduleRootManager=ModuleRootManager.getInstance(module);
  final String outPathUrl;
  final Application application=ApplicationManager.getApplication();
  if (forTestClasses) {
    if (application.isDispatchThread()) {
      final String url=moduleRootManager.getCompilerOutputPathForTestsUrl();
      outPathUrl=(url != null) ? url : moduleRootManager.getCompilerOutputPathUrl();
    }
 else {
      outPathUrl=application.runReadAction(new Computable<String>(){
        public String compute(){
          final String url=moduleRootManager.getCompilerOutputPathForTestsUrl();
          return (url != null) ? url : moduleRootManager.getCompilerOutputPathUrl();
        }
      }
);
    }
  }
 else {
    if (application.isDispatchThread()) {
      outPathUrl=moduleRootManager.getCompilerOutputPathUrl();
    }
 else {
      outPathUrl=application.runReadAction(new Computable<String>(){
        public String compute(){
          return moduleRootManager.getCompilerOutputPathUrl();
        }
      }
);
    }
  }
  if (outPathUrl != null) {
    return VirtualFileManager.extractPath(outPathUrl);
  }
  return null;
}
