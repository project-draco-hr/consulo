{
  apply((SeverityBasedTextAttributes)myOptionsList.getSelectedValue());
  final Collection<SeverityRegistrar.SeverityBasedTextAttributes> infoTypes=new HashSet<SeverityRegistrar.SeverityBasedTextAttributes>(mySeverityRegistrar.getRegisteredHighlightingInfoTypes());
  final ListModel listModel=myOptionsList.getModel();
  final List<HighlightSeverity> order=new ArrayList<HighlightSeverity>();
  for (int i=listModel.getSize() - 1; i >= 0; i--) {
    final SeverityBasedTextAttributes info=(SeverityBasedTextAttributes)listModel.getElementAt(i);
    order.add(info.getSeverity());
    if (!mySeverityRegistrar.isDefaultSeverity(info.getSeverity())) {
      infoTypes.remove(info);
      final Color stripeColor=info.getAttributes().getErrorStripeColor();
      mySeverityRegistrar.registerSeverity(info,stripeColor != null ? stripeColor : LightColors.YELLOW);
    }
  }
  for (  SeverityBasedTextAttributes info : infoTypes) {
    mySeverityRegistrar.unregisterSeverity(info.getSeverity());
  }
  mySeverityRegistrar.setOrder(order);
  super.doOKAction();
}
