{
  final PsiElement[] children=directory.getChildren();
  if (children == null)   return;
  for (  PsiElement child : children) {
    if (child instanceof PsiFile && (fileMaskRegExp == null || fileMaskRegExp.matcher(((PsiFile)child).getName()).matches())) {
      fileList.add((PsiFile)child);
    }
 else     if (isRecursive && child instanceof PsiDirectory) {
      addFilesUnderDirectory((PsiDirectory)child,fileList,isRecursive,fileMaskRegExp);
    }
  }
}
