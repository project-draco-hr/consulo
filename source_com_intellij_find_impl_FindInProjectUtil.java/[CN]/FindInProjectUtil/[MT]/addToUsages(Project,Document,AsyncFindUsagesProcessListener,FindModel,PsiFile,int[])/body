{
  if (psiFile == null) {
    return;
  }
  CharSequence text=document.getCharsSequence();
  int textLength=document.getTextLength();
  if (text != null) {
    int offset=0;
    FindManager findManager=FindManager.getInstance(project);
    while (offset < textLength) {
      FindResult result=findManager.findString(text,offset,findModel);
      if (result == null || !result.isStringFound())       break;
      UsageInfo info=new UsageInfo(psiFile,result.getStartOffset(),result.getEndOffset());
      consumer.foundUsage(info);
      count[0]++;
      final int prevOffset=offset;
      offset=result.getEndOffset();
      if (prevOffset == offset) {
        ++offset;
      }
    }
  }
}
