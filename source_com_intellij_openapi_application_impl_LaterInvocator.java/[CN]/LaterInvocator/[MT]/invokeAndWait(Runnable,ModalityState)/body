{
  LOG.assertTrue(modalityState != null);
  LOG.assertTrue(!isDispatchThread());
  final Semaphore semaphore=new Semaphore();
  semaphore.down();
  Runnable runnable1=new Runnable(){
    public void run(){
      try {
        runnable.run();
      }
  finally {
        semaphore.up();
      }
    }
    public String toString(){
      return "InvokeAndWait[" + runnable.toString() + "]";
    }
  }
;
  invokeLater(runnable1,modalityState);
  semaphore.waitFor();
}
