{
  if (graphComponent.isEnabled() && isEnabled() && !e.isConsumed()&& first != null) {
    mxRectangle dirty=mxUtils.getBoundingBox(currentState,currentAngle * mxConstants.DEG_PER_RAD);
    Point pt=SwingUtilities.convertPoint(e.getComponent(),e.getPoint(),graphComponent.getGraphControl());
    double cx=currentState.getCenterX();
    double cy=currentState.getCenterY();
    double dx=pt.getX() - cx;
    double dy=pt.getY() - cy;
    double c=Math.sqrt(dx * dx + dy * dy);
    currentAngle=((pt.getX() > cx) ? -1 : 1) * Math.acos(dy / c) + PI4 + initialAngle;
    dirty.add(mxUtils.getBoundingBox(currentState,currentAngle * mxConstants.DEG_PER_RAD));
    dirty.grow(1);
    graphComponent.getGraphControl().repaint(dirty.getRectangle());
    e.consume();
  }
 else   if (handle.getParent() != null) {
    handle.getParent().remove(handle);
  }
}
