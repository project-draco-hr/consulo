{
  final LayoutTreeSelection selection=myTree.getSelection();
  for (  PackagingElementNode<?> node : selection.getSelectedNodes()) {
    final PackagingElementNode<?> parent=selection.getParentNode(node);
    if (parent != null) {
      final Function<PackagingElement<?>,PackagingElement<?>> old2New=ensureRootIsWritable();
      final List<? extends PackagingElement<?>> toDelete=node.getPackagingElements();
      final List<? extends PackagingElement<?>> parentElements=parent.getPackagingElements();
      for (      PackagingElement<?> oldParent : parentElements) {
        final PackagingElement<?> newParent=old2New.fun(oldParent);
        if (newParent instanceof CompositePackagingElement<?>) {
          for (          PackagingElement<?> element : toDelete) {
            ((CompositePackagingElement<?>)newParent).removeChild(element);
          }
        }
      }
    }
  }
  myArtifactsEditor.rebuildTries();
}
