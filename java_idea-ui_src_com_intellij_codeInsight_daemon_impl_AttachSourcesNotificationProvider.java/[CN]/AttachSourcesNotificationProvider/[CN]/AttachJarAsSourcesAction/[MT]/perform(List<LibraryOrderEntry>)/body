{
  final List<Library.ModifiableModel> modelsToCommit=new ArrayList<Library.ModifiableModel>();
  for (  LibraryOrderEntry orderEntry : orderEntriesContainingFile) {
    final Library library=orderEntry.getLibrary();
    if (library == null)     continue;
    final VirtualFile root=findRoot(library);
    if (root == null)     continue;
    final Library.ModifiableModel model=library.getModifiableModel();
    model.addRoot(root,OrderRootType.SOURCES);
    modelsToCommit.add(model);
  }
  if (modelsToCommit.isEmpty())   return new ActionCallback.Rejected();
  new WriteAction(){
    protected void run(    final Result result){
      for (      Library.ModifiableModel model : modelsToCommit) {
        model.commit();
      }
    }
  }
.execute();
  return new ActionCallback.Done();
}
