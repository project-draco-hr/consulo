{
  if (needFontFallback(font,text)) {
    TextLayout layout=createTextLayout(text,font,getFontMetrics(font).getFontRenderContext());
    return layout != null ? (int)layout.getAdvance() : 0;
  }
 else {
    return getFontMetrics(font).stringWidth(text);
  }
}
