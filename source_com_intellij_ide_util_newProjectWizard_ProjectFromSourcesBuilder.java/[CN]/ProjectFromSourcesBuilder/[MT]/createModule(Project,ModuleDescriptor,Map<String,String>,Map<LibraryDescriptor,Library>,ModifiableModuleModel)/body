{
  final String moduleFilePath=descriptor.computeModuleFilePath();
  final File moduleFile=new File(moduleFilePath);
  if (moduleFile.exists()) {
    FileUtil.delete(moduleFile);
    final VirtualFile file=LocalFileSystem.getInstance().findFileByIoFile(moduleFile);
    if (file != null) {
      file.refresh(false,false);
    }
  }
  final Module module=moduleModel.newModule(moduleFilePath,StdModuleTypes.JAVA);
  final ModifiableRootModel modifiableModel=ModuleRootManager.getInstance(module).getModifiableModel();
  setupRootModel(descriptor,modifiableModel,sourceRootToPrefixMap,projectLibs);
  for (  ProjectConfigurationUpdater updater : myUpdaters) {
    updater.updateModule(descriptor,module,modifiableModel);
  }
  modifiableModel.commit();
  module.setSavePathsRelative(true);
  return module;
}
