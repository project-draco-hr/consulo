{
  mxRectangle dirty=null;
  if (state != null) {
    mxGraph graph=graphComponent.getGraph();
    mxIGraphModel model=graph.getModel();
    Object cell=state.getCell();
    state.setInvalid(true);
    dirty=graph.getView().validatePoints(parentState,cell);
    mxGeometry geo=graph.getCellGeometry(cell);
    if ((dx != 0 || dy != 0) && geo != null && geo.isRelative() && model.isVertex(cell) && (parentState == null || model.isVertex(parentState.getCell()) || deltas.get(state) != null)) {
      state.setX(state.getX() + dx);
      state.setY(state.getY() + dy);
      dirty.setX(dirty.getX() + dx);
      dirty.setY(dirty.getY() + dy);
      graph.getView().updateLabelBounds(state);
    }
    int childCount=model.getChildCount(cell);
    for (int i=0; i < childCount; i++) {
      mxRectangle tmp=revalidateState(state,graph.getView().getState(model.getChildAt(cell,i)),dx,dy);
      if (dirty != null) {
        dirty.add(tmp);
      }
 else {
        dirty=tmp;
      }
    }
  }
  return dirty;
}
