{
  if (child instanceof CompositeElement) {
    checkSubtree(child);
  }
  if (child.getTreeParent() != root) {
    throw new IncorrectTreeStructureException(child,"child has wrong parent value");
  }
  if (child == root.getFirstChildNode()) {
    if (child.getTreePrev() != null) {
      throw new IncorrectTreeStructureException(root,"firstChild.prev != null");
    }
  }
 else {
    if (child.getTreePrev() == null) {
      throw new IncorrectTreeStructureException(child,"not first child has prev == null");
    }
    if (child.getTreePrev().getTreeNext() != child) {
      throw new IncorrectTreeStructureException(child,"element.prev.next != element");
    }
  }
  if (child.getTreeNext() == null) {
    if (root.getLastChildNode() != child) {
      throw new IncorrectTreeStructureException(child,"not last child has next == null");
    }
  }
}
