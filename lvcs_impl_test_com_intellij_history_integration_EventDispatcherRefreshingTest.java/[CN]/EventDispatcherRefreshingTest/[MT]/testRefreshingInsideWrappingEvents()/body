{
  vcs.createDirectory("dir");
  d.beforeRefreshStart(false);
  fireCreated(new TestVirtualFile("dir/f1",null,-1));
  assertFalse(vcs.hasEntry("dir/f1"));
  CacheUpdaterHelper.performUpdate(d);
  assertTrue(vcs.hasEntry("dir/f1"));
  fireCreated(new TestVirtualFile("dir/f2",null,-1));
  assertFalse(vcs.hasEntry("dir/f2"));
  CacheUpdaterHelper.performUpdate(d);
  assertTrue(vcs.hasEntry("dir/f2"));
  d.afterRefreshFinish(false);
  List<Revision> rr=vcs.getRevisionsFor("dir");
  assertEquals(2,rr.size());
  assertEquals("External change",rr.get(0).getCauseChangeName());
}
