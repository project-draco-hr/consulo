{
  LOG.assertTrue(aClass.isValid());
  ApplicationManager.getApplication().assertReadAccessAllowed();
  Collection<CandidateInfo> candidates=getMethodsToOverrideImplement(aClass,toImplement);
  Collection<CandidateInfo> secondary=toImplement || aClass.isInterface() ? ContainerUtil.<CandidateInfo>newArrayList() : getMethodsToOverrideImplement(aClass,true);
  if (toImplement && PsiUtil.isLanguageLevel8OrHigher(aClass)) {
    for (Iterator<CandidateInfo> iterator=candidates.iterator(); iterator.hasNext(); ) {
      CandidateInfo candidate=iterator.next();
      PsiElement element=candidate.getElement();
      if (element instanceof PsiMethod && ((PsiMethod)element).isExtensionMethod()) {
        iterator.remove();
        secondary.add(candidate);
      }
    }
  }
  final MemberChooser<PsiMethodMember> chooser=showOverrideImplementChooser(editor,aClass,toImplement,candidates,secondary);
  if (chooser == null)   return;
  final List<PsiMethodMember> selectedElements=chooser.getSelectedElements();
  if (selectedElements == null || selectedElements.isEmpty())   return;
  LOG.assertTrue(aClass.isValid());
  new WriteCommandAction(project,aClass.getContainingFile()){
    protected void run(    final Result result) throws Throwable {
      overrideOrImplementMethodsInRightPlace(editor,aClass,selectedElements,chooser.isCopyJavadoc(),chooser.isInsertOverrideAnnotation());
    }
  }
.execute();
}
