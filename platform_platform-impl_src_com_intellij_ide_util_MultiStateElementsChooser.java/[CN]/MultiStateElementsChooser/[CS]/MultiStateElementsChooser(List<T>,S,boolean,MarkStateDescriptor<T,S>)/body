{
  super(new BorderLayout());
  myMarkStateDescriptor=markStateDescriptor;
  myTableModel=new MyTableModel(elementsCanBeMarked);
  myTable=new Table(myTableModel);
  myTable.setShowGrid(false);
  myTable.setIntercellSpacing(JBUI.emptySize());
  myTable.setTableHeader(null);
  myTable.setAutoResizeMode(JTable.AUTO_RESIZE_LAST_COLUMN);
  myTable.setColumnSelectionAllowed(false);
  JScrollPane pane=ScrollPaneFactory.createScrollPane(myTable);
  pane.setPreferredSize(JBUI.size(100,155));
  TableColumnModel columnModel=myTable.getColumnModel();
  if (elementsCanBeMarked) {
    TableColumn checkMarkColumn=columnModel.getColumn(myTableModel.CHECK_MARK_COLUM_INDEX);
    TableUtil.setupCheckboxColumn(checkMarkColumn);
    TableCellRenderer checkMarkRenderer=myMarkStateDescriptor.getMarkRenderer();
    if (checkMarkRenderer == null) {
      checkMarkRenderer=new CheckMarkColumnCellRenderer(myTable.getDefaultRenderer(Boolean.class));
    }
    checkMarkColumn.setCellRenderer(checkMarkRenderer);
  }
  columnModel.getColumn(myTableModel.ELEMENT_COLUMN_INDEX).setCellRenderer(new MyElementColumnCellRenderer());
  add(pane,BorderLayout.CENTER);
  myTable.registerKeyboardAction(new ActionListener(){
    @Override public void actionPerformed(    ActionEvent e){
      final int[] selectedRows=myTable.getSelectedRows();
      Map<T,S> selectedElements=new LinkedHashMap<T,S>(selectedRows.length);
      for (      int selectedRow : selectedRows) {
        selectedElements.put(myTableModel.getElementAt(selectedRow),myTableModel.getElementMarkState(selectedRow));
      }
      S nextState=myMarkStateDescriptor.getNextState(selectedElements);
      if (nextState != null) {
        myTableModel.setMarkState(selectedRows,nextState);
      }
    }
  }
,KeyStroke.getKeyStroke(KeyEvent.VK_SPACE,0),JComponent.WHEN_FOCUSED);
  final SpeedSearchBase<JBTable> speedSearch=new SpeedSearchBase<JBTable>(myTable){
    @Override public int getSelectedIndex(){
      return myTable.getSelectedRow();
    }
    @Override protected int convertIndexToModel(    int viewIndex){
      return myTable.convertRowIndexToModel(viewIndex);
    }
    @Override public Object[] getAllElements(){
      final int count=myTableModel.getRowCount();
      Object[] elements=new Object[count];
      for (int idx=0; idx < count; idx++) {
        elements[idx]=myTableModel.getElementAt(idx);
      }
      return elements;
    }
    @Override public String getElementText(    Object element){
      return getItemText((T)element);
    }
    @Override public void selectElement(    Object element,    String selectedText){
      final int count=myTableModel.getRowCount();
      for (int row=0; row < count; row++) {
        if (element.equals(myTableModel.getElementAt(row))) {
          final int viewRow=myTable.convertRowIndexToView(row);
          myTable.getSelectionModel().setSelectionInterval(viewRow,viewRow);
          TableUtil.scrollSelectionToVisible(myTable);
          break;
        }
      }
    }
  }
;
  speedSearch.setComparator(new SpeedSearchComparator(false));
  setElements(elements,markState);
  installActions(myTable);
}
