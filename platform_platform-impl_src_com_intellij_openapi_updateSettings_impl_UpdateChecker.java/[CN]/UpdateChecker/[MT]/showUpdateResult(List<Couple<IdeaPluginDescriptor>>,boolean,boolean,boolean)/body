{
  final boolean showBalloonNotification=!alwaysShowResults && ProjectManager.getInstance().getOpenProjects().length > 0;
  final Runnable showPluginsUpdateDialogRunnable=new Runnable(){
    @Override public void run(){
      final NoUpdatesDialog dialog=new NoUpdatesDialog(true,targetsForUpdate,enableLink){
        @Override protected void dispose(){
          ourUpdateInfoDialogShown=false;
          super.dispose();
        }
      }
;
      dialog.setShowConfirmation(showConfirmation);
      ourUpdateInfoDialogShown=true;
      dialog.show();
    }
  }
;
  if (showBalloonNotification && targetsForUpdate != null) {
    final String updatedPluginsList=StringUtil.join(targetsForUpdate,new Function<Couple<IdeaPluginDescriptor>,String>(){
      @Override public String fun(      Couple<IdeaPluginDescriptor> downloader){
        return downloader.getSecond().getName();
      }
    }
,", ");
    String message="You have the latest version of " + ApplicationInfo.getInstance().getVersionName() + " installed.<br> ";
    message+="The following plugin" + (targetsForUpdate.size() == 1 ? " is" : "s are") + " ready to <a href=\"update\">update</a>: "+ updatedPluginsList;
    showBalloonNotification(showPluginsUpdateDialogRunnable,message);
  }
 else   if ((targetsForUpdate != null || alwaysShowResults) && !ourUpdateInfoDialogShown) {
    showPluginsUpdateDialogRunnable.run();
  }
}
