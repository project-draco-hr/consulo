{
  final ActionCallback result=new ActionCallback();
  final Application app=ApplicationManager.getApplication();
  final PropertiesComponent propertiesComponent=PropertiesComponent.getInstance();
  final UpdateSettings updateSettings=UpdateSettings.getInstance();
  if (!updateSettings.CHECK_NEEDED) {
    result.setDone();
    return result;
  }
  app.executeOnPooledThread(new Runnable(){
    @Override public void run(){
      final CheckForUpdateResult checkForUpdateResult=checkForUpdates(updateSettings,propertiesComponent,false);
      final List<PluginDownloader> updatedPlugins=updatePlugins(false,null);
      app.invokeLater(new Runnable(){
        @Override public void run(){
          showUpdateResult(checkForUpdateResult,updatedPlugins,true,true,false);
          result.setDone();
        }
      }
);
    }
  }
);
  return result;
}
