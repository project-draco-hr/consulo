{
  String domain=getDomainFromHost(conn.getURL().getHost());
  Map domainStore;
  if (store.containsKey(domain)) {
    domainStore=(Map)store.get(domain);
  }
 else {
    domainStore=new HashMap();
    store.put(domain,domainStore);
  }
  String headerName=null;
  for (int i=1; (headerName=conn.getHeaderFieldKey(i)) != null; i++) {
    if (headerName.equalsIgnoreCase(SET_COOKIE)) {
      Map cookie=new HashMap();
      StringTokenizer st=new StringTokenizer(conn.getHeaderField(i),COOKIE_VALUE_DELIMITER);
      if (st.hasMoreTokens()) {
        String token=st.nextToken();
        String name=token.substring(0,token.indexOf(NAME_VALUE_SEPARATOR));
        String value=token.substring(token.indexOf(NAME_VALUE_SEPARATOR) + 1,token.length());
        domainStore.put(name,cookie);
        cookie.put(name,value);
      }
      while (st.hasMoreTokens()) {
        String token=st.nextToken();
        if (StringUtil.containsChar(token,NAME_VALUE_SEPARATOR)) {
          cookie.put(token.substring(0,token.indexOf(NAME_VALUE_SEPARATOR)).toLowerCase(),token.substring(token.indexOf(NAME_VALUE_SEPARATOR) + 1,token.length()));
        }
      }
    }
  }
}
