{
  for (  RadComponent c : selection) {
    if (!c.getParent().getLayoutManager().isGrid()) {
      e.getPresentation().setEnabled(false);
      return;
    }
    final int newRow=getNewRow(c);
    final int newCol=getNewColumn(c);
    final int newRowSpan=getNewRowSpan(c);
    final int newColSpan=getNewColSpan(c);
    if (newRow < 0 || newCol < 0 || newRowSpan < 1 || newColSpan < 1 || newRow + newRowSpan > c.getParent().getGridRowCount() || newCol + newColSpan > c.getParent().getGridColumnCount()) {
      e.getPresentation().setEnabled(false);
      return;
    }
    c.setDragging(true);
    final RadComponent overlap=c.getParent().findComponentInRect(newRow,newCol,newRowSpan,newColSpan);
    c.setDragging(false);
    if (overlap != null) {
      e.getPresentation().setEnabled(false);
      return;
    }
  }
}
