{
  ApplyPatchStatus result=null;
  int curLine=findStartLine(lines);
  for (  PatchLine line : myLines) {
    final String patchLineText=line.getText();
switch (line.getType()) {
case CONTEXT:
      checkContextMismatch(lines,curLine,patchLineText);
    curLine++;
  break;
case ADD:
if (curLine < lines.size() && lines.get(curLine).equals(patchLineText) && acceptPartial) {
  result=ApplyPatchStatus.and(result,ApplyPatchStatus.ALREADY_APPLIED);
}
 else {
  lines.add(curLine,patchLineText);
  result=ApplyPatchStatus.and(result,ApplyPatchStatus.SUCCESS);
}
curLine++;
break;
case REMOVE:
if (curLine >= lines.size() || !patchLineText.equals(lines.get(curLine))) {
if (acceptPartial) {
result=ApplyPatchStatus.and(result,ApplyPatchStatus.ALREADY_APPLIED);
}
 else {
checkContextMismatch(lines,curLine,patchLineText);
}
}
 else {
lines.remove(curLine);
result=ApplyPatchStatus.and(result,ApplyPatchStatus.SUCCESS);
}
break;
}
}
if (result != null) {
return result;
}
return ApplyPatchStatus.SUCCESS;
}
