{
  super(checkDataFile(file),new DescriptorWrapper<Key>(keyDescriptor),initialSize);
  myKeyDescriptor=keyDescriptor;
  myFile=file;
  myValueExternalizer=valueExternalizer;
  myValueStorage=PersistentHashMapValueStorage.create(getDataFile(myFile).getPath());
  myGarbageSize=getMetaData();
  if (makesSenceToCompact()) {
    compact();
  }
  ensureKeystreamExists();
}
