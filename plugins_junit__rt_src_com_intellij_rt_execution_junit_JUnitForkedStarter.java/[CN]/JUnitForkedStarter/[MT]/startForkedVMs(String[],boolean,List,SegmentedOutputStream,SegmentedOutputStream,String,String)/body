{
  final List parameters=new ArrayList();
  final BufferedReader bufferedReader=new BufferedReader(new FileReader(path));
  try {
    String line;
    while ((line=bufferedReader.readLine()) != null) {
      parameters.add(line);
    }
  }
  finally {
    bufferedReader.close();
  }
  IdeaTestRunner testRunner=(IdeaTestRunner)JUnitStarter.getAgentClass(isJUnit4).newInstance();
  testRunner.setStreams(out,err,0);
  final Object description=testRunner.getTestToStart(args);
  TreeSender.sendTree(testRunner,description);
  long time=System.currentTimeMillis();
  final List children=testRunner.getChildTests(description);
  final boolean forkTillMethod=forkMode.equalsIgnoreCase("method");
  int result=processChildren(isJUnit4,listeners,out,err,parameters,testRunner,children,0,forkTillMethod);
  time=System.currentTimeMillis() - time;
  new TimeSender(testRunner.getRegistry()).printHeader(time);
  return result;
}
