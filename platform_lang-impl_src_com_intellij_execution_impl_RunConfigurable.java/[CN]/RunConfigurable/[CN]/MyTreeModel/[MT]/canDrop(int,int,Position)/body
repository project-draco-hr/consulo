{
  DefaultMutableTreeNode oldNode=(DefaultMutableTreeNode)myTree.getPathForRow(oldIndex).getLastPathComponent();
  DefaultMutableTreeNode newNode=(DefaultMutableTreeNode)myTree.getPathForRow(newIndex).getLastPathComponent();
  DefaultMutableTreeNode oldParent=(DefaultMutableTreeNode)oldNode.getParent();
  DefaultMutableTreeNode newParent=(DefaultMutableTreeNode)newNode.getParent();
  NodeKind oldKind=getKind(oldNode);
  NodeKind newKind=getKind(newNode);
  ConfigurationType oldType=getType(oldNode);
  ConfigurationType newType=getType(newNode);
  if (oldParent == newParent) {
    if (oldNode.getPreviousSibling() == newNode && position == Position.BELOW) {
      return false;
    }
    if (oldNode.getNextSibling() == newNode && position == Position.ABOVE) {
      return false;
    }
  }
  if (oldType != newType || newParent == oldNode || oldParent == newNode)   return false;
  if (oldKind == FOLDER && newKind != FOLDER) {
    return false;
  }
  if (!oldKind.supportsDnD() || !newKind.supportsDnD()) {
    return false;
  }
  if (oldKind == TEMPORARY_CONFIGURATION && newKind == CONFIGURATION && position == Position.ABOVE)   return false;
  if (oldKind == CONFIGURATION && newKind == TEMPORARY_CONFIGURATION && position == Position.BELOW)   return false;
  if (oldKind == CONFIGURATION && newKind == TEMPORARY_CONFIGURATION && position == Position.ABOVE && newNode.getPreviousSibling() != null && getKind(newNode.getPreviousSibling()) != CONFIGURATION)   return false;
  if (oldKind == TEMPORARY_CONFIGURATION && newKind == CONFIGURATION && position == Position.BELOW && newNode.getNextSibling() != null && getKind(newNode.getNextSibling()) != TEMPORARY_CONFIGURATION)   return false;
  if (oldParent == newNode.getParent()) {
    if (oldKind.isConfiguration() && newKind.isConfiguration()) {
      return oldKind == newKind;
    }
 else     if (oldKind.isConfiguration() && newKind == FOLDER) {
      RunnerAndConfigurationSettings oldSettings=getSettings(oldNode);
      return (oldSettings != null && ((DefaultMutableTreeNode)newNode.getParent()).getUserObject() == oldSettings.getType());
    }
 else     if (oldKind == FOLDER) {
      return true;
    }
  }
  return true;
}
