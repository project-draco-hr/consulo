{
  boolean isEnabled=false;
  boolean toMove=false;
  DefaultMutableTreeNode[] selectedNodes=getSelectedNodes();
  ConfigurationType selectedType=null;
  for (  DefaultMutableTreeNode node : selectedNodes) {
    ConfigurationType type=getType(node);
    if (selectedType == null) {
      selectedType=type;
    }
 else {
      if (!Comparing.equal(type,selectedType)) {
        isEnabled=false;
        break;
      }
    }
    NodeKind kind=getKind(node);
    if (kind.isConfiguration() || (kind == CONFIGURATION_TYPE && node.getParent() == myRoot) || kind == FOLDER) {
      isEnabled=true;
    }
    if (kind.isConfiguration()) {
      toMove=true;
    }
  }
  e.getPresentation().setText(ExecutionBundle.message("run.configuration.create.folder.description" + (toMove ? ".move" : "")));
  e.getPresentation().setEnabled(isEnabled);
}
