{
  int[] rows=myTree.getSelectionRows();
  if (rows == null || rows.length != 1) {
    return null;
  }
  int oldIndex=rows[0];
  int newIndex=oldIndex + myDirection;
  while (newIndex > 0 && newIndex < myTree.getRowCount()) {
    RowsDnDSupport.RefinedDropSupport.Position position=myTreeModel.isDropInto(myTree,oldIndex,newIndex) ? INTO : myDirection > 0 ? BELOW : ABOVE;
    if (myTreeModel.canDrop(oldIndex,newIndex,position)) {
      return Trinity.create(oldIndex,newIndex,position);
    }
    if (position == BELOW && newIndex < myTree.getRowCount() - 1 && myTreeModel.canDrop(oldIndex,newIndex + 1,ABOVE)) {
      return Trinity.create(oldIndex,newIndex + 1,ABOVE);
    }
    if (position == ABOVE && newIndex > 1 && myTreeModel.canDrop(oldIndex,newIndex - 1,BELOW)) {
      return Trinity.create(oldIndex,newIndex - 1,BELOW);
    }
    newIndex+=myDirection;
  }
  return null;
}
