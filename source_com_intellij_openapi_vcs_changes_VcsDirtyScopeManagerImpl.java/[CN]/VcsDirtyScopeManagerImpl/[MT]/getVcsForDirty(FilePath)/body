{
  if (!myIsInitialized || myIsDisposed) {
    return null;
  }
  if (filePath.isNonLocal()) {
    return null;
  }
  final VirtualFile validParent=ChangesUtil.findValidParent(filePath);
  if (validParent == null) {
    return null;
  }
  if (myProjectRootManager.getFileIndex().isInContent(validParent) || isFileInBaseDir(filePath) || myVcsManager.hasExplicitMapping(filePath)) {
    if (myProjectRootManager.getFileIndex().isIgnored(validParent)) {
      return null;
    }
    return myVcsManager.getVcsFor(validParent);
  }
  return null;
}
