{
  final CompilerConfiguration compilerConfiguration=CompilerConfiguration.getInstance(myProject);
  snapshot.forEachUrl(new TObjectProcedure<String>(){
    public boolean execute(    final String url){
      final VirtualFile file=snapshot.getFileByUrl(url);
      if (compiler.isCompilableFile(file,context)) {
        if (!forceCompile && compilerConfiguration.isExcludedFromCompilation(file)) {
          return true;
        }
        if (forceCompile || file.getTimeStamp() != cache.getSourceTimestamp(url)) {
          if (LOG.isDebugEnabled()) {
            LOG.debug("File is out-of-date: " + url + "; current timestamp = "+ file.getTimeStamp()+ "; stored timestamp = "+ cache.getSourceTimestamp(url));
          }
          toCompile.add(file);
        }
      }
      return true;
    }
  }
);
}
