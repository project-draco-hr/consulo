{
  while (len > 0) {
    int avail=blockSize - pos;
    int copy=Math.min(avail,len);
    System.arraycopy(src,off,buffer,pos,copy);
    pos+=copy;
    off+=copy;
    len-=copy;
    if (pos >= blockSize)     writeBlock();
  }
}
