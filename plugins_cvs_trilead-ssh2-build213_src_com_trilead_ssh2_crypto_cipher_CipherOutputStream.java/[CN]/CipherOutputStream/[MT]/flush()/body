{
  if (pos != 0)   throw new IOException("FATAL: cannot flush since crypto buffer is not aligned.");
  if (out_buffer_pos > 0) {
    bo.write(out_buffer,0,out_buffer_pos);
    out_buffer_pos=0;
  }
  bo.flush();
}
