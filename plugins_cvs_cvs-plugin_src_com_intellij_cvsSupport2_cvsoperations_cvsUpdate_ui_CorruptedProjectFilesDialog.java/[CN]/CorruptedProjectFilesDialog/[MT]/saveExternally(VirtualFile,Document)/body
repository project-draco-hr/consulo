{
  FileDocumentManager fileDocumentManager=FileDocumentManager.getInstance();
  fileDocumentManager.saveDocument(fileDocumentManager.getDocument(currentVirtualFile));
  File ioProjectFile=VfsUtil.virtualToIoFile(currentVirtualFile);
  try {
    OutputStream outputStream=new BufferedOutputStream(new FileOutputStream(ioProjectFile));
    try {
      FileUtil.copy(new ByteArrayInputStream(document.getText().getBytes(currentVirtualFile.getCharset().name())),outputStream);
    }
  finally {
      outputStream.close();
    }
  }
 catch (  UnsupportedEncodingException e) {
    LOG.error(e);
  }
catch (  IOException e) {
    LOG.error(e);
  }
}
