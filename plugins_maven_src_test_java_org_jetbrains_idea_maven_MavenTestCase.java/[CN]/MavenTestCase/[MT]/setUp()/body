{
  super.setUp();
  ensureTempDirCreated();
  myDir=FileUtil.createTempFile(ourTempDir,"test","",false);
  myDir.mkdirs();
  setUpFixtures();
  myProject=myTestFixture.getProject();
  MavenWorkspaceSettingsComponent.getInstance(myProject).loadState(new MavenWorkspaceSettings());
  String home=getTestMavenHome();
  if (home != null) {
    getMavenGeneralSettings().setMavenHome(home);
  }
  restoreSettingsFile();
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    @Override public void run(){
      try {
        setUpInWriteAction();
      }
 catch (      Exception e) {
        throw new RuntimeException(e);
      }
    }
  }
);
}
