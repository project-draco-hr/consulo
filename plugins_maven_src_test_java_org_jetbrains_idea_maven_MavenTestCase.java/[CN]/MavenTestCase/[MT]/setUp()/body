{
  super.setUp();
  ensureTempDirCreated();
  myDir=new File(ourTempDir,getTestName(false));
  myDir.mkdirs();
  setUpFixtures();
  myProject=myTestFixture.getProject();
  MavenWorkspaceSettingsComponent.getInstance(myProject).loadState(new MavenWorkspaceSettings());
  String home=getTestMavenHome();
  if (home != null) {
    getMavenGeneralSettings().setMavenHome(home);
  }
  restoreSettingsFile();
  UIUtil.invokeAndWaitIfNeeded(new Runnable(){
    @Override public void run(){
      ApplicationManager.getApplication().runWriteAction(new Runnable(){
        @Override public void run(){
          try {
            setUpInWriteAction();
          }
 catch (          Exception e) {
            throw new RuntimeException(e);
          }
        }
      }
);
    }
  }
);
}
