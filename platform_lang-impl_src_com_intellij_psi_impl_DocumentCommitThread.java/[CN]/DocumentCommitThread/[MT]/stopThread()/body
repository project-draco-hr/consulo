{
  isDisposed=true;
synchronized (documentsToCommit) {
    documentsToCommit.clear();
  }
  cancel("Stop thread");
  wakeUpQueue();
  while (!threadFinished) {
    wakeUpQueue();
synchronized (documentsToCommit) {
      try {
        documentsToCommit.wait(10);
      }
 catch (      InterruptedException ignored) {
      }
    }
  }
}
