{
synchronized (documentsToCommit) {
    ProgressIndicatorEx indicator=new DaemonProgressIndicator();
    CommitTask newTask=new CommitTask(document,project,indicator,reason);
    markRemovedFromDocsToCommit(newTask);
    markRemovedCurrentTask(newTask);
    markRemovedFromDocsToApplyInEDT(newTask);
    documentsToCommit.addLast(newTask);
    log("Queued",newTask,false,reason);
    wakeUpQueue();
  }
}
