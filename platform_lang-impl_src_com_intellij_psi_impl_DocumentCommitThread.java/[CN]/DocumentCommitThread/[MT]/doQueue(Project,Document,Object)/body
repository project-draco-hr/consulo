{
synchronized (documentsToCommit) {
    ProgressIndicator indicator=createProgressIndicator();
    CommitTask newTask=new CommitTask(document,project,indicator,reason);
    markRemovedFromDocsToCommit(newTask);
    markRemovedCurrentTask(newTask);
    removeFromDocsToApplyInEDT(newTask);
    documentsToCommit.addLast(newTask);
    log("Queued",newTask,false,reason);
    wakeUpQueue();
  }
}
