{
  final long startDocModificationTimeStamp=document.getModificationStamp();
  return new Processor<Document>(){
    @Override public boolean process(    Document document){
      log("Finishing without PSI",task,synchronously,document.getModificationStamp(),startDocModificationTimeStamp);
      if (document.getModificationStamp() != startDocModificationTimeStamp || documentManager.getCachedViewProvider(document) != null) {
        return false;
      }
      documentManager.handleCommitWithoutPsi(document);
      return true;
    }
  }
;
}
