{
  if (usedFormNames.contains(formName)) {
    throw new CodeGenerationException("Recursive form nesting is not allowed");
  }
  usedFormNames.add(formName);
  final LwRootContainer rootContainer;
  try {
    rootContainer=nestedFormLoader.loadForm(formName);
  }
 catch (  Exception e) {
    throw new CodeGenerationException("Error loading nested form: " + e.getMessage());
  }
  final Set<String> thisFormNestedForms=new HashSet<String>();
  final CodeGenerationException[] validateExceptions=new CodeGenerationException[1];
  rootContainer.accept(new ComponentVisitor(){
    public boolean visit(    final IComponent component){
      if (component instanceof LwNestedForm) {
        LwNestedForm nestedForm=(LwNestedForm)component;
        if (!thisFormNestedForms.contains(nestedForm.getFormFileName())) {
          thisFormNestedForms.add(nestedForm.getFormFileName());
          try {
            validateNestedFormLoop(usedFormNames,nestedForm.getFormFileName(),nestedFormLoader);
          }
 catch (          CodeGenerationException e) {
            validateExceptions[0]=e;
            return false;
          }
        }
      }
      return true;
    }
  }
);
  if (validateExceptions[0] != null) {
    throw validateExceptions[0];
  }
}
