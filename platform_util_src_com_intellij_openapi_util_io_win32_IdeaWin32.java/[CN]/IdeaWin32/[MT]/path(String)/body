{
  final int length=path.length();
  if (length > 0 && path.charAt(length - 1) == '\\' || length >= MAX_PATH) {
    final StringBuilder sb=new StringBuilder(path);
    while (sb.length() > 0 && sb.charAt(sb.length() - 1) == '\\') {
      sb.deleteCharAt(sb.length() - 1);
    }
    if (sb.length() >= MAX_PATH) {
      sb.insert(0,PATH_PREFIX);
    }
    return sb.toString();
  }
  return path;
}
