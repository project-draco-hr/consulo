{
  final VirtualFile vFile=propertiesFile.getVirtualFile();
  if (vFile == null) {
    return;
  }
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    @Override public void run(){
      for (      IProperty property : propertiesFile.getProperties()) {
        final String name=property.getName();
        if (name != null && name.startsWith(AndroidUtils.ANDROID_LIBRARY_REFERENCE_PROPERTY_PREFIX)) {
          property.getPsiElement().delete();
        }
      }
      final VirtualFile baseDir=vFile.getParent();
      final String baseDirPath=baseDir.getPath();
      final Project project=getModule().getProject();
      int index=1;
      for (      String dependency : dependencies) {
        final String relPath=FileUtil.getRelativePath(baseDirPath,dependency,'/');
        final String value=relPath != null ? relPath : dependency;
        propertiesFile.addProperty(PropertiesElementFactory.createProperty(project,AndroidUtils.ANDROID_LIBRARY_REFERENCE_PROPERTY_PREFIX + index,value));
        index++;
      }
    }
  }
);
}
