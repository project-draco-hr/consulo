{
  ApplicationManager.getApplication().invokeLater(new Runnable(){
    public void run(){
      if (beforeAddition()) {
        final T newElement=new WriteCommandAction<T>(getParentDomElement().getManager().getProject()){
          protected void run(          Result<T> result) throws Throwable {
            result.setResult(doAdd());
          }
        }
.execute().getResultObject();
        afterAddition(e,newElement);
      }
    }
  }
);
}
