{
  myTfBundleName.registerKeyboardAction(new AbstractAction(){
    public void actionPerformed(    final ActionEvent e){
      myTfBundleName.getButton().doClick();
    }
  }
,KeyStroke.getKeyStroke(myLblBundleName.getDisplayedMnemonic(),KeyEvent.ALT_DOWN_MASK),JComponent.WHEN_IN_FOCUSED_WINDOW);
  myTfBundleName.addActionListener(new ActionListener(){
    public void actionPerformed(    final ActionEvent e){
      Project project=myModule.getProject();
      VirtualFile initialVirtualFile=null;
      URL resource=new ResourceBundleLoader(myModule).getResource(myTfBundleName.getText() + ".properties");
      if (resource != null) {
        initialVirtualFile=VfsUtil.findFileByURL(resource);
      }
      PsiFile initialPropertiesFile=initialVirtualFile == null ? null : PsiManager.getInstance(project).findFile(initialVirtualFile);
      TreeFileChooser fileChooser=TreeClassChooserFactory.getInstance(project).createFileChooser("Choose Poperties File",initialPropertiesFile,PropertiesFileType.FILE_TYPE,null);
      fileChooser.showDialog();
      PropertiesFile propertiesFile=(PropertiesFile)fileChooser.getSelectedFile();
      if (propertiesFile == null)       return;
      final PsiDirectory directory=propertiesFile.getContainingDirectory();
      final String packageName;
      final PsiPackage aPackage=directory.getPackage();
      if (aPackage == null) {
        packageName="";
      }
 else {
        packageName=directory.getPackage().getQualifiedName();
      }
      String bundleName=propertiesFile.getResourceBundle().getBaseName();
      if (packageName.length() > 0) {
        bundleName=packageName + '.' + bundleName;
      }
      bundleName=bundleName.replace('.','/');
      myTfBundleName.setText(bundleName);
    }
  }
);
  myTfKey.registerKeyboardAction(new AbstractAction(){
    public void actionPerformed(    final ActionEvent e){
      myTfKey.getButton().doClick();
    }
  }
,KeyStroke.getKeyStroke(myLblKey.getDisplayedMnemonic(),KeyEvent.ALT_DOWN_MASK),JComponent.WHEN_IN_FOCUSED_WINDOW);
  myTfKey.addActionListener(new ActionListener(){
    public void actionPerformed(    final ActionEvent e){
      final String bundleName=myTfBundleName.getText();
      if (bundleName.length() == 0) {
        Messages.showErrorDialog("Please specify name of the resource bundle","Error");
        return;
      }
      final ResourceBundle bundle=ResourceBundleLoader.getResourceBundle(myModule,bundleName);
      if (bundle == null) {
        Messages.showErrorDialog("Bundle \"" + bundleName + "\" does not exist","Error");
        return;
      }
      final KeyChooserDialog dialog=new KeyChooserDialog(myTfKey,bundle,bundleName,myTfKey.getText());
      dialog.show();
      if (!dialog.isOK()) {
        return;
      }
      final StringDescriptor descriptor=dialog.getDescriptor();
      if (descriptor == null) {
        return;
      }
      myTfKey.setText(descriptor.getKey());
      myTfValue.setText(descriptor.getResolvedValue());
    }
  }
);
}
