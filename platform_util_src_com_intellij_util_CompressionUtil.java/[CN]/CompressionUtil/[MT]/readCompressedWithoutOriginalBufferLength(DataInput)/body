{
  int size=DataInputOutputUtil.readINT(in);
  byte[] bytes=spareBufferLocal.getBuffer(size);
  in.readFully(bytes,0,size);
  int decompressedRequests=myDecompressionRequests.incrementAndGet();
  long started=System.nanoTime();
  byte[] decompressedResult=Snappy.uncompress(bytes,0,size);
  long doneTime=System.nanoTime() - started;
  long decompressedSize=myDecompressedSize.addAndGet(size);
  long decompressedTime=myDecompressionTime.addAndGet(doneTime);
  if (DUMP_COMPRESSION_STATS && decompressedRequests % 1000 == 0) {
    System.out.println("Decompressed " + decompressedRequests + " times, size: "+ decompressedSize+ " for "+ (decompressedTime / 1000000)+ "ms");
  }
  return decompressedResult;
}
