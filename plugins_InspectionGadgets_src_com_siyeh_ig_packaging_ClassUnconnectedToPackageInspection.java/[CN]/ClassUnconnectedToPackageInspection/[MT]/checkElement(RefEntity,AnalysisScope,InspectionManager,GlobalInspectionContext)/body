{
  if (!(refEntity instanceof RefClass)) {
    return null;
  }
  if (globalInspectionContext.isSuppressed(refEntity,getShortName())) {
    return null;
  }
  final RefClass refClass=(RefClass)refEntity;
  final PsiClass aClass=refClass.getElement();
  if (ClassUtils.isInnerClass(aClass)) {
    return null;
  }
  final Set<RefClass> dependencies=DependencyUtils.calculateDependenciesForClass(refClass);
  for (  RefClass dependency : dependencies) {
    if (inSamePackage(refClass,dependency)) {
      return null;
    }
  }
  final Set<RefClass> dependents=DependencyUtils.calculateDependentsForClass(refClass);
  for (  RefClass dependent : dependents) {
    if (inSamePackage(refClass,dependent)) {
      return null;
    }
  }
  final String errorString=InspectionGadgetsBundle.message("class.unconnected.to.package.problem.descriptor",refEntity.getName());
  return new CommonProblemDescriptor[]{inspectionManager.createProblemDescriptor(errorString)};
}
