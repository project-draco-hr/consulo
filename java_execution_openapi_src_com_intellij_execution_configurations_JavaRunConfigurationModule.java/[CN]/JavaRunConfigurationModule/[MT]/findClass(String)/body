{
  if (qualifiedName == null)   return null;
  final Module module=getModule();
  final GlobalSearchScope scope;
  if (module != null) {
    scope=myClassesInLibraries ? module.getModuleRuntimeScope(true) : GlobalSearchScope.moduleWithDependenciesScope(module);
  }
 else {
    scope=myClassesInLibraries ? GlobalSearchScope.allScope(getProject()) : GlobalSearchScope.projectScope(getProject());
  }
  return JavaExecutionUtil.findMainClass(getProject(),qualifiedName,scope);
}
