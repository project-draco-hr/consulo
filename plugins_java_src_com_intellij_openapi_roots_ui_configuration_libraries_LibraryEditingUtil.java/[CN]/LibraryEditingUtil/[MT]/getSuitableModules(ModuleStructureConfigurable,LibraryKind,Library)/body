{
  final List<Module> modules=new ArrayList<Module>();
  LibraryType type=kind == null ? null : LibraryType.findByKind(kind);
  for (  Module module : rootConfigurable.getModules()) {
    if (type != null && !type.isSuitableModule(module,rootConfigurable.getFacetConfigurator())) {
      continue;
    }
    if (library != null) {
      final ModuleRootModel rootModel=rootConfigurable.getContext().getModulesConfigurator().getRootModel(module);
      if (!getNotAddedLibrariesCondition(rootModel).apply(library)) {
        continue;
      }
    }
    modules.add(module);
  }
  return modules;
}
