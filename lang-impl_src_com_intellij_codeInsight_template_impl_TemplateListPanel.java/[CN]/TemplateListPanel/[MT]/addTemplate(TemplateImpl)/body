{
  TemplateGroup newGroup=getTemplateGroup(template.getGroupName());
  if (newGroup == null) {
    newGroup=new TemplateGroup(template.getGroupName());
    insertNewGroup(newGroup);
  }
  if (!newGroup.contains(template)) {
    newGroup.addTemplate(template);
  }
  DefaultMutableTreeNode node=new DefaultMutableTreeNode(template);
  if (myTreeRoot.getChildCount() > 0) {
    for (DefaultMutableTreeNode child=(DefaultMutableTreeNode)myTreeRoot.getFirstChild(); child != null; child=(DefaultMutableTreeNode)myTreeRoot.getChildAfter(child)) {
      if (((TemplateGroup)child.getUserObject()).getName().equals(template.getGroupName())) {
        int index=getIndexToInsert(child,template.getKey());
        child.insert(node,index);
        myTreeTableModel.nodesWereInserted(child,new int[]{index});
        setSelectedNode(node);
        return node;
      }
    }
  }
  return null;
}
