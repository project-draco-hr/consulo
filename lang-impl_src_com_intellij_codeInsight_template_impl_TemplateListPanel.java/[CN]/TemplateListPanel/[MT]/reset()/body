{
  TemplateSettings templateSettings=TemplateSettings.getInstance();
  List<TemplateGroup> groups=new ArrayList<TemplateGroup>(templateSettings.getTemplateGroups());
  Collections.sort(groups,new Comparator<TemplateGroup>(){
    public int compare(    final TemplateGroup o1,    final TemplateGroup o2){
      return o1.getName().compareTo(o2.getName());
    }
  }
);
  initTemplates(groups,templateSettings.getLastSelectedTemplateKey());
  if (templateSettings.getDefaultShortcutChar() == TemplateSettings.TAB_CHAR) {
    myExpandByCombo.setSelectedItem(TAB);
  }
 else   if (templateSettings.getDefaultShortcutChar() == TemplateSettings.ENTER_CHAR) {
    myExpandByCombo.setSelectedItem(ENTER);
  }
 else {
    myExpandByCombo.setSelectedItem(SPACE);
  }
  UiNotifyConnector.doWhenFirstShown(this,new Runnable(){
    public void run(){
      updateTemplateText();
    }
  }
);
  isModified=false;
  myUpdateNeeded=true;
}
