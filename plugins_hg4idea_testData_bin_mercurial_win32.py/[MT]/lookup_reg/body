def lookup_reg(key, valname=None, scope=None):
    ' Look up a key/value name in the Windows registry.\n\n    valname: value name. If unspecified, the default value for the key\n    is used.\n    scope: optionally specify scope for registry lookup, this can be\n    a sequence of scopes to look up in order. Default (CURRENT_USER,\n    LOCAL_MACHINE).\n    '
    try:
        from _winreg import HKEY_CURRENT_USER, HKEY_LOCAL_MACHINE, QueryValueEx, OpenKey
    except ImportError:
        return None
    if (scope is None):
        scope = (HKEY_CURRENT_USER, HKEY_LOCAL_MACHINE)
    elif (not isinstance(scope, (list, tuple))):
        scope = (scope,)
    for s in scope:
        try:
            val = QueryValueEx(OpenKey(s, key), valname)[0]
            return encoding.tolocal(val.encode('UTF-8'))
        except EnvironmentError:
            pass
