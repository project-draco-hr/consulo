def user_rcpath_win32():
    'return os-specific hgrc search path to the user dir'
    userdir = os.path.expanduser('~')
    if ((sys.getwindowsversion()[3] != 2) and (userdir == '~')):
        appdir = shell.SHGetPathFromIDList(shell.SHGetSpecialFolderLocation(0, shellcon.CSIDL_APPDATA))
        userdir = os.path.dirname(appdir)
    return [os.path.join(userdir, 'mercurial.ini'), os.path.join(userdir, '.hgrc')]
