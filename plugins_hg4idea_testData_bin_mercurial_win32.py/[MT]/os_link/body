def os_link(src, dst):
    try:
        win32file.CreateHardLink(dst, src)
        if (nlinks(src) < 2):
            try:
                win32file.DeleteFile(dst)
            except:
                pass
            raise OSError(errno.EINVAL, 'Hardlinking not supported')
    except pywintypes.error as details:
        raise OSError(errno.EINVAL, 'target implements hardlinks improperly')
    except NotImplementedError:
        raise OSError(errno.EINVAL, 'Hardlinking not supported')
