{
  return new ChooserDialog<Library>(){
    private LibraryTableEditor myEditor;
    private boolean myIsOk;
{
      myEditor=LibraryTableEditor.editLibraryTable(myLibraryTableModelProvider,myProject);
      Disposer.register(this,myEditor);
    }
    public List<Library> getChosenElements(){
      final List<Library> chosen=new ArrayList<Library>(Arrays.asList(myEditor.getSelectedLibraries()));
      chosen.removeAll(getAlreadyAddedLibraries());
      return chosen;
    }
    public void doChoose(){
      final Iterator iter=myLibraryTableModelProvider.getModifiableModel().getLibraryIterator();
      myIsOk=myEditor.openDialog(ClasspathPanel.this,iter.hasNext() ? Collections.singleton((Library)iter.next()) : Collections.<Library>emptyList(),false);
    }
    public boolean isOK(){
      return myIsOk;
    }
    public void dispose(){
    }
  }
;
}
