{
  final AntDomElement hostingElement=getHostingAntDomElement();
  if (hostingElement == null) {
    return null;
  }
  AntDomProject projectToSearchFrom;
  AntDomTarget contextTarget;
  if (hostingElement instanceof AntDomAnt) {
    final PsiFileSystemItem antFile=((AntDomAnt)hostingElement).getAntFilePath().getValue();
    projectToSearchFrom=antFile instanceof PsiFile ? AntSupport.getAntDomProjectForceAntFile((PsiFile)antFile) : null;
    contextTarget=null;
  }
 else {
    projectToSearchFrom=hostingElement.getContextAntProject();
    contextTarget=hostingElement.getParentOfType(AntDomTarget.class,false);
  }
  if (projectToSearchFrom == null) {
    return null;
  }
  return TargetResolver.resolve(projectToSearchFrom,contextTarget,referenceText == null ? Collections.<String>emptyList() : Collections.singletonList(referenceText));
}
