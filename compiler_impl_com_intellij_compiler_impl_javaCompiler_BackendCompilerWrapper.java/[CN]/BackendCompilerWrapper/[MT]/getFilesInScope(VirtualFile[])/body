{
  final List<VirtualFile> filesInScope=new ArrayList<VirtualFile>(dependentFiles.length);
  ApplicationManager.getApplication().runReadAction(new Runnable(){
    public void run(){
      for (int idx=0; idx < dependentFiles.length; idx++) {
        VirtualFile dependentFile=dependentFiles[idx];
        if (myCompileContext.getCompileScope().belongs(dependentFile.getUrl())) {
          filesInScope.add(dependentFile);
        }
      }
    }
  }
);
  return filesInScope.toArray(new VirtualFile[filesInScope.size()]);
}
