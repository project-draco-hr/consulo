{
  final Ref<CacheCorruptedException> exRef=new Ref<CacheCorruptedException>(null);
  ProjectRootManager.getInstance(myProject).getFileIndex().iterateContentUnderDirectory(from,new ContentIterator(){
    public boolean processFile(    final VirtualFile child){
      try {
        if (!child.isDirectory() && StdFileTypes.JAVA.equals(typeManager.getFileTypeByFile(child))) {
          updateOutputItemsList(outputDir,child,compiledWithErrors,sourceRoot,packagePrefix);
        }
        return true;
      }
 catch (      CacheCorruptedException e) {
        exRef.set(e);
        return false;
      }
    }
  }
);
  if (exRef.get() != null) {
    throw exRef.get();
  }
}
