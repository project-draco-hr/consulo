{
  Runnable runnable=new Runnable(){
    public void run(){
      Window[] windows=Window.getWindows();
      Window targetWindow=null;
      for (      Window each : windows) {
        if (each.isActive()) {
          targetWindow=each;
          break;
        }
      }
      if (targetWindow == null) {
        targetWindow=JOptionPane.getRootFrame();
      }
      if (targetWindow == null) {
        final IdeFrame frame=IdeFocusManager.findInstance().getLastFocusedFrame();
        if (frame == null) {
          final Project[] projects=ProjectManager.getInstance().getOpenProjects();
          final Project project=projects == null || projects.length == 0 ? ProjectManager.getInstance().getDefaultProject() : projects[0];
          final JFrame jFrame=WindowManager.getInstance().getFrame(project);
          if (jFrame != null) {
            showBalloonForComponent(jFrame,message,type,true,project);
          }
 else {
            LOG.info("Can not get component to show message: " + message);
          }
          return;
        }
        showBalloonForComponent(frame.getComponent(),message,type,true,frame.getProject());
      }
 else {
        showBalloonForComponent(targetWindow,message,type,true,null);
      }
    }
  }
;
  UIUtil.invokeLaterIfNeeded(runnable);
}
