{
  CharSequence chars=document.getCharsSequence();
  int spaceEnd=CharArrayUtil.shiftForward(chars,startOffset," \t");
  int line=document.getLineNumber(startOffset);
  if (spaceEnd > endOffset || indentLevel <= 0 || line >= document.getLineCount() - 1 || chars.charAt(spaceEnd) == '\n') {
    return;
  }
  int linesToAdjustIndent=0;
  for (int i=line + 1; i < document.getLineCount(); i++) {
    if (document.getLineStartOffset(i) >= endOffset) {
      break;
    }
    linesToAdjustIndent++;
  }
  char[] fill=new char[indentLevel];
  Arrays.fill(fill,' ');
  String indentString=new String(fill);
  for (; linesToAdjustIndent > 0; linesToAdjustIndent--) {
    int lineStartOffset=document.getLineStartOffset(++line);
    document.insertString(lineStartOffset,indentString);
  }
}
