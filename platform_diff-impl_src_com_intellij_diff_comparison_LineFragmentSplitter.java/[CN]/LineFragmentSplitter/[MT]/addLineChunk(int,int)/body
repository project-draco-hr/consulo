{
  if (last1 > end1 || last2 > end2)   return;
  WordBlock block=createBlock(last1,last2,end1,end2);
  if (block.offsets.isEmpty())   return;
  WordBlock lastBlock=ContainerUtil.getLastItem(myResult);
  if (lastBlock != null && shouldMergeBlocks(lastBlock,block)) {
    myResult.remove(myResult.size() - 1);
    myResult.add(mergeBlocks(lastBlock,block));
    lastHasEqualWords=hasEqualWords || lastHasEqualWords;
  }
 else {
    myResult.add(block);
    lastHasEqualWords=hasEqualWords;
  }
  hasEqualWords=false;
  last1=end1;
  last2=end2;
}
