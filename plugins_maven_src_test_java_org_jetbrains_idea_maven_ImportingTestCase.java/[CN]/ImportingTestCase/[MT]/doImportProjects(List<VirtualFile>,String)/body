{
  try {
    List<String> profilesList=Arrays.asList(profiles);
    MavenImportProcessor p=new MavenImportProcessor(myProject);
    p.createMavenProjectModel(files,new HashMap<VirtualFile,Module>(),profilesList,new Progress());
    p.createMavenToIdeaMapping();
    resolutionProblems=new ArrayList<Pair<File,List<String>>>();
    p.resolve(myProject,profilesList,resolutionProblems);
    p.commit(myProject,profilesList);
    projectModel=p.getMavenProjectModel();
  }
 catch (  CanceledException e) {
    throw new RuntimeException(e);
  }
}
