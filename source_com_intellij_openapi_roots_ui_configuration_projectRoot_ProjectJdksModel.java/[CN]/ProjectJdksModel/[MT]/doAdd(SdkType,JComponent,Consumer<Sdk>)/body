{
  myModified=true;
  final String home=SdkEditor.selectSdkHome(parent,type);
  if (home == null) {
    return;
  }
  final Set<String> names=new HashSet<String>();
  for (  Sdk jdk : myProjectJdks.values()) {
    names.add(jdk.getName());
  }
  final String suggestedName=type.suggestSdkName(null,home);
  String newSdkName=suggestedName;
  int i=0;
  while (names.contains(newSdkName)) {
    newSdkName=suggestedName + " (" + (++i)+ ")";
  }
  final ProjectJdkImpl newJdk=new ProjectJdkImpl(newSdkName,type);
  newJdk.setHomePath(home);
  if (!type.setupSdkPaths(newJdk,this))   return;
  if (newJdk.getVersionString() == null) {
    Messages.showMessageDialog(ProjectBundle.message("sdk.java.corrupt.error",home),ProjectBundle.message("sdk.java.corrupt.title"),Messages.getErrorIcon());
  }
  myProjectJdks.put(newJdk,newJdk);
  updateTree.consume(newJdk);
  mySdkEventsDispatcher.getMulticaster().sdkAdded(newJdk);
}
