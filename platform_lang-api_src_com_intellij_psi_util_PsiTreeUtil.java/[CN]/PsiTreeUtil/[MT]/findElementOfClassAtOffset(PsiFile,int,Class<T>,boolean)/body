{
  final PsiElement[] psiRoots=file.getPsiRoots();
  T result=null;
  for (  PsiElement root : psiRoots) {
    final PsiElement elementAt=root.findElementAt(offset);
    if (elementAt != null) {
      final T parent=getParentOfType(elementAt,clazz,strictStart);
      if (parent != null) {
        final TextRange range=parent.getTextRange();
        if (!strictStart || range.getStartOffset() == offset) {
          if (result == null || result.getTextRange().getEndOffset() > range.getEndOffset()) {
            result=parent;
          }
        }
      }
    }
  }
  return result;
}
