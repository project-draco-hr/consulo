{
  for (  UsageInfo usage : usages) {
    final PsiElement element=usage.getElement();
    if (element == null)     continue;
    if (!(usage instanceof LocalHidesFieldUsageInfo)) {
      final PsiReference ref;
      if (!(usage instanceof MoveRenameUsageInfo)) {
        ref=element.getReference();
      }
 else {
        ref=((MoveRenameUsageInfo)usage).reference;
      }
      if (ref != null) {
        PsiElement newElem=ref.handleElementRename(newName);
        if (variable instanceof PsiField) {
          fixPossibleNameCollisionsForFieldRenaming((PsiField)variable,newName,newElem);
        }
      }
    }
 else {
      PsiJavaCodeReferenceElement collidingRef=(PsiJavaCodeReferenceElement)element;
      PsiElement resolved=collidingRef.resolve();
      if (resolved instanceof PsiField) {
        qualifyField((PsiField)resolved,collidingRef,newName);
      }
 else {
      }
    }
  }
  variable.setName(newName);
  listener.elementRenamed(variable);
}
