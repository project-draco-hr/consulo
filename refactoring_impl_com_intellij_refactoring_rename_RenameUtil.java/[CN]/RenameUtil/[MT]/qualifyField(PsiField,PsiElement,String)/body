{
  PsiManager psiManager=occurence.getManager();
  PsiElementFactory factory=psiManager.getElementFactory();
  if (!field.hasModifierProperty(PsiModifier.STATIC)) {
    PsiReferenceExpression qualified=(PsiReferenceExpression)factory.createExpressionFromText("this." + newName,null);
    qualified=(PsiReferenceExpression)CodeStyleManager.getInstance(psiManager.getProject()).reformat(qualified);
    occurence.replace(qualified);
  }
 else {
    PsiReferenceExpression qualified=(PsiReferenceExpression)factory.createExpressionFromText("a." + newName,null);
    qualified=(PsiReferenceExpression)CodeStyleManager.getInstance(psiManager.getProject()).reformat(qualified);
    qualified.getQualifierExpression().replace(factory.createReferenceExpression(field.getContainingClass()));
    occurence.replace(qualified);
  }
}
