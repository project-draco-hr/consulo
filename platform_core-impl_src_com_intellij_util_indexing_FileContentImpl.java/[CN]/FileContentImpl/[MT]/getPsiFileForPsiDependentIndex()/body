{
  Document document=FileDocumentManager.getInstance().getCachedDocument(getFile());
  PsiFile psi=null;
  if (document != null) {
    PsiDocumentManager psiDocumentManager=PsiDocumentManager.getInstance(getProject());
    if (psiDocumentManager.isUncommited(document)) {
      PsiFile existingPsi=psiDocumentManager.getPsiFile(document);
      if (existingPsi != null) {
        psi=existingPsi;
      }
    }
  }
  if (psi == null) {
    psi=getPsiFile();
  }
  return psi;
}
