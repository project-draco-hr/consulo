{
  DebuggerSession session=context.getDebuggerSession();
  final RefreshThreadsTreeCommand command=new RefreshThreadsTreeCommand(session);
  final int state=session != null ? session.getState() : DebuggerSession.STATE_DISPOSED;
  if (ApplicationManager.getApplication().isUnitTestMode() || state == DebuggerSession.STATE_PAUSED || state == DebuggerSession.STATE_RUNNING) {
    showMessage(MessageDescriptor.EVALUATING);
    context.getDebugProcess().getManagerThread().schedule(command);
  }
 else {
    showMessage(session != null ? session.getStateDescription() : DebuggerBundle.message("status.debug.stopped"));
  }
}
