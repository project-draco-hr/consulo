{
  for (int i=references.length - 1; i >= 0; i--) {
    PsiReference ref=references[i];
    if (ref instanceof PsiDynaReference) {
      ref=((PsiDynaReference)ref).getLastFileReference();
    }
    if (ref instanceof FileReference) {
      final PsiElement file=references[i].resolve();
      return file instanceof PsiFile ? (PsiFile)file : null;
    }
  }
  return null;
}
