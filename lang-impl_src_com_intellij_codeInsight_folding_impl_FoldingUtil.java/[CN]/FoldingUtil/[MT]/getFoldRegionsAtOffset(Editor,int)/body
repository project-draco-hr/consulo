{
  ArrayList<FoldRegion> list=new ArrayList<FoldRegion>();
  FoldRegion[] allRegions=editor.getFoldingModel().getAllFoldRegions();
  for (  FoldRegion region : allRegions) {
    if (region.getStartOffset() <= offset && offset <= region.getEndOffset()) {
      list.add(region);
    }
  }
  FoldRegion[] regions=list.toArray(new FoldRegion[list.size()]);
  Arrays.sort(regions,new Comparator<FoldRegion>(){
    public int compare(    FoldRegion region1,    FoldRegion region2){
      return region2.getStartOffset() - region1.getStartOffset();
    }
  }
);
  return regions;
}
