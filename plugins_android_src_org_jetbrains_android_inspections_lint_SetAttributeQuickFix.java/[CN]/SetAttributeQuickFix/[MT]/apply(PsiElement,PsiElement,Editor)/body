{
  final XmlTag tag=PsiTreeUtil.getParentOfType(startElement,XmlTag.class,false);
  if (tag == null) {
    return;
  }
  final XmlAttribute attribute=tag.setAttribute(myAttributeName,SdkConstants.NS_RESOURCES,"");
  if (attribute != null) {
    if (myValue != null) {
      attribute.setValue(myValue);
    }
    if (editor != null) {
      final XmlAttributeValue valueElement=attribute.getValueElement();
      final TextRange valueTextRange=attribute.getValueTextRange();
      if (valueElement != null && valueTextRange != null) {
        final int valueElementStart=valueElement.getTextRange().getStartOffset();
        editor.getCaretModel().moveToOffset(valueElementStart + valueTextRange.getStartOffset());
        if (valueTextRange.getStartOffset() < valueTextRange.getEndOffset()) {
          editor.getSelectionModel().setSelection(valueElementStart + valueTextRange.getStartOffset(),valueElementStart + valueTextRange.getEndOffset());
        }
      }
    }
  }
}
