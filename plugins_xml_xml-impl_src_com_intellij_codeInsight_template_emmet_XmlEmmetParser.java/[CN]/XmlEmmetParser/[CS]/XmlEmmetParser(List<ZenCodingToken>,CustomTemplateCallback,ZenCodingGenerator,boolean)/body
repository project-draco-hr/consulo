{
  super(tokens,callback,generator);
  PsiElement context=callback.getContext();
  XmlTag parentTag=PsiTreeUtil.getParentOfType(context,XmlTag.class);
  if (surroundWithTemplate && parentTag != null && context.getNode().getElementType() == XmlTokenType.XML_START_TAG_START) {
    parentTag=PsiTreeUtil.getParentOfType(parentTag,XmlTag.class);
  }
  if (parentTag != null) {
    hasTagContext=true;
    tagLevel.push(parentTag.getName());
  }
}
