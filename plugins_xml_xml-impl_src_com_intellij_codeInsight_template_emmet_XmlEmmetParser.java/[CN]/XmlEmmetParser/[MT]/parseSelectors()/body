{
  final List<Pair<String,String>> result=new ArrayList<Pair<String,String>>();
  int classAttrPosition=-1;
  int idAttrPosition=-1;
  final StringBuilder classAttrBuilder=new StringBuilder();
  final StringBuilder idAttrBuilder=new StringBuilder();
  while (true) {
    final List<Pair<String,String>> attrList=parseSelector();
    if (attrList == null) {
      if (classAttrPosition != -1) {
        result.set(classAttrPosition,new Pair<String,String>(CLASS,classAttrBuilder.toString()));
      }
      if (idAttrPosition != -1) {
        result.set(idAttrPosition,new Pair<String,String>(ID,idAttrBuilder.toString()));
      }
      return result;
    }
    for (    Pair<String,String> attr : attrList) {
      if (CLASS.equals(attr.first)) {
        if (classAttrBuilder.length() > 0) {
          classAttrBuilder.append(' ');
        }
        classAttrBuilder.append(attr.second);
        if (classAttrPosition == -1) {
          classAttrPosition=result.size();
          result.add(attr);
        }
      }
 else       if (ID.equals(attr.first)) {
        if (idAttrBuilder.length() > 0) {
          idAttrBuilder.append(' ');
        }
        idAttrBuilder.append(attr.second);
        if (idAttrPosition == -1) {
          idAttrPosition=result.size();
          result.add(attr);
        }
      }
 else {
        result.add(attr);
      }
    }
  }
}
