{
  String oldText=expr.getText();
  if (oldText.startsWith("\"")) {
    newContent=StringUtil.escapeStringCharacters(newContent);
  }
 else   if (oldText.startsWith("'") && newContent.length() <= 1) {
    newContent=newContent.length() == 1 && newContent.charAt(0) == '\'' ? "\\'" : newContent;
  }
 else {
    throw new IncorrectOperationException("cannot handle content change for: " + oldText + ", expr: "+ expr);
  }
  String newText=oldText.substring(0,range.getStartOffset()) + newContent + oldText.substring(range.getEndOffset());
  final PsiExpression newExpr=JavaPsiFacade.getInstance(expr.getProject()).getElementFactory().createExpressionFromText(newText,null);
  return (PsiLiteralExpression)expr.replace(newExpr);
}
