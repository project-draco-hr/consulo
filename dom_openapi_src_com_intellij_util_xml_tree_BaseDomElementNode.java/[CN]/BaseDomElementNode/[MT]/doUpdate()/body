{
  if (!myDomElement.isValid())   return;
  setUniformIcon(getNodeIcon());
  clearColoredText();
  final DomElementAnnotationsManager manager=DomElementAnnotationsManager.getInstance(myDomElement.getManager().getProject());
  final DomElementsProblemsHolder holder=manager.getCachedProblemHolder(myDomElement);
  final List<DomElementProblemDescriptor> problems=holder.getProblems(myDomElement,true,highlightIfChildrenHasProblems(),HighlightSeverity.ERROR);
  if (problems.size() > 0) {
    addColoredFragment(getNodeName(),TooltipUtils.getTooltipText(problems),SimpleTextAttributes.ERROR_ATTRIBUTES);
  }
 else   if (myDomElement.getXmlTag() == null && !(myDomElement instanceof DomFileElement)) {
    addColoredFragment(getNodeName(),folder ? SimpleTextAttributes.GRAYED_BOLD_ATTRIBUTES : SimpleTextAttributes.GRAYED_ATTRIBUTES);
  }
 else   if (folder) {
    addColoredFragment(getNodeName(),SimpleTextAttributes.REGULAR_BOLD_ATTRIBUTES);
    final int childrenCount=getChildren().length;
    addColoredFragment(" (" + childrenCount + ')',SimpleTextAttributes.GRAY_ITALIC_ATTRIBUTES);
  }
 else {
    addColoredFragment(getNodeName(),SimpleTextAttributes.REGULAR_ATTRIBUTES);
  }
}
