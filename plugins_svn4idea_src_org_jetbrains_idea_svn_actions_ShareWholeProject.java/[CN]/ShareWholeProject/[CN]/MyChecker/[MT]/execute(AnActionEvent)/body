{
  final DataContext dataContext=e.getDataContext();
  myProject=PlatformDataKeys.PROJECT.getData(dataContext);
  if (myProject == null || myProject.isDefault()) {
    return;
  }
  final VirtualFile baseDir=myProject.getBaseDir();
  if (baseDir == null)   return;
  final ProjectLevelVcsManager vcsManager=ProjectLevelVcsManager.getInstance(myProject);
  final MyCheckResult result=checkMappings(baseDir,vcsManager);
  if (MyCheckResult.disable.equals(result))   return;
  myHadNoMappings=MyCheckResult.notMapped.equals(result);
  if (MyCheckResult.notMapped.equals(result)) {
    if (SvnUtil.seemsLikeVersionedDir(baseDir))     return;
  }
 else   if (SvnStatusUtil.isUnderControl(myProject,baseDir)) {
    return;
  }
  if ((!myHadNoMappings) && (!SvnVcs.getInstance(myProject).getSvnFileUrlMapping().isEmpty())) {
    return;
  }
  myVisible=true;
  myEnabled=(!vcsManager.isBackgroundVcsOperationRunning());
}
