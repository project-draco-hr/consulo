{
  String text=String.valueOf(node);
  if (text != null) {
    if (node instanceof StructureViewComponent.StructureViewTreeElementWrapper) {
      final TreeElement value=((StructureViewComponent.StructureViewTreeElementWrapper)node).getValue();
      if (value instanceof PsiTreeElementBase && ((PsiTreeElementBase)value).isSearchInLocationString()) {
        final String string=((PsiTreeElementBase)value).getLocationString();
        if (!StringUtil.isEmpty(string)) {
          return text + " (" + string+ ")";
        }
      }
    }
    return text;
  }
  if (node instanceof StructureViewComponent.StructureViewTreeElementWrapper) {
    final AccessToken token=ApplicationManager.getApplication().acquireReadActionLock();
    try {
      final ItemPresentation presentation=((StructureViewComponent.StructureViewTreeElementWrapper)node).getValue().getPresentation();
      return presentation.getPresentableText();
    }
  finally {
      token.finish();
    }
  }
  return null;
}
