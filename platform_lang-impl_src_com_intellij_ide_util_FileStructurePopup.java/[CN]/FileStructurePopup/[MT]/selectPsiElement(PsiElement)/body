{
  Set<PsiElement> parents=new java.util.HashSet<PsiElement>();
  while (element != null) {
    parents.add(element);
    if (element instanceof PsiFile)     break;
    element=element.getParent();
  }
  FilteringTreeStructure.FilteringNode node=(FilteringTreeStructure.FilteringNode)myAbstractTreeBuilder.getRootElement();
  while (node != null) {
    boolean changed=false;
    for (    FilteringTreeStructure.FilteringNode n : node.children()) {
      final PsiElement psiElement=getPsi(n);
      if (psiElement != null && parents.contains(psiElement)) {
        node=n;
        changed=true;
        break;
      }
    }
    if (!changed) {
      myAbstractTreeBuilder.getUi().select(node,null);
      return;
    }
  }
}
