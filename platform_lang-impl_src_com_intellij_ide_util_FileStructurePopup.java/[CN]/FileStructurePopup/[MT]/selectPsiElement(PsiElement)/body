{
  Set<PsiElement> parents=getAllParents(element);
  FilteringTreeStructure.FilteringNode node=(FilteringTreeStructure.FilteringNode)myAbstractTreeBuilder.getRootElement();
  while (node != null) {
    boolean changed=false;
    for (    FilteringTreeStructure.FilteringNode n : node.children()) {
      final PsiElement psiElement=getPsi(n);
      if (psiElement != null && parents.contains(psiElement)) {
        node=n;
        changed=true;
        break;
      }
    }
    if (!changed) {
      myAbstractTreeBuilder.getUi().select(node,null);
      if (myAbstractTreeBuilder.getSelectedElements().isEmpty()) {
        TreeUtil.selectFirstNode(myTree);
      }
      return;
    }
  }
  TreeUtil.selectFirstNode(myTree);
}
