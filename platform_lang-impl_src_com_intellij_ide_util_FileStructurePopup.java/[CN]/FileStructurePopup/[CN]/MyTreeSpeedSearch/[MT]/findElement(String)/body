{
  List<ObjectWithWeight> elements=new ArrayList<ObjectWithWeight>();
  s=s.trim();
  final ListIterator<Object> it=getElementIterator(0);
  while (it.hasNext()) {
    final ObjectWithWeight o=new ObjectWithWeight(it.next(),s,getComparator());
    if (!o.weights.isEmpty()) {
      elements.add(o);
    }
  }
  ObjectWithWeight cur=null;
  ArrayList<ObjectWithWeight> current=new ArrayList<ObjectWithWeight>();
  for (  ObjectWithWeight element : elements) {
    if (cur == null) {
      cur=element;
      current.add(cur);
      continue;
    }
    final int i=element.compareWith(cur);
    if (i == 0) {
      current.add(element);
    }
 else     if (i < 0) {
      cur=element;
      current.clear();
      current.add(cur);
    }
  }
  return current.isEmpty() ? null : findClosestTo(myInitialPsiElement,current);
}
