{
  myProject=project;
  myEditor=editor;
  myNavigatable=navigatable;
  myBaseTreeModel=structureViewModel;
  myDisposable=auxDisposable;
  if (applySortAndFilter) {
    myTreeActionsOwner=new MyTreeActionsOwner();
    myTreeModel=new TreeModelWrapper(structureViewModel,myTreeActionsOwner){
      @NotNull @Override public Filter[] getFilters(){
        return ArrayUtil.append(super.getFilters(),mySearchFilter);
      }
    }
;
  }
 else {
    myTreeActionsOwner=null;
    myTreeModel=structureViewModel;
  }
  PsiFile psiFile=getPsiFile(project);
  final PsiElement psiElement=getCurrentElement(psiFile);
  if (psiElement != null) {
    if (structureViewModel.shouldEnterElement(psiElement)) {
    }
 else {
    }
  }
  SmartTreeStructure treeStructure=new SmartTreeStructure(project,myTreeModel){
    public void rebuildTree(){
      if (!myPopup.isDisposed()) {
        super.rebuildTree();
      }
    }
    public boolean isToBuildChildrenInBackground(    final Object element){
      return getRootElement() == element;
    }
    protected TreeElementWrapper createTree(){
      return new StructureViewComponent.StructureViewTreeElementWrapper(myProject,myModel.getRoot(),myModel);
    }
    @Override public String toString(){
      return "structure view tree structure(model=" + myTreeModel + ")";
    }
  }
;
  final DefaultTreeModel model=new DefaultTreeModel(new DefaultMutableTreeNode(treeStructure.getRootElement()));
  myTree=new Tree(model);
  myTree.setRootVisible(false);
  myTree.setShowsRootHandles(true);
  myAbstractTreeBuilder=new StructureTreeBuilder(project,myTree,(DefaultTreeModel)myTree.getModel(),treeStructure,myTreeModel){
    @Override protected boolean validateNode(    Object child){
      return StructureViewComponent.isValid(child);
    }
  }
;
}
