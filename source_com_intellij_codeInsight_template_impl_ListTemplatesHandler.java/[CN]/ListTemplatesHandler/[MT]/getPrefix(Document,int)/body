{
  CharSequence chars=document.getCharsSequence();
  int start=offset;
  while (true) {
    if (start == 0)     break;
    char c=chars.charAt(start - 1);
    if (Character.isWhitespace(c))     break;
    start--;
  }
  return chars.subSequence(start,offset).toString();
}
