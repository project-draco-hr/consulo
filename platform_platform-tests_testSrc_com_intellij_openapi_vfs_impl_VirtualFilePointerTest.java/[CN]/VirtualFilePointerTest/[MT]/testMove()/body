{
  File tempDirectory=createTempDirectory();
  final File moveTarget=new File(tempDirectory,"moveTarget");
  moveTarget.mkdir();
  final File fileToMove=new File(tempDirectory,"toMove.txt");
  fileToMove.createNewFile();
  final LoggingListener fileToMoveListener=new LoggingListener();
  final VirtualFilePointer fileToMovePointer=createPointerByFile(fileToMove,fileToMoveListener);
  assertTrue(fileToMovePointer.isValid());
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    @Override public void run(){
      final VirtualFile virtualFile=getVirtualFile(fileToMove);
      assertTrue(virtualFile.isValid());
      final VirtualFile target=getVirtualFile(moveTarget);
      assertTrue(target.isValid());
      try {
        virtualFile.move(null,target);
      }
 catch (      IOException e) {
        fail();
      }
    }
  }
);
  assertTrue(fileToMovePointer.isValid());
  assertEquals("[]",fileToMoveListener.getLog().toString());
}
