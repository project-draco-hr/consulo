{
  final VirtualFile[] editedFiles=FileEditorManager.getInstance(myProject).getSelectedFiles();
  for (  PaletteGroupHeader group : myGroups) {
    remove(group);
    remove(group.getComponentList());
  }
  myGroups.clear();
  if (editedFiles.length > 0) {
    VirtualFile selectedFile=editedFiles[0];
    for (    PaletteItemProvider provider : myProviders) {
      PaletteGroup[] groups=provider.getActiveGroups(selectedFile);
      for (      PaletteGroup group : groups) {
        PaletteGroupHeader groupHeader=new PaletteGroupHeader(group);
        myGroups.add(groupHeader);
        add(groupHeader);
        PaletteComponentList componentList=new PaletteComponentList(group);
        add(componentList);
        groupHeader.setComponentList(componentList);
        componentList.addListSelectionListener(new MyListSelectionListener());
      }
    }
  }
  revalidate();
}
