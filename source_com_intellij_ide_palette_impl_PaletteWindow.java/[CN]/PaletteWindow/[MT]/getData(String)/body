{
  if (dataId.equals(DataConstants.PROJECT)) {
    return myProject;
  }
  PaletteItem item=getActiveItem();
  if (item != null) {
    Object data=item.getData(myProject,dataId);
    if (data != null)     return data;
  }
  for (  PaletteGroupHeader groupHeader : myGroupHeaders) {
    if (groupHeader.isSelected() && groupHeader.getComponentList().getSelectedValue() != null) {
      return groupHeader.getGroup().getData(myProject,dataId);
    }
  }
  JScrollPane activeScrollPane;
  if (collectTabNames(myGroups).length == 1) {
    activeScrollPane=myScrollPane;
  }
 else {
    activeScrollPane=(JScrollPane)myTabbedPane.getSelectedComponent();
  }
  PaletteContentWindow activeContentWindow=(PaletteContentWindow)activeScrollPane.getViewport().getView();
  PaletteGroupHeader groupHeader=activeContentWindow.getLastGroupHeader();
  if (groupHeader != null) {
    return groupHeader.getGroup().getData(myProject,dataId);
  }
  return null;
}
