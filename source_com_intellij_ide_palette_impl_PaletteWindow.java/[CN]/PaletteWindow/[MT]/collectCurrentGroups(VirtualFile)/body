{
  ArrayList<PaletteGroup> result=new ArrayList<PaletteGroup>();
  if (selectedFile == null) {
    VirtualFile[] editedFiles=FileEditorManager.getInstance(myProject).getSelectedFiles();
    if (editedFiles.length > 0) {
      selectedFile=editedFiles[0];
    }
  }
  if (selectedFile != null) {
    for (    PaletteItemProvider provider : myProviders) {
      PaletteGroup[] groups=provider.getActiveGroups(selectedFile);
      Collections.addAll(result,groups);
    }
  }
  return result;
}
