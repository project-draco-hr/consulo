{
  myRegistrar=registrar;
  mySeverityRegistrar=new SeverityRegistrar();
  SchemeProcessor<InspectionProfileImpl> processor=new BaseSchemeProcessor<InspectionProfileImpl>(){
    @Override public InspectionProfileImpl readScheme(    final Document document){
      InspectionProfileImpl profile=new InspectionProfileImpl(getProfileName(document),myRegistrar,InspectionProfileManager.this);
      profile.load(document.getRootElement());
      return profile;
    }
    @Override public boolean shouldBeSaved(    final InspectionProfileImpl scheme){
      return scheme.wasInitialized();
    }
    @Override public Document writeScheme(    final InspectionProfileImpl scheme) throws WriteExternalException {
      return scheme.saveToDocument();
    }
    @Override public void onSchemeAdded(    final InspectionProfileImpl scheme){
      updateProfileImpl(scheme);
      fireProfileChanged(scheme);
      onProfilesChanged();
    }
    @Override public void onSchemeDeleted(    final InspectionProfileImpl scheme){
      onProfilesChanged();
    }
    @Override public void onCurrentSchemeChanged(    final Scheme oldCurrentScheme){
      Profile current=mySchemesManager.getCurrentScheme();
      if (current != null) {
        fireProfileChanged((Profile)oldCurrentScheme,current,null);
      }
      onProfilesChanged();
    }
  }
;
  mySchemesManager=schemesManagerFactory.createSchemesManager(FILE_SPEC,processor,RoamingType.PER_USER);
}
