{
  if (!CodeInsightUtil.prepareFileForWrite(myFile))   return;
  try {
    PsiElementFactory factory=JavaPsiFacade.getInstance(myFile.getProject()).getElementFactory();
    if (myTargetPackage.getQualifiedName().length() == 0) {
      if (myStatement != null) {
        myStatement.delete();
      }
    }
 else {
      if (myStatement != null) {
        PsiJavaCodeReferenceElement packageReferenceElement=factory.createPackageReferenceElement(myTargetPackage);
        myStatement.getPackageReference().replace(packageReferenceElement);
      }
 else {
        PsiPackageStatement packageStatement=factory.createPackageStatement(myTargetPackage.getQualifiedName());
        myFile.addAfter(packageStatement,null);
      }
    }
  }
 catch (  IncorrectOperationException e) {
    LOG.error(e);
  }
}
