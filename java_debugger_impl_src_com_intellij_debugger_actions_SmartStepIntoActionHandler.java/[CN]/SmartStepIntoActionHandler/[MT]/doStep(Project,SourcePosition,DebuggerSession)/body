{
  final VirtualFile file=position != null ? position.getFile().getVirtualFile() : null;
  final FileEditor fileEditor=file != null ? FileEditorManager.getInstance(project).getSelectedEditor(file) : null;
  if (fileEditor instanceof TextEditor) {
    final List<PsiMethod> methods=findReferencedMethods(position);
    if (methods.size() > 0) {
      if (methods.size() == 1) {
        session.stepInto(true,createSmartStepFilter(methods.get(0)));
      }
 else {
        final PsiMethodListPopupStep popupStep=new PsiMethodListPopupStep(methods,new PsiMethodListPopupStep.OnChooseRunnable(){
          public void execute(          PsiMethod chosenMethod){
            session.stepInto(true,createSmartStepFilter(chosenMethod));
          }
        }
);
        final ListPopup popup=JBPopupFactory.getInstance().createListPopup(popupStep);
        final RelativePoint point=DebuggerUIUtil.calcPopupLocation(((TextEditor)fileEditor).getEditor(),position.getLine());
        popup.show(point);
      }
      return;
    }
  }
  session.stepInto(true,null);
}
