{
  final LayoutTreeComponent treeComponent=myEditor.getLayoutTreeComponent();
  final LayoutTreeSelection selection=treeComponent.getSelection();
  final CompositePackagingElement<?> parent=selection.getCommonParentElement();
  if (parent == null)   return;
  if (!treeComponent.checkCanRemove(selection.getNodes())) {
    return;
  }
  final Collection<? extends PackagingElement> selectedElements=selection.getElements();
  final String name=Messages.showInputDialog(myEditor.getMainComponent(),ProjectBundle.message("label.text.specify.artifact.name"),ProjectBundle.message("dialog.title.extract.artifact"),null);
  if (name != null) {
    treeComponent.ensureRootIsWritable();
    final Project project=myEditor.getContext().getProject();
    final ModifiableArtifact artifact=myEditor.getContext().getModifiableArtifactModel().addArtifact(name,PlainArtifactType.getInstance());
    for (    PackagingElement<?> element : selectedElements) {
      artifact.getRootElement().addOrFindChild(ArtifactUtil.copyWithChildren(element,project));
    }
    for (    PackagingElement element : selectedElements) {
      parent.removeChild(element);
    }
    parent.addOrFindChild(new ArtifactPackagingElement(project,ArtifactPointerManager.getInstance(project).create(artifact)));
    treeComponent.rebuildTree();
  }
}
