{
  TextRange hostTextRange=getHost().getTextRange();
  ProperTextRange textRange=relevantRangeInHost.isValid() ? new ProperTextRange(relevantRangeInHost.getStartOffset(),relevantRangeInHost.getEndOffset()) : null;
  textRange=textRange == null ? null : textRange.intersection(hostTextRange);
  if (textRange == null)   return new ProperTextRange(0,hostTextRange.getLength());
  return textRange.shiftRight(-hostTextRange.getStartOffset());
}
