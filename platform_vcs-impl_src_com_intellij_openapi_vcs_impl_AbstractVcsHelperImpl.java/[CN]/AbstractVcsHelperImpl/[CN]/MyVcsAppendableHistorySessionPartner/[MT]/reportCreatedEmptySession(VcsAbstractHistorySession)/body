{
  mySession=session;
  if (myFileHistoryPanel != null) {
    ApplicationManager.getApplication().invokeLater(new Runnable(){
      public void run(){
        myFileHistoryPanel.getHistoryPanelRefresh().consume(mySession);
      }
    }
);
    return;
  }
  ApplicationManager.getApplication().invokeLater(new Runnable(){
    public void run(){
      String actionName=VcsBundle.message("action.name.file.history",myPath.getName());
      ContentManager contentManager=ProjectLevelVcsManagerEx.getInstanceEx(myVcs.getProject()).getContentManager();
      myFileHistoryPanel=new FileHistoryPanelImpl(myVcs.getProject(),myPath,myRepositoryPath,session,myVcsHistoryProvider,myAnnotationProvider,contentManager,myRefresher);
      Content content=ContentFactory.SERVICE.getInstance().createContent(myFileHistoryPanel,actionName,true);
      ContentsUtil.addOrReplaceContent(contentManager,content,true);
      ToolWindow toolWindow=ToolWindowManager.getInstance(myVcs.getProject()).getToolWindow(ToolWindowId.VCS);
      toolWindow.activate(null);
    }
  }
);
}
