{
  if (files.size() == 1 && singleFilePromptTemplate != null) {
    final String filePrompt=MessageFormat.format(singleFilePromptTemplate,files.get(0).getPresentableUrl());
    if (ConfirmationDialog.requestForConfirmation(confirmationOption,myProject,filePrompt,singleFileTitle,Messages.getQuestionIcon(),okActionName,cancelActionName)) {
      return files;
    }
    return null;
  }
  final SelectFilePathsDialog dlg=new SelectFilePathsDialog(myProject,files,prompt,confirmationOption,okActionName,cancelActionName,true);
  dlg.setTitle(title);
  if (!confirmationOption.isPersistent()) {
    dlg.setDoNotAskOption(null);
  }
  dlg.show();
  return dlg.isOK() ? dlg.getSelectedFiles() : null;
}
