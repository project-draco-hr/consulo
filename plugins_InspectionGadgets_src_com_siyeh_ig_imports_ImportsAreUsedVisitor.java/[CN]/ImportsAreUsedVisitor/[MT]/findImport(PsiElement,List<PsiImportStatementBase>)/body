{
  final String qualifiedName;
  final String packageName;
  if (element instanceof PsiClass) {
    final PsiClass referencedClass=(PsiClass)element;
    qualifiedName=referencedClass.getQualifiedName();
    packageName=qualifiedName != null ? StringUtil.getPackageName(qualifiedName) : null;
  }
 else {
    qualifiedName=null;
    packageName=null;
  }
  final PsiClass referenceClass;
  final String referenceName;
  if (element instanceof PsiMember) {
    final PsiMember member=(PsiMember)element;
    if (member instanceof PsiClass && !member.hasModifierProperty(PsiModifier.STATIC)) {
      referenceClass=null;
      referenceName=null;
    }
 else {
      referenceClass=member.getContainingClass();
      referenceName=member.getName();
    }
  }
 else {
    referenceClass=null;
    referenceName=null;
  }
  for (  PsiImportStatementBase importStatementBase : importStatements) {
    if (importStatementBase instanceof PsiImportStatement && qualifiedName != null && packageName != null) {
      final PsiImportStatement importStatement=(PsiImportStatement)importStatementBase;
      final String importName=importStatement.getQualifiedName();
      if (importName != null) {
        if (importStatement.isOnDemand()) {
          if (importName.equals(packageName)) {
            return importStatement;
          }
        }
 else         if (importName.equals(qualifiedName)) {
          return importStatement;
        }
      }
    }
    if (importStatementBase instanceof PsiImportStaticStatement && referenceClass != null && referenceName != null) {
      final PsiImportStaticStatement importStaticStatement=(PsiImportStaticStatement)importStatementBase;
      if (importStaticStatement.isOnDemand()) {
        final PsiClass targetClass=importStaticStatement.resolveTargetClass();
        if (InheritanceUtil.isInheritorOrSelf(targetClass,referenceClass,true)) {
          return importStaticStatement;
        }
      }
 else {
        final String importReferenceName=importStaticStatement.getReferenceName();
        if (importReferenceName != null) {
          if (importReferenceName.equals(referenceName)) {
            return importStaticStatement;
          }
        }
      }
    }
  }
  return null;
}
