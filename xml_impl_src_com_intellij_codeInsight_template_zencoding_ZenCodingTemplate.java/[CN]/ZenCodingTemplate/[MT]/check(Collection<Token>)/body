{
  State state=State.WORD;
  for (  Token token : tokens) {
    if (token instanceof MarkerToken) {
      break;
    }
switch (state) {
case OPERATION:
      if (token instanceof OperationToken) {
        state=((OperationToken)token).getSign() == '*' ? State.NUMBER : State.WORD;
      }
 else {
        return false;
      }
    break;
case WORD:
  if (token instanceof TemplateToken) {
    state=State.OPERATION;
  }
 else {
    return false;
  }
break;
case NUMBER:
if (token instanceof NumberToken) {
state=State.AFTER_NUMBER;
}
 else {
return false;
}
break;
case AFTER_NUMBER:
if (token instanceof OperationToken && ((OperationToken)token).getSign() != '*') {
state=State.WORD;
}
 else {
return false;
}
break;
}
}
return state == State.OPERATION || state == State.AFTER_NUMBER;
}
