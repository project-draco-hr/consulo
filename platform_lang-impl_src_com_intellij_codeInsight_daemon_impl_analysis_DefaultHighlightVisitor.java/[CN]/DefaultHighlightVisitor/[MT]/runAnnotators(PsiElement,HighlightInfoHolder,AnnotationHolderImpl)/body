{
  List<Annotator> annotators=cachedAnnotators.get(element.getLanguage());
  if (annotators.isEmpty())   return;
  final boolean dumb=myDumbService.isDumb();
  annotationHolder.setSession(holder.getAnnotationSession());
  if (!JobUtil.invokeConcurrentlyUnderMyProgress(annotators,new Processor<Annotator>(){
    public boolean process(    Annotator annotator){
      if (dumb && !DumbService.isDumbAware(annotator)) {
        return true;
      }
      annotator.annotate(element,annotationHolder);
      return true;
    }
  }
,true))   throw new ProcessCanceledException();
synchronized (annotationHolder) {
    if (annotationHolder.hasAnnotations()) {
      for (      Annotation annotation : annotationHolder) {
        holder.add(HighlightInfo.fromAnnotation(annotation));
      }
      annotationHolder.clear();
    }
    annotationHolder.setSession(null);
  }
}
