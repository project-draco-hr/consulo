{
  final String line=callback.getNextLine();
  if (line == null) {
    return false;
  }
  if (StringUtil.startsWithChar(line,'[') && StringUtil.endsWithChar(line,']')) {
    processLoading(line,callback);
    return true;
  }
 else {
    if (LOG.isDebugEnabled()) {
      LOG.debug("Failed to match: #" + line + "#");
    }
  }
  int colonIndex1=line.indexOf(':');
  if (colonIndex1 == 1) {
    colonIndex1=line.indexOf(':',colonIndex1 + 1);
  }
  if (colonIndex1 == -1) {
    if (line.endsWith("errors") || line.endsWith("error")) {
      return true;
    }
    if (line.endsWith("warnings") || line.endsWith("warning")) {
      return true;
    }
  }
  if (colonIndex1 >= 0) {
    String part1=line.substring(0,colonIndex1).trim();
    if (part1.equals("error")) {
      addMessage(callback,CompilerMessageCategory.ERROR,line.substring(colonIndex1));
      return true;
    }
    if (part1.equals("javac")) {
      addMessage(callback,CompilerMessageCategory.ERROR,line);
      return true;
    }
    int colonIndex2=line.indexOf(':',colonIndex1 + 1);
    if (colonIndex2 >= 0) {
      final String filePath=part1.replace(File.separatorChar,'/');
      final VirtualFile[] file=new VirtualFile[1];
      ApplicationManager.getApplication().runReadAction(new Runnable(){
        public void run(){
          file[0]=LocalFileSystem.getInstance().findFileByPath(filePath);
        }
      }
);
      try {
        int lineNum=Integer.parseInt(line.substring(colonIndex1 + 1,colonIndex2).trim());
        String message=line.substring(colonIndex2 + 1).trim();
        CompilerMessageCategory category=CompilerMessageCategory.ERROR;
        if (message.startsWith("warning:")) {
          message=message.substring("warning:".length()).trim();
          category=CompilerMessageCategory.WARNING;
        }
        ArrayList messages=new ArrayList();
        messages.add(message);
        int colNum=0;
        String prevLine=null;
        do {
          final String nextLine=callback.getNextLine();
          if (nextLine == null) {
            return false;
          }
          if (nextLine.trim().equals("^")) {
            final int fakeColNum=nextLine.indexOf('^') + 1;
            final CharSequence chars=(prevLine != null) ? prevLine : line;
            final int offsetColNum=EditorUtil.calcOffset(null,chars,0,chars.length(),fakeColNum,8);
            colNum=EditorUtil.calcColumnNumber(null,chars,0,offsetColNum,myTabSize);
            break;
          }
          if (prevLine != null) {
            messages.add(prevLine);
          }
          prevLine=nextLine;
        }
 while (true);
        if (colNum > 0) {
          messages=convertMessages(messages);
          StringBuffer buf=new StringBuffer();
          for (Iterator it=messages.iterator(); it.hasNext(); ) {
            String m=(String)it.next();
            if (buf.length() > 0) {
              buf.append("\n");
            }
            buf.append(m);
          }
          addMessage(callback,category,buf.toString(),VirtualFileManager.constructUrl(LocalFileSystem.PROTOCOL,filePath),lineNum,colNum);
          return true;
        }
      }
 catch (      NumberFormatException e) {
      }
    }
  }
  if (line.endsWith("java.lang.OutOfMemoryError")) {
    addMessage(callback,CompilerMessageCategory.ERROR,"Out of memory. Increase the maximum heap size in Project Properties|Compiler settings.");
    return true;
  }
  addMessage(callback,CompilerMessageCategory.INFORMATION,line);
  return true;
}
