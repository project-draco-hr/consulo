{
  List<GenerationItem> generatedItems=new ArrayList<GenerationItem>();
  Map<String,GenerationItem> pathsToItemsMap=new HashMap<String,GenerationItem>();
  for (  GenerationItem item : itemsToGenerate) {
    pathsToItemsMap.put(item.getPath(),item);
  }
  Set<VirtualFile> vFiles=new HashSet<VirtualFile>();
  for (  GenerationItem item : itemsToGenerate) {
    vFiles.add(item.getVFile());
  }
  for (  VirtualFile vFile : vFiles) {
    List<String> generatedJavaFilesRelPaths=generateItems(vFile,outputRootDirectory);
    for (    String relPath : generatedJavaFilesRelPaths) {
      GenerationItem generationItem=pathsToItemsMap.get(relPath);
      if (generationItem != null)       generatedItems.add(generationItem);
    }
  }
  return generatedItems.toArray(new GenerationItem[generatedItems.size()]);
}
