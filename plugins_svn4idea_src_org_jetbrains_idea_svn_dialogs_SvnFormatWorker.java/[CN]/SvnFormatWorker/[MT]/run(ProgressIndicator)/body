{
  ProjectLevelVcsManager.getInstanceChecked(myProject).startBackgroundVcsOperation();
  indicator.setIndeterminate(true);
  final boolean supportsChangelists=myNewFormat.supportsChangelists();
  if (supportsChangelists) {
    myBeforeChangeLists=ChangeListManager.getInstance(myProject).getChangeListsCopy();
  }
  final SVNWCClient wcClient=myVcs.createWCClient();
  try {
    for (    WCInfo wcInfo : myWcInfos) {
      File path=new File(wcInfo.getPath());
      if (!wcInfo.isIsWcRoot()) {
        path=SvnUtil.getWorkingCopyRoot(path);
      }
      indicator.setText(SvnBundle.message("action.change.wcopy.format.task.progress.text",path.getAbsolutePath(),SvnUtil.formatRepresentation(wcInfo.getFormat()),SvnUtil.formatRepresentation(myNewFormat)));
      try {
        wcClient.doSetWCFormat(path,myNewFormat.getFormat());
      }
 catch (      Throwable e) {
        myExceptions.add(e);
      }
    }
  }
  finally {
    ProjectLevelVcsManager.getInstance(myProject).stopBackgroundVcsOperation();
    if (supportsChangelists) {
      SvnVcs.getInstance(myProject).processChangeLists(myBeforeChangeLists);
    }
    ApplicationManager.getApplication().getMessageBus().syncPublisher(SvnVcs.WC_CONVERTED).run();
  }
}
