{
  Element oldRoot=oldDoc.getRootElement();
  Element newRoot=newDoc.getRootElement();
  ourFileToProblem=new HashMap();
  List newProblems=newRoot.getChildren("problem");
  for (Iterator iterator=newProblems.iterator(); iterator.hasNext(); ) {
    Element newProblem=(Element)iterator.next();
    addProblem(newProblem);
  }
  List oldProblems=oldRoot.getChildren("problem");
  for (Iterator iterator=oldProblems.iterator(); iterator.hasNext(); ) {
    Element oldProblem=(Element)iterator.next();
    removeIfEquals(oldProblem);
  }
  Element root=new Element("problems");
  Document delta=new Document(root);
  for (Iterator iterator=ourFileToProblem.values().iterator(); iterator.hasNext(); ) {
    ArrayList fileList=(ArrayList)iterator.next();
    if (fileList != null) {
      for (int i=0; i < fileList.size(); i++) {
        Element element=(Element)fileList.get(i);
        root.addContent((Element)element.clone());
      }
    }
  }
  return delta;
}
