{
  final List<LibraryKind<?>> result=new SmartList<LibraryKind<?>>();
  final LibraryType<?> type=((LibraryEx)library).getType();
  if (type != null) {
    result.add(type.getKind());
  }
  final VirtualFile[] files=getLibraryFiles(library,context);
  LibraryDetectionManager.getInstance().processProperties(Arrays.asList(files),new LibraryDetectionManager.LibraryPropertiesProcessor(){
    @Override public <P extends LibraryProperties>boolean processProperties(    @NotNull LibraryKind<P> kind,    @NotNull P properties){
      result.add(kind);
      return true;
    }
  }
);
  return result;
}
