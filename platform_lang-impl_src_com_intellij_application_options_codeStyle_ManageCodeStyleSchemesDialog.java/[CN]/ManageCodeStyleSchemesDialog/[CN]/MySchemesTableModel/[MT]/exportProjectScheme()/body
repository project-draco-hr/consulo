{
  String name=Messages.showInputDialog("Enter new scheme name:","Copy Project Scheme to Global List",Messages.getQuestionIcon());
  if (name != null && !CodeStyleSchemesModel.PROJECT_SCHEME_NAME.equals(name)) {
    CodeStyleScheme newScheme=mySchemesModel.exportProjectScheme(name);
    updateSchemes();
    int switchToGlobal=Messages.showYesNoDialog("Project scheme was copied to global scheme list as '" + newScheme.getName() + "'.\n"+ "Switch to this created scheme?","Copy Project Scheme to Global List",Messages.getQuestionIcon());
    if (switchToGlobal == 0) {
      mySchemesModel.setUsePerProjectSettings(false);
      mySchemesModel.selectScheme(newScheme,null);
    }
    int row=0;
    for (    CodeStyleScheme scheme : mySchemes) {
      if (scheme == newScheme) {
        fireTableRowsInserted(row,row);
        return switchToGlobal == 0 ? row : -1;
      }
      row++;
    }
  }
  return -1;
}
