{
  Set<LinearBekGraphBuilder.MergeFragment> result=ContainerUtil.newHashSet();
  int mergesCount=0;
  LinkedHashSet<Integer> toProcess=ContainerUtil.newLinkedHashSet();
  toProcess.add(node.getNodeIndex());
  while (!toProcess.isEmpty()) {
    Integer i=ContainerUtil.getFirstItem(toProcess);
    toProcess.remove(i);
    LinearBekGraphBuilder.MergeFragment fragment=myLinearBekGraphBuilder.getFragment(i);
    if (fragment == null)     continue;
    result.add(fragment);
    toProcess.addAll(fragment.getTailsAndBody());
    mergesCount++;
    if (mergesCount > 10)     break;
  }
  return result;
}
