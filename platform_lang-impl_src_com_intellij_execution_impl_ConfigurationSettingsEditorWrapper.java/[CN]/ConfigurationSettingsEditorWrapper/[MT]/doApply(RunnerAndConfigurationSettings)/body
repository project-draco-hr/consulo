{
  final RunConfiguration runConfiguration=settings.getConfiguration();
  final RunManagerImpl runManager=RunManagerImpl.getInstanceImpl(runConfiguration.getProject());
  runManager.setBeforeRunTasks(runConfiguration,myBeforeRunStepsPanel.getTasks(true),false);
  runManager.shareConfiguration(runConfiguration,myStoreProjectConfiguration);
  RunnerAndConfigurationSettings runManagerSettings=runManager.getSettings(runConfiguration);
  if (runManagerSettings != null) {
    runManagerSettings.setEditBeforeRun(myBeforeRunStepsPanel.needEditBeforeRun());
    runManagerSettings.setSingleton(myBeforeRunStepsPanel.isSingleton());
  }
 else {
    settings.setEditBeforeRun(myBeforeRunStepsPanel.needEditBeforeRun());
    settings.setSingleton(myBeforeRunStepsPanel.isSingleton());
  }
}
