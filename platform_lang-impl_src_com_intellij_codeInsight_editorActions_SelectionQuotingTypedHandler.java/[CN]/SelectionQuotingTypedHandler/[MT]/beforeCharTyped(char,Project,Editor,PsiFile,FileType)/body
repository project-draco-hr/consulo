{
  if (myReplacedTextRange != null) {
    if (myReplacedTextRange.getEndOffset() <= editor.getDocument().getTextLength()) {
      editor.getSelectionModel().setSelection(myReplacedTextRange.getStartOffset(),myReplacedTextRange.getEndOffset());
      if (Registry.is("editor.smarterSelectionQuoting")) {
        editor.getCaretModel().moveToOffset(myCaretPosition + 1);
      }
    }
    myReplacedTextRange=null;
    return Result.STOP;
  }
  return Result.CONTINUE;
}
