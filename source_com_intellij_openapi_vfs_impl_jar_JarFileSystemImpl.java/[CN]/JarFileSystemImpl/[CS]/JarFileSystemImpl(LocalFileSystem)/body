{
  localFileSystem.addVirtualFileListener(new VirtualFileAdapter(){
    public void contentsChanged(    VirtualFileEvent event){
      JarFileInfo info=myPathToFileInfoMap.get(event.getFile().getPath());
      if (info != null) {
        refreshInfo(info,true);
      }
    }
    public void fileDeleted(    VirtualFileEvent event){
      VirtualFile parent=event.getParent();
      if (parent != null) {
        String oldPath=parent.getPath() + '/' + event.getFileName();
        JarFileInfo info=myPathToFileInfoMap.get(oldPath);
        if (info != null) {
          refreshInfo(info,true);
        }
      }
    }
    public void fileMoved(    VirtualFileMoveEvent event){
      String oldPath=event.getOldParent().getPath() + '/' + event.getFileName();
      JarFileInfo info=myPathToFileInfoMap.get(oldPath);
      if (info != null) {
        refreshInfo(info,true);
      }
    }
    public void propertyChanged(    VirtualFilePropertyEvent event){
      if (VirtualFile.PROP_NAME.equals(event.getPropertyName())) {
        VirtualFile parent=event.getParent();
        String oldPath=(parent == null ? "" : parent.getPath() + '/') + event.getOldValue();
        JarFileInfo info=myPathToFileInfoMap.get(oldPath);
        if (info != null) {
          refreshInfo(info,true);
        }
      }
    }
  }
);
}
