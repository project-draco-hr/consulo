{
  ModalityState modalityState=VirtualFileManagerImpl.calcModalityStateForRefreshEventsPosting(asynchronous);
  getManager().beforeRefreshStart(asynchronous,modalityState,null);
  if (!info.getFile().exists()) {
    LOG.info("file deleted");
    final VirtualFile rootFile=info.getRootFile();
    getManager().addEventToFireByRefresh(new Runnable(){
      public void run(){
        fireBeforeFileDeletion(null,rootFile);
synchronized (LOCK) {
          myPathToFileInfoMap.remove(info.getFile().getPath());
        }
        info.close();
        fireFileDeleted(null,rootFile,rootFile.getName(),null);
      }
    }
,asynchronous,modalityState);
  }
 else   if (info.getTimeStamp() != info.getFile().lastModified()) {
    LOG.info("timestamp changed");
    try {
      info.setTimeStamp(info.getFile().lastModified());
      refreshFilesInJar(info,asynchronous,modalityState);
    }
 catch (    IOException e) {
      LOG.info("Could not read jar");
      forceRefreshInfo(info,asynchronous,modalityState);
    }
  }
 else   if (forceRefresh) {
    forceRefreshInfo(info,asynchronous,modalityState);
  }
  getManager().afterRefreshFinish(asynchronous,modalityState);
}
