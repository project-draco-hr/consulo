{
  PsiType[] parameterTypes=new PsiType[parameters.length];
  boolean[] optionals=new boolean[parameters.length];
  for (int i=0; i < optionals.length; i++) {
    PsiParameter parameter=parameters[i];
    if (parameter instanceof GrParameter) {
      optionals[i]=((GrParameter)parameter).isOptional();
    }
 else     if (i == 0) {
      final Collection<PsiReference> all=ReferencesSearch.search(parameter).findAll();
      optionals[i]=all.size() == 0;
    }
 else {
      optionals[i]=false;
    }
    parameterTypes[i]=parameter.getType();
  }
  return create(returnType,parameterTypes,optionals,manager,scope);
}
