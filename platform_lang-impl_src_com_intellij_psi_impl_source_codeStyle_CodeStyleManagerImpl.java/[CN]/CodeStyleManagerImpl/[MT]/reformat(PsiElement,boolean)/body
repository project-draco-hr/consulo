{
  CheckUtil.checkWritable(element);
  if (!SourceTreeToPsiMap.hasTreeElement(element)) {
    return element;
  }
  ASTNode treeElement=SourceTreeToPsiMap.psiElementToTree(element);
  PsiFileImpl file=(PsiFileImpl)element.getContainingFile();
  FileType fileType=StdFileTypes.JAVA;
  if (file != null) {
    fileType=file.getFileType();
  }
  final PsiElement formatted=SourceTreeToPsiMap.treeElementToPsi(new CodeFormatterFacade(getSettings(),fileType).process(treeElement));
  if (!canChangeWhiteSpacesOnly) {
    return postProcessElement(formatted);
  }
 else {
    return formatted;
  }
}
