{
  CharSequence text=document.getCharsSequence();
  if (offset < 0 || offset >= text.length() || !isWhiteSpaceSymbol(text.charAt(offset))) {
    return null;
  }
  for (int i=offset - 1; i >= 0; i--) {
    char c=text.charAt(i);
    if (c == '\n') {
      break;
    }
    if (!isWhiteSpaceSymbol(c)) {
      return null;
    }
  }
  int end=offset;
  for (; end < text.length(); end++) {
    if (!isWhiteSpaceSymbol(text.charAt(end))) {
      break;
    }
  }
  setSequentialProcessingAllowed(false);
  String dummy=createDummy(file);
  document.insertString(offset,dummy);
  return new TextRange(offset,offset + dummy.length());
}
