{
  CharSequence text=document.getImmutableCharSequence();
  if (offset <= 0 || offset >= text.length() || !isWhiteSpaceSymbol(text.charAt(offset))) {
    return null;
  }
  if (!isWhiteSpaceSymbol(text.charAt(offset - 1))) {
    return null;
  }
  int end=offset;
  for (; end < text.length(); end++) {
    if (text.charAt(end) == '\n') {
      break;
    }
    if (!isWhiteSpaceSymbol(text.charAt(end))) {
      return null;
    }
  }
  setSequentialProcessingAllowed(false);
  String dummy=createDummy(file);
  document.insertString(offset,dummy);
  return new TextRange(offset,offset + dummy.length());
}
