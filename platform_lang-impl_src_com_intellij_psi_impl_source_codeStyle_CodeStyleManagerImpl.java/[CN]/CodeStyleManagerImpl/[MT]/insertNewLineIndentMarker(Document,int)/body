{
  CharSequence text=document.getCharsSequence();
  if (offset < 0 || offset >= text.length() || !isWhiteSpaceSymbol(text.charAt(offset))) {
    return null;
  }
  int start=offset;
  for (int i=offset - 1; i >= 0; i--) {
    char c=text.charAt(i);
    if (c == '\n') {
      break;
    }
    if (!isWhiteSpaceSymbol(c)) {
      return null;
    }
    start=i;
  }
  int end=offset;
  for (; end < text.length(); end++) {
    if (!isWhiteSpaceSymbol(text.charAt(end))) {
      break;
    }
  }
  StringBuilder buffer=new StringBuilder();
  buffer.append(text.subSequence(start,end));
  document.deleteString(start,end);
  document.insertString(start,buffer);
  setSequentialProcessingAllowed(false);
  document.insertString(offset,DUMMY_IDENTIFIER);
  return new TextRange(offset,offset + DUMMY_IDENTIFIER.length());
}
