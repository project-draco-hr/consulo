{
  myUndefinedMacroNames=undefinedMacroNames;
  setModel(myTableModel);
  TableColumn column=getColumnModel().getColumn(NAME_COLUMN);
  column.setCellRenderer(new DefaultTableCellRenderer(){
    public Component getTableCellRendererComponent(    JTable table,    Object value,    boolean isSelected,    boolean hasFocus,    int row,    int column){
      final Component component=super.getTableCellRendererComponent(table,value,isSelected,hasFocus,row,column);
      final String macroValue=getMacroValueAt(row);
      component.setForeground(macroValue.length() == 0 ? Color.RED : isSelected ? table.getSelectionForeground() : table.getForeground());
      return component;
    }
  }
);
  setSelectionMode(ListSelectionModel.MULTIPLE_INTERVAL_SELECTION);
  getEmptyText().setText(ApplicationBundle.message("text.no.path.variables"));
}
