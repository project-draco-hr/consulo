{
  final String title=ApplicationBundle.message("title.add.variable");
  final PathMacroEditor macroEditor=new PathMacroEditor(title,"","","",new AddValidator(title),myEditOnlyPaths);
  macroEditor.show();
  if (macroEditor.isOK()) {
    final String name=macroEditor.getName();
    myMacros.add(new Pair<String,Pair<String,String>>(name,new Pair<String,String>(macroEditor.getValue(),macroEditor.getDescription())));
    Collections.sort(myMacros,MACRO_COMPARATOR);
    final int index=indexOfMacroWithName(name);
    LOG.assertTrue(index >= 0);
    myTableModel.fireTableDataChanged();
    setRowSelectionInterval(index,index);
  }
}
