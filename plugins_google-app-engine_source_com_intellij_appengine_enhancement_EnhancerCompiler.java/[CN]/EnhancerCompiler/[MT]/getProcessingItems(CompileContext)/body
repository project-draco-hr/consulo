{
  List<ProcessingItem> items=new ArrayList<ProcessingItem>();
  for (  Module module : ModuleManager.getInstance(myProject).getModules()) {
    for (    AppEngineFacet facet : FacetManager.getInstance(module).getFacetsByType(AppEngineFacet.ID)) {
      if (facet.getConfiguration().isRunEnhancerOnMake()) {
        final VirtualFile outputRoot=CompilerModuleExtension.getInstance(module).getCompilerOutputPath();
        if (outputRoot != null) {
          try {
            final ClassFilesCollector classFilesCollector=new ClassFilesCollector((CompileContextEx)context,items,facet,outputRoot);
            classFilesCollector.collectItems(outputRoot,"");
          }
 catch (          CacheCorruptedException e) {
            context.addMessage(CompilerMessageCategory.ERROR,e.getMessage(),null,-1,-1);
            LOG.info(e);
            break;
          }
        }
      }
    }
  }
  return items.toArray(new ProcessingItem[items.size()]);
}
