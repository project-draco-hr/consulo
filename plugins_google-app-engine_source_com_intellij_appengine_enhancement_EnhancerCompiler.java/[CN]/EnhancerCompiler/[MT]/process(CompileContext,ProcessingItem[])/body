{
  context.getProgressIndicator().setText("Enhancing classes...");
  MultiValuesMap<AppEngineFacet,ClassFileItem> itemsByFacet=new MultiValuesMap<AppEngineFacet,ClassFileItem>();
  for (  ProcessingItem item : items) {
    final ClassFileItem classFileItem=(ClassFileItem)item;
    itemsByFacet.put(classFileItem.getFacet(),classFileItem);
  }
  List<ProcessingItem> processed=new ArrayList<ProcessingItem>();
  for (  AppEngineFacet facet : itemsByFacet.keySet()) {
    final Collection<ClassFileItem> classFileItems=itemsByFacet.get(facet);
    if (!runEnhancer(facet,classFileItems,context)) {
      break;
    }
    processed.addAll(classFileItems);
  }
  context.getProgressIndicator().setText("");
  context.getProgressIndicator().setText2("");
  return processed.toArray(new ProcessingItem[processed.size()]);
}
