{
  final PsiElement[] children=element.getChildren();
  if (children.length != 0) {
    for (    PsiElement child : children) {
      buildNewCommentText(child,elementToReplace,newCommentText);
    }
    return;
  }
  @NonNls final String text=element.getText();
  if (element != elementToReplace) {
    newCommentText.append(text);
  }
 else {
    newCommentText.append(text.substring(0,startIndex));
    newCommentText.append("{@code ");
    final int endIndex=text.indexOf("</code>",startIndex);
    if (endIndex >= 0) {
      final String codeText=text.substring(startIndex + 6,endIndex);
      newCommentText.append(codeText);
      newCommentText.append('}');
      newCommentText.append(text.substring(endIndex + 7));
    }
 else {
      final String codeText=text.substring(startIndex + 6);
      newCommentText.append(codeText);
      newCommentText.append('}');
    }
  }
}
