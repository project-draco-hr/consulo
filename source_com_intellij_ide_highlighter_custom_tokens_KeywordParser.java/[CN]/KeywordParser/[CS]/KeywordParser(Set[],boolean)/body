{
  LOG.assertTrue(keywordSets.length == myKeywordSets.length);
  myIgnoreCase=ignoreCase;
  int maxLength=0;
  for (int i=0; i < keywordSets.length; i++) {
    Set keywordSet=keywordSets[i];
    myKeywordSets[i]=getKeywordSet(keywordSet);
    for (Iterator iterator=keywordSet.iterator(); iterator.hasNext(); ) {
      String s=(String)iterator.next();
      maxLength=Math.max(maxLength,s.length());
      final char firstChar=s.charAt(0);
      if (ignoreCase) {
        myFirstCharacters.set(Character.toUpperCase(firstChar),Character.toUpperCase(firstChar) + 1);
        myFirstCharacters.set(Character.toLowerCase(firstChar),Character.toLowerCase(firstChar) + 1);
      }
 else {
        myFirstCharacters.set(firstChar,firstChar + 1);
      }
      for (int j=0; j < s.length(); j++) {
        final char currentChar=s.charAt(j);
        if (ignoreCase) {
          myCharacters.set(Character.toUpperCase(currentChar),Character.toUpperCase(currentChar) + 1);
          myCharacters.set(Character.toLowerCase(currentChar),Character.toLowerCase(currentChar) + 1);
        }
 else {
          myCharacters.set(currentChar,currentChar + 1);
        }
      }
    }
  }
  mySmartUpdateShift=maxLength;
}
