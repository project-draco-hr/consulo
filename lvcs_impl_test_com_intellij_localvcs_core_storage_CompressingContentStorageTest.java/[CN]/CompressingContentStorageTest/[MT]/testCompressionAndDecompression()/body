{
  final byte[][] compressed=new byte[1][];
  IContentStorage subject=createStoredBytesRecordingMock(compressed);
  byte[] original=b("public void foo() {} public void foo() {}");
  CompressingContentStorage s=new CompressingContentStorage(subject);
  assertEquals(1,s.store(original));
  assertTrue(compressed[0].length < original.length);
  reset(subject);
  expect(subject.load(2)).andReturn(compressed[0]);
  replay(subject);
  assertEquals(original,s.load(2));
}
