{
  super(project,document,PRESENTABLE_NAME,file,editor,TextRange.create(startOffset,endOffset),true,highlightInfoProcessor);
  myStartOffset=startOffset;
  myEndOffset=endOffset;
  myUpdateAll=updateAll;
  myPriorityRange=priorityRange;
  myEditor=editor;
  LOG.assertTrue(file.isValid());
  boolean wholeFileHighlighting=isWholeFileHighlighting();
  myHasErrorElement=!wholeFileHighlighting && Boolean.TRUE.equals(myFile.getUserData(HAS_ERROR_ELEMENT));
  final DaemonCodeAnalyzerEx daemonCodeAnalyzer=DaemonCodeAnalyzerEx.getInstanceEx(myProject);
  FileStatusMap fileStatusMap=daemonCodeAnalyzer.getFileStatusMap();
  myErrorFound=!wholeFileHighlighting && fileStatusMap.wasErrorFound(myDocument);
  setProgressLimit(document.getTextLength() / 2);
  myGlobalScheme=EditorColorsManager.getInstance().getGlobalScheme();
}
