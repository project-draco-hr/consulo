{
  int startOffset=myCurrentInlayIndex < 0 ? mySegmentStartOffset : myInlays.get(myCurrentInlayIndex).getOffset();
  int nextIndex=getNextInlayIndex();
  int endOffset=nextIndex < myInlays.size() ? myInlays.get(nextIndex).getOffset() : mySegmentEndOffset;
  int lineStartOffset=myDocument.getLineStartOffset(myCurrentEndLogicalLine);
  myFragmentIterator=myView.getTextLayoutCache().getLineLayout(myCurrentEndLogicalLine).getFragmentsInVisualOrder(myView,myCurrentEndLogicalLine,myCurrentX,myCurrentVisualColumn,startOffset - lineStartOffset,endOffset - lineStartOffset,myQuickEvaluationListener);
}
