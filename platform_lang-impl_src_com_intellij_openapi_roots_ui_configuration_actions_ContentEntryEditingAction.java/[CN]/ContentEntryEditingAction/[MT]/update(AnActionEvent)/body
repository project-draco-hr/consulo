{
  super.update(e);
  final Presentation presentation=e.getPresentation();
  presentation.setEnabled(true);
  final VirtualFile[] files=doGetSelectedFiles();
  if (files == null || files.length == 0) {
    presentation.setEnabled(false);
    return;
  }
  for (  VirtualFile file : files) {
    if (file == null || !file.isDirectory()) {
      presentation.setEnabled(false);
      break;
    }
  }
}
