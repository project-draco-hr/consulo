{
  if (psiElement instanceof PsiReturnStatement) {
    PsiMethod method=PsiTreeUtil.getParentOfType(psiElement,PsiMethod.class);
    if (method != null && PsiType.VOID == method.getReturnType()) {
      PsiReturnStatement stmt=(PsiReturnStatement)psiElement;
      if (stmt.getReturnValue() != null) {
        Document doc=editor.getDocument();
        doc.insertString(stmt.getTextRange().getStartOffset() + "return".length(),";");
        return;
      }
    }
  }
  if (psiElement instanceof PsiExpressionStatement || psiElement instanceof PsiDeclarationStatement || psiElement instanceof PsiDoWhileStatement|| psiElement instanceof PsiReturnStatement|| psiElement instanceof PsiThrowStatement|| psiElement instanceof PsiBreakStatement|| psiElement instanceof PsiContinueStatement|| psiElement instanceof PsiAssertStatement|| psiElement instanceof PsiField && !(psiElement instanceof PsiEnumConstant) || psiElement instanceof PsiMethod && (((PsiMethod)psiElement).getContainingClass().isInterface() || ((PsiMethod)psiElement).hasModifierProperty(PsiModifier.ABSTRACT))) {
    String text=psiElement.getText();
    int insertionOffset=psiElement.getTextRange().getEndOffset();
    Document doc=editor.getDocument();
    if (psiElement instanceof PsiField && ((PsiField)psiElement).hasModifierProperty(PsiModifier.ABSTRACT)) {
      doc.insertString(insertionOffset,"()");
      insertionOffset+="()".length();
    }
    if (!StringUtil.endsWithChar(text,';')) {
      final PsiElement parent=psiElement.getParent();
      if (parent instanceof PsiForStatement && ((PsiForStatement)parent).getUpdate() == psiElement) {
        return;
      }
      doc.insertString(insertionOffset,";");
    }
  }
}
