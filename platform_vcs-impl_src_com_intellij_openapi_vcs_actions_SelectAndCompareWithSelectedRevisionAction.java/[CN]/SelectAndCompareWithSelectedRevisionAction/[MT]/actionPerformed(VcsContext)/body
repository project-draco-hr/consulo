{
  final VirtualFile file=vcsContext.getSelectedFiles()[0];
  final Project project=vcsContext.getProject();
  final AbstractVcs vcs=ProjectLevelVcsManager.getInstance(project).getVcsFor(file);
  if (vcs == null) {
    return;
  }
  RevisionSelector selector=vcs.getRevisionSelector();
  final DiffProvider diffProvider=vcs.getDiffProvider();
  if (selector != null) {
    final FileDocumentManager fileDocumentManager=FileDocumentManager.getInstance();
    fileDocumentManager.saveDocument(fileDocumentManager.getDocument(file));
    final VcsRevisionNumber vcsRevisionNumber=selector.selectNumber(file);
    if (vcsRevisionNumber != null) {
      DiffActionExecutor.showDiff(diffProvider,vcsRevisionNumber,file,project,VcsBackgroundableActions.COMPARE_WITH);
    }
  }
}
