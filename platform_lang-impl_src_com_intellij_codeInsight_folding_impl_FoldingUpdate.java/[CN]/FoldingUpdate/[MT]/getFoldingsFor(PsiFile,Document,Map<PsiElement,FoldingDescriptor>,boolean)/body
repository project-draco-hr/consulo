{
  final FileViewProvider viewProvider=file.getViewProvider();
  for (  final Language language : viewProvider.getLanguages()) {
    final PsiFile psi=viewProvider.getPsi(language);
    final FoldingBuilder foldingBuilder=LanguageFolding.INSTANCE.forLanguage(language);
    if (psi != null && foldingBuilder != null) {
      for (      FoldingDescriptor descriptor : LanguageFolding.buildFoldingDescriptors(foldingBuilder,psi,document,quick)) {
        elementsToFoldMap.put(descriptor.getElement().getPsi(),descriptor);
      }
    }
  }
}
