def _string_escape(text):
    '\n    >>> d = {\'nl\': chr(10), \'bs\': chr(92), \'cr\': chr(13), \'nul\': chr(0)}\n    >>> s = "ab%(nl)scd%(bs)s%(bs)sn%(nul)sab%(cr)scd%(bs)s%(nl)s" % d\n    >>> s\n    \'ab\\ncd\\\\\\\\n\\x00ab\\rcd\\\\\\n\'\n    >>> res = _string_escape(s)\n    >>> s == res.decode(\'string_escape\')\n    True\n    '
    text = text.replace('\\', '\\\\').replace('\n', '\\n').replace('\r', '\\r')
    return text.replace('\x00', '\\0')
