def delayopener(opener, target, divert, buf):

    def o(name, mode='r'):
        if (name != target):
            return opener(name, mode)
        if divert:
            return opener((name + '.a'), mode.replace('a', 'w'))
        return appender(opener(name, mode), buf)
    return o
