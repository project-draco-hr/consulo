{
  if (file == null || !file.isValid()) {
    return null;
  }
  if (file.getFileSystem() instanceof JarFileSystem && file.getParent() != null) {
    return null;
  }
  String path=file.getPath();
  if (path.endsWith(JarFileSystem.JAR_SEPARATOR)) {
    path=path.substring(0,path.length() - JarFileSystem.JAR_SEPARATOR.length());
  }
  return path.replace('/',File.separatorChar);
}
