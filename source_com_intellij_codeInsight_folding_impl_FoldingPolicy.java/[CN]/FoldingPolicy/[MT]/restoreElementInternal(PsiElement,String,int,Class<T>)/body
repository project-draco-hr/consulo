{
  PsiElement[] children=parent.getChildren();
  for (int i=0; i < children.length; i++) {
    PsiElement child=children[i];
    if (hisClass.isAssignableFrom(child.getClass())) {
      T namedChild=(T)child;
      if (name.equals(namedChild.getName())) {
        if (index == 0) {
          return namedChild;
        }
        index--;
      }
    }
  }
  return null;
}
