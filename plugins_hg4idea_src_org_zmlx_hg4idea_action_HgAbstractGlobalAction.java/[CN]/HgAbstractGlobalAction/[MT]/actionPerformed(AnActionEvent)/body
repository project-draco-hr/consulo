{
  final DataContext dataContext=event.getDataContext();
  final Project project=PlatformDataKeys.PROJECT.getData(dataContext);
  if (project == null) {
    return;
  }
  HgGlobalCommand command=getHgGlobalCommandBuilder(project).build(findRepos(project));
  if (command == null) {
    return;
  }
  try {
    command.execute();
  }
 catch (  HgCommandException e) {
    VcsUtil.showErrorMessage(project,e.getMessage(),"Error");
  }
  VcsDirtyScopeManager vcsDirtyScopeManager=VcsDirtyScopeManager.getInstance(project);
  vcsDirtyScopeManager.dirDirtyRecursively(command.getRepo());
  command.getRepo().refresh(true,true);
}
