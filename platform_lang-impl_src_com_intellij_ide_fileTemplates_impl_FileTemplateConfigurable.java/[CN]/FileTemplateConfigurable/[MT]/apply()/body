{
  if (myTemplate != null) {
    myTemplate.setText(myTemplateEditor.getDocument().getText());
    String name=myNameField.getText();
    String extension=myExtensionField.getText();
    int lastDotIndex=extension.lastIndexOf(".");
    if (lastDotIndex >= 0) {
      name+=extension.substring(0,lastDotIndex + 1);
      extension=extension.substring(lastDotIndex + 1);
    }
    if (name.length() == 0 || !isValidFilename(name + "." + extension)) {
      throw new ConfigurationException(IdeBundle.message("error.invalid.template.file.name.or.extension"));
    }
    myTemplate.setName(name);
    myTemplate.setExtension(extension);
    myTemplate.setReformatCode(myAdjustBox.isSelected());
  }
  myModified=false;
}
