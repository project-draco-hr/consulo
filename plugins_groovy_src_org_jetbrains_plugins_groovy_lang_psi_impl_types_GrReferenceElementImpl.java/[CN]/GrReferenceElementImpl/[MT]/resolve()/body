{
  String refName=getReferenceName();
  if (refName == null)   return null;
switch (getKind()) {
case CLASS_OR_PACKAGE_FQ:
{
      PsiClass aClass=getManager().findClass(PsiUtil.getQualifiedReferenceText(this),getResolveScope());
      if (aClass != null)       return aClass;
    }
case PACKAGE_FQ:
  return getManager().findPackage(PsiUtil.getQualifiedReferenceText(this));
case CLASS:
GrReferenceElement qualifier=getQualifier();
if (qualifier != null) {
PsiElement qualifierResolved=qualifier.resolve();
if (qualifierResolved instanceof PsiPackage) {
  PsiClass[] classes=((PsiPackage)qualifierResolved).getClasses();
  for (  final PsiClass aClass : classes) {
    if (refName.equals(aClass.getName()))     return aClass;
  }
}
 else if (qualifierResolved instanceof PsiClass) {
  return ((PsiClass)qualifierResolved).findInnerClassByName(refName,true);
}
}
 else {
ClassResolver processor=new ClassResolver(refName);
ResolveUtil.treeWalkUp(this,processor);
List<PsiNamedElement> candidates=processor.getCandidates();
return candidates.size() == 1 ? candidates.get(0) : null;
}
break;
}
return null;
}
