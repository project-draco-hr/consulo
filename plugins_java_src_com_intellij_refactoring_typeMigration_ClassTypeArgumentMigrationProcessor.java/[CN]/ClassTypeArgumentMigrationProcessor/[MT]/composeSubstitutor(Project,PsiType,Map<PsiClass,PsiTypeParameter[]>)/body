{
  PsiSubstitutor substitutor=PsiSubstitutor.EMPTY;
  final PsiResolveHelper psiResolveHelper=JavaPsiFacade.getInstance(project).getResolveHelper();
  for (  Map.Entry<PsiClass,PsiTypeParameter[]> entry : visibleTypeParams.entrySet()) {
    final PsiClassType clearedOriginalType=JavaPsiFacade.getElementFactory(project).createType(entry.getKey(),PsiSubstitutor.EMPTY);
    for (    PsiTypeParameter parameter : entry.getValue()) {
      substitutor=substitutor.put(parameter,psiResolveHelper.getSubstitutionForTypeParameter(parameter,clearedOriginalType,migrationType,true,clearedOriginalType.getLanguageLevel()));
    }
  }
  return substitutor;
}
