{
  logger.debug("+++ doExecuteAction - START +++");
  if (logger.isDebugEnabled()) {
    logger.debug("Current project " + project.getName());
  }
  final PsiElementClassMember[] dialogMembers=buildMembersToShow(clazz);
  if (dialogMembers.length == 0) {
    HintManager.getInstance().showErrorHint(editor,"No members to include in toString() have been found");
    return;
  }
  final MemberChooserBuilder<PsiElementClassMember> builder=new MemberChooserBuilder<PsiElementClassMember>(project);
  final MemberChooserHeaderPanel header=new MemberChooserHeaderPanel(clazz);
  builder.setHeaderPanel(header);
  builder.overrideAnnotationVisible(PsiUtil.isLanguageLevel5OrHigher(clazz));
  builder.setTitle("Generate toString()");
  logger.debug("Displaying member chooser dialog");
  SwingUtilities.invokeLater(new Runnable(){
    public void run(){
      if (project.isDisposed())       return;
      final MemberChooser dialog=builder.createBuilder(dialogMembers);
      dialog.setCopyJavadocVisible(false);
      dialog.selectElements(dialogMembers);
      header.setChooser(dialog);
      dialog.show();
      if (DialogWrapper.OK_EXIT_CODE == dialog.getExitCode()) {
        Collection<PsiMember> selectedMembers=GenerateToStringUtils.convertClassMembersToPsiMembers(dialog.getSelectedElements());
        final TemplateResource template=header.getSelectedTemplate();
        TemplatesManager.getInstance().setDefaultTemplate(template);
        if (template.isValidTemplate()) {
          GenerateToStringWorker.executeGenerateActionLater(clazz,editor,selectedMembers,template,dialog.isInsertOverrideAnnotation());
        }
 else {
          HintManager.getInstance().showErrorHint(editor,"toString() template '" + template.getFileName() + "' is invalid");
        }
      }
    }
  }
);
  logger.debug("+++ doExecuteAction - END +++");
}
