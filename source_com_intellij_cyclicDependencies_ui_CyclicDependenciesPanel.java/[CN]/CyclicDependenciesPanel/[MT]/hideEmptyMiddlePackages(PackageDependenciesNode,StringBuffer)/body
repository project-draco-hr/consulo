{
  if (node.getChildCount() > 1 || (node.getChildCount() == 1 && node.getChildAt(0) instanceof FileNode)) {
    result.append((result.length() != 0 ? "." : "") + (node.toString().equals(DEFAULT_PACKAGE_ABBREVIATION) ? "" : node.toString()));
  }
 else {
    if (node.getChildCount() == 1) {
      PackageDependenciesNode child=(PackageDependenciesNode)node.getChildAt(0);
      if (!(node instanceof PackageNode)) {
        node.removeAllChildren();
        child=hideEmptyMiddlePackages(child,result);
        node.add(child);
      }
 else {
        if (child instanceof PackageNode) {
          node.removeAllChildren();
          result.append((result.length() != 0 ? "." : "") + (node.toString().equals(DEFAULT_PACKAGE_ABBREVIATION) ? "" : node.toString()));
          node=hideEmptyMiddlePackages(child,result);
          ((PackageNode)node).setPackageName(result.toString());
        }
      }
    }
  }
  return node;
}
