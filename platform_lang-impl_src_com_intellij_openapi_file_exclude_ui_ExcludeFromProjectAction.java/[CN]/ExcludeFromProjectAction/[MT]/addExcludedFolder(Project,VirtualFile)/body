{
  Module module=ModuleUtilCore.findModuleForFile(folder,project);
  if (module == null)   return;
  ModifiableRootModel model=ModuleRootManager.getInstance(module).getModifiableModel();
  for (  ContentEntry entry : model.getContentEntries()) {
    VirtualFile entryFile=entry.getFile();
    if (entryFile != null) {
      if (VfsUtilCore.isAncestor(entryFile,folder,true)) {
        entry.addFolder(folder,ExcludedContentFolderTypeProvider.getInstance());
        model.commit();
        return;
      }
    }
  }
  model.dispose();
}
