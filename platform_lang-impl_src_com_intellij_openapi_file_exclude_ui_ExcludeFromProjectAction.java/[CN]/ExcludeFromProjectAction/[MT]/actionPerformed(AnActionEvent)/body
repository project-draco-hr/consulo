{
  DataContext dataContext=e.getDataContext();
  final Project project=PlatformDataKeys.PROJECT.getData(dataContext);
  if (project == null)   return;
  final VirtualFile file=PlatformDataKeys.VIRTUAL_FILE.getData(dataContext);
  if (file == null)   return;
  if (file.isDirectory()) {
    ApplicationManager.getApplication().runWriteAction(new Runnable(){
      @Override public void run(){
        addExcludedFolder(project,file);
      }
    }
);
  }
 else {
    ProjectFileExclusionManagerImpl fileExManager=ProjectFileExclusionManagerImpl.getInstance(project);
    if (fileExManager == null)     return;
    fileExManager.addExclusion(file);
  }
}
