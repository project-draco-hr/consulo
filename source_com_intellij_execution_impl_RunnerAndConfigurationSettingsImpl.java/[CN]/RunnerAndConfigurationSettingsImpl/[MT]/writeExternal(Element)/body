{
  final ConfigurationFactory factory=myConfiguration.getFactory();
  element.setAttribute(TEMPLATE_FLAG_ATTRIBUTE,String.valueOf(myIsTemplate));
  if (!myIsTemplate) {
    element.setAttribute(NAME_ATTR,myConfiguration.getName());
  }
  element.setAttribute(CONFIGURATION_TYPE_ATTRIBUTE,factory.getType().getComponentName());
  element.setAttribute(FACTORY_NAME_ATTRIBUTE,factory.getName());
  myConfiguration.writeExternal(element);
  for (Iterator<JavaProgramRunner> iterator=myRunnerSettings.keySet().iterator(); iterator.hasNext(); ) {
    JavaProgramRunner runner=iterator.next();
    RunnerSettings settings=myRunnerSettings.get(runner);
    Element runnerElement=new Element(RUNNER_ELEMENT);
    settings.writeExternal(runnerElement);
    element.addContent(runnerElement);
    runnerElement.setAttribute(RUNNER_ID,runner.getInfo().getId());
  }
  for (Iterator<JavaProgramRunner> iterator=myConfigurationPerRunnerSettings.keySet().iterator(); iterator.hasNext(); ) {
    JavaProgramRunner runner=iterator.next();
    ConfigurationPerRunnerSettings settings=myConfigurationPerRunnerSettings.get(runner);
    Element runnerElement=new Element(CONFIGURATION_ELEMENT);
    settings.writeExternal(runnerElement);
    element.addContent(runnerElement);
    runnerElement.setAttribute(RUNNER_ID,runner.getInfo().getId());
  }
}
