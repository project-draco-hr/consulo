{
  final Project project=CommonDataKeys.PROJECT.getData(dataContext);
  if (project == null) {
    return Collections.emptyList();
  }
  final List<RunContentDescriptor> runningProcesses=ExecutionManager.getInstance(project).getContentManager().getAllDescriptors();
  if (runningProcesses.isEmpty()) {
    return Collections.emptyList();
  }
  final List<RunContentDescriptor> activeDescriptors=new ArrayList<RunContentDescriptor>();
  for (  RunContentDescriptor descriptor : runningProcesses) {
    final ProcessHandler processHandler=descriptor.getProcessHandler();
    if (processHandler != null && !processHandler.isProcessTerminating() && !processHandler.isProcessTerminated()) {
      activeDescriptors.add(descriptor);
    }
  }
  return activeDescriptors;
}
