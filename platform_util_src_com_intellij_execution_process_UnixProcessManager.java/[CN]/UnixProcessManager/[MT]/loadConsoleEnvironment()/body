{
  final Map<String,String> env=new HashMap<String,String>();
  final String shell=System.getenv("SHELL");
  if (shell != null && (shell.contains("bash") || shell.contains("zsh"))) {
    processCommandOutput(new String[]{shell,"--login","-c","printenv"},new Processor<String>(){
      @Override public boolean process(      String s){
        final String[] split=s.split("=",2);
        if (split.length > 1) {
          env.put(split[0],split[1]);
        }
        return false;
      }
    }
,false,false);
  }
  ourCachedConsoleEnv=!env.isEmpty() ? Collections.unmodifiableMap(env) : System.getenv();
}
