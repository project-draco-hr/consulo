{
  final File file=getDetectorsRegistryFile();
  FileUtil.createIfDoesntExist(file);
  try {
    DataOutputStream output=new DataOutputStream(new BufferedOutputStream(new FileOutputStream(file)));
    try {
      output.writeInt(REGISTRY_VERSION);
      output.writeInt(myDetectorsVersion);
      final FrameworkDetector[] detectors=FrameworkDetector.EP_NAME.getExtensions();
      output.writeInt(detectors.length);
      for (      FrameworkDetector detector : detectors) {
        output.writeUTF(detector.getDetectorId());
        output.writeInt(myDetectorIds.get(detector.getDetectorId()));
        output.writeInt(detector.getDetectorVersion());
      }
    }
  finally {
      output.close();
    }
  }
 catch (  IOException e) {
    LOG.info(e);
  }
}
