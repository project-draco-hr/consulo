{
  final OrderEntry[] orderEntries=ModuleRootManager.getInstance(module).getOrderEntries();
  final List<OrderEntry> result=new ArrayList<OrderEntry>();
  final List<OrderEntry> moduleOrderEntries=new ArrayList<OrderEntry>();
  int insertIndex=0;
  for (int idx=0; idx < orderEntries.length; idx++) {
    OrderEntry orderEntry=orderEntries[idx];
    if (orderEntry instanceof ModuleOrderEntry) {
      moduleOrderEntries.add(orderEntry);
    }
 else {
      result.add(orderEntry);
      if (orderEntry instanceof ModuleSourceOrderEntry) {
        insertIndex=result.size() - 1;
      }
    }
  }
  if (moduleOrderEntries.size() > 0) {
    result.addAll(insertIndex,moduleOrderEntries);
  }
  return result.toArray(new OrderEntry[result.size()]);
}
