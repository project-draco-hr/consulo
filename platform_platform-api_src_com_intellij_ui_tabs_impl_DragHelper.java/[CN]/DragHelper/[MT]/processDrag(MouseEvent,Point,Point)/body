{
  if (!myTabs.isTabDraggingEnabled())   return;
  SwingUtilities.convertPointFromScreen(startPointScreen,myTabs);
  if (isDragJustStarted()) {
    final TabLabel label=findLabel(startPointScreen);
    if (label == null)     return;
    final Rectangle labelBounds=label.getBounds();
    myHoldDelta=new Dimension(startPointScreen.x - labelBounds.x,startPointScreen.y - labelBounds.y);
    myDragSource=label.getInfo();
    myDragRec=new Rectangle(startPointScreen,labelBounds.getSize());
    myDragOriginalRec=(Rectangle)myDragRec.clone();
    myDragOriginalRec.x-=myHoldDelta.width;
    myDragOriginalRec.y-=myHoldDelta.height;
  }
 else {
    if (myDragRec == null)     return;
    final Point toPoint=SwingUtilities.convertPoint(event.getComponent(),event.getPoint(),myTabs);
    myDragRec.x=toPoint.x;
    myDragRec.y=toPoint.y;
  }
  myDragRec.x-=myHoldDelta.width;
  myDragRec.y-=myHoldDelta.height;
  final Rectangle headerRec=myTabs.getLastLayoutPass().getHeaderRectangle();
  ScreenUtil.moveToFit(myDragRec,headerRec,null);
  int deadZoneX=0;
  int deadZoneY=0;
  final TabLabel top=findLabel(new Point(myDragRec.x + myDragRec.width / 2,myDragRec.y + deadZoneY));
  final TabLabel bottom=findLabel(new Point(myDragRec.x + myDragRec.width / 2,myDragRec.y + myDragRec.height - deadZoneY));
  final TabLabel left=findLabel(new Point(myDragRec.x + deadZoneX,myDragRec.y + myDragRec.height / 2));
  final TabLabel right=findLabel(new Point(myDragRec.x + myDragRec.width - deadZoneX,myDragRec.y + myDragRec.height / 2));
  TabLabel targetLabel;
  if (myTabs.isHorizontalTabs()) {
    targetLabel=findMostOverlapping(myHorizontal,left,right);
    if (targetLabel == null) {
      targetLabel=findMostOverlapping(myVertical,top,bottom);
    }
  }
 else {
    targetLabel=findMostOverlapping(myVertical,top,bottom);
    if (targetLabel == null) {
      targetLabel=findMostOverlapping(myHorizontal,left,right);
    }
  }
  if (targetLabel != null) {
    Rectangle saved=myDragRec;
    myDragRec=null;
    myTabs.reallocate(myDragSource,targetLabel.getInfo(),true);
    myDragOriginalRec=myTabs.myInfo2Label.get(myDragSource).getBounds();
    myDragRec=saved;
    myTabs.moveDraggedTabLabel();
  }
 else {
    myTabs.moveDraggedTabLabel();
    final int border=myTabs.getTabsBorder().getTabBorderSize();
    headerRec.x-=border;
    headerRec.y-=border;
    headerRec.width+=border * 2;
    headerRec.height+=border * 2;
    myTabs.repaint(headerRec);
  }
}
