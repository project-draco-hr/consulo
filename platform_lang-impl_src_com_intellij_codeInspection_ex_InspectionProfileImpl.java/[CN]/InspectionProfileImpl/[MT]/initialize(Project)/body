{
  if (myBaseProfile != null) {
    myBaseProfile.initInspectionTools(project);
  }
  final List<InspectionToolWrapper> tools;
  try {
    tools=createTools();
  }
 catch (  ProcessCanceledException e) {
    return false;
  }
  for (  InspectionToolWrapper tool : tools) {
    final String shortName=tool.getShortName();
    HighlightDisplayKey key=HighlightDisplayKey.find(shortName);
    if (key == null) {
      final InspectionEP extension=tool.getExtension();
      Computable<String> computable=extension == null ? new Computable.PredefinedValueComputable<String>(tool.getDisplayName()) : new Computable<String>(){
        @Override public String compute(){
          return extension.getDisplayName();
        }
      }
;
      if (tool instanceof LocalInspectionToolWrapper) {
        key=HighlightDisplayKey.register(shortName,computable,((LocalInspectionToolWrapper)tool).getID(),((LocalInspectionToolWrapper)tool).getAlternativeID());
      }
 else {
        key=HighlightDisplayKey.register(shortName,computable);
      }
    }
    LOG.assertTrue(key != null,shortName + " ; number of initialized tools: " + myTools.size());
    HighlightDisplayLevel level=myBaseProfile != null ? myBaseProfile.getErrorLevel(key) : tool.getDefaultLevel();
    boolean enabled=myBaseProfile != null ? myBaseProfile.isToolEnabled(key) : tool.isEnabledByDefault();
    final ToolsImpl toolsList=new ToolsImpl(tool,level,!myLockedProfile && enabled,enabled);
    final Element element=myDeinstalledInspectionsSettings.remove(tool.getShortName());
    if (element != null) {
      try {
        toolsList.readExternal(element,this);
      }
 catch (      InvalidDataException e) {
        LOG.error(e);
      }
    }
    myTools.put(tool.getShortName(),toolsList);
  }
  if (mySource != null) {
    copyToolsConfigurations(mySource,project);
  }
  return true;
}
