{
  Set<Pair<String,Boolean>> names=new THashSet<Pair<String,Boolean>>();
  final JspFile jspFile=JspPsiUtil.getJspFile(file);
  collectNamesToImport(names,file,jspFile);
  if (jspFile != null) {
    PsiFile[] files=ArrayUtil.mergeArrays(JspSpiUtil.getIncludingFiles(jspFile),JspSpiUtil.getIncludedFiles(jspFile),PsiFile.class);
    for (    PsiFile includingFile : files) {
      final PsiFile javaRoot=includingFile.getViewProvider().getPsi(StdLanguages.JAVA);
      if (javaRoot instanceof PsiJavaFile && file != javaRoot) {
        collectNamesToImport(names,(PsiJavaFile)javaRoot,jspFile);
      }
    }
  }
  addUnresolvedImportNames(names,file);
  return names;
}
