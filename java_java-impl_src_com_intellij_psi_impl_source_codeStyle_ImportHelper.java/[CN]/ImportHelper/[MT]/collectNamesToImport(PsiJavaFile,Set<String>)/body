{
  Set<String> names=new THashSet<String>();
  final JspFile jspFile=JspPsiUtil.getJspFile(file);
  collectNamesToImport(names,file,namesToImportStaticly,jspFile);
  if (jspFile != null) {
    PsiFile[] files=ArrayUtil.mergeArrays(JspSpiUtil.getIncludingFiles(jspFile),JspSpiUtil.getIncludedFiles(jspFile),PsiFile.class);
    for (    PsiFile includingFile : files) {
      final PsiFile javaRoot=includingFile.getViewProvider().getPsi(StdLanguages.JAVA);
      if (javaRoot instanceof PsiJavaFile && file != javaRoot) {
        collectNamesToImport(names,(PsiJavaFile)javaRoot,namesToImportStaticly,jspFile);
      }
    }
  }
  addUnresolvedImportNames(names,file,namesToImportStaticly);
  return ArrayUtil.toStringArray(names);
}
