{
  if (psiExpression instanceof PsiReferenceExpression) {
    return createReferenceValue((PsiReferenceExpression)psiExpression);
  }
  if (psiExpression instanceof PsiLiteralExpression) {
    return createLiteralValue((PsiLiteralExpression)psiExpression);
  }
  if (psiExpression instanceof PsiNewExpression) {
    return createTypeValue(psiExpression.getType(),Nullness.NOT_NULL);
  }
  final Object value=JavaConstantExpressionEvaluator.computeConstantExpression(psiExpression,false);
  PsiType type=psiExpression.getType();
  if (value != null && type != null) {
    if (value instanceof String) {
      return createTypeValue(type,Nullness.NOT_NULL);
    }
    return getConstFactory().createFromValue(value,type,null);
  }
  return null;
}
