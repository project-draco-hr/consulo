{
  myVcs.addGitReferenceListener(myReferenceListener);
  myChangeManager.addChangeListListener(myChangesListener);
synchronized (myStateLock) {
    updateRootCollection();
    if (myCurrentConfiguration == null) {
      if (calculateSpecialStatus() == SpecialStatus.NORMAL) {
        try {
          detectLocals();
        }
 catch (        VcsException e) {
          LOG.error("Exception during detecting local configurations",e);
        }
      }
    }
    referencesChanged();
  }
  if (!ApplicationManager.getApplication().isHeadlessEnvironment()) {
    myWidgetUninstall=GitBranchesWidget.install(myProject,this);
  }
}
