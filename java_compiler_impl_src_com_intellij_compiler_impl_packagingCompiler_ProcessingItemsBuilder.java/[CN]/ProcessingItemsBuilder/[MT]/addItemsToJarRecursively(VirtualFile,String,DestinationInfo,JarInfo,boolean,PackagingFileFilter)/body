{
  if (fileFilter != null && !fileFilter.accept(sourceFile,myContext.getCompileContext())) {
    return;
  }
  if (sourceFile.isDirectory()) {
    final VirtualFile[] children=sourceFile.getChildren();
    for (    VirtualFile child : children) {
      String childPath=DeploymentUtil.trimForwardSlashes(DeploymentUtil.appendToPath(pathInJar,child.getName()));
      addItemsToJarRecursively(child,childPath,jarDestination,jarInfo,addToJarContent,fileFilter);
    }
  }
 else {
    String fullOutputPath=DeploymentUtil.appendToPath(jarDestination.getOutputPath(),pathInJar);
    if (myContext.checkOutputPath(fullOutputPath,sourceFile)) {
      final PackagingProcessingItem item=myContext.getOrCreateProcessingItem(sourceFile,myBuildParticipant);
      item.addDestination(new JarDestinationInfo(pathInJar,jarInfo,jarDestination));
      if (addToJarContent) {
        jarInfo.addContent(pathInJar,sourceFile);
      }
    }
  }
}
