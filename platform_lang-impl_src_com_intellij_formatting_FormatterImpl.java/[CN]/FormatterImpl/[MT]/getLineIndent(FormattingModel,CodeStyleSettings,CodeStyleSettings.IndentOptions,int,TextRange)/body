{
  final FormattingDocumentModel documentModel=model.getDocumentModel();
  final Block block=model.getRootBlock();
  final FormatProcessor processor=new FormatProcessor(documentModel,block,settings,indentOptions,new FormatTextRanges(affectedRange,true),offset);
  final LeafBlockWrapper blockAfterOffset=processor.getBlockAfter(offset);
  if (blockAfterOffset != null) {
    final WhiteSpace whiteSpace=blockAfterOffset.getWhiteSpace();
    final IndentInfo indent=calcIndent(offset,documentModel,processor,whiteSpace);
    return indent.generateNewWhiteSpace(indentOptions).toString();
  }
  return null;
}
