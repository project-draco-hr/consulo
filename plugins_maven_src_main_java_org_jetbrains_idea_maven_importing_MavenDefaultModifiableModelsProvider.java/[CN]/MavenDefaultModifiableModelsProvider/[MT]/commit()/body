{
  MavenUtil.invokeAndWaitWriteAction(myProject,new Runnable(){
    public void run(){
      ((ProjectRootManagerEx)ProjectRootManager.getInstance(myProject)).mergeRootsChangesDuring(new Runnable(){
        public void run(){
          processExternalArtifactDependencies();
          for (          Library.ModifiableModel each : myLibraryModels.values()) {
            each.commit();
          }
          myLibrariesModel.commit();
          Collection<ModifiableRootModel> rootModels=myRootModels.values();
          ModifiableRootModel[] rootModels1=rootModels.toArray(new ModifiableRootModel[rootModels.size()]);
          ModuleRootManagerImpl.multiCommit(rootModels1,myModuleModel);
          for (          ModifiableFacetModel each : myFacetModels.values()) {
            each.commit();
          }
          if (myArtifactModel != null) {
            myArtifactModel.commit();
          }
        }
      }
);
    }
  }
);
}
