def copyfile(src, dst, basedir):
    (abssrc, absdst) = [util.canonpath(basedir, basedir, x) for x in [src, dst]]
    if os.path.exists(absdst):
        raise util.Abort((_('cannot create %s: destination already exists') % dst))
    dstdir = os.path.dirname(absdst)
    if (dstdir and (not os.path.isdir(dstdir))):
        try:
            os.makedirs(dstdir)
        except IOError:
            raise util.Abort((_('cannot create %s: unable to create destination directory') % dst))
    util.copyfile(abssrc, absdst)
