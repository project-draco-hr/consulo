def diffstatdata(lines):
    (filename, adds, removes) = (None, 0, 0)
    for line in lines:
        if line.startswith('diff'):
            if filename:
                isbinary = ((adds == 0) and (removes == 0))
                yield (filename, adds, removes, isbinary)
            (adds, removes) = (0, 0)
            if line.startswith('diff --git'):
                filename = gitre.search(line).group(1)
            else:
                filename = line.split(None, 5)[(-1)]
        elif (line.startswith('+') and (not line.startswith('+++'))):
            adds += 1
        elif (line.startswith('-') and (not line.startswith('---'))):
            removes += 1
    if filename:
        isbinary = ((adds == 0) and (removes == 0))
        yield (filename, adds, removes, isbinary)
