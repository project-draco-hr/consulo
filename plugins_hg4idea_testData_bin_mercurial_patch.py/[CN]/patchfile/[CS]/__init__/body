def __init__(self, ui, fname, opener, missing=False, eolmode='strict'):
    self.fname = fname
    self.eolmode = eolmode
    self.eol = None
    self.opener = opener
    self.ui = ui
    self.lines = []
    self.exists = False
    self.missing = missing
    if (not missing):
        try:
            self.lines = self.readlines(fname)
            self.exists = True
        except IOError:
            pass
    else:
        self.ui.warn((_("unable to find '%s' for patching\n") % self.fname))
    self.hash = {}
    self.dirty = 0
    self.offset = 0
    self.skew = 0
    self.rej = []
    self.fileprinted = False
    self.printfile(False)
    self.hunks = 0
