{
  final DebuggerContextImpl debuggerContext=getDebuggerContext(e.getDataContext());
  if (debuggerContext == null)   return;
  final DebuggerSession session=debuggerContext.getDebuggerSession();
  if (session == null) {
    return;
  }
  final MainWatchPanel watchPanel=DebuggerPanelsManager.getInstance(debuggerContext.getProject()).getWatchPanel();
  if (watchPanel == null) {
    return;
  }
  final DebuggerTreeNodeImpl[] selectedNodes=getSelectedNodes(e.getDataContext());
  if (selectedNodes != null && selectedNodes.length > 0) {
    debuggerContext.getDebugProcess().getManagerThread().invokeLater(new AddToWatchesCommand(debuggerContext,selectedNodes,watchPanel));
  }
 else {
    final Editor editor=e.getData(DataKeys.EDITOR);
    final TextWithImports editorText=DebuggerUtilsEx.getEditorText(editor);
    if (editorText != null) {
      doAddWatch(watchPanel,editorText,null);
    }
  }
}
