{
  List<OrderRoot> result=new ArrayList<OrderRoot>();
  VirtualFile platformDir=getPlatformDir(target);
  if (platformDir == null)   return result;
  VirtualFile androidJar=platformDir.findChild(SdkConstants.FN_FRAMEWORK_LIBRARY);
  if (androidJar == null)   return result;
  VirtualFile androidJarRoot=JarFileSystem.getInstance().findFileByPath(androidJar.getPath() + JarFileSystem.JAR_SEPARATOR);
  if (androidJarRoot != null) {
    result.add(new OrderRoot(androidJarRoot,OrderRootType.CLASSES));
  }
  IAndroidTarget.IOptionalLibrary[] libs=target.getOptionalLibraries();
  if (libs != null) {
    for (    IAndroidTarget.IOptionalLibrary lib : libs) {
      VirtualFile libRoot=JarFileSystem.getInstance().findFileByPath(lib.getJarPath() + JarFileSystem.JAR_SEPARATOR);
      if (libRoot != null) {
        result.add(new OrderRoot(libRoot,OrderRootType.CLASSES));
      }
    }
  }
  VirtualFile targetDir=platformDir;
  if (!target.isPlatform()) {
    targetDir=LocalFileSystem.getInstance().findFileByPath(target.getLocation());
  }
  if (targetDir != null) {
    addJavaDocAndSources(result,targetDir);
  }
  VirtualFile sdkDir=sdkPath != null ? LocalFileSystem.getInstance().findFileByPath(sdkPath) : null;
  if (sdkDir != null) {
    addJavaDocAndSources(result,sdkDir);
  }
  final String resFolderPath=target.getPath(IAndroidTarget.RESOURCES);
  if (resFolderPath != null) {
    final VirtualFile resFolder=LocalFileSystem.getInstance().findFileByPath(resFolderPath);
    if (resFolder != null) {
      result.add(new OrderRoot(resFolder,OrderRootType.CLASSES));
    }
  }
  if (sdkPath != null) {
    final VirtualFile annotationsJar=JarFileSystem.getInstance().findFileByPath(FileUtil.toSystemIndependentName(sdkPath) + AndroidCommonUtils.ANNOTATIONS_JAR_RELATIVE_PATH + JarFileSystem.JAR_SEPARATOR);
    if (annotationsJar != null) {
      result.add(new OrderRoot(annotationsJar,OrderRootType.CLASSES));
    }
  }
  return result;
}
