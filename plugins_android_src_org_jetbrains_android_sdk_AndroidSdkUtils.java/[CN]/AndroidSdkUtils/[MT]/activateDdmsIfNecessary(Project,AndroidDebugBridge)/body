{
  final boolean ddmsEnabled=AndroidEnableDdmsAction.isDdmsEnabled();
  boolean shouldRestartDdms=!ddmsEnabled;
  if (ddmsEnabled && bridge != null && isDdmsCorrupted(bridge)) {
    shouldRestartDdms=true;
    LOG.info("DDMLIB is corrupted and will be restarted");
    AndroidEnableDdmsAction.setDdmsEnabled(project,false);
  }
  if (shouldRestartDdms) {
    if (!ddmsEnabled) {
      int result=Messages.showYesNoDialog(project,AndroidBundle.message("android.ddms.disabled.error"),AndroidBundle.message("android.ddms.disabled.dialog.title"),Messages.getQuestionIcon());
      if (result != 0) {
        return false;
      }
    }
    AndroidEnableDdmsAction.setDdmsEnabled(project,true);
  }
  return true;
}
