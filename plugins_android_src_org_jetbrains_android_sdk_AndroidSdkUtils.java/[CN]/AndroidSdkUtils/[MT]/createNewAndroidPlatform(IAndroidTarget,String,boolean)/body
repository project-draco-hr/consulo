{
  ProjectJdkTable table=ProjectJdkTable.getInstance();
  String sdkName=SdkConfigurationUtil.createUniqueSdkName(AndroidSdkType.SDK_NAME,Arrays.asList(table.getAllJdks()));
  final Sdk sdk=table.createSdk(sdkName,SdkType.findInstance(AndroidSdkType.class));
  SdkModificator sdkModificator=sdk.getSdkModificator();
  sdkModificator.setHomePath(sdkPath);
  sdkModificator.commitChanges();
  setUpSdk(sdk,null,table.getAllJdks(),target,addRoots);
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    @Override public void run(){
      ProjectJdkTable.getInstance().addJdk(sdk);
    }
  }
);
  return sdk;
}
