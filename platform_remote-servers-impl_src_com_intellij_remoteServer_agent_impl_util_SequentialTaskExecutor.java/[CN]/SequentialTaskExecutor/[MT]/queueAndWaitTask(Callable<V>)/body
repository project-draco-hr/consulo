{
  final Ref<V> resultRef=new Ref<V>();
  final Ref<Throwable> throwableRef=new Ref<Throwable>();
  final Semaphore taskSemaphore=new Semaphore();
  taskSemaphore.down();
  queueTask(new Runnable(){
    @Override public void run(){
      try {
        resultRef.set(task.call());
      }
 catch (      Throwable e) {
        throwableRef.set(e);
        LOG.error(e);
      }
 finally {
        taskSemaphore.up();
      }
    }
  }
);
  taskSemaphore.waitFor();
  if (!throwableRef.isNull()) {
    throw throwableRef.get();
  }
  return resultRef.get();
}
