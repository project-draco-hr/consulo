def _playback(journal, report, opener, entries, unlink=True):
    for (f, o, ignore) in entries:
        if (o or (not unlink)):
            try:
                opener(f, 'a').truncate(o)
            except IOError:
                report((_('failed to truncate %s\n') % f))
                raise
        else:
            try:
                fn = opener(f).name
                os.unlink(fn)
            except (IOError, OSError) as inst:
                if (inst.errno != errno.ENOENT):
                    raise
    os.unlink(journal)
