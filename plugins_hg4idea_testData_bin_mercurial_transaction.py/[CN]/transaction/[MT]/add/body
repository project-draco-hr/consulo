@active
def add(self, file, offset, data=None):
    if (file in self.map):
        return
    if self._queue:
        self._queue[(-1)].append((file, offset, data))
        return
    self.entries.append((file, offset, data))
    self.map[file] = (len(self.entries) - 1)
    self.file.write(('%s\x00%d\n' % (file, offset)))
    self.file.flush()
