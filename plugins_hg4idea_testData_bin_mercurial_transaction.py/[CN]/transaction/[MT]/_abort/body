def _abort(self):
    self.count = 0
    self.file.close()
    try:
        if (not self.entries):
            if self.journal:
                os.unlink(self.journal)
            return
        self.report(_('transaction abort!\n'))
        try:
            _playback(self.journal, self.report, self.opener, self.entries, False)
            self.report(_('rollback completed\n'))
        except:
            self.report(_('rollback failed - please run hg recover\n'))
    finally:
        self.journal = None
