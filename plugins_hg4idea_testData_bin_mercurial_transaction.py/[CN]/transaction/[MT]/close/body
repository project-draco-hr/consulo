@active
def close(self):
    'commit the transaction'
    self.count -= 1
    if (self.count != 0):
        return
    self.file.close()
    self.entries = []
    if self.after:
        self.after()
    if os.path.isfile(self.journal):
        os.unlink(self.journal)
    self.journal = None
