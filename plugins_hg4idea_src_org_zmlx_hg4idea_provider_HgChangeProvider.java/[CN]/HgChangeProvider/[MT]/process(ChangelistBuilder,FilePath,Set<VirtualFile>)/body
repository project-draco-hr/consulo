{
  VirtualFile repo=VcsUtil.getVcsRootFor(myProject,filePath);
  if (repo == null || processedRoots.contains(repo)) {
    return new HashSet<HgChange>();
  }
  Set<HgChange> hgChanges=new HgStatusCommand(myProject).execute(repo);
  if (hgChanges == null || hgChanges.isEmpty()) {
    return new HashSet<HgChange>();
  }
  sendChanges(builder,hgChanges,new HgResolveCommand(myProject).getListSynchronously(repo),new HgWorkingCopyRevisionsCommand(myProject).identify(repo),new HgWorkingCopyRevisionsCommand(myProject).firstParent(repo));
  processedRoots.add(repo);
  return hgChanges;
}
