{
  FindSettings findSettings=FindSettings.getInstance();
  model.setCaseSensitive(myCbCaseSensitive.isSelected());
  findSettings.setCaseSensitive(myCbCaseSensitive.isSelected());
  if (model.isReplaceState()) {
    model.setPreserveCase(myCbPreserveCase.isSelected());
    findSettings.setPreserveCase(myCbPreserveCase.isSelected());
  }
  model.setWholeWordsOnly(myCbWholeWordsOnly.isSelected());
  findSettings.setWholeWordsOnly(myCbWholeWordsOnly.isSelected());
  model.setRegularExpressions(myCbRegularExpressions.isSelected());
  findSettings.setRegularExpressions(myCbRegularExpressions.isSelected());
  model.setStringToFind(getStringToFind());
  if (model.isReplaceState()) {
    model.setPromptOnReplace(true);
    model.setReplaceAll(false);
    String stringToReplace=(String)myReplaceComboBox.getSelectedItem();
    if (stringToReplace == null) {
      stringToReplace="";
    }
    model.setStringToReplace(stringToReplace);
  }
  if (!model.isMultipleFiles()) {
    model.setForward(myRbForward.isSelected());
    findSettings.setForward(myRbForward.isSelected());
    model.setFromCursor(myRbFromCursor.isSelected());
    findSettings.setFromCursor(myRbFromCursor.isSelected());
    model.setGlobal(myRbGlobal.isSelected());
    findSettings.setGlobal(myRbGlobal.isSelected());
  }
 else {
    if (myCbToOpenInNewTab != null) {
      model.setOpenInNewTab(myCbToOpenInNewTab.isSelected());
    }
    model.setProjectScope(myRbProject.isSelected());
    model.setDirectoryName(null);
    model.setModuleName(null);
    model.setCustomScopeName(null);
    model.setCustomScope(null);
    if (myRbDirectory.isSelected()) {
      String directory=getDirectory();
      model.setDirectoryName(directory == null ? "" : directory);
      model.setWithSubdirectories(myCbWithSubdirectories.isSelected());
      findSettings.setWithSubdirectories(myCbWithSubdirectories.isSelected());
    }
 else     if (myRbModule.isSelected()) {
      model.setModuleName((String)myModuleComboBox.getSelectedItem());
    }
 else     if (myRbCustomScope.isSelected()) {
      SearchScope selectedScope=myScopeCombo.getSelectedScope();
      String customScopeName=selectedScope == null ? null : selectedScope.getDisplayName();
      model.setCustomScopeName(customScopeName);
      model.setCustomScope(selectedScope == null ? null : selectedScope);
      findSettings.setCustomScope(customScopeName);
    }
    if (useFileFilter.isSelected()) {
      findSettings.setFileMask(model.getFileFilter());
    }
 else {
      findSettings.setFileMask(null);
    }
  }
}
