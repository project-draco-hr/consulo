{
  ProjectManager projectManager=ProjectManager.getInstance();
  if (projectManager == null)   return null;
  final Project[] projects=projectManager.getOpenProjects();
  if (projects.length == 0)   return null;
  if (projects.length == 1 && !projects[0].isDisposed())   return projects[0];
  for (  Project project : projects) {
    if (project.isInitialized() && !project.isDisposed() && ProjectRootManager.getInstance(project).getFileIndex().isInContent(file)) {
      return project;
    }
  }
  return !projects[0].isDisposed() ? projects[0] : null;
}
