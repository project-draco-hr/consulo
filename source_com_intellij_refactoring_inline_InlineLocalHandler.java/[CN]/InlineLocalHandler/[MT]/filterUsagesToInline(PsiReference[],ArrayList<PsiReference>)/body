{
  PsiReference firstWriteUsage=null;
  PsiExpression assignmentExpression=null;
  for (int idx=0; idx < refs.length; idx++) {
    PsiReference ref=refs[idx];
    PsiElement refElement=ref.getElement();
    if (PsiUtil.isAccessedForWriting((PsiExpression)refElement)) {
      if (assignmentExpression != null)       break;
      assignmentExpression=(PsiExpression)refElement.getParent();
      firstWriteUsage=ref;
      continue;
    }
    if (assignmentExpression != null) {
      if (!PsiTreeUtil.isAncestor(assignmentExpression,refElement,true))       break;
    }
    toInline.add(ref);
  }
  return firstWriteUsage;
}
