{
  if (myPopup == null || !myPopup.isVisible()) {
    return;
  }
  final Dimension size=myList.getPreferredSize();
  if (size.width < myPopupActualWidth) {
    size.width=myPopupActualWidth;
  }
  Dimension sz=new Dimension(Math.max(getField().getWidth(),size.width),size.height);
  if (sz.width > 800 || sz.height > 800) {
    final int extra=new JBScrollPane().getVerticalScrollBar().getWidth();
    sz=new Dimension(Math.min(800,Math.max(getField().getWidth(),size.width + extra)),Math.min(800,size.height + extra));
    sz.width+=16;
  }
 else {
    sz.height++;
    sz.height++;
    sz.width++;
    sz.width++;
  }
  myPopup.setSize(sz);
  if (getField() == field) {
    final Point p=getField().getLocationOnScreen();
    p.y+=getField().getHeight();
    if (getField().getWidth() < sz.width) {
      p.x-=sz.width - getField().getWidth();
    }
    myPopup.setLocation(p);
  }
 else {
    adjustPopup();
  }
}
