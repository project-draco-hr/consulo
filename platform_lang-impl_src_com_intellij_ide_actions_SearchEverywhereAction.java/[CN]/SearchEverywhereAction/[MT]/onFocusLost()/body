{
  final ActionCallback result=new ActionCallback();
  UIUtil.invokeLaterIfNeeded(new Runnable(){
    @Override public void run(){
      try {
        if (myCalcThread != null) {
          myCalcThread.cancel();
        }
        myAlarm.cancelAllRequests();
        if (myBalloon != null && !myBalloon.isDisposed() && myPopup != null && !myPopup.isDisposed()) {
          myBalloon.cancel();
          myPopup.cancel();
        }
        SwingUtilities.invokeLater(new Runnable(){
          @Override public void run(){
            ActionToolbarImpl.updateAllToolbarsImmediately();
          }
        }
);
      }
  finally {
        result.setDone();
      }
    }
  }
);
  return result;
}
