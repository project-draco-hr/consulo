{
  final MinusculeMatcher matcher=new MinusculeMatcher("*" + pattern,NameUtil.MatchingCaseSensitivity.NONE);
  final ArrayList<VirtualFile> files=new ArrayList<VirtualFile>();
  for (  VirtualFile file : ArrayUtil.reverseArray(EditorHistoryManager.getInstance(project).getFiles())) {
    if (StringUtil.isEmptyOrSpaces(pattern) || matcher.matches(file.getName())) {
      if (!files.contains(file)) {
        files.add(file);
      }
    }
    if (files.size() > MAX_RECENT_FILES)     break;
  }
  if (files.size() > 0) {
    myAlreadyAddedFiles.addAll(files);
    UIUtil.invokeLaterIfNeeded(new Runnable(){
      @Override public void run(){
        if (!myProgressIndicator.isCanceled()) {
          myTitleIndexes.recentFiles=myListModel.size();
          for (          Object file : files) {
            myListModel.addElement(file);
          }
        }
      }
    }
);
  }
}
