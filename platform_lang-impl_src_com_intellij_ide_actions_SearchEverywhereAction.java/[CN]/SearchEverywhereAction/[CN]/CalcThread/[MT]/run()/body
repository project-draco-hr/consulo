{
  UIUtil.invokeAndWaitIfNeeded(new Runnable(){
    @Override public void run(){
      myTitleIndexes.clear();
      clearModel();
      myAlreadyAddedFiles.clear();
    }
  }
);
  if (pattern.trim().length() == 0) {
    buildModelFromRecentFiles();
    updatePopup();
    return;
  }
  checkModelsUpToDate();
  buildTopHit(pattern);
  buildRecentFiles(pattern);
  updatePopup();
  AccessToken readLock=ApplicationManager.getApplication().acquireReadActionLock();
  if (!DumbServiceImpl.getInstance(project).isDumb()) {
    try {
      buildClasses(pattern,false);
    }
  finally {
      readLock.finish();
    }
    updatePopup();
  }
  readLock=ApplicationManager.getApplication().acquireReadActionLock();
  try {
    buildFiles(pattern);
  }
  finally {
    readLock.finish();
  }
  buildActionsAndSettings(pattern);
  updatePopup();
}
