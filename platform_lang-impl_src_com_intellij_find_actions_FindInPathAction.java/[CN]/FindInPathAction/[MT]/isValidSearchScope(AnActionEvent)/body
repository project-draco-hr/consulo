{
  final PsiElement[] elements=e.getData(LangDataKeys.PSI_ELEMENT_ARRAY);
  if (elements != null && elements.length == 1 && elements[0] instanceof PsiDirectoryContainer) {
    return true;
  }
  final VirtualFile[] virtualFiles=e.getData(PlatformDataKeys.VIRTUAL_FILE_ARRAY);
  return virtualFiles != null && virtualFiles.length == 1 && virtualFiles[0].isDirectory();
}
