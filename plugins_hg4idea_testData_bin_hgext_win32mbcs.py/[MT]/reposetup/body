def reposetup(ui, repo):
    if (not os.path.supports_unicode_filenames):
        ui.warn(_('[win32mbcs] cannot activate on this platform.\n'))
        return
    global _encoding
    _encoding = ui.config('win32mbcs', 'encoding', encoding.encoding)
    if (_encoding.lower() in problematic_encodings.split()):
        for f in funcs.split():
            wrapname(f, wrapper)
        wrapname('mercurial.osutil.listdir', wrapperforlistdir)
        ui.debug(('[win32mbcs] activated with encoding: %s\n' % _encoding))
