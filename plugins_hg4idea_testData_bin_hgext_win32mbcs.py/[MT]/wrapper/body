def wrapper(func, args, kwds):
    for arg in args:
        if isinstance(arg, unicode):
            return func(*args, **kwds)
    try:
        return encode(func(*decode(args), **decode(kwds)))
    except UnicodeError:
        raise util.Abort((_('[win32mbcs] filename conversion failed with %s encoding\n') % _encoding))
