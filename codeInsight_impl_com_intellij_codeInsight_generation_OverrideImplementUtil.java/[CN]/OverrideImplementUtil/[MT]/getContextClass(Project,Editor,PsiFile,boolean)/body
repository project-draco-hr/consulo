{
  PsiDocumentManager.getInstance(project).commitAllDocuments();
  int offset=editor.getCaretModel().getOffset();
  PsiElement element=file.findElementAt(offset);
  do {
    element=PsiTreeUtil.getParentOfType(element,PsiClass.class);
  }
 while (element instanceof PsiTypeParameter);
  final PsiClass aClass=(PsiClass)element;
  return aClass == null || !allowInterface && aClass.isInterface() ? null : aClass;
}
