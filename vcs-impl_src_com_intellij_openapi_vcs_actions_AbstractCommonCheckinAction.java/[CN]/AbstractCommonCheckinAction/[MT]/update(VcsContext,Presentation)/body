{
  Project project=vcsContext.getProject();
  if (project == null) {
    presentation.setEnabled(false);
    presentation.setVisible(false);
    return;
  }
  final ProjectLevelVcsManager plVcsManager=ProjectLevelVcsManager.getInstance(project);
  if (plVcsManager.getAllActiveVcss().length == 0) {
    presentation.setEnabled(false);
    presentation.setVisible(false);
    return;
  }
  FilePath[] roots=filterRoots(getRoots(vcsContext),project);
  if (roots == null || roots.length == 0) {
    presentation.setEnabled(false);
    return;
  }
  int checkinType=getCheckinType(roots);
  if (checkinType == DIRECTORIES) {
    if (roots.length == 0) {
      presentation.setEnabled(false);
      return;
    }
  }
 else {
    AbstractVcs commonVcsFor=getCommonVcsFor(roots,project);
    if (commonVcsFor == null) {
      presentation.setEnabled(false);
      presentation.setVisible(false);
      return;
    }
  }
  String actionName=getActionName(vcsContext) + "...";
  presentation.setText(actionName);
  presentation.setEnabled(!plVcsManager.isBackgroundVcsOperationRunning());
  presentation.setVisible(true);
}
