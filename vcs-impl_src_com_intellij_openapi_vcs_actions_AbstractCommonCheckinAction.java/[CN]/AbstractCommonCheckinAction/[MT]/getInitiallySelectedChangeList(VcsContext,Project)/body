{
  LocalChangeList initialSelection;
  ChangeList[] selectedChangeLists=context.getSelectedChangeLists();
  if (selectedChangeLists != null && selectedChangeLists.length > 0) {
    initialSelection=ChangeListManager.getInstance(project).findChangeList(selectedChangeLists[0].getName());
  }
 else {
    Change[] selectedChanges=context.getSelectedChanges();
    if (selectedChanges != null && selectedChanges.length > 0) {
      initialSelection=ChangeListManager.getInstance(project).getChangeList(selectedChanges[0]);
    }
 else {
      initialSelection=ChangeListManager.getInstance(project).getDefaultChangeList();
    }
  }
  return initialSelection;
}
