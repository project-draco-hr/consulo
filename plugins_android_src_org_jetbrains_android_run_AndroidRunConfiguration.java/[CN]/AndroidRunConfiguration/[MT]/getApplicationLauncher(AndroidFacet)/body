{
  String activityToLaunch=null;
  if (MODE.equals(LAUNCH_DEFAULT_ACTIVITY)) {
    Manifest manifest=facet.getManifest();
    if (manifest == null)     return null;
    String defaultActivityName=AndroidUtils.getDefaultActivityName(manifest);
    if (defaultActivityName != null) {
      activityToLaunch=defaultActivityName;
    }
 else {
      Messages.showErrorDialog(facet.getModule().getProject(),AndroidBundle.message("default.activity.not.found.error"),CommonBundle.getErrorTitle());
      return null;
    }
  }
 else   if (MODE.equals(LAUNCH_SPECIFIC_ACTIVITY)) {
    activityToLaunch=ACTIVITY_CLASS;
  }
  if (activityToLaunch != null) {
    final GlobalSearchScope scope=facet.getModule().getModuleWithDependenciesAndLibrariesScope(false);
    final PsiClass activityClass=JavaPsiFacade.getInstance(getProject()).findClass(activityToLaunch,scope);
    if (activityClass != null) {
      activityToLaunch=JavaExecutionUtil.getRuntimeQualifiedName(activityClass);
    }
  }
  return new MyApplicationLauncher(activityToLaunch);
}
