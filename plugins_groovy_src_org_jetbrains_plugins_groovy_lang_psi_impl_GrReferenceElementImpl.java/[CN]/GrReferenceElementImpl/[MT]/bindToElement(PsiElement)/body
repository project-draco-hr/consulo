{
  if (isReferenceTo(element))   return this;
  if (element instanceof PsiClass) {
    final String newName=((PsiClass)element).getName();
    final GrReferenceElementImpl newElement=((GrReferenceElementImpl)handleElementRename(newName));
    if (newElement.isReferenceTo(element))     return newElement;
    final String qualifiedName=((PsiClass)element).getQualifiedName();
    if (qualifiedName == null)     return newElement;
    return newElement.bindWithQualifiedRef(qualifiedName);
  }
 else   if (element instanceof PsiMember) {
    PsiMember member=(PsiMember)element;
    if (!isPhysical()) {
      return this;
    }
    final PsiClass psiClass=member.getContainingClass();
    if (psiClass == null)     throw new IncorrectOperationException();
    String qName=psiClass.getQualifiedName() + "." + member.getName();
    return bindWithQualifiedRef(qName);
  }
 else   if (element instanceof PsiPackage) {
    final String qName=((PsiPackage)element).getQualifiedName();
    return bindWithQualifiedRef(qName);
  }
  throw new IncorrectOperationException("Cannot bind to:" + element + " of class "+ element.getClass());
}
