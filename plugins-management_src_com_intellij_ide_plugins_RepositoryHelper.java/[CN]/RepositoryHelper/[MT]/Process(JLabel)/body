{
  ArrayList<IdeaPluginDescriptor> plugins=null;
  try {
    String buildNumber=RepositoryHelper.ExtractBuildNumber();
    @NonNls String url=RepositoryHelper.REPOSITORY_LIST_URL + "?build=" + buildNumber;
    setLabelText(label,IdeBundle.message("progress.connecting.to.plugin.manager",RepositoryHelper.REPOSITORY_HOST));
    HttpConfigurable.getInstance().prepareURL(RepositoryHelper.REPOSITORY_HOST);
{
      RepositoryContentHandler handler=new RepositoryContentHandler();
      HttpURLConnection connection=(HttpURLConnection)new URL(url).openConnection();
      setLabelText(label,IdeBundle.message("progress.waiting.for.reply.from.plugin.manager",RepositoryHelper.REPOSITORY_HOST));
      InputStream is=RepositoryHelper.getConnectionInputStream(connection);
      if (is != null) {
        setLabelText(label,IdeBundle.message("progress.downloading.list.of.plugins"));
        File temp=RepositoryHelper.CreateLocalPluginsDescriptions();
        RepositoryHelper.ReadPluginsStream(temp,is,handler);
        plugins=handler.getPluginsList();
      }
    }
  }
 catch (  RuntimeException e) {
    e.printStackTrace();
    if (e.getCause() == null || !(e.getCause() instanceof InterruptedException)) {
    }
  }
  return plugins;
}
