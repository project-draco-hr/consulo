{
  if (entity instanceof RefElement) {
    final RefElementImpl refElement=(RefElementImpl)entity;
    if (refElement.isSuppressed(tool.getShortName()))     return false;
    final PsiElement element=refElement.getElement();
    if (element == null)     return false;
    if (RUN_WITH_EDITOR_PROFILE) {
      final InspectionProfileEntry inspectionTool=InspectionProjectProfileManager.getInstance(element.getProject()).getInspectionProfile(element).getInspectionTool(tool.getShortName());
      if (inspectionTool instanceof GlobalInspectionToolWrapper && ((GlobalInspectionToolWrapper)inspectionTool).getTool() != tool) {
        return false;
      }
    }
  }
  return true;
}
