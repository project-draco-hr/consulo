{
  myJobDescriptors=new ArrayList<JobDescriptor>();
  final InspectionProjectProfileManager profileManager=InspectionProjectProfileManager.getInstance(getProject());
  if (RUN_WITH_EDITOR_PROFILE) {
    final Set<String> profiles=scope.getActiveInspectionProfiles();
    for (    String profile : profiles) {
      InspectionProfileWrapper inspectionProfile=profileManager.getProfileWrapper(profile);
      if (inspectionProfile == null) {
        inspectionProfile=new InspectionProfileWrapper((InspectionProfile)profileManager.getProfile(profile));
        final InspectionProfileWrapper profileWrapper=inspectionProfile;
        ApplicationManager.getApplication().runReadAction(new Runnable(){
          public void run(){
            profileWrapper.init(getProject());
          }
        }
);
      }
      processProfileTools(inspectionProfile,tools,localTools);
    }
  }
 else {
    final InspectionProfileWrapper profile=new InspectionProfileWrapper(getCurrentProfile());
    processProfileTools(profile,tools,localTools);
    ApplicationManager.getApplication().runReadAction(new Runnable(){
      public void run(){
        profile.init(getProject());
      }
    }
);
  }
}
