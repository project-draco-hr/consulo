{
  PsiElement targetElement=TargetElementUtilBase.getInstance().findTargetElement(editor,TargetElementUtilBase.REFERENCED_ELEMENT_ACCEPTED | TargetElementUtilBase.ELEMENT_NAME_ACCEPTED | TargetElementUtilBase.LOOKUP_ITEM_ACCEPTED,offset);
  PsiType type;
  if (targetElement instanceof PsiVariable) {
    type=((PsiVariable)targetElement).getType();
  }
 else   if (targetElement instanceof PsiMethod) {
    type=((PsiMethod)targetElement).getReturnType();
  }
 else {
    return null;
  }
  if (type == null)   return null;
  return PsiUtil.resolveClassInType(type);
}
