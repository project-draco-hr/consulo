{
  List<PsiElement> candidates=new ArrayList<PsiElement>(elements.length);
  List<FileDescriptor> files=new ArrayList<FileDescriptor>(elements.length);
  final Set<String> names=new HashSet<String>();
  for (  PsiElement element : elements) {
    if (element instanceof PsiNamedElement) {
      names.add(((PsiNamedElement)element).getName());
    }
  }
  for (  PsiElement element : elements) {
    PsiFile file=getContainingFile(element);
    if (file == null)     continue;
    final PsiElement parent=element.getParent();
    files.add(new FileDescriptor(file,names.size() > 1 || parent == file ? element : parent));
    candidates.add(element.getNavigationElement());
  }
  fun.fun(PsiUtilBase.toPsiElementArray(candidates),files);
}
