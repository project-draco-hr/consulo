{
  if (classDirectory == null && module != null) {
    try {
      classDirectory=PackageUtil.findOrCreateDirectoryForPackage(module,"",null,false);
    }
 catch (    IncorrectOperationException e) {
      return null;
    }
  }
  if (classDirectory == null) {
    return null;
  }
  try {
    final Properties properties=ApplicationManager.getApplication().isUnitTestMode() ? new Properties() : FileTemplateManager.getInstance().getDefaultProperties(classDirectory.getProject());
    return createClassNamed(className,new Properties(properties),templateName,classDirectory);
  }
 catch (  IncorrectOperationException e) {
    LOG.error(e);
    return null;
  }
}
