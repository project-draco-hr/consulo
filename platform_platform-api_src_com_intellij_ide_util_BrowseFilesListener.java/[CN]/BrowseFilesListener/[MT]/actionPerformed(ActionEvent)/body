{
  final VirtualFile fileToSelect=getFileToSelect();
  myChooserDescriptor.setTitle(myTitle);
  myChooserDescriptor.setDescription(myDescription);
  if (SystemInfo.isMac) {
    FileChooser.chooseFilesWithSlideEffect(myChooserDescriptor,null,fileToSelect,new Consumer<VirtualFile[]>(){
      @Override public void consume(      final VirtualFile[] files){
        if (files != null && files.length > 0) {
          myTextField.setText(files[0].getPath().replace('/',File.separatorChar));
        }
      }
    }
);
  }
 else {
    VirtualFile[] files=(fileToSelect != null) ? FileChooser.chooseFiles(myTextField,myChooserDescriptor,fileToSelect) : FileChooser.chooseFiles(myTextField,myChooserDescriptor);
    if (files.length > 0) {
      myTextField.setText(files[0].getPath().replace('/',File.separatorChar));
    }
  }
}
