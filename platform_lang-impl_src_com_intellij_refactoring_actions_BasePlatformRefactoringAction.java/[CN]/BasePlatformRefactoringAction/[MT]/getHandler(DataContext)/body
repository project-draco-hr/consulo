{
  final Language[] languages=LangDataKeys.CONTEXT_LANGUAGES.getData(dataContext);
  if (languages != null) {
    PsiElement elementAtCaret=getElementAtCaret(LangDataKeys.EDITOR.getData(dataContext),LangDataKeys.PSI_FILE.getData(dataContext));
    for (    Language language : languages) {
      RefactoringActionHandler handler=getHandler(language,elementAtCaret);
      if (handler != null) {
        return handler;
      }
    }
  }
 else {
    PsiElement element=LangDataKeys.PSI_ELEMENT.getData(dataContext);
    if (element != null) {
      return getHandler(element.getLanguage(),element);
    }
  }
  return null;
}
