{
  final Language[] languages=LangDataKeys.CONTEXT_LANGUAGES.getData(dataContext);
  if (languages != null) {
    Editor editor=LangDataKeys.EDITOR.getData(dataContext);
    PsiFile file=LangDataKeys.PSI_FILE.getData(dataContext);
    PsiElement elementAtCaret=editor == null || file == null ? null : getElementAtCaret(editor,file);
    for (    Language language : languages) {
      RefactoringActionHandler handler=getHandler(language,elementAtCaret);
      if (handler != null) {
        return handler;
      }
    }
  }
 else {
    PsiElement element=LangDataKeys.PSI_ELEMENT.getData(dataContext);
    if (element != null) {
      return getHandler(element.getLanguage(),element);
    }
  }
  return null;
}
