{
  if (myMode == mode)   return;
  myMode=mode;
  if (mode == EvaluationMode.EXPRESSION) {
    text=new XExpressionImpl(StringUtil.convertLineSeparators(text.getExpression()," "),text.getLanguage(),text.getCustomInfo());
  }
  myInputComponent=createInputComponent(mode,text);
  myMainPanel.removeAll();
  myInputComponent.addComponent(myMainPanel,myResultPanel);
  setTitle(myInputComponent.getTitle());
  mySwitchModeAction.putValue(Action.NAME,getSwitchButtonText(mode));
  getInputEditor().requestFocusInEditor();
}
