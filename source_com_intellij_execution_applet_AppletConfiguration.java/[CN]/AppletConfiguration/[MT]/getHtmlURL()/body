{
  if (HTML_USED) {
    if (HTML_FILE_NAME == null || HTML_FILE_NAME.length() == 0) {
      throw new CantRunException("HTML file not specified.");
    }
    return new AppletHtmlFile(HTML_FILE_NAME,null);
  }
 else {
    if (MAIN_CLASS_NAME == null || MAIN_CLASS_NAME.length() == 0) {
      throw new CantRunException("Class not specified.");
    }
    try {
      final File tempFile=File.createTempFile("AppletPage",".html");
      final FileWriter writer=new FileWriter(tempFile);
      writer.write("<html>\n" + "<head>\n" + "<title>" + MAIN_CLASS_NAME + "</title>\n"+ "</head>\n"+ "<applet codebase=\".\"\n"+ "code=\""+ MAIN_CLASS_NAME+ "\"\n"+ "name=\""+ MAIN_CLASS_NAME+ "\"\n"+ "width="+ WIDTH+ "\n"+ "height="+ HEIGHT+ "\n"+ "align=top>\n");
      final AppletParameter[] appletParameters=getAppletParameters();
      if (appletParameters != null) {
        for (int i=0; i < appletParameters.length; i++) {
          final AppletParameter parameter=appletParameters[i];
          writer.write("<param name=\"" + parameter.getName() + "\" value=\""+ parameter.getValue()+ "\">\n");
        }
      }
      writer.write("</applet>\n</body>\n</html>\n");
      writer.close();
      final String htmlFile=tempFile.getAbsolutePath();
      return new AppletHtmlFile(htmlFile,tempFile);
    }
 catch (    IOException e) {
      throw new CantRunException("Failed to generate temporary html wrapper for applet class");
    }
  }
}
