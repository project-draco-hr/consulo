{
  PsiJavaPackage aPackage=null;
  if (qualifierElement instanceof PsiJavaPackage) {
    aPackage=(PsiJavaPackage)qualifierElement;
  }
 else {
    final PsiDirectory directory=sourceFile.getContainingDirectory();
    if (directory != null) {
      aPackage=JavaDirectoryService.getInstance().getPackage(directory);
    }
    if (aPackage == null) {
      aPackage=JavaPsiFacade.getInstance(manager.getProject()).findPackage("");
    }
  }
  if (aPackage == null)   return null;
  return aPackage;
}
