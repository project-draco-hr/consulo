{
  for (int i=0; i < usages.length; i++) {
    UsageInfo usage=usages[i];
    if (!usage.getElement().isValid()) {
      continue;
    }
    if (!(usage.getElement() instanceof PsiMethod)) {
      final PsiReference ref;
      if (usage instanceof MoveRenameUsageInfo) {
        ref=((MoveRenameUsageInfo)usage).reference;
      }
 else {
        ref=usage.getElement().getReference();
      }
      if (ref != null) {
        ref.handleElementRename(newName);
      }
    }
  }
  method.setName(newName);
  for (int i=0; i < usages.length; i++) {
    UsageInfo usage=usages[i];
    if (!usage.getElement().isValid()) {
      continue;
    }
    if (usage.getElement() instanceof PsiMethod) {
      ((PsiMethod)usage.getElement()).setName(newName);
    }
  }
  listener.elementRenamed(method);
}
