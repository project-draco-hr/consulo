{
  final PsiVariable collidingVariable=scope.getManager().getResolveHelper().resolveReferencedVariable(newName,scope);
  if (collidingVariable instanceof PsiLocalVariable || collidingVariable instanceof PsiParameter) {
    final PsiElement commonParent=PsiTreeUtil.findCommonParent(element,collidingVariable);
    if (commonParent != null) {
      PsiElement current=element;
      while (current != null && current != commonParent) {
        if (current instanceof PsiMethod || current instanceof PsiClass) {
          return;
        }
        current=current.getParent();
      }
    }
  }
  if (collidingVariable != null) {
    collidingNameVisitor.visitCollidingElement(collidingVariable);
  }
}
