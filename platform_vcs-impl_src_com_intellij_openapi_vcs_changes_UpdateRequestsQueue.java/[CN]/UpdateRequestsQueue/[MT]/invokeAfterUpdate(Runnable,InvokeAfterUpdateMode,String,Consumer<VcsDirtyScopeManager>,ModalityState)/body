{
  LOG.debug("invokeAfterUpdate for project: " + myProject.getName());
  final CallbackData data=CallbackData.create(afterUpdate,title,state,mode,myProject);
  VcsDirtyScopeManagerProxy managerProxy=null;
  if (dirtyScopeManagerFiller != null) {
    managerProxy=new VcsDirtyScopeManagerProxy();
    dirtyScopeManagerFiller.consume(managerProxy);
  }
  if (!myStopped) {
    if (managerProxy != null) {
      managerProxy.callRealManager(VcsDirtyScopeManager.getInstance(myProject));
    }
  }
synchronized (myLock) {
    if (!myStopped) {
      myWaitingUpdateCompletionQueue.add(data.getCallback());
      schedule();
    }
  }
  if (myStopped) {
    LOG.debug("invokeAfterUpdate: stopped, invoke right now for project: " + myProject.getName());
    SwingUtilities.invokeLater(new Runnable(){
      public void run(){
        if (!myProject.isDisposed()) {
          afterUpdate.run();
        }
      }
    }
);
    return;
  }
  if (data.getWrapperStarter() != null) {
    data.getWrapperStarter().run();
  }
  LOG.debug("invokeAfterUpdate: exit for project: " + myProject.getName());
}
