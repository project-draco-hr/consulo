{
  if (ChangeListManagerImpl.DEBUG) {
    ChangeListManagerImpl.log("UpdateRequestsQueue.waitUntilRefreshed");
  }
  try {
    while (true) {
      final Semaphore semaphore=new Semaphore();
synchronized (myLock) {
        if (!myRequestSubmitted && !myRequestRunning) {
          return;
        }
        semaphore.down();
        myWaitingUpdateCompletionSemaphores.add(semaphore);
      }
      if (!semaphore.waitFor(10000)) {
        LOG.error("Too long VCS update");
        return;
      }
    }
  }
  finally {
    if (ChangeListManagerImpl.DEBUG) {
      ChangeListManagerImpl.log(" - end - UpdateRequestsQueue.waitUntilRefreshed");
    }
  }
}
