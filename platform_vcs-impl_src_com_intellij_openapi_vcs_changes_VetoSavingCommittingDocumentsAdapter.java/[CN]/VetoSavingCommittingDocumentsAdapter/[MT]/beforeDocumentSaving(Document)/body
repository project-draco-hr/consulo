{
  final Object beingCommitted=document.getUserData(ChangeListManagerImpl.DOCUMENT_BEING_COMMITTED_KEY);
  if (beingCommitted == SAVE_DENIED) {
    throw new VetoDocumentSavingException();
  }
  if (beingCommitted instanceof Project) {
    boolean allowSave=showAllowSaveDialog((Project)beingCommitted,Collections.singletonList(document));
    if (!allowSave) {
      throw new VetoDocumentSavingException();
    }
  }
}
