{
  mySystemBuilder=new SystemBuilder(myProject,myDialog.getSettings());
  final System commonSystem=mySystemBuilder.build(myElements);
  myResult=new Result(commonSystem);
  final System[] systems=commonSystem.isolate();
  for (int i=0; i < systems.length; i++) {
    final System system=systems[i];
    if (system != null) {
      final ResolverTree tree=new ResolverTree(system);
      tree.resolve();
      final Binding[] solutions=tree.getSolutions();
      if (solutions.length > 0) {
        myResult.incorporateSolution(solutions[0]);
      }
    }
  }
  final HashSet<PsiElement> cookedItems=myResult.getCookedElements();
  final UsageInfo[] usages=new UsageInfo[cookedItems.size()];
  int i=0;
  for (final Iterator<PsiElement> e=cookedItems.iterator(); e.hasNext(); ) {
    final PsiElement element=e.next();
    usages[i++]=new UsageInfo(element){
      public String getTooltipText(){
        return myResult.getCookedType(element).getCanonicalText();
      }
    }
;
  }
  return usages;
}
