{
  if (startNode == null) {
    return null;
  }
  ASTNode parent=startNode.getTreeParent();
  if (parent == null) {
    return null;
  }
  boolean returnFirstNonEmptySubNode=false;
  ASTNode prev=getPreviousNode(startNode);
  if (prev != null && config.getWhiteSpaceTokenTypes().contains(prev.getElementType()) && StringUtil.countNewLines(prev.getChars()) > 0) {
    returnFirstNonEmptySubNode=true;
  }
  boolean stop=false;
  for (ASTNode result=startNode; result != null && result.getTreeParent() == parent; result=result.getTreeNext()) {
    if (config.getStopMultilineCheckElementTypes().contains(result.getElementType())) {
      return null;
    }
    if (result.getTextLength() <= 0) {
      continue;
    }
    if (config.getCommentTokenTypes().contains(result.getElementType())) {
      continue;
    }
    if (config.getWhiteSpaceTokenTypes().contains(result.getElementType()) && StringUtil.countNewLines(result.getChars()) > 0) {
      stop=true;
      continue;
    }
    if (returnFirstNonEmptySubNode) {
      return result;
    }
    if (stop) {
      return result;
    }
  }
  return null;
}
