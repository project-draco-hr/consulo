{
  if (myIntersectHighlighter != null) {
    myEditor.getMarkupModel().removeHighlighter(myIntersectHighlighter);
    myIntersectHighlighter.dispose();
  }
  if (myEditor.getSelectionModel().hasSelection()) {
    int selectionStart=myEditor.getSelectionModel().getSelectionStart();
    int selectionEnd=myEditor.getSelectionModel().getSelectionEnd();
    TextRange resRange=new TextRange(highlightStart,highlightEnd).intersection(new TextRange(selectionStart,selectionEnd));
    if (resRange != null) {
      TextAttributes attributes=new TextAttributes();
      attributes.setBackgroundColor(Color.LIGHT_GRAY);
      attributes.setForegroundColor(Color.white);
      myIntersectHighlighter=myEditor.getMarkupModel().addRangeHighlighter(resRange.getStartOffset(),resRange.getEndOffset(),HighlighterLayer.LAST + 1,attributes,HighlighterTargetArea.EXACT_RANGE);
    }
  }
}
