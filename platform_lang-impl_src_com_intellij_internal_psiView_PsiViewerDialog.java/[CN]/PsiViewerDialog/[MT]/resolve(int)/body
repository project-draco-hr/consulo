{
  final PsiElement element=getPsiElement();
  if (element == null)   return null;
  Object o=myRefs.getClientProperty(REFS_CACHE);
  if (o == null) {
    myRefs.putClientProperty(REFS_CACHE,o=new HashMap());
  }
  HashMap map=(HashMap)o;
  Object cache=map.get(element);
  if (cache == null) {
    final PsiReference[] references=element.getReferences();
    cache=new PsiElement[references.length];
    for (int i=0; i < references.length; i++) {
      ((PsiElement[])cache)[i]=references[i].resolve();
    }
    map.put(element,cache);
  }
  PsiElement[] elements=(PsiElement[])cache;
  return index >= elements.length ? null : elements[index];
}
