{
  final String text=myEditor.getDocument().getText();
  if ("".equals(text.trim())) {
    return;
  }
  myLastParsedText=text;
  PsiElement rootElement=null;
  try {
    for (    JRadioButton button : myExtensionButtons) {
      if (button.isSelected()) {
        PsiViewerExtension ext=(PsiViewerExtension)button.getClientProperty(EXTENSION_KEY);
        rootElement=ext.createElement(myProject,text);
      }
    }
    if (rootElement == null) {
      for (int i=0; i < myFileTypeButtons.length; i++) {
        JRadioButton fileTypeButton=myFileTypeButtons[i];
        if (fileTypeButton.isSelected()) {
          final FileType type=myFileTypes[i];
          if (type instanceof LanguageFileType) {
            final Language language=((LanguageFileType)type).getLanguage();
            final Language dialect=(Language)myDialectsComboBox.getSelectedItem();
            rootElement=PsiFileFactory.getInstance(myProject).createFileFromText("Dummy." + type.getDefaultExtension(),dialect == null ? language : dialect,text);
          }
 else {
            rootElement=PsiFileFactory.getInstance(myProject).createFileFromText("Dummy." + type.getDefaultExtension(),text);
          }
        }
      }
    }
  }
 catch (  IncorrectOperationException e1) {
    rootElement=null;
    Messages.showMessageDialog(myProject,e1.getMessage(),"Error",Messages.getErrorIcon());
  }
  ViewerTreeStructure structure=(ViewerTreeStructure)myTreeBuilder.getTreeStructure();
  structure.setRootPsiElement(rootElement);
  myTreeBuilder.updateFromRoot();
  myTree.setRootVisible(true);
  myTree.expandRow(0);
  myTree.setRootVisible(false);
}
