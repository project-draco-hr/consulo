{
  if (end == null || start == end) {
    return start;
  }
  final TextRange endRange=end.getTextRange();
  PsiElement parent=start.getContext();
  while (parent != null && !parent.getTextRange().contains(endRange)) {
    parent=parent.getContext();
  }
  return parent;
}
