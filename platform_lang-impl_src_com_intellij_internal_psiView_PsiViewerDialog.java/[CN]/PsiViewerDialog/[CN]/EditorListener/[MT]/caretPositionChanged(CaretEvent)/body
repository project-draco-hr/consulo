{
  if (!available() || myEditor.getSelectionModel().hasSelection())   return;
  final ViewerTreeStructure treeStructure=(ViewerTreeStructure)myPsiTreeBuilder.getTreeStructure();
  final PsiElement rootPsiElement=treeStructure.getRootPsiElement();
  if (rootPsiElement == null)   return;
  final PsiElement rootElement=((ViewerTreeStructure)myPsiTreeBuilder.getTreeStructure()).getRootPsiElement();
  int baseOffset=rootPsiElement.getTextRange().getStartOffset();
  final int offset=myEditor.getCaretModel().getOffset() + baseOffset;
  final PsiElement element=InjectedLanguageFacadeImpl.findElementAtNoCommit(rootElement.getContainingFile(),offset);
  if (element != null && myBlockTreeBuilder != null) {
    TextRange rangeInHostFile=InjectedLanguageManager.getInstance(myProject).injectedToHost(element,element.getTextRange());
    selectBlockNode(findBlockNode(rangeInHostFile,true));
  }
  myPsiTreeBuilder.select(element);
}
