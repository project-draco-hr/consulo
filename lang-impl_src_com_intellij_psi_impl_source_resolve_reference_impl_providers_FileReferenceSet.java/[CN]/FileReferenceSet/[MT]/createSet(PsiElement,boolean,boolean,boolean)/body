{
  String text;
  int offset;
  if (element instanceof XmlAttributeValue) {
    text=((XmlAttributeValue)element).getValue();
    String s=element.getText();
    offset=StringUtil.startsWithChar(s,'"') || StringUtil.startsWithChar(s,'\'') ? 1 : 0;
  }
 else   if (element instanceof XmlTag) {
    final XmlTag tag=((XmlTag)element);
    text=tag.getValue().getTrimmedText();
    offset=XmlUtil.getTextRangeInTagValue(tag).getStartOffset();
  }
 else {
    return null;
  }
  if (text == null) {
    return null;
  }
  for (  final FileReferenceHelper helper : FileReferenceHelperRegistrar.getHelpers()) {
    text=helper.trimUrl(text);
  }
  return new FileReferenceSet(text,element,offset,ReferenceType.FILE_TYPE,null,true,endingSlashNotAllowed){
    protected boolean isUrlEncoded(){
      return urlEncoded;
    }
    protected boolean isSoft(){
      return soft;
    }
  }
;
}
