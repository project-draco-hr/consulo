{
  LOG.assertTrue(mySubExpression.isValid());
  PsiExpression expression;
  if (mySubExpressionValue == null) {
    expression=mySubExpression;
  }
 else {
    PsiExpression constExpression=PsiManager.getInstance(project).getElementFactory().createExpressionFromText(mySubExpressionValue.toString(),mySubExpression);
    LOG.assertTrue(constExpression.isValid());
    expression=(PsiExpression)mySubExpression.replace(constExpression);
  }
  while (expression.getParent() instanceof PsiExpression) {
    expression=(PsiExpression)expression.getParent();
  }
  PsiExpression newExpression=simplifyExpression(expression);
  expression.replace(newExpression);
}
