{
  final String lowercaseProductName=ApplicationNamesInfo.getInstance().getLowercaseProductName();
  final String systemLafClassName=UIManager.getSystemLookAndFeelClassName();
  if (SystemInfo.isMac) {
    UIManager.LookAndFeelInfo laf=findLaf(systemLafClassName);
    LOG.assertTrue(laf != null);
    return laf;
  }
  if ("Rubymine".equals(lowercaseProductName) || "Pycharm".equals(lowercaseProductName)) {
    final String desktop=AccessController.doPrivileged(new GetPropertyAction("sun.desktop"));
    if ("gnome".equals(desktop)) {
      UIManager.LookAndFeelInfo laf=findLaf(systemLafClassName);
      if (laf != null) {
        return laf;
      }
      LOG.info("Could not find system look and feel: " + laf);
    }
  }
  final String defaultLafName=StartupUtil.getDefaultLAF();
  if (defaultLafName != null) {
    UIManager.LookAndFeelInfo defaultLaf=findLaf(defaultLafName);
    if (defaultLaf != null) {
      return defaultLaf;
    }
  }
  UIManager.LookAndFeelInfo ideaLaf=findLaf(IDEA_LAF_CLASS_NAME);
  if (ideaLaf != null) {
    return ideaLaf;
  }
  throw new IllegalStateException("No default look&feel found");
}
