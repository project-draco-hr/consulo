{
  super.update(e);
  final DataContext dataContext=e.getDataContext();
  final Project project=(Project)dataContext.getData(DataConstants.PROJECT);
  final Presentation presentation=e.getPresentation();
  if (presentation.isEnabled()) {
    final IdeView view=(IdeView)dataContext.getData(DataConstantsEx.IDE_VIEW);
    final ProjectFileIndex projectFileIndex=ProjectRootManager.getInstance(project).getFileIndex();
    final PsiDirectory[] dirs=view.getDirectories();
    for (int i=0; i < dirs.length; i++) {
      final PsiDirectory dir=dirs[i];
      if (projectFileIndex.isInSourceContent(dir.getVirtualFile()) && dir.getPackage() != null) {
        return;
      }
    }
    presentation.setEnabled(false);
    presentation.setVisible(false);
  }
}
