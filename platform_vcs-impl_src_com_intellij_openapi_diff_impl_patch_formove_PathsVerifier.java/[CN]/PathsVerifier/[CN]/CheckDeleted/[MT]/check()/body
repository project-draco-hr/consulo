{
  final VirtualFile beforeFile=myBaseMapper.getFile(myPatch,myBeforeName);
  if (!checkExistsAndValid(beforeFile,myBeforeName)) {
    return false;
  }
  addPatch(myPatch,beforeFile);
  final FilePathImpl filePath=new FilePathImpl(beforeFile.getParent(),beforeFile.getName(),beforeFile.isDirectory());
  if (myPatch.isDeletedFile() || myPatch.getAfterName() == null) {
    myDeletedPaths.add(filePath);
  }
  myBeforePaths.add(filePath);
  return true;
}
