{
  Module module=VfsUtil.getModuleForFile(myProject,file);
  if (module == null) {
    for (Iterator it=myRootToModuleMap.keySet().iterator(); it.hasNext(); ) {
      VirtualFile root=(VirtualFile)it.next();
      if (VfsUtil.isAncestor(root,file,false)) {
        module=myRootToModuleMap.get(root);
        break;
      }
    }
  }
  return module;
}
