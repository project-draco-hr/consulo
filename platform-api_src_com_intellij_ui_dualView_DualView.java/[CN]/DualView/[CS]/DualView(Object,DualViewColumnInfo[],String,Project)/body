{
  super(new CardLayout());
  myTreeStorage=new Storage.PropertiesComponentStorage(columnServiceKey + "_tree",PropertiesComponent.getInstance(project));
  myFlatStorage=new Storage.PropertiesComponentStorage(columnServiceKey + "_flat",PropertiesComponent.getInstance(project));
  myCardLayout=(CardLayout)getLayout();
  add(createTreeComponent(columns,(TreeNode)root),TREE);
  add(createFlatComponent(columns),FLAT);
  (myTreeView.getTreeViewModel()).addTreeModelListener(new TreeModelListener(){
    public void treeNodesInserted(    TreeModelEvent e){
      refreshFlatModel();
    }
    public void treeNodesRemoved(    TreeModelEvent e){
      refreshFlatModel();
    }
    public void treeStructureChanged(    TreeModelEvent e){
      refreshFlatModel();
    }
    public void treeNodesChanged(    TreeModelEvent e){
      refreshFlatModel();
    }
  }
);
  setRootVisible(true);
  switchToTheFlatMode();
  restoreState();
  myPropertyChangeListener=new PropertyChangeListener(){
    public void propertyChange(    PropertyChangeEvent evt){
      saveState();
    }
  }
;
  addWidthListenersTo(myTreeView);
  addWidthListenersTo(myFlatView);
}
