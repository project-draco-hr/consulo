{
  PsiUtil.shortenReferences((GroovyPsiElement)generatedClass);
  CreateClassActionBase.putCursor(project,generatedClass.getContainingFile(),generatedClass);
  final String text=map.getText();
  int begin=0;
  int end=text.length();
  if (text.startsWith("["))   begin++;
  if (text.endsWith("]"))   end--;
  final GrExpression newExpression=GroovyPsiElementFactory.getInstance(project).createExpressionFromText("new " + generatedClass.getQualifiedName() + "("+ text.substring(begin,end)+ ")");
  final GrExpression replacedNewExpression=((GrExpression)map.replace(newExpression));
  final PsiElement parent=PsiUtil.skipParentheses(replacedNewExpression.getParent(),true);
  if (parent instanceof GrVariable && !(parent instanceof GrField) && !(parent instanceof GrParameter)&& ((GrVariable)parent).getDeclaredType() != null && replacedNewExpression.getType() != null) {
    ((GrVariable)parent).setType(replacedNewExpression.getType());
  }
  PsiUtil.shortenReferences(replacedNewExpression);
}
