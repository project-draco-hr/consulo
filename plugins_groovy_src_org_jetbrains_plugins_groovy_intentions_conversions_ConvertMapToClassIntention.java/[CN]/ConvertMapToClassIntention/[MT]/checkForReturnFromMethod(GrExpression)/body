{
  final PsiElement parent=PsiUtil.skipParentheses(replacedNewExpression.getParent(),true);
  final GrMethod method=PsiTreeUtil.getParentOfType(replacedNewExpression,GrMethod.class,true,GrClosableBlock.class);
  if (method == null)   return;
  final List<GrStatement> returns=ControlFlowUtils.collectReturns(method.getBlock());
  if (returns.size() > 1 || !returns.contains(parent))   return;
  if (method.getReturnTypeElementGroovy() == null)   return;
  final PsiType returnType=method.getReturnType();
  final PsiType type=replacedNewExpression.getType();
  if (TypesUtil.isAssignable(returnType,type,replacedNewExpression.getManager(),replacedNewExpression.getResolveScope()))   return;
  method.setReturnType(type);
}
