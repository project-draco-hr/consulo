{
  final List<RepositoryLocationGroup> groups=new ArrayList<RepositoryLocationGroup>();
  final List<RepositoryLocation> singles=new ArrayList<RepositoryLocation>();
  final MultiMap<Object,RepositoryLocation> map=new MultiMap<Object,RepositoryLocation>();
  for (  RepositoryLocation location : in) {
    final Object key=myGroupCreator.createKey(location);
    map.putValue(key,location);
  }
  final Set<Object> keys=map.keySet();
  for (  Object key : keys) {
    final Collection<RepositoryLocation> locations=map.get(key);
    if (locations.size() == 1) {
      singles.addAll(locations);
    }
 else {
      final RepositoryLocationGroup group=myGroupCreator.createGroup(key,locations);
      groups.add(group);
    }
  }
  return new Pair<List<RepositoryLocationGroup>,List<RepositoryLocation>>(groups,singles);
}
