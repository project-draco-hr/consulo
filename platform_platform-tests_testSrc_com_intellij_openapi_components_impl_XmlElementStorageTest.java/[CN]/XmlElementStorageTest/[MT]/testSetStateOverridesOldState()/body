{
  MyXmlElementStorage storage=new MyXmlElementStorage(document(tag("root",tag("component",attr("name","test"),tag("foo")))),myParentDisposable);
  Element newState=tag("component",attr("name","test"),tag("bar"));
  StateStorage.ExternalizationSession externalizationSession=storage.startExternalization();
  externalizationSession.setState(this,"test",newState,null);
  storage.startSave(externalizationSession).save();
  assertNotNull(storage.mySavedDocument);
  assertNotNull(storage.mySavedDocument.getRootElement().getChild("component").getChild("bar"));
  assertNull(storage.mySavedDocument.getRootElement().getChild("component").getChild("foo"));
}
