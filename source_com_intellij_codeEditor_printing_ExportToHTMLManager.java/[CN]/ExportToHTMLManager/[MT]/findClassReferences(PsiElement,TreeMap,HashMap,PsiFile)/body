{
  PsiReference ref=psiElement.getReference();
  if (ref instanceof PsiJavaCodeReferenceElement) {
    PsiElement refElement=ref.resolve();
    if (refElement instanceof PsiClass) {
      PsiFile containingFile=refElement.getContainingFile();
      if (!containingFile.equals(psiFile) && filesMap.get(containingFile) != null) {
        TextRange textRange=psiElement.getTextRange();
        refMap.put(new Integer(textRange.getStartOffset()),ref);
      }
      return;
    }
  }
  PsiElement[] children=psiElement.getChildren();
  for (int i=0; i < children.length; i++) {
    findClassReferences(children[i],refMap,filesMap,psiFile);
  }
}
