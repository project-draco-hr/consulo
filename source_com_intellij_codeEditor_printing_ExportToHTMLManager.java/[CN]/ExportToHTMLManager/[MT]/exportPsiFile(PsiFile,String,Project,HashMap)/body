{
  ExportToHTMLSettings exportToHTMLSettings=ExportToHTMLSettings.getInstance(project);
  if (psiFile instanceof PsiBinaryFile) {
    return true;
  }
  TreeMap refMap=null;
  if (exportToHTMLSettings.isGenerateHyperlinksToClasses()) {
    FileType fileType=psiFile.getFileType();
    if (StdFileTypes.JAVA == fileType || StdFileTypes.JSP == fileType) {
      refMap=new TreeMap(new Comparator(){
        public int compare(        Object o1,        Object o2){
          if (o1 instanceof Integer && o2 instanceof Integer) {
            return ((Integer)o1).intValue() - ((Integer)o2).intValue();
          }
          return 0;
        }
      }
);
      findClassReferences(psiFile,refMap,filesMap,psiFile);
    }
  }
  String dirName=constructOutputDirectory(psiFile,outputDirectoryName);
  HTMLTextPainter textPainter=new HTMLTextPainter(psiFile,project,dirName,exportToHTMLSettings.PRINT_LINE_NUMBERS);
  try {
    textPainter.paint(refMap,psiFile.getFileType());
  }
 catch (  FileNotFoundException e) {
    myLastException=e;
    return false;
  }
  return true;
}
