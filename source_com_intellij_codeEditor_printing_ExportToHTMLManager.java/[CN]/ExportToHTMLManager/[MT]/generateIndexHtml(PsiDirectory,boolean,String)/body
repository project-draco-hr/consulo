{
  OutputStreamWriter writer;
  try {
    String indexHtmlName=constructOutputDirectory(psiDirectory,outputDirectoryName) + File.separator + "index.html";
    writer=new OutputStreamWriter(new FileOutputStream(indexHtmlName),"UTF-8");
    writer.write("<html><head><title>" + psiDirectory.getPackage().getQualifiedName() + "</title></head><body>");
    if (recursive) {
      PsiDirectory[] directories=psiDirectory.getSubdirectories();
      for (      PsiDirectory directory : directories) {
        writer.write("<a href=\"" + directory.getName() + "/index.html\"><b>"+ directory.getName()+ "</b></a><br />");
      }
    }
    PsiFile[] files=psiDirectory.getFiles();
    for (    PsiFile file : files) {
      if (!(file instanceof PsiBinaryFile)) {
        writer.write("<a href=\"" + getHTMLFileName(file) + "\">"+ file.getVirtualFile().getName()+ "</a><br />");
      }
    }
    writer.write("</body></html>");
    writer.close();
  }
 catch (  IOException e) {
    LOG.error(e.getMessage(),e);
    return;
  }
}
