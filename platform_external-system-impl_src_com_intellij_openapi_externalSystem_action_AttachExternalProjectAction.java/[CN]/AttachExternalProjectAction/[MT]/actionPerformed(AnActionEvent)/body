{
  ProjectSystemId externalSystemId=ExternalSystemDataKeys.EXTERNAL_SYSTEM_ID.getData(e.getDataContext());
  if (externalSystemId == null) {
    return;
  }
  ExternalSystemManager<?,?,?,?,?> manager=ExternalSystemApiUtil.getManager(externalSystemId);
  if (manager == null) {
    return;
  }
  Project project=CommonDataKeys.PROJECT.getData(e.getDataContext());
  if (project == null) {
    return;
  }
  ProjectImportProvider[] projectImportProviders=new ProjectImportProvider[1];
  for (  ProjectImportProvider provider : ProjectImportProvider.PROJECT_IMPORT_PROVIDER.getExtensions()) {
    if (provider instanceof AbstractExternalProjectImportProvider && externalSystemId.equals(((AbstractExternalProjectImportProvider)provider).getExternalSystemId())) {
      projectImportProviders[0]=provider;
      break;
    }
  }
  if (projectImportProviders[0] == null) {
    return;
  }
  AddModuleWizard wizard=ImportModuleAction.selectFileAndCreateWizard(project,null,manager.getExternalProjectDescriptor(),projectImportProviders);
  if (wizard != null && (wizard.getStepCount() <= 0 || wizard.showAndGet())) {
    ImportModuleAction.createFromWizard(project,wizard);
  }
}
