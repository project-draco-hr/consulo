{
  if (log.isDebugEnabled())   log.debug("Filtering fields using the pattern: " + pattern);
  List<PsiField> availableFields=new ArrayList<PsiField>();
  PsiField[] fields=psi.getFields(clazz);
  for (  PsiField field : fields) {
    FieldElement fe=ElementFactory.newFieldElement(project,field,psi);
    if (log.isDebugEnabled())     log.debug("Field being filtered: " + fe);
    if (!fe.applyFilter(pattern)) {
      availableFields.add(field);
    }
  }
  return availableFields.toArray(new PsiField[availableFields.size()]);
}
