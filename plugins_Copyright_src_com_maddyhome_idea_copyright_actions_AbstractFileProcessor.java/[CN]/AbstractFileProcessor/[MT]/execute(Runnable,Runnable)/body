{
  final ProgressWindow progressWindow=new ProgressWindow(true,myProject);
  progressWindow.setTitle(title);
  progressWindow.setText(message);
  try {
    ProgressManager.getInstance().runProcess(readAction,progressWindow);
  }
 catch (  ProcessCanceledException processcanceledexception) {
    return;
  }
  new WriteCommandAction(myProject,title,null){
    protected void run(    Result result) throws Throwable {
      CommandProcessor.getInstance().markCurrentCommandAsComplex(myProject);
      writeAction.run();
    }
  }
.execute();
}
