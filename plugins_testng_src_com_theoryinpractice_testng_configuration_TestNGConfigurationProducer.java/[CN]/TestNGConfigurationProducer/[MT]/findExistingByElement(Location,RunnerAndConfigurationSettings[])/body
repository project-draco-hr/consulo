{
  final Module predefinedModule=((TestNGConfiguration)((RunManagerImpl)RunManagerEx.getInstanceEx(location.getProject())).getConfigurationTemplate(getConfigurationFactory()).getConfiguration()).getConfigurationModule().getModule();
  for (  RunnerAndConfigurationSettings existingConfiguration : existingConfigurations) {
    TestNGConfiguration config=(TestNGConfiguration)existingConfiguration.getConfiguration();
    TestData testobject=config.getPersistantData();
    if (testobject != null) {
      final PsiElement element=location.getPsiElement();
      if (testobject.isConfiguredByElement(element)) {
        final Module configurationModule=config.getConfigurationModule().getModule();
        if (Comparing.equal(location.getModule(),configurationModule))         return existingConfiguration;
        if (Comparing.equal(predefinedModule,configurationModule)) {
          return existingConfiguration;
        }
      }
    }
  }
  return null;
}
