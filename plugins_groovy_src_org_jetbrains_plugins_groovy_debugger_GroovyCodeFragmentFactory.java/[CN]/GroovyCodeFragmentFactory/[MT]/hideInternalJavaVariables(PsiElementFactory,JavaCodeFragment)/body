{
  final String varPrefix="_$$_$$$_$$$$$$$$$_" + new Random().nextInt(42);
  result.accept(new PsiRecursiveElementWalkingVisitor(){
    @Override public void visitElement(    PsiElement element){
      if (element instanceof PsiReferenceExpression && ((PsiReferenceExpression)element).resolve() instanceof PsiLocalVariable) {
        element.replace(factory.createExpressionFromText(varPrefix + element.getText(),element));
      }
      super.visitElement(element);
    }
  }
);
  result.accept(new PsiRecursiveElementWalkingVisitor(){
    @Override public void visitElement(    PsiElement element){
      if (element instanceof PsiLocalVariable) {
        ((PsiLocalVariable)element).setName(varPrefix + ((PsiLocalVariable)element).getName());
      }
      super.visitElement(element);
    }
  }
);
}
