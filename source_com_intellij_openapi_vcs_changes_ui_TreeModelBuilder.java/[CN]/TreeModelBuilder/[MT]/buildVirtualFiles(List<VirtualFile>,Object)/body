{
  ChangesBrowserNode baseNode;
  if (tag != null) {
    baseNode=ChangesBrowserNode.create(myProject,tag);
    model.insertNodeInto(baseNode,root,root.getChildCount());
  }
 else {
    baseNode=root;
  }
  final HashMap<FilePath,ChangesBrowserNode> foldersCache=new HashMap<FilePath,ChangesBrowserNode>();
  final HashMap<Module,ChangesBrowserNode> moduleCache=new HashMap<Module,ChangesBrowserNode>();
  for (  VirtualFile file : files) {
    insertChangeNode(file,foldersCache,moduleCache,baseNode);
  }
}
