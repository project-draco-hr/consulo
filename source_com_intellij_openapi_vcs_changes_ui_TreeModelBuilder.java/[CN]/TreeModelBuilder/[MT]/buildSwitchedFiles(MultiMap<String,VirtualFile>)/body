{
  ChangesBrowserNode baseNode=ChangesBrowserNode.create(myProject,ChangesListView.SWITCHED_FILES_TAG);
  model.insertNodeInto(baseNode,root,root.getChildCount());
  for (  String branchName : switchedFiles.keySet()) {
    final List<VirtualFile> switchedFileList=switchedFiles.get(branchName);
    if (switchedFileList.size() > 0) {
      ChangesBrowserNode branchNode=ChangesBrowserNode.create(myProject,branchName);
      model.insertNodeInto(branchNode,baseNode,baseNode.getChildCount());
      final HashMap<FilePath,ChangesBrowserNode> foldersCache=new HashMap<FilePath,ChangesBrowserNode>();
      final HashMap<Module,ChangesBrowserNode> moduleCache=new HashMap<Module,ChangesBrowserNode>();
      for (      VirtualFile file : switchedFileList) {
        insertChangeNode(file,foldersCache,moduleCache,branchNode);
      }
    }
  }
}
