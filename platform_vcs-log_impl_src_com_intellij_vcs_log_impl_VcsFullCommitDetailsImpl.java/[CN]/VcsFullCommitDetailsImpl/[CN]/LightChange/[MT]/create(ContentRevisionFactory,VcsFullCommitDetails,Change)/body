{
  LightChange lc=new LightChange();
  Change.Type type=change.getType();
  lc.myModification=type == Change.Type.MODIFICATION;
  lc.myContentRevisionFactory=contentRevisionFactory;
  ContentRevision before=change.getBeforeRevision();
  if (before != null && !lc.myModification) {
    FilePath filePath=before.getFile();
    if (filePath.getVirtualFile() == null) {
      lc.myBeforePath=filePath.getIOFile().getPath();
    }
 else {
      lc.myBeforeFile=filePath.getVirtualFile();
    }
  }
  ContentRevision after=change.getAfterRevision();
  if (after != null) {
    FilePath filePath=after.getFile();
    if (filePath.getVirtualFile() == null) {
      lc.myAfterPath=filePath.getIOFile().getPath();
    }
 else {
      lc.myAfterFile=filePath.getVirtualFile();
    }
  }
  lc.myDetails=details;
  return lc;
}
