{
  LocalHistoryAction action=LvcsIntegration.checkinFilesBeforeRefactoring(myProject,getCommandName());
  PsiClass anInterface=null;
  try {
    anInterface=extractInterface(myTargetDir,myClass,myInterfaceName,mySelectedMembers,myJavaDocPolicy);
  }
 catch (  IncorrectOperationException ex) {
    throw ex;
  }
 finally {
    LvcsIntegration.checkinFilesAfterRefactoring(myProject,action);
  }
  if (anInterface != null) {
    ExtractClassUtil.askAndTurnRefsToSuper(myProject,myClass,anInterface);
  }
}
