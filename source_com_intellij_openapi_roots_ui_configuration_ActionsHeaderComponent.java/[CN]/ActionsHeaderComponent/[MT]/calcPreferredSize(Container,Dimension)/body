{
  final Component[] components=container.getComponents();
  int maxWidth=0;
  int maxHeight=0;
  for (int idx=0; idx < components.length; idx++) {
    Component component=components[idx];
    if (component instanceof Container) {
      calcPreferredSize((Container)component,dimension);
      maxWidth=Math.max(maxWidth,dimension.width);
      maxHeight=Math.max(maxHeight,dimension.height);
    }
 else {
      final Dimension preferredSize=component.getPreferredSize();
      maxWidth=Math.max(maxWidth,preferredSize.width);
      maxHeight=Math.max(maxHeight,preferredSize.height);
    }
  }
  final Dimension preferredSize=container.getPreferredSize();
  dimension.width=Math.max(maxWidth,preferredSize.width);
  dimension.height=Math.max(maxHeight,preferredSize.height);
}
