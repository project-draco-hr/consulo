{
  final DataContext dc=e.getDataContext();
  if ((!isVisible(dc)) || (!isEnabled(dc)))   return;
  final Project project=PlatformDataKeys.PROJECT.getData(dc);
  final Iterable<VirtualFilePointer> iterable=VcsDataKeys.UPDATE_VIEW_FILES_ITERABLE.getData(dc);
  final Checkpoint before=(Checkpoint)VcsDataKeys.CHECKPOINT_BEFORE.getData(dc);
  final Checkpoint after=(Checkpoint)VcsDataKeys.CHECKPOINT_AFTER.getData(dc);
  final String selectedUrl=VcsDataKeys.UPDATE_VIEW_SELECTED_PATH.getData(dc);
  ShowDiffAction.showDiffForChange(new MyIterableWrapper(iterable.iterator(),before,after),new MySelectionMarker(selectedUrl),project,ShowDiffAction.DiffExtendUIFactory.NONE,true);
}
