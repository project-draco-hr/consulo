{
  Object newElement=updateElement();
  boolean changed=false;
  if (getElement() != newElement) {
    presentation.setChanged(true);
  }
  if (newElement == null)   return;
  Color oldColor=myColor;
  String oldName=myName;
  Icon oldOpenIcon=myOpenIcon;
  Icon oldClosedIcon=myClosedIcon;
  List<ColoredFragment> oldFragments=new ArrayList<ColoredFragment>(presentation.getColoredText());
  myColor=Color.black;
  updateFileStatus();
  doUpdate();
  myName=getName();
  presentation.setPresentableText(myName);
  presentation.setChanged(changed || !Comparing.equal(new Object[]{myOpenIcon,myClosedIcon,myName,oldFragments,myColor},new Object[]{oldOpenIcon,oldClosedIcon,oldName,oldFragments,oldColor}));
  presentation.setForcedTextForeground(myColor);
  presentation.setOpenIcon(myOpenIcon);
  presentation.setClosedIcon(myClosedIcon);
}
