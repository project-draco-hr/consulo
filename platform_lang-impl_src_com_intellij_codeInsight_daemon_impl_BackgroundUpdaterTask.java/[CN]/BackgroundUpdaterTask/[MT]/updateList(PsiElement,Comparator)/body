{
  if (myCanceled)   return;
synchronized (lock) {
    myData.add(element);
  }
  myAlarm.addRequest(new Runnable(){
    @Override public void run(){
      myAlarm.cancelAllRequests();
      if (myCanceled)       return;
      ArrayList<PsiElement> data=new ArrayList<PsiElement>();
synchronized (lock) {
        if (comparator != null) {
          Collections.sort(myData,comparator);
        }
        data.addAll(myData);
      }
      replaceModel(data);
      myPopup.getContent().revalidate();
      myPopup.pack(true,true);
      myPopup.getContent().repaint();
      myPopup.setCaption(getCaption(getCurrentSize()));
    }
  }
,10,ModalityState.stateForComponent(myPopup.getContent()));
}
