{
  if (!myShouldUpdatePreview) {
    return;
  }
  if (myLastDocumentModificationStamp != myEditor.getDocument().getModificationStamp()) {
    myTextToReformat=myEditor.getDocument().getText();
  }
  CommandProcessor.getInstance().executeCommand(ProjectManager.getInstance().getDefaultProject(),new Runnable(){
    public void run(){
      replaceText();
    }
  }
,null,null);
  myEditor.getSettings().setRightMargin(getRightMargin());
  myLastDocumentModificationStamp=myEditor.getDocument().getModificationStamp();
}
