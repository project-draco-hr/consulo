{
  List<NewVirtualFile> roots;
synchronized (LOCK) {
    roots=new ArrayList<NewVirtualFile>(myRoots.values());
    final Iterator<NewVirtualFile> it=roots.iterator();
    while (it.hasNext()) {
      NewVirtualFile file=it.next();
      if (!file.isInLocalFileSystem()) {
        it.remove();
      }
    }
  }
  return roots.toArray(new VirtualFile[roots.size()]);
}
