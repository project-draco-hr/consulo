{
  final NewVirtualFileSystem delegate=getDelegate(file);
  delegate.renameFile(requestor,file,newName);
  if (!delegate.exists(file)) {
    processEvent(new VFilePropertyChangeEvent(requestor,file,VirtualFile.PROP_NAME,file.getName(),newName,false));
  }
 else {
    processEvent(new VFileCreateEvent(requestor,file.getParent(),newName,file.isDirectory(),false));
  }
}
