{
  boolean canceled=true;
  try {
    task.run(pi);
    canceled=pi != null && pi.isCanceled();
  }
 catch (  ProcessCanceledException e) {
  }
 finally {
    if (pooledContinuation != null) {
      pooledContinuation.run();
    }
  }
  final boolean finalCanceled=canceled;
  UIUtil.invokeLaterIfNeeded(new Runnable(){
    public void run(){
      if (finalCanceled) {
        task.onCancel();
      }
 else {
        task.onSuccess();
      }
    }
  }
);
}
