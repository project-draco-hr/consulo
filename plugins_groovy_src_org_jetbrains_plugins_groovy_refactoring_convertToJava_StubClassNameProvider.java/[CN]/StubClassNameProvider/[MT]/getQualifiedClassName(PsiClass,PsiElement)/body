{
  if (context != null && psiClass != null) {
    psiClass=GenerationUtil.findAccessibleSuperClass(context,psiClass);
  }
  if (psiClass == null) {
    return CommonClassNames.JAVA_LANG_OBJECT;
  }
  if (psiClass instanceof GrTypeDefinition) {
    if (!myAllToCompile.contains(psiClass.getContainingFile().getVirtualFile())) {
      final PsiClass container=psiClass.getContainingClass();
      if (container != null) {
        return getQualifiedClassName(container,null) + "$" + psiClass.getName();
      }
    }
  }
  final String name=psiClass.getQualifiedName();
  if (name != null)   return name;
  return psiClass.getName();
}
