{
  if (content != null) {
    try {
      String s=(String)content.getTransferData(DataFlavor.stringFlavor);
      s=StringUtil.convertLineSeparators(s,"\n");
      int caretOffset=editor.getCaretModel().getOffset();
      insertStringAtCaret(editor,s,false,true);
      return new TextRange(caretOffset,caretOffset + s.length());
    }
 catch (    Exception exception) {
      editor.getComponent().getToolkit().beep();
    }
  }
  return null;
}
