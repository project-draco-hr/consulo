{
  if (elements.isEmpty())   return true;
  Set<VirtualFile> files=new THashSet<VirtualFile>();
  Project project=null;
  for (  PsiElement element : elements) {
    PsiFile file=element.getContainingFile();
    if (file == null)     continue;
    VirtualFile virtualFile=file.getVirtualFile();
    if (virtualFile == null)     continue;
    files.add(virtualFile);
    project=element.getProject();
  }
  VirtualFile[] virtualFiles=files.toArray(new VirtualFile[files.size()]);
  ReadonlyStatusHandler.OperationStatus status=ReadonlyStatusHandler.getInstance(project).ensureFilesWritable(virtualFiles);
  return !status.hasReadonlyFiles();
}
