{
  if (startOffset == endOffset)   return null;
  final PsiElement left=findElementAtInRoot(root,startOffset);
  PsiElement right=findElementAtInRoot(root,endOffset - 1);
  if (left == null || right == null)   return null;
  PsiElement commonParent=PsiTreeUtil.findCommonParent(left,right);
  LOG.assertTrue(commonParent != null);
  LOG.assertTrue(commonParent.getTextRange() != null);
  while (commonParent.getParent() != null && commonParent.getTextRange().equals(commonParent.getParent().getTextRange())) {
    commonParent=commonParent.getParent();
  }
  return commonParent;
}
