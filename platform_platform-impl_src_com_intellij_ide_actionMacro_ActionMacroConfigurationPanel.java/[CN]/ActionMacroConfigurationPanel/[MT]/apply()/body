{
  final ActionMacroManager manager=ActionMacroManager.getInstance();
  ActionMacro[] macros=manager.getAllMacros();
  HashSet<String> removedIds=new HashSet<String>();
  for (  ActionMacro macro1 : macros) {
    removedIds.add(macro1.getActionId());
  }
  manager.removeAllMacros();
  final Enumeration newMacros=myMacrosModel.elements();
  while (newMacros.hasMoreElements()) {
    ActionMacro macro=(ActionMacro)newMacros.nextElement();
    manager.addMacro(macro);
    removedIds.remove(macro.getActionId());
  }
  manager.registerActions();
  for (  String id : removedIds) {
    Keymap[] allKeymaps=KeymapManagerEx.getInstanceEx().getAllKeymaps();
    for (    Keymap keymap : allKeymaps) {
      keymap.removeAllActionShortcuts(id);
    }
  }
}
