{
  GitUnstashDialog d=new GitUnstashDialog(project,gitRoots,defaultRoot);
  d.show();
  if (!d.isOK()) {
    return;
  }
  affectedRoots.add(d.getGitRoot());
  GitLineHandler h=d.handler(false);
  final AtomicBoolean needToEscapedBraces=new AtomicBoolean(false);
  h.addLineListener(new GitLineHandlerAdapter(){
    public void onLineAvailable(    String line,    Key outputType){
      if (line.startsWith("fatal: Needed a single revision")) {
        needToEscapedBraces.set(true);
      }
    }
  }
);
  int rc=GitHandlerUtil.doSynchronously(h,GitBundle.getString("unstash.unstashing"),h.printableCommandLine(),false);
  if (needToEscapedBraces.get()) {
    h=d.handler(true);
    rc=GitHandlerUtil.doSynchronously(h,GitBundle.getString("unstash.unstashing"),h.printableCommandLine(),false);
  }
  if (rc != 0) {
    GitUIUtil.showOperationErrors(project,h.errors(),h.printableCommandLine());
  }
}
