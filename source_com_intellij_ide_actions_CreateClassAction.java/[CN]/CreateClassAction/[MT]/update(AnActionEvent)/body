{
  super.update(e);
  DataContext dataContext=e.getDataContext();
  Project project=(Project)dataContext.getData(DataConstants.PROJECT);
  Presentation presentation=e.getPresentation();
  if (presentation.isEnabled()) {
    IdeView view=(IdeView)dataContext.getData(DataConstantsEx.IDE_VIEW);
    ProjectFileIndex projectFileIndex=ProjectRootManager.getInstance(project).getFileIndex();
    PsiDirectory[] dirs=view.getDirectories();
    for (int i=0; i < dirs.length; i++) {
      PsiDirectory dir=dirs[i];
      if (projectFileIndex.isInSourceContent(dir.getVirtualFile()) && dir.getPackage() != null) {
        return;
      }
    }
    presentation.setEnabled(false);
    presentation.setVisible(false);
  }
}
