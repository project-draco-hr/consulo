{
  final DataFlowInstructionVisitor visitor=new DataFlowInstructionVisitor(dfaRunner);
  final RunnerResult rc=dfaRunner.analyzeMethod(scope,visitor,IGNORE_ASSERT_STATEMENTS,initialStates);
  if (rc == RunnerResult.OK) {
    createDescription(dfaRunner,holder,visitor);
    MultiMap<PsiElement,DfaMemoryState> nestedClosures=dfaRunner.getNestedClosures();
    for (    PsiElement closure : nestedClosures.keySet()) {
      analyzeDfaWithNestedClosures(closure,holder,dfaRunner,nestedClosures.get(closure));
    }
  }
 else   if (rc == RunnerResult.TOO_COMPLEX) {
    if (scope.getParent() instanceof PsiMethod) {
      PsiMethod method=(PsiMethod)scope.getParent();
      final PsiIdentifier name=method.getNameIdentifier();
      if (name != null) {
        holder.registerProblem(name,InspectionsBundle.message("dataflow.too.complex"),ProblemHighlightType.WEAK_WARNING);
      }
    }
  }
}
