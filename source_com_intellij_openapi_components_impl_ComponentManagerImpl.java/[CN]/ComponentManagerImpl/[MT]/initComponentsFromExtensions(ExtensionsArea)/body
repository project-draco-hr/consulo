{
  final boolean headless=ApplicationManager.getApplication().isHeadlessEnvironment();
  final ComponentDescriptor[] componentDescriptors=(ComponentDescriptor[])extensionsArea.getExtensionPoint(ExtensionPoints.COMPONENT).getExtensions();
  for (int i=0; i < componentDescriptors.length; i++) {
    ComponentDescriptor descriptor=componentDescriptors[i];
    final Map<String,String> options=descriptor.getOptionsMap();
    if (isComponentSuitable(options)) {
      ClassLoader loader=findLoader(descriptor.getPluginName());
      try {
        final String implementation=headless ? descriptor.getHeadlessImplementation() : descriptor.getImplementation();
        if (!StringUtil.isEmpty(implementation)) {
          registerComponent(Class.forName(descriptor.getInterface(),true,loader),Class.forName(implementation,true,loader),options,true,isTrue(options,"lazy"));
        }
      }
 catch (      Exception e) {
        LOG.error(new PluginException(e,PluginManager.getPlugin(descriptor.getPluginName())));
      }
catch (      Error e) {
        LOG.error(new PluginException(e,PluginManager.getPlugin(descriptor.getPluginName())));
      }
    }
  }
}
