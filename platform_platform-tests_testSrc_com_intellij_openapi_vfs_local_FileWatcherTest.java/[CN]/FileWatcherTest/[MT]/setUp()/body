{
  super.setUp();
  myWatcher=FileWatcher.getInstance();
  assertNotNull(myWatcher);
  assertFalse(myWatcher.isOperational());
  myWatcher.startup();
  assertTrue(myWatcher.isOperational());
  myFileSystem=LocalFileSystem.getInstance();
  assertNotNull(myFileSystem);
  myConnection=ApplicationManager.getApplication().getMessageBus().connect();
  myConnection.subscribe(VirtualFileManager.VFS_CHANGES,new BulkFileListener(){
    @Override public void before(    @NotNull List<? extends VFileEvent> events){
    }
    @Override public void after(    @NotNull List<? extends VFileEvent> events){
synchronized (myEvents) {
        myEvents.addAll(events);
        myEvents.notifyAll();
      }
    }
  }
);
}
