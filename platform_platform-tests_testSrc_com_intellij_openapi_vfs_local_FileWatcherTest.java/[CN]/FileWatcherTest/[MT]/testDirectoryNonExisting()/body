{
  File topDir=createTestDir("top");
  File subDir=new File(topDir,"subDir");
  File file=new File(subDir,"file.txt");
  refresh(topDir);
  LocalFileSystem.WatchRequest request=watch(subDir);
  try {
    myAccept=true;
    assertTrue(subDir.toString(),subDir.mkdir());
    assertEvent(VFileCreateEvent.class,subDir.getAbsolutePath());
    refresh(subDir);
    myAccept=true;
    FileUtil.writeToFile(file,"new content");
    assertEvent(VFileCreateEvent.class,file.getAbsolutePath());
  }
  finally {
    unwatch(request);
    delete(topDir);
  }
}
