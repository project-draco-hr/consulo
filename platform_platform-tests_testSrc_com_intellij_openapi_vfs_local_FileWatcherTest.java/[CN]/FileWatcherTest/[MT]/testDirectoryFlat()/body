{
  File topDir=createTestDir("top");
  File watchedFile=createTestFile(topDir,"test.txt");
  File subDir=createTestDir(topDir,"sub");
  File unwatchedFile=createTestFile(subDir,"test.txt");
  refresh(topDir);
  LocalFileSystem.WatchRequest request=watch(topDir,false);
  try {
    myAccept=true;
    FileUtil.writeToFile(watchedFile,"new content");
    assertEvent(VFileContentChangeEvent.class,watchedFile.getPath());
    myTimeout=10 * INTER_RESPONSE_DELAY;
    myAccept=true;
    FileUtil.writeToFile(unwatchedFile,"new content");
    assertEvent(VFileEvent.class);
    myTimeout=NATIVE_PROCESS_DELAY;
  }
  finally {
    unwatch(request);
    delete(topDir);
  }
}
