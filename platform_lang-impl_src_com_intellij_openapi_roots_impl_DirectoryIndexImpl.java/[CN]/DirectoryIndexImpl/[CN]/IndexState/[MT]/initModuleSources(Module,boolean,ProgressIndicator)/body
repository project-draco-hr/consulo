{
  assertWritable();
  progress.checkCanceled();
  progress.setText2(ProjectBundle.message("project.index.processing.module.sources.progress",module.getName()));
  ContentEntry[] contentEntries=getContentEntries(module);
  if (reverseAllSets) {
    contentEntries=ArrayUtil.reverseArray(contentEntries);
  }
  for (  ContentEntry contentEntry : contentEntries) {
    VirtualFile contentRoot=contentEntry.getFile();
    ContentFolder[] folders=contentEntry.getFolders(ContentFolderType.SOURCE_FOLDER_TYPES);
    if (reverseAllSets) {
      folders=ArrayUtil.reverseArray(folders);
    }
    for (    ContentFolder sourceFolder : folders) {
      VirtualFile dir=sourceFolder.getFile();
      if (dir instanceof NewVirtualFile && contentRoot instanceof NewVirtualFile) {
        fillMapWithModuleSource(module,(NewVirtualFile)contentRoot,(NewVirtualFile)dir,"",(NewVirtualFile)dir,sourceFolder.getType(),progress);
      }
    }
  }
}
