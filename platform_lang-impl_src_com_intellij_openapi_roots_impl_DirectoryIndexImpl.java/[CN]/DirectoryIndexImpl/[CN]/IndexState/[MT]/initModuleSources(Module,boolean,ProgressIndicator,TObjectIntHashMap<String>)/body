{
  assertWritable();
  progress.checkCanceled();
  progress.setText2(ProjectBundle.message("project.index.processing.module.sources.progress",module.getName()));
  ContentEntry[] contentEntries=getContentEntries(module);
  if (reverseAllSets) {
    contentEntries=ArrayUtil.reverseArray(contentEntries);
  }
  for (  ContentEntry contentEntry : contentEntries) {
    VirtualFile contentRoot=contentEntry.getFile();
    ContentFolder[] sourceFolders=contentEntry.getFolders(ContentFolderScopes.all(false));
    if (reverseAllSets) {
      sourceFolders=ArrayUtil.reverseArray(sourceFolders);
    }
    for (    ContentFolder sourceFolder : sourceFolders) {
      VirtualFile dir=sourceFolder.getFile();
      if (dir instanceof NewVirtualFile && contentRoot instanceof NewVirtualFile) {
        int rootTypeId=getRootTypeId(sourceFolder);
        fillMapWithModuleSource(module,(NewVirtualFile)contentRoot,(NewVirtualFile)dir,"",(NewVirtualFile)dir,rootTypeId,progress,interned);
      }
    }
  }
}
