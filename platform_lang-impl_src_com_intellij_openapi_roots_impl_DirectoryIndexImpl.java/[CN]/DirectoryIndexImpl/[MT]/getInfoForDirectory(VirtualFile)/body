{
  checkAvailability();
  dispatchPendingEvents();
  if (!(dir instanceof NewVirtualFile))   return null;
  RootIndex rootIndex=getRootIndex();
  DirectoryInfo riInfo=rootIndex != null ? rootIndex.getInfoForDirectory(dir) : null;
  if (ourUseRootIndexOnly) {
    return riInfo;
  }
  return assertConsistentResult(dir,riInfo,myState.getInfo(((NewVirtualFile)dir).getId()));
}
