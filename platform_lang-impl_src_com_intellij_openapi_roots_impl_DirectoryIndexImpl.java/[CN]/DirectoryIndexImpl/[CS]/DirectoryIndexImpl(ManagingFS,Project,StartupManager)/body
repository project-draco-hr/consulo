{
  myPersistence=managingFS;
  myProject=project;
  myConnection=project.getMessageBus().connect(project);
  myExcludePolicies=Extensions.getExtensions(DirectoryIndexExcludePolicy.EP_NAME,myProject);
  startupManager.registerPreStartupActivity(new Runnable(){
    @Override public void run(){
      initialize();
    }
  }
);
  Disposer.register(project,new Disposable(){
    @Override public void dispose(){
      myDisposed=true;
      myState.multiDirPackages.clear();
      myState.myDirToInfoMap.clear();
      myState.myDirToPackageName.clear();
      myState.myExcludeRootsMap.clear();
      myState.myPackageNameToDirsMap.clear();
      myState.myProjectExcludeRoots.clear();
      myState.myRootTypeId.clear();
      myState.myRootTypes.clear();
    }
  }
);
}
