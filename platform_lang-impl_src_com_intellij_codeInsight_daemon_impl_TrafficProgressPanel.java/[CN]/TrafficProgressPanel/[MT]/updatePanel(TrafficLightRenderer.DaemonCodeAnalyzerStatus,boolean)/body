{
  try {
    boolean needRebuild=myTrafficLightRenderer.updatePanel(status,myTrafficLightRenderer.getProject());
    statusLabel.setText(myTrafficLightRenderer.statusLabel);
    if (myTrafficLightRenderer.statusExtraLine == null) {
      statusExtraLineLabel.setVisible(false);
    }
 else {
      statusExtraLineLabel.setText(myTrafficLightRenderer.statusExtraLine);
      statusExtraLineLabel.setVisible(true);
    }
    myPassStatuses.setVisible(myTrafficLightRenderer.passStatusesVisible);
    statistics.setText(myTrafficLightRenderer.statistics);
    resetProgressBars(myTrafficLightRenderer.progressBarsEnabled,myTrafficLightRenderer.progressBarsCompleted);
    if (needRebuild) {
      rebuildPassesProgress(status);
    }
    for (    ProgressableTextEditorHighlightingPass pass : status.passStati) {
      double progress=pass.getProgress();
      Pair<JProgressBar,JLabel> pair=myTrafficLightRenderer.passes.get(pass);
      JProgressBar progressBar=pair.first;
      int percent=(int)Math.round(progress * TrafficLightRenderer.MAX);
      if (percent == 100 && !pass.isFinished()) {
        percent=99;
      }
      progressBar.setValue(percent);
      JLabel percentage=pair.second;
      percentage.setText(percent + "%");
    }
  }
  finally {
    if (isFake) {
      myEmptyPassStatuses.setPreferredSize(myPassStatuses.getPreferredSize());
      myPassStatusesContainer.setContent(myEmptyPassStatuses);
    }
 else {
      myPassStatusesContainer.setContent(myPassStatuses);
    }
  }
}
