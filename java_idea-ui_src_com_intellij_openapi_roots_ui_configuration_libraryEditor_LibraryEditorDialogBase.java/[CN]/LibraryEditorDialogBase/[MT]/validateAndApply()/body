{
  final String currentName=myLibraryRootsComponent.getLibraryEditor().getName();
  String newName=myNameField.getText().trim();
  if (newName.length() == 0) {
    newName=null;
  }
  if (!Comparing.equal(newName,currentName)) {
    final LibraryTable.ModifiableModel tableModifiableModel=getTableModifiableModel();
    if (tableModifiableModel != null && !(tableModifiableModel instanceof ModuleLibraryTable)) {
      if (newName == null) {
        Messages.showErrorDialog(ProjectBundle.message("library.name.not.specified.error",newName),ProjectBundle.message("library.name.not.specified.title"));
        return false;
      }
      if (LibraryEditingUtil.libraryAlreadyExists(tableModifiableModel,newName)) {
        Messages.showErrorDialog(ProjectBundle.message("library.name.already.exists.error",newName),ProjectBundle.message("library.name.already.exists.title"));
        return false;
      }
    }
    myLibraryRootsComponent.renameLibrary(newName);
  }
  return true;
}
