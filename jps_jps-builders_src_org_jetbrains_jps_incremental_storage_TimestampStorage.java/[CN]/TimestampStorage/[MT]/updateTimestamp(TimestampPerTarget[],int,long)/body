{
  final TimestampPerTarget newItem=new TimestampPerTarget(targetId,timestamp);
  if (oldState == null) {
    return new TimestampPerTarget[]{newItem};
  }
  for (int i=0, length=oldState.length; i < length; i++) {
    if (oldState[i].targetId == targetId) {
      oldState[i]=newItem;
      return oldState;
    }
  }
  return ArrayUtil.append(oldState,newItem);
}
