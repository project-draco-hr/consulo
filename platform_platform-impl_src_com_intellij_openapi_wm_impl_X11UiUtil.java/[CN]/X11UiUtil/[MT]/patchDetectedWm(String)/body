{
  if (X11 == null || SystemProperties.getBooleanProperty("idea.skip.wm.patching",false))   return;
  try {
    if (wmName.startsWith("Mutter") || "Muffin".equals(wmName) || "GNOME Shell".equals(wmName)) {
      try {
        setWM("MUTTER_WM");
      }
 catch (      NoSuchFieldException e) {
        setWM("METACITY_WM");
      }
    }
 else     if ("Marco".equals(wmName)) {
      setWM("METACITY_WM");
    }
 else     if ("awesome".equals(wmName)) {
      try {
        Class<?> xwmClass=Class.forName("sun.awt.X11.XWM");
        xwmClass.getDeclaredField("OTHER_NONREPARENTING_WM");
        if (System.getenv("_JAVA_AWT_WM_NONREPARENTING") == null) {
          setWM("OTHER_NONREPARENTING_WM");
        }
      }
 catch (      NoSuchFieldException e) {
        setWM("LG3D_WM");
      }
    }
  }
 catch (  Throwable e) {
    LOG.warn(e);
  }
}
