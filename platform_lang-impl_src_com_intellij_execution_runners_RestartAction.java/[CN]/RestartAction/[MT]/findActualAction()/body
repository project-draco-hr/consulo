{
  if (registry.isEmpty())   return null;
  List<RestartAction> candidates=new ArrayList<RestartAction>(registry);
  Collections.sort(candidates,new Comparator<RestartAction>(){
    @Override public int compare(    RestartAction action1,    RestartAction action2){
      boolean isActive1=action1.isEnabled();
      boolean isActive2=action2.isEnabled();
      if (isActive1 != isActive2)       return isActive1 ? -1 : 1;
      Window window1=SwingUtilities.windowForComponent(action1.myDescriptor.getComponent());
      Window window2=SwingUtilities.windowForComponent(action2.myDescriptor.getComponent());
      if (window1 == null)       return 1;
      if (window2 == null)       return -1;
      boolean showing1=action1.myDescriptor.getComponent().isShowing();
      boolean showing2=action2.myDescriptor.getComponent().isShowing();
      if (showing1 && !showing2)       return -1;
      if (showing2 && !showing1)       return 1;
      return (window1.isActive() ? -1 : 1);
    }
  }
);
  return candidates.get(0);
}
