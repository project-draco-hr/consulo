{
  final JavaResolveResult resolved=methodCallExpr.resolveMethodGenerics();
  PsiElement r=resolved.getElement();
  if (r instanceof PsiCompiledElement) {
    r=r.getNavigationElement();
  }
  if (!(r instanceof PsiMethod))   return true;
  PsiMethod methodCalled=(PsiMethod)r;
  PsiType returnType=methodCalled.getReturnType();
  if (returnType == null)   return true;
  final PsiType parentType=parentSubstitutor.substitute(methodCallExpr.getType());
  final PsiSubstitutor substitutor=resolved.getSubstitutor().putAll(parentSubstitutor);
  Collection<PsiMethod> overrides=new THashSet<PsiMethod>(OverridingMethodsSearch.search(methodCalled,parent.getScope().toSearchScope(),true).findAll());
  overrides.add(methodCalled);
  final boolean[] result={true};
  for (  PsiMethod override : overrides) {
    if (!result[0])     break;
    if (override instanceof PsiCompiledElement) {
      override=(PsiMethod)override.getNavigationElement();
    }
    if (!parent.getScope().contains(override))     continue;
    final PsiCodeBlock body=override.getBody();
    if (body == null)     continue;
    final PsiSubstitutor superSubstitutor=methodCalled == override ? substitutor : MethodSignatureUtil.getSuperMethodSignatureSubstitutor(methodCalled.getSignature(substitutor),override.getSignature(substitutor));
    body.accept(new JavaRecursiveElementWalkingVisitor(){
      @Override public void visitAnonymousClass(      PsiAnonymousClass aClass){
      }
      public void visitReturnStatement(      final PsiReturnStatement statement){
        PsiExpression returnValue=statement.getReturnValue();
        if (returnValue == null)         return;
        if (!TypeConversionUtil.isAssignable(parentType,superSubstitutor.substitute(superSubstitutor.substitute(returnValue.getType()))))         return;
        if (!handToProcessor(returnValue,processor,parent,substitutor)) {
          stopWalking();
          result[0]=false;
        }
      }
    }
);
  }
  return result[0];
}
