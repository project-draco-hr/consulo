{
synchronized (packets) {
    if (msg == null) {
      connectionClosed=true;
    }
 else {
      byte[] tmp=new byte[msglen];
      System.arraycopy(msg,0,tmp,0,msglen);
      packets.addElement(tmp);
    }
    packets.notifyAll();
    if (packets.size() > 5) {
      connectionClosed=true;
      throw new IOException("Error, peer is flooding us with authentication packets.");
    }
  }
}
