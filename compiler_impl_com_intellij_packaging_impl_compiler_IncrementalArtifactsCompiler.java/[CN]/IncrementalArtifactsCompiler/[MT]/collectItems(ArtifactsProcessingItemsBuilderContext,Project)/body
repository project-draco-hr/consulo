{
  final CompileContext context=builderContext.getCompileContext();
  final Set<Artifact> artifactsToBuild=getArtifactsToBuild(project,context.getCompileScope());
  for (  Artifact artifact : ArtifactManager.getInstance(project).getArtifacts()) {
    final String outputPath=artifact.getOutputPath();
    if (outputPath != null && outputPath.length() != 0) {
      collectItems(builderContext,artifact,outputPath,project,artifactsToBuild.contains(artifact));
    }
 else     if (artifactsToBuild.contains(artifact)) {
      context.addMessage(CompilerMessageCategory.ERROR,"Cannot build '" + artifact.getName() + "' artifact: output path is not specified",null,-1,-1);
    }
  }
  context.putUserData(AFFECTED_ARTIFACTS,artifactsToBuild);
  return builderContext.getProcessingItems();
}
