{
  if (previewState != null) {
    mxGraphics2DCanvas canvas=graphComponent.getCanvas();
    if (graphComponent.isAntiAlias()) {
      mxUtils.setAntiAlias((Graphics2D)g,true,false);
    }
    float alpha=graphComponent.getPreviewAlpha();
    if (alpha < 1) {
      ((Graphics2D)g).setComposite(AlphaComposite.getInstance(AlphaComposite.SRC_OVER,alpha));
    }
    Graphics2D previousGraphics=canvas.getGraphics();
    Point previousTranslate=canvas.getTranslate();
    double previousScale=canvas.getScale();
    try {
      canvas.setScale(graphComponent.getGraph().getView().getScale());
      canvas.setTranslate(0,0);
      canvas.setGraphics((Graphics2D)g);
      paintPreview(canvas);
    }
  finally {
      canvas.setScale(previousScale);
      canvas.setTranslate(previousTranslate.x,previousTranslate.y);
      canvas.setGraphics(previousGraphics);
    }
  }
}
