{
  final Language language=getManager().getInjectedLanguage(this);
  if (language == null)   return null;
  final Project project=getProject();
  final ParserDefinition parserDefinition=language.getParserDefinition();
  if (parserDefinition == null)   return null;
  final PsiParser parser=parserDefinition.createParser(project);
  final IElementType root=parserDefinition.getFileNodeType();
  Object value=getValue();
  if (!(value instanceof String))   return null;
  String text=(String)value;
  TextRange insideQuotes=new TextRange(1,text.length() + 1);
  final PsiBuilderImpl builder=new PsiBuilderImpl(language,project,null,text);
  final ASTNode parsedNode=parser.parse(root,builder);
  if (parsedNode instanceof FileElement) {
    parsedNode.putUserData(MANAGER_KEY,getManager());
    TextRange documentWindow=getTextRange().cutOut(insideQuotes);
    DocumentEx document=(DocumentEx)PsiDocumentManager.getInstance(project).getDocument(getContainingFile());
    DocumentRange documentRange=new DocumentRange(document,documentWindow);
    final VirtualFile virtualFile=new VirtualFileDelegate(getContainingFile().getVirtualFile(),documentWindow,language,text);
    PsiFile psiFile=parserDefinition.createFile(new SingleRootFileViewProvider(getManager(),virtualFile));
    FileDocumentManagerImpl.registerDocument(documentRange,virtualFile);
    SrcRepositoryPsiElement repositoryPsiElement=(SrcRepositoryPsiElement)psiFile;
    ((FileElement)parsedNode).setPsiElement(repositoryPsiElement);
    repositoryPsiElement.setTreeElement(parsedNode);
  }
  return Pair.create(parsedNode.getPsi(),insideQuotes);
}
