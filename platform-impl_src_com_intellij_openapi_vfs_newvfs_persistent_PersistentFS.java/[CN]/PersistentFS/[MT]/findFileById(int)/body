{
  try {
    dirCacheReadLock.lock();
    final VirtualFile cached=myIdToDirCache.get(id);
    if (cached != null) {
      return cached;
    }
  }
  finally {
    dirCacheReadLock.unlock();
  }
  final VirtualFile result=doFindFile(id);
  if (result != null && result.isDirectory()) {
    try {
      dirCacheWriteLock.lock();
      myIdToDirCache.put(id,result);
    }
  finally {
      dirCacheWriteLock.unlock();
    }
  }
  return result;
}
