{
  String message=myErrorMessage.get();
  if (message != null) {
    ExternalProjectStructureTreeModel model=GradleUtil.getProjectStructureTreeModel(event.getDataContext());
    if (model != null) {
      model.rebuild();
    }
    GradleConfigNotificationManager notificationManager=ServiceManager.getService(project,GradleConfigNotificationManager.class);
    notificationManager.processRefreshError(message);
    myErrorMessage.set(null);
  }
  boolean enabled=false;
  final ExternalSystemTaskManager taskManager=ServiceManager.getService(project,ExternalSystemTaskManager.class);
  if (taskManager != null) {
    enabled=!taskManager.hasTaskOfTypeInProgress(ExternalSystemTaskType.RESOLVE_PROJECT);
  }
  event.getPresentation().setEnabled(enabled);
}
