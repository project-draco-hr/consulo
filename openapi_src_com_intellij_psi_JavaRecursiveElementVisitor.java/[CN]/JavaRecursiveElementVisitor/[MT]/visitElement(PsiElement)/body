{
  if (!myRefExprsInVisit.isEmpty() && myRefExprsInVisit.peek() == element) {
    myRefExprsInVisit.pop();
    myRefExprsInVisit.push(null);
  }
 else {
    if (element instanceof PsiBinaryExpression) {
      if (!myBinaryExpressions.isEmpty() && myBinaryExpressions.peek() == element) {
        return;
      }
      PsiElement child=element.getFirstChild();
      List<PsiElement> children=new SmartList<PsiElement>();
      while (child != null) {
        if (child instanceof PsiBinaryExpression) {
          myBinaryExpressions.push((PsiBinaryExpression)child);
        }
        child.accept(this);
        child=child.getNextSibling();
        if (child == null) {
          child=myBinaryExpressions.isEmpty() ? null : myBinaryExpressions.pop();
          if (child != null)           child=child.getFirstChild();
        }
      }
    }
 else {
      element.acceptChildren(this);
    }
  }
}
