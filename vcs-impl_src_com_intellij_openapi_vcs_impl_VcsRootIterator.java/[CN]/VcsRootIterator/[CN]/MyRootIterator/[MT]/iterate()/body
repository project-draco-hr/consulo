{
  while (!myQueue.isEmpty()) {
    final VirtualFile current=myQueue.removeFirst();
    if (!myProcessor.process(new FilePathImpl(current)))     return false;
    if (current.isDirectory()) {
      final VirtualFile[] files=current.getChildren();
      for (      VirtualFile child : files) {
        if (myRootPresentFilter != null && (!myRootPresentFilter.accept(child)))         continue;
        if (myExcludedFileIndex.isExcludedFile(child))         continue;
        myQueue.add(child);
      }
    }
  }
  return true;
}
