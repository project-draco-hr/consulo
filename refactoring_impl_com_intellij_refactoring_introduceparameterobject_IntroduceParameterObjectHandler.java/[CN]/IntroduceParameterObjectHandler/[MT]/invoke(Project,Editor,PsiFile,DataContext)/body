{
  final ScrollingModel scrollingModel=editor.getScrollingModel();
  scrollingModel.scrollToCaret(ScrollType.MAKE_VISIBLE);
  final PsiElement element=LangDataKeys.PSI_ELEMENT.getData(dataContext);
  PsiMethod selectedMethod=null;
  if (element instanceof PsiMethod) {
    selectedMethod=(PsiMethod)element;
  }
 else {
    final CaretModel caretModel=editor.getCaretModel();
    final int position=caretModel.getOffset();
    final PsiMethodCallExpression methodCallExpression=PsiTreeUtil.getParentOfType(file.findElementAt(position),PsiMethodCallExpression.class);
    if (methodCallExpression != null) {
      selectedMethod=methodCallExpression.resolveMethod();
    }
  }
  if (selectedMethod == null) {
    final String message=RefactorJBundle.message("cannot.perform.the.refactoring") + RefactorJBundle.message("the.caret.should.be.positioned.at.the.name.of.the.method.to.be.refactored");
    CommonRefactoringUtil.showErrorHint(project,editor,message,REFACTORING_NAME,HelpID.IntroduceParameterObject);
    return;
  }
  invoke(project,selectedMethod,editor);
}
