{
  PsiElement element=psiReference.getElement();
  PsiExpression methodCall=PsiTreeUtil.getParentOfType(element,PsiMethodCallExpression.class);
  if (methodCall == null)   return TailCallType.None;
  if (methodCall.getParent() instanceof PsiReturnStatement)   return TailCallType.Return;
  if (methodCall.getParent() instanceof PsiExpressionStatement) {
    PsiStatement callStatement=(PsiStatement)methodCall.getParent();
    PsiMethod callerMethod=PsiTreeUtil.getParentOfType(callStatement,PsiMethod.class);
    if (callerMethod != null) {
      final PsiStatement[] psiStatements=callerMethod.getBody().getStatements();
      return psiStatements.length > 0 && callStatement == psiStatements[psiStatements.length - 1] ? TailCallType.Simple : TailCallType.None;
    }
  }
  return TailCallType.None;
}
