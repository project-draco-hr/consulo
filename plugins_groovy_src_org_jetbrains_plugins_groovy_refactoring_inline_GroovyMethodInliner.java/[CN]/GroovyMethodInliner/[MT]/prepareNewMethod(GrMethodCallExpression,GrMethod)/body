{
  GroovyElementFactory factory=GroovyElementFactory.getInstance(method.getProject());
  GrMethod newMethod=factory.createMethodFromText(method.getText());
  ArrayList<GrVariable> innerVariables=new ArrayList<GrVariable>();
  collectInnerVariables(newMethod.getBlock(),innerVariables);
  for (  GrVariable variable : innerVariables) {
    String newName=InlineMethodConflictSolver.suggestNewName(variable,method,call);
    if (!newName.equals(variable.getName())) {
      variable.setName(newName);
    }
  }
  GroovyRefactoringUtil.replaceParamatersWithArguments(call,newMethod);
  return newMethod;
}
