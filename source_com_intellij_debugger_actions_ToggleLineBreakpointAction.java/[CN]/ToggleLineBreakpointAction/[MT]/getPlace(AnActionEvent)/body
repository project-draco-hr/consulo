{
  DataContext dataContext=event.getDataContext();
  Project project=(Project)dataContext.getData(DataConstants.PROJECT);
  if (project == null)   return null;
  Editor editor=(Editor)dataContext.getData(DataConstants.EDITOR);
  if (editor == null) {
    editor=FileEditorManager.getInstance(project).getSelectedTextEditor();
  }
  if (editor != null) {
    final Document document=editor.getDocument();
    PsiFile file=PsiDocumentManager.getInstance(project).getPsiFile(document);
    if (file != null) {
      FileTypeManager fileTypeManager=FileTypeManager.getInstance();
      FileType fileType=fileTypeManager.getFileTypeByFile(file.getVirtualFile());
      if (StdFileTypes.JAVA == fileType || StdFileTypes.JSP == fileType) {
        final Editor editor1=editor;
        return new PlaceInDocument(){
          public Document getDocument(){
            return document;
          }
          public int getOffset(){
            return editor1.getCaretModel().getOffset();
          }
        }
;
      }
    }
  }
  return null;
}
