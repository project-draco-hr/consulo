{
  if (!file.isValid()) {
    return file;
  }
  if (file.getFileSystem() instanceof LocalFileProvider) {
    final VirtualFile localFile=((LocalFileProvider)file.getFileSystem()).getLocalVirtualFileFor(file);
    if (localFile != null) {
      return localFile;
    }
  }
  return file;
}
