{
  assertIsDispatchThread();
  validateCallContext();
  final LogicalPosition logicalPosition=myEditor.offsetToLogicalPosition(offset);
  moveToLogicalPosition(logicalPosition,locateBeforeSoftWrap,null);
  if (!ignoreWrongMoves && !myEditor.offsetToLogicalPosition(myOffset).equals(logicalPosition)) {
    StringBuilder debugBuffer=new StringBuilder();
    moveToLogicalPosition(logicalPosition,locateBeforeSoftWrap,debugBuffer);
    int textStart=Math.max(0,Math.min(offset,myOffset) - 1);
    final DocumentEx document=myEditor.getDocument();
    int textEnd=Math.min(document.getTextLength() - 1,Math.max(offset,myOffset) + 1);
    CharSequence text=document.getCharsSequence().subSequence(textStart,textEnd);
    LOG.error("caret moved to wrong offset. Requested: offset=" + offset + ", logical position="+ logicalPosition+ " but actual: offset="+ myOffset+ ", logical position="+ myLogicalCaret+ "("+ myEditor.offsetToLogicalPosition(myOffset)+ "). "+ myEditor.dumpState()+ "\n interested text ["+ textStart+ "; "+ textEnd+ "): '"+ text+ "'"+ "\n debug trace: "+ debugBuffer);
  }
}
