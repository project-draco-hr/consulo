{
  Document document=myEditor.getDocument();
  int logicalLine=position.line;
  int startOffset=document.getLineStartOffset(logicalLine);
  int endOffset=document.getLineEndOffset(logicalLine);
  VisualPosition visualPosition=myEditor.offsetToVisualPosition(document.getLineStartOffset(logicalLine));
  int y=myEditor.visualPositionToXY(visualPosition).y;
  int lineHeight=myEditor.getLineHeight();
  int height=lineHeight;
  List<? extends TextChange> softWraps=myEditor.getSoftWrapModel().getSoftWrapsForRange(startOffset,endOffset);
  for (  TextChange softWrap : softWraps) {
    height+=StringUtil.countNewLines(softWrap.getText()) * lineHeight;
  }
  return new VerticalInfo(y,height);
}
