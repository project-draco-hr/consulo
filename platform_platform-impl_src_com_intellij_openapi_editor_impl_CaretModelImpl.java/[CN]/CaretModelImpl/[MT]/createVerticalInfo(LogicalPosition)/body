{
  Document document=myEditor.getDocument();
  int logicalLine=position.line;
  LogicalPosition logicalPosition=myEditor.offsetToLogicalPosition(document.getLineStartOffset(logicalLine));
  VisualPosition visualPosition=myEditor.logicalToVisualPosition(logicalPosition);
  int y=myEditor.visualPositionToXY(visualPosition).y;
  int height=myEditor.getLineHeight();
  int visualLine=visualPosition.line + 1;
  int lastVisualLine=myEditor.offsetToVisualPosition(document.getTextLength() - 1).line;
  for (; visualLine <= lastVisualLine; visualLine++) {
    LogicalPosition logical=myEditor.visualToLogicalPosition(new VisualPosition(visualLine,0));
    if (logical.line == logicalLine) {
      height+=myEditor.getLineHeight();
    }
 else {
      break;
    }
  }
  return new VerticalInfo(y,height);
}
