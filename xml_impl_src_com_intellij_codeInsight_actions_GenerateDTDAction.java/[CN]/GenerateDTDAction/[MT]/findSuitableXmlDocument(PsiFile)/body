{
  if (psiFile instanceof XmlFile) {
    final VirtualFile virtualFile=psiFile.getVirtualFile();
    if (virtualFile != null && virtualFile.isWritable()) {
      final XmlDocument document=((XmlFile)psiFile).getDocument();
      if (document != null && document.getRootTag() != null) {
        return document;
      }
    }
  }
  return null;
}
