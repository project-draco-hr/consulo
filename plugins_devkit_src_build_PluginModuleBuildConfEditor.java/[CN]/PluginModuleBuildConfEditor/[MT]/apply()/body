{
  if (!mySetDependencyOnPluginModule.isEmpty()) {
    throw new ConfigurationException("Unable to set dependency on plugin module.");
  }
  final File plugin=myBuildProperties.getPluginXmlPath() != null ? new File(myBuildProperties.getPluginXmlPath()) : null;
  final String newPluginPath=myPluginXML.getText() + File.separator + "META-INF"+ File.separator+ "plugin.xml";
  if (plugin != null && plugin.exists() && !plugin.getPath().equals(newPluginPath) && Messages.showYesNoDialog(myModule.getProject(),"Delete " + plugin.getPath() + " ?","Clean up META-INF directory",null) == DialogWrapper.OK_EXIT_CODE) {
    CommandProcessor.getInstance().executeCommand(myModule.getProject(),new Runnable(){
      public void run(){
        FileUtil.delete(plugin.getParentFile());
      }
    }
,"Remove old plugin.xml directory",null);
  }
  myBuildProperties.setPluginXMLUrl(newPluginPath);
  myBuildProperties.setManifestUrl(myManifest.getText());
  myBuildProperties.setUseUserManifest(myUseUserManifest.isSelected());
  myModified=false;
}
