{
  final PsiElement psiElement=element;
  final boolean isDirectory=psiElement instanceof PsiDirectory;
  if (!isDirectory) {
    EditorHelper.openInEditor(psiElement);
  }
  ApplicationManager.getApplication().invokeLater(new Runnable(){
    public void run(){
      myBuilder.selectElement(psiElement,BasePsiNode.getVirtualFile(psiElement));
      if (!isDirectory) {
        ApplicationManager.getApplication().invokeLater(new Runnable(){
          public void run(){
            if (Commander.getInstance(myProject).MOVE_FOCUS) {
              ToolWindowManager.getInstance(myProject).activateEditorComponent();
            }
          }
        }
);
      }
    }
  }
,ModalityState.NON_MMODAL);
}
