{
  if (topElementIsSelected()) {
    goUp();
    return;
  }
  if (getSelectedValue() == null) {
    return;
  }
  final AbstractTreeNode element=getSelectedNode();
  if (element.getChildren().size() == 0) {
    if (!shouldDrillDownOnEmptyElement(element.getValue())) {
      Object selectedValue=getSelectedValue();
      if (selectedValue instanceof Navigatable && ((Navigatable)selectedValue).canNavigate()) {
        ((Navigatable)selectedValue).navigate(true);
        onNavigatePerformed();
        return;
      }
 else {
        return;
      }
    }
  }
  if (myBuilder == null) {
    return;
  }
  updateHistory(false);
  myBuilder.drillDown();
  updateHistory(true);
}
