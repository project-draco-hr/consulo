{
  PsiElement commonParent=findCommonParent(root,startOffset,endOffset);
  if (commonParent == null)   return Collections.emptyList();
  final List<PsiElement> list=new ArrayList<PsiElement>();
  for (  HighlightRangeExtension extension : Extensions.getExtensions(HighlightRangeExtension.EP_NAME)) {
    List<PsiElement> extendList=extension.getElementsToHighlight(root,commonParent,startOffset,endOffset);
    if (extendList != null) {
      list.addAll(extendList);
    }
  }
  PsiElement parent=commonParent;
  while (parent != null && parent != root) {
    list.add(parent);
    parent=includeAllParents ? parent.getParent() : null;
  }
  list.add(root);
  return Collections.unmodifiableList(list);
}
