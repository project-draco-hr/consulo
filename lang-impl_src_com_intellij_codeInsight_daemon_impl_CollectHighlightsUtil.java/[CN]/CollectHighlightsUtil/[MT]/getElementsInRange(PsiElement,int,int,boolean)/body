{
  PsiElement commonParent=findCommonParent(root,startOffset,endOffset);
  if (commonParent == null)   return Collections.emptyList();
  final List<PsiElement> list=new ArrayList<PsiElement>(getElementsToHighlight(root,commonParent,startOffset,endOffset));
  PsiElement parent=commonParent;
  while (parent != null && parent != root) {
    list.add(parent);
    parent=includeAllParents ? parent.getParent() : null;
  }
  list.add(root);
  return Collections.unmodifiableList(list);
}
