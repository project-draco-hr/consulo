{
  PsiMethodCallExpression methodCallExpression=PsiTreeUtil.getParentOfType(context,PsiMethodCallExpression.class);
  if (methodCallExpression != null) {
    final PsiMethod psiMethod=methodCallExpression.resolveMethod();
    if (psiMethod != null && "add".equals(psiMethod.getName())) {
      final PsiClass containingClass=psiMethod.getContainingClass();
      if (containingClass != null) {
        final PsiExpression qualifierExpression=methodCallExpression.getMethodExpression().getQualifierExpression();
        if (qualifierExpression instanceof PsiMethodCallExpression) {
          final PsiReferenceExpression getStylesheetsMethodExpression=((PsiMethodCallExpression)qualifierExpression).getMethodExpression();
          if ("getStylesheets".equals(getStylesheetsMethodExpression.getReferenceName())) {
            return getStylesheetsMethodExpression.getQualifierExpression();
          }
        }
      }
    }
  }
  return null;
}
