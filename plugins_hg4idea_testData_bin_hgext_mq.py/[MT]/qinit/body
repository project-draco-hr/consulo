def qinit(ui, repo, create):
    'initialize a new queue repository\n\n    This command also creates a series file for ordering patches, and\n    an mq-specific .hgignore file in the queue repository, to exclude\n    the status and guards files (these contain mostly transient state).'
    q = repo.mq
    r = q.init(repo, create)
    q.save_dirty()
    if r:
        if (not os.path.exists(r.wjoin('.hgignore'))):
            fp = r.wopener('.hgignore', 'w')
            fp.write('^\\.hg\n')
            fp.write('^\\.mq\n')
            fp.write('syntax: glob\n')
            fp.write('status\n')
            fp.write('guards\n')
            fp.close()
        if (not os.path.exists(r.wjoin('series'))):
            r.wopener('series', 'w').close()
        r.add(['.hgignore', 'series'])
        commands.add(ui, r)
    return 0
