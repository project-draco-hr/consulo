def mqcommand(orig, ui, repo, *args, **kwargs):
    'Add --mq option to operate on patch repository instead of main'
    mq = kwargs.pop('mq', None)
    if (not mq):
        return orig(ui, repo, *args, **kwargs)
    q = repo.mq
    r = q.qrepo()
    if (not r):
        raise util.Abort('no queue repository')
    return orig(r.ui, r, *args, **kwargs)
