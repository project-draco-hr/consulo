def check_localchanges(self, repo, force=False, refresh=True):
    (m, a, r, d) = repo.status()[:4]
    if ((m or a or r or d) and (not force)):
        if refresh:
            raise util.Abort(_('local changes found, refresh first'))
        else:
            raise util.Abort(_('local changes found'))
    return (m, a, r, d)
