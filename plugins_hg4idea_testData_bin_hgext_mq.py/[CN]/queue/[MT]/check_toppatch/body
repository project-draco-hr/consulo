def check_toppatch(self, repo):
    if (len(self.applied) > 0):
        top = bin(self.applied[(-1)].rev)
        patch = self.applied[(-1)].name
        pp = repo.dirstate.parents()
        if (top not in pp):
            raise util.Abort(_('working directory revision is not qtip'))
        return (top, patch)
    return (None, None)
