def patchopts(self, diffopts, *patches):
    'Return a copy of input diff options with git set to true if\n        referenced patch is a git patch and should be preserved as such.\n        '
    diffopts = diffopts.copy()
    if ((not diffopts.git) and (self.gitmode == 'keep')):
        for patchfn in patches:
            patchf = self.opener(patchfn, 'r')
            for line in patchf:
                if line.startswith('diff --git'):
                    diffopts.git = True
                    break
            patchf.close()
    return diffopts
