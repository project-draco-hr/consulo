def series_end(self, all_patches=False):
    'If all_patches is False, return the index of the next pushable patch\n        in the series, or the series length. If all_patches is True, return the\n        index of the first patch past the last applied one.\n        '
    end = 0

    def next(start):
        if all_patches:
            return start
        i = start
        while (i < len(self.series)):
            (p, reason) = self.pushable(i)
            if p:
                break
            self.explain_pushable(i)
            i += 1
        return i
    if (len(self.applied) > 0):
        p = self.applied[(-1)].name
        try:
            end = self.series.index(p)
        except ValueError:
            return 0
        return next((end + 1))
    return next(end)
