def _cleanup(self, patches, numrevs, keep=False):
    if (not keep):
        r = self.qrepo()
        if r:
            r.remove(patches, True)
        else:
            for p in patches:
                os.unlink(self.join(p))
    if numrevs:
        del self.applied[:numrevs]
        self.applied_dirty = 1
    for i in sorted([self.find_series(p) for p in patches], reverse=True):
        del self.full_series[i]
    self.parse_series()
    self.series_dirty = 1
