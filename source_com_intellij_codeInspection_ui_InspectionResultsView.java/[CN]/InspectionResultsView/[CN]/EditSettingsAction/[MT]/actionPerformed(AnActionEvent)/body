{
  final InspectionManagerEx manager=((InspectionManagerEx)InspectionManagerEx.getInstance(myProject));
  final String currentProfileName=manager.getCurrentProfile().getName();
  manager.setExternalProfile(myInspectionProfile);
  final InspectionCodeSettingsPanel dlg=new InspectionCodeSettingsPanel(manager,myScope);
  final InspectionTool selectedTool=getSelectedTool();
  if (selectedTool != null) {
    dlg.selectInspectionTool(selectedTool.getShortName());
  }
  dlg.show();
  ApplicationManager.getApplication().invokeLater(new Runnable(){
    public void run(){
      manager.setExternalProfile(null);
      if (dlg.isOK()) {
        myInspectionProfile=manager.getCurrentProfile();
        manager.setProfile(InspectionProfileManager.getInstance().getProfile(currentProfileName));
        InspectionResultsView.this.update();
      }
    }
  }
);
}
