{
  ExportToHTMLDialog exportToHTMLDialog=new ExportToHTMLDialog(myProject);
  final ExportToHTMLSettings exportToHTMLSettings=ExportToHTMLSettings.getInstance(myProject);
  if (exportToHTMLSettings.OUTPUT_DIRECTORY == null) {
    exportToHTMLSettings.OUTPUT_DIRECTORY=PathManager.getHomePath() + File.separator + "exportToHTML";
  }
  exportToHTMLDialog.reset();
  exportToHTMLDialog.show();
  if (!exportToHTMLDialog.isOK()) {
    return;
  }
  exportToHTMLDialog.apply();
  final String outputDirectoryName=exportToHTMLSettings.OUTPUT_DIRECTORY;
  ApplicationManager.getApplication().invokeLater(new Runnable(){
    public void run(){
      final Runnable exportRunnable=new Runnable(){
        public void run(){
          HTMLExportFrameMaker maker=new HTMLExportFrameMaker(outputDirectoryName,myProject);
          maker.start();
          try {
            exportHTML(maker);
          }
 catch (          ProcessCanceledException e) {
          }
          maker.done();
        }
      }
;
      if (!ApplicationManager.getApplication().runProcessWithProgressSynchronously(exportRunnable,"Generating HTML...",true,myProject)) {
        return;
      }
      if (exportToHTMLSettings.OPEN_IN_BROWSER) {
        BrowserUtil.launchBrowser(exportToHTMLSettings.OUTPUT_DIRECTORY + File.separator + "index.html");
      }
    }
  }
);
}
