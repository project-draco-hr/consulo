{
  final LocalQuickFix[] fixes=descriptor.getFixes();
  if (fixes != null && fixes.length > idx && fixes[idx] != null) {
    PsiElement psiElement=element.getElement();
    if (psiElement != null && psiElement.isValid()) {
      if (!psiElement.isWritable()) {
        final ReadonlyStatusHandler.OperationStatus operationStatus=ReadonlyStatusHandler.getInstance(myProject).ensureFilesWritable(new VirtualFile[]{psiElement.getContainingFile().getVirtualFile()});
        if (operationStatus.hasReadonlyFiles()) {
          return;
        }
      }
      ApplicationManager.getApplication().runWriteAction(new Runnable(){
        public void run(){
          Runnable command=new Runnable(){
            public void run(){
              CommandProcessor.getInstance().markCurrentCommandAsComplex(myProject);
              fixes[idx].applyFix(myProject,descriptor);
            }
          }
;
          CommandProcessor.getInstance().executeCommand(myProject,command,fixes[idx].getName(),null);
          final DescriptorProviderInspection tool=((DescriptorProviderInspection)getSelectedTool());
          if (tool != null) {
            tool.ignoreProblem(element,descriptor,idx);
          }
          update();
        }
      }
);
    }
  }
}
