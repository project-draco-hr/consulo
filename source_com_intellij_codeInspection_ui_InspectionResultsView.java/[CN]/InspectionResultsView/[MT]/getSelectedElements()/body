{
  TreePath[] selectionPaths=myTree.getSelectionPaths();
  if (selectionPaths != null) {
    final InspectionTool selectedTool=getSelectedTool();
    if (selectedTool == null)     return EMPTY_ELEMENTS_ARRAY;
    Set<RefElement> result=new HashSet<RefElement>();
    for (int i=0; i < selectionPaths.length; i++) {
      final InspectionTreeNode node=(InspectionTreeNode)selectionPaths[i].getLastPathComponent();
      addElementsInNode(node,result);
    }
    return result.toArray(new RefElement[result.size()]);
  }
  return EMPTY_ELEMENTS_ARRAY;
}
