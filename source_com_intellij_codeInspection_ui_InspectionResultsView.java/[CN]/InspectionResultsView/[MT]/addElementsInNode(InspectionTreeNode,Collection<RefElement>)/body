{
  if (!node.isValid())   return;
  if (node instanceof RefElementNode) {
    out.add(((RefElementNode)node).getElement());
  }
 else   if (node instanceof ProblemDescriptionNode) {
    out.add(((ProblemDescriptionNode)node).getElement());
  }
 else   if (node instanceof InspectionPackageNode || node instanceof InspectionNode) {
    final Enumeration children=node.children();
    while (children.hasMoreElements()) {
      InspectionTreeNode child=(InspectionTreeNode)children.nextElement();
      addElementsInNode(child,out);
    }
  }
}
