{
  if (myTree.getSelectionCount() == 0 || !(getSelectedTool() instanceof DescriptorProviderInspection))   return EMPTY_DESCRIPTORS;
  final TreePath[] paths=myTree.getSelectionPaths();
  Set<ProblemDescriptor> descriptors=new HashSet<ProblemDescriptor>();
  for (  TreePath path : paths) {
    Object node=path.getLastPathComponent();
    if (node instanceof ProblemDescriptionNode) {
      final ProblemDescriptionNode problemNode=(ProblemDescriptionNode)node;
      descriptors.add(problemNode.getDescriptor());
    }
  }
  final RefElement[] elements=getSelectedElements();
  final DescriptorProviderInspection tool=(DescriptorProviderInspection)getSelectedTool();
  for (  RefElement element : elements) {
    final ProblemDescriptor[] descriptions=tool.getDescriptions(element);
    if (descriptions != null)     descriptors.addAll(Arrays.asList(descriptions));
  }
  return descriptors.toArray(new ProblemDescriptor[descriptors.size()]);
}
