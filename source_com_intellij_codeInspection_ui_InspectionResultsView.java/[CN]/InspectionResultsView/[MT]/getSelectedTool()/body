{
  final TreePath[] paths=myTree.getSelectionPaths();
  if (paths == null)   return null;
  InspectionTool tool=null;
  for (int i=0; i < paths.length; i++) {
    Object[] nodes=paths[i].getPath();
    for (int j=nodes.length - 1; j >= 0; j--) {
      Object node=nodes[j];
      if (node instanceof InspectionNode) {
        if (tool == null) {
          tool=((InspectionNode)node).getTool();
        }
 else         if (tool != ((InspectionNode)node).getTool()) {
          return null;
        }
        break;
      }
    }
  }
  return tool;
}
