{
  InspectionTool[] tools=myInspectionProfile.getInspectionTools(myProject);
  clearTree();
  boolean resultsFound=false;
  final InspectionManagerEx manager=((InspectionManagerEx)InspectionManagerEx.getInstance(myProject));
  final boolean isGroupedBySeverity=manager.getUIOptions().GROUP_BY_SEVERITY;
  myGroups=new java.util.HashMap<HighlightDisplayLevel,Map<String,InspectionGroupNode>>();
  for (int i=0; i < tools.length; i++) {
    InspectionTool tool=tools[i];
    final HighlightDisplayKey key=HighlightDisplayKey.find(tool.getShortName());
    if (myInspectionProfile.isToolEnabled(key)) {
      addTool(tool,myInspectionProfile.getErrorLevel(key),isGroupedBySeverity);
      resultsFound|=tool.hasReportedProblems();
    }
  }
  myTree.sort();
  myTree.restoreExpantionAndSelection();
  return resultsFound;
}
