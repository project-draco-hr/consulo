{
  if (node.isResult()) {
    TestResultMessage result=node.getResultMessage();
switch (result.getResult()) {
case MessageHelper.PASSED_TEST:
      if (node.isTearDownFailure()) {
        return PoolOfTestIcons.TEAR_DOWN_FAILURE;
      }
    return PoolOfTestIcons.PASSED_ICON;
case MessageHelper.SKIPPED_TEST:
  return PoolOfTestIcons.SKIPPED_ICON;
case MessageHelper.FAILED_TEST:
return PoolOfTestIcons.FAILED_ICON;
case MessageHelper.TEST_STARTED:
return PoolOfTestIcons.TERMINATED_ICON;
}
}
 else {
if (node.getChildCount() == 0) {
final TestProxy nodeParent=node.getParent();
if (nodeParent != null && nodeParent.isTearDownFailure()) {
final TestResultMessage resultMessage=nodeParent.getResultMessage();
if (resultMessage != null && resultMessage.getResult() == MessageHelper.PASSED_TEST) {
return PoolOfTestIcons.FAILED_ICON;
}
}
return PoolOfTestIcons.NOT_RAN;
}
boolean hasFail=false;
boolean hasSkipped=false;
boolean hasTerminated=false;
boolean hasTearDownFailure=false;
for (TestProxy result : node.getChildren()) {
Icon icon=getIcon(result);
if (icon == PoolOfTestIcons.FAILED_ICON) {
hasFail=true;
}
 else if (icon == PoolOfTestIcons.SKIPPED_ICON) {
hasSkipped=true;
}
 else if (icon == PoolOfTestIcons.TERMINATED_ICON) {
hasTerminated=true;
}
 else if (result.isTearDownFailure()) {
hasTearDownFailure=true;
}
}
if (hasTerminated) return PoolOfTestIcons.TERMINATED_ICON;
if (hasFail) return PoolOfTestIcons.FAILED_ICON;
if (hasSkipped) return PoolOfTestIcons.SKIPPED_ICON;
if (hasTearDownFailure) return PoolOfTestIcons.TEAR_DOWN_FAILURE;
}
return PoolOfTestIcons.PASSED_ICON;
}
