{
  mySelected=selected;
  myFocused=hasFocus;
  if (selected) {
    setPaintFocusBorder(true);
    if (hasFocus) {
      setBackground(UIManager.getColor("Tree.selectionBackground"));
    }
 else {
      setBackground(tree.getBackground());
    }
  }
 else {
    setBackground(tree.getBackground());
  }
  Color color=null;
  if (value instanceof DefaultMutableTreeNode) {
    DefaultMutableTreeNode node=(DefaultMutableTreeNode)value;
    Object userObject=node.getUserObject();
    if (userObject instanceof NodeDescriptor) {
      NodeDescriptor descriptor=(NodeDescriptor)userObject;
      if (expanded) {
        setIcon(descriptor.getOpenIcon());
      }
 else {
        setIcon(descriptor.getClosedIcon());
      }
      color=descriptor.getColor();
    }
    if (userObject instanceof SimpleNode) {
      renderNodeText(((SimpleNode)userObject),this);
      return;
    }
  }
  String text=tree.convertValueToText(value,selected,expanded,leaf,row,hasFocus);
  if (text == null)   text="";
  append(text,new SimpleTextAttributes(Font.PLAIN,color));
}
