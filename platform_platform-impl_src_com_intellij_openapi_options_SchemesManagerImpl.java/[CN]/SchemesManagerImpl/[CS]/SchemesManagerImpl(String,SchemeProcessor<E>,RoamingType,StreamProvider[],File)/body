{
  myFileSpec=fileSpec;
  myProcessor=processor;
  myRoamingType=roamingType;
  myProviders=providers;
  myBaseDir=baseDir;
  if (processor instanceof SchemeExtensionProvider) {
    mySchemeExtension=((SchemeExtensionProvider)processor).getSchemeExtension();
    myUpgradeExtension=((SchemeExtensionProvider)processor).isUpgradeNeeded();
  }
  myBaseDir.mkdirs();
  if (ApplicationManager.getApplication().isUnitTestMode() || !ApplicationManager.getApplication().isCommandLine()) {
    addVFSListener();
  }
}
