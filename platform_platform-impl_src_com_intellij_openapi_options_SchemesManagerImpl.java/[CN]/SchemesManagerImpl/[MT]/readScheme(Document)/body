{
  Element rootElement=subDocument.getRootElement();
  if (rootElement.getName().equals(SHARED_SCHEME)) {
    String schemeName=rootElement.getAttributeValue(NAME);
    String schemePath=rootElement.getAttributeValue(ORIGINAL_SCHEME_PATH);
    Document sharedDocument=loadGlobalScheme(schemePath);
    if (sharedDocument != null) {
      E result=readScheme(sharedDocument);
      if (result != null) {
        renameScheme(result,schemeName);
        result.getExternalInfo().setOriginalPath(schemePath);
        result.getExternalInfo().setIsImported(true);
      }
      return result;
    }
 else {
      Element localCopyElement=subDocument.getRootElement().getChild(SCHEME_LOCAL_COPY);
      if (localCopyElement != null) {
        Element firstChild=(Element)localCopyElement.getChildren().get(0);
        return myProcessor.readScheme(new Document((Element)firstChild.clone()));
      }
 else {
        return null;
      }
    }
  }
 else   if (rootElement.getName().equals(SHARED_SCHEME_ORIGINAL)) {
    SharedSchemeData schemeData=unwrap(subDocument);
    E scheme=myProcessor.readScheme(schemeData.original);
    if (scheme != null) {
      renameScheme(scheme,schemeData.name);
    }
    return scheme;
  }
 else {
    return myProcessor.readScheme(subDocument);
  }
}
