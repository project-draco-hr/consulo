{
  Map<String,E> result=new LinkedHashMap<String,E>();
  if (myProvider != null && myProvider.isEnabled()) {
    readSchemesFromProviders(result);
  }
 else {
    VirtualFile dir=getVirtualDir();
    VirtualFile[] files=dir == null ? null : dir.getChildren();
    if (files != null) {
      for (      VirtualFile file : files) {
        E scheme=readSchemeFromFile(file,false,Collections.<String,E>emptyMap());
        if (scheme != null) {
          result.put(scheme.getName(),scheme);
        }
      }
    }
  }
  Collection<E> list=result.values();
  for (  E scheme : list) {
    myProcessor.initScheme(scheme);
    checkCurrentScheme(scheme);
  }
  return list;
}
