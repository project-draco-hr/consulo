{
  StreamProvider provider=getProvider();
  if (provider == null) {
    return;
  }
  Parent document=myProcessor.writeScheme(scheme);
  if (document != null) {
    String fileSpec=getFileFullPath(UniqueFileNamesProvider.convertName(scheme.getName())) + mySchemeExtension;
    if (!provider.isApplicable(fileSpec,getRoamingType(provider))) {
      return;
    }
    Element wrapped=wrap(document,name,description);
    if (provider instanceof CurrentUserHolder) {
      wrapped=wrapped.clone();
      String userName=((CurrentUserHolder)provider).getCurrentUserName();
      if (userName != null) {
        wrapped.setAttribute(USER,userName);
      }
    }
    StorageUtil.doSendContent(provider,fileSpec,wrapped,getRoamingType(provider),false);
  }
}
