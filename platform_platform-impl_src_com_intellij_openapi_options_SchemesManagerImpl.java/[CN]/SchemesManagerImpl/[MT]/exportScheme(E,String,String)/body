{
  StreamProvider provider=getProvider();
  if (provider == null) {
    return;
  }
  Document document=myProcessor.writeScheme(scheme);
  if (document != null) {
    String fileSpec=getFileFullPath(UniqueFileNamesProvider.convertName(scheme.getName())) + mySchemeExtension;
    if (!provider.isApplicable(fileSpec,RoamingType.GLOBAL)) {
      return;
    }
    Document wrapped=wrap(document,name,description);
    if (provider instanceof CurrentUserHolder) {
      wrapped=wrapped.clone();
      String userName=((CurrentUserHolder)provider).getCurrentUserName();
      if (userName != null) {
        wrapped.getRootElement().setAttribute(USER,userName);
      }
    }
    StorageUtil.doSendContent(provider,fileSpec,wrapped,RoamingType.GLOBAL,false);
  }
}
