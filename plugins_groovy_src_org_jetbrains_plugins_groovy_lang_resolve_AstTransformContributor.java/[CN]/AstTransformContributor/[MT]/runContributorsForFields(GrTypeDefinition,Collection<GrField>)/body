{
  Set<GrTypeDefinition> inProgress=IN_PROGRESS_FIELDS.get();
  if (inProgress == null) {
    inProgress=new HashSet<GrTypeDefinition>();
    IN_PROGRESS_FIELDS.set(inProgress);
  }
  boolean added=inProgress.add(clazz);
  assert added;
  try {
    for (    final AstTransformContributor contributor : EP_NAME.getExtensions()) {
      contributor.collectFields(clazz,collector);
    }
  }
  finally {
    inProgress.remove(clazz);
  }
  return collector;
}
