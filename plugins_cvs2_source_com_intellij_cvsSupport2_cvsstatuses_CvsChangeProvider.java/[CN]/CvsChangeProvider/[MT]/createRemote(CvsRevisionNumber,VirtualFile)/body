{
  final CvsConnectionSettings settings=CvsEntriesManager.getInstance().getCvsConnectionSettingsFor(selectedFile.getParent());
  final File file=new File(CvsUtil.getModuleName(selectedFile));
  final RevisionOrDate versionInfo;
  if (revisionNumber.getDateOrRevision() != null) {
    versionInfo=RevisionOrDateImpl.createOn(revisionNumber.getDateOrRevision());
  }
 else {
    versionInfo=new SimpleRevision(revisionNumber.asString());
  }
  final Project project=myVcs.getProject();
  final File ioFile=new File(selectedFile.getPath());
  if (selectedFile.getFileType().isBinary()) {
    return new CvsBinaryContentRevision(file,ioFile,versionInfo,settings,project);
  }
 else {
    return new CvsContentRevision(file,ioFile,versionInfo,settings,project);
  }
}
