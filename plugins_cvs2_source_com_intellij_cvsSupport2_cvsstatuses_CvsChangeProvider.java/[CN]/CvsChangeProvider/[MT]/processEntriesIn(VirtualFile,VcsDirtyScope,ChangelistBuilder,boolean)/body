{
  if (!scope.belongsTo(PeerFactory.getInstance().getVcsContextFactory().createFilePathOn(dir)))   return;
  final DirectoryContent dirContent=CvsStatusProvider.getDirectoryContent(dir,myVcs.getProject());
  for (  VirtualFile file : dirContent.getUnknownFiles()) {
    builder.processUnversionedFile(file);
  }
  for (  VirtualFile file : dirContent.getIgnoredFiles()) {
    builder.processIgnoredFile(file);
  }
  for (  Entry entry : dirContent.getDeletedDirectories()) {
    builder.processLocallyDeletedFile(VcsUtil.getFilePath(CvsVfsUtil.getFileFor(dir,entry.getFileName()),true));
  }
  for (  Entry entry : dirContent.getDeletedFiles()) {
    builder.processLocallyDeletedFile(VcsUtil.getFilePath(CvsVfsUtil.getFileFor(dir,entry.getFileName()),false));
  }
  for (  VirtualFileEntry fileEntry : dirContent.getFiles()) {
    processFile(dir,fileEntry.getVirtualFile(),fileEntry.getEntry(),builder);
  }
  if (recursively) {
    for (    VirtualFile file : dir.getChildren()) {
      if (file.isDirectory()) {
        processEntriesIn(file,scope,builder,true);
      }
    }
  }
}
