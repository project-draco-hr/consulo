{
  OrderEnumerator base=OrderEnumerator.orderEntries(module);
  if (type == OrderRootType.CLASSES || type == OrderRootType.SOURCES) {
    base=base.exportedOnly();
  }
  if (type == OrderRootType.CLASSES) {
    return base.withoutModuleSourceEntries().recursively().exportedOnly().classes();
  }
  if (type == OrderRootType.SOURCES) {
    return base.recursively().exportedOnly().sources();
  }
  if (type.collectFromDependentModules()) {
    return base.recursively().roots(type);
  }
  return base.roots(type);
}
