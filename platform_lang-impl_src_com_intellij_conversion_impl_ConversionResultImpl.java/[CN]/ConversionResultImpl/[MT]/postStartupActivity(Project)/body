{
  final Application application=ApplicationManager.getApplication();
  if (application.isHeadlessEnvironment() || application.isUnitTestMode()) {
    return;
  }
  List<VirtualFile> changedFiles=findVirtualFiles(myChangedFiles);
  if (!changedFiles.isEmpty()) {
    EditAction.editFilesAndShowErrors(project,changedFiles);
  }
  final List<VirtualFile> createdFiles=findVirtualFiles(myCreatedFiles);
  if (containsFilesUnderVcs(createdFiles,project)) {
    final VcsShowConfirmationOptionImpl option=new VcsShowConfirmationOptionImpl("","","","","");
    final Collection<VirtualFile> selected=AbstractVcsHelper.getInstance(project).selectFilesToProcess(createdFiles,"Files Created","Select files to be added to version control",null,null,option);
    if (selected != null && !selected.isEmpty()) {
      final ChangeListManagerImpl changeListManager=ChangeListManagerImpl.getInstanceImpl(project);
      changeListManager.addUnversionedFiles(changeListManager.getDefaultChangeList(),new ArrayList<VirtualFile>(selected));
    }
  }
}
