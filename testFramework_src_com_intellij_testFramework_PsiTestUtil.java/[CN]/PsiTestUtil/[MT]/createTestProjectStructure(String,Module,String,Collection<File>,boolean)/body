{
  File dir=FileUtil.createTempDirectory(tempName,null);
  filesToDelete.add(dir);
  VirtualFile vDir=LocalFileSystem.getInstance().refreshAndFindFileByPath(dir.getCanonicalPath().replace(File.separatorChar,'/'));
  if (rootPath != null) {
    VirtualFile vDir1=LocalFileSystem.getInstance().findFileByPath(rootPath.replace(File.separatorChar,'/'));
    if (vDir1 == null) {
      throw new Exception(rootPath + " not found");
    }
    VfsUtil.copyDirectory(null,vDir1,vDir,null);
  }
  if (addProjectRoots) {
    addSourceContentToRoots(module,vDir);
  }
  return vDir;
}
