{
  if (icon instanceof ImageIcon) {
    Image image=((ImageIcon)icon).getImage();
    PixelGrabber grabber=new PixelGrabber(image,0,0,-1,-1,true);
    try {
      grabber.grabPixels();
    }
 catch (    InterruptedException e) {
    }
    int[] pixels=(int[])grabber.getPixels();
    System.arraycopy(pixels,0,pixels=new int[pixels.length],0,pixels.length);
    for (int i=0; i < pixels.length; i++) {
      int pixel=pixels[i];
      int alpha=(pixel >> 24) & 0xff;
      if (alpha == 0)       continue;
      int red=(pixel >> 16) & 0xFF;
      red=0xff;
      int green=(pixel >> 8) & 0xFF;
      int blue=(pixel >> 0) & 0xFF;
      int value;
      value=((alpha & 0xFF) << 24) | ((red & 0xFF) << 16) | ((green & 0xFF) << 8)| ((blue & 0xFF) << 0);
      pixels[i]=value;
    }
    final BufferedImage buffered=new BufferedImage(icon.getIconWidth(),icon.getIconHeight(),BufferedImage.TYPE_INT_ARGB);
    buffered.setRGB(0,0,icon.getIconWidth(),icon.getIconHeight(),pixels,0,icon.getIconWidth());
    image=buffered;
    icon=IconLoader.getIcon(image);
    return icon;
  }
 else   if (icon instanceof RowIcon) {
    RowIcon rowIcon=new RowIcon(((RowIcon)icon).getIconCount());
    for (int i=0; i < ((RowIcon)icon).getIconCount(); i++) {
      Icon subIcon=((RowIcon)icon).getIcon(i);
      Icon reddened=redden(subIcon);
      rowIcon.setIcon(reddened,i);
    }
    return rowIcon;
  }
 else   if (icon instanceof LayeredIcon) {
    Icon firstIcon=((LayeredIcon)icon).getIcons()[0];
    Icon reddened=redden(firstIcon);
    return ((LayeredIcon)icon).replaceFirstIcon(reddened);
  }
 else {
    return null;
  }
}
