{
  String protocol=url.getProtocol();
  String path=url.getPath();
  if (protocol.equals(JAR)) {
    if (path.startsWith(FILE + PROTOCOL_DELIMITER)) {
      try {
        URL subURL=new URL(path);
        path=subURL.getPath();
      }
 catch (      MalformedURLException e) {
        throw new RuntimeException("Can not parse URL, unhandled exception thrown ",e);
      }
    }
 else {
      throw new RuntimeException(new IOException("Can not parse URL " + url.toExternalForm()));
    }
  }
  if (SystemInfo.isWindows || SystemInfo.isOS2) {
    while (path.charAt(0) == '/') {
      path=path.substring(1,path.length());
    }
  }
  path=StringUtil.replace(path,"%20"," ");
  String vfUrl=protocol + "://" + path;
  return vfUrl;
}
