{
  VirtualFile[] children=fromDir.getChildren();
  for (int i=0; i < children.length; i++) {
    VirtualFile child=children[i];
    if (filter == null || filter.accept(child)) {
      if (!child.isDirectory()) {
        copyFile(requestor,child,toDir);
      }
 else {
        VirtualFile newChild=toDir.createChildDirectory(requestor,child.getName());
        copyDirectory(requestor,child,newChild,filter);
      }
    }
  }
}
