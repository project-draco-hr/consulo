{
  if (elementToMove instanceof PsiPackage) {
    final PsiDirectory[] directories=((PsiPackage)elementToMove).getDirectories();
    for (    PsiDirectory directory : directories) {
      checkMove(directory,readOnly);
    }
  }
 else   if (elementToMove instanceof PsiDirectory) {
    final PsiFile[] files=((PsiDirectory)elementToMove).getFiles();
    if (!elementToMove.isWritable()) {
      readOnly.add(((PsiDirectory)elementToMove).getVirtualFile());
      return;
    }
    for (    PsiFile file : files) {
      checkMove(file,readOnly);
    }
    final PsiDirectory[] subdirectories=((PsiDirectory)elementToMove).getSubdirectories();
    for (    PsiDirectory subdirectory : subdirectories) {
      checkMove(subdirectory,readOnly);
    }
  }
 else   if (elementToMove instanceof PsiJavaFile) {
    if (!elementToMove.isWritable()) {
      readOnly.add(((PsiFile)elementToMove).getVirtualFile());
    }
  }
}
