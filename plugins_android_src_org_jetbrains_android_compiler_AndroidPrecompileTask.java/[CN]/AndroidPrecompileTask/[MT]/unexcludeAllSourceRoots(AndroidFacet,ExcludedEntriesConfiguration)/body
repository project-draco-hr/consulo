{
  final VirtualFile[] sourceRoots=ModuleRootManager.getInstance(facet.getModule()).getSourceRoots();
  final Set<VirtualFile> sourceRootSet=new HashSet<VirtualFile>();
  sourceRootSet.addAll(Arrays.asList(sourceRoots));
  final String aidlGenSourceRootPath=AndroidRootUtil.getAidlGenSourceRootPath(facet);
  if (aidlGenSourceRootPath != null) {
    final VirtualFile aidlGenSourceRoot=LocalFileSystem.getInstance().findFileByPath(aidlGenSourceRootPath);
    if (aidlGenSourceRoot != null) {
      sourceRootSet.remove(aidlGenSourceRoot);
    }
  }
  final String aptGenSourceRootPath=AndroidRootUtil.getAptGenSourceRootPath(facet);
  if (aptGenSourceRootPath != null) {
    final VirtualFile aptGenSourceRoot=LocalFileSystem.getInstance().findFileByPath(aptGenSourceRootPath);
    if (aptGenSourceRoot != null) {
      sourceRootSet.remove(aptGenSourceRoot);
    }
  }
  final VirtualFile rsGenRoot=AndroidRootUtil.getRenderscriptGenDir(facet);
  if (rsGenRoot != null) {
    sourceRootSet.remove(rsGenRoot);
  }
  final VirtualFile buildconfigGenDir=AndroidRootUtil.getBuildconfigGenDir(facet);
  if (buildconfigGenDir != null) {
    sourceRootSet.remove(buildconfigGenDir);
  }
  final ExcludeEntryDescription[] descriptions=configuration.getExcludeEntryDescriptions();
  configuration.removeAllExcludeEntryDescriptions();
  for (  ExcludeEntryDescription description : descriptions) {
    final VirtualFile file=description.getVirtualFile();
    if (file == null || !sourceRootSet.contains(file)) {
      configuration.addExcludeEntryDescription(description);
    }
  }
}
