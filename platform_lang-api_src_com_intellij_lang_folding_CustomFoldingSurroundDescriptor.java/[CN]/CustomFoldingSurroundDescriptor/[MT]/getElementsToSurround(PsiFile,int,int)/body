{
  if (startOffset >= endOffset - 1)   return PsiElement.EMPTY_ARRAY;
  Commenter commenter=LanguageCommenters.INSTANCE.forLanguage(file.getLanguage());
  if (commenter == null || commenter.getLineCommentPrefix() == null)   return PsiElement.EMPTY_ARRAY;
  PsiElement startElement=file.findElementAt(startOffset);
  if (startElement instanceof PsiWhiteSpace)   startElement=startElement.getNextSibling();
  PsiElement endElement=file.findElementAt(endOffset - 1);
  if (endElement instanceof PsiWhiteSpace)   endElement=endElement.getPrevSibling();
  if (startElement != null && endElement != null) {
    if (startElement.getTextRange().getStartOffset() > endElement.getTextRange().getStartOffset())     return PsiElement.EMPTY_ARRAY;
    startElement=findClosestParentAfterLineBreak(startElement);
    if (startElement != null) {
      endElement=findClosestParentBeforeLineBreak(endElement);
      if (endElement != null) {
        PsiElement commonParent=startElement.getParent();
        if (endElement.getParent() == commonParent) {
          if (startElement == endElement)           return new PsiElement[]{startElement};
          return new PsiElement[]{startElement,endElement};
        }
      }
    }
  }
  return PsiElement.EMPTY_ARRAY;
}
