{
  Component focusOwner=IdeFocusManager.getGlobalInstance().getFocusOwner();
  DataContext dataContext=DataManager.getInstance().getDataContext(focusOwner);
  boolean isDisposeInProgress=ApplicationManager.getApplication().isDisposeInProgress();
  Editor activeEditor=isDisposeInProgress ? null : CommonDataKeys.EDITOR.getData(dataContext);
  if (activeEditor != null && activeEditor.getDocument() != document) {
    activeEditor=null;
  }
  return activeEditor;
}
