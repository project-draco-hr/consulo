{
  final Runnable action=new Runnable(){
    public void run(){
      generalCommit(processor);
    }
  }
;
  if (myForceSyncCommit) {
    ProgressManager.getInstance().runProcessWithProgressSynchronously(action,myActionName,true,myProject);
    return doesntContainErrors(processor.getVcsExceptions());
  }
 else {
    Task.Backgroundable task=new Task.Backgroundable(myProject,myActionName,true,myConfiguration.getCommitOption()){
      public void run(      @NotNull final ProgressIndicator indicator){
        final ProjectLevelVcsManager vcsManager=ProjectLevelVcsManager.getInstance(myProject);
        vcsManager.startBackgroundVcsOperation();
        try {
          action.run();
        }
  finally {
          vcsManager.stopBackgroundVcsOperation();
        }
      }
      @Override public NotificationInfo notifyFinished(){
        final List<Change> changesFailedToCommit=processor.getChangesFailedToCommit();
        int failed=changesFailedToCommit.size();
        int committed=myIncludedChanges.size() - failed;
        String text=committed + " " + StringUtil.pluralize("change",committed)+ " committed";
        if (failed > 0) {
          text+=", " + failed + " "+ StringUtil.pluralize("change",failed)+ " failed to commit";
        }
        String content=StringUtil.isEmpty(myCommitMessage) ? text : text + ": " + escape(myCommitMessage);
        VcsBalloonProblemNotifier.NOTIFICATION_GROUP.createNotification(content,NotificationType.INFORMATION).notify(myProject);
        return new NotificationInfo("VCS Commit","VCS Commit Finished",text,true);
      }
    }
;
    ProgressManager.getInstance().run(task);
    return false;
  }
}
