{
  final JUnitConfiguration configuration=(JUnitConfiguration)getModel().getProperties().getConfiguration();
  final TestMethods testMethods=new TestMethods(configuration.getProject(),configuration,myRunnerSettings,myConfigurationPerRunnerSettings,getFailedTests(configuration.getProject()));
  return new MyRunProfile(configuration){
    @NotNull public Module[] getModules(){
      return testMethods.getModulesToCompile();
    }
    public RunProfileState getState(    @NotNull Executor executor,    @NotNull ExecutionEnvironment env) throws ExecutionException {
      testMethods.clear();
      return testMethods;
    }
    @Override public void clear(){
      testMethods.clear();
      super.clear();
    }
  }
;
}
