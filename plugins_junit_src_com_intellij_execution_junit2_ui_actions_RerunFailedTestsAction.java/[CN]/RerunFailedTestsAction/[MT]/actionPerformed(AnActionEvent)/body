{
  List<AbstractTestProxy> failed=getFailedTests();
  final DataContext dataContext=e.getDataContext();
  Project project=DataKeys.PROJECT.getData(dataContext);
  JUnitConfiguration configuration=myModel.getProperties().getConfiguration();
  final TestMethods testMethods=new TestMethods(project,configuration,myRunnerSettings,myConfigurationPerRunnerSettings,failed);
  boolean isDebug=myConsoleProperties.getDebugSession() != null;
  final JavaProgramRunner defaultRunner=isDebug ? ExecutionRegistry.getInstance().getDebuggerRunner() : ExecutionRegistry.getInstance().getDefaultRunner();
  try {
    final RunProfile profile=new RunProfile(){
      public RunProfileState getState(      DataContext context,      RunnerInfo runnerInfo,      RunnerSettings runnerSettings,      ConfigurationPerRunnerSettings configurationSettings) throws ExecutionException {
        testMethods.clear();
        return testMethods;
      }
      public String getName(){
        return ExecutionBundle.message("rerun.failed.tests.action.name");
      }
      public void checkConfiguration() throws RuntimeConfigurationException {
      }
      public Module[] getModules(){
        return Module.EMPTY_ARRAY;
      }
    }
;
    RunStrategyImpl.getInstance().execute(profile,dataContext,defaultRunner,myRunnerSettings,myConfigurationPerRunnerSettings);
  }
 catch (  ExecutionException e1) {
    LOG.error(e1);
  }
 finally {
    testMethods.clear();
  }
}
