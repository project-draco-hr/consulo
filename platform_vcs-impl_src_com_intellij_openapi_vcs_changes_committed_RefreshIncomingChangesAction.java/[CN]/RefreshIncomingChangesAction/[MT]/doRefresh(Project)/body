{
  final CommittedChangesCache cache=CommittedChangesCache.getInstance(project);
  cache.hasCachesForAnyRoot(new Consumer<Boolean>(){
    public void consume(    final Boolean notEmpty){
      if ((!notEmpty) && (!CacheSettingsDialog.showSettingsDialog(project))) {
        return;
      }
      cache.refreshAllCachesAsync(true,false);
      cache.refreshIncomingChangesAsync();
    }
  }
);
}
