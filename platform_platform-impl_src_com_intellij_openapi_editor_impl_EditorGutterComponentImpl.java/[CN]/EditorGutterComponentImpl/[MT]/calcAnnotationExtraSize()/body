{
  myTextAnnotationExtraSize=0;
  if (!myEditor.isInDistractionFreeMode() || isMirrored())   return;
  Window frame=SwingUtilities.getWindowAncestor(myEditor.getComponent());
  if (frame == null)   return;
  EditorSettings settings=myEditor.getSettings();
  int rightMargin=settings.getRightMargin(myEditor.getProject());
  if (rightMargin <= 0)   return;
  JComponent editorComponent=myEditor.getComponent();
  RelativePoint point=new RelativePoint(editorComponent,new Point(0,0));
  Point editorLocationInWindow=point.getPoint(frame);
  int editorLocationX=(int)editorLocationInWindow.getX();
  int rightMarginX=rightMargin * EditorUtil.getSpaceWidth(Font.PLAIN,myEditor) + editorLocationX;
  int width=editorLocationX + editorComponent.getWidth();
  if (rightMarginX < width && editorLocationX < width - rightMarginX) {
    int centeredSize=(width - rightMarginX - editorLocationX) / 2 - (myLineMarkerAreaWidth + getLineNumberAreaWidth());
    myTextAnnotationExtraSize=Math.max(0,centeredSize - myTextAnnotationGuttersSize);
  }
}
