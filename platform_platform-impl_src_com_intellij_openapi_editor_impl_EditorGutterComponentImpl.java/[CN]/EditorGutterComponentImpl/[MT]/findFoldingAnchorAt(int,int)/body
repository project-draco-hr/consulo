{
  if (!myEditor.getSettings().isFoldingOutlineShown())   return null;
  int anchorX=getFoldingAreaOffset();
  int anchorWidth=getFoldingAnchorWidth();
  FoldRegion[] visibleRanges=((FoldingModelImpl)myEditor.getFoldingModel()).fetchVisible();
  for (  FoldRegion foldRange : visibleRanges) {
    if (!foldRange.isValid())     continue;
    final FoldingGroup group=foldRange.getGroup();
    if (group != null && ((FoldingModelImpl)myEditor.getFoldingModel()).getFirstRegion(group) != foldRange) {
      continue;
    }
    VisualPosition foldStart=offsetToLineStartPosition(foldRange.getStartOffset());
    final int endOffset=getEndOffset(foldRange);
    VisualPosition foldEnd=offsetToLineStartPosition(endOffset);
    final Document document=myEditor.getDocument();
    if (document.getLineNumber(foldRange.getStartOffset()) == document.getLineNumber(endOffset)) {
      continue;
    }
    if (rectByFoldOffset(foldStart,anchorWidth,anchorX).contains(x,y))     return foldRange;
    if ((group == null || foldRange.isExpanded()) && rectByFoldOffset(foldEnd,anchorWidth,anchorX).contains(x,y))     return foldRange;
  }
  return null;
}
