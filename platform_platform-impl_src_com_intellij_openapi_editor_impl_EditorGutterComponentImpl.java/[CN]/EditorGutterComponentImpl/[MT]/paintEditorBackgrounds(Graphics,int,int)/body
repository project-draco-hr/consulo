{
  myTextFgColors.clear();
  Color defaultBackgroundColor=myEditor.getBackgroundColor();
  Color defaultForegroundColor=myEditor.getColorsScheme().getDefaultForeground();
  int startX=myEditor.isInDistractionFreeMode() ? 0 : getWhitespaceSeparatorOffset() + (isFoldingOutlineShown() ? 1 : 0);
  if (myEditor.myUseNewRendering) {
    com.intellij.openapi.editor.impl.view.IterationState state=new com.intellij.openapi.editor.impl.view.IterationState(myEditor,firstVisibleOffset,lastVisibleOffset,false,true,false,true,false);
    while (!state.atEnd()) {
      drawEditorBackgroundForRange(g,state.getStartOffset(),state.getEndOffset(),state.getMergedAttributes(),defaultBackgroundColor,defaultForegroundColor,startX);
      state.advance();
    }
  }
 else {
    IterationState state=new IterationState(myEditor,firstVisibleOffset,lastVisibleOffset,false,true);
    while (!state.atEnd()) {
      drawEditorBackgroundForRange(g,state.getStartOffset(),state.getEndOffset(),state.getMergedAttributes(),defaultBackgroundColor,defaultForegroundColor,startX);
      state.advance();
    }
  }
}
