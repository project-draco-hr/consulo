{
  VisualPosition visualStart=myEditor.offsetToVisualPosition(startOffset,true,false);
  VisualPosition visualEnd=myEditor.offsetToVisualPosition(endOffset,false,true);
  for (int line=visualStart.getLine(); line <= visualEnd.getLine(); line++) {
    if (line == visualStart.getLine()) {
      if (visualStart.getColumn() == 0) {
        drawEditorLineBackgroundRect(g,attributes,line,defaultBackgroundColor,defaultForegroundColor,startX,myEditor.visibleLineToY(line));
      }
    }
 else     if (line != visualEnd.getLine() || visualEnd.getColumn() != 0) {
      drawEditorLineBackgroundRect(g,attributes,line,defaultBackgroundColor,defaultForegroundColor,startX,myEditor.visibleLineToY(line));
    }
  }
}
