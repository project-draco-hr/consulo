{
  Rectangle clip=g.getClipBounds();
  int anchorX=getFoldingAreaOffset();
  int width=getFoldingAnchorWidth();
  FoldRegion[] visibleFoldRegions=((FoldingModelImpl)myEditor.getFoldingModel()).fetchVisible();
  int firstVisibleOffset=myEditor.logicalPositionToOffset(myEditor.xyToLogicalPosition(new Point(0,clip.y - myEditor.getLineHeight())));
  int lastVisibleOffset=myEditor.logicalPositionToOffset(myEditor.xyToLogicalPosition(new Point(0,clip.y + clip.height + myEditor.getLineHeight())));
  for (  FoldRegion visibleFoldRegion : visibleFoldRegions) {
    if (!visibleFoldRegion.isValid())     continue;
    if (visibleFoldRegion.getStartOffset() > lastVisibleOffset)     continue;
    if (getEndOffset(visibleFoldRegion) < firstVisibleOffset)     continue;
    drawAnchor(visibleFoldRegion,width,clip,g,anchorX,false,false);
  }
  if (myActiveFoldRegion != null) {
    drawAnchor(myActiveFoldRegion,width,clip,g,anchorX,true,true);
    drawAnchor(myActiveFoldRegion,width,clip,g,anchorX,true,false);
  }
}
