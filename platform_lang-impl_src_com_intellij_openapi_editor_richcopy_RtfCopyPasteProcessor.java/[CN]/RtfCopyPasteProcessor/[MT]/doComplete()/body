{
  StringBuilder builder=StringBuilderSpinAllocator.alloc();
  try {
    builder.append(HEADER_PREFIX);
    builder.append("{\\colortbl;");
    for (    int id : myColorRegistry.getAllIds()) {
      Color color=myColorRegistry.dataById(id);
      builder.append(String.format("\\red%d\\green%d\\blue%d;",color.getRed(),color.getGreen(),color.getBlue()));
    }
    builder.append("}\n");
    builder.append("{\\fonttbl");
    for (    int id : myFontNameRegistry.getAllIds()) {
      String fontName=myFontNameRegistry.dataById(id);
      builder.append(String.format("{\\f%d %s;}",id,fontName));
    }
    builder.append("}\n");
    myBuilder.insert(0,builder);
  }
  finally {
    StringBuilderSpinAllocator.dispose(builder);
  }
  myBuilder.append("\\par");
  myBuilder.append(HEADER_SUFFIX);
}
