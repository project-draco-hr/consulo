{
  HgCommandExecutor executor=new HgCommandExecutor(myProject);
  VirtualFile sourceRepo=VcsUtil.getVcsRootFor(myProject,source);
  VirtualFile targetRepo=VcsUtil.getVcsRootFor(myProject,target);
  if (sourceRepo != null && targetRepo != null && sourceRepo.equals(targetRepo)) {
    executor.execute(sourceRepo,"copy",Arrays.asList("--after",VcsFileUtil.relativeOrFullPath(sourceRepo,source),VcsFileUtil.relativeOrFullPath(targetRepo,target)),null);
  }
 else {
    if (targetRepo != null) {
      new HgAddCommand(myProject).execute(Collections.singleton(target));
    }
  }
}
