{
  final Module module=myRefModule.getModule();
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    @Override public void run(){
      final ModifiableRootModel model=ModuleRootManager.getInstance(module).getModifiableModel();
      for (      OrderEntry entry : model.getOrderEntries()) {
        if (entry instanceof LibraryOrderEntry && Comparing.strEqual(entry.getPresentableName(),myOrderEntry.getPresentableName())) {
          if (myFiles == null) {
            model.removeOrderEntry(entry);
          }
 else {
            final Library library=((LibraryOrderEntry)entry).getLibrary();
            if (library != null) {
              final Library.ModifiableModel modifiableModel=library.getModifiableModel();
              for (              VirtualFile file : myFiles) {
                modifiableModel.removeRoot(file.getUrl(),OrderRootType.CLASSES);
              }
              modifiableModel.commit();
            }
          }
        }
      }
      model.commit();
    }
  }
);
}
