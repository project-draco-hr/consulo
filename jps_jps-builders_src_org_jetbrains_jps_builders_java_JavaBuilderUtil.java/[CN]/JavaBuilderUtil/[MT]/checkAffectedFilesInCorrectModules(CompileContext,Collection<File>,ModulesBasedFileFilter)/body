{
  if (affected.isEmpty()) {
    return Collections.emptyList();
  }
  final List<Pair<File,JpsModule>> result=new ArrayList<Pair<File,JpsModule>>();
  for (  File file : affected) {
    if (!moduleBasedFilter.accept(file)) {
      final RootDescriptor moduleAndRoot=context.getProjectDescriptor().getBuildRootIndex().getModuleAndRoot(context,file);
      result.add(Pair.create(file,moduleAndRoot != null ? moduleAndRoot.target.getModule() : null));
    }
  }
  return result;
}
