{
  final List<VirtualFile> filesInScope=new ArrayList<VirtualFile>(files.size());
  ApplicationManager.getApplication().runReadAction(new Runnable(){
    @Override public void run(){
      for (      VirtualFile file : files) {
        if (context.getCompileScope().belongs(file.getUrl())) {
          final Module module=context.getModuleByFile(file);
          if (chunk.getNodes().contains(module)) {
            filesInScope.add(file);
          }
        }
      }
    }
  }
);
  return filesInScope;
}
