{
  final Map<Module,List<VirtualFile>> moduleToFilesMap=CompilerUtil.buildModuleToFilesMap(context,snapshot);
  for (  Chunk<Module> moduleChunk : allChunks) {
    List<VirtualFile> files=Collections.emptyList();
    for (    Module module : moduleChunk.getNodes()) {
      final List<VirtualFile> moduleFiles=moduleToFilesMap.get(module);
      if (moduleFiles != null) {
        files=ContainerUtil.concat(files,moduleFiles);
      }
    }
    chunkMap.put(moduleChunk,files);
  }
}
