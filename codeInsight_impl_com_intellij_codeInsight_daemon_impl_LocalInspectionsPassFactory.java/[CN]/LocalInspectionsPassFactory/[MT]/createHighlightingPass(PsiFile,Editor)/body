{
  TextRange textRange=calculateRangeToProcess(editor);
  if (textRange == null)   return null;
  DaemonCodeAnalyzer daemonCodeAnalyzer=DaemonCodeAnalyzer.getInstance(myProject);
  ExecutorService executorService=daemonCodeAnalyzer.getDaemonExecutorService();
  return new LocalInspectionsPass(file,editor.getDocument(),textRange.getStartOffset(),textRange.getEndOffset(),executorService);
}
