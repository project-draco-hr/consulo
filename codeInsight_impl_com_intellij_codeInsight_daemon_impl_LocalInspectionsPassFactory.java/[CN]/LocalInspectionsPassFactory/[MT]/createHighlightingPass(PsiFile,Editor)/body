{
  TextRange textRange=calculateRangeToProcess(editor);
  if (textRange == null)   return new ProgressableTextEditorHighlightingPass.EmptyPass(myProject,editor.getDocument(),LocalInspectionsPass.IN_PROGRESS_ICON,LocalInspectionsPass.PRESENTABLE_NAME);
  DaemonCodeAnalyzer daemonCodeAnalyzer=DaemonCodeAnalyzer.getInstance(myProject);
  ExecutorService executorService=daemonCodeAnalyzer.getDaemonExecutorService();
  return new LocalInspectionsPass(file,editor.getDocument(),textRange.getStartOffset(),textRange.getEndOffset(),executorService);
}
