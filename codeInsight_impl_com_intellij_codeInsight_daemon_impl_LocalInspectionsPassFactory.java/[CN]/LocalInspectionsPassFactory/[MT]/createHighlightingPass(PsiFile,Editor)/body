{
  TextRange textRange=calculateRangeToProcess(editor);
  if (textRange == null)   return null;
  DaemonCodeAnalyzerImpl daemonCodeAnalyzer=(DaemonCodeAnalyzerImpl)DaemonCodeAnalyzer.getInstance(myProject);
  ExecutorService executorService=daemonCodeAnalyzer.getDaemonExecutorService();
  return new LocalInspectionsPass(myProject,file,editor.getDocument(),textRange.getStartOffset(),textRange.getEndOffset(),executorService,daemonCodeAnalyzer.getUpdateProgress());
}
