{
  final UIDefaults uiDefaults=UIManager.getLookAndFeelDefaults();
  fixPopupWeight();
  fixGtkPopupStyle();
  fixTreeWideSelection(uiDefaults);
  fixMenuIssues(uiDefaults);
  if (UIUtil.isUnderAquaLookAndFeel()) {
    uiDefaults.put("Panel.opaque",Boolean.TRUE);
    uiDefaults.put("ScrollBarUI","com.intellij.ide.ui.laf.IntelliJButtonlessScrollBarUI");
  }
 else   if (UIUtil.isWinLafOnVista()) {
    uiDefaults.put("ComboBox.border",null);
  }
  initInputMapDefaults(uiDefaults);
  uiDefaults.put("Button.defaultButtonFollowsFocus",Boolean.FALSE);
  patchFileChooserStrings(uiDefaults);
  patchLafFonts(uiDefaults);
  patchOptionPaneIcons(uiDefaults);
  fixSeparatorColor(uiDefaults);
  updateToolWindows();
  for (  Frame frame : Frame.getFrames()) {
    updateUI(frame);
  }
  fireLookAndFeelChanged();
}
