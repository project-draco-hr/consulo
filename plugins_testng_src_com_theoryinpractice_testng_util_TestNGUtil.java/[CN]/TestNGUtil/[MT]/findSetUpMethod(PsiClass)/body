{
  final PsiManager manager=psiClass.getManager();
  final PsiElementFactory factory=manager.getElementFactory();
  final PsiMethod patternMethod=factory.createMethodFromText("@org.testng.annotations.BeforeMethod\n protected void setUp() throws Exception {}",null);
  final PsiMethod[] psiMethods=psiClass.getMethods();
  PsiMethod inClass=null;
  for (  PsiMethod psiMethod : psiMethods) {
    if (AnnotationUtil.isAnnotated(psiMethod,BeforeMethod.class.getName(),false)) {
      inClass=psiMethod;
      break;
    }
  }
  if (inClass == null) {
    final PsiMethod psiMethod=(PsiMethod)psiClass.add(patternMethod);
    CodeStyleManager.getInstance(psiClass.getProject()).shortenClassReferences(psiClass);
    return psiMethod;
  }
 else   if (inClass.getBody() == null) {
    return (PsiMethod)inClass.replace(patternMethod);
  }
  return inClass;
}
