{
  final Project project=psiElement.getProject();
  final PsiManager manager=PsiManager.getInstance(project);
  if (JavaPsiFacade.getInstance(manager.getProject()).findClass(TestNG.class.getName(),psiElement.getResolveScope()) == null) {
    if (!ApplicationManager.getApplication().isUnitTestMode()) {
      if (Messages.showOkCancelDialog(psiElement.getProject(),"TestNG will be added to module classpath","Unable to convert.",Messages.getWarningIcon()) != DialogWrapper.OK_EXIT_CODE) {
        return false;
      }
    }
    final Module module=ModuleUtil.findModuleForPsiElement(psiElement);
    if (module == null)     return false;
    String url=VfsUtil.getUrlForLibraryRoot(new File(PathUtil.getJarPathForClass(Assert.class)));
    ModuleRootModificationUtil.addModuleLibrary(module,url);
  }
  return true;
}
