{
  ProgressWindowWithNotification progressWindow=new ProgressWindowWithNotification(true,debuggerContext.getProject());
  SuspendContextCommandImpl askSetAction=new DebuggerContextCommandImpl(debuggerContext){
    public void threadAction(){
      final NodeDescriptorImpl descriptor=node.getDescriptor();
      String initialString="";
      if (descriptor instanceof ValueDescriptorImpl) {
        Value currentValue=((ValueDescriptorImpl)descriptor).getValue();
        if (currentValue instanceof StringReference) {
          initialString=DebuggerUtilsEx.getValueOrErrorAsString(debuggerContext.createEvaluationContext(),currentValue);
          initialString=initialString == null ? "" : "\"" + DebuggerUtilsEx.translateStringValue(initialString) + "\"";
        }
 else         if (currentValue instanceof PrimitiveValue) {
          ValueLabelRenderer renderer=((ValueDescriptorImpl)descriptor).getRenderer(debuggerContext.getDebugProcess());
          initialString=getDisplayableString((PrimitiveValue)currentValue,renderer instanceof NodeRenderer && HexRenderer.UNIQUE_ID.equals(renderer.getUniqueId()));
        }
        final String initialString1=initialString;
        final Project project=debuggerContext.getProject();
        DebuggerInvocationUtil.invokeLater(project,new Runnable(){
          public void run(){
            showEditor(new TextWithImportsImpl(CodeFragmentKind.EXPRESSION,initialString1),node,debuggerContext,setValueRunnable);
          }
        }
);
      }
    }
  }
;
  progressWindow.setTitle(DebuggerBundle.message("title.evaluating"));
  debuggerContext.getDebugProcess().getManagerThread().startProgress(askSetAction,progressWindow);
}
