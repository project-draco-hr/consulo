{
  CharSequence text=document.getCharsSequence();
  int foundOffset=offset - 1;
  for (; foundOffset > 0; foundOffset--) {
    char c=text.charAt(foundOffset);
    if (c != ' ' && c != '\t' && c != '\r' && c != '\n') {
      break;
    }
  }
  if (foundOffset == -1) {
    return -1;
  }
 else {
    return document.getLineNumber(foundOffset);
  }
}
