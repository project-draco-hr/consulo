{
  final IElementType tokenType=expression.getOperationTokenType();
  if (tokenType == JavaTokenType.ANDAND) {
    for (    PsiExpression operand : expression.getOperands()) {
      checkExpression(operand);
      if (agreeingInstanceof) {
        return;
      }
    }
    if (!inElse && conflictingInstanceof != null) {
      agreeingInstanceof=false;
    }
  }
 else   if (tokenType == JavaTokenType.OROR) {
    for (    PsiExpression operand : expression.getOperands()) {
      if (operand instanceof PsiPrefixExpression && ((PsiPrefixExpression)operand).getOperationTokenType() == JavaTokenType.EXCL) {
        inElse=true;
      }
      checkExpression(operand);
    }
    if (inElse && conflictingInstanceof != null) {
      agreeingInstanceof=false;
    }
  }
}
