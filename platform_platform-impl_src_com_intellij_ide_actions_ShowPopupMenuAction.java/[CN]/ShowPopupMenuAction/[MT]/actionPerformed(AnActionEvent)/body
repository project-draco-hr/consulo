{
  final RelativePoint relPoint=JBPopupFactory.getInstance().guessBestPopupLocation(e.getDataContext());
  KeyboardFocusManager focusManager=KeyboardFocusManager.getCurrentKeyboardFocusManager();
  Component focusOwner=focusManager.getFocusOwner();
  Point popupMenuPoint=relPoint.getPoint(focusOwner);
  final Editor editor=e.getData(PlatformDataKeys.EDITOR);
  int coord=editor != null ? Math.max(0,popupMenuPoint.y - 1) : popupMenuPoint.y;
  focusOwner.dispatchEvent(new MouseEvent(focusOwner,MouseEvent.MOUSE_PRESSED,System.currentTimeMillis(),0,popupMenuPoint.x,coord,1,true));
}
