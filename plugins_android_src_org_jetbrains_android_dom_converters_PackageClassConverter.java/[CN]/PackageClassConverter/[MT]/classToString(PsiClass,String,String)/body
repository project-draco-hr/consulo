{
  if (psiClass == null)   return null;
  String qName=getQualifiedName(psiClass);
  if (qName == null)   return null;
  PsiFile file=psiClass.getContainingFile();
  if (file instanceof PsiClassOwner) {
    PsiClassOwner psiFile=(PsiClassOwner)file;
    if (Comparing.equal(psiFile.getPackageName(),basePackageName)) {
      String name=getName(psiClass);
      if (name != null) {
        final String dottedName='.' + name;
        if (dottedName.startsWith(prefix)) {
          return dottedName;
        }
 else         if (name.startsWith(prefix)) {
          return name;
        }
      }
    }
 else     if (basePackageName != null && qName.startsWith(basePackageName)) {
      final String name=qName.substring(basePackageName.length());
      if (name.startsWith(prefix)) {
        return name;
      }
    }
  }
  return qName;
}
