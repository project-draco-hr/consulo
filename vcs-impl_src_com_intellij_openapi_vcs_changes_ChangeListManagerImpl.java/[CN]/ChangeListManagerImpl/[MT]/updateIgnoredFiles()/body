{
synchronized (myDataLock) {
    List<VirtualFile> unversionedFiles=myComposite.getVFHolder(FileHolder.HolderType.UNVERSIONED).getFiles();
    List<VirtualFile> ignoredFiles=myComposite.getVFHolder(FileHolder.HolderType.IGNORED).getFiles();
    for (    VirtualFile file : unversionedFiles) {
      if (isIgnoredFile(file)) {
        myComposite.getVFHolder(FileHolder.HolderType.UNVERSIONED).removeFile(file);
        myComposite.getVFHolder(FileHolder.HolderType.IGNORED).addFile(file);
      }
    }
    for (    VirtualFile file : ignoredFiles) {
      if (!isIgnoredFile(file)) {
        VcsDirtyScopeManager.getInstance(myProject).fileDirty(file);
      }
    }
    FileStatusManager.getInstance(getProject()).fileStatusesChanged();
    ChangesViewManager.getInstance(myProject).scheduleRefresh();
  }
}
