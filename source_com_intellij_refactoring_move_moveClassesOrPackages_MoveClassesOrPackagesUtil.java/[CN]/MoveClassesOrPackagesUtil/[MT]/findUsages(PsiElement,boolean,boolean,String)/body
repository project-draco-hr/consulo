{
  PsiManager manager=element.getManager();
  PsiSearchHelper helper=manager.getSearchHelper();
  if (Comparing.equal(getQualfiedName(element),newQName))   return new UsageInfo[0];
  ArrayList<UsageInfo> results=new ArrayList<UsageInfo>();
  Set<PsiReference> foundReferences=new HashSet<PsiReference>();
  GlobalSearchScope projectScope=GlobalSearchScope.projectScope(manager.getProject());
  PsiReference[] references=helper.findReferences(element,projectScope,false);
  for (int i=0; i < references.length; i++) {
    PsiReference reference=references[i];
    TextRange range=reference.getRangeInElement();
    if (foundReferences.contains(reference))     continue;
    results.add(new MoveRenameUsageInfo(reference.getElement(),reference,range.getStartOffset(),range.getEndOffset(),element,false));
    foundReferences.add(reference);
  }
  findNonCodeUsages(searchInStringsAndComments,searchInNonJavaFiles,element,newQName,results);
  return results.toArray(new UsageInfo[results.size()]);
}
