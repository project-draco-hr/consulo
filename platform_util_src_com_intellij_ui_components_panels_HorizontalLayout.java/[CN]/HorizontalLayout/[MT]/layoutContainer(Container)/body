{
synchronized (container.getTreeLock()) {
    Dimension left=getPreferredSize(myLeft);
    Dimension right=getPreferredSize(myRight);
    Dimension center=getPreferredSize(myCenter);
    Insets insets=container.getInsets();
    int width=container.getWidth() - insets.left - insets.right;
    int height=container.getHeight() - insets.top - insets.bottom;
    int leftX=0;
    if (left != null) {
      leftX=myGap + layout(myLeft,0,height,insets);
    }
    int rightX=width;
    if (right != null) {
      rightX-=right.width;
    }
    if (rightX < leftX) {
      rightX=leftX;
    }
    if (center != null) {
      int centerX=(width - center.width) / 2;
      if (centerX > leftX) {
        int centerRightX=centerX + center.width + myGap+ myGap;
        if (centerRightX > rightX) {
          centerX=rightX - center.width - myGap- myGap;
        }
      }
      if (centerX < leftX) {
        centerX=leftX;
      }
      centerX=myGap + layout(myCenter,centerX,height,insets);
      if (rightX < centerX) {
        rightX=centerX;
      }
    }
    if (right != null) {
      layout(myRight,rightX,height,insets);
    }
  }
}
