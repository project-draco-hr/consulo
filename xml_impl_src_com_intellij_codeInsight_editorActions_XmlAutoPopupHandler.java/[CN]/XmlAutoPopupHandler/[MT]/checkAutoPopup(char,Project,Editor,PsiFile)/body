{
  final boolean isXmlLikeFile=file.getLanguage() instanceof XMLLanguage || file.getViewProvider().getBaseLanguage() instanceof XMLLanguage;
  boolean spaceInTag=isXmlLikeFile && charTyped == ' ';
  if (spaceInTag) {
    spaceInTag=false;
    final PsiElement at=file.findElementAt(editor.getCaretModel().getOffset());
    if (at != null) {
      final PsiElement parent=at.getParent();
      if (parent instanceof XmlTag) {
        spaceInTag=true;
      }
    }
  }
  if ((charTyped == '<' || charTyped == '{' || charTyped == '/' || spaceInTag) && isXmlLikeFile) {
    autoPopupXmlLookup(project,editor);
    return Result.STOP;
  }
  return Result.CONTINUE;
}
