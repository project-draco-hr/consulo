{
  final List<VirtualFile> toCheck=new ArrayList<VirtualFile>(files.length);
  final LocalFileSystem lfs=LocalFileSystem.getInstance();
  for (  File file : files) {
    final VirtualFile vFile=lfs.findFileByIoFile(file);
    if (vFile != null) {
      toCheck.add(vFile);
    }
  }
  final ReadonlyStatusHandler.OperationStatus status=ReadonlyStatusHandler.getInstance(project).ensureFilesWritable(VfsUtil.toVirtualFileArray(toCheck));
  if (status.hasReadonlyFiles()) {
    throw new IOException(status.getReadonlyFilesMessage());
  }
}
