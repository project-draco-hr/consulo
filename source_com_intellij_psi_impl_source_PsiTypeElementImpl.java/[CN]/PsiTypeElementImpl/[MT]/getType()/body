{
  PsiType cachedType=myCachedType;
  if (cachedType != null)   return cachedType;
  TreeElement element=getFirstChildNode();
  while (element != null) {
    if (element.getTreeNext() == null && PRIMITIVE_TYPE_BIT_SET.contains(element.getElementType())) {
      myCachedType=cachedType=JavaPsiFacade.getInstance(getManager().getProject()).getElementFactory().createPrimitiveType(element.getText());
    }
 else     if (element.getElementType() == JavaElementType.TYPE) {
      PsiType componentType=((PsiTypeElement)SourceTreeToPsiMap.treeElementToPsi(element)).getType();
      myCachedType=cachedType=getLastChildNode().getElementType() == JavaTokenType.ELLIPSIS ? new PsiEllipsisType(componentType) : componentType.createArrayType();
    }
 else     if (element.getElementType() == JavaElementType.JAVA_CODE_REFERENCE) {
      myCachedType=cachedType=new PsiClassReferenceType(getReferenceElement());
    }
 else     if (element.getElementType() == JavaTokenType.QUEST) {
      myCachedType=cachedType=createWildcardType();
    }
    if (element.getTextLength() != 0)     break;
    element=element.getTreeNext();
  }
  return cachedType;
}
