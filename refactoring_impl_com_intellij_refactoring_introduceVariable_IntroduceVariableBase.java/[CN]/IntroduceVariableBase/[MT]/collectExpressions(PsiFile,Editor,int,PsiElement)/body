{
  final PsiElement elementAtCaret=file.findElementAt(TargetElementUtil.adjustOffset(editor.getDocument(),offset));
  final List<PsiExpression> expressions=new ArrayList<PsiExpression>();
  PsiExpression expression=PsiTreeUtil.getParentOfType(elementAtCaret,PsiExpression.class);
  while (expression != null) {
    if (!expressions.contains(expression) && !(expression instanceof PsiParenthesizedExpression) && !(expression instanceof PsiSuperExpression)&& expression.getType() != PsiType.VOID) {
      if (!(expression instanceof PsiReferenceExpression && expression.getParent() instanceof PsiMethodCallExpression)) {
        expressions.add(expression);
      }
    }
    expression=PsiTreeUtil.getParentOfType(expression,PsiExpression.class);
  }
  return expressions;
}
