{
  PsiExpression tempExpr;
  final PsiElement elementAt=file.findElementAt(startOffset);
  final PsiLiteralExpression literalExpression=PsiTreeUtil.getParentOfType(elementAt,PsiLiteralExpression.class);
  final PsiElementFactory elementFactory=JavaPsiFacade.getInstance(project).getElementFactory();
  try {
    String text=file.getText().subSequence(startOffset,endOffset).toString();
    PsiElement prefix=null;
    PsiElement suffix=null;
    if (literalExpression != null) {
      final String stripped=StringUtil.stripQuotesAroundValue(text);
      boolean primitive=false;
      if (stripped.equals("true") || stripped.equals("false")) {
        primitive=true;
      }
 else {
        try {
          Integer.parseInt(stripped);
          primitive=true;
        }
 catch (        NumberFormatException e1) {
        }
      }
      text=primitive ? stripped : ("\"" + stripped + "\"");
      final int offset=literalExpression.getTextOffset();
      if (offset + 1 < startOffset) {
        prefix=elementFactory.createExpressionFromText(file.getText().substring(offset,startOffset) + "\"",file);
      }
      if (offset + literalExpression.getTextLength() - 1 > endOffset) {
        suffix=elementFactory.createExpressionFromText("\"" + file.getText().substring(endOffset,offset + literalExpression.getTextLength()),file);
      }
    }
    tempExpr=elementFactory.createExpressionFromText(text,file);
    tempExpr.putUserData(ElementToWorkOn.PREFIX,prefix);
    tempExpr.putUserData(ElementToWorkOn.SUFFIX,suffix);
    tempExpr.putUserData(ElementToWorkOn.PARENT,elementAt);
  }
 catch (  IncorrectOperationException e) {
    tempExpr=null;
  }
  return tempExpr;
}
