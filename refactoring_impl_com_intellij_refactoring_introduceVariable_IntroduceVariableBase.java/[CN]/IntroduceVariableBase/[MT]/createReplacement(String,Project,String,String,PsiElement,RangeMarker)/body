{
  final String allText=parent.getContainingFile().getText();
  final TextRange parentRange=parent.getTextRange();
  String beg=allText.substring(parentRange.getStartOffset(),rangeMarker.getStartOffset());
  if (StringUtil.stripQuotesAroundValue(beg).length() == 0 && prefix == null)   beg="";
  String end=allText.substring(rangeMarker.getEndOffset(),parentRange.getEndOffset());
  if (StringUtil.stripQuotesAroundValue(end).length() == 0 && suffix == null)   end="";
  final String text=beg + (prefix != null ? prefix : "") + refText+ (suffix != null ? suffix : "")+ end;
  return JavaPsiFacade.getInstance(project).getElementFactory().createExpressionFromText(text,parent);
}
