{
  int offset=0;
  int startOffset=-1;
  int endOffset=-1;
  for (int i=0; i < myRelevantRangesInHostDocument.length; i++) {
    RangeMarker hostRange=myRelevantRangesInHostDocument[i];
    offset+=myPrefixes[i].length();
    int length=hostRange.getEndOffset() - hostRange.getStartOffset();
    TextRange intersection=new ProperTextRange(offset,offset + length).intersection(rangeToEdit);
    if (intersection != null) {
      if (startOffset == -1) {
        startOffset=intersection.getStartOffset();
      }
      endOffset=intersection.getEndOffset();
    }
    offset+=length;
    offset+=mySuffixes[i].length();
  }
  if (startOffset == -1 || startOffset == endOffset)   return null;
  return new ProperTextRange(startOffset,endOffset);
}
