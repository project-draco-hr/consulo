{
  if (intersectWithEditable(new TextRange(startOffset,startOffset)) == null || intersectWithEditable(new TextRange(endOffset,endOffset)) == null) {
    LOG.assertTrue(s.equals(getText().substring(startOffset,endOffset)));
    return;
  }
  if (isOneLine()) {
    s=StringUtil.replace(s.toString(),"\n","");
  }
  myDelegate.replaceString(injectedToHost(startOffset),injectedToHost(endOffset),s);
}
