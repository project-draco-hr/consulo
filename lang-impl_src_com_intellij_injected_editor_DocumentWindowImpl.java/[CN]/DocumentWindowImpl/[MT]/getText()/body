{
  StringBuilder text=new StringBuilder();
  String hostText=myDelegate.getText();
  for (  PsiLanguageInjectionHost.Shred shred : myShreds) {
    RangeMarker hostRange=shred.getHostRangeMarker();
    if (hostRange.isValid()) {
      text.append(shred.prefix);
      text.append(hostText,hostRange.getStartOffset(),hostRange.getEndOffset());
      text.append(shred.suffix);
    }
  }
  return text.toString();
}
