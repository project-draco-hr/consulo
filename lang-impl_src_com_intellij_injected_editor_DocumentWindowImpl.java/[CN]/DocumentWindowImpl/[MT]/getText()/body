{
  StringBuilder text=new StringBuilder();
  String hostText=myDelegate.getText();
  for (int i=0; i < myRelevantRangesInHostDocument.length; i++) {
    RangeMarker hostRange=myRelevantRangesInHostDocument[i];
    if (hostRange.isValid()) {
      text.append(myPrefixes[i]);
      text.append(hostText,hostRange.getStartOffset(),hostRange.getEndOffset());
      text.append(mySuffixes[i]);
    }
  }
  return text.toString();
}
