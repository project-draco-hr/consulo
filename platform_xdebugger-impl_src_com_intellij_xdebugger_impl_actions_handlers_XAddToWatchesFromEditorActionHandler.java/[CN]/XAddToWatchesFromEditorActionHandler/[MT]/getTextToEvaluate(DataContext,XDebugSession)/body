{
  final Editor editor=CommonDataKeys.EDITOR.getData(dataContext);
  if (editor == null) {
    return null;
  }
  String text=editor.getSelectionModel().getSelectedText();
  if (text == null && session.isSuspended()) {
    final XStackFrame stackFrame=session.getCurrentStackFrame();
    if (stackFrame != null) {
      text=XDebuggerEvaluateActionHandler.getExpressionText(stackFrame.getEvaluator(),editor.getProject(),editor);
    }
  }
  return StringUtil.isEmptyOrSpaces(text) ? null : text;
}
