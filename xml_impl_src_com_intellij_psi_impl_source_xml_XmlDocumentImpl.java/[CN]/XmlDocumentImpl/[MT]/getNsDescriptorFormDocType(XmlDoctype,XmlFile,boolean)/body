{
  XmlNSDescriptor descriptor=getNSDescriptorFromMetaData(doctype.getMarkupDecl(),true);
  final String filePath=getFilePathForLogging(containingFile);
  final String dtdUri=XmlUtil.getDtdUri(doctype);
  LOG.debug("DTD url for doctype " + doctype.getText() + " in file "+ filePath+ " is "+ dtdUri);
  if (dtdUri != null && dtdUri.length() > 0) {
    final XmlFile xmlFile=XmlUtil.findNamespace(containingFile,dtdUri);
    final String schemaFilePath=getFilePathForLogging(xmlFile);
    LOG.debug("Schema file for " + filePath + " is "+ schemaFilePath);
    XmlNSDescriptor descriptorFromDtd=getNSDescriptorFromMetaData(xmlFile == null ? null : xmlFile.getDocument(),forHtml);
    LOG.debug("Descriptor from meta data for schema file " + schemaFilePath + " is "+ (descriptorFromDtd != null ? descriptorFromDtd.getClass().getCanonicalName() : "NULL"));
    if (descriptor != null && descriptorFromDtd != null) {
      descriptor=new XmlNSDescriptorSequence(new XmlNSDescriptor[]{descriptor,descriptorFromDtd});
    }
 else     if (descriptorFromDtd != null) {
      descriptor=descriptorFromDtd;
    }
  }
  return descriptor;
}
