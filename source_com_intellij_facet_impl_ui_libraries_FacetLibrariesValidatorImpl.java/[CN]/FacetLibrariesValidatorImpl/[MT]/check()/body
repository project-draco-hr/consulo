{
  if (myRequiredLibraries == null) {
    return ValidationResult.OK;
  }
  ModuleRootModel rootModel=myContext.getRootModel();
  List<VirtualFile> roots=collectRoots(rootModel);
  RequiredLibrariesInfo.RequiredClassesNotFoundInfo info=myRequiredLibraries.checkLibraries(roots.toArray(new VirtualFile[roots.size()]));
  if (info == null) {
    return ValidationResult.OK;
  }
  String missingJars=IdeBundle.message("label.missed.libraries.prefix") + " " + info.getMissingJarsText();
  final String text=IdeBundle.message("label.missed.libraries.text",missingJars,info.getClassNames()[0]);
  LibraryInfo[] missingLibraries=info.getLibraryInfos();
  VirtualFile baseDir=myContext.getModule().getProject().getBaseDir();
  final String baseDirPath=baseDir != null ? baseDir.getPath() : "";
  LibraryCompositionSettings libraryCompositionSettings=new LibraryCompositionSettings(missingLibraries,myDescription.getDefaultLibraryName(),baseDirPath,myDescription.getDefaultLibraryName(),null);
  return new ValidationResult(text,new LibrariesQuickFix(libraryCompositionSettings));
}
