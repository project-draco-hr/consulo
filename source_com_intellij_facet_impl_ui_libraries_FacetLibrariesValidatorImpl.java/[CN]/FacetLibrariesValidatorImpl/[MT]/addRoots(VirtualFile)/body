{
  if (files.length == 0)   return;
  ModifiableRootModel rootModel=myContext.getModifiableRootModel();
  final Project project=myContext.getProject();
  if (rootModel == null || project == null) {
    myAddedRoots.addAll(Arrays.asList(files));
  }
 else {
    Library library=new WriteAction<Library>(){
      protected void run(      final Result<Library> result){
        result.setResult(createLibrary(files));
      }
    }
.execute().getResultObject();
    if (library != null) {
      rootModel.addLibraryEntry(library);
    }
  }
  onChange();
}
