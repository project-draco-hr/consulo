{
  ModifiableRootModel model=ModuleRootManager.getInstance(module).getModifiableModel();
  List<Library> addedLibraries=new ArrayList<Library>();
  for (  Library library : myAddedLibraries) {
    model.addLibraryEntry(library);
    addedLibraries.add(library);
  }
  if (!myAddedRoots.isEmpty()) {
    VirtualFile[] roots=myAddedRoots.toArray(new VirtualFile[myAddedRoots.size()]);
    LibraryTable libraryTable=ProjectLibraryTable.getInstance(module.getProject());
    Library library=FacetEditorContextBase.createLibraryInTable(myDescription.getDefaultLibraryName(),roots,libraryTable);
    model.addLibraryEntry(library);
    addedLibraries.add(library);
  }
  if (model.isChanged()) {
    model.commit();
  }
 else {
    model.dispose();
  }
  return addedLibraries;
}
