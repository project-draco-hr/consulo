{
  DefaultMutableTreeNode root=new DefaultMutableTreeNode(new Descriptor());
  RunManager runManager=RunManager.getInstance(myProject);
  final ConfigurationType[] configTypes=runManager.getConfigurationFactories();
  for (  final ConfigurationType type : configTypes) {
    final Icon icon=type.getIcon();
    DefaultMutableTreeNode typeNode=new DefaultMutableTreeNode(new ConfigurationTypeDescriptor(type,icon,isConfigurationAssigned(type)));
    root.add(typeNode);
    final Set<String> addedNames=StringSetSpinAllocator.alloc();
    try {
      RunConfiguration[] configurations=runManager.getConfigurations(type);
      for (      final RunConfiguration configuration : configurations) {
        final String configurationName=configuration.getName();
        if (addedNames.contains(configurationName)) {
          continue;
        }
        addedNames.add(configurationName);
        typeNode.add(new DefaultMutableTreeNode(new ConfigurationDescriptor(configuration,isConfigurationAssigned(configuration))));
      }
    }
  finally {
      StringSetSpinAllocator.dispose(addedNames);
    }
  }
  return root;
}
