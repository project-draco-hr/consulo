{
  final RemotelyConfigurableStatisticsService statisticsService=new RemotelyConfigurableStatisticsService(new StatisticsConnectionService(),new StatisticsHttpClientSender(),new StatisticsUploadAssistant());
  if (StatisticsUploadAssistant.showNotification()) {
    StatisticsNotificationManager.showNotification(statisticsService,myProject);
  }
 else   if (StatisticsUploadAssistant.isSendAllowed() && StatisticsUploadAssistant.isTimeToSend()) {
    StatisticsService serviceToUse=null;
    StatisticsService[] extensions=StatisticsService.EP_NAME.getExtensions();
    if (extensions.length > 1) {
      LOG.warn(String.format("More than one stats service detected (%s). Falling back to the built-in one",Arrays.toString(extensions)));
    }
 else     if (extensions.length == 1) {
      serviceToUse=extensions[0];
    }
    if (serviceToUse == null) {
      serviceToUse=statisticsService;
    }
    runWithDelay(serviceToUse);
  }
}
