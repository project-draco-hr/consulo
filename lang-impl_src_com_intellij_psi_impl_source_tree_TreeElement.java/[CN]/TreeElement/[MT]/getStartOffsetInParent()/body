{
  if (myParent == null)   return -1;
  int offset=myStartOffsetInParent;
  if (offset != -1)   return offset;
synchronized (START_OFFSET_LOCK) {
    TreeElement cur=this;
    while (true) {
      if (cur.myStartOffsetInParent != -1)       break;
      TreeElement prev=cur.getTreePrev();
      if (prev == null)       break;
      cur=prev;
    }
    if (cur.myStartOffsetInParent == -1) {
      cur.myStartOffsetInParent=0;
    }
    while (cur != this) {
      TreeElement next=cur.getTreeNext();
      next.myStartOffsetInParent=cur.myStartOffsetInParent + cur.getTextLength();
      cur=next;
    }
    return myStartOffsetInParent;
  }
}
