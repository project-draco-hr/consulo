{
  if (myProcessed)   return;
  myProcessed=true;
  PsiScopesUtil.walkChildrenScopes(this,new BaseScopeProcessor(){
    public boolean execute(    PsiElement element,    PsiSubstitutor substitutor){
      if (element instanceof PsiLocalVariable) {
        final PsiLocalVariable variable=(PsiLocalVariable)element;
        final String name=variable.getName();
        Set<String> set=myVariablesSet;
        if (set != null && set.contains(name)) {
          myConflict=true;
          myVariablesSet=null;
          myClassesSet=null;
        }
 else {
          if (set == null)           set=new HashSet<String>();
          set.add(name);
          myVariablesSet=set;
        }
      }
 else       if (element instanceof PsiClass) {
        final PsiClass psiClass=(PsiClass)element;
        final String name=psiClass.getName();
        if (myClassesSet == null)         myClassesSet=new HashSet<String>();
        if (myClassesSet.contains(name)) {
          myConflict=true;
          myVariablesSet=null;
          myClassesSet=null;
        }
 else         myClassesSet.add(name);
      }
      return !myConflict;
    }
  }
,PsiSubstitutor.EMPTY,this,this);
}
