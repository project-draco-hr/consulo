{
  return new Runnable(){
    public void run(){
      myAction.finish();
      if (!myProject.isDisposed()) {
        ChangeListManager.getInstance(myProject).invokeAfterUpdate(new Runnable(){
          public void run(){
            final CommittedChangesCache cache=CommittedChangesCache.getInstance(myProject);
            cache.refreshAllCachesAsync(false);
            cache.refreshIncomingChangesAsync();
          }
        }
,InvokeAfterUpdateMode.SILENT,null,new Consumer<VcsDirtyScopeManager>(){
          public void consume(          final VcsDirtyScopeManager vcsDirtyScopeManager){
            for (            FilePath path : myPathsToRefresh) {
              vcsDirtyScopeManager.fileDirty(path);
            }
          }
        }
);
        LocalHistory.putSystemLabel(myProject,myActionName + ": " + myCommitMessage);
      }
    }
  }
;
}
