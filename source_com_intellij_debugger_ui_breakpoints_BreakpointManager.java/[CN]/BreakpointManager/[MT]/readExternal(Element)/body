{
  LOG.assertTrue(SwingUtilities.isEventDispatchThread());
  myStartupManager.registerPostStartupActivity(new Runnable(){
    public void run(){
      PsiDocumentManager.getInstance(myProject).commitAndRunReadAction(new Runnable(){
        public void run(){
          final Map<String,Breakpoint> nameToBreakpointMap=new java.util.HashMap<String,Breakpoint>();
          try {
            final List groups=parentNode.getChildren();
            for (Iterator it=groups.iterator(); it.hasNext(); ) {
              final Element group=(Element)it.next();
              final String category=group.getName();
              Element anyExceptionBreakpointGroup=null;
              if (!AnyExceptionBreakpoint.ANY_EXCEPTION_BREAKPOINT.equals(category)) {
                anyExceptionBreakpointGroup=group.getChild(AnyExceptionBreakpoint.ANY_EXCEPTION_BREAKPOINT);
                final BreakpointFactory factory=BreakpointFactory.getInstance(category);
                if (factory != null) {
                  for (Iterator i=group.getChildren("breakpoint").iterator(); i.hasNext(); ) {
                    Element breakpointNode=(Element)i.next();
                    Breakpoint breakpoint=factory.createBreakpoint(myProject);
                    breakpoint.readExternal(breakpointNode);
                    addBreakpoint(breakpoint);
                    nameToBreakpointMap.put(breakpoint.getDisplayName(),breakpoint);
                  }
                }
              }
 else {
                anyExceptionBreakpointGroup=group;
              }
              if (anyExceptionBreakpointGroup != null) {
                final Element breakpointElement=group.getChild("breakpoint");
                if (breakpointElement != null) {
                  myAnyExceptionBreakpoint.readExternal(breakpointElement);
                }
              }
            }
          }
 catch (          InvalidDataException e) {
          }
          final Element rulesGroup=parentNode.getChild(RULES_GROUP_NAME);
          if (rulesGroup != null) {
            final List rules=rulesGroup.getChildren("rule");
            for (Iterator it=rules.iterator(); it.hasNext(); ) {
              final Element rule=(Element)it.next();
              final Element master=rule.getChild(MASTER_BREAKPOINT_TAGNAME);
              if (master == null) {
                continue;
              }
              final Element slave=rule.getChild(SLAVE_BREAKPOINT_TAGNAME);
              if (slave == null) {
                continue;
              }
              final Breakpoint masterBreakpoint=nameToBreakpointMap.get(master.getAttributeValue("name"));
              if (masterBreakpoint == null) {
                continue;
              }
              final Breakpoint slaveBreakpoint=nameToBreakpointMap.get(slave.getAttributeValue("name"));
              if (slaveBreakpoint == null) {
                continue;
              }
              addBreakpointRule(new EnableBreakpointRule(BreakpointManager.this,masterBreakpoint,slaveBreakpoint));
            }
          }
          DebuggerInvocationUtil.invokeLater(myProject,new Runnable(){
            public void run(){
              updateBreakpointsUI();
            }
          }
);
        }
      }
);
    }
  }
);
}
