{
  if (component == null)   component=KeyboardFocusManager.getCurrentKeyboardFocusManager().getActiveWindow();
  return (component instanceof Window) ? (Window)component : SwingUtilities.getWindowAncestor(component);
}
