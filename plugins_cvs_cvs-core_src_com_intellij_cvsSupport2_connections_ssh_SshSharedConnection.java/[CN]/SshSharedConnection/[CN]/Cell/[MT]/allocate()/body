{
synchronized (myLock) {
    if (myConnectionLifeCycle.isClosed()) {
      return null;
    }
    if (!myConnectionLifeCycle.hasDied()) {
      SshLogger.debug("connection ok, active sessions: " + mySessions.size());
      if (mySessions.size() >= SESSIONS_PER_CONNECTION)       return null;
      myTs=System.currentTimeMillis();
      final SshSessionConnection wrapper=new SshSessionConnection(myRepository,myCloseListener,mySessionProvider);
      mySessions.addLast(wrapper);
      return wrapper;
    }
    myConnectionLifeCycle.setClosing();
  }
  closeSelf();
  return null;
}
