{
  myProcessHandler=new DefaultDebugProcessHandler();
  ConsoleView console;
  if (isDebugMode()) {
    Project project=myFacet.getModule().getProject();
    final TextConsoleBuilder builder=TextConsoleBuilderFactory.getInstance().createBuilder(project);
    console=builder.getConsole();
    if (console != null) {
      console.attachToProcess(myProcessHandler);
    }
  }
 else {
    console=attachConsole();
  }
  ApplicationManager.getApplication().executeOnPooledThread(new Runnable(){
    public void run(){
      try {
        start();
      }
 catch (      AdbNotRespondingException e) {
        LOG.info(e);
        myProcessHandler.notifyTextAvailable(e.getMessage() + '\n',STDERR);
        if (!myProcessHandler.isProcessTerminated() && myProcessHandler.isStartNotified()) {
          myProcessHandler.destroyProcess();
        }
      }
    }
  }
);
  return new DefaultExecutionResult(console,myProcessHandler);
}
