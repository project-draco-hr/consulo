{
  final int result=Messages.showDialog(myProject,myNotMerged.size() + " not merged revision(s) found.",myMergeTitle,new String[]{"Merge &all","&Select revisions to merge","Cancel"},0,Messages.getQuestionIcon());
  if (result == 2)   return null;
  final MergerFactory factory;
  if (result == 0) {
    factory=createMergeAllFactory();
  }
 else {
    final ToBeMergedDialog dialog=new ToBeMergedDialog(myProject,myNotMerged,myMergeTitle,myBranchInfo);
    dialog.show();
    if (dialog.getExitCode() == DialogWrapper.CANCEL_EXIT_CODE) {
      return null;
    }
    final List<CommittedChangeList> lists=dialog.getSelected();
    if (lists.isEmpty())     return null;
    factory=new ChangeListsMergerFactory(lists);
  }
  return factory;
}
