{
  if (ourCommunityModules != null) {
    return ourCommunityModules;
  }
  ourCommunityModules=new THashSet<String>();
  File modulesXml=findFileUnderCommunityHome(".idea/modules.xml");
  if (!modulesXml.exists()) {
    throw new IllegalStateException("Cannot obtain test data path: " + modulesXml.getAbsolutePath() + " not found");
  }
  try {
    Element componentRoot=JDomSerializationUtil.findComponent(JDOMUtil.loadDocument(modulesXml).getRootElement(),ModuleManagerImpl.COMPONENT_NAME);
    ModuleManagerImpl.ModulePath[] files=ModuleManagerImpl.getPathsToModuleFiles(componentRoot);
    for (    ModuleManagerImpl.ModulePath file : files) {
      String name=FileUtil.getNameWithoutExtension(PathUtil.getFileName(file.getPath()));
      ourCommunityModules.add(name);
    }
    return ourCommunityModules;
  }
 catch (  JDOMException e) {
    throw new RuntimeException("Cannot read modules from " + modulesXml.getAbsolutePath(),e);
  }
catch (  IOException e) {
    throw new RuntimeException("Cannot read modules from " + modulesXml.getAbsolutePath(),e);
  }
}
