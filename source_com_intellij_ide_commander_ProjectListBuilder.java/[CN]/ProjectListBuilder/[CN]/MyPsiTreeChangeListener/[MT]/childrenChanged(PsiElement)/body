{
  while (true) {
    if (parent == null)     break;
    if (parent instanceof PsiCodeBlock)     break;
    if (parent instanceof PsiFile) {
      parent=((PsiFile)parent).getContainingDirectory();
      if (parent == null)       break;
    }
    if (parent instanceof PsiMethod || parent instanceof PsiField || parent instanceof PsiClass|| parent instanceof PsiFile|| parent instanceof PsiDirectory)     break;
    parent=parent.getParent();
  }
  if (parent == null) {
    return;
  }
  final Object element=getParentElement();
  if (element instanceof PsiElement) {
    if (!((PsiElement)element).isValid()) {
      addUpdateRequest();
      return;
    }
    PsiElement psiElement=(PsiElement)element;
    PsiElement pparent=parent.getParent();
    if (pparent instanceof PsiFile) {
      pparent=pparent.getParent();
    }
    if (psiElement.equals(pparent)) {
      addUpdateRequest();
      return;
    }
    while (true) {
      if (psiElement == null)       return;
      if (psiElement.equals(parent)) {
        addUpdateRequest();
        return;
      }
      psiElement=psiElement.getParent();
    }
  }
}
