{
  RepositoryManager repositoryManager=myManager.getRepositoryManager();
  RepositoryIndex index=repositoryManager.getIndex();
  VirtualFileFilter rootFilter=null;
  long[] classIds=index.getClassesByQualifiedName(qName,rootFilter);
  if (classIds.length == 0)   return null;
  RepositoryElementsManager repositoryElementsManager=myManager.getRepositoryElementsManager();
  VirtualFile bestFile=null;
  PsiClass bestClass=null;
  for (int i=0; i < classIds.length; i++) {
    long classId=classIds[i];
    PsiClass aClass=(PsiClass)repositoryElementsManager.findOrCreatePsiElementById(classId);
    LOG.assertTrue(aClass != null);
    LOG.assertTrue(aClass.isValid());
    PsiFile file=aClass.getContainingFile();
    if (file == null) {
      LOG.error("aClass=" + aClass);
      continue;
    }
    VirtualFile vFile=file.getVirtualFile();
    if (!scope.contains(vFile))     continue;
    if (bestFile == null || scope.compare(vFile,bestFile) > 0) {
      bestFile=vFile;
      bestClass=aClass;
    }
  }
  return bestClass;
}
