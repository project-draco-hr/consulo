{
  Document document=editor.getDocument();
  String s=document.getCharsSequence().subSequence(startOffset,endOffset).toString();
  s=StringUtil.convertLineSeparators(s);
  CopyPasteManager.getInstance().setContents(new KillRingTransferable(s,document,startOffset,endOffset,cut));
  if (editor instanceof EditorEx) {
    EditorEx ex=(EditorEx)editor;
    if (ex.isStickySelection()) {
      ex.setStickySelection(false);
    }
  }
}
