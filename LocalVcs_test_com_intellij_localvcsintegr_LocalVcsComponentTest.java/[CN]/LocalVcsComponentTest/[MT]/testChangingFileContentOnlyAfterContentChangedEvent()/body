{
  final VirtualFile f=root.createChildData(null,"file.java");
  f.setBinaryContent("before".getBytes());
  ContentChangesListener l=new ContentChangesListener(f);
  addFileListenerDuring(l,new Callable(){
    public Object call() throws Exception {
      f.setBinaryContent("after".getBytes());
      return null;
    }
  }
);
  assertEquals("before",l.getContentBefore());
  assertEquals("after",l.getContentAfter());
}
