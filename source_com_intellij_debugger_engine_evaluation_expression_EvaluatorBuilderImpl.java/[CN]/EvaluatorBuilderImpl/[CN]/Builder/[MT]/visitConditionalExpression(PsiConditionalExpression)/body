{
  if (LOG.isDebugEnabled()) {
    LOG.debug("visitConditionalExpression " + expression);
  }
  if (expression.getThenExpression() == null || expression.getElseExpression() == null) {
    throw new EvaluateRuntimeException(EvaluateExceptionUtil.INVALID_EXPRESSION(expression.getText()));
  }
  PsiExpression condition=expression.getCondition();
  condition.accept(this);
  if (myResult == null) {
    throw new EvaluateRuntimeException(EvaluateExceptionUtil.INVALID_EXPRESSION(condition.getText()));
  }
  Evaluator conditionEvaluator=myResult;
  expression.getThenExpression().accept(this);
  if (myResult == null) {
    throw new EvaluateRuntimeException(EvaluateExceptionUtil.INVALID_EXPRESSION(expression.getThenExpression().getText()));
  }
  Evaluator thenEvaluator=myResult;
  expression.getElseExpression().accept(this);
  if (myResult == null) {
    throw new EvaluateRuntimeException(EvaluateExceptionUtil.INVALID_EXPRESSION(expression.getElseExpression().getText()));
  }
  Evaluator elseEvaluator=myResult;
  myResult=new ConditionalExpressionEvaluator(conditionEvaluator,thenEvaluator,elseEvaluator);
}
