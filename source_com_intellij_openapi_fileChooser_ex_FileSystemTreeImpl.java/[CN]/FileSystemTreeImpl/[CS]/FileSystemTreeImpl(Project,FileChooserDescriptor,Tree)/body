{
  myProject=project;
  myTreeStructure=new FileTreeStructure(project,descriptor);
  myDescriptor=descriptor;
  myTree=tree;
  DefaultTreeModel treeModel=new DefaultTreeModel(new DefaultMutableTreeNode());
  myTree.setModel(treeModel);
  myTreeBuilder=createTreeBuilder(myTree,treeModel,myTreeStructure,FileComparator.getInstance(),descriptor);
  new TreeSpeedSearch(myTree);
  myTree.putClientProperty("JTree.lineStyle","Angled");
  myTree.expandPath(new TreePath(treeModel.getRoot()));
  TreeToolTipHandler.install(myTree);
  TreeUtil.installActions(myTree);
  myTree.getSelectionModel().setSelectionMode(myTreeStructure.getChooserDescriptor().getChooseMultiple() ? TreeSelectionModel.DISCONTIGUOUS_TREE_SELECTION : TreeSelectionModel.SINGLE_TREE_SELECTION);
  addTreeExpansionListener();
  registerTreeActions();
}
