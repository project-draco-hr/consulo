{
  final ChangeListManager manager=ChangeListManager.getInstance(project);
  if (changes.isEmpty()) {
    Messages.showWarningDialog(project,VcsBundle.message("commit.dialog.no.changes.detected.text"),VcsBundle.message("commit.dialog.no.changes.detected.title"));
    return;
  }
  ArrayList<Change> validChanges=new ArrayList<Change>();
  Set<LocalChangeList> lists=new THashSet<LocalChangeList>();
  for (  Change change : changes) {
    final LocalChangeList list=manager.getChangeList(change);
    if (list != null) {
      lists.add(list);
      validChanges.add(change);
    }
  }
  rollback(project,new ArrayList<LocalChangeList>(lists),validChanges,refreshSynchronously,afterVcsRefreshInAwt);
}
