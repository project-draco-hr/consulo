{
  if (myAssertLabel != null) {
    final int var=maxLocals + 1;
    mv.visitLabel(myAssertLabel);
    mv.visitVarInsn(Opcodes.ASTORE,var);
    final Label end=new Label();
    addPatternTest(myMethodPattern.patternIndex,end,var);
    addPatternAssertion(MessageFormat.format("Return value of method {0}.{1} annotated as @{2} does not match pattern {3}",myInstrumenter.myClassName,myMethodName,myMethodPattern.annotation,myMethodPattern.pattern),true);
    mv.visitLabel(end);
    mv.visitLocalVariable(RETURN_VALUE_NAME,PatternValidationInstrumenter.JAVA_LANG_STRING,null,myAssertLabel,end,var);
    mv.visitVarInsn(Opcodes.ALOAD,var);
    mv.visitInsn(Opcodes.ARETURN);
  }
  super.visitMaxs(maxStack,maxLocals);
}
