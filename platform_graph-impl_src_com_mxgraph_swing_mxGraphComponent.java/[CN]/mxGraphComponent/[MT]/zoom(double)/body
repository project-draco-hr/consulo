{
  mxGraphView view=graph.getView();
  double newScale=(double)((int)(view.getScale() * 100 * factor)) / 100;
  if (newScale != view.getScale() && newScale > 0.04) {
    mxPoint translate=(pageVisible && centerPage) ? getPageTranslate(newScale) : new mxPoint();
    graph.getView().scaleAndTranslate(newScale,translate.getX(),translate.getY());
    if (keepSelectionVisibleOnZoom && !graph.isSelectionEmpty()) {
      getGraphControl().scrollRectToVisible(view.getBoundingBox(graph.getSelectionCells()).getRectangle());
    }
 else {
      maintainScrollBar(true,factor,centerZoom);
      maintainScrollBar(false,factor,centerZoom);
    }
  }
}
