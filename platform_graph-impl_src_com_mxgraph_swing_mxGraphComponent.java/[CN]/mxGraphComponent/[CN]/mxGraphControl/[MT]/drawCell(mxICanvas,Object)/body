{
  mxCellState state=graph.getView().getState(cell);
  if (state != null && isCellDisplayable(state.getCell()) && (!(canvas instanceof mxGraphics2DCanvas) || hitClip((mxGraphics2DCanvas)canvas,state))) {
    graph.drawState(canvas,state,cell != cellEditor.getEditingCell());
  }
  boolean edgesFirst=graph.isKeepEdgesInBackground();
  boolean edgesLast=graph.isKeepEdgesInForeground();
  if (edgesFirst) {
    drawChildren(cell,true,false);
  }
  drawChildren(cell,!edgesFirst && !edgesLast,true);
  if (edgesLast) {
    drawChildren(cell,true,false);
  }
  if (state != null) {
    cellDrawn(canvas,state);
  }
}
