{
  return new CompilationEvent(){
    @Override protected void process(    OutputParser.Callback callback){
      JavaFileObject fileObject=diagnostic.getSource();
      String message=diagnostic.getMessage(null);
      String url;
      if (fileObject == null) {
        url=null;
      }
 else {
        URI uri=fileObject.toUri();
        if (uri.getScheme().equals("file")) {
          url=VfsUtil.pathToUrl(FileUtil.toSystemIndependentName(uri.getPath()));
        }
 else {
          url=fileObject.toString();
        }
      }
      CompilerMessageCategory category=diagnostic.getKind() == Diagnostic.Kind.ERROR ? CompilerMessageCategory.ERROR : diagnostic.getKind() == Diagnostic.Kind.WARNING || diagnostic.getKind() == Diagnostic.Kind.MANDATORY_WARNING ? CompilerMessageCategory.WARNING : CompilerMessageCategory.INFORMATION;
      callback.message(category,message,url,(int)diagnostic.getLineNumber(),(int)diagnostic.getColumnNumber());
    }
    @NonNls @Override public String toString(){
      return "Diagnostic: " + diagnostic;
    }
  }
;
}
