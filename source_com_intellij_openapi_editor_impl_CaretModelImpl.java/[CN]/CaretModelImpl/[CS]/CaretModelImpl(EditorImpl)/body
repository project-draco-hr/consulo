{
  myEditor=editor;
  myLogicalCaret=new LogicalPosition(0,0);
  myVisibleCaret=new VisualPosition(0,0);
  myOffset=0;
  myVisualLineStart=0;
  Document doc=editor.getDocument();
  if (doc.getLineCount() > 1) {
    myVisualLineEnd=doc.getLineStartOffset(1);
  }
 else {
    myVisualLineEnd=doc.getLineCount() == 0 ? 0 : doc.getLineEndOffset(0);
  }
}
