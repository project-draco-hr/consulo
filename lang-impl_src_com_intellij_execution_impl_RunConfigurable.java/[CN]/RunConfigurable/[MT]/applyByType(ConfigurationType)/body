{
  DefaultMutableTreeNode typeNode=getConfigurationTypeNode(type);
  final RunManagerImpl manager=getRunManager();
  final ArrayList<RunConfigurationBean> stableConfigurations=new ArrayList<RunConfigurationBean>();
  if (typeNode != null) {
    for (int i=0; i < typeNode.getChildCount(); i++) {
      final Object userObject=((DefaultMutableTreeNode)typeNode.getChildAt(i)).getUserObject();
      if (userObject instanceof SingleConfigurationConfigurable) {
        final SingleConfigurationConfigurable configurable=(SingleConfigurationConfigurable)userObject;
        final RunnerAndConfigurationSettingsImpl settings=(RunnerAndConfigurationSettingsImpl)configurable.getSettings();
        if (manager.isTemporary(settings)) {
          applyConfiguration(typeNode,configurable);
        }
        stableConfigurations.add(new RunConfigurationBean(configurable));
      }
 else       if (userObject instanceof RunnerAndConfigurationSettingsImpl) {
        RunnerAndConfigurationSettingsImpl settings=(RunnerAndConfigurationSettingsImpl)userObject;
        stableConfigurations.add(new RunConfigurationBean(settings,manager.isConfigurationShared(settings),manager.getStepsBeforeLaunch(settings.getConfiguration())));
      }
    }
  }
  for (  RunConfigurationBean bean : stableConfigurations) {
    final SingleConfigurationConfigurable configurable=bean.getConfigurable();
    if (configurable != null) {
      applyConfiguration(typeNode,configurable);
    }
  }
  manager.removeConfigurations(type);
  for (  final RunConfigurationBean stableConfiguration : stableConfigurations) {
    manager.addConfiguration(stableConfiguration.getSettings(),stableConfiguration.isShared(),stableConfiguration.getStepsBeforeLaunch());
  }
}
