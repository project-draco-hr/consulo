{
  ClassLoader t=classLoader;
  if (t == null) {
    t=getDefaultClassLoader();
  }
  if (t == null) {
    t=getClass().getClassLoader();
  }
  if (t == null) {
    t=Thread.currentThread().getContextClassLoader();
  }
  if (t == null) {
    throw new IllegalStateException("Cannot determine classloader");
  }
  return t;
}
