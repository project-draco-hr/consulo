{
  if (myShowWarning && myMigrationRoots.size() > 10 && !ApplicationManager.getApplication().isUnitTestMode()) {
    myShowWarning=false;
    try {
      final Runnable checkTimeToStopRunnable=new Runnable(){
        public void run(){
          if (Messages.showYesNoCancelDialog("Found more than 10 roots to migrate. Do you want to preview?","Type Migration",Messages.getWarningIcon()) == DialogWrapper.OK_EXIT_CODE) {
            myException=new MigrateException();
          }
        }
      }
;
      SwingUtilities.invokeLater(checkTimeToStopRunnable);
    }
 catch (    Exception e) {
    }
  }
  if (myException != null)   throw myException;
  rememberRootTrace(usageInfo,type,place,alreadyProcessed);
  if (!alreadyProcessed && !getTypeEvaluator().setType(usageInfo,type)) {
    alreadyProcessed=true;
  }
  if (!alreadyProcessed)   myMigrationRoots.addFirst(new Pair<TypeMigrationUsageInfo,PsiType>(usageInfo,type));
  return alreadyProcessed;
}
