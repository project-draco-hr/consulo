{
  final PomModel model=PomManager.getModel(getProject());
  final Listener listener=new Listener(model.getModelAspect(XmlAspect.class));
  model.addModelListener(listener);
  final PsiFile file=createFile("a.xml","<a/>");
  new WriteCommandAction(getProject()){
    @Override protected void run(    Result result) throws Throwable {
      final Document document=PsiDocumentManager.getInstance(getProject()).getDocument(file);
      ((DocumentEx)document).setInBulkUpdate(true);
      document.insertString(0," ");
      commitDocument(document);
      ((DocumentEx)document).setInBulkUpdate(false);
    }
  }
.execute();
  assertFileTextEquals(getTestName(false) + ".txt",listener.getEventString());
}
