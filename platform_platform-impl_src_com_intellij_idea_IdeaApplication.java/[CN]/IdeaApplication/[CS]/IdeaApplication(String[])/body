{
  LOG.assertTrue(ourInstance == null);
  ourInstance=this;
  myArgs=args;
  boolean isInternal=Boolean.valueOf(System.getProperty(IDEA_IS_INTERNAL_PROPERTY)).booleanValue();
  boolean headless=Main.isHeadless();
  if (!headless) {
    patchSystem();
  }
  if (Main.isCommandLine()) {
    new CommandLineApplication(isInternal,false,headless);
  }
 else {
    Splash splash=null;
    if (myArgs.length == 0) {
      myStarter=getStarter();
      if (myStarter instanceof IdeStarter) {
        splash=((IdeStarter)myStarter).showSplash(myArgs);
      }
    }
    ApplicationManagerEx.createApplication(isInternal,false,false,false,"idea",splash);
  }
  if (myStarter == null) {
    myStarter=getStarter();
  }
  myStarter.premain(args);
}
