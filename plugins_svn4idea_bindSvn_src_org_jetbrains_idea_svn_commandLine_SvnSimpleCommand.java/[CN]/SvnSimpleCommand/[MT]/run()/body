{
  addListener(new ProcessEventListener(){
    @Override public void processTerminated(    int exitCode){
    }
    @Override public void startFailed(    Throwable exception){
synchronized (myDataLock) {
        myException=new VcsException("Process failed to start (" + myCommandLine.getCommandLineString() + "): "+ exception.toString(),exception);
      }
    }
  }
);
  start();
  if (isStarted()) {
    waitFor(-1);
  }
synchronized (myDataLock) {
    if (myException != null)     throw myException;
    final int code=getExitCode();
    if (code == 0) {
      return myStdout.toString();
    }
 else {
      final String msg=new StringBuilder("Svn process exited with error code: ").append(code).append("\n").append("stderr: ").append(myStderr.toString()).append("\nstdout: ").append(getStdout().toString()).append("\nCommand was: ").append(myCommandLine.getCommandLineString()).toString();
      throw new VcsException(msg);
    }
  }
}
