{
  myDataDescriptor=dataDescriptor;
  myFile=file;
  if (!file.exists()) {
    if (!file.createNewFile()) {
      throw new IOException("Cannot create empty file: " + file);
    }
  }
  myStorage=new ResizeableMappedFile(myFile,initialSize);
  myKeyStream=new MyAppenderStream(keystreamFile());
  if (myStorage.length() == 0) {
    markDirty(true);
    putMetaData(0);
    allocVector(FIRST_VECTOR);
  }
 else {
    int sign;
    try {
      sign=myStorage.getInt(0);
    }
 catch (    Exception e) {
      sign=DIRTY_MAGIC;
    }
    if (sign != CORRECTLY_CLOSED_MAGIC) {
      myStorage.close();
      throw new CorruptedException(file);
    }
  }
  myKeyRaf=new RandomAccessFile(keystreamFile(),"r");
  myKeyReadStream=new MyDataIS(myKeyRaf);
}
