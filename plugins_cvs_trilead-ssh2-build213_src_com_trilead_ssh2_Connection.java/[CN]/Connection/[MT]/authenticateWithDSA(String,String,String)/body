{
  if (tm == null)   throw new IllegalStateException("Connection is not established!");
  if (authenticated)   throw new IllegalStateException("Connection is already authenticated!");
  if (am == null)   am=new AuthenticationManager(tm);
  if (cm == null)   cm=new ChannelManager(tm);
  if (user == null)   throw new IllegalArgumentException("user argument is null");
  if (pem == null)   throw new IllegalArgumentException("pem argument is null");
  authenticated=am.authenticatePublicKey(user,pem.toCharArray(),password,getOrCreateSecureRND());
  return authenticated;
}
