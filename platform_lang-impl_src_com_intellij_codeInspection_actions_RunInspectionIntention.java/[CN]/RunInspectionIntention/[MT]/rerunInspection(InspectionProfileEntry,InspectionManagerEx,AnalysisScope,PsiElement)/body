{
  final InspectionProfileImpl profile=new InspectionProfileImpl(baseTool.getDisplayName());
  final InspectionProfileImpl model=(InspectionProfileImpl)profile.getModifiableModel();
  final InspectionProfileEntry[] profileEntries=model.getInspectionTools(null);
  for (  InspectionProfileEntry entry : profileEntries) {
    model.disableTool(entry.getShortName());
  }
  model.enableTool(baseTool.getShortName());
  try {
    Element element=new Element("toCopy");
    baseTool.writeSettings(element);
    model.getInspectionTool(baseTool.getShortName(),psiElement).readSettings(element);
  }
 catch (  Exception e) {
  }
  model.setEditable(baseTool.getDisplayName());
  final GlobalInspectionContextImpl inspectionContext=managerEx.createNewGlobalContext(false);
  inspectionContext.setExternalProfile(model);
  inspectionContext.doInspections(scope,managerEx);
}
