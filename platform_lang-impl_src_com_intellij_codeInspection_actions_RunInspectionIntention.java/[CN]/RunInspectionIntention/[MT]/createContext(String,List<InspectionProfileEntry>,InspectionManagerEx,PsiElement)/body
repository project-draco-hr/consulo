{
  final InspectionProfileImpl model=InspectionProfileImpl.createSimple(profileName,baseTools);
  try {
    Element element=new Element("toCopy");
    for (    InspectionProfileEntry baseTool : baseTools) {
      baseTool.writeSettings(element);
      model.getInspectionTool(baseTool.getShortName(),psiElement).readSettings(element);
    }
  }
 catch (  Exception e) {
  }
  model.setEditable(profileName);
  final GlobalInspectionContextImpl inspectionContext=managerEx.createNewGlobalContext(false);
  inspectionContext.setExternalProfile(model);
  return inspectionContext;
}
