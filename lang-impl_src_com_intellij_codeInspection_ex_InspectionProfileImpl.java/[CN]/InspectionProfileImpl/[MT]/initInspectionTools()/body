{
  if (!ApplicationManager.getApplication().isUnitTestMode() || INIT_INSPECTIONS) {
    if (!myInitialized.getAndSet(true)) {
      if (myBaseProfile != null) {
        myBaseProfile.initInspectionTools();
      }
      final InspectionTool[] tools=myRegistrar.createTools();
      for (      InspectionTool tool : tools) {
        final String shortName=tool.getShortName();
        if (HighlightDisplayKey.find(shortName) == null) {
          if (tool instanceof LocalInspectionToolWrapper) {
            HighlightDisplayKey.register(shortName,tool.getDisplayName(),((LocalInspectionToolWrapper)tool).getTool().getID(),((LocalInspectionToolWrapper)tool).getTool().getAlternativeID());
          }
 else {
            HighlightDisplayKey.register(shortName);
          }
        }
        myTools.put(tool.getShortName(),new Tools(tool));
      }
      if (mySource != null) {
        copyToolsConfigurations(mySource,null);
      }
    }
  }
}
