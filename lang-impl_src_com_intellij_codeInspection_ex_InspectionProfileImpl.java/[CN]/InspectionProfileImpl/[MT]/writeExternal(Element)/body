{
  super.writeExternal(element);
  element.setAttribute(VERSION_TAG,VALID_VERSION);
  element.setAttribute(IS_LOCKED,String.valueOf(myLockedProfile));
  for (  final String toolName : myDisplayLevelMap.keySet()) {
    final ToolState state=getToolState(toolName);
    final HighlightDisplayKey key=HighlightDisplayKey.find(toolName);
    if (key != null) {
      final Element inspectionElement=new Element(INSPECTION_TOOL_TAG);
      inspectionElement.setAttribute(CLASS_TAG,toolName);
      inspectionElement.setAttribute(LEVEL_TAG,state.getLevel().toString());
      inspectionElement.setAttribute(ENABLED_TAG,Boolean.toString(isToolEnabled(key)));
      final InspectionTool tool=myTools.get(toolName);
      LOG.assertTrue(tool != null);
      tool.writeSettings(inspectionElement);
      element.addContent(inspectionElement);
    }
 else {
      final Element toolElement=state.getToolElement();
      LOG.assertTrue(toolElement != null);
      toolElement.detach();
      element.addContent(toolElement);
    }
  }
}
