{
  try {
    initInspectionTools();
    for (    ToolsImpl toolList : profile.myTools.values()) {
      if (toolList.getTools() != null) {
        for (        ScopeToolState state : toolList.getTools()) {
          final InspectionTool inspectionTool=copyToolSettings((InspectionTool)state.getTool());
          final ToolsImpl tools=myTools.get(inspectionTool.getShortName());
          if (state.getScope() != null) {
            tools.addTool(state.getScope(),inspectionTool,state.isEnabled(),state.getLevel());
          }
 else {
            tools.setTool(inspectionTool,state.isEnabled(),state.getLevel());
          }
        }
      }
 else {
        final InspectionTool inspectionTool=copyToolSettings((InspectionTool)toolList.getTool());
        final ToolsImpl tools=myTools.get(inspectionTool.getShortName());
        if (scope != null) {
          tools.addTool(scope,inspectionTool,toolList.isEnabled(),toolList.getLevel());
        }
 else {
          final HighlightDisplayKey key=HighlightDisplayKey.find(inspectionTool.getShortName());
          tools.setTool(inspectionTool,profile.isToolEnabled(key),profile.getErrorLevel(key));
        }
      }
    }
  }
 catch (  WriteExternalException e) {
    LOG.error(e);
  }
catch (  InvalidDataException e) {
    LOG.error(e);
  }
}
