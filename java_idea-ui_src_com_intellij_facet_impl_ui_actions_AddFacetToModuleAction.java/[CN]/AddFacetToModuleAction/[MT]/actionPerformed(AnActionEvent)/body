{
  FacetInfo parent=myEditor.getSelectedFacetInfo();
  final FacetTypeId<?> underlyingFacetType=myType.getUnderlyingFacetType();
  Facet facet;
  if (parent == null && underlyingFacetType == null || parent != null && parent.getFacetType().getId() == underlyingFacetType) {
    facet=myEditor.createFacet(parent,myType);
  }
 else {
    LOG.assertTrue(parent != null);
    final FacetInfo grandParent=myEditor.getParent(parent);
    LOG.assertTrue(grandParent == null && underlyingFacetType == null || grandParent != null && grandParent.getFacetType().getId() == underlyingFacetType);
    facet=myEditor.createFacet(grandParent,myType);
  }
  ProjectStructureConfigurable.getInstance(myProject).select(facet,true);
}
