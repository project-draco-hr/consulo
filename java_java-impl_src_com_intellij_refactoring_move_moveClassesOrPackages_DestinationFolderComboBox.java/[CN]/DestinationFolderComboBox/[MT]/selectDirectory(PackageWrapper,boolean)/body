{
  final DirectoryChooser.ItemWrapper selectedItem=(DirectoryChooser.ItemWrapper)getComboBox().getSelectedItem();
  if (selectedItem == null || selectedItem == NULL_WRAPPER) {
    return new MultipleRootsMoveDestination(targetPackage);
  }
  final PsiDirectory selectedPsiDirectory=selectedItem.getDirectory();
  VirtualFile selectedDestination=selectedPsiDirectory.getVirtualFile();
  if (showChooserWhenDefault && Comparing.equal(selectedDestination,myInitialTargetDirectory.getVirtualFile()) && mySourceRoots.length > 1) {
    selectedDestination=MoveClassesOrPackagesUtil.chooseSourceRoot(targetPackage,mySourceRoots,myInitialTargetDirectory);
  }
  if (selectedDestination == null)   return null;
  return new AutocreatingSingleSourceRootMoveDestination(targetPackage,selectedDestination);
}
