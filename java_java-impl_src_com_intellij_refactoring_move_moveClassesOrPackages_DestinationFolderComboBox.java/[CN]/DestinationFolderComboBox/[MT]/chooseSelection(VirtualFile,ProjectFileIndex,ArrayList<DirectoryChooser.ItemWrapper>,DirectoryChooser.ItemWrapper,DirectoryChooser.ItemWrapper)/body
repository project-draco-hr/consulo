{
  if (initial != null || items.contains(NULL_WRAPPER) || items.isEmpty()) {
    return initial;
  }
 else {
    if (oldOne != null) {
      return oldOne;
    }
 else     if (initialTargetDirectorySourceRoot != null) {
      final boolean inTest=fileIndex.isInTestSourceContent(initialTargetDirectorySourceRoot);
      for (      DirectoryChooser.ItemWrapper item : items) {
        final VirtualFile virtualFile=item.getDirectory().getVirtualFile();
        if (fileIndex.isInTestSourceContent(virtualFile) == inTest) {
          return item;
        }
      }
    }
  }
  return items.get(0);
}
