{
  PsiElement firstComment=comment;
  PsiElement lastComment=comment;
  final String lineCommentPrefix=LanguageCommenters.INSTANCE.forLanguage(file.getViewProvider().getRootLanguage(comment)).getLineCommentPrefix();
  if (lineCommentPrefix != null && text.startsWith(lineCommentPrefix)) {
    int sline=doc.getLineNumber(comment.getTextRange().getStartOffset());
    int eline=doc.getLineNumber(comment.getTextRange().getEndOffset());
    for (int j=i - 1; j >= 0; j--) {
      PsiElement cmt=comments.get(j);
      if (cmt.getText().startsWith(lineCommentPrefix) && doc.getLineNumber(cmt.getTextRange().getEndOffset()) == sline - 1) {
        firstComment=cmt;
        sline=doc.getLineNumber(cmt.getTextRange().getStartOffset());
      }
 else {
        break;
      }
    }
    for (int j=i + 1; j < comments.size(); j++) {
      PsiElement cmt=comments.get(j);
      if (cmt.getText().startsWith(lineCommentPrefix) && doc.getLineNumber(cmt.getTextRange().getStartOffset()) == eline + 1) {
        lastComment=cmt;
        eline=doc.getLineNumber(cmt.getTextRange().getEndOffset());
      }
 else {
        break;
      }
    }
  }
  return new CommentRange(firstComment,lastComment);
}
