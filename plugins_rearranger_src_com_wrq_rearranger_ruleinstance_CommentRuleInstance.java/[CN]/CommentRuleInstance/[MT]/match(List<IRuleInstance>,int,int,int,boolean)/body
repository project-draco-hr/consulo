{
  int index=startIndex + direction;
  int nRulesSeen=0;
  while (index >= 0 && index < resultRuleInstances.size() && nRulesSeen < nRules) {
    if (!(resultRuleInstances.get(index) instanceof CommentRuleInstance)) {
      nRulesSeen++;
      final IRuleInstance ruleInstance=resultRuleInstances.get(index);
      if (ruleInstance.hasMatches()) {
        if (!ANDing) {
          return true;
        }
      }
 else {
        if (ANDing) {
          return false;
        }
      }
    }
    index+=direction;
  }
  return ANDing;
}
