{
  final boolean hasEmptyCaches=CommittedChangesCache.getInstance(myProject).hasEmptyCaches();
  ApplicationManager.getApplication().invokeLater(new Runnable(){
    public void run(){
      if (myLoadingChangeListsLabel != null) {
        remove(myLoadingChangeListsLabel);
        myLoadingChangeListsLabel=null;
      }
      myCommittedChangeLists=receivedChanges;
      myTreeBrowser.setItems(myCommittedChangeLists,CommittedChangesBrowserUseCase.UPDATE);
      if (hasEmptyCaches) {
        myTreeBrowser.getEmptyText().appendText("Click ").appendText("Refresh",SimpleTextAttributes.LINK_ATTRIBUTES,new ActionListener(){
          public void actionPerformed(          final ActionEvent e){
            RefreshIncomingChangesAction.doRefresh(myProject);
          }
        }
).appendText(" to initialize repository changes cache");
      }
    }
  }
,myProject.getDisposed());
}
