{
  final boolean hasEmptyCaches=CommittedChangesCache.getInstance(myProject).hasEmptyCaches();
  ApplicationManager.getApplication().invokeLater(new Runnable(){
    public void run(){
      if (myLoadingChangeListsLabel != null) {
        remove(myLoadingChangeListsLabel);
        myLoadingChangeListsLabel=null;
      }
      myCommittedChangeLists=receivedChanges;
      myTreeBrowser.setItems(myCommittedChangeLists,CommittedChangesBrowserUseCase.UPDATE);
      myTreeBrowser.getEmptyText().clear();
      if (hasEmptyCaches) {
        myTreeBrowser.getEmptyText().appendText("Click ",SimpleTextAttributes.REGULAR_ATTRIBUTES);
        myTreeBrowser.getEmptyText().appendText("Refresh",SimpleTextAttributes.LINK_ATTRIBUTES,new ActionListener(){
          public void actionPerformed(          final ActionEvent e){
            RefreshIncomingChangesAction.doRefresh(myProject);
          }
        }
);
        myTreeBrowser.getEmptyText().appendText(" to initialize repository changes cache",SimpleTextAttributes.REGULAR_ATTRIBUTES);
      }
    }
  }
,myProject.getDisposed());
}
