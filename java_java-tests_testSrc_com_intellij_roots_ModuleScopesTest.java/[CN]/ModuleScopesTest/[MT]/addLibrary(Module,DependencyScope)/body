{
  final VirtualFile libraryRoot=myFixture.findOrCreateDir("lib");
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    @Override public void run(){
      final ModifiableRootModel model=ModuleRootManager.getInstance(m).getModifiableModel();
      final Library library=model.getModuleLibraryTable().createLibrary("l");
      final Library.ModifiableModel libraryModel=library.getModifiableModel();
      libraryModel.addRoot(libraryRoot,OrderRootType.CLASSES);
      libraryModel.commit();
      model.findLibraryOrderEntry(library).setScope(scope);
      model.commit();
    }
  }
);
  return libraryRoot;
}
