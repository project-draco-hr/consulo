{
  if (entity instanceof RefElement) {
    final RefElement element=(RefElement)entity;
    final Collection<RefElement> references=element.getOutReferences();
    final RefUtil refUtil=RefUtil.getInstance();
    for (    RefElement reference : references) {
      final RefPackage refPackage=refUtil.getPackage(reference);
      if (refPackage != null) {
        dependencies.add(refPackage);
      }
    }
  }
  final List<RefEntity> children=entity.getChildren();
  if (children == null) {
    return;
  }
  for (  RefEntity child : children) {
    if (!(child instanceof RefPackage)) {
      tabulateDependencyPackages(child,dependencies);
    }
  }
}
