{
  ArrayList<Variable> variables=new ArrayList<Variable>();
  TemplateImplUtil.parseVariables(text,variables,TemplateImpl.INTERNAL_VARS_SET);
  if (!includeInternal) {
    for (Iterator<Variable> iterator=variables.iterator(); iterator.hasNext(); ) {
      if (TemplateImpl.INTERNAL_VARS_SET.contains(iterator.next().getName())) {
        iterator.remove();
      }
    }
  }
  return variables;
}
