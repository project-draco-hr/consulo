{
  JPanel panel=new JPanel(new GridBagLayout());
  GridBag gb=new GridBag().setDefaultInsets(4,4,4,4).setDefaultWeightY(1).setDefaultFill(GridBagConstraints.BOTH);
  JPanel editorPanel=new JPanel(new BorderLayout());
  editorPanel.setPreferredSize(new Dimension(250,130));
  editorPanel.setMinimumSize(new Dimension(250,130));
  editorPanel.add(myTemplateEditor.getComponent(),BorderLayout.CENTER);
  panel.add(editorPanel,gb.nextLine().next().weighty(1).weightx(1).coverColumn(2));
  myEditVariablesButton=new JButton(CodeInsightBundle.message("dialog.edit.template.button.edit.variables"));
  myEditVariablesButton.setDefaultCapable(false);
  myEditVariablesButton.setMaximumSize(myEditVariablesButton.getPreferredSize());
  panel.add(myEditVariablesButton,gb.next().weighty(0));
  panel.add(createTemplateOptionsPanel(),gb.nextLine().next().next().coverColumn(2).weighty(1));
  JPanel contextPanel=createShortContextPanel();
  panel.add(contextPanel,gb.nextLine().next());
  myKeyField.getDocument().addDocumentListener(new com.intellij.ui.DocumentAdapter(){
    protected void textChanged(    javax.swing.event.DocumentEvent e){
      validateOKButton();
    }
  }
);
  myTemplateEditor.getDocument().addDocumentListener(new DocumentAdapter(){
    public void documentChanged(    DocumentEvent e){
      validateOKButton();
      validateEditVariablesButton();
    }
  }
);
  myEditVariablesButton.addActionListener(new ActionListener(){
    public void actionPerformed(    ActionEvent e){
      editVariables();
    }
  }
);
  JPanel centerPanel=new JPanel(new BorderLayout());
  centerPanel.add(createNorthPanel(),BorderLayout.NORTH);
  centerPanel.add(panel,BorderLayout.CENTER);
  panel.setBorder(IdeBorderFactory.createTitledBorder(CodeInsightBundle.message("dialog.edit.template.template.text.title"),false,false,true));
  return centerPanel;
}
