{
switch (rule.getEmitCondition()) {
case CommentRule.EMIT_ALWAYS:
    return new EmitAlwaysCommentRuleInstance(rule);
case CommentRule.EMIT_IF_ITEMS_MATCH_SURROUNDING_RULES:
  return new SurroundingCommentRuleInstance(rule);
case CommentRule.EMIT_IF_ITEMS_MATCH_SUBSEQUENT_RULE:
return new SubsequentCommentRuleInstance(rule);
case CommentRule.EMIT_IF_ITEMS_MATCH_PRECEDING_RULE:
return new PrecedingCommentRuleInstance(rule);
default :
throw new IllegalStateException("unknown emit condition type=" + rule.getEmitCondition());
}
}
