{
  return ApplicationManager.getApplication().runReadAction(new Computable<List<PsiFile>>(){
    public List<PsiFile> compute(){
      final Collection<VirtualFile> files=FileBasedIndex.getInstance().getContainingFiles(NAME,className,GlobalSearchScope.projectScope(project).intersectWith(scope));
      if (files.isEmpty())       return Collections.emptyList();
      List<PsiFile> result=new ArrayList<PsiFile>();
      for (      VirtualFile file : files) {
        if (!file.isValid())         continue;
        PsiFile psiFile=PsiManager.getInstance(project).findFile(file);
        if (psiFile != null) {
          result.add(psiFile);
        }
      }
      return result;
    }
  }
);
}
