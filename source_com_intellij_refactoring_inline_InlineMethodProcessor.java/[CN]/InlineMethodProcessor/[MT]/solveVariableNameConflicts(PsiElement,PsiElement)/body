{
  if (scope instanceof PsiVariable) {
    PsiVariable var=(PsiVariable)scope;
    String name=var.getName();
    String oldName=name;
    while (true) {
      String newName=myCodeStyleManager.suggestUniqueVariableName(name,placeToInsert,true);
      if (newName.equals(name))       break;
      name=newName;
      newName=myCodeStyleManager.suggestUniqueVariableName(name,var,true);
      if (newName.equals(name))       break;
      name=newName;
    }
    if (!name.equals(oldName)) {
      RefactoringUtil.renameVariableReferences(var,name,GlobalSearchScope.projectScope(myProject));
      var.getNameIdentifier().replace(myFactory.createIdentifier(name));
    }
  }
  PsiElement[] children=scope.getChildren();
  for (  PsiElement child : children) {
    solveVariableNameConflicts(child,placeToInsert);
  }
}
