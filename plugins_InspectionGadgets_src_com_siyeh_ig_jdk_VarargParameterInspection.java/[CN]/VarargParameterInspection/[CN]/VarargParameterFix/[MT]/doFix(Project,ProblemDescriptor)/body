{
  final PsiElement element=descriptor.getPsiElement();
  final PsiMethod method=(PsiMethod)element.getParent();
  final PsiParameterList parameterList=method.getParameterList();
  final PsiParameter[] parameters=parameterList.getParameters();
  final PsiParameter lastParameter=parameters[parameters.length - 1];
  if (!lastParameter.isVarArgs()) {
    return;
  }
  final PsiEllipsisType type=(PsiEllipsisType)lastParameter.getType();
  final Query<PsiReference> query=ReferencesSearch.search(method);
  final PsiType componentType=type.getComponentType();
  final String typeText=componentType.getCanonicalText();
  final Collection<PsiReference> references=query.findAll();
  for (  PsiReference reference : references) {
    modifyCalls(reference,typeText,parameters.length - 1);
  }
  final PsiType arrayType=type.toArrayType();
  final PsiManager psiManager=lastParameter.getManager();
  final PsiElementFactory factory=JavaPsiFacade.getInstance(psiManager.getProject()).getElementFactory();
  final PsiTypeElement newTypeElement=factory.createTypeElement(arrayType);
  final PsiTypeElement typeElement=lastParameter.getTypeElement();
  typeElement.replace(newTypeElement);
}
