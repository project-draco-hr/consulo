{
  Runnable runnable=new Runnable(){
    public void run(){
      try {
        if (myJob.isCanceled()) {
          cancel(false);
        }
 else {
          PrioritizedFutureTask.super.run();
        }
      }
  finally {
        try {
          if (myReportExceptions) {
            PrioritizedFutureTask.super.get();
          }
        }
 catch (        CancellationException ignored) {
        }
catch (        InterruptedException e) {
          LOG.error(e);
        }
catch (        ExecutionException e) {
          LOG.error(e);
        }
 finally {
          myJob.taskDone();
        }
      }
    }
  }
;
  if (myParentThreadHasReadAccess) {
    if (ApplicationManagerEx.getApplicationEx().isUnitTestMode()) {
      ApplicationImpl.setExceptionalThreadWithReadAccessFlag(true);
    }
    if (!ApplicationManagerEx.getApplicationEx().tryRunReadAction(runnable)) {
      myJob.cancel();
    }
  }
 else {
    runnable.run();
  }
}
