{
  final PsiFile file=lookup.getPsiFile();
  if (file == null)   return false;
  final Editor editor=lookup.getEditor();
  PsiDocumentManager.getInstance(file.getProject()).commitDocument(editor.getDocument());
  final int offset=editor.getCaretModel().getOffset();
  final String prefix=CompletionUtil.findJavaIdentifierPrefix(file,offset);
  final TemplateImpl template=LiveTemplateCompletionContributor.findApplicableTemplate(file,offset,prefix);
  return template != null && shortcutChar == TemplateSettings.getInstance().getShortcutChar(template);
}
