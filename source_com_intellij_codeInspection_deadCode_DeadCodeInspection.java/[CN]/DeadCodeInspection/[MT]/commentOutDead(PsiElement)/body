{
  PsiFile psiFile=psiElement.getContainingFile();
  if (psiFile != null) {
    Document doc=PsiDocumentManager.getInstance(myProject).getDocument(psiFile);
    TextRange textRange=psiElement.getTextRange();
    SimpleDateFormat format=new SimpleDateFormat();
    String date=format.format(new Date());
    int startOffset=textRange.getStartOffset();
    CharSequence chars=doc.getCharsSequence();
    while (CharArrayUtil.regionMatches(chars,startOffset,"// --Commented out by Inspection")) {
      int line=doc.getLineNumber(startOffset) + 1;
      if (line < doc.getLineCount()) {
        startOffset=doc.getLineStartOffset(line);
        startOffset=CharArrayUtil.shiftForward(chars,startOffset," \t");
      }
    }
    int endOffset=textRange.getEndOffset();
    int line1=doc.getLineNumber(startOffset);
    int line2=doc.getLineNumber(endOffset - 1);
    if (line1 == line2) {
      doc.insertString(startOffset,"// --Commented out by Inspection (" + date + "): ");
    }
 else {
      for (int i=line1; i <= line2; i++) {
        doc.insertString(doc.getLineStartOffset(i),"//");
      }
      doc.insertString(doc.getLineStartOffset(Math.min(line2 + 1,doc.getLineCount() - 1)),"// --Commented out by Inspection STOP (" + date + ")"+ "\n");
      doc.insertString(doc.getLineStartOffset(line1),"// --Commented out by Inspection START (" + date + "):"+ "\n");
    }
  }
}
