{
  Project project=e.getData(DataKeys.PROJECT);
  Change[] changes=e.getData(DataKeys.CHANGES);
  List<VirtualFile> unversionedFiles=e.getData(ChangesListView.UNVERSIONED_FILES_DATA_KEY);
  if (project != null && changes == null && unversionedFiles == null) {
    unversionedFiles=new ArrayList<VirtualFile>();
    changes=getChangesForSelectedFiles(project,changes,unversionedFiles,null,e);
  }
  e.getPresentation().setEnabled(project != null && (changes != null && changes.length > 0) || (unversionedFiles != null && unversionedFiles.size() > 0));
}
