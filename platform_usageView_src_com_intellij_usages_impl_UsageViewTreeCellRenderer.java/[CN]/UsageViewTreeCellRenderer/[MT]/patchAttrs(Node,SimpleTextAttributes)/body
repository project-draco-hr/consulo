{
  if (node.isExcluded()) {
    original=new SimpleTextAttributes(original.getStyle() | SimpleTextAttributes.STYLE_STRIKEOUT,original.getFgColor(),original.getWaveColor());
  }
  if (node instanceof GroupNode) {
    UsageGroup group=((GroupNode)node).getGroup();
    FileStatus fileStatus=group != null ? group.getFileStatus() : null;
    if (fileStatus != null && fileStatus != FileStatus.NOT_CHANGED) {
      original=new SimpleTextAttributes(original.getStyle(),fileStatus.getColor(),original.getWaveColor());
    }
    DefaultMutableTreeNode parent=(DefaultMutableTreeNode)node.getParent();
    if (parent != null && parent.isRoot()) {
      original=new SimpleTextAttributes(original.getStyle() | SimpleTextAttributes.STYLE_BOLD,original.getFgColor(),original.getWaveColor());
    }
  }
  if (original.getBgColor() != null) {
    Color fgColor=original.getFgColor();
    if (fgColor != null) {
      final float hsb[]=new float[3];
      Color.RGBtoHSB(fgColor.getRed(),fgColor.getGreen(),fgColor.getBlue(),hsb);
      if (hsb[2] > 0.7f) {
        fgColor=null;
      }
    }
    return new SimpleTextAttributes(original.getStyle(),fgColor,original.getWaveColor());
  }
  return original;
}
