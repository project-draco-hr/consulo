{
  ArrayList<UsageInfo> usagesVector=new ArrayList<UsageInfo>();
  try {
    if (myMigrationMap == null) {
      return UsageInfo.EMPTY_ARRAY;
    }
    for (int i=0; i < myMigrationMap.getEntryCount(); i++) {
      MigrationMapEntry entry=myMigrationMap.getEntryAt(i);
      UsageInfo[] usages;
      if (entry.getType() == MigrationMapEntry.PACKAGE) {
        usages=MigrationUtil.findPackageUsages(myProject,myPsiMigration,entry.getOldName());
      }
 else {
        usages=MigrationUtil.findClassUsages(myProject,myPsiMigration,entry.getOldName());
      }
      for (      UsageInfo usage : usages) {
        usagesVector.add(new MigrationUsageInfo(usage,entry));
      }
    }
  }
  finally {
    myPsiMigration.finish();
    myPsiMigration=null;
  }
  return usagesVector.toArray(new MigrationUsageInfo[usagesVector.size()]);
}
