{
  Presentation presentation=e.getPresentation();
  IdeaPluginDescriptor[] selection=pluginTable.getSelectedObjects();
  boolean enabled=(selection != null);
  if (enabled) {
    for (    IdeaPluginDescriptor descr : selection) {
      if (descr instanceof PluginNode) {
        int status=PluginManagerColumnInfo.getRealNodeState((PluginNode)descr);
        enabled=enabled && (status != PluginNode.STATUS_DOWNLOADED);
      }
 else       if (descr instanceof IdeaPluginDescriptorImpl) {
        presentation.setText(updateMessage);
        presentation.setDescription(updateMessage);
        PluginId id=descr.getPluginId();
        enabled=enabled && PluginsTableModel.hasNewerVersion(id);
      }
    }
  }
  presentation.setEnabled(enabled);
}
