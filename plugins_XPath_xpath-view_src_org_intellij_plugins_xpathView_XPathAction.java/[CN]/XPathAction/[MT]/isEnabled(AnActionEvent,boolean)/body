{
  final Project project=DataKeys.PROJECT.getData(event.getDataContext());
  if (project == null) {
    return false;
  }
  Editor editor=DataKeys.EDITOR.getData(event.getDataContext());
  if (editor == null) {
    FileEditorManager fem=FileEditorManager.getInstance(project);
    editor=fem.getSelectedTextEditor();
  }
  if (editor == null) {
    return false;
  }
  final PsiDocumentManager cem=PsiDocumentManager.getInstance(project);
  final PsiFile psiFile=cem.getPsiFile(editor.getDocument());
  if (!(psiFile instanceof XmlFile)) {
    return false;
  }
 else   if (psiFile.getLanguage() == StdFileTypes.DTD.getLanguage()) {
    return false;
  }
  return !checkAvailable || isEnabledAt((XmlFile)psiFile,editor.getCaretModel().getOffset());
}
