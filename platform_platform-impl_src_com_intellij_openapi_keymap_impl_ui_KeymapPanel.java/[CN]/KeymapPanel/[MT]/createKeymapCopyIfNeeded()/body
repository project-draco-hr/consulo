{
  if (mySelectedKeymap.canModify())   return true;
  final KeymapImpl selectedKeymap=getSelectedKeymap();
  if (selectedKeymap == null) {
    return false;
  }
  KeymapImpl newKeymap=selectedKeymap.deriveKeymap();
  String newKeymapName=KeyMapBundle.message("new.keymap.name",selectedKeymap.getName());
  if (!tryNewKeymapName(newKeymapName)) {
    for (int i=0; ; i++) {
      newKeymapName=KeyMapBundle.message("new.indexed.keymap.name",selectedKeymap.getName(),i);
      if (tryNewKeymapName(newKeymapName)) {
        break;
      }
    }
  }
  newKeymap.setName(newKeymapName);
  newKeymap.setCanModify(true);
  final int indexOf=myKeymapListModel.getIndexOf(selectedKeymap);
  if (indexOf >= 0) {
    myKeymapListModel.insertElementAt(newKeymap,indexOf + 1);
  }
 else {
    myKeymapListModel.addElement(newKeymap);
  }
  myKeymapList.setSelectedItem(newKeymap);
  processCurrentKeymapChanged();
  return true;
}
