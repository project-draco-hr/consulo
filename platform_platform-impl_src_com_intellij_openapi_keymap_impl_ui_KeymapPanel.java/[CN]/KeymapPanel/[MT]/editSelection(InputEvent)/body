{
  final String actionId=myActionsTree.getSelectedActionId();
  if (actionId == null)   return;
  DefaultActionGroup group=new DefaultActionGroup();
  final Shortcut[] shortcuts=mySelectedKeymap.getShortcuts(actionId);
  group.add(new AnAction("Add Keyboard Shortcut"){
    @Override public void actionPerformed(    AnActionEvent e){
      Shortcut firstKeyboard=null;
      for (      Shortcut shortcut : shortcuts) {
        if (shortcut instanceof KeyboardShortcut) {
          firstKeyboard=shortcut;
          break;
        }
      }
      addKeyboardShortcut(firstKeyboard);
    }
  }
);
  group.add(new AnAction("Add Mouse Shortcut"){
    @Override public void actionPerformed(    AnActionEvent e){
      Shortcut firstMouse=null;
      for (      Shortcut shortcut : shortcuts) {
        if (shortcut instanceof MouseShortcut) {
          firstMouse=shortcut;
          break;
        }
      }
      addMouseShortcut(firstMouse);
    }
  }
);
  group.addSeparator();
  for (  final Shortcut shortcut : shortcuts) {
    group.add(new AnAction("Remove " + KeymapUtil.getShortcutText(shortcut)){
      @Override public void actionPerformed(      AnActionEvent e){
        removeShortcut(shortcut);
      }
    }
);
  }
  final DataContext dataContext=DataManager.getInstance().getDataContext(this);
  final ListPopup popup=JBPopupFactory.getInstance().createActionGroupPopup("Edit Shortcuts",group,dataContext,JBPopupFactory.ActionSelectionAid.SPEEDSEARCH,true);
  if (e instanceof MouseEvent) {
    popup.show(new RelativePoint((MouseEvent)e));
  }
 else {
    popup.showInBestPositionFor(dataContext);
  }
}
