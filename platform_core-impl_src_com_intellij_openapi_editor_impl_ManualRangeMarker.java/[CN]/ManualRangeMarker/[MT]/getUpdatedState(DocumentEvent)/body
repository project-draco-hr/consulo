{
  if (event instanceof RetargetRangeMarkers) {
    int start=((RetargetRangeMarkers)event).getStartOffset();
    if (myRange.getStartOffset() >= start && myRange.getEndOffset() <= ((RetargetRangeMarkers)event).getEndOffset()) {
      ProperTextRange range=myRange.shiftRight(((RetargetRangeMarkers)event).getMoveDestinationOffset() - start);
      return Pair.create(range,myLinesCols == null ? null : PersistentRangeMarker.storeLinesAndCols(range,event.getDocument()));
    }
  }
  if (myLinesCols != null) {
    return PersistentRangeMarker.applyChange(event,myRange,myRange.getStartOffset(),myRange.getEndOffset(),myGreedyLeft,myGreedyRight,myLinesCols);
  }
  ProperTextRange range=RangeMarkerImpl.applyChange(event,myRange.getStartOffset(),myRange.getEndOffset(),myGreedyLeft,myGreedyRight);
  return range == null ? null : new Pair<ProperTextRange,PersistentRangeMarker.LinesCols>(range,null);
}
