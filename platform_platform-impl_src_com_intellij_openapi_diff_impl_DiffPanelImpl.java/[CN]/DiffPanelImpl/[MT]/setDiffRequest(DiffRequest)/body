{
  myDiffRequest=data;
  if (data.getHints().contains(DiffTool.HINT_DO_NOT_IGNORE_WHITESPACES)) {
    setComparisonPolicy(ComparisonPolicy.DEFAULT,false);
  }
  myDataProvider.putData(myDiffRequest.getGenericData());
  IdeFocusManager fm=IdeFocusManager.getInstance(myProject);
  boolean isEditor1Focused=getEditor1() != null && fm.getFocusedDescendantFor(getEditor1().getComponent()) != null;
  boolean isEditor2Focused=myData.getContent2() != null && getEditor2() != null && fm.getFocusedDescendantFor(getEditor2().getComponent()) != null;
  setContents(data.getContents()[0],data.getContents()[1]);
  setTitle1(data.getContentTitles()[0]);
  setTitle2(data.getContentTitles()[1]);
  setWindowTitle(myOwnerWindow,data.getWindowTitle());
  data.customizeToolbar(myPanel.resetToolbar());
  myPanel.registerToolbarActions();
  final JComponent oldBottomComponent=myPanel.getBottomComponent();
  if (oldBottomComponent instanceof Disposable) {
    Disposer.dispose((Disposable)oldBottomComponent);
  }
  final JComponent newBottomComponent=data.getBottomComponent();
  myPanel.setBottomComponent(newBottomComponent);
  if (myIsRequestFocus) {
    if (isEditor1Focused || isEditor2Focused) {
      Editor e=isEditor2Focused ? getEditor2() : getEditor1();
      if (e != null) {
        fm.requestFocus(e.getContentComponent(),true);
      }
    }
    myPanel.requestScrollEditors();
  }
}
