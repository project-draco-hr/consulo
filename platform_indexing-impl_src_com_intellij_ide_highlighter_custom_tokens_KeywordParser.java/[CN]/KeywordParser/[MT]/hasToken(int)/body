{
  int index=0;
  int offset=position;
  boolean found=false;
  while (offset < myBuffer.length()) {
    char c=myBuffer.charAt(offset++);
    int nextIndex=myTrie.findSubNode(index,myIgnoreCase ? Character.toUpperCase(c) : c);
    if (nextIndex == 0) {
      break;
    }
    index=nextIndex;
    if (myHashCodes.contains(index) && isWordEnd(offset)) {
      String keyword=myBuffer.subSequence(position,offset).toString();
      String testKeyword=myIgnoreCase ? StringUtil.toUpperCase(keyword) : keyword;
      for (int i=0; i < CustomHighlighterTokenType.KEYWORD_TYPE_COUNT; i++) {
        if (myKeywordSets.get(i).contains(testKeyword)) {
          myTokenInfo.updateData(position,position + keyword.length(),getToken(i));
          found=true;
          break;
        }
      }
    }
  }
  return found;
}
