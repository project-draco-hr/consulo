{
  MavenEmbedder e=MavenEmbedderFactory.createEmbedderForRead(mavenSettings,this);
  try {
    Set<VirtualFile> updatedFiles=new HashSet<VirtualFile>();
    for (    VirtualFile each : files) {
      MavenProjectModel n=findProject(each);
      if (n == null) {
        doAdd(each,e,updatedFiles,p,force);
      }
 else {
        doUpdate(n,e,false,updatedFiles,p,force);
      }
    }
  }
  finally {
    MavenEmbedderFactory.releaseEmbedder(e);
  }
}
