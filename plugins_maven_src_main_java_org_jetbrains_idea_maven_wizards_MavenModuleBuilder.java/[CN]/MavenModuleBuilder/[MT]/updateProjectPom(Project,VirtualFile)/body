{
  new WriteCommandAction.Simple(project,"Create new Maven module",getPsiFile(project,pom)){
    protected void run() throws Throwable {
      if (myParentProject != null) {
        MavenModel model=MavenUtil.getMavenModel(project,pom);
        MavenParent parent=model.getMavenParent();
        MavenId parentId=myParentProject.getMavenId();
        parent.getGroupId().setStringValue(parentId.groupId);
        parent.getArtifactId().setStringValue(parentId.artifactId);
        parent.getVersion().setStringValue(parentId.version);
        if (myInheritGroupId) {
          XmlElement el=model.getGroupId().getXmlElement();
          if (el != null)           el.delete();
        }
        if (myInheritVersion) {
          XmlElement el=model.getVersion().getXmlElement();
          if (el != null)           el.delete();
        }
        if (pom.getParent().getParent() != myParentProject.getDirectoryFile()) {
          parent.getRelativePath().setValue(getPsiFile(project,myParentProject.getFile()));
        }
      }
      CodeStyleManager.getInstance(project).reformat(getPsiFile(project,pom));
    }
  }
.execute();
}
