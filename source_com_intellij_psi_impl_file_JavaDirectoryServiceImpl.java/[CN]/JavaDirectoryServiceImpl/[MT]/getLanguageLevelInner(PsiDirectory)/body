{
  final VirtualFile virtualFile=dir.getVirtualFile();
  final Project project=dir.getProject();
  final Module module=ProjectRootManager.getInstance(project).getFileIndex().getModuleForFile(virtualFile);
  if (module != null) {
    return module.getEffectiveLanguageLevel();
  }
  return JavaPsiFacade.getInstance(project).getEffectiveLanguageLevel();
}
