{
  final LookupImpl lookup=getLookup();
  lookup.setCurrentItem(item);
  if (completionChar == 0 || completionChar == '\n' || completionChar == '\t' || completionChar == Lookup.COMPLETE_STATEMENT_SELECT_CHAR) {
    new WriteCommandAction.Simple(getProject()){
      @Override protected void run() throws Throwable {
        lookup.finishLookup(completionChar);
      }
    }
.execute().throwException();
  }
 else {
    type(completionChar);
  }
}
