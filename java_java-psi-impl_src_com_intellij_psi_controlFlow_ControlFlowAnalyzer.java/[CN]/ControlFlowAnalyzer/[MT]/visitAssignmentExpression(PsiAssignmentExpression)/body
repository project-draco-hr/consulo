{
  startElement(expression);
  myStartStatementStack.pushStatement(expression.getRExpression() == null ? expression : expression.getRExpression(),false);
  myEndStatementStack.pushStatement(expression.getRExpression() == null ? expression : expression.getRExpression(),false);
  PsiExpression rExpr=expression.getRExpression();
  if (rExpr != null) {
    rExpr.accept(this);
  }
  PsiExpression lExpr=expression.getLExpression();
  if (lExpr instanceof PsiReferenceExpression) {
    final PsiReferenceExpression referenceExpression=(PsiReferenceExpression)lExpr;
    if (!referenceExpression.isQualified() || referenceExpression.getQualifierExpression() instanceof PsiThisExpression) {
      PsiVariable variable=getUsedVariable(referenceExpression);
      if (variable != null) {
        if (myAssignmentTargetsAreElements)         startElement(lExpr);
        if (expression.getOperationTokenType() != JavaTokenType.EQ) {
          generateReadInstruction(variable);
        }
        generateWriteInstruction(variable);
        if (myAssignmentTargetsAreElements)         finishElement(lExpr);
      }
    }
 else {
      lExpr.accept(this);
    }
  }
 else {
    lExpr.accept(this);
  }
  myStartStatementStack.popStatement();
  myEndStatementStack.popStatement();
  finishElement(expression);
}
