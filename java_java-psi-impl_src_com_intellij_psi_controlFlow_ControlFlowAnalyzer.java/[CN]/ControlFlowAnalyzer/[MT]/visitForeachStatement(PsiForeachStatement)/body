{
  startElement(statement);
  final PsiStatement body=statement.getBody();
  myStartStatementStack.pushStatement(body == null ? statement : body,false);
  myEndStatementStack.pushStatement(statement,false);
  final PsiExpression iteratedValue=statement.getIteratedValue();
  if (iteratedValue != null) {
    iteratedValue.accept(this);
  }
  final int gotoTarget=myCurrentFlow.getSize();
  Instruction instruction=new ConditionalGoToInstruction(0,statement.getIteratedValue());
  myCurrentFlow.addInstruction(instruction);
  addElementOffsetLater(statement,false);
  final PsiParameter iterationParameter=statement.getIterationParameter();
  if (myPolicy.isParameterAccepted(iterationParameter)) {
    generateWriteInstruction(iterationParameter);
  }
  if (body != null) {
    body.accept(this);
  }
  final GoToInstruction gotoInstruction=new GoToInstruction(gotoTarget);
  myCurrentFlow.addInstruction(gotoInstruction);
  myStartStatementStack.popStatement();
  myEndStatementStack.popStatement();
  finishElement(statement);
}
