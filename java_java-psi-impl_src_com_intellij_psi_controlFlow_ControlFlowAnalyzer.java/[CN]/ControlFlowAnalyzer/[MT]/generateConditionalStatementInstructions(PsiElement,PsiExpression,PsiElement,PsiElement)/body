{
  if (thenBranch == null) {
    myStartStatementStack.pushStatement(statement,false);
  }
 else {
    myStartStatementStack.pushStatement(thenBranch,true);
  }
  if (elseBranch == null) {
    myEndStatementStack.pushStatement(statement,false);
  }
 else {
    myEndStatementStack.pushStatement(elseBranch,true);
  }
  myEndJumpRoles.push(elseBranch == null ? BranchingInstruction.Role.END : BranchingInstruction.Role.ELSE);
  myStartJumpRoles.push(thenBranch == null ? BranchingInstruction.Role.END : BranchingInstruction.Role.THEN);
  if (conditionExpression != null) {
    conditionExpression.accept(this);
  }
  boolean generateElseFlow=true;
  boolean generateThenFlow=true;
  boolean generateConditionalJump=true;
  if (myEvaluateConstantIfCondition) {
    final Object value=myConstantEvaluationHelper.computeConstantExpression(conditionExpression);
    if (value instanceof Boolean) {
      boolean condition=((Boolean)value).booleanValue();
      generateThenFlow=condition;
      generateElseFlow=!condition;
      generateConditionalJump=false;
      myCurrentFlow.setConstantConditionOccurred(true);
    }
  }
  if (generateConditionalJump) {
    BranchingInstruction.Role role=elseBranch == null ? BranchingInstruction.Role.END : BranchingInstruction.Role.ELSE;
    Instruction instruction=new ConditionalGoToInstruction(0,role,conditionExpression);
    myCurrentFlow.addInstruction(instruction);
    if (elseBranch == null) {
      addElementOffsetLater(statement,false);
    }
 else {
      addElementOffsetLater(elseBranch,true);
    }
  }
  if (thenBranch != null && generateThenFlow) {
    thenBranch.accept(this);
  }
  if (elseBranch != null && generateElseFlow) {
    if (generateThenFlow) {
      Instruction instruction=new GoToInstruction(0);
      myCurrentFlow.addInstruction(instruction);
      addElementOffsetLater(statement,false);
    }
    elseBranch.accept(this);
  }
  myStartJumpRoles.pop();
  myEndJumpRoles.pop();
  myStartStatementStack.popStatement();
  myEndStatementStack.popStatement();
}
