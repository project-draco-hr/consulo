{
  final String name=HgUtil.getNewBranchNameFromUser(myProject,"Create New Branch");
  if (name == null) {
    return;
  }
  try {
    new HgBranchCreateCommand(myProject,myPreselectedRepo,name).execute(new HgCommandResultHandler(){
      @Override public void process(      @Nullable HgCommandResult result){
        myProject.getMessageBus().syncPublisher(HgVcs.BRANCH_TOPIC).update(myProject,null);
        if (HgErrorUtil.hasErrorsInCommandExecution(result)) {
          new HgCommandResultNotifier(myProject).notifyError(result,"Creation failed","Branch creation [" + name + "] failed");
        }
      }
    }
);
  }
 catch (  HgCommandException exception) {
    HgAbstractGlobalAction.handleException(myProject,"Can't create new branch: ",exception);
  }
}
