{
  final HgBookmarkDialog bookmarkDialog=new HgBookmarkDialog(myProject);
  bookmarkDialog.show();
  if (bookmarkDialog.isOK()) {
    try {
      final String name=bookmarkDialog.getName();
      new HgBookmarkCreateCommand(myProject,myPreselectedRepo,name,bookmarkDialog.isActive()).execute(new HgCommandResultHandler(){
        @Override public void process(        @Nullable HgCommandResult result){
          myProject.getMessageBus().syncPublisher(HgVcs.BRANCH_TOPIC).update(myProject,null);
          if (HgErrorUtil.hasErrorsInCommandExecution(result)) {
            new HgCommandResultNotifier(myProject).notifyError(result,"Creation failed","Bookmark creation [" + name + "] failed");
          }
        }
      }
);
    }
 catch (    HgCommandException exception) {
      HgAbstractGlobalAction.handleException(myProject,exception);
    }
  }
}
