{
  Entry root=new RootEntry();
  createFile(root,1,"file",s.storeContent(b("old content")),1L);
  Change c=new ChangeFileContentChange("file",s.storeContent(b("new content")),2L);
  c.applyTo(root);
  os.writeChange(c);
  Change read=is.readChange();
  assertEquals(ChangeFileContentChange.class,read.getClass());
  ChangeFileContentChange result=(ChangeFileContentChange)read;
  assertEquals(array(idp(-1,1)),result.getAffectedIdPaths());
  assertEquals(c("old content"),result.getOldContent());
  assertEquals(1L,result.getOldTimestamp());
}
