{
  super(new BorderLayout());
  myProject=project;
  myToolWindow=toolWindow;
  myToolWindow.setDecorator(this);
  myDivider=new MyDivider();
  myToggleFloatingModeAction=new ToggleFloatingModeAction();
  myToggleSideModeAction=new ToggleSideModeAction();
  myToggleDockModeAction=new ToggleDockModeAction();
  myToggleAutoHideModeAction=new TogglePinnedModeAction();
  myToggleContentUiTypeAction=new ToggleContentUiTypeAction();
  myListenerList=new EventListenerList();
  myHeader=new ToolWindowHeader(toolWindow,info,new Producer<ActionGroup>(){
    @Override public ActionGroup produce(){
      return createGearPopupGroup();
    }
  }
){
    @Override protected boolean isActive(){
      return isFocused();
    }
    protected void hideToolWindow(){
      fireHidden();
    }
    @Override protected void toolWindowTypeChanged(    ToolWindowType type){
      fireTypeChanged(type);
    }
    @Override protected void sideHidden(){
      fireHiddenSide();
    }
  }
;
  MyKeymapManagerListener keymapManagerListener=new MyKeymapManagerListener();
  final KeymapManagerEx keymapManager=KeymapManagerEx.getInstanceEx();
  myWeakKeymapManagerListener=new WeakKeymapManagerListener(keymapManager,keymapManagerListener);
  keymapManager.addKeymapManagerListener(myWeakKeymapManagerListener);
  init();
  myToolWindowHandler=new ToolWindowHandler();
  myToolWindow.addPropertyChangeListener(myToolWindowHandler);
  apply(info);
}
