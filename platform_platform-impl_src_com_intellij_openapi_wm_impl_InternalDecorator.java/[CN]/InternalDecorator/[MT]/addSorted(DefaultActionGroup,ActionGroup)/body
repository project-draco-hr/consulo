{
  final AnAction[] children=group.getChildren(null);
  boolean hadSecondary=false;
  for (  AnAction action : children) {
    if (group.isPrimary(action)) {
      main.add(action);
    }
 else {
      hadSecondary=true;
    }
  }
  if (hadSecondary) {
    main.addSeparator();
    for (    AnAction action : children) {
      if (!group.isPrimary(action)) {
        main.addAction(action).setAsSecondary(true);
      }
    }
  }
  String separatorText=group.getTemplatePresentation().getText();
  if (children.length > 0 && !StringUtil.isEmpty(separatorText)) {
    main.addAction(new AnSeparator(separatorText),Constraints.FIRST);
  }
}
