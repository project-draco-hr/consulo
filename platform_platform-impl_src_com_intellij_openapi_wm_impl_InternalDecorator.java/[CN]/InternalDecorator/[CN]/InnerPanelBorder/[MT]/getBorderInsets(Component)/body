{
  UISettings settings=UISettings.getInstance();
  ToolWindowManagerImpl mgr=((ToolWindowImpl)myWindow).getToolWindowManager();
  if (!mgr.isToolWindowRegistered(((ToolWindowImpl)myWindow).getId()))   return new Insets(0,0,0,0);
  List<String> topIds=mgr.getIdsOn(ToolWindowAnchor.TOP);
  boolean topButtons=!settings.HIDE_TOOL_STRIPES && !topIds.isEmpty();
  boolean windowAtTop=hasDockedVisible(mgr,topIds);
  List<String> bottomIds=mgr.getIdsOn(ToolWindowAnchor.BOTTOM);
  boolean bottomButtons=!settings.HIDE_TOOL_STRIPES && !bottomIds.isEmpty();
  boolean windowAtBottom=hasDockedVisible(mgr,bottomIds);
  List<String> leftIds=mgr.getIdsOn(ToolWindowAnchor.LEFT);
  boolean leftButtons=!settings.HIDE_TOOL_STRIPES && !leftIds.isEmpty();
  boolean windowAtLeft=hasDockedVisible(mgr,leftIds);
  List<String> rightIds=mgr.getIdsOn(ToolWindowAnchor.RIGHT);
  boolean rightBottoms=!settings.HIDE_TOOL_STRIPES && !rightIds.isEmpty();
  boolean windowAtRight=hasDockedVisible(mgr,rightIds);
  Insets insets=new Insets(0,0,0,0);
  if (myWindow.getAnchor() == ToolWindowAnchor.TOP) {
    insets.top=topButtons ? 1 : 0;
    insets.left=leftButtons ? 1 : 0;
    insets.right=rightBottoms ? 1 : 0;
    insets.bottom=1;
  }
 else   if (myWindow.getAnchor() == ToolWindowAnchor.BOTTOM) {
    insets.top=1;
    insets.left=leftButtons ? 1 : 0;
    insets.right=rightBottoms ? 1 : 0;
    insets.bottom=bottomButtons ? 1 : 0;
  }
 else   if (myWindow.getAnchor() == ToolWindowAnchor.LEFT) {
    insets.top=myWindow.isSplitMode() ? 1 : 4;
    insets.left=leftButtons ? 1 : 0;
    insets.right=1;
    insets.bottom=bottomButtons && !windowAtBottom ? 1 : 0;
  }
 else   if (myWindow.getAnchor() == ToolWindowAnchor.RIGHT) {
    insets.top=myWindow.isSplitMode() ? 1 : 4;
    insets.left=1;
    insets.right=rightBottoms ? 1 : 0;
    insets.bottom=bottomButtons && !windowAtBottom ? 1 : 0;
  }
  return insets;
}
