{
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    public void run(){
      ExternalResourceManagerEx manager=ExternalResourceManagerEx.getInstanceEx();
      if (myProject == null) {
        manager.clearAllResources();
      }
 else {
        manager.clearAllResources(myProject);
      }
      for (      NameLocationPair pair : myPairs) {
        String s=FileUtil.toSystemIndependentName(StringUtil.notNullize(pair.myLocation));
        if (myProject == null || pair.myShared) {
          manager.addResource(pair.myName,s);
        }
 else {
          manager.addResource(pair.myName,s,myProject);
        }
      }
      for (      Object myIgnoredUrl : myIgnoredUrls) {
        String url=(String)myIgnoredUrl;
        manager.addIgnoredResource(url);
      }
      if (myProject != null) {
        manager.setDefaultHtmlDoctype(myHtmlLanguageLevelForm.getDoctype(),myProject);
      }
    }
  }
);
  setModified(false);
}
