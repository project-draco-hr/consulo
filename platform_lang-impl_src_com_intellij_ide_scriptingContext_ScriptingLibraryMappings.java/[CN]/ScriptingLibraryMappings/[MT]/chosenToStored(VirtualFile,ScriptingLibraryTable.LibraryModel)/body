{
  if (value instanceof CompoundLibrary)   return value;
  CompoundLibrary compoundLib=file == null ? myProjectLibs : myCompoundLibMap.get(file);
  if (value == null) {
    if (compoundLib != null) {
      compoundLib.clearLibraries();
      myCompoundLibMap.remove(file);
      compoundLib=null;
    }
  }
 else {
    if (compoundLib == null) {
      compoundLib=new CompoundLibrary();
      myCompoundLibMap.put(file,compoundLib);
    }
    compoundLib.toggleLibrary(value);
    if (compoundLib.isEmpty()) {
      myCompoundLibMap.remove(file);
      compoundLib=null;
    }
  }
  return compoundLib;
}
