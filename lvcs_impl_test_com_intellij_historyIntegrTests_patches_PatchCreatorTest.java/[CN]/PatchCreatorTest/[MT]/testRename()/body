{
  VirtualFile f=root.createChildData(null,"f.java");
  f.setBinaryContent(new byte[]{1});
  f.rename(null,"ff.java");
  createPatchBetweenRevisions(1,0);
  f.rename(null,"f.java");
  applyPatch();
  VirtualFile patched=root.findChild("ff.java");
  assertNull(root.findChild("f.java"));
  assertNotNull(patched);
  assertEquals(1,patched.contentsToByteArray()[0]);
}
