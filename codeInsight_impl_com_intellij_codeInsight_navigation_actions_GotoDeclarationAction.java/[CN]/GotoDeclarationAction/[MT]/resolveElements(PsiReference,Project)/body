{
  PsiElement parent=reference.getElement().getParent();
  if (parent instanceof PsiMethodCallExpression) {
    PsiMethodCallExpression callExpr=(PsiMethodCallExpression)parent;
    boolean allowStatics=false;
    PsiExpression qualifier=callExpr.getMethodExpression().getQualifierExpression();
    if (qualifier == null) {
      allowStatics=true;
    }
 else     if (qualifier instanceof PsiJavaCodeReferenceElement) {
      PsiElement referee=((PsiJavaCodeReferenceElement)qualifier).advancedResolve(true).getElement();
      if (referee instanceof PsiClass)       allowStatics=true;
    }
    PsiManager manager=PsiManager.getInstance(project);
    PsiResolveHelper helper=manager.getResolveHelper();
    PsiElement[] candidates=PsiUtil.mapElements(helper.getReferencedMethodCandidates(callExpr,false));
    ArrayList<PsiElement> methods=new ArrayList<PsiElement>();
    for (    PsiElement candidate1 : candidates) {
      PsiMethod candidate=(PsiMethod)candidate1;
      if (candidate.hasModifierProperty(PsiModifier.STATIC) && !allowStatics)       continue;
      List<PsiMethod> supers=Arrays.asList(candidate.findSuperMethods());
      if (supers.isEmpty()) {
        methods.add(candidate);
      }
 else {
        methods.addAll(supers);
      }
    }
    return methods;
  }
  if (reference instanceof PsiPolyVariantReference) {
    final ResolveResult[] results=((PsiPolyVariantReference)reference).multiResolve(false);
    final ArrayList<PsiElement> navigatableResults=new ArrayList<PsiElement>(results.length);
    for (    ResolveResult r : results) {
      PsiElement element=r.getElement();
      if (element != reference.getElement() && (EditSourceUtil.canNavigate(element) || element instanceof Navigatable && ((Navigatable)element).canNavigateToSource())) {
        navigatableResults.add(element);
      }
    }
    return navigatableResults;
  }
  PsiElement resolved=reference.resolve();
  if (resolved instanceof NavigationItem) {
    return Collections.singleton(resolved);
  }
  return Collections.emptyList();
}
