{
  final PsiReference reference=TargetElementUtil.findReference(editor,offset);
  final Collection<PsiElement> candidates=suggestCandidates(project,reference);
  if (candidates.size() == 1) {
    Navigatable navigatable=EditSourceUtil.getDescriptor(candidates.iterator().next());
    if (navigatable != null && navigatable.canNavigate()) {
      navigatable.navigate(true);
    }
  }
 else   if (candidates.size() > 1) {
    PsiElement[] elements=candidates.toArray(new PsiElement[candidates.size()]);
    final TextRange range=reference.getRangeInElement();
    final String refText=reference.getElement().getText().substring(range.getStartOffset(),range.getEndOffset());
    String title=CodeInsightBundle.message("declaration.navigation.title",refText);
    NavigationUtil.getPsiElementPopup(elements,title).showInBestPositionFor(editor);
  }
}
