{
  AbstractBlockWrapper previous=getPreviousIncompleteBlock(block,offset);
  if (previous != null) {
    return getLastNestedCompositeBlockForSameRange(previous);
  }
 else {
    return getParentFor(offset,(AbstractBlockWrapper)block);
  }
}
