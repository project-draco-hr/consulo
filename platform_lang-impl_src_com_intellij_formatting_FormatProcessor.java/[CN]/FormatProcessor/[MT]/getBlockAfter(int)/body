{
  int current=startOffset;
  LeafBlockWrapper result=null;
  while (current < myLastWhiteSpace.getStartOffset()) {
    final LeafBlockWrapper currentValue=myTextRangeToWrapper.get(current);
    if (currentValue != null) {
      result=currentValue;
      break;
    }
    current++;
  }
  LeafBlockWrapper prevBlock=getPrevBlock(result);
  if (prevBlock != null && prevBlock.contains(startOffset)) {
    return prevBlock;
  }
 else {
    return result;
  }
}
