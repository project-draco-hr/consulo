{
  final Project project=e.getData(DataKeys.PROJECT);
  if (project != null) {
    final List<? extends AppEngineFacet> facets=AppEngineUtil.collectAllFacets(project);
    if (facets.isEmpty()) {
      Messages.showErrorDialog(project,"No App Engine facets found in the project",CommonBundle.getErrorTitle());
      return;
    }
    AppEngineFacet facet;
    if (facets.size() == 1) {
      facet=facets.get(0);
    }
 else {
      final UploadApplicationDialog dialog=new UploadApplicationDialog(project);
      dialog.show();
      facet=dialog.getSelectedFacet();
      if (!dialog.isOK() || facet == null) {
        return;
      }
    }
    final AppEngineUploader uploader=new AppEngineUploader(project);
    uploader.startUploading(facet);
  }
}
