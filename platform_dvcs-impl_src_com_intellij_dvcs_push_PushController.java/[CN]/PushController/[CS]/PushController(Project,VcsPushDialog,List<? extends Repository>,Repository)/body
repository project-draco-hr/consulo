{
  myProject=project;
  myPushSettings=ServiceManager.getService(project,PushSettings.class);
  myGlobalRepositoryManager=ServiceManager.getService(project,VcsRepositoryManager.class);
  myExcludedRepositoryRoots=ContainerUtil.newHashSet(myPushSettings.getExcludedRepoRoots());
  myPreselectedRepositories=preselectedRepositories;
  myCurrentlyOpenedRepository=currentRepo;
  myPushSupports=getAffectedSupports(myProject);
  mySingleRepoProject=isSingleRepoProject();
  myDialog=dialog;
  CheckedTreeNode rootNode=new CheckedTreeNode(null);
  createTreeModel(rootNode);
  myPushLog=new PushLog(myProject,rootNode);
  myPushLog.getTree().addPropertyChangeListener(PushLogTreeUtil.EDIT_MODE_PROP,new PropertyChangeListener(){
    @Override public void propertyChange(    PropertyChangeEvent evt){
      Boolean isEditMode=(Boolean)evt.getNewValue();
      if (isEditMode) {
        myDialog.disableOkActions();
      }
    }
  }
);
  startLoadingCommits();
  Disposer.register(dialog.getDisposable(),this);
}
