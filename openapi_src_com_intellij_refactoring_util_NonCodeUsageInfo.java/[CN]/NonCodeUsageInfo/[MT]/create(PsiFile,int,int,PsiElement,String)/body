{
  PsiElement element=file.findElementAt(startOffset);
  TextRange range;
  while (true) {
    range=element.getTextRange();
    if (range.getEndOffset() < endOffset) {
      element=element.getParent();
    }
 else {
      break;
    }
  }
  int elementStart=range.getStartOffset();
  startOffset-=elementStart;
  endOffset-=elementStart;
  return new NonCodeUsageInfo(element,startOffset,endOffset,referencedElement,newText);
}
