{
  configureByFileNoCompletion("/codeInsight/completion/normal/" + getTestName(false) + ".java");
  final ModifiableRootModel model=ModuleRootManager.getInstance(getModule()).getModifiableModel();
  model.getContentEntries()[0].getSourceFolders()[0].setPackagePrefix("foo.bar.goo");
  model.commit();
  complete();
  checkResultByFile("/codeInsight/completion/normal/" + getTestName(false) + "_after.java");
  assertTrue(JavaPsiFacade.getInstance(myProject).findPackage("foo").isValid());
  assertTrue(JavaPsiFacade.getInstance(myProject).findPackage("foo.bar").isValid());
  assertTrue(JavaPsiFacade.getInstance(myProject).findPackage("foo.bar.goo").isValid());
}
