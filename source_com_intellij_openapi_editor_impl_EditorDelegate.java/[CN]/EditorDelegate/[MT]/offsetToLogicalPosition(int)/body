{
  int lineStartOffset=myDocument.getLineStartOffset(myDocument.getLineNumber(offset));
  LogicalPosition windowPosition=myDelegate.offsetToLogicalPosition(myDocument.getTextRange().getStartOffset());
  LogicalPosition pos=myDelegate.offsetToLogicalPosition(offset + myDocument.getTextRange().getStartOffset());
  return new LogicalPosition(pos.line - windowPosition.line,offset - lineStartOffset);
}
