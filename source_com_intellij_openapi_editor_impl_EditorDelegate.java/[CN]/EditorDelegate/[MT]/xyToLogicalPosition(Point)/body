{
  LogicalPosition windowPosition=myDelegate.offsetToLogicalPosition(myDocument.getTextRange().getStartOffset());
  LogicalPosition pos=myDelegate.xyToLogicalPosition(p);
  int myOffset=logicalPositionToOffset(parentToInjected(pos));
  int lineStartOffset=myDocument.getLineStartOffset(myDocument.getLineNumber(myOffset));
  return new LogicalPosition(pos.line - windowPosition.line,myOffset - lineStartOffset);
}
