{
  if (!StringUtil.isEmptyOrSpaces(overrideMavenHome)) {
    return new File(overrideMavenHome);
  }
  final String m2home=System.getenv(ENV_M2_HOME);
  if (!StringUtil.isEmptyOrSpaces(m2home)) {
    final File homeFromEnv=new File(m2home);
    if (isValidMavenHome(homeFromEnv)) {
      return homeFromEnv;
    }
  }
  final String userHome=System.getProperty(PROP_USER_HOME);
  if (!StringUtil.isEmptyOrSpaces(userHome)) {
    final File underUserHome=new File(userHome,M2_DIR);
    if (isValidMavenHome(underUserHome)) {
      return underUserHome;
    }
  }
  return null;
}
