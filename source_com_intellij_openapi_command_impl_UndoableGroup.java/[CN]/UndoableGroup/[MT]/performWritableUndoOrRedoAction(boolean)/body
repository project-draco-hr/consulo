{
  final Iterator<UndoableAction> each=isUndo ? reverseIterator(myActions.listIterator(myActions.size())) : myActions.iterator();
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    public void run(){
      String message="Cannot " + actionName(isUndo);
      while (each.hasNext()) {
        UndoableAction undoableAction=each.next();
        try {
          if (isUndo)           undoableAction.undo();
 else           undoableAction.redo();
        }
 catch (        UnexpectedUndoException e) {
          if (!ApplicationManager.getApplication().isUnitTestMode()) {
            if (e.getMessage() != null) {
              message+=".\n" + e.getMessage();
            }
            Messages.showMessageDialog(myProject,message,message,Messages.getErrorIcon());
          }
 else {
            LOG.error(e);
          }
        }
      }
    }
  }
);
}
