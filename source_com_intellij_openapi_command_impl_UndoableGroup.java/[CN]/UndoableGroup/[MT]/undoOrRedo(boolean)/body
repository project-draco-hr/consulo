{
  LocalHistoryAction actionStarted=LvcsAction.EMPTY;
  if (myProject != null) {
    LocalVcs lvcs=LocalVcs.getInstance(myProject);
    if (isComplex() && lvcs != null) {
      final String lvcsActionName;
      if (isUndo) {
        lvcsActionName=CommonBundle.message("local.vcs.action.name.undo.command",myCommandName);
      }
 else {
        lvcsActionName=CommonBundle.message("local.vcs.action.name.redo.command",myCommandName);
      }
      actionStarted=lvcs.startAction_New(lvcsActionName,"",false);
    }
  }
  try {
    performWritableUndoOrRedoAction(isUndo);
  }
  finally {
    actionStarted.finish();
  }
}
