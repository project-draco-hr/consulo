{
  LocalHistoryAction action=LvcsAction.EMPTY;
  if (myProject != null) {
    if (isComplex()) {
      final String actionName;
      if (isUndo) {
        actionName=CommonBundle.message("local.vcs.action.name.undo.command",myCommandName);
      }
 else {
        actionName=CommonBundle.message("local.vcs.action.name.redo.command",myCommandName);
      }
      action=LocalHistory.startAction(myProject,actionName);
    }
  }
  try {
    performWritableUndoOrRedoAction(isUndo);
  }
  finally {
    action.finish();
  }
}
