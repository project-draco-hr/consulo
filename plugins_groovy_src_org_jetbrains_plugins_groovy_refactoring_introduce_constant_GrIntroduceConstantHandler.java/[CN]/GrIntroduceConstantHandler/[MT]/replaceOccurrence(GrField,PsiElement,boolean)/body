{
  final PsiElement replaced;
  final GrReferenceExpression newExpr=createRefExpression(field,occurrence);
  if (occurrence instanceof GrExpression) {
    replaced=((GrExpression)occurrence).replaceWithExpression(newExpr,false);
  }
 else {
    replaced=occurrence.replace(newExpr);
  }
  if (escalateVisibility) {
    PsiUtil.escalateVisibility(field,replaced);
  }
  if (replaced instanceof GrReferenceExpression) {
    if (PsiUtil.shortenReference((GrReferenceExpression)replaced))     return;
    final PsiElement qualifier=((GrReferenceElement)replaced).getQualifier();
    if (qualifier instanceof GrReferenceExpression) {
      PsiUtil.shortenReference((GrReferenceExpression)qualifier);
    }
  }
}
