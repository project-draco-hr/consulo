{
  myMessage.clear();
  addInfo("Waiting for IDE frame activation",-1);
  myRunner=new PlaybackRunner(myDocument.getText(),this);
  new Thread(){
    @Override public void run(){
      new WaitFor(){
        protected boolean condition(){
          return KeyboardFocusManager.getCurrentKeyboardFocusManager().getFocusedWindow() instanceof IdeFrame || myRunner == null;
        }
      }
;
      if (myRunner == null) {
        message("Script stopped",-1);
        return;
      }
      message("Starting script...",-1);
      try {
        sleep(1000);
      }
 catch (      InterruptedException e) {
      }
      if (myRunner == null) {
        message("Script stopped",-1);
        return;
      }
      myRunner.run().doWhenProcessed(new Runnable(){
        public void run(){
          myRunner=null;
        }
      }
);
    }
  }
.start();
}
