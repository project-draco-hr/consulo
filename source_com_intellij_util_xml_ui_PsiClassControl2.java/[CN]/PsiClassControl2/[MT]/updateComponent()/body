{
  final EditorTextField textField=getTextField();
  ApplicationManager.getApplication().invokeLater(new Runnable(){
    public void run(){
      final List<DomElementProblemDescriptor> errorProblems=DomElementAnnotationsManager.getInstance().getProblems(getDomElement(),true);
      final List<DomElementProblemDescriptor> warningProblems=DomElementAnnotationsManager.getInstance().getProblems(getDomElement(),true,true,HighlightSeverity.WARNING);
      Color background=getDefaultBackground();
      if (errorProblems.size() > 0 && textField.getText().trim().length() == 0) {
        background=getErrorBackground();
      }
 else       if (warningProblems.size() > 0) {
        background=getWarningBackground();
      }
      textField.setBackground(background);
      errorProblems.addAll(warningProblems);
      textField.setToolTipText(TooltipUtils.getTooltipText(errorProblems));
      final Editor editor=textField.getEditor();
      if (editor != null && isCommitted()) {
        DaemonCodeAnalyzer.getInstance(getProject()).updateVisibleHighlighters(editor);
      }
    }
  }
);
}
