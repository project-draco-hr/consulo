{
  final List<V> variants=handler.computeSmartStepVariants(position);
  if (variants.isEmpty()) {
    session.stepInto();
    return;
  }
 else   if (variants.size() == 1) {
    session.smartStepInto(handler,variants.get(0));
    return;
  }
  JBPopupFactory.getInstance().createListPopup(new BaseListPopupStep<V>(handler.getPopupTitle(position),variants){
    @Override public Icon getIconFor(    V aValue){
      return aValue.getIcon();
    }
    @NotNull @Override public String getTextFor(    V value){
      return value.getText();
    }
    @Override public PopupStep onChosen(    V selectedValue,    boolean finalChoice){
      session.smartStepInto(handler,selectedValue);
      return FINAL_CHOICE;
    }
  }
).show(relativePoint);
}
