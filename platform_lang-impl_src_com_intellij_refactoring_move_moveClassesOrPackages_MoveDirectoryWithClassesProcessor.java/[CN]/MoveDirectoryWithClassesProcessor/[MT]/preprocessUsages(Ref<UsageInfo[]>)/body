{
  final MultiMap<PsiElement,String> conflicts=new MultiMap<PsiElement,String>();
  for (  PsiFile psiFile : myFilesToMove.keySet()) {
    try {
      myFilesToMove.get(psiFile).checkMove(psiFile);
    }
 catch (    IncorrectOperationException e) {
      conflicts.putValue(psiFile,e.getMessage());
    }
  }
  for (  MoveDirectoryWithClassesHelper helper : MoveDirectoryWithClassesHelper.findAll()) {
    helper.preprocessUsages(myProject,myFilesToMove.keySet(),refUsages.get(),myTargetDirectory,conflicts);
  }
  return showConflicts(conflicts,refUsages.get());
}
