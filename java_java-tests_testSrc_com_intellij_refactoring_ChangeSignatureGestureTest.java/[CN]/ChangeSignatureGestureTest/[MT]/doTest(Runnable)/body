{
  myFixture.configureByFile("/refactoring/changeSignatureGesture/" + getTestName(false) + ".java");
  final ChangeSignatureGestureDetector detector=ChangeSignatureGestureDetector.getInstance(getProject());
  final Document document=myFixture.getEditor().getDocument();
  try {
    PsiManager.getInstance(getProject()).addPsiTreeChangeListener(detector);
    detector.addDocListener(document);
    run.run();
    myFixture.doHighlighting();
    final IntentionAction intention=myFixture.findSingleIntention("Change signature ...");
    myFixture.launchAction(intention);
    myFixture.checkResultByFile("/refactoring/changeSignatureGesture/" + getTestName(false) + "_after.java");
  }
  finally {
    detector.removeDocListener(document);
    PsiManager.getInstance(getProject()).removePsiTreeChangeListener(detector);
  }
}
