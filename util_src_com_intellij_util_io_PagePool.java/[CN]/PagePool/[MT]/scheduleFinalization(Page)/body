{
  final int curFinalizationId;
synchronized (lock) {
    curFinalizationId=++finalizationId;
  }
  final FinalizationRequest request=page.prepareForFinalization(curFinalizationId);
  if (request == null)   return;
  boolean wakeUpFinalizer=false;
synchronized (lock) {
    if (myFinalizerThread == null) {
      myFinalizerThread=new Thread(new FinalizationThreadWorker(),FINALIZER_THREAD_NAME);
      myFinalizerThread.start();
    }
    myFinalizationQueue.put(keyForPage(page),request);
    if (myFinalizationQueue.size() > 5000) {
      flushFinalizationQueue();
    }
 else {
      wakeUpFinalizer=true;
    }
  }
  if (wakeUpFinalizer) {
synchronized (finalizationMonitor) {
      finalizationMonitor.notifyAll();
    }
  }
}
