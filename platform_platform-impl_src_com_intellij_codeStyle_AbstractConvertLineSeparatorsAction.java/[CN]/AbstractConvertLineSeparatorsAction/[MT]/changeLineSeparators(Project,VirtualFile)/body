{
  try {
    CharSequence currentText=LoadTextUtil.getTextByBinaryPresentation(virtualFile.contentsToByteArray(),virtualFile);
    String currentLineSeparator=LoadTextUtil.detectLineSeparator(virtualFile,false);
    if (mySeparator.equals(currentLineSeparator)) {
      return;
    }
    String newText=StringUtil.convertLineSeparators(currentText.toString(),mySeparator);
    LoadTextUtil.write(project,virtualFile,this,newText,-1);
    LocalHistory.getInstance().putSystemLabel(project,String.format("Line Ending: %s->%s",currentLineSeparator == null ? "" : LineSeparator.fromString(currentLineSeparator),LineSeparator.fromString(mySeparator)));
  }
 catch (  IOException e) {
    LOG.warn(e);
  }
}
