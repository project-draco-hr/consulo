{
  myTestFixture.configureByFile(name);
  final PsiFile file=myTestFixture.getFile();
  new WriteCommandAction(myTestFixture.getProject(),file){
    protected void run(    Result result) throws Throwable {
      final Document doc=myTestFixture.getEditor().getDocument();
      ExpectedHighlightingData data=new ExpectedHighlightingData(doc,true,checkWeakWarnings,false,file);
      PsiDocumentManager.getInstance(myTestFixture.getProject()).commitAllDocuments();
      Collection<HighlightInfo> highlights1=doHighlighting(includeExternalToolPass);
      data.checkResult(highlights1,doc.getText());
    }
  }
.execute();
}
