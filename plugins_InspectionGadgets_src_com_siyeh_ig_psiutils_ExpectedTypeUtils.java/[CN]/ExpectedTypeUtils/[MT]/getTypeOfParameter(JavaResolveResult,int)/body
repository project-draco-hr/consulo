{
  final PsiMethod psiMethod=(PsiMethod)result.getElement();
  PsiSubstitutor substitutor=result.getSubstitutor();
  final PsiParameterList paramList=psiMethod.getParameterList();
  final PsiParameter[] parameters=paramList.getParameters();
  if (parameterPosition < 0) {
    return null;
  }
  if (parameterPosition >= parameters.length) {
    final int lastParamPosition=parameters.length - 1;
    if (lastParamPosition < 0) {
      return null;
    }
    final PsiParameter lastParameter=parameters[lastParamPosition];
    if (lastParameter.isVarArgs()) {
      return substitutor.substitute(((PsiArrayType)lastParameter.getType()).getComponentType());
    }
    return null;
  }
  final PsiParameter param=parameters[parameterPosition];
  if (param.isVarArgs()) {
    return substitutor.substitute(((PsiArrayType)param.getType()).getComponentType());
  }
  return substitutor.substitute(param.getType());
}
