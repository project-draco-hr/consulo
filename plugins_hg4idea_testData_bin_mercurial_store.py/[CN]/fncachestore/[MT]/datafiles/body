def datafiles(self):
    rewrite = False
    existing = []
    pjoin = self.pathjoiner
    spath = self.path
    for f in self.fncache:
        ef = hybridencode(f)
        try:
            st = os.stat(pjoin(spath, ef))
            yield (f, ef, st.st_size)
            existing.append(f)
        except OSError:
            rewrite = True
    if rewrite:
        self.fncache.rewrite(existing)
