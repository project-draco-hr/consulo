def _build_lower_encodefun():
    win_reserved = [ord(x) for x in '\\:*?"<>|']
    cmap = dict([(chr(x), chr(x)) for x in xrange(127)])
    for x in ((range(32) + range(126, 256)) + win_reserved):
        cmap[chr(x)] = ('~%02x' % x)
    for x in range(ord('A'), (ord('Z') + 1)):
        cmap[chr(x)] = chr(x).lower()
    return (lambda s: ''.join([cmap[c] for c in s]))
