{
  if (myEditor == null)   return;
  final LookupManager lookupManager=LookupManager.getInstance(myProject);
  if (lookupManager.isDisposed())   return;
  final CompletionParameters parameters=new CompletionParameters(psiFile,psiFile,CompletionType.BASIC,myEditor.getCaretModel().getOffset(),1);
  final Lookup lookup=lookupManager.showLookup(myEditor,lookupItems,new CompletionPreferencePolicy(parameters));
  toProcessTab=false;
  lookup.addLookupListener(new LookupAdapter(){
    public void lookupCanceled(    LookupEvent event){
      lookup.removeLookupListener(this);
      toProcessTab=true;
    }
    public void itemSelected(    LookupEvent event){
      lookup.removeLookupListener(this);
      if (isFinished())       return;
      toProcessTab=true;
      TemplateState.this.itemSelected(event.getItem(),psiFile,currentSegmentNumber,event.getCompletionChar(),lookupItems);
    }
  }
);
}
