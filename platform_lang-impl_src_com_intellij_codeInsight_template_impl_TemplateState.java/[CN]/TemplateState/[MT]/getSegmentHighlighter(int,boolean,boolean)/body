{
  final TextAttributes lvAttr=EditorColorsManager.getInstance().getGlobalScheme().getAttributes(EditorColors.LIVE_TEMPLATE_ATTRIBUTES);
  TextAttributes attributes=isSelected ? lvAttr : new TextAttributes();
  TextAttributes endAttributes=new TextAttributes();
  int start=mySegments.getSegmentStart(segmentNumber);
  int end=mySegments.getSegmentEnd(segmentNumber);
  RangeHighlighter segmentHighlighter=myEditor.getMarkupModel().addRangeHighlighter(start,end,HighlighterLayer.LAST + 1,isEnd ? endAttributes : attributes,HighlighterTargetArea.EXACT_RANGE);
  segmentHighlighter.setGreedyToLeft(true);
  segmentHighlighter.setGreedyToRight(true);
  return segmentHighlighter;
}
