{
  if (myEditor == null)   return;
  final LookupManager lookupManager=LookupManager.getInstance(myProject);
  final Lookup lookup=lookupManager.showLookup(myEditor,lookupItems);
  ((LookupImpl)lookup).setAdvertisementText(advertisingText);
  ((LookupImpl)lookup).refreshUi();
  ourLookupShown=true;
  lookup.addLookupListener(new LookupAdapter(){
    public void lookupCanceled(    LookupEvent event){
      lookup.removeLookupListener(this);
      ourLookupShown=false;
    }
    public void itemSelected(    LookupEvent event){
      lookup.removeLookupListener(this);
      if (isFinished())       return;
      ourLookupShown=false;
      TemplateState.this.itemSelected(event.getItem(),psiFile,currentSegmentNumber,event.getCompletionChar(),lookupItems);
    }
  }
);
}
