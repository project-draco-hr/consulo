{
  if (isDisposed())   return;
  LookupManager.getInstance(myProject).hideActiveLookup();
  calcResults(false);
  if (!brokenOff) {
    doReformat(null);
  }
  setFinalEditorState(brokenOff);
  cleanupTemplateState(brokenOff);
}
