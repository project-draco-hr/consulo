{
  Project project=e.getProject();
  final VcsLog log=e.getData(VcsLogDataKeys.VSC_LOG);
  if (project == null || log == null) {
    return;
  }
  Collection<String> refs=ContainerUtil.map(log.getAllReferences(),new Function<VcsRef,String>(){
    @Override public String fun(    VcsRef ref){
      return ref.getName();
    }
  }
);
  final PopupWithTextFieldWithAutoCompletion textField=new PopupWithTextFieldWithAutoCompletion(project,refs);
  JBPopup popup=textField.createPopup();
  popup.addListener(new JBPopupListener.Adapter(){
    @Override public void onClosed(    LightweightWindowEvent event){
      if (event.isOk()) {
        log.jumpToReference(textField.getText());
      }
    }
  }
);
  popup.showUnderneathOf(log.getToolbar());
}
