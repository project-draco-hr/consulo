{
  if (file.isDirectory()) {
    AddFileOperation op=getOperationForFile(file);
    op.addFile(file);
    if (!containsSubOperation(op)) {
      if (myMainPartSize == getSubOperationsCount()) {
        addOperation(op);
      }
 else {
        addOperation(myMainPartSize,op);
      }
      ++myMainPartSize;
    }
  }
 else {
    if (!mySubstitutionToOperation.containsKey(keywordSubstitution)) {
      final AddFileOperation substitutionOperation=new AddFileOperation(keywordSubstitution);
      mySubstitutionToOperation.put(keywordSubstitution,substitutionOperation);
      addOperation(substitutionOperation);
    }
    mySubstitutionToOperation.get(keywordSubstitution).addFile(file);
  }
}
