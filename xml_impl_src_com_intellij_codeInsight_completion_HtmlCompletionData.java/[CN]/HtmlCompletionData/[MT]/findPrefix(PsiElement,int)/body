{
  XmlTag tag=PsiTreeUtil.getParentOfType(insertedElement,XmlTag.class,false);
  String prefix=null;
  if (isScriptTag(tag) && ourScriptCompletionData != null && !(insertedElement.getParent() instanceof XmlAttributeValue)) {
    prefix=ourScriptCompletionData.findPrefix(insertedElement,offset);
  }
 else   if (isStyleTag(tag) && ourStyleCompletionData != null) {
    prefix=ourStyleCompletionData.findPrefix(insertedElement,offset);
  }
  if (prefix == null) {
    prefix=super.findPrefix(insertedElement,offset);
    if (insertedElement instanceof XmlToken && ((XmlToken)insertedElement).getTokenType() == XmlTokenType.XML_DATA_CHARACTERS && prefix != null && prefix.startsWith("&")) {
      prefix=prefix.substring(1);
    }
  }
  return prefix;
}
