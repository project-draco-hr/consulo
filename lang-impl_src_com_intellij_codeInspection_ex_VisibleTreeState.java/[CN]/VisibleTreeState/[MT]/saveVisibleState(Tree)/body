{
  myExpandedNodes.clear();
  final DefaultMutableTreeNode rootNode=(DefaultMutableTreeNode)tree.getModel().getRoot();
  Enumeration<TreePath> expanded=tree.getExpandedDescendants(new TreePath(rootNode.getPath()));
  if (expanded != null) {
    while (expanded.hasMoreElements()) {
      final TreePath treePath=expanded.nextElement();
      final DefaultMutableTreeNode node=(DefaultMutableTreeNode)treePath.getLastPathComponent();
      String expandedNode;
      if (node.getUserObject() instanceof Descriptor) {
        expandedNode=((Descriptor)node.getUserObject()).getKey().toString();
      }
 else {
        expandedNode=(String)node.getUserObject();
      }
      myExpandedNodes.add(expandedNode);
    }
  }
  setSelectionPaths(tree.getSelectionPaths());
}
