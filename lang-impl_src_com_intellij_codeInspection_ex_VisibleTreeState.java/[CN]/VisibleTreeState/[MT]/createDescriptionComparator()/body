{
  return new Comparator<State>(){
    public int compare(    State s1,    State s2){
      if (s1.myKey.equals(s2.myKey)) {
        if (s1.myDescriptor != null && s2.myDescriptor != null) {
          final NamedScope scope1=s1.myDescriptor.getScope();
          final NamedScope scope2=s2.myDescriptor.getScope();
          if (scope1 != null && scope2 != null) {
            return scope1.getName().compareTo(scope2.getName());
          }
        }
      }
      return s1.myKey.compareTo(s2.myKey);
    }
  }
;
}
