{
  final Value value=descriptor.getValue();
  if (value instanceof ObjectReference) {
    try {
      final ObjectReference objRef=(ObjectReference)value;
      final ReferenceType refType=objRef.referenceType();
      final Field valueField=refType.fieldByName("value");
      if (valueField != null) {
        final Value rgbValue=objRef.getValue(valueField);
        if (rgbValue instanceof IntegerValue) {
          final Color color=new Color(((IntegerValue)rgbValue).value(),true);
          return new ColorIcon(16,12,color,true);
        }
      }
    }
 catch (    Exception e) {
      throw new EvaluateException(e.getMessage(),e);
    }
  }
  return null;
}
