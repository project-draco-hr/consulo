{
  Map<GitRepository,List<Change>> changes=new HashMap<GitRepository,List<Change>>();
  for (  GitRepository repository : repositories) {
    try {
      Collection<String> diff=GitUtil.getPathsDiffBetweenRefs(myPreviousBranch,myStartPointReference,myProject,repository.getRoot());
      List<Change> changesInRepo=getChangesAffectedByCheckout(repository,diff,false);
      if (!changesInRepo.isEmpty()) {
        changes.put(repository,changesInRepo);
      }
    }
 catch (    VcsException e) {
      LOG.warn(String.format("Couldn't collect diff between %s and %s in %s",myPreviousBranch,myStartPointReference,repository.getRoot()));
    }
  }
  return changes;
}
