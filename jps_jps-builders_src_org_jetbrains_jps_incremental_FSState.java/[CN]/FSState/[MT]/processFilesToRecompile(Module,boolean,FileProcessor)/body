{
  final FilesDelta lastRoundDelta=myLastRoundDelta;
  final FilesDelta delta=lastRoundDelta != null ? lastRoundDelta : getDelta(module);
  final Map<File,Set<File>> data=delta.getSourcesToRecompile(forTests);
  final CompilerExcludes excludes=module.getProject().getCompilerConfiguration().getExcludes();
synchronized (data) {
    for (    Map.Entry<File,Set<File>> entry : data.entrySet()) {
      final String root=FileUtil.toSystemIndependentName(entry.getKey().getPath());
      for (      File file : entry.getValue()) {
        if (excludes.isExcluded(file)) {
          continue;
        }
        if (!processor.apply(module,file,root)) {
          return false;
        }
      }
    }
  }
  return true;
}
