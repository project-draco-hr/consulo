{
  final FilesDelta mainDelta=getDelta(rd.module);
  final boolean marked=mainDelta.markRecompileIfNotDeleted(rd.root,rd.isTestRoot,file);
  if (marked) {
    if (tsStorage != null) {
      tsStorage.markDirty(file);
    }
    final FilesDelta roundDelta=myCurrentRoundDelta;
    if (roundDelta != null) {
      if (myContextModules.contains(rd.module)) {
        roundDelta.markRecompile(rd.root,rd.isTestRoot,file);
      }
    }
  }
}
