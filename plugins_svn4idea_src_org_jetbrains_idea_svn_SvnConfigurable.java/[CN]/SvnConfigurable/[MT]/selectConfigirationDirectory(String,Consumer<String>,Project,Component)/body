{
  final FileChooserDescriptor descriptor=createFileDescriptor();
  path="file://" + path.replace(File.separatorChar,'/');
  VirtualFile root=VirtualFileManager.getInstance().findFileByUrl(path);
  String oldValue=PropertiesComponent.getInstance().getValue("FileChooser.showHiddens");
  PropertiesComponent.getInstance().setValue("FileChooser.showHiddens",Boolean.TRUE.toString());
  VirtualFile file=FileChooser.chooseFile(descriptor,component,project,root);
  PropertiesComponent.getInstance().setValue("FileChooser.showHiddens",oldValue);
  if (file == null) {
    return;
  }
  final String resultPath=file.getPath().replace('/',File.separatorChar);
  dirConsumer.consume(resultPath);
}
