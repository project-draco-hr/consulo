{
  PsiClass clazz=resolved.getContainingClass();
  if (clazz == null || !GroovyCommonClassNames.GROOVY_LANG_CLOSURE.equals(clazz.getQualifiedName()))   return null;
  if (!CLOSURE_METHODS.contains(resolved.getName()))   return null;
  GrExpression qualifier=refExpr.getQualifierExpression();
  if (qualifier == null)   return null;
  PsiType qType=qualifier.getType();
  if (!(qType instanceof GrClosureType))   return null;
  if ("call".equals(resolved.getName())) {
    return GrClosureSignatureUtil.getReturnType(((GrClosureType)qType).getSignature(),callExpression);
  }
 else   if ("curry".equals(resolved.getName()) || "trampoline".equals(resolved.getName())) {
    return ((GrClosureType)qType).curry(PsiUtil.getArgumentTypes(refExpr,false),0,callExpression);
  }
 else   if ("memoize".equals(resolved.getName())) {
    return qType;
  }
 else   if ("rcurry".equals(resolved.getName())) {
    return ((GrClosureType)qType).curry(PsiUtil.getArgumentTypes(refExpr,false),-1,callExpression);
  }
 else   if ("ncurry".equals(resolved.getName())) {
    final GrArgumentList argList=callExpression.getArgumentList();
    if (argList != null) {
      final GrExpression[] arguments=argList.getExpressionArguments();
      if (arguments.length > 0) {
        final GrExpression first=arguments[0];
        if (first instanceof GrLiteral) {
          final Object value=((GrLiteral)first).getValue();
          if (value instanceof Integer) {
            final PsiType[] argTypes=PsiUtil.getArgumentTypes(refExpr,false);
            if (argTypes != null) {
              return ((GrClosureType)qType).curry(ArrayUtil.remove(argTypes,0),(Integer)value,callExpression);
            }
          }
        }
      }
    }
    return qType;
  }
  return null;
}
