{
  if (!myRefExpr.isValid() || !myRefExpr.getManager().isInProject(myRefExpr))   return false;
  int offset=editor.getCaretModel().getOffset();
  PsiElement refName=myRefExpr.getReferenceNameElement();
  if (offset < refName.getTextRange().getStartOffset() || offset > refName.getTextRange().getEndOffset()) {
    return false;
  }
  return !CreateFromUsageUtils.isValidReference(myRefExpr,false);
}
