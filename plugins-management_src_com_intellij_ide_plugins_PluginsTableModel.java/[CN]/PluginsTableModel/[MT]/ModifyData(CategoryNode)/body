{
  ArrayList<IdeaPluginDescriptor> newList=new ArrayList<IdeaPluginDescriptor>();
  constructList(root,newList);
  for (  IdeaPluginDescriptor descr : newList) {
    PluginId descrId=descr.getPluginId();
    IdeaPluginDescriptor existing=PluginManager.getPlugin(descrId);
    if (existing == null) {
      if (UpdateVersions.containsKey(descrId)) {
        String currVersion=(String)UpdateVersions.get(descrId);
        int state=PluginManagerColumnInfo.compareVersion(descr.getVersion(),currVersion);
        if (state > 0) {
          for (int i=0; i < view.size(); i++) {
            IdeaPluginDescriptor obsolete=view.get(i);
            if (obsolete.getPluginId() == descrId)             view.remove(obsolete);
          }
          view.add(descr);
        }
      }
 else {
        view.add(descr);
      }
    }
 else {
      int state=PluginManagerColumnInfo.compareVersion(descr.getVersion(),existing.getVersion());
      if (state > 0) {
        NewVersions2Plugins.put(existing.getPluginId(),Integer.valueOf(1));
      }
      ((IdeaPluginDescriptorImpl)existing).setDownloadsCount(((PluginNode)descr).getDownloads());
    }
  }
  sortByColumn(sortableProvider.getSortColumn());
}
