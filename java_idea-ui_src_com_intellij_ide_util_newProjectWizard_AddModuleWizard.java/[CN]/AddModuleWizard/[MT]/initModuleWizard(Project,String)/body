{
  myWizardContext=new WizardContext(project);
  if (defaultPath != null) {
    myWizardContext.setProjectFileDirectory(defaultPath);
    myWizardContext.setProjectName(defaultPath.substring(FileUtil.toSystemIndependentName(defaultPath).lastIndexOf("/") + 1));
  }
  myWizardContext.addContextListener(new WizardContext.Listener(){
    public void buttonsUpdateRequested(){
      updateButtons();
    }
    public void nextStepRequested(){
      doNextAction();
    }
  }
);
  if (myImportProviders == null) {
    myWizardMode=new CreateFromTemplateMode();
    appendSteps(myWizardMode.getSteps(myWizardContext,myModulesProvider));
  }
 else {
    myWizardMode=new ImportMode(myImportProviders);
    StepSequence sequence=myWizardMode.getSteps(myWizardContext,DefaultModulesProvider.createForProject(project));
    appendSteps(sequence);
    for (    ProjectImportProvider provider : myImportProviders) {
      provider.getBuilder().setFileToImport(defaultPath);
    }
    if (myImportProviders.length == 1) {
      myWizardContext.setProjectBuilder(myImportProviders[0].getBuilder());
    }
  }
  init();
}
