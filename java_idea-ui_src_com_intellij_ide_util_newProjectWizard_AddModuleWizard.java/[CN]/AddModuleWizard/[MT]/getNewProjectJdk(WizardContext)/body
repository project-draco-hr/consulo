{
  if (context.getProjectJdk() != null) {
    return context.getProjectJdk();
  }
  final Project project=context.getProject() == null ? ProjectManager.getInstance().getDefaultProject() : context.getProject();
  final Sdk projectJdk=ProjectRootManager.getInstance(project).getProjectJdk();
  if (projectJdk != null) {
    return projectJdk;
  }
  if (context.getProject() == null) {
    @Nullable final ProjectBuilder projectBuilder=context.getProjectBuilder();
    return ProjectJdkTable.getInstance().findMostRecentSdk(new Condition<Sdk>(){
      public boolean value(      Sdk sdk){
        return projectBuilder == null || projectBuilder.isSuitableSdk(sdk);
      }
    }
);
  }
  return null;
}
