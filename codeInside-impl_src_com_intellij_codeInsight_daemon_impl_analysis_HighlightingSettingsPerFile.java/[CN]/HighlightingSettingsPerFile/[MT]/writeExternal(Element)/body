{
  if (myHighlightSettings.isEmpty())   throw new WriteExternalException();
  for (  Map.Entry<VirtualFile,FileHighlighingSetting[]> entry : myHighlightSettings.entrySet()) {
    final Element child=new Element(SETTING_TAG);
    final VirtualFile vFile=entry.getKey();
    if (!vFile.isValid())     continue;
    child.setAttribute(FILE_ATT,vFile.getUrl());
    for (int i=0; i < entry.getValue().length; i++) {
      final FileHighlighingSetting fileHighlighingSetting=entry.getValue()[i];
      child.setAttribute(ROOT_ATT_PREFIX + i,fileHighlighingSetting.toString());
    }
    element.addContent(child);
  }
  for (  Map.Entry<VirtualFile,Pair<String,Boolean>> entry : myProfileSettings.entrySet()) {
    final Pair<String,Boolean> value=entry.getValue();
    if (value != null) {
      final String name=value.first;
      final Element child=new Element(PROFILES_TAG);
      final VirtualFile vFile=entry.getKey();
      if (vFile == null || !vFile.isValid())       continue;
      child.setAttribute(FILE_ATT,vFile.getUrl());
      child.setAttribute(PROFILE_NAME_ATT,name);
      child.setAttribute(IS_ACTIVE_ATT,value.second.toString());
      element.addContent(child);
    }
  }
}
