{
  int upNodeIndex, downNodeIndex;
  if (element instanceof GraphNode) {
    upNodeIndex=((GraphNode)element).getNodeIndex();
    downNodeIndex=upNodeIndex;
  }
 else {
    GraphEdge edge=(GraphEdge)element;
    upNodeIndex=edge.getUpNodeIndex();
    downNodeIndex=edge.getDownNodeIndex();
  }
  if (downNodeIndex == LinearGraph.NOT_LOAD_COMMIT)   downNodeIndex=upNodeIndex;
  int upLayoutIndex=myPrintedLinearGraph.getLayoutIndex(upNodeIndex);
  int downLayoutIndex=myPrintedLinearGraph.getLayoutIndex(downNodeIndex);
  CommitId headCommitId=myPrintedLinearGraph.getOneOfHeads(upNodeIndex);
  if (upLayoutIndex != downLayoutIndex) {
    return myColorManager.getColorOfFragment(headCommitId,Math.max(upLayoutIndex,downLayoutIndex));
  }
  if (upLayoutIndex == myPrintedLinearGraph.getHeadLayoutIndex(upNodeIndex))   return myColorManager.getColorOfBranch(headCommitId);
 else   return myColorManager.getColorOfFragment(headCommitId,upLayoutIndex);
}
