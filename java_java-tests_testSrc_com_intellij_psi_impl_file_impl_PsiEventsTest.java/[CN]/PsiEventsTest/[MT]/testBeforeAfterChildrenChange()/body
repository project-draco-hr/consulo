{
  listener=new PsiTreeChangeListener(){
    @Override public void beforeChildAddition(    @NotNull PsiTreeChangeEvent event){
      logEvent(event);
    }
    @Override public void beforeChildRemoval(    @NotNull PsiTreeChangeEvent event){
      logEvent(event);
    }
    @Override public void beforeChildReplacement(    @NotNull PsiTreeChangeEvent event){
      logEvent(event);
    }
    @Override public void beforeChildMovement(    @NotNull PsiTreeChangeEvent event){
      logEvent(event);
    }
    @Override public void beforeChildrenChange(    @NotNull PsiTreeChangeEvent event){
      logEvent(event);
    }
    @Override public void beforePropertyChange(    @NotNull PsiTreeChangeEvent event){
      logEvent(event);
    }
    @Override public void childAdded(    @NotNull PsiTreeChangeEvent event){
      logEvent(event);
      assertBeforeEventFired(event);
    }
    @Override public void childRemoved(    @NotNull PsiTreeChangeEvent event){
      logEvent(event);
      assertBeforeEventFired(event);
    }
    @Override public void childReplaced(    @NotNull PsiTreeChangeEvent event){
      logEvent(event);
      assertBeforeEventFired(event);
    }
    @Override public void childrenChanged(    @NotNull PsiTreeChangeEvent event){
      logEvent(event);
      assertBeforeEventFired(event);
    }
    @Override public void childMoved(    @NotNull PsiTreeChangeEvent event){
      logEvent(event);
      assertBeforeEventFired(event);
    }
    @Override public void propertyChanged(    @NotNull PsiTreeChangeEvent event){
      logEvent(event);
      assertBeforeEventFired(event);
    }
  }
;
  myFile=createFile("A.java","class A { int i; }");
  doTestEvents("class A { }");
  doTestEvents("class A { int k; }");
  doTestEvents("class A { int k; int i; }");
  doTestEvents("class A { void foo(){} }");
  doTestEvents("xxxxxx");
  doTestEvents("");
}
