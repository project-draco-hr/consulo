{
  Map<VirtualFile,Set<HgFile>> result=new HashMap<VirtualFile,Set<HgFile>>();
  for (  Change change : changes) {
    ContentRevision afterRevision=change.getAfterRevision();
    ContentRevision beforeRevision=change.getBeforeRevision();
    if (afterRevision != null) {
      addFile(result,afterRevision.getFile());
    }
    if (beforeRevision != null) {
      addFile(result,beforeRevision.getFile());
    }
  }
  return result;
}
