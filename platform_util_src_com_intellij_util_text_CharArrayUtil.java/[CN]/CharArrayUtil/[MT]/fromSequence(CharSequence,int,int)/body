{
  if (seq instanceof CharSequenceBackedByArray) {
    return Arrays.copyOfRange(((CharSequenceBackedByArray)seq).getChars(),start,end);
  }
  if (seq instanceof CharBuffer) {
    CharBuffer buffer=(CharBuffer)seq;
    char[] chars=new char[end - start];
    buffer.position(start);
    buffer.get(chars,0,end - start);
    buffer.position(0);
    return chars;
  }
  if (seq instanceof StringBuffer) {
    char[] chars=new char[end - start];
    ((StringBuffer)seq).getChars(start,end,chars,0);
    return chars;
  }
  String s=seq.toString();
  char[] chars=new char[end - start];
  s.getChars(start,end,chars,0);
  return chars;
}
