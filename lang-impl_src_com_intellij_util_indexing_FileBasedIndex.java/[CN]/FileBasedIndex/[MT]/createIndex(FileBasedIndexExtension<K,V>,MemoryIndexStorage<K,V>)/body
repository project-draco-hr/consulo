{
  if (extension instanceof CustomImplementationFileBasedIndexExtension) {
    return ((CustomImplementationFileBasedIndexExtension<K,V,FileContent>)extension).createIndexImplementation(memStorage);
  }
 else {
    return new MapReduceIndex<K,V,FileContent>(extension.getIndexer(),memStorage);
  }
}
