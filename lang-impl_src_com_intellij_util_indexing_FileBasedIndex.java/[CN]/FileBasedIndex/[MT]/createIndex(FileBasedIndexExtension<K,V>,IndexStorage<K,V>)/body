{
  if (extension instanceof CustomImplementationFileBasedIndexExtension) {
    return ((CustomImplementationFileBasedIndexExtension<K,V,FileContent>)extension).createIndexImplementation(storage);
  }
  return new MapReduceIndex<K,V,FileContent>(extension.getIndexer(),storage);
}
