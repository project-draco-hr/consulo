{
  PsiFile target=null;
  long modStamp=doc.getModificationStamp();
  for (  Project project : ProjectManager.getInstance().getOpenProjects()) {
    final PsiDocumentManager pdm=PsiDocumentManager.getInstance(project);
    final PsiFile file=pdm.getCachedPsiFile(doc);
    if (file != null && file.getModificationStamp() > modStamp) {
      target=file;
      modStamp=file.getModificationStamp();
    }
  }
  return target;
}
