{
  for (int attempt=0; attempt < 2; attempt++) {
    try {
      ensureUpToDate(indexId);
      final UpdatableIndex<K,?,FileContent> index=getIndex(indexId);
      return index != null ? index.getAllKeys() : Collections.<K>emptyList();
    }
 catch (    StorageException e) {
      requestRebuild(indexId);
      LOG.info(e);
    }
catch (    RuntimeException e) {
      final Throwable cause=e.getCause();
      if (cause instanceof StorageException || cause instanceof IOException) {
        requestRebuild(indexId);
        LOG.info(e);
      }
 else {
        throw e;
      }
    }
  }
  return Collections.emptyList();
}
