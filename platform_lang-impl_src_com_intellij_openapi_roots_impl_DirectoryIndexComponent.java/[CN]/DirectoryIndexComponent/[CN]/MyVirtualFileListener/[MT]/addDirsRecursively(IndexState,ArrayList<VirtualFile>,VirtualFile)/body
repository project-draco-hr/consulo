{
  if (!(dir instanceof NewVirtualFile) || !state.myDirToInfoMap.containsKey(getId(dir)))   return;
  list.add(dir);
  for (  VirtualFile child : ((NewVirtualFile)dir).getCachedChildren()) {
    if (child.isDirectory()) {
      addDirsRecursively(state,list,child);
    }
  }
}
