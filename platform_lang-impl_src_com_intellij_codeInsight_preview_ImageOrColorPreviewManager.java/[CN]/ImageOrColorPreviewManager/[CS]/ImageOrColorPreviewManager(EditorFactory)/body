{
  editorFactory.addEditorFactoryListener(new EditorFactoryListener(){
    @Override public void editorCreated(    @NotNull EditorFactoryEvent event){
      registerListeners(event.getEditor());
    }
    @Override public void editorReleased(    @NotNull EditorFactoryEvent event){
      Editor editor=event.getEditor();
      if (editor.isOneLineMode()) {
        return;
      }
      KeyListener keyListener=EDITOR_LISTENER_ADDED.get(editor);
      if (keyListener != null) {
        EDITOR_LISTENER_ADDED.set(editor,null);
        editor.getContentComponent().removeKeyListener(keyListener);
        editor.removeEditorMouseMotionListener(ImageOrColorPreviewManager.this);
      }
    }
  }
,this);
}
