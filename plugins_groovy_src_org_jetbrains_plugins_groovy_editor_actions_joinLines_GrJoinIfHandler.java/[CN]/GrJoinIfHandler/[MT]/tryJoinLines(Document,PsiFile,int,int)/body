{
  if (!(file instanceof GroovyFileBase))   return CANNOT_JOIN;
  final PsiElement element=file.findElementAt(end);
  final GrStatementOwner statementOwner=PsiTreeUtil.getParentOfType(element,GrStatementOwner.class,true,GroovyFileBase.class);
  if (statementOwner == null)   return CANNOT_JOIN;
  if (statementOwner.getStatements().length > 1)   return CANNOT_JOIN;
  final PsiElement parent=statementOwner.getParent();
  if (!(parent instanceof GrBlockStatement))   return CANNOT_JOIN;
  final PsiElement pparent=parent.getParent();
  if (!(pparent instanceof GrIfStatement))   return CANNOT_JOIN;
  final GrIfStatement ifStatement=(GrIfStatement)pparent;
  if (parent == ifStatement.getThenBranch() || parent == ifStatement.getElseBranch()) {
    final GrStatement statement=((GrBlockStatement)(parent)).replaceWithStatement(statementOwner.getStatements()[0]);
    return statement.getTextRange().getStartOffset();
  }
  return CANNOT_JOIN;
}
