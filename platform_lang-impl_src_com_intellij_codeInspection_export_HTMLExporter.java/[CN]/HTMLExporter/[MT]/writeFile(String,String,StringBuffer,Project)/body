{
  ProgressIndicator indicator=ProgressManager.getInstance().getProgressIndicator();
  final String fullPath=folder + File.separator + fileName;
  if (indicator != null) {
    ProgressManager.checkCanceled();
    indicator.setText(InspectionsBundle.message("inspection.export.generating.html.for",fullPath));
  }
  FileWriter writer=null;
  try {
    File folderFile=new File(folder);
    folderFile.mkdirs();
    new File(fullPath).getParentFile().mkdirs();
    writer=new FileWriter(fullPath);
    writer.write(buf.toString().toCharArray());
  }
 catch (  IOException e) {
    Runnable showError=new Runnable(){
      public void run(){
        Messages.showMessageDialog(project,InspectionsBundle.message("inspection.export.error.writing.to",fullPath),InspectionsBundle.message("inspection.export.results.error.title"),Messages.getErrorIcon());
      }
    }
;
    ApplicationManager.getApplication().invokeLater(showError,ModalityState.NON_MODAL);
    throw new ProcessCanceledException();
  }
 finally {
    if (writer != null) {
      try {
        writer.close();
      }
 catch (      IOException e) {
      }
    }
  }
}
