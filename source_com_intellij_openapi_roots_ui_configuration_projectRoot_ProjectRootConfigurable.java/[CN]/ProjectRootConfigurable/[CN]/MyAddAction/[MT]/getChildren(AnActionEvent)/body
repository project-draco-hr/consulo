{
  if (myChildren == null) {
    myChildren=new AnAction[3];
    myChildren[0]=createAddLibrariesGroup();
    myChildren[1]=createAddJdkGroup();
    myChildren[2]=new AnAction(ProjectBundle.message("add.new.module.text")){
      public void actionPerformed(      AnActionEvent e){
        final Module module=myModulesConfigurator.addModule(myTree);
        if (module != null) {
          final MyNode node=new MyNode(new ModuleConfigurable(myModulesConfigurator,module,TREE_UPDATER));
          addNode(node,myModulesNode);
          selectNodeInTree(node);
        }
      }
      public void update(      AnActionEvent e){
        e.getPresentation().setEnabled(!myProject.isDefault());
      }
    }
;
  }
  if (myFromPopup) {
    final Object selectedObject=getSelectedObject();
    if (selectedObject instanceof Library || selectedObject instanceof String) {
      return ((DefaultActionGroup)myChildren[0]).getChildren(e);
    }
 else     if (selectedObject instanceof ProjectJdk || selectedObject instanceof ProjectJdksModel) {
      return ((DefaultActionGroup)myChildren[1]).getChildren(e);
    }
  }
  return myChildren;
}
