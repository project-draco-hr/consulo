{
  if (!hasBlockSelection())   return null;
  int[] starts=getBlockSelectionStarts();
  int[] ends=getBlockSelectionEnds();
  Document doc=myEditor.getDocument();
  for (int i=0; i < starts.length; i++) {
    int start=starts[i];
    int end=ends[i];
    if (start == end) {
      RangeMarker guard=doc.getOffsetGuard(start);
      if (guard != null)       return guard;
    }
    if (start != end) {
      RangeMarker guard=doc.getRangeGuard(start,end);
      if (guard != null)       return guard;
    }
  }
  return null;
}
