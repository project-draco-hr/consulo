{
  LOG.assertTrue(scheme.getName() != null,"New scheme name should not be null");
  int toReplace=-1;
  boolean newSchemeIsShared=isShared(scheme);
  for (int i=0; i < mySchemes.size(); i++) {
    T t=mySchemes.get(i);
    if (scheme.getName().equals(t.getName()) && newSchemeIsShared == isShared(t)) {
      toReplace=i;
      break;
    }
  }
  if (toReplace == -1) {
    mySchemes.add(scheme);
  }
 else {
    if (replaceExisting) {
      mySchemes.set(toReplace,scheme);
    }
 else {
      renameScheme(scheme,generateUniqueName(scheme));
      mySchemes.add(scheme);
    }
  }
  onSchemeAdded(scheme);
}
