{
  if (cutOperationJustHappened)   return false;
  VirtualFile virtualFile=file.getVirtualFile();
  if (virtualFile == null)   return false;
  if (file instanceof PsiCodeFragment)   return true;
  Project project=file.getProject();
  if (!ModuleUtil.projectContainsFile(project,virtualFile,false))   return false;
  FileEditor[] editors=FileEditorManager.getInstance(myProject).getEditors(virtualFile);
  for (  FileEditor editor : editors) {
    if (!editor.isModified())     return false;
  }
  FilePath path=new FilePathImpl(virtualFile);
  boolean vcsIsThinking=!VcsDirtyScopeManager.getInstance(myProject).whatFilesDirty(Arrays.asList(path)).isEmpty();
  if (vcsIsThinking)   return false;
  AbstractVcs activeVcs=ProjectLevelVcsManager.getInstance(project).getVcsFor(virtualFile);
  if (activeVcs == null)   return true;
  FileStatus status=FileStatusManager.getInstance(project).getStatus(virtualFile);
  return status == FileStatus.MODIFIED || status == FileStatus.ADDED;
}
