{
  final GraphicsConfig config=new GraphicsConfig(g);
  final Rectangle rect=getVisibleRect();
  final int firstVisibleRow=getClosestRowForLocation(rect.x,rect.y);
  final int lastVisibleRow=getClosestRowForLocation(rect.x,rect.y + rect.height);
  for (int row=firstVisibleRow; row <= lastVisibleRow; row++) {
    final TreePath path=getPathForRow(row);
    if (path != null) {
      final Rectangle bounds=getRowBounds(row);
      Object component=path.getLastPathComponent();
      final Object[] pathObjects=path.getPath();
      if (component instanceof LoadingNode && pathObjects.length > 1) {
        component=pathObjects[pathObjects.length - 2];
      }
      final Object object=((DefaultMutableTreeNode)component).getUserObject();
      Color color=getFileColorFor(object);
      if (color != null) {
        g.setColor(ColorUtil.softer(color));
        g.fillRect(0,bounds.y,getWidth(),bounds.height);
      }
    }
  }
  config.restore();
}
