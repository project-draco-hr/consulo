{
  if (event == null || event.isConsumed())   return null;
  boolean extendedKeyCodeFirst=!SystemInfo.isWindows && !SystemInfo.isMac && event.getModifiers() == 0;
  KeyStroke stroke=getKeyStroke(event,extendedKeyCodeFirst);
  return stroke != null ? stroke : getKeyStroke(event,!extendedKeyCodeFirst);
}
