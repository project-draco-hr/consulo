{
  myModuleProvider=moduleProvider;
  myRefreshAction=refreshAction;
  mySelectionRunnable=selectionRunnable;
  myLayoutDeviceManager=ProfileList.getInstance(moduleProvider.getProject()).getLayoutDeviceManager();
  myUserDeviceManager=new UserDeviceManager(){
    @Override protected void userDevicesChanged(){
      updatePlatform(getPlatform(getSdk()));
    }
  }
;
  Disposer.register(this,myUserDeviceManager);
  myDeviceAction=new MyComboBoxAction<DeviceWrapper>(){
    @Override protected boolean selectionChanged(    DeviceWrapper item){
      if (item == NO_DEVICES) {
        return false;
      }
      updateDevice(item);
      setSelection(item);
      mySelectionRunnable.run();
      myRefreshAction.run();
      return true;
    }
    @Override protected int getMaxRows(){
      return 20;
    }
  }
;
  myDeviceConfigurationAction=new MyComboBoxAction<State>(){
    @Override protected boolean selectionChanged(    State item){
      updateDeviceConfiguration(item);
      mySelectionRunnable.run();
      setSelection(item);
      myRefreshAction.run();
      return true;
    }
  }
;
  myTargetAction=new MyComboBoxAction<IAndroidTarget>(){
    @Override protected boolean selectionChanged(    IAndroidTarget item){
      updateTarget(item);
      mySelectionRunnable.run();
      setSelection(item);
      updateThemes();
      return true;
    }
  }
;
  myLocaleAction=new MyComboBoxAction<LocaleData>(){
    @Override protected boolean selectionChanged(    LocaleData item){
      updateLocale(item);
      mySelectionRunnable.run();
      setSelection(item);
      myRefreshAction.run();
      return true;
    }
  }
;
  myDockModeAction=new MyComboBoxAction<UiMode>(){
    @Override protected boolean selectionChanged(    UiMode item){
      myProfile.setDockMode(item.getResourceValue());
      mySelectionRunnable.run();
      setSelection(item);
      myRefreshAction.run();
      return true;
    }
  }
;
  myNightModeAction=new MyComboBoxAction<NightMode>(){
    @Override protected boolean selectionChanged(    NightMode item){
      myProfile.setNightMode(item.getResourceValue());
      mySelectionRunnable.run();
      setSelection(item);
      myRefreshAction.run();
      return true;
    }
  }
;
  myThemeAction=new AbstractComboBoxAction<ThemeData>(){
    @Override protected void update(    ThemeData theme,    Presentation presentation,    boolean popup){
      presentation.setEnabled(theme != null && theme != ThemeManager.FRAMEWORK && theme != ThemeManager.PROJECT);
      if (theme != null) {
        if (!popup && !theme.isProjectTheme() && myThemeManager.getAddedThemes().contains(new ThemeData(theme.getName(),true))) {
          presentation.setText(theme.getName() + " (framework)");
        }
 else         if (!popup || theme == ThemeManager.FRAMEWORK || theme == ThemeManager.PROJECT) {
          presentation.setText(theme.getName());
        }
 else {
          presentation.setText("      " + theme.getName());
        }
      }
 else {
        presentation.setText("[None]");
      }
    }
    @Override protected boolean selectionChanged(    ThemeData item){
      updateTheme(item);
      mySelectionRunnable.run();
      setSelection(item);
      myRefreshAction.run();
      return true;
    }
    @Override protected int getMaxRows(){
      return 20;
    }
  }
;
  myThemeAction.showDisabledActions(true);
}
