{
  Module module=e.getData(LangDataKeys.MODULE_CONTEXT);
  if (module == null) {
    module=e.getData(LangDataKeys.MODULE);
  }
  if (module != null && !module.isDisposed()) {
    final VirtualFile moduleFile=module.getModuleFile();
    if (moduleFile != null && moduleFile.isValid()) {
      final VirtualFile moduleDir=moduleFile.getParent();
      if (moduleDir != null && moduleDir.isValid()) {
        return moduleDir;
      }
    }
  }
  return null;
}
