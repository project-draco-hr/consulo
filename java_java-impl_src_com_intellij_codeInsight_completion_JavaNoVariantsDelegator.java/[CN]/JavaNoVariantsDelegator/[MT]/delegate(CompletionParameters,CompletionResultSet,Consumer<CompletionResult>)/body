{
  if (parameters.getCompletionType() == CompletionType.BASIC && parameters.getInvocationCount() <= 1 && JavaCompletionContributor.mayStartClassName(result,false) && JavaCompletionContributor.isClassNamePossible(parameters.getPosition())) {
    final ClassByNameMerger merger=new ClassByNameMerger(parameters.getInvocationCount() == 0,result);
    JavaClassNameCompletionContributor.addAllClasses(parameters,JavaCompletionSorting.addJavaSorting(parameters,result),true,new Consumer<LookupElement>(){
      @Override public void consume(      LookupElement element){
        JavaPsiClassReferenceElement classElement=element.as(JavaPsiClassReferenceElement.CLASS_CONDITION_KEY);
        if (classElement != null) {
          classElement.setAutoCompletionPolicy(AutoCompletionPolicy.NEVER_AUTOCOMPLETE);
        }
        merger.consume(classElement);
      }
    }
);
    merger.finishedClassProcessing();
  }
 else   if (parameters.getCompletionType() == CompletionType.SMART && parameters.getInvocationCount() == 2) {
    result.runRemainingContributors(parameters.withInvocationCount(3),passResult);
  }
}
