{
  String originalText=progress != null ? progress.getText() : null;
  substituteContentLength(progress,originalText,-1);
  if (progress != null) {
    progress.setText2("Downloading " + location);
  }
  URL url=new URL(location);
  try {
    HttpConfigurable.getInstance().prepareURL(location);
  }
 catch (  IOException e) {
    LOG.info("Can not prepareURL '" + location + "'",e);
  }
  URLConnection urlConnection=url.openConnection();
  try {
    int timeout=(int)TimeUnit.MINUTES.toMillis(2);
    urlConnection.setConnectTimeout(timeout);
    urlConnection.setReadTimeout(timeout);
    urlConnection.connect();
    InputStream in=urlConnection.getInputStream();
    int contentLength=urlConnection.getContentLength();
    substituteContentLength(progress,originalText,contentLength);
    NetUtils.copyStreamContent(progress,in,output,contentLength);
  }
 catch (  IOException e) {
    if (urlConnection instanceof HttpURLConnection) {
      HttpURLConnection httpURLConnection=(HttpURLConnection)urlConnection;
      LOG.warn("Can not download '" + location + "', response code: "+ httpURLConnection.getResponseCode()+ ", response message: "+ httpURLConnection.getResponseMessage()+ ", headers: "+ httpURLConnection.getHeaderFields());
    }
    throw e;
  }
}
