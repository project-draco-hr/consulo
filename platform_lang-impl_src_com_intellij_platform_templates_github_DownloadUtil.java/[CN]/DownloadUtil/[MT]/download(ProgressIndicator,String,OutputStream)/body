{
  String originalText=progress != null ? progress.getText() : null;
  substituteContentLength(progress,originalText,-1);
  if (progress != null) {
    progress.setText2("Downloading " + location);
  }
  HttpURLConnection urlConnection=HttpConfigurable.getInstance().openHttpConnection(location);
  try {
    int timeout=(int)TimeUnit.MINUTES.toMillis(2);
    urlConnection.setConnectTimeout(timeout);
    urlConnection.setReadTimeout(timeout);
    urlConnection.connect();
    InputStream in=urlConnection.getInputStream();
    int contentLength=urlConnection.getContentLength();
    substituteContentLength(progress,originalText,contentLength);
    NetUtils.copyStreamContent(progress,in,output,contentLength);
  }
 catch (  IOException e) {
    throw new IOException("Can not download '" + location + "', response code: "+ urlConnection.getResponseCode()+ ", response message: "+ urlConnection.getResponseMessage()+ ", headers: "+ urlConnection.getHeaderFields(),e);
  }
 finally {
    try {
      urlConnection.disconnect();
    }
 catch (    Exception e) {
      LOG.warn("Exception at disconnect()",e);
    }
  }
}
