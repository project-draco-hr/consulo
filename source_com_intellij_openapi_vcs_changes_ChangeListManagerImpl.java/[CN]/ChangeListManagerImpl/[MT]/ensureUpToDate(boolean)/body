{
  final boolean ok=ProgressManager.getInstance().runProcessWithProgressSynchronously(new Runnable(){
    public void run(){
      final ProgressIndicator indicator=ProgressManager.getInstance().getProgressIndicator();
      indicator.setText(VcsBundle.message("commit.wait.util.synced.message"));
synchronized (myPendingUpdatesLock) {
        scheduleUpdate(0);
        while (myUpdateAlarm.getActiveRequestCount() > 0 || myUpdateInProgress) {
          if (indicator.isCanceled())           break;
          try {
            myPendingUpdatesLock.wait(100);
          }
 catch (          InterruptedException e) {
            break;
          }
        }
      }
    }
  }
,VcsBundle.message("commit.wait.util.synced.title"),canBeCanceled,myProject);
  if (ok) {
    refreshView();
  }
  return ok;
}
