{
  final boolean ok=ProgressManager.getInstance().runProcessWithProgressSynchronously(new Runnable(){
    public void run(){
      ProgressManager.getInstance().getProgressIndicator().setText("Please wait until VCS synchronization is finished.");
      scheduleUpdate(0);
      while (myUpdateAlarm.getActiveRequestCount() > 0) {
synchronized (myPendingUpdatesLock) {
          try {
            myPendingUpdatesLock.wait();
          }
 catch (          InterruptedException e) {
            break;
          }
        }
      }
    }
  }
,"Finishing VCS refresh",canBeCanceled,myProject);
  if (ok) {
    refreshView();
  }
  return ok;
}
