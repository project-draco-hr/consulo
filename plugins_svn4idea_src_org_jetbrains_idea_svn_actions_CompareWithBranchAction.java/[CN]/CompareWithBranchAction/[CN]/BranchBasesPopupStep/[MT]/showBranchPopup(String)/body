{
  List<SvnBranchItem> branches;
  try {
    branches=getBranches(selectedValue);
  }
 catch (  SVNException e) {
    Messages.showErrorDialog(myProject,e.getMessage(),SvnBundle.message("compare.with.branch.list.error"));
    return;
  }
  final JList branchList=new JList(branches.toArray());
  branchList.setCellRenderer(new BranchRenderer());
  JBPopupFactory.getInstance().createListPopupBuilder(branchList).setTitle(SVNPathUtil.tail(selectedValue)).setResizable(true).setDimensionServiceKey("Svn.CompareWithBranchPopup").setItemChoosenCallback(new Runnable(){
    public void run(){
      SvnBranchItem item=(SvnBranchItem)branchList.getSelectedValue();
      if (item != null) {
        new CompareWithBranchOperation(myProject,myVirtualFile,myConfiguration).compareWithBranch(item.myUrl,item.getRevision());
      }
    }
  }
).createPopup().showCenteredInCurrentWindow(myProject);
}
