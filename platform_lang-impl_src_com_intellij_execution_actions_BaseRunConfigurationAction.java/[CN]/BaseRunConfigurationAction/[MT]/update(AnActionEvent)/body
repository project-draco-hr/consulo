{
  final ConfigurationContext context=ConfigurationContext.getFromContext(event.getDataContext());
  final Presentation presentation=event.getPresentation();
  final RunnerAndConfigurationSettings existing=context.findExisting();
  RunnerAndConfigurationSettings configuration=existing;
  if (configuration == null) {
    configuration=context.getConfiguration();
  }
  if (configuration == null) {
    presentation.setEnabled(false);
    presentation.setVisible(false);
  }
 else {
    presentation.setEnabled(true);
    presentation.setVisible(true);
    final List<ConfigurationFromContext> fromContext=getConfigurationsFromContext(context);
    if (existing == null && !fromContext.isEmpty()) {
      context.setConfiguration(fromContext.get(0).getConfigurationSettings());
    }
    final String name=suggestRunActionName((LocatableConfiguration)configuration.getConfiguration());
    updatePresentation(presentation,existing != null || fromContext.size() <= 1 ? name : "",context);
  }
}
