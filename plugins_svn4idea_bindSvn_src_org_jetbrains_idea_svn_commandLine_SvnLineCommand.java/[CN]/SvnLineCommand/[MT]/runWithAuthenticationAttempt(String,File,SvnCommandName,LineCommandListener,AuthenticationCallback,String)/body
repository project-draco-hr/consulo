{
  File base=firstFile.isDirectory() ? firstFile : firstFile.getParentFile();
  base=SvnBindUtil.correctUpToExistingParent(base);
  listener.baseDirectory(base);
  File configDir=null;
  while (true) {
    final SvnLineCommand command=runCommand(exePath,commandName,listener,base,configDir,parameters);
    if (command.myErr.length() > 0) {
      final String errText=command.myErr.toString().trim();
      if (authenticationCallback != null) {
        final AuthCallbackCase callback=createCallback(errText,authenticationCallback,base);
        if (callback != null) {
          cleanup(exePath,commandName,base);
          if (callback.getCredentials(errText)) {
            if (authenticationCallback.getSpecialConfigDir() != null) {
              configDir=authenticationCallback.getSpecialConfigDir();
            }
            continue;
          }
        }
      }
      throw new SvnBindException(errText);
    }
    final Integer exitCode=command.myExitCode.get();
    if (exitCode != 0) {
      throw new SvnBindException("Svn process exited with error code: " + exitCode);
    }
    return;
  }
}
