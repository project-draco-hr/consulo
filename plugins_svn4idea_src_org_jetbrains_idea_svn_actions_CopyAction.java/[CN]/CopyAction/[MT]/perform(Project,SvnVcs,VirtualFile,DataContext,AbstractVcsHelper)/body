{
  final File srcFile=new File(file.getPath());
  CopyDialog dialog=new CopyDialog(project,true,srcFile);
  dialog.show();
  if (dialog.isOK()) {
    final String dstURL=dialog.getToURL();
    final SVNRevision revision=dialog.getRevision();
    final String comment=dialog.getComment();
    final SVNException[] exception=new SVNException[1];
    Runnable copyCommand=new Runnable(){
      public void run(){
        try {
          ProgressIndicator progress=ProgressManager.getInstance().getProgressIndicator();
          SVNCopyClient client=activeVcs.createCopyClient();
          if (progress != null) {
            progress.setText("Copy to '" + dstURL + "'");
            client.setEventHandler(new CopyEventHandler(progress));
          }
          System.out.println("copy from revision: " + revision);
          SVNCommitInfo result=client.doCopy(srcFile,SVNRevision.UNDEFINED,revision,dstURL,SVNRevision.HEAD,false,comment);
          if (result != null && result != SVNCommitInfo.NULL) {
            WindowManager.getInstance().getStatusBar(project).setInfo("Comitted revision " + result.getNewRevision() + ".");
          }
        }
 catch (        SVNException e) {
          exception[0]=e;
        }
      }
    }
;
    ApplicationManager.getApplication().runProcessWithProgressSynchronously(copyCommand,"Subversion Copy",false,project);
    if (exception[0] != null) {
      throw new VcsException(exception[0]);
    }
  }
}
