{
  final File srcFile=new File(file.getPath());
  CopyDialog dialog=new CopyDialog(project,true,srcFile);
  dialog.show();
  if (dialog.isOK()) {
    final String dstURL=dialog.getToURL();
    final SVNRevision revision=dialog.getRevision();
    final String comment=dialog.getComment();
    final SVNException[] exception=new SVNException[1];
    Runnable copyCommand=new Runnable(){
      public void run(){
        try {
          ProgressIndicator progress=ProgressManager.getInstance().getProgressIndicator();
          SVNCopyClient client=activeVcs.createCopyClient();
          if (progress != null) {
            progress.setText(SvnBundle.message("progress.text.copy.to",dstURL));
            client.setEventHandler(new CopyEventHandler(progress));
          }
          SVNCommitInfo result=client.doCopy(srcFile,revision,SVNURL.parseURIEncoded(dstURL),comment);
          if (result != null && result != SVNCommitInfo.NULL) {
            WindowManager.getInstance().getStatusBar(project).setInfo(SvnBundle.message("status.text.comitted.revision",result.getNewRevision()));
          }
        }
 catch (        SVNException e) {
          exception[0]=e;
        }
      }
    }
;
    ProgressManager.getInstance().runProcessWithProgressSynchronously(copyCommand,SvnBundle.message("progress.title.copy"),false,project);
    if (exception[0] != null) {
      throw new VcsException(exception[0]);
    }
  }
}
