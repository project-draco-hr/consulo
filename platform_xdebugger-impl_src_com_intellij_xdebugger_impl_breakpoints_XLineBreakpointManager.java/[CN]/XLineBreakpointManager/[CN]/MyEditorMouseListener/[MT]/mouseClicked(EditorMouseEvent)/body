{
  final Editor editor=e.getEditor();
  final MouseEvent mouseEvent=e.getMouseEvent();
  if (mouseEvent.isPopupTrigger() || mouseEvent.getButton() != MouseEvent.BUTTON1 || MarkupEditorFilterFactory.createIsDiffFilter().avaliableIn(editor) || e.getArea() != EditorMouseEventArea.LINE_MARKERS_AREA) {
    return;
  }
  PsiDocumentManager.getInstance(myProject).commitAndRunReadAction(new Runnable(){
    public void run(){
      final int line=editor.xyToLogicalPosition(mouseEvent.getPoint()).line;
      final Document document=editor.getDocument();
      final VirtualFile file=FileDocumentManager.getInstance().getFile(document);
      if (line >= 0 && line < document.getLineCount() && file != null) {
        ApplicationManager.getApplication().invokeLater(new Runnable(){
          public void run(){
            if (!myProject.isDisposed() && myProject.isInitialized() && file.isValid()) {
              XDebuggerUtil.getInstance().toggleLineBreakpoint(myProject,file,line);
            }
          }
        }
);
      }
    }
  }
);
}
