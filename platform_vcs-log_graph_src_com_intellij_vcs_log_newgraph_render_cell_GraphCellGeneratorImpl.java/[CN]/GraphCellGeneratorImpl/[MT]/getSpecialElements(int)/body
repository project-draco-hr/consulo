{
  List<SpecialRowElement> result=new SmartList<SpecialRowElement>();
  int position=0;
  for (  GraphElement element : getSortedVisibleElementsInRow(visibleRowIndex)) {
    if (element instanceof Node) {
      result.add(new SpecialRowElement(element,position,SpecialRowElement.Type.NODE));
    }
    if (element instanceof Edge) {
      Edge edge=(Edge)element;
      int edgeSize=edge.getDownNodeVisibleIndex() - edge.getUpNodeVisibleIndex();
      int upOffset=visibleRowIndex - edge.getUpNodeVisibleIndex();
      int downOffset=edge.getDownNodeVisibleIndex() - visibleRowIndex;
      if (edgeSize >= LONG_EDGE_SIZE) {
        if (!showLongEdges) {
          addArrowIfNeeded(result,position,edge,upOffset,downOffset,LONG_EDGE_PART_SIZE);
        }
 else {
          if (SHOW_ARROW_WHEN_SHOW_LONG_EDGES)           addArrowIfNeeded(result,position,edge,upOffset,downOffset,LONG_EDGE_PART_SIZE);
          if (edgeSize >= VERY_LONG_EDGE_SIZE)           addArrowIfNeeded(result,position,edge,upOffset,downOffset,VERY_LONG_EDGE_PART_SIZE);
        }
      }
    }
    position++;
  }
  return result;
}
