{
  if (!context.getDebugProcess().isAttached()) {
    throw EvaluateExceptionUtil.createEvaluateException(DebuggerBundle.message("error.vm.disconnected"));
  }
  try {
    if (context.getFrameProxy() == null) {
      throw EvaluateExceptionUtil.NULL_STACK_FRAME;
    }
    Object value=myEvaluator.evaluate((EvaluationContextImpl)context);
    if (value != null && !(value instanceof Value)) {
      throw EvaluateExceptionUtil.createEvaluateException(DebuggerBundle.message("evaluation.error.invalid.expression",""));
    }
    myValue=(Value)value;
    return myValue;
  }
 catch (  Throwable e) {
    if (LOG.isDebugEnabled()) {
      LOG.debug(e);
    }
    if (e instanceof EvaluateException)     throw ((EvaluateException)e);
 else     throw EvaluateExceptionUtil.createEvaluateException(e);
  }
}
