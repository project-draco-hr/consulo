{
  Task.Backgroundable task=new Task.Backgroundable(myProject,"Directory comparison",true){
    @Override public void run(    @NotNull ProgressIndicator indicator){
      indicator.setText("Calculating differences");
      final DirDiffTableModel model=new DirDiffTableModel(myProject,dir1,dir2,indicator);
      final Runnable run=new Runnable(){
        public void run(){
          if (model.getRowCount() == 0) {
            Messages.showInfoMessage(myProject,"No difference has been found","Directory Diff Tool");
          }
 else {
            new DirDiffDialog(myProject,model).show();
          }
        }
      }
;
      ApplicationManager.getApplication().invokeLater(run);
    }
  }
;
  ProgressManager.getInstance().run(task);
}
