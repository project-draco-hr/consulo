{
  final DirDiffTableModel model=new DirDiffTableModel(myProject,dir1,dir2,settings);
  if (settings.showInFrame) {
    DirDiffFrame frame=new DirDiffFrame(myProject,model);
    if (onWindowClose != null) {
      final JFrame jFrame=frame.getFrame();
      jFrame.addWindowListener(new WindowAdapter(){
        @Override public void windowClosed(        WindowEvent e){
          onWindowClose.run();
          jFrame.removeWindowListener(this);
        }
      }
);
    }
    frame.show();
  }
 else {
    DirDiffDialog dirDiffDialog=new DirDiffDialog(myProject,model);
    if (myProject == null || myProject.isDefault()) {
      dirDiffDialog.setModal(true);
    }
    if (onWindowClose != null) {
      final Window owner=dirDiffDialog.getOwner();
      owner.addWindowListener(new WindowAdapter(){
        @Override public void windowClosed(        WindowEvent e){
          onWindowClose.run();
          owner.removeWindowListener(this);
        }
      }
);
    }
    dirDiffDialog.show();
  }
}
