{
  ApplicationManager.getApplication().invokeLater(new Runnable(){
    public void run(){
      if (beforeAddition()) {
        final T newElement=new WriteCommandAction<T>(getProject()){
          protected void run(          Result<T> result) throws Throwable {
            result.setResult(doAdd());
          }
        }
.execute().getResultObject();
        if (newElement != null) {
          reset();
          afterAddition(myCollectionPanel.getTable(),myData.size() - 1);
        }
      }
    }
  }
);
}
