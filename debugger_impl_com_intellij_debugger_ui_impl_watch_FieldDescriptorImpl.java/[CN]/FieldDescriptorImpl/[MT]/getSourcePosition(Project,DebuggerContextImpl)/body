{
  if (context.getFrameProxy() == null)   return null;
  final ReferenceType type=myField.declaringType();
  final PsiManager psiManager=PsiManager.getInstance(project);
  final String fieldName=myField.name();
  if (fieldName.startsWith("val$")) {
    String varName=fieldName.substring(fieldName.lastIndexOf('$') + 1);
    PsiElement element=PositionUtil.getContextElement(context);
    if (element == null) {
      return null;
    }
    PsiClass aClass=PsiTreeUtil.getParentOfType(element,PsiClass.class,false);
    if (aClass == null) {
      return null;
    }
    aClass=(PsiClass)aClass.getNavigationElement();
    PsiVariable psiVariable=psiManager.getResolveHelper().resolveReferencedVariable(varName,aClass);
    if (psiVariable == null) {
      return null;
    }
    return SourcePosition.createFromOffset(psiVariable.getContainingFile(),psiVariable.getTextOffset());
  }
 else {
    PsiClass aClass=psiManager.findClass(type.name().replace('$','.'),GlobalSearchScope.allScope(myProject));
    if (aClass == null)     return null;
    aClass=(PsiClass)aClass.getNavigationElement();
    PsiField[] fields=aClass.getFields();
    for (    PsiField field : fields) {
      if (fieldName.equals(field.getName())) {
        return SourcePosition.createFromOffset(field.getContainingFile(),field.getTextOffset());
      }
    }
    return null;
  }
}
