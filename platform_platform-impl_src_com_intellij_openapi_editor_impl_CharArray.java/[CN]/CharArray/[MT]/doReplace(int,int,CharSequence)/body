{
  prepareForModification();
  if (isDeferredChangeMode()) {
    storeChange(new TextChangeImpl(newString,startOffset,endOffset));
    if (myDebugDeferredProcessing) {
      myDebugArray.doReplace(startOffset,endOffset,newString);
    }
    return;
  }
  int newLength=newString.length();
  int oldLength=endOffset - startOffset;
  CharArrayUtil.getChars(newString,myArray,startOffset,Math.min(newLength,oldLength));
  if (newLength > oldLength) {
    doInsert(newString.subSequence(oldLength,newLength),endOffset);
  }
 else   if (newLength < oldLength) {
    doRemove(startOffset + newLength,startOffset + oldLength);
  }
}
