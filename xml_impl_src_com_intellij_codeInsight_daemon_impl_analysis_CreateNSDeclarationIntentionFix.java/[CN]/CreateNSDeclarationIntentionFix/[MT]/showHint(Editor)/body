{
  if (myToken == null)   return false;
  XmlToken token=(XmlToken)myToken.retrieve();
  if (token == null)   return false;
  if (!XmlSettings.getInstance().SHOW_XML_ADD_IMPORT_HINTS || myNamespacePrefix.length() == 0) {
    return false;
  }
  PsiElement element=ObjectUtils.assertNotNull(myElement.retrieve());
  final Set<String> namespaces=getXmlExtension().guessUnboundNamespaces(element,getFile());
  if (!namespaces.isEmpty()) {
    final String message=ShowAutoImportPass.getMessage(namespaces.size() > 1,namespaces.iterator().next());
    final String title=getTitle();
    final ImportNSAction action=new ImportNSAction(namespaces,getFile(),element,editor,title);
    if (element instanceof XmlTag) {
      if (VisibleHighlightingPassFactory.calculateVisibleRange(editor).contains(token.getTextRange())) {
        HintManager.getInstance().showQuestionHint(editor,message,token.getTextOffset(),token.getTextOffset() + myNamespacePrefix.length(),action);
        return true;
      }
    }
 else {
      HintManager.getInstance().showQuestionHint(editor,message,element.getTextOffset(),element.getTextRange().getEndOffset(),action);
      return true;
    }
  }
  return false;
}
