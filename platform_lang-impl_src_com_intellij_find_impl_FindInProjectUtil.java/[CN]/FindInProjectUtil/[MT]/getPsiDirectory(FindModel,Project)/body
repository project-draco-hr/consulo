{
  String directoryName=findModel.getDirectoryName();
  if (findModel.isProjectScope() || directoryName == null) {
    return null;
  }
  final PsiManager psiManager=PsiManager.getInstance(project);
  String path=directoryName.replace(File.separatorChar,'/');
  VirtualFile virtualFile=LocalFileSystem.getInstance().findFileByPath(path);
  if (virtualFile == null || !virtualFile.isDirectory()) {
    virtualFile=null;
    for (    LocalFileProvider provider : ((VirtualFileManagerEx)VirtualFileManager.getInstance()).getLocalFileProviders()) {
      VirtualFile file=provider.findLocalVirtualFileByPath(path);
      if (file != null && file.isDirectory()) {
        if (file.getChildren().length > 0) {
          virtualFile=file;
          break;
        }
        if (virtualFile == null) {
          virtualFile=file;
        }
      }
    }
  }
  return virtualFile == null ? null : psiManager.findDirectory(virtualFile);
}
