{
  if (project == null) {
    return fileType;
  }
  if (fileType instanceof LanguageFileType) {
    final Language language=((LanguageFileType)fileType).getLanguage();
    final Language substitutedLanguage=LanguageSubstitutors.INSTANCE.substituteLanguage(language,file,project);
    LanguageFileType substFileType=substitutedLanguage.getAssociatedFileType();
    if (!substitutedLanguage.equals(language) && substFileType != null) {
      return new SubstitutedFileType(fileType,substFileType);
    }
  }
  return fileType;
}
