{
  double result=-1;
  mxPoint[] pointsCurve=getCurvePoints(index);
  double[] curveIntervals=getIntervals(index);
  if (pointsCurve != null && pointsCurve.length > 1) {
    int segIndex=intersectRectPerimeterSeg(index,rect);
    mxPoint intersectPoint=null;
    if (segIndex != -1) {
      intersectPoint=intersectRectPerimeterPoint(index,rect,segIndex);
    }
    if (intersectPoint != null) {
      double startSegX=pointsCurve[segIndex - 1].getX();
      double startSegY=pointsCurve[segIndex - 1].getY();
      double distToStartSeg=curveIntervals[segIndex - 1] * getCurveLength(index);
      double intersectOffsetX=intersectPoint.getX() - startSegX;
      double intersectOffsetY=intersectPoint.getY() - startSegY;
      double lenToIntersect=Math.sqrt(intersectOffsetX * intersectOffsetX + intersectOffsetY * intersectOffsetY);
      result=distToStartSeg + lenToIntersect;
    }
  }
  return result;
}
