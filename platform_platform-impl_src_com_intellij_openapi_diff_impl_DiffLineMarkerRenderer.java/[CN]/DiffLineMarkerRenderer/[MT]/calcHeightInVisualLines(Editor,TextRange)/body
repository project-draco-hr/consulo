{
  int startY=editor.offsetToVisualPosition(range.getStartOffset()).getLine();
  int endY=editor.offsetToVisualPosition(range.getEndOffset()).getLine();
  if (startY > endY) {
    return 0;
  }
  return endY - startY + 1;
}
