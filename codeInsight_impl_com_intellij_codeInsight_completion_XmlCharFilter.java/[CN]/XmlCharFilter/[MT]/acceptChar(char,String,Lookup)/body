{
  if (!isInXmlContext(lookup))   return null;
  if (Character.isJavaIdentifierPart(c))   return Result.ADD_TO_PREFIX;
switch (c) {
case ':':
case '.':
case '-':
    return Result.ADD_TO_PREFIX;
case ',':
case ';':
case '=':
case '(':
case '/':
  if (isWithinTag(lookup)) {
    if (StringUtil.isNotEmpty(prefix)) {
      return Result.SELECT_ITEM_AND_FINISH_LOOKUP;
    }
    XmlAutoPopupHandler.autoPopupXmlLookup(lookup.getEditor().getProject(),lookup.getEditor());
    return Result.HIDE_LOOKUP;
  }
return Result.ADD_TO_PREFIX;
case '>':
if (StringUtil.isNotEmpty(prefix)) {
return Result.SELECT_ITEM_AND_FINISH_LOOKUP;
}
default :
return Result.HIDE_LOOKUP;
case ' ':
return Result.SELECT_ITEM_AND_FINISH_LOOKUP;
}
}
