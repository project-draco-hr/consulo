{
  int result=0;
  int rowCount=jTable.getRowCount();
  for (int i=0; i < rowCount; i++) {
    TableCellRenderer tcr=jTable.getCellRenderer(i,columnIndex);
    Component comp=tcr.getTableCellRendererComponent(jTable,jTable.getValueAt(i,columnIndex),true,true,i,columnIndex);
    int compWidth=comp.getPreferredSize().width;
    if (compWidth > result) {
      result=compWidth;
    }
  }
  TableCellRenderer tcr=jTable.getColumnModel().getColumn(columnIndex).getHeaderRenderer();
  if (tcr == null) {
    tcr=jTable.getDefaultRenderer(String.class);
  }
  Component comp=tcr.getTableCellRendererComponent(jTable,model.getColumnName(columnIndex),true,true,-1,columnIndex);
  int compWidth=comp.getPreferredSize().width;
  if (compWidth > result) {
    result=compWidth;
  }
  if (columnIndex == DESCRIPTION_COLUMN) {
    if (result < 400)     result=400;
  }
  return result;
}
