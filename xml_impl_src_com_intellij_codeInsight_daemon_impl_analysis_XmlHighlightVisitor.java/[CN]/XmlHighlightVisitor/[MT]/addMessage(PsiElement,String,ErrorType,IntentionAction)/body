{
  if (message != null && !message.isEmpty()) {
    final PsiFile containingFile=context.getContainingFile();
    final HighlightInfoType defaultInfoType=type == ErrorType.ERROR ? HighlightInfoType.ERROR : type == ErrorType.WARNING ? HighlightInfoType.WARNING : HighlightInfoType.WEAK_WARNING;
    if (context instanceof XmlTag && XmlExtension.getExtension(containingFile).shouldBeHighlightedAsTag((XmlTag)context)) {
      addElementsForTagWithManyQuickFixes((XmlTag)context,message,defaultInfoType,fixes);
    }
 else {
      final PsiElement contextOfFile=InjectedLanguageManager.getInstance(containingFile.getProject()).getInjectionHost(containingFile);
      final HighlightInfo highlightInfo;
      if (contextOfFile != null) {
        TextRange range=InjectedLanguageManager.getInstance(context.getProject()).injectedToHost(context,context.getTextRange());
        highlightInfo=HighlightInfo.newHighlightInfo(defaultInfoType).range(range).descriptionAndTooltip(message).create();
      }
 else {
        highlightInfo=HighlightInfo.newHighlightInfo(HighlightInfoType.WRONG_REF).range(context).descriptionAndTooltip(message).create();
      }
      if (fixes != null) {
        for (        final IntentionAction quickFixAction : fixes) {
          if (quickFixAction == null)           continue;
          QuickFixAction.registerQuickFixAction(highlightInfo,quickFixAction);
        }
      }
      addToResults(highlightInfo);
    }
  }
}
