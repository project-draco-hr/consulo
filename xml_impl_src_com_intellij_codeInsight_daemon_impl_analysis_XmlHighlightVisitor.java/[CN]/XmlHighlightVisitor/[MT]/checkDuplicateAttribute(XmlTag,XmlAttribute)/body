{
  if (skipValidation(tag)) {
    return;
  }
  final XmlAttribute[] attributes=tag.getAttributes();
  final PsiFile containingFile=tag.getContainingFile();
  final XmlExtension extension=containingFile instanceof XmlFile ? XmlExtension.getExtension(containingFile) : XmlExtension.DEFAULT_EXTENSION;
  for (  XmlAttribute tagAttribute : attributes) {
    ProgressManager.checkCanceled();
    if (attribute != tagAttribute && Comparing.strEqual(attribute.getName(),tagAttribute.getName())) {
      final String localName=attribute.getLocalName();
      if (extension.canBeDuplicated(tagAttribute))       continue;
      HighlightInfo highlightInfo=HighlightInfo.newHighlightInfo(getTagProblemInfoType(tag)).range(XmlChildRole.ATTRIBUTE_NAME_FINDER.findChild(SourceTreeToPsiMap.psiElementToTree(attribute))).descriptionAndTooltip(XmlErrorMessages.message("duplicate.attribute",localName)).create();
      addToResults(highlightInfo);
      IntentionAction intentionAction=new RemoveAttributeIntentionFix(localName,attribute);
      QuickFixAction.registerQuickFixAction(highlightInfo,intentionAction);
    }
  }
}
