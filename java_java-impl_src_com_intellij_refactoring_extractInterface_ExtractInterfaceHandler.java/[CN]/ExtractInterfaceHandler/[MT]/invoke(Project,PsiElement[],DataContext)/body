{
  if (elements.length != 1)   return;
  myProject=project;
  myClass=(PsiClass)elements[0];
  if (!CommonRefactoringUtil.checkReadOnlyStatus(project,myClass))   return;
  final ExtractInterfaceDialog dialog=new ExtractInterfaceDialog(myProject,myClass);
  dialog.show();
  if (!dialog.isOK() || !dialog.isExtractSuperclass())   return;
  CommandProcessor.getInstance().executeCommand(myProject,new Runnable(){
    public void run(){
      ApplicationManager.getApplication().runWriteAction(new Runnable(){
        public void run(){
          myInterfaceName=dialog.getExtractedSuperName();
          mySelectedMembers=dialog.getSelectedMembers();
          myTargetDir=dialog.getTargetDirectory();
          myJavaDocPolicy=new JavaDocPolicy(dialog.getJavaDocPolicy());
          try {
            doRefactoring();
          }
 catch (          IncorrectOperationException e) {
            LOG.error(e);
          }
        }
      }
);
    }
  }
,REFACTORING_NAME,null);
}
