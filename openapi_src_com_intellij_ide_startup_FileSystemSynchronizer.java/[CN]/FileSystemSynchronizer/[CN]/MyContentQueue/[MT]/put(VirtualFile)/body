{
  FileContent content;
synchronized (this) {
    content=new FileContent(file);
    if (file.isValid()) {
      try {
        if (content.getPhysicalLength() < SIZE_THRESHOLD) {
          while (totalSize > SIZE_THRESHOLD) {
            wait();
          }
          totalSize+=content.getPhysicalBytes().length;
        }
      }
 catch (      IOException e) {
        content.setEmptyContent();
      }
catch (      Throwable e) {
        LOG.error(e);
      }
    }
 else {
      content.setEmptyContent();
    }
  }
  put(content);
}
