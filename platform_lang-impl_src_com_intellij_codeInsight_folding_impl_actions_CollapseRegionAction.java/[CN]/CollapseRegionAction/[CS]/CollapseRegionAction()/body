{
  super(new EditorActionHandler(){
    @Override public void execute(    final Editor editor,    DataContext dataContext){
      CodeFoldingManager foldingManager=CodeFoldingManager.getInstance(editor.getProject());
      foldingManager.updateFoldRegions(editor);
      final int line=editor.getCaretModel().getLogicalPosition().line;
      Runnable processor=new Runnable(){
        public void run(){
          FoldRegion region=FoldingUtil.findFoldRegionStartingAtLine(editor,line);
          if (region != null && region.isExpanded()) {
            region.setExpanded(false);
          }
 else {
            int offset=editor.getCaretModel().getOffset();
            FoldRegion[] regions=FoldingUtil.getFoldRegionsAtOffset(editor,offset);
            for (            FoldRegion region1 : regions) {
              if (region1.isExpanded()) {
                region1.setExpanded(false);
                break;
              }
            }
          }
        }
      }
;
      editor.getFoldingModel().runBatchFoldingOperation(processor);
    }
    @Override public boolean isEnabled(    Editor editor,    DataContext dataContext){
      return super.isEnabled(editor,dataContext) && editor.getProject() != null;
    }
  }
);
}
