{
  if (!(parameters.getOriginalFile() instanceof PsiJavaFile))   return null;
  final String ad=advertise(parameters);
  final String suffix=ad == null ? "" : "; " + StringUtil.decapitalize(ad);
  if (parameters.getCompletionType() == CompletionType.SMART) {
    if (!ApplicationManager.getApplication().isUnitTestMode()) {
      final Project project=parameters.getPosition().getProject();
      final PsiFile file=parameters.getOriginalFile();
      PsiExpression expression=PsiTreeUtil.getContextOfType(parameters.getPosition(),PsiExpression.class,true);
      if (expression != null && expression.getParent() instanceof PsiExpressionList) {
        int lbraceOffset=expression.getParent().getTextRange().getStartOffset();
        new ShowParameterInfoHandler().invoke(project,editor,file,lbraceOffset,null);
      }
      if (expression instanceof PsiLiteralExpression) {
        return LangBundle.message("completion.no.suggestions") + suffix;
      }
      if (expression instanceof PsiInstanceOfExpression) {
        final PsiInstanceOfExpression instanceOfExpression=(PsiInstanceOfExpression)expression;
        if (PsiTreeUtil.isAncestor(instanceOfExpression.getCheckType(),parameters.getPosition(),false)) {
          return LangBundle.message("completion.no.suggestions") + suffix;
        }
      }
    }
    final Set<PsiType> expectedTypes=JavaCompletionUtil.getExpectedTypes(parameters);
    if (expectedTypes != null) {
      PsiType type=expectedTypes.size() == 1 ? expectedTypes.iterator().next() : null;
      if (type != null) {
        final PsiType deepComponentType=type.getDeepComponentType();
        if (deepComponentType instanceof PsiClassType) {
          if (((PsiClassType)deepComponentType).resolve() != null) {
            return CompletionBundle.message("completion.no.suggestions.of.type",type.getPresentableText()) + suffix;
          }
          return CompletionBundle.message("completion.unknown.type",type.getPresentableText()) + suffix;
        }
        if (!PsiType.NULL.equals(type)) {
          return CompletionBundle.message("completion.no.suggestions.of.type",type.getPresentableText()) + suffix;
        }
      }
    }
  }
  return LangBundle.message("completion.no.suggestions") + suffix;
}
