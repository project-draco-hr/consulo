{
  final PsiFile file=context.getFile();
  final Project project=context.getProject();
  JavaCompletionUtil.initOffsets(file,project,context.getOffsetMap());
  if (context.getCompletionType() == CompletionType.BASIC && file instanceof PsiJavaFile) {
    final PsiElement element=file.findElementAt(context.getStartOffset());
    if (METHOD_START.accepts(element)) {
      PsiElement decl=PsiTreeUtil.getParentOfType(element,PsiMethod.class);
      if (decl == null)       decl=PsiTreeUtil.getParentOfType(element,PsiVariable.class);
      if (decl != null) {
        final int textOffset=decl.getTextOffset();
        context.setFileCopyPatcher(new FileCopyPatcher(){
          public void patchFileCopy(          @NotNull final PsiFile fileCopy,          @NotNull final Document document,          @NotNull final OffsetMap map){
            document.replaceString(map.getOffset(CompletionInitializationContext.START_OFFSET),Math.max(map.getOffset(CompletionInitializationContext.SELECTION_END_OFFSET),textOffset),CompletionInitializationContext.DUMMY_IDENTIFIER.trim());
          }
        }
);
        return;
      }
    }
    context.setFileCopyPatcher(new DummyIdentifierPatcher(CompletionInitializationContext.DUMMY_IDENTIFIER.trim()));
  }
}
