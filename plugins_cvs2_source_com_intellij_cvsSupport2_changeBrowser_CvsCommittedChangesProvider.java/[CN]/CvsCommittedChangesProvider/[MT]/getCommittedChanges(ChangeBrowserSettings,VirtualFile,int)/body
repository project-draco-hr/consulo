{
  if (myEnvironment != null && myModuleName != null) {
    return loadCommittedChanges(settings,myModuleName,myEnvironment);
  }
  final VirtualFile rootDir=root.isDirectory() ? root : root.getParent();
  final String module=CvsUtil.getModuleName(root);
  final CvsEnvironment connectionSettings=CvsEntriesManager.getInstance().getCvsConnectionSettingsFor(rootDir);
  if (module != null) {
    return loadCommittedChanges(settings,module,connectionSettings);
  }
 else {
    throw new VcsException(CvsBundle.message("cannot.find.repository.location.error.message",root.getPath()));
  }
}
