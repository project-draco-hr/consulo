{
  if (!CvsUtil.fileIsUnderCvs(new File(root.getPresentableUrl()))) {
    return null;
  }
  final VirtualFile rootDir=root.isDirectory() ? root : root.getParent();
  final String module=CvsUtil.getModuleName(root);
  final CvsEnvironment connectionSettings=CvsEntriesManager.getInstance().getCvsConnectionSettingsFor(rootDir);
  return new CvsRepositoryLocation(rootDir,connectionSettings,module);
}
