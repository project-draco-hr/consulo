{
  ids.add(pluginId);
  if (toEnable) {
    for (    String id : getNonOptionalDependencies(pluginId)) {
      collectInvolvedIds(id,true,ids);
    }
  }
 else {
    Condition<PluginId> condition=new Condition<PluginId>(){
      @Override public boolean value(      PluginId id){
        return pluginId.equals(id.getIdString());
      }
    }
;
    for (    final IdeaPluginDescriptor plugin : myAllPlugins) {
      if (null != ContainerUtil.find(plugin.getDependentPluginIds(),condition) && null == ContainerUtil.find(plugin.getOptionalDependentPluginIds(),condition)) {
        collectInvolvedIds(plugin.getPluginId().getIdString(),false,ids);
      }
    }
  }
}
