{
  if (file.isDirectory() && (myChooseFolders || isFileSelectable(file))) {
    return file;
  }
  boolean isJar=file.getFileType() instanceof ArchiveFileType;
  if (!isJar) {
    return acceptAsGeneralFile(file) ? file : null;
  }
  if (myChooseJarsAsFiles) {
    return file;
  }
  if (!acceptAsJarFile(file)) {
    return null;
  }
  String path=file.getPath();
  return ((ArchiveFileSystem)file.getFileSystem()).findLocalVirtualFileByPath(path);
}
