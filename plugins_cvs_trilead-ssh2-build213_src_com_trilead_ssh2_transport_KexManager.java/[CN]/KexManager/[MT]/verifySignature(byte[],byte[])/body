{
  if (kxs.np.server_host_key_algo.equals("ssh-rsa")) {
    RSASignature rs=RSASHA1Verify.decodeSSHRSASignature(sig);
    RSAPublicKey rpk=RSASHA1Verify.decodeSSHRSAPublicKey(hostkey);
    log.log(50,"Verifying ssh-rsa signature");
    return RSASHA1Verify.verifySignature(kxs.H,rs,rpk);
  }
  if (kxs.np.server_host_key_algo.equals("ssh-dss")) {
    DSASignature ds=DSASHA1Verify.decodeSSHDSASignature(sig);
    DSAPublicKey dpk=DSASHA1Verify.decodeSSHDSAPublicKey(hostkey);
    log.log(50,"Verifying ssh-dss signature");
    return DSASHA1Verify.verifySignature(kxs.H,ds,dpk);
  }
  throw new IOException("Unknown server host key algorithm '" + kxs.np.server_host_key_algo + "'");
}
