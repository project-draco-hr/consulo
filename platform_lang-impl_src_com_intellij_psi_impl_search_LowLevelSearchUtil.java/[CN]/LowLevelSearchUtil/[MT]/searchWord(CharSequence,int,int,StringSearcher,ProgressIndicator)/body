{
  LOG.assertTrue(endOffset <= text.length());
  for (int index=startOffset; index < endOffset; index++) {
    if (progress != null)     progress.checkCanceled();
    index=searcher.scan(text,index,endOffset);
    if (index < 0)     return -1;
    if (!searcher.isJavaIdentifier()) {
      return index;
    }
    if (index > startOffset) {
      char c=text.charAt(index - 1);
      if (Character.isJavaIdentifierPart(c) && c != '$') {
        if (index < 2 || text.charAt(index - 2) != '\\') {
          continue;
        }
      }
    }
    String pattern=searcher.getPattern();
    if (index + pattern.length() < endOffset) {
      char c=text.charAt(index + pattern.length());
      if (Character.isJavaIdentifierPart(c) && c != '$') {
        continue;
      }
    }
    return index;
  }
  return -1;
}
