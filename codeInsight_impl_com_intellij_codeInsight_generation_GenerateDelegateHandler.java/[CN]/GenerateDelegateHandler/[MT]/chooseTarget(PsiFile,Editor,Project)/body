{
  PsiElement target=null;
  final PsiElementClassMember[] targetElements=getTargetElements(file,editor);
  if (targetElements == null || targetElements.length == 0)   return null;
  if (!ApplicationManager.getApplication().isUnitTestMode()) {
    MemberChooser<PsiElementClassMember> chooser=new MemberChooser<PsiElementClassMember>(targetElements,false,false,project);
    chooser.setTitle(CodeInsightBundle.message("generate.delegate.target.chooser.title"));
    chooser.setCopyJavadocVisible(false);
    chooser.show();
    if (chooser.getExitCode() != MemberChooser.OK_EXIT_CODE)     return null;
    final List<PsiElementClassMember> selectedElements=chooser.getSelectedElements();
    if (selectedElements != null && selectedElements.size() > 0)     target=selectedElements.get(0).getElement();
  }
 else {
    target=targetElements[0].getElement();
  }
  return target;
}
