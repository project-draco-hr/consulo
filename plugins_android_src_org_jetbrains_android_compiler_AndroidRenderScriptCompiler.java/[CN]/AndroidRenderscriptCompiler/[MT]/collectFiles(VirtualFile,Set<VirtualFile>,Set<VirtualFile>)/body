{
  if (!visited.add(root)) {
    return;
  }
  if (root.isDirectory()) {
    for (    VirtualFile child : root.getChildren()) {
      collectFiles(child,visited,result);
    }
  }
 else {
    result.add(root);
  }
}
