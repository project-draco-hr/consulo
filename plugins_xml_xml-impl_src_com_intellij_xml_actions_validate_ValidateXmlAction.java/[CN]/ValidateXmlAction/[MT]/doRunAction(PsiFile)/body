{
  CommandProcessor.getInstance().executeCommand(psiFile.getProject(),new Runnable(){
    public void run(){
      final Runnable action=new Runnable(){
        public void run(){
          try {
            psiFile.putUserData(runningValidationKey,"");
            PsiDocumentManager.getInstance(psiFile.getProject()).commitAllDocuments();
            getHandler(psiFile).doValidate((XmlFile)psiFile);
          }
  finally {
            psiFile.putUserData(runningValidationKey,null);
          }
        }
      }
;
      ApplicationManager.getApplication().runWriteAction(action);
    }
  }
,getCommandName(),null);
}
