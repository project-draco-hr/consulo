{
  if (!editor.getSelectionModel().hasSelection())   return false;
  final TemplateImpl template=getTemplate();
  if (template != null) {
    int offset=editor.getCaretModel().getOffset();
    int startOffset=offset;
    if (editor.getSelectionModel().hasSelection()) {
      final int selStart=editor.getSelectionModel().getSelectionStart();
      final int selEnd=editor.getSelectionModel().getSelectionEnd();
      startOffset=(offset == selStart) ? selEnd : selStart;
    }
    if (!template.isDeactivated() && (TemplateManagerImpl.isApplicable(file,offset,template) || (TemplateManagerImpl.isApplicable(file,startOffset,template)))) {
      return true;
    }
  }
  return false;
}
