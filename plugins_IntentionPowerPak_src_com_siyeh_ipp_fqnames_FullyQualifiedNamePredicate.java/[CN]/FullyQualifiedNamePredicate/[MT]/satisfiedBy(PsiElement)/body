{
  if (!(element instanceof PsiJavaCodeReferenceElement) || !((PsiJavaCodeReferenceElement)element).isQualified()) {
    return false;
  }
  if (PsiTreeUtil.getParentOfType(element,PsiImportStatementBase.class,PsiPackageStatement.class) != null) {
    return false;
  }
  final PsiElement qualifier=((PsiJavaCodeReferenceElement)element).getQualifier();
  if (qualifier instanceof PsiJavaCodeReferenceElement) {
    final PsiElement resolved=((PsiJavaCodeReferenceElement)qualifier).resolve();
    if (resolved instanceof PsiPackage)     return true;
    if (resolved instanceof PsiClass) {
      return CodeStyleSettingsManager.getSettings(element.getProject()).INSERT_INNER_CLASS_IMPORTS;
    }
  }
  return false;
}
