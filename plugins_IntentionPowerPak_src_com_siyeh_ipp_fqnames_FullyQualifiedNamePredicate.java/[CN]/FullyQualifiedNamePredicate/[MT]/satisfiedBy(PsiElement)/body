{
  if (!(element instanceof PsiJavaCodeReferenceElement)) {
    return false;
  }
  final PsiJavaCodeReferenceElement referenceElement=(PsiJavaCodeReferenceElement)element;
  if (!referenceElement.isQualified()) {
    return false;
  }
  if (PsiTreeUtil.getParentOfType(element,PsiImportStatementBase.class,PsiPackageStatement.class,PsiCodeFragment.class) != null) {
    return false;
  }
  final PsiElement qualifier=referenceElement.getQualifier();
  if (qualifier instanceof PsiJavaCodeReferenceElement) {
    final PsiJavaCodeReferenceElement qualfierReferenceElement=(PsiJavaCodeReferenceElement)qualifier;
    final PsiElement resolved=qualfierReferenceElement.resolve();
    if (resolved instanceof PsiPackage) {
      return true;
    }
    if (resolved instanceof PsiClass) {
      final Project project=element.getProject();
      final CodeStyleSettings codeStyleSettings=CodeStyleSettingsManager.getSettings(project);
      return codeStyleSettings.INSERT_INNER_CLASS_IMPORTS;
    }
  }
  return false;
}
