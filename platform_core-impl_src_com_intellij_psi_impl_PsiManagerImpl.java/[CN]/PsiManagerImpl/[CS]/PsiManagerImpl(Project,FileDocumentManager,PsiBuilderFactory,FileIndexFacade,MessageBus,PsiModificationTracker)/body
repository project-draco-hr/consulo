{
  myProject=project;
  myFileIndex=fileIndex;
  myMessageBus=messageBus;
  myModificationTracker=modificationTracker;
  @SuppressWarnings({"UnusedDeclaration","UnnecessaryLocalVariable"}) Object used=psiBuilderFactory;
  boolean isProjectDefault=project.isDefault();
  myFileManager=isProjectDefault ? new EmptyFileManager(this) : new FileManagerImpl(this,fileDocumentManager,fileIndex);
  myTreeChangePreprocessors.add((PsiTreeChangePreprocessor)modificationTracker);
  Collections.addAll(myTreeChangePreprocessors,Extensions.getExtensions(PsiTreeChangePreprocessor.EP_NAME,myProject));
  Disposer.register(project,new Disposable(){
    @Override public void dispose(){
      myIsDisposed=true;
    }
  }
);
}
