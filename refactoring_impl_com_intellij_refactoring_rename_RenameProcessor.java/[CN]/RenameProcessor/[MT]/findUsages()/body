{
  myRenamers.clear();
  ArrayList<UsageInfo> result=new ArrayList<UsageInfo>();
  List<PsiElement> elements=new ArrayList<PsiElement>(myAllRenames.keySet());
  for (int i=0; i < elements.size(); i++) {
    PsiElement element=elements.get(i);
    final String newName=myAllRenames.get(element);
    final UsageInfo[] usages=RenameUtil.findUsages(element,newName,mySearchInComments,mySearchTextOccurrences,myAllRenames);
    result.addAll(Arrays.asList(usages));
    if (element instanceof PsiClass && myShouldRenameVariables) {
      myRenamers.add(new AutomaticVariableRenamer((PsiClass)element,newName,Arrays.asList(usages)));
    }
    if (element instanceof PsiClass && myShouldRenameInheritors) {
      if (((PsiClass)element).getName() != null) {
        myRenamers.add(new InheritorRenamer((PsiClass)element,newName));
      }
    }
    if (element instanceof PsiClass && myShouldRenameForms) {
      myRenamers.add(new FormsRenamer((PsiClass)element,newName));
    }
    if (element instanceof PsiMethod) {
      addOverriders((PsiMethod)element,newName,elements);
    }
    if (element instanceof PsiField) {
      myRenamers.add(new ConstructorParameterOnFieldRenameRenamer((PsiField)element,newName));
    }
  }
  UsageInfo[] usageInfos=result.toArray(new UsageInfo[result.size()]);
  usageInfos=UsageViewUtil.removeDuplicatedUsages(usageInfos);
  return usageInfos;
}
