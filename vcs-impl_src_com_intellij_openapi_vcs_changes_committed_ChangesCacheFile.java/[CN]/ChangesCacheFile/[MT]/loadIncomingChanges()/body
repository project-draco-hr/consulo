{
  List<CommittedChangeList> result=new ArrayList<CommittedChangeList>();
  int offset=0;
  openStreams();
  try {
    while (true) {
      IndexEntry[] entries=readLastIndexEntries(offset,1);
      if (entries.length == 0) {
        break;
      }
      if (!entries[0].completelyDownloaded) {
        IncomingChangeListData data=readIncomingChangeListData(offset,entries[0]);
        if (data.accountedChanges.size() == 0) {
          result.add(data.changeList);
        }
 else {
          ReceivedChangeList changeList=new ReceivedChangeList(data.changeList);
          for (          Change change : data.changeList.getChanges()) {
            if (!data.accountedChanges.contains(change)) {
              changeList.addChange(change);
            }
          }
          result.add(changeList);
        }
        if (result.size() == myIncomingCount)         break;
      }
      offset++;
    }
    LOG.info("Loaded " + result.size() + " incoming changelists");
  }
  finally {
    closeStreams();
  }
  return result;
}
