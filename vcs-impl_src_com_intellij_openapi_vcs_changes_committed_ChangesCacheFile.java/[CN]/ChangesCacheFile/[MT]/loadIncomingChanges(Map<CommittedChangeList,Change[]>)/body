{
  int offset=0;
  openStreams();
  try {
    while (true) {
      IndexEntry[] entries=readLastIndexEntries(offset,1);
      if (entries.length == 0) {
        break;
      }
      if (!entries[0].completelyDownloaded) {
        IncomingChangeListData data=readIncomingChangeListData(offset,entries[0]);
        if (data.accountedChanges.size() == 0) {
          changeLists.put(data.changeList,CommittedChangesCache.ALL_CHANGES);
        }
 else {
          List<Change> changes=new ArrayList<Change>();
          for (          Change change : data.changeList.getChanges()) {
            if (!data.accountedChanges.contains(change)) {
              changes.add(change);
            }
          }
          changeLists.put(data.changeList,changes.toArray(new Change[changes.size()]));
        }
        if (changeLists.size() == myIncomingCount)         break;
      }
      offset++;
    }
    LOG.info("Loaded " + changeLists.size() + " incoming changelists");
  }
  finally {
    closeStreams();
  }
}
