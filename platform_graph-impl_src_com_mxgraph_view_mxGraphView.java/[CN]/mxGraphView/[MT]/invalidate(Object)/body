{
  mxIGraphModel model=graph.getModel();
  cell=(cell != null) ? cell : model.getRoot();
  mxCellState state=getState(cell);
  if (state == null || !state.isInvalid()) {
    if (state != null) {
      state.setInvalid(true);
    }
    int childCount=model.getChildCount(cell);
    for (int i=0; i < childCount; i++) {
      Object child=model.getChildAt(cell,i);
      invalidate(child);
    }
    int edgeCount=model.getEdgeCount(cell);
    for (int i=0; i < edgeCount; i++) {
      invalidate(model.getEdgeAt(cell,i));
    }
  }
}
