{
  List<mxPoint> pts=edge.getAbsolutePoints();
  mxPoint point=null;
  if (pts != null && (source || pts.size() > 2 || opposite == null)) {
    int count=pts.size();
    int index=(source) ? Math.min(1,count - 1) : Math.max(0,count - 2);
    point=pts.get(index);
  }
  if (point == null && opposite != null) {
    point=new mxPoint(opposite.getCenterX(),opposite.getCenterY());
  }
  return point;
}
