{
  DomainObjectSet<? extends IdeaModule> gradleModules=gradleProject.getModules();
  if (gradleModules == null || gradleModules.isEmpty()) {
    throw new IllegalStateException("No modules found for the target project: " + gradleProject);
  }
  Map<String,GradleModule> modules=new HashMap<String,GradleModule>();
  for (  IdeaModule gradleModule : gradleModules) {
    if (gradleModule == null) {
      continue;
    }
    GradleModuleImpl module=populateModule(gradleModule,intellijProject);
    String moduleName=module.getName();
    GradleModule previouslyParsedModule=modules.get(moduleName);
    if (modules.containsKey(moduleName)) {
      throw new IllegalStateException(String.format("Modules with duplicate name (%s) detected: '%s' and '%s'",moduleName,module,previouslyParsedModule));
    }
    modules.put(moduleName,module);
    intellijProject.addModule(module);
  }
}
