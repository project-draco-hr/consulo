{
  final File projectBuildFileDestDir=VfsUtil.virtualToIoFile(project.getBaseDir());
  projectBuildFileDestDir.mkdirs();
  final File destFile=new File(projectBuildFileDestDir,BuildProperties.getProjectBuildFileName(project) + XML_EXTENSION);
  final File propertiesFile=new File(projectBuildFileDestDir,BuildProperties.getPropertyFileName(project));
  ensureFilesWritable(project,new File[]{destFile,propertiesFile});
  if (!backup(destFile,project,genOptions,filesToRefresh)) {
    return null;
  }
  if (!backup(propertiesFile,project,genOptions,filesToRefresh)) {
    return null;
  }
  generateSingleFileBuild(project,genOptions,destFile,propertiesFile);
  filesToRefresh.add(destFile);
  filesToRefresh.add(propertiesFile);
  return new File[]{destFile,propertiesFile};
}
