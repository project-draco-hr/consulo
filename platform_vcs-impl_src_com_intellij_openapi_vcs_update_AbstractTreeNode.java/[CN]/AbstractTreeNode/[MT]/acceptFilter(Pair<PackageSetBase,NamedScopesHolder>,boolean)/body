{
  boolean apply=false;
  if (children != null && filter != null) {
    for (Iterator I=children.iterator(); I.hasNext(); ) {
      AbstractTreeNode node=(AbstractTreeNode)I.next();
      if (node.acceptFilter(filter,showOnlyFilteredItems)) {
        apply=true;
      }
 else       if (showOnlyFilteredItems) {
        if (node instanceof Disposable) {
          Disposer.dispose((Disposable)node);
        }
        I.remove();
      }
    }
    applyFilter(apply);
  }
  return apply;
}
