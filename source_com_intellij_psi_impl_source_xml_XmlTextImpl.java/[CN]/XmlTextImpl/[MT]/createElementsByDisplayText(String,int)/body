{
  if (!toCode(displayText))   return Factory.createSingleLeafElement(XmlTokenType.XML_DATA_CHARACTERS,displayText.toCharArray(),0,displayText.length(),null,null);
  final FileElement dummyParent=new DummyHolder(null,null).getTreeElement();
  if (policy == CDATA_ON_TEXT) {
    TreeUtil.addChildren(dummyParent,Factory.createLeafElement(XmlTokenType.XML_CDATA_START,"<![CDATA[".toCharArray(),0,9,-1,dummyParent.getCharTable()));
    TreeUtil.addChildren(dummyParent,Factory.createLeafElement(XmlTokenType.XML_DATA_CHARACTERS,displayText.toCharArray(),0,displayText.length(),-1,dummyParent.getCharTable()));
    TreeUtil.addChildren(dummyParent,Factory.createLeafElement(XmlTokenType.XML_CDATA_END,"]]>".toCharArray(),0,3,-1,dummyParent.getCharTable()));
  }
 else   if (policy == ENCODE_SYMS) {
    int sectionStartOffset=0;
    int offset=0;
    while (offset < displayText.length()) {
      if (toCode(displayText.charAt(offset))) {
        final String plainSection=displayText.substring(sectionStartOffset,offset);
        if (plainSection.length() > 0)         TreeUtil.addChildren(dummyParent,Factory.createLeafElement(XmlTokenType.XML_DATA_CHARACTERS,plainSection.toCharArray(),0,plainSection.length(),-1,dummyParent.getCharTable()));
        TreeUtil.addChildren(dummyParent,createCharEntity(displayText.charAt(offset),dummyParent.getCharTable()));
      }
    }
  }
  return dummyParent.firstChild;
}
