{
  Collections.sort(changes,ChangeList.CHANGE_ORDER);
  List<Diff> diffs=new ArrayList<Diff>(changes.size());
  for (  Change change : changes) {
    if (!change.isValid()) {
      continue;
    }
    int start1=change.getChangeSide(FragmentSide.SIDE1).getStartLine();
    int end1=change.getChangeSide(FragmentSide.SIDE1).getEndLine();
    Interval interval1=Interval.fromTo(start1,end1);
    int start2=change.getChangeSide(FragmentSide.SIDE2).getStartLine();
    int end2=change.getChangeSide(FragmentSide.SIDE2).getEndLine();
    Interval interval2=Interval.fromTo(start2,end2);
    diffs.add(new Diff(interval1,interval2,change.getType().getTypeKey()));
  }
  return new LineBlocks(diffs);
}
