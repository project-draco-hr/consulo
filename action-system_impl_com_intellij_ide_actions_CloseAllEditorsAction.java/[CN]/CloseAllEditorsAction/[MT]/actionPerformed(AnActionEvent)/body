{
  final DataContext dataContext=e.getDataContext();
  final Project project=DataKeys.PROJECT.getData(dataContext);
  CommandProcessor commandProcessor=CommandProcessor.getInstance();
  commandProcessor.executeCommand(project,new Runnable(){
    public void run(){
      final EditorWindow window=(EditorWindow)dataContext.getData(DataConstantsEx.EDITOR_WINDOW);
      if (window != null) {
        final VirtualFile[] files=window.getFiles();
        for (int i=0; i < files.length; i++) {
          VirtualFile file=files[i];
          window.closeFile(file);
        }
        return;
      }
      FileEditorManagerEx fileEditorManager=FileEditorManagerEx.getInstanceEx(project);
      VirtualFile selectedFile=fileEditorManager.getSelectedFiles()[0];
      VirtualFile[] openFiles=fileEditorManager.getSiblings(selectedFile);
      for (int i=0; i < openFiles.length; i++) {
        fileEditorManager.closeFile(openFiles[i]);
      }
    }
  }
,IdeBundle.message("command.close.all.editors"),null);
}
