{
  XStackFrame stackFrame=mySession.getCurrentStackFrame();
  XDebuggerTree tree=getTree();
  if (event == SessionEvent.BEFORE_RESUME || event == SessionEvent.SETTINGS_CHANGED) {
    saveCurrentTreeState(stackFrame);
    if (event == SessionEvent.BEFORE_RESUME) {
      return;
    }
  }
  tree.markNodesObsolete();
  if (stackFrame != null) {
    buildTreeAndRestoreState(stackFrame);
  }
 else {
    tree.setSourcePosition(null);
    XDebuggerTreeNode node;
    if (!mySession.isStopped() && mySession.isPaused()) {
      node=createInfoMessage(tree,"Frame is not available");
    }
 else {
      XDebugProcess debugProcess=mySession.getDebugProcess();
      node=createInfoMessage(tree,debugProcess.getCurrentStateMessage(),debugProcess.getCurrentStateHyperlinkListener());
    }
    tree.setRoot(node,true);
  }
}
