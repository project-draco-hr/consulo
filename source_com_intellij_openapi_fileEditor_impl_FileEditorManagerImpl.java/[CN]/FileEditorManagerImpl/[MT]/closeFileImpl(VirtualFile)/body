{
  if (file == null) {
    throw new IllegalArgumentException("file cannot be null");
  }
  assertThread();
  ++mySplitters.myInsideChange;
  try {
    final EditorWindow[] windows=mySplitters.findWindows(file);
    if (windows != null) {
      final VirtualFile nextFile=findNextFile(file);
      for (      final EditorWindow window : windows) {
        LOG.assertTrue(window.getSelectedEditor() != null);
        window.closeFile(file,false);
        if (window.getTabCount() == 0 && nextFile != null) {
          EditorWithProviderComposite newComposite=newEditorComposite(nextFile,null);
          window.setEditor(newComposite);
        }
      }
      for (      final EditorWindow window : windows) {
        if (window.isDisposed()) {
          continue;
        }
        if (window.getTabCount() == 0) {
          window.unsplit();
        }
      }
    }
    myDispatcher.getMulticaster().fileClosed(this,file);
  }
  finally {
    --mySplitters.myInsideChange;
  }
}
