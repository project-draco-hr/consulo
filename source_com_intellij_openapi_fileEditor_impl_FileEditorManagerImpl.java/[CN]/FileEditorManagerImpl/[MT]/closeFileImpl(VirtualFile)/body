{
  if (file == null) {
    throw new IllegalArgumentException("file cannot be null");
  }
  assertThread();
  ++mySplitters.myInsideChange;
  try {
    final EditorWindow[] windows=mySplitters.findWindows(file);
    if (windows != null) {
      final VirtualFile nextFile=findNextFile(file);
      for (      final EditorWindow window : windows) {
        LOG.assertTrue(window.getSelectedEditor() != null);
        final EditorWithProviderComposite oldComposite=window.findFileComposite(file);
        if (oldComposite != null) {
          window.removeEditor(oldComposite);
        }
        if (nextFile != null) {
          if (window.getTabCount() == 0) {
            EditorWithProviderComposite newComposite=window.findFileComposite(nextFile);
            if (newComposite == null) {
              newComposite=newEditorComposite(nextFile,null);
            }
            window.setEditor(newComposite);
          }
        }
      }
    }
    myDispatcher.getMulticaster().fileClosed(this,file);
  }
  finally {
    --mySplitters.myInsideChange;
  }
}
