{
  SshLogger.debug("proxy authenticator asked");
  final String protocol=getRequestingProtocol();
  if ((protocol == null) || (!StringUtil.containsIgnoreCase(protocol,SOCKS_REQUESTING_PROTOCOL))) {
    return super.getPasswordAuthentication();
  }
  final RequestorType type=getRequestorType();
  final String host=getRequestingHost();
  final int port=getRequestingPort();
  final Pair<String,String> result=myKnown.get(new Pair<String,Integer>(host,port));
  if (result != null) {
    SshLogger.debug("proxy authenticator found what to answer");
    return new PasswordAuthentication(result.getFirst(),result.getSecond().toCharArray());
  }
  return super.getPasswordAuthentication();
}
