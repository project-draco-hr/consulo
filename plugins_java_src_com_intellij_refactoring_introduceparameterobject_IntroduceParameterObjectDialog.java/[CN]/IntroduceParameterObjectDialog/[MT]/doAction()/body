{
  final boolean useExistingClass=useExistingClass();
  final boolean keepMethod=keepMethodAsDelegate();
  final String className;
  final String packageName;
  final boolean createInnerClass=myCreateInnerClassRadioButton.isSelected();
  if (createInnerClass) {
    className=getInnerClassName();
    packageName="";
  }
 else   if (useExistingClass) {
    final String existingClassName=getExistingClassName();
    className=StringUtil.getShortName(existingClassName);
    packageName=StringUtil.getPackageName(existingClassName);
  }
 else {
    packageName=getPackageName();
    className=getClassName();
  }
  List<VariableData> parameters=new ArrayList<VariableData>();
  for (  VariableData data : parameterInfo) {
    if (data.passAsParameter) {
      parameters.add(data);
    }
  }
  final String newVisibility=myEscalateVisibilityCheckBox.isEnabled() && myEscalateVisibilityCheckBox.isSelected() ? VisibilityUtil.ESCALATE_VISIBILITY : null;
  final MoveDestination moveDestination=((DestinationFolderComboBox)myDestinationCb).selectDirectory(new PackageWrapper(PsiManager.getInstance(myProject),packageName),false);
  invokeRefactoring(new IntroduceParameterObjectProcessor(className,packageName,moveDestination,sourceMethod,parameters.toArray(new VariableData[parameters.size()]),keepMethod,useExistingClass,createInnerClass,newVisibility,myGenerateAccessorsCheckBox.isSelected()));
}
