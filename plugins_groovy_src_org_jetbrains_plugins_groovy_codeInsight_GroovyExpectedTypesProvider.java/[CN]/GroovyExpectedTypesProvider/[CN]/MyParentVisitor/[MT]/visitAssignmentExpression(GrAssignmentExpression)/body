{
  if (myExpr == assignment.getRValue()) {
    GrExpression lExpr=assignment.getLValue();
    PsiType type=lExpr.getType();
    if (type != null) {
      TailType tailType=getAssignmentRValueTailType(assignment);
      ExpectedTypeInfoImpl info=createInfoImpl(type,ExpectedTypeInfo.TYPE_OR_SUBTYPE,type,tailType);
      if (lExpr instanceof GrReferenceExpression) {
        PsiElement refElement=((GrReferenceExpression)lExpr).resolve();
        if (refElement instanceof GrVariable) {
          info.expectedName=getPropertyName((GrVariable)refElement);
        }
      }
      myResult=new ExpectedTypeInfo[]{info};
    }
 else {
      myResult=ExpectedTypeInfo.EMPTY_ARRAY;
    }
  }
 else {
    if (myForCompletion) {
      myExpr=(GrExpression)myExpr.getParent();
      ((GroovyPsiElement)assignment.getParent()).accept(this);
      return;
    }
    GrExpression rExpr=assignment.getRValue();
    if (rExpr != null) {
      PsiType type=rExpr.getType();
      if (type != null) {
        if (type instanceof PsiClassType) {
          final PsiClass resolved=((PsiClassType)type).resolve();
          if (resolved instanceof PsiAnonymousClass) {
            type=((PsiAnonymousClass)resolved).getBaseClassType();
          }
        }
        ExpectedTypeInfoImpl info=createInfoImpl(type,ExpectedTypeInfo.TYPE_OR_SUPERTYPE,type,TailType.NONE);
        myResult=new ExpectedTypeInfo[]{info};
        return;
      }
    }
    myResult=ExpectedTypeInfo.EMPTY_ARRAY;
  }
}
