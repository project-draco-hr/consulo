{
  final DataContext dataContext=e.getDataContext();
  final Project project=CommonDataKeys.PROJECT.getData(dataContext);
  LOG.assertTrue(project instanceof ProjectEx);
  Module module;
  Module[] modules=ModuleManager.getInstance(project).getModules();
  if (modules.length == 1 && project.getName().equals(modules[0].getName())) {
    module=modules[0];
  }
 else {
    module=null;
  }
  Messages.showInputDialog(project,RefactoringBundle.message("enter.new.project.name"),RefactoringBundle.message("rename.project"),Messages.getQuestionIcon(),project.getName(),new RenameProjectHandler.MyInputValidator((ProjectEx)project,module));
}
