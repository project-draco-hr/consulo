{
  if (ApplicationManager.getApplication().isUnitTestMode())   return null;
  if (new PsiMatcherImpl(keyword).dot(PsiMatchers.hasText(PsiModifier.PUBLIC)).parent(PsiMatchers.hasClass(PsiModifierList.class)).parent(PsiMatchers.hasClass(PsiClass.class)).parent(PsiMatchers.hasClass(PsiJavaFile.class)).getElement() == null) {
    return null;
  }
  PsiClass aClass=(PsiClass)keyword.getParent().getParent();
  PsiJavaFile file=(PsiJavaFile)aClass.getContainingFile();
  VirtualFile virtualFile=file.getVirtualFile();
  HighlightInfo errorResult=null;
  if (virtualFile != null && !aClass.getName().equals(virtualFile.getNameWithoutExtension())) {
    String message=JavaErrorMessages.message("public.class.should.be.named.after.file",aClass.getName());
    TextRange range=HighlightNamesUtil.getClassDeclarationTextRange(aClass);
    errorResult=HighlightInfo.newHighlightInfo(HighlightInfoType.ERROR).range(range).descriptionAndTooltip(message).create();
    IntentionAction fix=QUICK_FIX_FACTORY.createModifierListFix(psiModifierList,PsiModifier.PUBLIC,false,false);
    QuickFixAction.registerQuickFixAction(errorResult,fix);
    PsiClass[] classes=file.getClasses();
    if (classes.length > 1) {
      QuickFixAction.registerQuickFixAction(errorResult,new MoveClassToSeparateFileFix(aClass));
    }
    for (    PsiClass otherClass : classes) {
      if (!otherClass.getManager().areElementsEquivalent(otherClass,aClass) && otherClass.hasModifierProperty(PsiModifier.PUBLIC) && otherClass.getName().equals(virtualFile.getNameWithoutExtension())) {
        return errorResult;
      }
    }
    QuickFixAction.registerQuickFixAction(errorResult,new RenameFileFix(aClass.getName() + "." + StdFileTypes.JAVA.getDefaultExtension()));
    QuickFixAction.registerQuickFixAction(errorResult,new RenameElementFix(aClass));
  }
  return errorResult;
}
