{
  PsiElement parent=extendRef.getParent();
  if (!(parent instanceof PsiReferenceList)) {
    return null;
  }
  PsiElement grand=parent.getParent();
  if (!(grand instanceof PsiClass)) {
    return null;
  }
  PsiClass aClass=(PsiClass)grand;
  if (aClass.getExtendsList() != parent || aClass instanceof PsiTypeParameter) {
    return null;
  }
  if (!(resolved instanceof PsiClass)) {
    return HighlightInfo.createHighlightInfo(HighlightInfoType.ERROR,extendRef,JavaErrorMessages.message("class.name.expected"));
  }
  PsiClass base=(PsiClass)resolved;
  if (!PsiUtil.isInnerClass(base))   return null;
  PsiClass baseClass=base.getContainingClass();
  if (!hasEnclosingInstanceInScope(baseClass,extendRef,true) && !qualifiedNewCalledInConstructors(aClass,baseClass)) {
    String description=JavaErrorMessages.message("no.enclosing.instance.in.scope",HighlightUtil.formatClass(baseClass));
    return HighlightInfo.createHighlightInfo(HighlightInfoType.ERROR,extendRef,description);
  }
  return null;
}
