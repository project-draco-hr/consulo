{
  if (Patches.SUN_BUG_ID_4508058) {
    if (virtualFile.getCharset() != null && virtualFile.getCharset().name().contains("UTF-8")) {
      reader.mark(1);
      char c=(char)reader.read();
      if (c == '\uFEFF') {
        virtualFile.setBOM(CharsetToolkit.UTF8_BOM);
      }
 else {
        reader.reset();
      }
    }
  }
}
