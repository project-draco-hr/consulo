{
class StopIterationException extends RuntimeException {
  }
  try {
    VfsUtilCore.visitChildrenRecursively(myRoot,new VirtualFileVisitor(false){
      @Override public boolean visitFile(      @NotNull VirtualFile file){
        if (myRootPresentFilter != null && !myRootPresentFilter.accept(file))         return false;
        if (isExcluded(myExcludedFileIndex,file))         return false;
        if (myProject.isDisposed() || !process(file))         throw new StopIterationException();
        final VirtualFile[] files=file.getChildren();
        if (myDirectoryFilter != null && !myDirectoryFilter.process(file,files))         return false;
        return true;
      }
    }
);
  }
 catch (  StopIterationException e) {
    return false;
  }
  return true;
}
