{
  byte[] content=printDocument(copy);
  ByteArrayInputStream in=new ByteArrayInputStream(content);
  try {
    if (provider.isEnabled()) {
      provider.saveContent(fileSpec,in,content.length,type,async);
    }
  }
  finally {
    in.close();
  }
}
