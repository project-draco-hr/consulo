{
  PsiClass newClass;
  for (  MoveClassHandler handler : MoveClassHandler.EP_NAME.getExtensions()) {
    newClass=handler.doMoveClass(aClass,moveDestination);
    if (newClass != null)     return newClass;
  }
  PsiFile file=aClass.getContainingFile();
  PsiDirectory newDirectory=moveDestination.getTargetDirectory(file);
  final PsiPackage newPackage=JavaDirectoryService.getInstance().getPackage(newDirectory);
  newClass=aClass;
  if (!newDirectory.equals(file.getContainingDirectory())) {
    aClass.getManager().moveFile(file,newDirectory);
    if (file instanceof PsiClassOwner && newPackage != null) {
      ((PsiClassOwner)file).setPackageName(newPackage.getQualifiedName());
    }
  }
  return newClass;
}
