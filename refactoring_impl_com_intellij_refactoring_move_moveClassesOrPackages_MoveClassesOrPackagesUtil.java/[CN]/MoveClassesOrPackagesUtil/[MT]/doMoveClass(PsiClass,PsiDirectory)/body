{
  PsiClass newClass;
  for (  MoveClassHandler handler : MoveClassHandler.EP_NAME.getExtensions()) {
    newClass=handler.doMoveClass(aClass,moveDestination);
    if (newClass != null)     return newClass;
  }
  PsiFile file=aClass.getContainingFile();
  final PsiPackage newPackage=JavaDirectoryService.getInstance().getPackage(moveDestination);
  newClass=aClass;
  if (!moveDestination.equals(file.getContainingDirectory())) {
    aClass.getManager().moveFile(file,moveDestination);
    if (file instanceof PsiClassOwner && newPackage != null) {
      ((PsiClassOwner)file).setPackageName(newPackage.getQualifiedName());
    }
  }
  return newClass;
}
