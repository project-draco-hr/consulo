{
  PsiManager manager=element.getManager();
  if (Comparing.equal(getQualfiedName(element),newQName))   return new UsageInfo[0];
  ArrayList<UsageInfo> results=new ArrayList<UsageInfo>();
  Set<PsiReference> foundReferences=new HashSet<PsiReference>();
  GlobalSearchScope projectScope=GlobalSearchScope.projectScope(manager.getProject());
  PsiReference[] references=ReferencesSearch.search(element,projectScope,false).toArray(new PsiReference[0]);
  for (  PsiReference reference : references) {
    TextRange range=reference.getRangeInElement();
    if (foundReferences.contains(reference))     continue;
    results.add(new MoveRenameUsageInfo(reference.getElement(),reference,range.getStartOffset(),range.getEndOffset(),element,false));
    foundReferences.add(reference);
  }
  findNonCodeUsages(searchInStringsAndComments,searchInNonJavaFiles,element,newQName,results);
  return results.toArray(new UsageInfo[results.size()]);
}
