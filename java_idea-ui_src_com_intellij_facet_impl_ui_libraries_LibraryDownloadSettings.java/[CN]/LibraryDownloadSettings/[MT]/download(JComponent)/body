{
  LibraryDownloader downloader=new LibraryDownloader(mySelectedDownloads,null,parent,myDirectoryForDownloadedLibrariesPath,myLibraryName);
  VirtualFile[] files=downloader.download();
  if (files.length != mySelectedDownloads.size()) {
    return null;
  }
  final NewLibraryEditor libraryEditor;
  if (myLibraryType != null) {
    libraryEditor=new NewLibraryEditor(myLibraryType,new LibraryVersionProperties(myVersion.getVersionString()));
  }
 else {
    libraryEditor=new NewLibraryEditor();
  }
  libraryEditor.setName(myLibraryName);
  for (  VirtualFile file : files) {
    libraryEditor.addRoot(file,OrderRootType.CLASSES);
  }
  return libraryEditor;
}
