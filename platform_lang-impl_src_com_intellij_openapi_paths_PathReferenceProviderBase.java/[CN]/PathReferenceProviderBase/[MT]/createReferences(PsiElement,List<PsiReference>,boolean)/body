{
  final TextRange range=ElementManipulators.getValueTextRange(psiElement);
  int offset=range.getStartOffset();
  int endOffset=range.getEndOffset();
  final String elementText=psiElement.getText();
  for (  DynamicContextProvider provider : Extensions.getExtensions(DynamicContextProvider.EP_NAME)) {
    final int dynamicOffset=provider.getOffset(psiElement,offset,elementText);
    if (dynamicOffset == -1) {
      return false;
    }
 else     if (dynamicOffset != offset) {
      offset=dynamicOffset;
    }
  }
  final int pos=getLastPosOfURL(offset,elementText);
  if (pos != -1 && pos < endOffset) {
    endOffset=pos;
  }
  try {
    final String text=elementText.substring(offset,endOffset);
    return createReferences(psiElement,offset,text,references,soft);
  }
 catch (  StringIndexOutOfBoundsException e) {
    LOG.error("Cannot process string: '" + psiElement.getParent().getParent().getText() + "'",e);
    return false;
  }
}
