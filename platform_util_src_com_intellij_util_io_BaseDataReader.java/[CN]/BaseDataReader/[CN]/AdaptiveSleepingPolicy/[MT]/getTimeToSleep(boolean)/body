{
  int currentSleepTime=myCurrentSleepTime;
  if (wasActive)   currentSleepTime=sleepTimeWhenWasActive;
 else   if (currentSleepTime == sleepTimeWhenWasActive) {
    currentSleepTime=sleepTimeWhenIdle;
    myIterationsWithCurrentTime=0;
  }
 else {
    int iterationsWithCurrentTime=++myIterationsWithCurrentTime;
    if (iterationsWithCurrentTime >= maxIterationsWithCurrentSleepTime) {
      myIterationsWithCurrentTime=0;
      currentSleepTime=Math.min(2 * currentSleepTime,maxSleepTimeWhenIdle);
    }
  }
  myCurrentSleepTime=currentSleepTime;
  return currentSleepTime;
}
