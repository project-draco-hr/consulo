{
  PsiElement element=TargetElementUtilBase.findTargetElement(myEditor,TargetElementUtilBase.ELEMENT_NAME_ACCEPTED | TargetElementUtilBase.REFERENCED_ELEMENT_ACCEPTED);
  final PsiReference ref=myFile.findReferenceAt(myEditor.getCaretModel().getOffset());
  PsiReferenceExpression refExpr=ref instanceof PsiReferenceExpression ? (PsiReferenceExpression)ref : null;
  assertTrue(element instanceof PsiMethod);
  PsiMethod method=(PsiMethod)element;
  final boolean condition=InlineMethodProcessor.checkBadReturns(method) && !InlineUtil.allUsagesAreTailCalls(method);
  assertFalse("Bad returns found",condition);
  final InlineMethodProcessor processor=new InlineMethodProcessor(getProject(),method,refExpr,myEditor,options.isInlineThisOnly(),nonCode,nonCode);
  processor.run();
}
