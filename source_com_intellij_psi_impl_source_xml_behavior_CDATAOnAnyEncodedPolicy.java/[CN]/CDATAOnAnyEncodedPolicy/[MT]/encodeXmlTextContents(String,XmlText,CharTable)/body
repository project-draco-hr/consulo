{
  final ASTNode firstChild=text.getNode().getFirstChildNode();
  boolean textAlreadyHasCDATA=firstChild != null && firstChild.getElementType() == XmlElementType.XML_CDATA;
  if (textAlreadyHasCDATA || XmlUtil.toCode(displayText)) {
    final FileElement dummyParent=createCDATAElement(text.getManager(),charTableByTree,displayText);
    return dummyParent.getFirstChildNode();
  }
 else {
    return super.encodeXmlTextContents(displayText,text,charTableByTree);
  }
}
