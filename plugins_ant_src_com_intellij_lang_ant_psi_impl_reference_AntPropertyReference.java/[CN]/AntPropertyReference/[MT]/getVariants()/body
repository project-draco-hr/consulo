{
  final AntElement currentElement=getElement();
  final Set<PsiElement> variants=PsiElementSetSpinAllocator.alloc();
  final Set<String> definedProperties=StringSetSpinAllocator.alloc();
  try {
    final Set<PsiElement> elementsDepthStack=PsiElementSetSpinAllocator.alloc();
    try {
      final AntProject project=currentElement.getAntProject();
      final AntFile antFile=currentElement.getAntFile();
      for (      final AntProperty property : antFile.getProperties()) {
        if (currentElement != property) {
          addAntProperties(property,variants,definedProperties);
        }
      }
      getVariants(project,variants,elementsDepthStack,definedProperties);
      for (      final AntFile imported : project.getImportedFiles()) {
        getVariants(imported.getAntProject(),variants,elementsDepthStack,definedProperties);
      }
    }
  finally {
      PsiElementSetSpinAllocator.dispose(elementsDepthStack);
    }
    return variants.toArray(new Object[variants.size()]);
  }
  finally {
    PsiElementSetSpinAllocator.dispose(variants);
    StringSetSpinAllocator.dispose(definedProperties);
  }
}
