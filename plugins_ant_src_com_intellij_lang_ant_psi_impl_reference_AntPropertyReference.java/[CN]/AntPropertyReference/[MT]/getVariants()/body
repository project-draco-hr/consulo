{
  final AntElement currentElement=getElement();
  final Set<PsiElement> variants=PsiElementSetSpinAllocator.alloc();
  try {
    final Set<PsiElement> elementsDepthStack=PsiElementSetSpinAllocator.alloc();
    try {
      final AntProject project=currentElement.getAntProject();
      for (      final AntProperty property : project.getProperties()) {
        if (currentElement != property) {
          addAntProperties(property,variants);
        }
      }
      getVariants(project,variants,elementsDepthStack);
      for (      final AntFile imported : project.getImportedFiles()) {
        getVariants(imported.getAntProject(),variants,elementsDepthStack);
      }
    }
  finally {
      PsiElementSetSpinAllocator.dispose(elementsDepthStack);
    }
    variants.add(new AntElementCompletionWrapper(ANT_FILE_PROPERTY,currentElement.getProject(),AntElementRole.PROPERTY_ROLE));
    return variants.toArray(new Object[variants.size()]);
  }
  finally {
    PsiElementSetSpinAllocator.dispose(variants);
  }
}
