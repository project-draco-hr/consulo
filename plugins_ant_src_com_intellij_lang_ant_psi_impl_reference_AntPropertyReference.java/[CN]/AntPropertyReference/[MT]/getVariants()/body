{
  final Set<PsiElement> variants=PsiElementSetSpinAllocator.alloc();
  try {
    final AntProject project=getElement().getAntProject();
    for (    final AntProperty property : project.getProperties()) {
      addAntProperties(property,variants);
    }
    getVariants(project,variants);
    for (    final AntFile imported : project.getImportedFiles()) {
      getVariants(imported.getAntProject(),variants);
    }
    return variants.toArray(new Object[variants.size()]);
  }
  finally {
    PsiElementSetSpinAllocator.dispose(variants);
  }
}
