{
  if (elementsDepthStack.contains(element))   return;
  elementsDepthStack.add(element);
  try {
    for (    final PsiElement child : element.getChildren()) {
      if (child instanceof AntStructuredElement) {
        getVariants((AntStructuredElement)child,variants,elementsDepthStack);
        if (child instanceof AntImport) {
          AntImport antImport=(AntImport)child;
          final AntFile imported=antImport.getImportedFile();
          if (imported != null) {
            getVariants(imported.getAntProject(),variants,elementsDepthStack);
          }
        }
 else         if (child instanceof AntProperty) {
          AntProperty property=(AntProperty)child;
          final PropertiesFile propertiesFile=property.getPropertiesFile();
          if (propertiesFile == null) {
            addAntProperties(property,variants);
          }
 else {
            for (            final Property importedProp : propertiesFile.getProperties()) {
              variants.add(importedProp);
            }
          }
        }
      }
    }
  }
  finally {
    elementsDepthStack.remove(element);
  }
}
