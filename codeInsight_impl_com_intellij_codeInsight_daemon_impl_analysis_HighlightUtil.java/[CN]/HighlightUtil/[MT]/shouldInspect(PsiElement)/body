{
  if (!shouldHighlight(psiRoot))   return false;
  final Project project=psiRoot.getProject();
  final ProjectFileIndex fileIndex=ProjectRootManager.getInstance(project).getFileIndex();
  final VirtualFile virtualFile=psiRoot.getContainingFile().getVirtualFile();
  if (virtualFile == null || !virtualFile.isValid())   return false;
  if ((fileIndex.isInLibrarySource(virtualFile) || fileIndex.isInLibraryClasses(virtualFile)) && !fileIndex.isInContent(virtualFile)) {
    return false;
  }
  return true;
}
