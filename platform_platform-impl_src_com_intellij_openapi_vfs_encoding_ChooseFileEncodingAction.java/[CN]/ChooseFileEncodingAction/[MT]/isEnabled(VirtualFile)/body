{
  boolean enabled=true;
  if (virtualFile != null) {
    Charset charset=cachedCharsetFromContent(virtualFile);
    if (charset != null) {
      enabled=false;
    }
 else     if (!virtualFile.isDirectory()) {
      FileType fileType=FileTypeManager.getInstance().getFileTypeByFile(virtualFile);
      if (fileType.isBinary() || fileType == StdFileTypes.GUI_DESIGNER_FORM || fileType == StdFileTypes.IDEA_MODULE || fileType == StdFileTypes.IDEA_PROJECT || fileType == StdFileTypes.IDEA_WORKSPACE || fileType == StdFileTypes.PATCH || fileType == StdFileTypes.PROPERTIES || fileType == StdFileTypes.XML || fileType == StdFileTypes.JSPX) {
        enabled=false;
      }
    }
  }
  return enabled;
}
