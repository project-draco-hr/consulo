{
  Pair<String,Boolean> result=update(myVirtualFile);
  boolean enabled=result.second;
  if (myVirtualFile != null) {
    Charset charset=cachedCharsetFromContent(myVirtualFile);
    String prefix=charset == null ? "" : "Encoding (auto-detected):";
    if (charset == null)     charset=myVirtualFile.getCharset();
    e.getPresentation().setText(prefix + " " + charset.toString());
  }
  e.getPresentation().setEnabled(enabled);
  e.getPresentation().setDescription(result.first);
}
