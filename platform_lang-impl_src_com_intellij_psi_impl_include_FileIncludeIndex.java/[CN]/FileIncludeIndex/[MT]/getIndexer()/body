{
  return new DataIndexer<Key,List<FileIncludeInfoImpl>,FileContent>(){
    @Override @NotNull public Map<Key,List<FileIncludeInfoImpl>> map(    @NotNull FileContent inputData){
      Map<Key,List<FileIncludeInfoImpl>> map=new FactoryMap<Key,List<FileIncludeInfoImpl>>(){
        @Override protected List<FileIncludeInfoImpl> create(        Key key){
          return new ArrayList<FileIncludeInfoImpl>();
        }
      }
;
      for (      FileIncludeProvider provider : myProviders) {
        if (!provider.acceptFile(inputData.getFile()))         continue;
        FileIncludeInfo[] infos=provider.getIncludeInfos(inputData);
        if (infos.length == 0)         continue;
        List<FileIncludeInfoImpl> infoList=map.get(new FileKey(inputData.getFile()));
        for (        FileIncludeInfo info : infos) {
          FileIncludeInfoImpl impl=new FileIncludeInfoImpl(info.path,info.offset,info.runtimeOnly,provider.getId());
          map.get(new IncludeKey(info.fileName)).add(impl);
          infoList.add(impl);
        }
      }
      return map;
    }
  }
;
}
