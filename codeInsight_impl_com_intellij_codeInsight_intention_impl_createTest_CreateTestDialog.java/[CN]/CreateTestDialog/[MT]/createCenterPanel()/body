{
  JPanel panel=new JPanel(new GridBagLayout());
  panel.setBorder(IdeBorderFactory.createBorder());
  GridBagConstraints constr=new GridBagConstraints();
  constr.insets=new Insets(4,8,4,8);
  constr.fill=GridBagConstraints.HORIZONTAL;
  constr.anchor=GridBagConstraints.WEST;
  JPanel librariesPanel=new JPanel();
  BoxLayout l=new BoxLayout(librariesPanel,BoxLayout.X_AXIS);
  librariesPanel.setLayout(l);
  ButtonGroup group=new ButtonGroup();
  for (  final CreateTestProvider p : Extensions.getExtensions(CreateTestProvider.EXTENSION_NAME)) {
    final JRadioButton b=new JRadioButton(p.getName());
    group.add(b);
    librariesPanel.add(b);
    b.addActionListener(new ActionListener(){
      public void actionPerformed(      ActionEvent e){
        if (b.isSelected() && !p.isLibraryAttached(myTargetModule)) {
          int result=Messages.showYesNoDialog(myProject,"Do you wand to attach " + p.getName() + " library to the module?","Library is not available",Messages.getQuestionIcon());
          if (result == 0) {
            ApplicationManager.getApplication().runWriteAction(new Runnable(){
              public void run(){
                OrderEntryFix.addJarToRoots(p.getLibraryPath(),myTargetModule);
              }
            }
);
          }
        }
        String superClass=p.getDefaultSuperClass();
        mySuperClassField.setText(superClass == null ? "" : superClass);
      }
    }
);
  }
  constr.gridx=0;
  constr.weightx=1;
  constr.gridwidth=GridBagConstraints.REMAINDER;
  panel.add(librariesPanel,constr);
  constr.gridx=0;
  constr.weightx=0;
  constr.gridwidth=1;
  panel.add(new JLabel(CodeInsightBundle.message("intention.create.test.dialog.class.name")),constr);
  constr.gridx=1;
  constr.weightx=1;
  panel.add(myTargetClassNameField,constr);
  constr.gridx=0;
  constr.weightx=0;
  panel.add(new JLabel(CodeInsightBundle.message("intention.create.test.dialog.super.class")),constr);
  constr.gridx=1;
  constr.weightx=1;
  panel.add(mySuperClassField,constr);
  constr.gridx=0;
  constr.weightx=0;
  panel.add(new JLabel(CodeInsightBundle.message("dialog.create.class.destination.package.label")),constr);
  constr.gridx=1;
  constr.weightx=1;
  JPanel targetPackagePanel=new JPanel(new BorderLayout());
  targetPackagePanel.add(myTargetPackageField,BorderLayout.CENTER);
  panel.add(targetPackagePanel,constr);
  constr.gridx=0;
  constr.gridwidth=GridBagConstraints.REMAINDER;
  panel.add(myGenerateBeforeBox,constr);
  panel.add(myGenerateAfterBox,constr);
  panel.add(new JLabel("Select methods to create tests for:"),constr);
  panel.add(new JScrollPane(myMembersTable),constr);
  return panel;
}
