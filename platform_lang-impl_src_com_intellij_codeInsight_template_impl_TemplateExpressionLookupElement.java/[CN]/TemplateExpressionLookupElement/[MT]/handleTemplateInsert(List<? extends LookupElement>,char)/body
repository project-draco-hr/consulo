{
  final InsertionContext context=createInsertionContext(this,myState.getPsiFile(),elements,myState.getEditor(),completionChar);
  new WriteCommandAction(context.getProject()){
    @Override protected void run(    @NotNull Result result) throws Throwable {
      doHandleInsert(context);
    }
  }
.execute();
  Disposer.dispose(context.getOffsetMap());
  if (handleCompletionChar(context) && !myState.isFinished()) {
    myState.calcResults(true);
    myState.considerNextTabOnLookupItemSelected(getDelegate());
  }
}
