{
  final InsertionContext context=createInsertionContext(this,myState.getPsiFile(),elements,myState.getEditor(),completionChar);
  new WriteCommandAction(context.getProject()){
    @Override protected void run(    Result result) throws Throwable {
      handleInsert(context);
    }
  }
.execute();
  Disposer.dispose(context.getOffsetMap());
}
