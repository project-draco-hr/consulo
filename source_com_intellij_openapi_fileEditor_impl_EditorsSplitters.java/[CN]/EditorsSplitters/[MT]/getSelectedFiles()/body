{
  final ArrayListSet<VirtualFile> files=new ArrayListSet<VirtualFile>();
  for (Iterator<EditorWindow> iterator=myWindows.iterator(); iterator.hasNext(); ) {
    final EditorWindow window=iterator.next();
    final VirtualFile file=window.getSelectedFile();
    if (file != null) {
      files.add(file);
    }
  }
  final VirtualFile[] virtualFiles=files.toArray(new VirtualFile[files.size()]);
  final VirtualFile currentFile=getCurrentFile();
  if (currentFile != null) {
    for (int i=0; i != virtualFiles.length; ++i) {
      if (virtualFiles[i] == currentFile) {
        virtualFiles[i]=virtualFiles[0];
        virtualFiles[0]=currentFile;
        break;
      }
    }
  }
  return virtualFiles;
}
