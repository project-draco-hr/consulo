{
  enableSilentOperation(VcsConfiguration.StandardConfirmation.ADD);
  final VirtualFile file=createFileInCommand("a.txt","old content");
  final ChangeListManager changeListManager=ChangeListManager.getInstance(myProject);
  changeListManager.ensureUpToDate(false);
  final LocalChangeList list=changeListManager.addChangeList("test",null);
  changeListManager.moveChangesTo(list,new Change[]{changeListManager.getChange(file)});
  final String newName="renamed";
  myScheme.doTest(new Runnable(){
    @Override public void run(){
      changeListManager.editName(list.getName(),newName);
      checkFilesAreInList(new VirtualFile[]{file},newName,changeListManager);
    }
  }
);
  checkFilesAreInList(new VirtualFile[]{file},newName,changeListManager);
  changeListManager.ensureUpToDate(false);
  checkFilesAreInList(new VirtualFile[]{file},newName,changeListManager);
}
