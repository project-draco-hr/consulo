{
  super(project);
  setTitle("Migrate CVS Root");
  final File file=CvsVfsUtil.getFileFor(directory);
  final String root=CvsUtil.loadRootFrom(file);
  myRadioButton1=new JRadioButton(CvsBundle.message("migrate.replace.if.root.equals.label",root));
  myRadioButton1.setSelected(true);
  final ButtonGroup group=new ButtonGroup();
  group.add(myRadioButton1);
  group.add(myRadioButton2);
  myDirectoryField.setText(directory.getPath());
  final FileChooserDescriptor descriptor=new FileChooserDescriptor(false,true,false,false,false,false){
    @Override public void validateSelectedFiles(    VirtualFile[] files) throws Exception {
      for (      VirtualFile vFile : files) {
        final File file=CvsVfsUtil.getFileFor(vFile);
        final String root=CvsUtil.loadRootFrom(file);
        if (root == null) {
          throw new Exception(CvsBundle.message("error.message.directory.is.not.under.cvs"));
        }
      }
    }
  }
;
  descriptor.setRoots(ProjectRootManager.getInstance(project).getContentRootsFromAllModules());
  myDirectoryField.addBrowseFolderListener("Select directory to migrate to a new CVS root","",project,descriptor);
  FileChooserFactory.getInstance().installFileCompletion(myDirectoryField.getChildComponent(),descriptor,true,getDisposable());
  myDirectoryField.getTextField().getDocument().addDocumentListener(new DocumentListener(){
    @Override public void insertUpdate(    DocumentEvent e){
      enableOKActionConditionally();
    }
    @Override public void removeUpdate(    DocumentEvent e){
      enableOKActionConditionally();
    }
    @Override public void changedUpdate(    DocumentEvent e){
      enableOKActionConditionally();
    }
  }
);
  myCvsConfigurationPanel=new SelectCvsConfigurationPanel(project);
  if (SystemInfo.isMac) {
    myCvsConfigurationPanel.setBorder(new EmptyBorder(2,3,2,0));
  }
  myListener=new ListSelectionListener(){
    @Override public void valueChanged(    ListSelectionEvent e){
      enableOKActionConditionally();
    }
  }
;
  myCvsConfigurationPanel.addListSelectionListener(myListener);
  setOKButtonText("Migrate");
  init();
}
