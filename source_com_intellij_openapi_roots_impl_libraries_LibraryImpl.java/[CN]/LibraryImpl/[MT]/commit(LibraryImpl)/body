{
  if (myLibraryTable != null) {
    ApplicationManager.getApplication().assertWriteAccessAllowed();
  }
 else   if (myRootModel != null) {
    LOG.assertTrue(myRootModel.isWritable());
  }
  final boolean sameName=Comparing.equal(model.myName,myName);
  boolean sameRoots=true;
  for (  final OrderRootType rootType : SERIALIZABLE_ROOT_TYPES) {
    final VirtualFilePointerContainer container=myRoots.get(rootType);
    final VirtualFilePointerContainer thatContainer=model.myRoots.get(rootType);
    sameRoots=Arrays.equals(container.getUrls(),thatContainer.getUrls());
    if (!sameRoots)     break;
  }
  final boolean isChanged=sameName && sameRoots;
  if (isChanged)   return;
  if (!sameName) {
    myName=model.myName;
    if (myLibraryTable instanceof LibraryTableBase) {
      ((LibraryTableBase)myLibraryTable).fireLibraryRenamed(this);
    }
  }
  if (!sameRoots) {
    myRoots=model.myRoots;
    myRootProvider.fireRootSetChanged();
  }
}
