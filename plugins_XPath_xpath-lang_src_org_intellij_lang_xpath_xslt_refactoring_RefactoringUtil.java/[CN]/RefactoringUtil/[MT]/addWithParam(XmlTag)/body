{
  XmlTag withParamTag=templateTag.createChildTag("with-param",XsltSupport.XSLT_NS,null,false);
  final XmlTag anchor=XsltCodeInsightUtil.findLastWithParam(templateTag);
  final PsiElement c;
  if (anchor != null) {
    withParamTag=(XmlTag)templateTag.addAfter(withParamTag,anchor);
  }
 else   if ((c=XsltCodeInsightUtil.findFirstRealTagChild(templateTag)) != null) {
    withParamTag=(XmlTag)templateTag.addBefore(withParamTag,c);
  }
 else {
    withParamTag=(XmlTag)templateTag.add(withParamTag);
  }
  withParamTag=(XmlTag)withParamTag.getManager().getCodeStyleManager().reformat(withParamTag);
  return withParamTag;
}
