{
  root.doCreateDirectory(1,p("dir"));
  root.doCreateFile(2,p("dir/file"),"a");
  Change c=new ChangeFileContentChange(p("dir/file"),"b");
  c.applyTo(root);
  root.doRename(p("dir/file"),"new file");
  root.doChangeFileContent(p("dir/new file"),"c");
  List<Difference> d1=c.getDifferences(root,root.getEntry(p("dir/new file")));
  assertEquals(1,d1.size());
  assertTrue(d1.get(0).isModified());
  assertEquals("file",d1.get(0).getOlderEntry().getName());
  assertEquals("b",d1.get(0).getOlderEntry().getContent());
  assertEquals("new file",d1.get(0).getCurrentEntry().getName());
  assertEquals("c",d1.get(0).getCurrentEntry().getContent());
  List<Difference> d2=c.getDifferences(root,root.getEntry(p("dir")));
  assertEquals(1,d2.size());
  assertTrue(d2.get(0).isModified());
  assertEquals("file",d2.get(0).getOlderEntry().getName());
  assertEquals("b",d2.get(0).getOlderEntry().getContent());
  assertEquals("new file",d2.get(0).getCurrentEntry().getName());
  assertEquals("c",d2.get(0).getCurrentEntry().getContent());
}
