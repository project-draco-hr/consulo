{
  root.doCreateDirectory(1,p("dir1"));
  root.doCreateDirectory(2,p("dir2"));
  root.doCreateFile(3,p("dir1/file"),"content");
  Change c=new MoveChange(p("dir1/file"),p("dir2"));
  c.applyTo(root);
  root.doRename(3,"new file");
  root.doChangeFileContent(3,"new content");
  List<Difference> d1=c.getDifferences(root,root.getEntry(p("dir1")));
  assertEquals(1,d1.size());
  assertTrue(d1.get(0).isDeleted());
  List<Difference> d2=c.getDifferences(root,root.getEntry(p("dir2")));
  assertEquals(1,d2.size());
  assertTrue(d2.get(0).isCreated());
  List<Difference> d3=c.getDifferences(root,root.getEntry(p("dir2/new file")));
  assertEquals(1,d3.size());
  assertTrue(d3.get(0).isModified());
}
