{
  myLock=new Object();
  myUpdateStuff=createUpdateStuff();
  myUpdater=new ZipperUpdater(ApplicationManager.getApplication().isUnitTestMode() ? 10 : 300,Alarm.ThreadToUse.POOLED_THREAD,project);
  myConnection=project.getMessageBus().connect();
  myLocalFileSystem=LocalFileSystem.getInstance();
  VcsAnnotationRefresher handler=createHandler();
  myDirtyPaths=new HashSet<String>();
  myDirtyChanges=new HashMap<String,VcsRevisionNumber>();
  myDirtyFiles=new HashSet<VirtualFile>();
  myFileAnnotationMap=MultiMap.createSet();
  myVcsManager=vcsManager;
  myVcsKeySet=new HashSet<VcsKey>();
  myConnection.subscribe(VcsAnnotationRefresher.LOCAL_CHANGES_CHANGED,handler);
}
