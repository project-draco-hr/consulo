{
  final VirtualFile left=findFile(args[1]);
  final VirtualFile right=findFile(args[2]);
  final VirtualFile middle=findFile(args[3]);
  final VirtualFile result=findOrCreateFile(args.length == 4 ? args[3] : args[4]);
  MergeRequest request=DiffRequestFactory.getInstance().createMergeRequest(getText(left),getText(right),getText(middle),result,ProjectManager.getInstance().getDefaultProject(),ActionButtonPresentation.APPLY,ActionButtonPresentation.CANCEL_WITH_PROMPT);
  request.addHint(DiffTool.HINT_SHOW_MODAL_DIALOG);
  request.setWindowTitle("Merge");
  request.setVersionTitles(new String[]{left.getPresentableUrl(),result.getPresentableUrl(),middle.getPresentableUrl()});
  DiffManager.getInstance().getDiffTool().show(request);
  FileDocumentManager.getInstance().saveAllDocuments();
}
