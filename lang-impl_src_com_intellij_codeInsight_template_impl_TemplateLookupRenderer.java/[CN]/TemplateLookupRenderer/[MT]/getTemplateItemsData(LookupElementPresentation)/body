{
  TemplateItemsData data=presentation.getUserData(KEY);
  if (data == null) {
    data=new TemplateItemsData();
    presentation.putUserData(KEY,data);
    for (    LookupItem item : presentation.getItems()) {
      if (!(item.getObject() instanceof Template)) {
        data.hasNonTemplates=true;
        break;
      }
 else {
        Template template=(Template)item.getObject();
        final String description=template.getDescription();
        if (description != null) {
          data.maxTemplateDescriptionLength=Math.max(data.maxTemplateDescriptionLength,description.length());
        }
      }
    }
  }
  return data;
}
