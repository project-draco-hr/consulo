{
  TaskManagerImpl manager=(TaskManagerImpl)TaskManager.getManager(myProject);
  if (mySelectedTask == null) {
    String taskName=getTaskName();
    String lastId=null;
    for (    final TaskRepository repository : manager.getAllRepositories()) {
      final String id=repository.extractId(taskName);
      if (id != null) {
        lastId=id;
        ProgressManager.getInstance().runProcessWithProgressSynchronously(new Runnable(){
          public void run(){
            try {
              mySelectedTask=repository.findTask(id);
            }
 catch (            Exception e) {
            }
          }
        }
,"Getting " + id + " from "+ repository.getPresentableName()+ "...",true,myProject);
      }
      if (mySelectedTask != null) {
        break;
      }
    }
    if (lastId == null) {
      mySelectedTask=manager.createLocalTask(taskName);
    }
 else     if (mySelectedTask == null) {
      if (Messages.showOkCancelDialog(myProject,"Issue " + lastId + " not found.\n"+ "Do you want to create local task?","Issue Not Found",CommonBundle.getNoButtonText(),CommonBundle.getYesButtonText(),Messages.getQuestionIcon()) == DialogWrapper.OK_EXIT_CODE) {
        return;
      }
      mySelectedTask=manager.createLocalTask(taskName);
    }
  }
  manager.getState().markAsInProgress=myMarkAsInProgressBox.isSelected();
  super.doOKAction();
}
