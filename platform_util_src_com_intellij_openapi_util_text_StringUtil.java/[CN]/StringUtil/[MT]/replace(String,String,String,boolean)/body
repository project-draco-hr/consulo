{
  if (text.length() < oldS.length())   return text;
  final String text1=ignoreCase ? text.toLowerCase() : text;
  final String oldS1=ignoreCase ? oldS.toLowerCase() : oldS;
  StringBuilder newText=null;
  int i=0;
  while (i < text1.length()) {
    int i1=text1.indexOf(oldS1,i);
    if (i1 < 0) {
      if (i == 0)       return text;
      newText.append(text,i,text.length());
      break;
    }
 else {
      if (newS == null)       return null;
      if (newText == null)       newText=new StringBuilder();
      newText.append(text,i,i1);
      newText.append(newS);
      i=i1 + oldS.length();
    }
  }
  return newText != null ? newText.toString() : "";
}
