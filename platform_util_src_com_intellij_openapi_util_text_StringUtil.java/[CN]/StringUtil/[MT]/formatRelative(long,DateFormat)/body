{
  long minDelta=(new Date().getTime() - timestamp) / (1000 * 60);
  if (minDelta < 2) {
    return CommonBundle.message("format.date.momentsAgo");
  }
  if (minDelta < 10) {
    return CommonBundle.message("format.date.fewMinutesAgo");
  }
  if (minDelta <= 30) {
    return CommonBundle.message("format.date.last30Minutes");
  }
  int hoursDelta=Math.round(minDelta / 60f);
  if (hoursDelta <= 1) {
    return CommonBundle.message("format.date.lastHour");
  }
  if (hoursDelta < 5) {
    return CommonBundle.message("format.date.hoursAgo",hoursDelta);
  }
  return format.format(timestamp);
}
