{
  myProject=project;
  myContentManager=contentManager;
  myShelveChangesManager=shelveChangesManager;
  bus.connect().subscribe(ShelveChangesManager.SHELF_TOPIC,new ChangeListener(){
    public void stateChanged(    ChangeEvent e){
      ApplicationManager.getApplication().invokeLater(new Runnable(){
        public void run(){
          updateChangesContent();
        }
      }
,ModalityState.NON_MODAL);
    }
  }
);
  myTree.setRootVisible(false);
  myTree.setShowsRootHandles(true);
  myTree.setCellRenderer(new ShelfTreeCellRenderer());
  final CustomShortcutSet diffShortcut=new CustomShortcutSet(KeyStroke.getKeyStroke(KeyEvent.VK_D,SystemInfo.isMac ? KeyEvent.META_DOWN_MASK : KeyEvent.CTRL_DOWN_MASK));
  ActionManager.getInstance().getAction("ChangesView.Diff").registerCustomShortcutSet(diffShortcut,myTree);
  PopupHandler.installPopupHandler(myTree,"ShelvedChangesPopupMenu",ActionPlaces.UNKNOWN);
}
