{
  myUpdatePending=false;
  final List<ShelvedChangeList> changes=myShelveChangesManager.getShelvedChangeLists();
  if (changes.size() == 0) {
    if (myContent != null) {
      myContentManager.removeContent(myContent);
    }
    myContent=null;
  }
 else {
    if (myContent == null) {
      myContent=PeerFactory.getInstance().getContentFactory().createContent(new JScrollPane(myTree),VcsBundle.message("shelf.tab"),false);
      myContent.setCloseable(false);
      myContentManager.addContent(myContent);
    }
    TreeState state=TreeState.createOn(myTree);
    myTree.setModel(buildChangesModel());
    state.applyTo(myTree);
    if (myPostUpdateRunnable != null) {
      myPostUpdateRunnable.run();
    }
  }
  myPostUpdateRunnable=null;
}
