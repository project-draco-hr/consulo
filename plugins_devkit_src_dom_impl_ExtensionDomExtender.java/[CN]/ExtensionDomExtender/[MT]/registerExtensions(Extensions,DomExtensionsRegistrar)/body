{
  final XmlElement xmlElement=extensions.getXmlElement();
  if (xmlElement == null)   return new Object[0];
  final PsiManager psiManager=xmlElement.getManager();
  IdeaPlugin ideaPlugin=extensions.getParentOfType(IdeaPlugin.class,true);
  if (ideaPlugin == null)   return new Object[0];
  registerExtensions(extensions,ideaPlugin,registrar,psiManager);
  List<Object> deps=new ArrayList<Object>();
  IdeaPlugin plugin=extensions.getDefaultExtensionNs().getValue();
  if (plugin == null)   plugin=extensions.getXmlns().getValue();
  if (plugin != null) {
    registerExtensions(extensions,plugin,registrar,psiManager);
    deps.add(plugin.<DomElement>getRoot());
  }
  deps.add(ProjectRootManager.getInstance(xmlElement.getProject()));
  deps.add(ideaPlugin.getRoot());
  return deps.toArray(new Object[deps.size()]);
}
