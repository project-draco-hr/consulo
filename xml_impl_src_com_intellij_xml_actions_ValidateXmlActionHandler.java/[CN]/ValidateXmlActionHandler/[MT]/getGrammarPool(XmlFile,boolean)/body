{
  final XMLGrammarPool previousGrammarPool=file.getUserData(GRAMMAR_POOL_KEY);
  XMLGrammarPool grammarPool=null;
  if (!forceChecking && !isValidationDependentFilesOutOfDate(file)) {
    grammarPool=previousGrammarPool;
  }
  if (grammarPool == null) {
    grammarPool=new XMLGrammarPoolImpl();
    file.putUserData(GRAMMAR_POOL_KEY,grammarPool);
  }
  return grammarPool;
}
