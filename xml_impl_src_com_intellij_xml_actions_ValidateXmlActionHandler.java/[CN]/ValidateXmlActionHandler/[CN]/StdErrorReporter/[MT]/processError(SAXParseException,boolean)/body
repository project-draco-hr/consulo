{
  if (LOG.isDebugEnabled()) {
    String error=buildMessageString(ex);
    LOG.debug("enter: processError(error='" + error + "')");
  }
  myErrorsDetected=true;
  if (!ApplicationManager.getApplication().isUnitTestMode()) {
    SwingUtilities.invokeLater(new Runnable(){
      public void run(){
        final VirtualFile file=getFile(ex.getPublicId(),ex.getSystemId());
        myErrorsView.addMessage(warning ? MessageCategory.WARNING : MessageCategory.ERROR,new String[]{ex.getLocalizedMessage()},file != null ? file.getPresentableUrl() : "",file != null ? new OpenFileDescriptor(myProject,file,ex.getLineNumber() - 1,ex.getColumnNumber() - 1) : null,NewErrorTreeViewPanel.createExportPrefix(ex.getLineNumber()),NewErrorTreeViewPanel.createRendererPrefix(ex.getLineNumber(),ex.getColumnNumber()),file);
      }
    }
);
  }
}
