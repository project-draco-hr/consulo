{
  if (ourSettingsModificationCount != modificationCountForChildren) {
    resetChildren();
    modificationCountForChildren=ourSettingsModificationCount;
  }
  final Object o=unwrapValue(getValue());
  long currentStamp=-1;
  if (o instanceof StubBasedPsiElement && ((StubBasedPsiElement)o).getStub() != null) {
    currentStamp=((StubBasedPsiElement)o).getContainingFile().getModificationStamp();
  }
 else   if (o instanceof PsiElement && ((PsiElement)o).getNode() instanceof CompositeElement) {
    currentStamp=((CompositeElement)((PsiElement)o).getNode()).getModificationCount();
  }
 else   if (o instanceof ModificationTracker) {
    currentStamp=((ModificationTracker)o).getModificationCount();
  }
  if (childrenStamp != currentStamp) {
    resetChildren();
    childrenStamp=currentStamp;
  }
  try {
    return super.getChildren();
  }
 catch (  IndexNotReadyException ignore) {
    return Collections.emptyList();
  }
}
