{
  DataContext dataContext=e.getDataContext();
  final Project project=PlatformDataKeys.PROJECT.getData(dataContext);
  if (project == null)   return;
  if (myPopup != null && myPopup.isVisible())   return;
  final DefaultListModel model=buildModel(project);
  final JBList list=new JBList(model);
  list.getEmptyText().setText("No Bookmarks");
  EditBookmarkDescriptionAction editDescriptionAction=new EditBookmarkDescriptionAction(project,list);
  DefaultActionGroup actions=new DefaultActionGroup();
  actions.add(editDescriptionAction);
  actions.add(new DeleteBookmarkAction(project,list));
  actions.add(new MoveBookmarkUpAction(project,list));
  actions.add(new MoveBookmarkDownAction(project,list));
  myPopup=new MasterDetailPopupBuilder(project).setActionsGroup(actions).setList(list).setDetailView(new DetailViewImpl(project)).setCloseOnEnter(false).setDoneRunnable(new Runnable(){
    @Override public void run(){
      myPopup.cancel();
    }
  }
).setDelegate(this).createMasterDetailPopup();
  new AnAction(){
    @Override public void actionPerformed(    AnActionEvent e){
      Object selectedValue=list.getSelectedValue();
      if (selectedValue instanceof BookmarkItem) {
        itemChosen((BookmarkItem)selectedValue,project,myPopup,true);
      }
    }
  }
.registerCustomShortcutSet(CommonShortcuts.getEditSource(),list);
  editDescriptionAction.setPopup(myPopup);
  myPopup.showCenteredInCurrentWindow(project);
  list.setSelectionMode(ListSelectionModel.MULTIPLE_INTERVAL_SELECTION);
}
