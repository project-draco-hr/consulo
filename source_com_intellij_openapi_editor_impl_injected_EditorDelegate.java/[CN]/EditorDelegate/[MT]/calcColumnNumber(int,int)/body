{
  if (myDocument.getTextLength() == 0)   return 0;
  CharSequence text=myDocument.getCharsSequence();
  int start=myDocument.getLineStartOffset(lineIndex);
  if (offset == 0)   return 0;
  int end=myDocument.getLineEndOffset(lineIndex);
  if (offset > end - start)   offset=end - start;
  return EditorUtil.calcColumnNumber(this,text,start,start + offset,myDelegate.getTabSize());
}
