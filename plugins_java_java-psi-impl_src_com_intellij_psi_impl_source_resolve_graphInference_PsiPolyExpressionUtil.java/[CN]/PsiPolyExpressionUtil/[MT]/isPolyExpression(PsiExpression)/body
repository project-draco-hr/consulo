{
  if (expression instanceof PsiLambdaExpression || expression instanceof PsiMethodReferenceExpression) {
    return true;
  }
 else   if (expression instanceof PsiParenthesizedExpression) {
    return isPolyExpression(((PsiParenthesizedExpression)expression).getExpression());
  }
 else   if (expression instanceof PsiNewExpression) {
    final PsiJavaCodeReferenceElement classReference=((PsiNewExpression)expression).getClassReference();
    if (classReference != null) {
      final PsiReferenceParameterList parameterList=classReference.getParameterList();
      if (parameterList != null) {
        final PsiTypeElement[] typeElements=parameterList.getTypeParameterElements();
        if (typeElements.length == 1 && typeElements[0].getType() instanceof PsiDiamondType) {
          return isInAssignmentOrInvocationContext(expression);
        }
      }
    }
  }
 else   if (expression instanceof PsiMethodCallExpression) {
    return isMethodCallPolyExpression(expression,((PsiMethodCallExpression)expression).resolveMethod());
  }
 else   if (expression instanceof PsiConditionalExpression) {
    final ConditionalKind conditionalKind=isBooleanOrNumeric(expression);
    if (conditionalKind == null) {
      return isInAssignmentOrInvocationContext(expression);
    }
  }
  return false;
}
