{
  if (expr instanceof PsiParenthesizedExpression) {
    return isBooleanOrNumeric(((PsiParenthesizedExpression)expr).getExpression());
  }
  PsiType type=null;
  if (expr instanceof PsiNewExpression || hasStandaloneForm(expr)) {
    type=expr.getType();
  }
 else   if (expr instanceof PsiMethodCallExpression) {
    final PsiMethod method=((PsiMethodCallExpression)expr).resolveMethod();
    if (method != null) {
      type=method.getReturnType();
    }
  }
  if (TypeConversionUtil.isNumericType(type))   return ConditionalKind.NUMERIC;
  if (TypeConversionUtil.isBooleanType(type))   return ConditionalKind.BOOLEAN;
  if (expr instanceof PsiConditionalExpression) {
    final PsiExpression thenExpression=((PsiConditionalExpression)expr).getThenExpression();
    final PsiExpression elseExpression=((PsiConditionalExpression)expr).getElseExpression();
    final ConditionalKind thenKind=isBooleanOrNumeric(thenExpression);
    final ConditionalKind elseKind=isBooleanOrNumeric(elseExpression);
    if (thenKind == elseKind)     return thenKind;
  }
  return null;
}
