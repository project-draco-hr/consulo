{
  Object obj=null;
  if (node instanceof Element) {
    String id=((Element)node).getAttribute("id");
    obj=dec.objects.get(id);
    if (obj == null) {
      obj=into;
      if (obj == null) {
        obj=cloneTemplate(node);
      }
      if (id != null && id.length() > 0) {
        dec.putObject(id,obj);
      }
    }
    node=node.getFirstChild();
    while (node != null) {
      if (!processInclude(dec,node,obj) && node.getNodeName().equals("add") && node instanceof Element) {
        String as=((Element)node).getAttribute("as");
        if (as != null && as.length() > 0) {
          String extend=((Element)node).getAttribute("extend");
          Map<String,Object> style=(extend != null) ? ((mxStylesheet)obj).getStyles().get(extend) : null;
          if (style == null) {
            style=new Hashtable<String,Object>();
          }
 else {
            style=new Hashtable<String,Object>(style);
          }
          Node entry=node.getFirstChild();
          while (entry != null) {
            if (entry instanceof Element) {
              Element entryElement=(Element)entry;
              String key=entryElement.getAttribute("as");
              if (entry.getNodeName().equals("add")) {
                String text=entry.getTextContent();
                Object value=null;
                if (text != null && text.length() > 0) {
                  value=mxUtils.eval(text);
                }
 else {
                  value=entryElement.getAttribute("value");
                }
                if (value != null) {
                  style.put(key,value);
                }
              }
 else               if (entry.getNodeName().equals("remove")) {
                style.remove(key);
              }
            }
            entry=entry.getNextSibling();
          }
          ((mxStylesheet)obj).putCellStyle(as,style);
        }
      }
      node=node.getNextSibling();
    }
  }
  return obj;
}
