{
  PsiJavaCodeReferenceElement ref=expression.getQualifier();
  if (ref != null) {
    PsiElement element=ref.resolve();
    if (element instanceof PsiClass) {
      PsiClass aClass=(PsiClass)element;
      if (myClassSuperClasses.contains(aClass)) {
        visitExplicitThis(aClass,expression);
      }
      if (aClass.isInheritor(getPsiClass(),true)) {
        myClassSuperClasses.add(aClass);
        visitExplicitThis(aClass,expression);
      }
    }
    ref.accept(this);
  }
 else {
    PsiClass containingClass=PsiTreeUtil.getParentOfType(expression,PsiClass.class);
    if (containingClass != null) {
      if (getPsiClass().getManager().areElementsEquivalent(getPsiClass(),containingClass)) {
        visitExplicitThis(getPsiClass(),expression);
      }
    }
  }
}
