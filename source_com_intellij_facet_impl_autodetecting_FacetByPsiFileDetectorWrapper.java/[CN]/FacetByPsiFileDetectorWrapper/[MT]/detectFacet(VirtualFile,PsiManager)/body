{
  PsiFile psiFile=psiManager.findFile(virtualFile);
  if (psiFile == null || !myPsiFileFilter.value(psiFile)) {
    return null;
  }
  Module module=ModuleUtil.findModuleForFile(virtualFile,psiManager.getProject());
  if (module == null)   return null;
  return detectFacet(module,virtualFile,psiFile);
}
