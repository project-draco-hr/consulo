{
  final ArrayList<TreeElement> result=new ArrayList<TreeElement>();
  final DomElementVisitor elementVisitor=new DomElementVisitor(){
    public void visitDomElement(    final DomElement element){
      final DomService.StructureViewMode viewMode=myDescriptor.fun(element);
switch (viewMode) {
case SHOW:
        result.add(new DomStructureTreeElement(element,myDescriptor,myNavigationProvider));
      break;
case SHOW_CHILDREN:
    DomUtil.acceptAvailableChildren(element,this);
  break;
case SKIP:
break;
}
}
}
;
DomUtil.acceptAvailableChildren(myElement,elementVisitor);
return result.toArray(new TreeElement[result.size()]);
}
