{
  tree.addMouseListener(new MouseAdapter(){
    public void mouseClicked(    MouseEvent e){
      if (e.getClickCount() != 2)       return;
      if (tree.getPathForLocation(e.getX(),e.getY()) == null)       return;
      DataContext dataContext=DataManager.getInstance().getDataContext(tree);
      Project project=DataKeys.PROJECT.getData(dataContext);
      if (project == null)       return;
      final TreePath selectionPath=tree.getSelectionPath();
      if (selectionPath == null)       return;
      final Object lastPathComponent=selectionPath.getLastPathComponent();
      if (((TreeNode)lastPathComponent).isLeaf() || !expandOnDoubleClick(((TreeNode)lastPathComponent))) {
        OpenSourceUtil.openSourcesFrom(dataContext,true);
      }
    }
    private boolean expandOnDoubleClick(    final TreeNode treeNode){
      if (treeNode instanceof DefaultMutableTreeNode) {
        final Object userObject=((DefaultMutableTreeNode)treeNode).getUserObject();
        if (userObject instanceof NodeDescriptor) {
          return ((NodeDescriptor)userObject).expandOnDoubleClick();
        }
      }
      return true;
    }
  }
);
}
