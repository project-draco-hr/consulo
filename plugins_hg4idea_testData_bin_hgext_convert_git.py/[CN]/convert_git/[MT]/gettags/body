def gettags(self):
    tags = {}
    fh = self.gitopen(('git ls-remote --tags "%s"' % self.path))
    prefix = 'refs/tags/'
    for line in fh:
        line = line.strip()
        if (not line.endswith('^{}')):
            continue
        (node, tag) = line.split(None, 1)
        if (not tag.startswith(prefix)):
            continue
        tag = tag[len(prefix):(-3)]
        tags[tag] = node
    if fh.close():
        raise util.Abort((_('cannot read tags from %s') % self.path))
    return tags
