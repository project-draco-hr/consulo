def getchangedfiles(self, version, i):
    changes = []
    if (i is None):
        fh = self.gitopen(('git diff-tree --root -m -r %s' % version))
        for l in fh:
            if ('\t' not in l):
                continue
            (m, f) = l[:(-1)].split('\t')
            changes.append(f)
    else:
        fh = self.gitopen(('git diff-tree --name-only --root -r %s "%s^%s" --' % (version, version, (i + 1))))
        changes = [f.rstrip('\n') for f in fh]
    if fh.close():
        raise util.Abort((_('cannot read changes in %s') % version))
    return changes
