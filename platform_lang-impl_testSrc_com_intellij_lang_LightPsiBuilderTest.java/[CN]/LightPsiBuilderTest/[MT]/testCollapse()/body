{
  doTest("a<<b",new PsiParser(){
    @NotNull public ASTNode parse(    IElementType root,    PsiBuilder builder){
      final PsiBuilder.Marker rootMarker=builder.mark();
      PsiBuilder.Marker inner=null;
      while (builder.getTokenType() != null) {
        if ("<".equals(builder.getTokenText()) && inner == null)         inner=builder.mark();
        builder.advanceLexer();
        if (!"<".equals(builder.getTokenText()) && inner != null) {
          inner.collapse(new IElementType("COLLAPSE",Language.ANY));
          inner=null;
        }
      }
      rootMarker.done(root);
      return builder.getTreeBuilt();
    }
  }
,"Element(ROOT)\n" + "  PsiElement(TOKEN)('a')\n" + "  PsiElement(COLLAPSE)('<<')\n"+ "  PsiElement(TOKEN)('b')\n");
}
