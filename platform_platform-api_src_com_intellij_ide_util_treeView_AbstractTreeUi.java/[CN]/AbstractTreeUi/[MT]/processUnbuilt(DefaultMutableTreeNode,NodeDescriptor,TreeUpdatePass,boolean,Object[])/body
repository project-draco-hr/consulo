{
  if (!isExpanded && getBuilder().isAlwaysShowPlus(descriptor)) {
    return new Pair<Boolean,Object[]>(true,null);
  }
  final Object element=getElementFor(node);
  final Object[] children=preloadedChildren != null ? preloadedChildren : getChildrenFor(element);
  boolean processed;
  if (children.length == 0) {
    removeLoading(node,true);
    processed=true;
  }
 else {
    if (isAutoExpand(node)) {
      addNodeAction(getElementFor(node),new NodeAction(){
        public void onReady(        final DefaultMutableTreeNode node){
          final TreePath path=new TreePath(node.getPath());
          if (getTree().isExpanded(path) || children.length == 0) {
            removeLoading(node,false);
          }
 else {
            maybeYeild(new ActiveRunnable(){
              public ActionCallback run(){
                expand(element,null);
                return new ActionCallback.Done();
              }
            }
,pass,node);
          }
        }
      }
,false);
    }
    processed=false;
  }
  processNodeActionsIfReady(node);
  return new Pair<Boolean,Object[]>(processed,children);
}
