{
  assertIsDispatchThread();
  if (isNodeBeingBuilt(node))   return;
  final Object o=node.getUserObject();
  if (!(o instanceof NodeDescriptor))   return;
  if (isYeildingNow()) {
    myPendingNodeActions.add(node);
    return;
  }
  final Object element=getBuilder().getTreeStructureElement((NodeDescriptor)o);
  boolean childrenReady=!isLoadedInBackground(element) && !isUpdatingChildrenNow(node);
  processActions(node,element,myNodeActions,childrenReady ? myNodeChildrenActions : null);
  if (childrenReady) {
    processActions(node,element,myNodeChildrenActions,null);
  }
  if (!isUpdatingParent(node) && !isWorkerBusy()) {
    final UpdaterTreeState state=myUpdaterState;
    if (myNodeActions.isEmpty() && state != null && !state.isProcessingNow()) {
      if (canInitiateNewActivity()) {
        if (!state.restore(childrenReady ? node : null)) {
          setUpdaterState(state);
        }
      }
    }
  }
  maybeReady();
}
