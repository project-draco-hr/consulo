{
  processInnerChange(new Runnable(){
    public void run(){
      if (path.getLastPathComponent() instanceof DefaultMutableTreeNode) {
        DefaultMutableTreeNode node=(DefaultMutableTreeNode)path.getLastPathComponent();
        if (node.getChildCount() > 0 && !myTree.isExpanded(path)) {
          if (!canSmartExpand) {
            myNotForSmartExpand.add(node);
          }
          try {
            myRequestedExpand=path;
            myTree.expandPath(path);
            processSmartExpand(node,canSmartExpand,false);
          }
  finally {
            myNotForSmartExpand.remove(node);
            myRequestedExpand=null;
          }
        }
 else {
          processNodeActionsIfReady(node);
        }
      }
    }
  }
);
}
