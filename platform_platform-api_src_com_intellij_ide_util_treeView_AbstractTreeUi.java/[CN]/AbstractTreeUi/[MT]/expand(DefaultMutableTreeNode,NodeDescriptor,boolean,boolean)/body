{
  final Alarm alarm=new Alarm(Alarm.ThreadToUse.SHARED_THREAD);
  alarm.addRequest(new Runnable(){
    public void run(){
      myTree.setCursor(Cursor.getPredefinedCursor(Cursor.WAIT_CURSOR));
    }
  }
,WAIT_CURSOR_DELAY);
  if (wasLeaf && isAutoExpand(descriptor)) {
    expand(node,canSmartExpand);
  }
  ArrayList<TreeNode> nodes=TreeUtil.childrenToArray(node);
  for (  TreeNode node1 : nodes) {
    final DefaultMutableTreeNode childNode=(DefaultMutableTreeNode)node1;
    if (isLoadingNode(childNode))     continue;
    NodeDescriptor childDescr=getDescriptorFrom(childNode);
    if (isAutoExpand(childDescr)) {
      addNodeAction(getElementFor(childNode),new NodeAction(){
        public void onReady(        DefaultMutableTreeNode node){
          expand(childNode,canSmartExpand);
        }
      }
,false);
      addSubtreeToUpdate(childNode);
    }
  }
  int n=alarm.cancelAllRequests();
  if (n == 0) {
    myTree.setCursor(Cursor.getDefaultCursor());
  }
}
