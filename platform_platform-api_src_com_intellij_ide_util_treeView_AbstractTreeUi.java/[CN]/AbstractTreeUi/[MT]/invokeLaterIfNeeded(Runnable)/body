{
  final ActionCallback result=new ActionCallback();
  Runnable actual=new Runnable(){
    public void run(){
      runnable.run();
      result.setDone();
    }
  }
;
  if (isPassthroughMode() || (!isEdt() && !isTreeShowing())) {
    actual.run();
  }
 else {
    UIUtil.invokeLaterIfNeeded(actual);
  }
  return result;
}
