{
  AbstractTreeStructure treeStructure=getTreeStructure();
  ActionCallback result=treeStructure.asyncCommit();
  result.doWhenDone(new Runnable(){
    @Override public void run(){
      try {
        removeFromCancelled(node);
        execute(new Runnable(){
          @Override public void run(){
            doUpdateChildren(node,pass,loadedChildren,forcedNow,toSmartExpand,forceUpdate,descriptorIsUpToDate,updateChildren);
          }
        }
);
      }
 catch (      ProcessCanceledException e) {
        addToCancelled(node);
        throw e;
      }
    }
  }
);
  return result;
}
