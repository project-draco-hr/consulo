{
  if (isReleased())   return new ActionCallback.Rejected();
  setCancelRequested(true);
  final ActionCallback done=new ActionCallback();
  invokeLaterIfNeeded(false,new Runnable(){
    @Override public void run(){
      if (isReleased()) {
        done.setRejected();
        return;
      }
      if (myResettingToReadyNow.get()) {
        _getReady().notify(done);
      }
 else       if (isReady()) {
        resetToReadyNow();
        done.setDone();
      }
 else {
        if (isIdle() && hasPendingWork()) {
          resetToReadyNow();
          done.setDone();
        }
 else {
          _getReady().notify(done);
        }
      }
      maybeReady();
    }
  }
);
  if (isEdt() || isPassthroughMode()) {
    maybeReady();
  }
  return done;
}
