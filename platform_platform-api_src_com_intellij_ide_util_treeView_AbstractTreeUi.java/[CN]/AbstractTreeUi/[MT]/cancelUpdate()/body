{
  assertIsDispatchThread();
  final ActionCallback done=new ActionCallback();
  if (myResettingToReadyNow.get()) {
    getReady(this).notify(done);
  }
 else   if (isReady()) {
    resetToReadyNow();
    done.setDone();
  }
 else {
    if (isIdle() && hasPendingWork()) {
      resetToReadyNow();
      done.setDone();
    }
 else {
      requestCancel();
      getReady(this).notify(done);
    }
  }
  maybeReady();
  return done;
}
