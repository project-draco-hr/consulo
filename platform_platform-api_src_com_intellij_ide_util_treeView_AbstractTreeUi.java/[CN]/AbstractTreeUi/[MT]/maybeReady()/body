{
  assertIsDispatchThread();
  if (isReleased())   return;
  if (isReady()) {
    if (isReleaseRequested()) {
      releaseNow();
      return;
    }
    if (myTree.isShowing() || myUpdateIfInactive) {
      myInitialized.setDone();
    }
    if (myUpdaterState != null && !myUpdaterState.isProcessingNow()) {
      UpdaterTreeState oldState=myUpdaterState;
      if (!myUpdaterState.restore(null)) {
        setUpdaterState(oldState);
      }
      if (!isReady()) {
        return;
      }
    }
    setHoldSize(false);
    if (myTree.isShowing()) {
      if (getBuilder().isToEnsureSelectionOnFocusGained() && Registry.is("ide.tree.ensureSelectionOnFocusGained")) {
        TreeUtil.ensureSelection(myTree);
      }
    }
    if (myInitialized.isDone()) {
      myBusyObject.onReady();
    }
  }
}
