{
  final Object element=getElementFor(toExpand);
  if (element == null) {
    runDone(onDone);
    return;
  }
  addNodeAction(element,new NodeAction(){
    public void onReady(    final DefaultMutableTreeNode node){
      if (node.getChildCount() >= 0 && !myTree.isExpanded(new TreePath(node.getPath()))) {
        expand(node);
      }
      if (expandIndex < 0) {
        runDone(onDone);
        return;
      }
      final DefaultMutableTreeNode nextNode=getNodeForElement(kidsToExpand.get(expandIndex),false);
      if (nextNode != null) {
        processExpand(nextNode,kidsToExpand,expandIndex - 1,onDone);
      }
 else {
        runDone(onDone);
      }
    }
  }
);
  expand(toExpand);
}
