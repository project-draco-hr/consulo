{
  myBuilder=builder;
  myTree=tree;
  myTreeModel=treeModel;
  TREE_NODE_WRAPPER=getBuilder().createSearchingTreeNodeWrapper();
  myTree.setModel(myTreeModel);
  setRootNode((DefaultMutableTreeNode)treeModel.getRoot());
  setTreeStructure(treeStructure);
  myNodeDescriptorComparator=comparator;
  myUpdateIfInactive=updateIfInactive;
  myExpansionListener=new MyExpansionListener();
  myTree.addTreeExpansionListener(myExpansionListener);
  mySelectionListener=new MySelectionListener();
  myTree.addTreeSelectionListener(mySelectionListener);
  myTree.addComponentListener(new ComponentAdapter(){
    @Override public void componentResized(    ComponentEvent e){
      super.componentResized(e);
    }
    @Override public void componentMoved(    ComponentEvent e){
      super.componentMoved(e);
    }
    @Override public void componentShown(    ComponentEvent e){
      super.componentShown(e);
    }
    @Override public void componentHidden(    ComponentEvent e){
      super.componentHidden(e);
    }
  }
);
  setUpdater(getBuilder().createUpdater());
  myProgress=getBuilder().createProgressIndicator();
  Disposer.register(getBuilder(),getUpdater());
  final UiNotifyConnector uiNotify=new UiNotifyConnector(tree,new Activatable(){
    public void showNotify(){
      if (!isReleased()) {
        AbstractTreeUi.this.showNotify();
      }
    }
    public void hideNotify(){
      if (!isReleased()) {
        AbstractTreeUi.this.hideNotify();
      }
    }
  }
);
  Disposer.register(getBuilder(),uiNotify);
  myTree.addFocusListener(myFocusListener);
}
