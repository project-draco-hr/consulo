{
  MutualMap<Object,Integer> elementToIndexMap=new MutualMap<Object,Integer>(true);
  final Object element=getBuilder().getTreeStructureElement(descriptor);
  if (!isValid(element))   return elementToIndexMap;
  List<Object> children=preloadedChildren != null ? preloadedChildren.getElements() : Arrays.asList(getChildrenFor(element));
  int index=0;
  for (  Object child : children) {
    if (!isValid(child))     continue;
    elementToIndexMap.put(child,Integer.valueOf(index));
    index++;
  }
  return elementToIndexMap;
}
