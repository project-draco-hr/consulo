{
  if (isReleased())   return new ActionCallback.Rejected();
  assertIsDispatchThread();
  DefaultMutableTreeNode[] uc=myUpdatingChildren.toArray(new DefaultMutableTreeNode[myUpdatingChildren.size()]);
  for (  DefaultMutableTreeNode each : uc) {
    resetIncompleteNode(each);
  }
  Object[] bg=myLoadedInBackground.keySet().toArray(new Object[myLoadedInBackground.size()]);
  for (  Object each : bg) {
    final DefaultMutableTreeNode node=getNodeForElement(each,false);
    if (node != null) {
      resetIncompleteNode(node);
    }
  }
  myUpdaterState=null;
  getUpdater().reset();
  myYieldingNow=false;
  myYieldingPasses.clear();
  myYieldingDoneRunnables.clear();
  myNodeActions.clear();
  myNodeChildrenActions.clear();
  myUpdatingChildren.clear();
  myLoadedInBackground.clear();
  myDeferredExpansions.clear();
  myDeferredSelections.clear();
  ActionCallback result=_getReady();
  result.doWhenDone(new Runnable(){
    public void run(){
      myResettingToReadyNow.set(false);
      setCancelRequested(false);
    }
  }
);
  maybeReady();
  return result;
}
