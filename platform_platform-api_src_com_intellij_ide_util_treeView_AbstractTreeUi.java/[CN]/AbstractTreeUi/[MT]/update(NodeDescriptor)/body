{
  final AsyncResult<Boolean> result=new AsyncResult<Boolean>();
  Object element=getElementFromDescriptor(nodeDescriptor);
  boolean bgLoading=getTreeStructure().isToBuildChildrenInBackground(element);
  boolean edt=isEdt();
  if (bgLoading) {
    if (edt) {
      final Ref<Boolean> changes=new Ref<Boolean>(false);
      queueToBackground(new Runnable(){
        public void run(){
          changes.set(getBuilder().updateNodeDescriptor(nodeDescriptor));
        }
      }
,new Runnable(){
        public void run(){
          result.setDone(changes.get());
        }
      }
,null);
    }
 else {
      result.setDone(getBuilder().updateNodeDescriptor(nodeDescriptor));
    }
  }
 else {
    if (edt || !myWasEverShown) {
      result.setDone(getBuilder().updateNodeDescriptor(nodeDescriptor));
    }
 else {
      UIUtil.invokeLaterIfNeeded(new Runnable(){
        public void run(){
          if (!isReleased()) {
            result.setDone(getBuilder().updateNodeDescriptor(nodeDescriptor));
          }
 else {
            result.setRejected();
          }
        }
      }
);
    }
  }
  return result;
}
