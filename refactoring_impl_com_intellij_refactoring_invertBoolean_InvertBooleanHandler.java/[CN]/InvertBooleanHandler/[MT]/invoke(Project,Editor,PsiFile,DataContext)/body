{
  editor.getScrollingModel().scrollToCaret(ScrollType.MAKE_VISIBLE);
  PsiElement element=(PsiElement)dataContext.getData(DataConstants.PSI_ELEMENT);
  if (element instanceof PsiMethod) {
    invoke(((PsiMethod)element),project);
  }
 else   if (element instanceof PsiVariable) {
    invoke(((PsiVariable)element),project);
  }
 else {
    CommonRefactoringUtil.showErrorMessage(REFACTORING_NAME,RefactoringBundle.getCannotRefactorMessage(RefactoringBundle.message("error.wrong.caret.position.method.or.variable.name")),HelpID.INVERT_BOOLEAN,project);
  }
}
