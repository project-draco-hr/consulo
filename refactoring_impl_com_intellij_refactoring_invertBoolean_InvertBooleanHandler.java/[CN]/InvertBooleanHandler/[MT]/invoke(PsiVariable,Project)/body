{
  final PsiType returnType=var.getType();
  if (!PsiType.BOOLEAN.equals(returnType)) {
    CommonRefactoringUtil.showErrorMessage(REFACTORING_NAME,RefactoringBundle.getCannotRefactorMessage(RefactoringBundle.message("invert.boolean.wrong.type")),HelpID.INVERT_BOOLEAN,project);
    return;
  }
  if (!CommonRefactoringUtil.checkReadOnlyStatus(project,var))   return;
  if (var instanceof PsiParameter && ((PsiParameter)var).getDeclarationScope() instanceof PsiMethod) {
    final PsiMethod method=(PsiMethod)((PsiParameter)var).getDeclarationScope();
    final PsiMethod superMethod=SuperMethodWarningUtil.checkSuperMethod(method,RefactoringBundle.message("to.refactor"));
    if (superMethod != null) {
      var=superMethod.getParameterList().getParameters()[method.getParameterList().getParameterIndex((PsiParameter)var)];
    }
  }
  new InvertBooleanDialog(var).show();
}
