{
  VirtualFile f=root.createChildData(null,"f.java");
  f.setBinaryContent("old".getBytes());
  f.setBinaryContent("new".getBytes());
  f.setBinaryContent("current".getBytes());
  HistoryDialogModel m=createModelAndSelectRevisions(1,2);
  DirectoryChange c=(DirectoryChange)m.getChanges().get(0);
  DiffContent left=c.getFileDifferenceModel().getLeftDiffContent(new NullRevisionsProgress());
  DiffContent right=c.getFileDifferenceModel().getRightDiffContent(new NullRevisionsProgress());
  assertEquals("old",new String(left.getBytes()));
  assertEquals("new",new String(right.getBytes()));
  m.selectRevisions(0,1);
  c=(DirectoryChange)m.getChanges().get(0);
  right=c.getFileDifferenceModel().getRightDiffContent(new NullRevisionsProgress());
  assertEquals("current",new String(right.getBytes()));
  assertTrue(right instanceof DocumentContent);
}
