{
  VirtualFile dir=root.createChildDirectory(null,"oldDir");
  VirtualFile f=dir.createChildData(null,"f.java");
  dir.rename(null,"newDir");
  f.move(null,root);
  HistoryDialogModel m=new DirectoryHistoryDialogModel(gateway,getVcs(),dir);
  m.selectChanges(1,1);
  m.createReverter().revert();
  assertEquals("oldDir",dir.getName());
  assertEquals(dir,f.getParent());
}
