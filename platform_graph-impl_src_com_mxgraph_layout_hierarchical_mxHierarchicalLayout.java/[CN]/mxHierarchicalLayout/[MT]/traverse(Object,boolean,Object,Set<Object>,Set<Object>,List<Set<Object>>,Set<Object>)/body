{
  mxGraphView view=graph.getView();
  mxIGraphModel model=graph.getModel();
  if (vertex != null && allVertices != null) {
    if (!allVertices.contains(vertex) && (filledVertexSet == null ? true : filledVertexSet.contains(vertex))) {
      currentComp.add(vertex);
      allVertices.add(vertex);
      if (filledVertexSet != null) {
        filledVertexSet.remove(vertex);
      }
      int edgeCount=model.getEdgeCount(vertex);
      if (edgeCount > 0) {
        for (int i=0; i < edgeCount; i++) {
          Object e=model.getEdgeAt(vertex,i);
          boolean isSource=view.getVisibleTerminal(e,true) == vertex;
          if (!directed || isSource) {
            Object next=view.getVisibleTerminal(e,!isSource);
            traverse(next,directed,e,allVertices,currentComp,hierarchyVertices,filledVertexSet);
          }
        }
      }
    }
 else {
      if (!currentComp.contains(vertex)) {
        Set<Object> matchComp=null;
        for (        Set<Object> comp : hierarchyVertices) {
          if (comp.contains(vertex)) {
            currentComp.addAll(comp);
            matchComp=comp;
            break;
          }
        }
        if (matchComp != null) {
          hierarchyVertices.remove(matchComp);
        }
      }
    }
  }
}
