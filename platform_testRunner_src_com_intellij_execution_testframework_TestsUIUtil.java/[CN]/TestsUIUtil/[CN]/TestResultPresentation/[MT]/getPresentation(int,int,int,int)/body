{
  if (myRoot == null) {
    myBalloonText=myTitle=myStarted ? "Tests were interrupted" : ExecutionBundle.message("test.not.started.progress.text");
    myText="";
    myType=MessageType.WARNING;
  }
 else {
    if (failedCount > 0) {
      myTitle=ExecutionBundle.message("junit.runing.info.tests.failed.label");
      myText=passedCount + " passed, " + failedCount+ " failed"+ (notStartedCount > 0 ? ", " + notStartedCount + " not started" : "");
      myType=MessageType.ERROR;
    }
 else     if (notStartedCount > 0) {
      myTitle=ignoredCount > 0 ? "Tests Ignored" : ExecutionBundle.message("junit.running.info.failed.to.start.error.message");
      myText=passedCount + " passed, " + notStartedCount+ (ignoredCount > 0 ? " ignored" : " not started");
      myType=ignoredCount == 0 ? MessageType.WARNING : MessageType.ERROR;
    }
 else {
      myTitle=ExecutionBundle.message("junit.runing.info.tests.passed.label");
      myText=passedCount + " passed";
      myType=MessageType.INFO;
    }
    if (myComment != null) {
      myText+=" " + myComment;
    }
    myBalloonText=myTitle + ": " + myText;
  }
  return this;
}
