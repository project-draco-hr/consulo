{
  if (project.isDisposed())   return;
  if (properties == null)   return;
  final String testRunDebugId=properties.isDebug() ? ToolWindowId.DEBUG : ToolWindowId.RUN;
  final ToolWindowManager toolWindowManager=ToolWindowManager.getInstance(project);
  String title;
  String text;
  String balloonText;
  MessageType type;
  TestResultPresentation testResultPresentation=new TestResultPresentation(root).getPresentation();
  type=testResultPresentation.getType();
  balloonText=testResultPresentation.getBalloonText();
  title=testResultPresentation.getTitle();
  text=testResultPresentation.getText();
  if (!Comparing.strEqual(toolWindowManager.getActiveToolWindowId(),testRunDebugId)) {
    toolWindowManager.notifyByBalloon(testRunDebugId,type,balloonText,null,null);
  }
 else {
    Notifications.Bus.logEvent(balloonText,type.toNotificationType(),project);
  }
  SystemNotifications.getInstance().notify("TestRunner",title,text);
}
