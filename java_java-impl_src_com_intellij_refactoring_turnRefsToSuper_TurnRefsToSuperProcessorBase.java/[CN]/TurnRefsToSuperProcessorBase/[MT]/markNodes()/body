{
  for (  final PsiElement element : myElementToNode.keySet()) {
    if (element instanceof PsiExpression) {
      final PsiElement parent=element.getParent();
      if (parent instanceof PsiReferenceExpression) {
        final PsiReferenceExpression refExpr=(PsiReferenceExpression)parent;
        if (element.equals(refExpr.getQualifierExpression())) {
          final PsiElement refElement=refExpr.resolve();
          if (refElement != null && !isInSuper(refElement)) {
            markNode(element);
          }
        }
      }
    }
 else     if (!myReplaceInstanceOf && element.getParent() != null && element.getParent().getParent() instanceof PsiInstanceOfExpression) {
      markNode(element);
    }
 else     if (element.getParent() instanceof PsiClassObjectAccessExpression) {
      markNode(element);
    }
 else     if (element instanceof PsiParameter) {
      final PsiType type=((PsiParameter)element).getType();
      final PsiClass aClass=PsiUtil.resolveClassInType(type);
      if (aClass != null) {
        if (aClass instanceof PsiTypeParameter) {
          for (          Node node : myElementToNode.get(element).mySuccessors) {
            final PsiResolveHelper psiResolveHelper=JavaPsiFacade.getInstance(myProject).getResolveHelper();
            final PsiType psiType=psiResolveHelper.inferTypeForMethodTypeParameter((PsiTypeParameter)aClass,new PsiParameter[]{(PsiParameter)element},new PsiExpression[]{(PsiExpression)node.myMark.myElement},PsiSubstitutor.EMPTY,null,false);
            if (checkNode(element,PsiUtil.resolveClassInType(psiType)))             break;
          }
        }
 else {
          checkNode(element,aClass);
        }
      }
 else {
        markNode(element);
      }
    }
  }
}
