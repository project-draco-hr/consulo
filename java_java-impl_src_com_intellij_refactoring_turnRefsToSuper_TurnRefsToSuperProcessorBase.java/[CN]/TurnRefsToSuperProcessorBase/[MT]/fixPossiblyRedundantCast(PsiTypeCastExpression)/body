{
  PsiTypeElement castTypeElement=cast.getCastType();
  if (castTypeElement == null)   return;
  PsiClass castClass=PsiUtil.resolveClassInType(castTypeElement.getType());
  if (castClass == null)   return;
  PsiExpression operand=cast.getOperand();
  if (operand == null)   return;
  PsiClass operandClass=PsiUtil.resolveClassInType(RefactoringUtil.getTypeByExpression(operand));
  if (operandClass == null)   return;
  if (!castClass.getManager().areElementsEquivalent(castClass,operandClass) && !operandClass.isInheritor(castClass,true)) {
    return;
  }
  PsiExpression exprToReplace=cast;
  while (exprToReplace.getParent() instanceof PsiParenthesizedExpression) {
    exprToReplace=(PsiExpression)exprToReplace.getParent();
  }
  exprToReplace.replace(operand);
}
