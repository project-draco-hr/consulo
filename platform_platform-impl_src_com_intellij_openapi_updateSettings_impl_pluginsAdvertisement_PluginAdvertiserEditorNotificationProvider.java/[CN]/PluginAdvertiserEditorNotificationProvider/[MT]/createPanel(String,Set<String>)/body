{
  final EditorNotificationPanel panel=new EditorNotificationPanel();
  panel.setText("Plugins supporting *." + extension + " are found");
  final IdeaPluginDescriptor disabledPlugin=getDisabledPlugin(plugins);
  if (disabledPlugin != null) {
    panel.createActionLabel("Enable " + disabledPlugin.getName() + " plugin",new Runnable(){
      @Override public void run(){
        myEnabledExtensions.add(extension);
        PluginManagerCore.enablePlugin(disabledPlugin.getPluginId().getIdString());
        myNotifications.updateAllNotifications();
        PluginManagerMain.notifyPluginsWereUpdated("Plugin was successfully enabled",null);
      }
    }
);
  }
 else {
    panel.createActionLabel("Install plugins",new Runnable(){
      @Override public void run(){
        ProgressManager.getInstance().run(new Task.Modal(null,"Search for plugins in repository",true){
          private final Set<Couple<IdeaPluginDescriptor>> myPlugins=new LinkedHashSet<Couple<IdeaPluginDescriptor>>();
          private List<IdeaPluginDescriptor> myAllPlugins;
          @Override public void run(          @NotNull ProgressIndicator indicator){
            try {
              myAllPlugins=RepositoryHelper.loadPluginsFromRepository(indicator);
              for (              IdeaPluginDescriptor loadedPlugin : myAllPlugins) {
                if (plugins.contains(loadedPlugin.getPluginId().getIdString())) {
                  myPlugins.add(Couple.of(null,loadedPlugin));
                }
              }
            }
 catch (            Exception ignore) {
            }
          }
          @Override public void onSuccess(){
            final PluginsAdvertiserDialog advertiserDialog=new PluginsAdvertiserDialog(null,myPlugins,myAllPlugins);
            advertiserDialog.show();
            if (advertiserDialog.isOK()) {
              myEnabledExtensions.add(extension);
              myNotifications.updateAllNotifications();
            }
          }
        }
);
      }
    }
);
  }
  panel.createActionLabel("Ignore extension",new Runnable(){
    @Override public void run(){
      final UnknownFeaturesCollector collectorSuggester=UnknownFeaturesCollector.getInstance(myProject);
      collectorSuggester.ignoreFeature(createExtensionFeature(extension));
      myNotifications.updateAllNotifications();
    }
  }
);
  return panel;
}
