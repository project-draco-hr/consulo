{
  final Sdk jdk=ModuleRootManager.getInstance(module).getSdk();
  if (jdk == null) {
    throw CantRunException.noJdkForModule(module);
  }
  final VirtualFile homeDirectory=jdk.getHomeDirectory();
  if (homeDirectory == null || !homeDirectory.isValid()) {
    throw CantRunException.jdkMisconfigured(jdk,module);
  }
  return jdk;
}
