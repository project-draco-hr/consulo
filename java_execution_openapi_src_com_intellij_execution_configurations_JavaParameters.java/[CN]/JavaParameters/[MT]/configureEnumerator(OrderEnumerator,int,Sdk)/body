{
  if ((classPathType & JDK_ONLY) == 0) {
    enumerator=enumerator.withoutSdk();
  }
  if ((classPathType & TESTS_ONLY) == 0) {
    enumerator=enumerator.productionOnly();
  }
  OrderRootsEnumerator rootsEnumerator=enumerator.classes();
  final NotNullFunction<OrderEntry,VirtualFile[]> provider=computeRootProvider(classPathType,jdk);
  if (provider != null) {
    rootsEnumerator=rootsEnumerator.usingCustomRootProvider(provider);
  }
  return rootsEnumerator;
}
