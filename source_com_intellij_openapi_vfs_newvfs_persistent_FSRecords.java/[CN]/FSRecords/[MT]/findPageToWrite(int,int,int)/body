{
  final RecordDataOutput result;
  incModCount(id);
  int att_page=headPage;
  while (att_page != 0) {
    int curPage=att_page;
    final RandomAccessPagedDataInput page=myConnection.getAttributes().getReader(att_page);
    final int attIdOnPage=page.readInt();
    final int next=page.readInt();
    if (attIdOnPage == encodedAttId) {
      page.close();
      result=myConnection.getAttributes().getWriter(curPage);
      result.writeInt(encodedAttId);
      result.writeInt(next);
      return (DataOutputStream)result;
    }
    att_page=next;
    page.close();
  }
  result=myConnection.getAttributes().createRecord();
  result.writeInt(encodedAttId);
  result.writeInt(headPage);
  myConnection.getRecords().putInt(id * RECORD_SIZE + ATTREF_OFFSET,result.getRecordId());
  return (DataOutputStream)result;
}
