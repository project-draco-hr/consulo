{
  try {
    r.lock();
    int encodedAttId=myConnection.getAttributeId(attId);
    int att_page=myConnection.getRecords().getInt(id * RECORD_SIZE + ATTREF_OFFSET);
    while (att_page != 0) {
      final RandomAccessPagedDataInput page=myConnection.getAttributes().getReader(att_page);
      final int attIdOnPage=page.readInt();
      final int next=page.readInt();
      if (attIdOnPage == encodedAttId) {
        return new DataInputStream(page){
          boolean closed=false;
          public void close() throws IOException {
            if (!closed) {
              closed=true;
              super.close();
              r.unlock();
            }
          }
          protected void finalize() throws Throwable {
            if (!closed) {
              w.unlock();
            }
            super.finalize();
          }
        }
;
      }
      att_page=next;
      page.close();
    }
    r.unlock();
    return null;
  }
 catch (  IOException e) {
    r.unlock();
    throw new RuntimeException(e);
  }
}
