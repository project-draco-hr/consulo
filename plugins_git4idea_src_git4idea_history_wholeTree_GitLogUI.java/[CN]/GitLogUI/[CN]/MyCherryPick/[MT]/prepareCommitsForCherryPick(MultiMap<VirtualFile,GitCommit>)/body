{
  Map<GitRepository,List<GitCommit>> commitsInRoots=new HashMap<GitRepository,List<GitCommit>>();
  GitRepositoryManager repositoryManager=ServiceManager.getService(myProject,GitRepositoryManager.class);
  for (  Map.Entry<VirtualFile,Collection<GitCommit>> entry : commits.entrySet()) {
    List<GitCommit> sortedCommits=new ArrayList<GitCommit>(entry.getValue());
    Collections.reverse(sortedCommits);
    GitRepository repository=repositoryManager.getRepositoryForRoot(entry.getKey());
    if (repository == null) {
      continue;
    }
    commitsInRoots.put(repository,sortedCommits);
  }
  return commitsInRoots;
}
