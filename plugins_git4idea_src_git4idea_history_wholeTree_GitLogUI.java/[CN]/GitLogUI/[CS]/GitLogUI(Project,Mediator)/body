{
  myProject=project;
  myMediator=mediator;
  mySearchContext=new ArrayList<String>();
  myUsersSearchContext=new ArrayList<String>();
  myRefs=new HashMap<VirtualFile,SymbolicRefs>();
  myRecalculatedCommon=new SymbolicRefs();
  myPreviousFilter="";
  myDetails=new MySpecificDetails(myProject);
  myDescriptionRenderer=new DescriptionRenderer();
  mySelectionSpeedometer=new Speedometer(20,400);
  createTableModel();
  myState=StepType.CONTINUE;
  myUIRefresh=new UIRefresh(){
    @Override public void detailsLoaded(){
      fireTableRepaint();
    }
    @Override public void linesReloaded(    boolean drawMore){
      if ((!StepType.STOP.equals(myState)) && (!StepType.FINISHED.equals(myState))) {
        myState=drawMore ? StepType.PAUSE : StepType.CONTINUE;
      }
      fireTableRepaint();
      updateMoreVisibility();
    }
    @Override public void acceptException(    Exception e){
      LOG.info(e);
    }
    @Override public void finished(){
      myState=StepType.FINISHED;
      updateMoreVisibility();
    }
    @Override public void reportSymbolicRefs(    VirtualFile root,    SymbolicRefs symbolicRefs){
      myRefs.put(root,symbolicRefs);
      myRecalculatedCommon.clear();
      if (myRefs.isEmpty())       return;
      final CheckSamePattern<String> currentUser=new CheckSamePattern<String>();
      final CheckSamePattern<String> currentBranch=new CheckSamePattern<String>();
      for (      SymbolicRefs refs : myRefs.values()) {
        myRecalculatedCommon.addLocals(refs.getLocalBranches());
        myRecalculatedCommon.addRemotes(refs.getRemoteBranches());
        myRecalculatedCommon.addTags(refs.getTags());
        final String currentFromRefs=refs.getCurrent() == null ? null : refs.getCurrent().getFullName();
        currentBranch.iterate(currentFromRefs);
        currentUser.iterate(refs.getUsername());
      }
      if (currentBranch.isSame()) {
        myRecalculatedCommon.setCurrent(myRefs.values().iterator().next().getCurrent());
      }
      if (currentUser.isSame()) {
        final String username=currentUser.getSameValue();
        myRecalculatedCommon.setUsername(username);
        myUserFilterI.setMe(username);
      }
      myBranchSelectorAction.setSymbolicRefs(myRecalculatedCommon);
    }
  }
;
}
