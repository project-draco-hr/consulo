{
  final RootsHolder wasRootsHolder=myTableModel.getRootsHolder();
  final HashSet<VirtualFile> activeRoots=new HashSet<VirtualFile>(rootsUnderVcs);
  if (wasRootsHolder != null) {
    final HashSet<VirtualFile> excludedRoots=new HashSet<VirtualFile>(wasRootsHolder.getRoots());
    excludedRoots.removeAll(myTableModel.getActiveRoots());
    activeRoots.removeAll(excludedRoots);
  }
  myRootsUnderVcs=rootsUnderVcs;
  final RootsHolder rootsHolder=new RootsHolder(rootsUnderVcs);
  myTableModel.setRootsHolder(rootsHolder);
  myTableModel.setActiveRoots(activeRoots);
  myDetailsCache.rootsChanged(rootsUnderVcs);
  if (myStarted) {
    reloadRequest();
  }
}
