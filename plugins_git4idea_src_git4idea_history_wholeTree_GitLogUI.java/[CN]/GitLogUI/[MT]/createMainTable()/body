{
  myJBTable=new JBTable(myTableModel){
    @Override public TableCellRenderer getCellRenderer(    int row,    int column){
      final TableCellRenderer custom=myTableModel.getColumnInfo(column).getRenderer(myTableModel.getValueAt(row,column));
      return custom == null ? super.getCellRenderer(row,column) : custom;
    }
  }
;
  final TableLinkMouseListener tableLinkListener=new TableLinkMouseListener(){
    @Override protected Object tryGetTag(    MouseEvent e,    JTable table,    int row,    int column){
      myDescriptionRenderer.getTableCellRendererComponent(table,table.getValueAt(row,column),false,false,row,column);
      final Rectangle rc=table.getCellRect(row,column,false);
      int index=myDescriptionRenderer.myInner.findFragmentAt(e.getPoint().x - rc.x - myDescriptionRenderer.getCurrentWidth());
      if (index >= 0) {
        return myDescriptionRenderer.myInner.getFragmentTag(index);
      }
      return null;
    }
  }
;
  final ActionToolbar actionToolbar=createToolbar();
  tableLinkListener.install(myJBTable);
  myJBTable.getExpandableItemsHandler().setEnabled(false);
  myJBTable.setShowGrid(false);
  myJBTable.setModel(myTableModel);
  myJBTable.setBorder(null);
  final PopupHandler popupHandler=new PopupHandler(){
    @Override public void invokePopup(    Component comp,    int x,    int y){
      createContextMenu();
      myContextMenu.getComponent().show(comp,x,y);
    }
  }
;
  myJBTable.addMouseListener(popupHandler);
  myTableScrollPane=ScrollPaneFactory.createScrollPane(myJBTable);
  myTableScrollPane.setBorder(IdeBorderFactory.createBorder(SideBorder.TOP | SideBorder.RIGHT | SideBorder.BOTTOM));
  myGraphGutter=new GraphGutter(myTableModel);
  myGraphGutter.setJBTable(myJBTable);
  myTableViewPort=myTableScrollPane.getViewport();
  myGraphGutter.setTableViewPort(myTableViewPort);
  myGraphGutter.getComponent().addMouseListener(popupHandler);
  new AdjustComponentWhenShown(){
    @Override protected boolean init(){
      return adjustColumnSizes(myTableScrollPane);
    }
    @Override protected boolean canExecute(){
      return myStarted;
    }
  }
.install(myJBTable);
  myMyChangeListener=new GitTableScrollChangeListener(myJBTable,myDetailsCache,myTableModel,new Runnable(){
    @Override public void run(){
      updateByScroll();
    }
  }
,new Runnable(){
    @Override public void run(){
      if (myGraphGutter.getComponent().isVisible()) {
        myGraphGutter.getComponent().repaint();
      }
    }
  }
);
  myTableScrollPane.getViewport().addChangeListener(myMyChangeListener);
  final JPanel wrapper=new DataProviderPanel(new BorderLayout());
  wrapper.add(actionToolbar.getComponent(),BorderLayout.NORTH);
  final JPanel mainBorderWrapper=new JPanel(new BorderLayout());
  final JPanel wrapperGutter=new JPanel(new BorderLayout());
  createTreeUpperComponent();
  wrapperGutter.add(myEqualToHeadr,BorderLayout.NORTH);
  wrapperGutter.add(myGraphGutter.getComponent(),BorderLayout.CENTER);
  mainBorderWrapper.add(wrapperGutter,BorderLayout.WEST);
  mainBorderWrapper.add(myTableScrollPane,BorderLayout.CENTER);
  wrapper.add(mainBorderWrapper,BorderLayout.CENTER);
  myDetailsPanel=new GitLogDetailsPanel(myProject,myDetailsCache,new Convertor<VirtualFile,CachedRefs>(){
    @Override public CachedRefs convert(    VirtualFile o){
      return myRefs.get(o);
    }
  }
,new Processor<AbstractHash>(){
    @Override public boolean process(    AbstractHash hash){
      return myMarked.contains(hash);
    }
  }
);
  myDetailsSplitter.setFirstComponent(wrapper);
  JPanel details=myDetailsPanel.getComponent();
  details.setBorder(IdeBorderFactory.createBorder(SideBorder.TOP | SideBorder.RIGHT));
  setupDetailsSplitter(GitLogSettings.getInstance(myProject).isShowDetails());
  return myDetailsSplitter;
}
