{
  lexer.start(text.toCharArray());
  int idx=0;
  while (lexer.getTokenType() != null) {
    if (idx >= expectedTokens.length)     fail("Too many tokens");
    String tokenName=lexer.getTokenType().toString();
    String expectedTokenType=expectedTokens[idx++];
    String expectedTokenText=expectedTokens[idx++];
    assertEquals(expectedTokenType,tokenName);
    String tokenText=new String(lexer.getBuffer(),lexer.getTokenStart(),lexer.getTokenEnd() - lexer.getTokenStart());
    assertEquals(expectedTokenText,tokenText);
    lexer.advance();
  }
  if (idx < expectedTokens.length)   fail("Not enough tokens");
}
