{
  if (output == null || output.isEmpty()) {
    throw new IllegalArgumentException("Empty git --version output: " + output);
  }
  Matcher m=FORMAT.matcher(output.trim());
  if (!m.matches()) {
    throw new IllegalArgumentException("Unsupported format of git --version output: " + output);
  }
  int major=getIntGroup(m,1);
  int minor=getIntGroup(m,2);
  int rev=getIntGroup(m,3);
  int patch=getIntGroup(m,4);
  boolean msys=(m.groupCount() >= 5) && m.group(5) != null && m.group(5).equalsIgnoreCase("msysgit");
  Type type;
  if (SystemInfo.isWindows) {
    type=msys ? Type.MSYS : Type.CYGWIN;
  }
 else {
    type=Type.UNIX;
  }
  return new GitVersion(major,minor,rev,patch,type);
}
