{
  myProjectManager=projectManager;
  final String systemPath=PathManager.getSystemPath();
  File system=new File(systemPath);
  try {
    system=system.getCanonicalFile();
  }
 catch (  IOException e) {
    LOG.info(e);
  }
  mySystemDirectory=system;
  projectManager.addProjectManagerListener(new ProjectWatcher());
  final MessageBusConnection appConnection=ApplicationManager.getApplication().getMessageBus().connect();
  appConnection.subscribe(ProjectEx.ProjectSaved.TOPIC,new ProjectEx.ProjectSaved(){
    public void saved(    @NotNull Project project){
      sendReloadRequest(project);
    }
  }
);
  ShutDownTracker.getInstance().registerShutdownTask(new Runnable(){
    @Override public void run(){
      shutdownServer(myClient,myProcessHandler);
    }
  }
);
}
