{
  Point startPoint=myEditor.visualPositionToXY(myEditor.offsetToVisualPosition(myStartOffset));
  Point endPoint=myEditor.visualPositionToXY(myEditor.offsetToVisualPosition(myEndOffset));
  Point point=new Point((startPoint.x + endPoint.x) / 2,startPoint.y);
  if (!SearchResults.insideVisibleArea(myEditor,myCursor.getPrimaryRange())) {
    ApplicationManager.getApplication().invokeLater(new Runnable(){
      @Override public void run(){
        object.hide();
      }
    }
);
    VisibleAreaListener visibleAreaListener=new VisibleAreaListener(){
      @Override public void visibleAreaChanged(      VisibleAreaEvent e){
        if (SearchResults.insideVisibleArea(myEditor,myCursor.getPrimaryRange())) {
          showReplacementPreview();
          final VisibleAreaListener visibleAreaListener=this;
          myEditor.getScrollingModel().removeVisibleAreaListener(visibleAreaListener);
          myVisibleAreaListenersToRemove.remove(visibleAreaListener);
        }
      }
    }
;
    myEditor.getScrollingModel().addVisibleAreaListener(visibleAreaListener);
    myVisibleAreaListenersToRemove.add(visibleAreaListener);
  }
  return new RelativePoint(myEditor.getContentComponent(),point);
}
