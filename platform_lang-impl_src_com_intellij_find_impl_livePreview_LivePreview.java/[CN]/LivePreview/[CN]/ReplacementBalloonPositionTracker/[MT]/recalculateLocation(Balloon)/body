{
  LiveOccurrence cursor=mySearchResults.getCursor();
  if (cursor == null)   return null;
  final TextRange cur=cursor.getPrimaryRange();
  int startOffset=cur.getStartOffset();
  int endOffset=cur.getEndOffset();
  Point startPoint=myEditor.visualPositionToXY(myEditor.offsetToVisualPosition(startOffset));
  Point endPoint=myEditor.visualPositionToXY(myEditor.offsetToVisualPosition(endOffset));
  Point point=new Point((startPoint.x + endPoint.x) / 2,startPoint.y);
  if (!SearchResults.insideVisibleArea(myEditor,cur)) {
    ApplicationManager.getApplication().invokeLater(new Runnable(){
      @Override public void run(){
        object.hide();
      }
    }
);
    VisibleAreaListener visibleAreaListener=new VisibleAreaListener(){
      @Override public void visibleAreaChanged(      VisibleAreaEvent e){
        if (SearchResults.insideVisibleArea(myEditor,cur)) {
          showReplacementPreview();
          final VisibleAreaListener visibleAreaListener=this;
          final boolean remove=myVisibleAreaListenersToRemove.remove(visibleAreaListener);
          if (remove) {
            myEditor.getScrollingModel().removeVisibleAreaListener(visibleAreaListener);
          }
        }
      }
    }
;
    myEditor.getScrollingModel().addVisibleAreaListener(visibleAreaListener);
    myVisibleAreaListenersToRemove.add(visibleAreaListener);
  }
  return new RelativePoint(myEditor.getContentComponent(),point);
}
