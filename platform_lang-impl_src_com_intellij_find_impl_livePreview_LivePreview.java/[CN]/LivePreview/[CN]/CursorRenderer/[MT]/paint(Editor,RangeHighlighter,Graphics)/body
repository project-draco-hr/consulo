{
  Document document=editor.getDocument();
  int offset=highlighter.getStartOffset();
  while (offset < highlighter.getEndOffset()) {
    int line=document.getLineNumber(offset);
    int newOffset=document.getLineEndOffset(line);
    newOffset=Math.min(highlighter.getEndOffset(),newOffset);
    drawSegment(editor,new TextRange(offset,newOffset),g);
    offset=newOffset + 1;
  }
}
