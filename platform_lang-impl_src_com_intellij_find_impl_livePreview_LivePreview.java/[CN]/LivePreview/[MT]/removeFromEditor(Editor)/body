{
  if (myReplacementBalloon != null) {
    myReplacementBalloon.hide();
  }
  if (editor != null) {
    for (    VisibleAreaListener visibleAreaListener : myVisibleAreaListenersToRemove) {
      editor.getScrollingModel().removeVisibleAreaListener(visibleAreaListener);
    }
    myVisibleAreaListenersToRemove.clear();
    Project project=mySearchResults.getProject();
    if (!project.isDisposed()) {
      for (      RangeHighlighter h : myHighlighters) {
        HighlightManager.getInstance(project).removeSegmentHighlighter(editor,h);
      }
      if (myCursorHighlighter != null) {
        HighlightManager.getInstance(project).removeSegmentHighlighter(editor,myCursorHighlighter);
        myCursorHighlighter=null;
      }
    }
    myHighlighters.clear();
    if (myListeningSelection) {
      editor.getSelectionModel().removeSelectionListener(this);
      myListeningSelection=false;
    }
  }
}
