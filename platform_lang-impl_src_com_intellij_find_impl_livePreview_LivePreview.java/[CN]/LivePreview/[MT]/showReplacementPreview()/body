{
  hideBalloon();
  final LiveOccurrence cursor=mySearchResults.getCursor();
  final Editor editor=mySearchResults.getEditor();
  if (myDelegate != null && cursor != null) {
    String replacementPreviewText=myDelegate.getStringToReplace(editor,cursor);
    if (replacementPreviewText != null) {
      ReplacementView replacementView=new ReplacementView(replacementPreviewText,cursor);
      replacementView.setDelegate(this);
      BalloonBuilder balloonBuilder=JBPopupFactory.getInstance().createBalloonBuilder(replacementView);
      balloonBuilder.setFadeoutTime(0);
      balloonBuilder.setFillColor(IdeTooltipManager.GRAPHITE_COLOR);
      balloonBuilder.setAnimationCycle(0);
      balloonBuilder.setHideOnClickOutside(false);
      balloonBuilder.setHideOnKeyOutside(false);
      balloonBuilder.setHideOnAction(false);
      balloonBuilder.setCloseButtonEnabled(true);
      myReplacementBalloon=balloonBuilder.createBalloon();
      final int startOffset=cursor.getPrimaryRange().getStartOffset();
      final int endOffset=cursor.getPrimaryRange().getEndOffset();
      myReplacementBalloon.show(new ReplacementBalloonPositionTracker(editor,startOffset,endOffset,cursor),Balloon.Position.above);
    }
  }
}
