{
  hideBalloon();
  final FindResult cursor=mySearchResults.getCursor();
  final Editor editor=mySearchResults.getEditor();
  if (myDelegate != null && cursor != null) {
    String replacementPreviewText=myDelegate.getStringToReplace(editor,cursor);
    if (StringUtil.isEmpty(replacementPreviewText)) {
      replacementPreviewText=EMPTY_STRING_DISPLAY_TEXT;
    }
    final FindModel findModel=mySearchResults.getFindModel();
    if (findModel.isRegularExpressions() && findModel.isReplaceState()) {
      ReplacementView replacementView=new ReplacementView(replacementPreviewText,cursor);
      replacementView.setDelegate(this);
      BalloonBuilder balloonBuilder=JBPopupFactory.getInstance().createBalloonBuilder(replacementView);
      balloonBuilder.setFadeoutTime(0);
      balloonBuilder.setFillColor(IdeTooltipManager.GRAPHITE_COLOR);
      balloonBuilder.setAnimationCycle(0);
      balloonBuilder.setHideOnClickOutside(false);
      balloonBuilder.setHideOnKeyOutside(false);
      balloonBuilder.setHideOnAction(false);
      balloonBuilder.setCloseButtonEnabled(true);
      myReplacementBalloon=balloonBuilder.createBalloon();
      myReplacementBalloon.show(new ReplacementBalloonPositionTracker(editor),Balloon.Position.above);
    }
  }
}
