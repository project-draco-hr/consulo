{
  vcs.createFile("f",ch("1"),-1);
  l.commandStarted(createCommandEvent("command"));
  vcs.changeFileContent("f",ch("2"),-1);
  gateway.addUnsavedDocument("f","3");
  l.startAction("action");
  vcs.changeFileContent("f",ch("4"),-1);
  gateway.addUnsavedDocument("f","5");
  l.finishAction();
  vcs.changeFileContent("f",ch("6"),-1);
  l.commandFinished(null);
  List<Revision> rr=vcs.getRevisionsFor("f");
  assertEquals(3,rr.size());
  assertEquals(c("6"),rr.get(0).getEntry().getContent());
  assertEquals(c("3"),rr.get(1).getEntry().getContent());
  assertEquals(c("1"),rr.get(2).getEntry().getContent());
  assertEquals("command",rr.get(0).getCauseAction());
  assertNull(rr.get(1).getCauseAction());
  assertNull(rr.get(2).getCauseAction());
}
