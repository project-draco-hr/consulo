{
  VirtualFile dir=root.createChildDirectory(null,"oldDir");
  VirtualFile f=dir.createChildData(null,"f.java");
  dir.rename(null,"newDir");
  f.move(null,root);
  DirectoryHistoryDialogModel m=new DirectoryHistoryDialogModel(dir,getVcs(),gateway);
  m.selectChanges(1,1);
  m.createReverter().revert();
  assertEquals("oldDir",dir.getName());
  assertEquals(dir,f.getParent());
}
