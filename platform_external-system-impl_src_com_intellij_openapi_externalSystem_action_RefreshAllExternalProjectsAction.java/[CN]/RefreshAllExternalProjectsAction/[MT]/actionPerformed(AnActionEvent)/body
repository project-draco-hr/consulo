{
  final Project project=CommonDataKeys.PROJECT.getData(e.getDataContext());
  if (project == null) {
    e.getPresentation().setEnabled(false);
    return;
  }
  final List<ProjectSystemId> systemIds=getSystemIds(e);
  if (systemIds.isEmpty()) {
    e.getPresentation().setEnabled(false);
    return;
  }
  FileDocumentManager.getInstance().saveAllDocuments();
  for (  ProjectSystemId externalSystemId : systemIds) {
    ExternalSystemUtil.refreshProjects(project,externalSystemId,true);
  }
}
