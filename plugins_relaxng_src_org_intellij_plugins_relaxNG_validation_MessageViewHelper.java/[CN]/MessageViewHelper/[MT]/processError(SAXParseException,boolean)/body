{
  if (myErrors.size() == 0 && myErrorsView == null) {
    myErrorsView=new NewErrorTreeViewPanel(myProject,null,true,true,null);
    myErrorsView.setProcessController(myProcessController);
    openMessageViewImpl();
  }
  final String error=ex.getLineNumber() + "|" + ex.getColumnNumber()+ "|"+ ex.getSystemId()+ "|"+ ex.getLocalizedMessage();
  if (!myErrors.add(error)) {
    return;
  }
  VirtualFile file=null;
  final String systemId=ex.getSystemId();
  if (systemId != null) {
    try {
      file=VfsUtil.findFileByURL(new URL(systemId));
    }
 catch (    MalformedURLException e) {
      System.err.println("systemId = " + systemId);
      e.printStackTrace();
    }
  }
  final VirtualFile file1=file;
  SwingUtilities.invokeLater(new Runnable(){
    public void run(){
      myErrorsView.addMessage(warning ? MessageCategory.WARNING : MessageCategory.ERROR,new String[]{ex.getLocalizedMessage()},file1,ex.getLineNumber() - 1,ex.getColumnNumber() - 1,null);
    }
  }
);
}
