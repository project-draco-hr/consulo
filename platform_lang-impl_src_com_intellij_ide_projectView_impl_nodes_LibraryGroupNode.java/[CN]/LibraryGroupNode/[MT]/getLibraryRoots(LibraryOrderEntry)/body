{
  Library library=orderEntry.getLibrary();
  if (library == null)   return VirtualFile.EMPTY_ARRAY;
  OrderRootType[] rootTypes=LibraryType.DEFAULT_EXTERNAL_ROOT_TYPES;
  if (library instanceof LibraryEx) {
    if (((LibraryEx)library).isDisposed())     return VirtualFile.EMPTY_ARRAY;
    PersistentLibraryKind<?> libKind=((LibraryEx)library).getKind();
    if (libKind != null) {
      rootTypes=LibraryType.findByKind(libKind).getExternalRootTypes();
    }
  }
  final ArrayList<VirtualFile> files=new ArrayList<VirtualFile>();
  for (  OrderRootType rootType : rootTypes) {
    files.addAll(Arrays.asList(library.getFiles(rootType)));
  }
  return VfsUtilCore.toVirtualFileArray(files);
}
