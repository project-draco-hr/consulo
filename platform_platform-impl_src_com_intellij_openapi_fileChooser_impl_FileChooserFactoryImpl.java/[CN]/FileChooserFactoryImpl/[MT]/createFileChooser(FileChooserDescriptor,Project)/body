{
  if (SystemInfo.isMac && (System.getProperty("idea.use.native.mac.filechooser",Boolean.FALSE.toString()).equals(Boolean.TRUE.toString()) || Registry.is("ide.use.native.mac.filechooser"))) {
    return new MacFileChooserDialog(descriptor);
  }
  return new FileChooserDialogImpl(descriptor,project);
}
