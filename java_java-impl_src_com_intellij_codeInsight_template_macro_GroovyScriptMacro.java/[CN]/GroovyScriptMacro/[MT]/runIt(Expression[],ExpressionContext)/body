{
  try {
    Result result=params[0].calculateResult(context);
    if (result == null)     return result;
    String text=result.toString();
    GroovyShell shell=new GroovyShell();
    File possibleFile=new File(text);
    Script script=possibleFile.exists() ? shell.parse(possibleFile) : shell.parse(text);
    Binding binding=new Binding();
    for (int i=1; i < params.length; ++i) {
      Result paramResult=params[i].calculateResult(context);
      binding.setVariable("_" + i,paramResult != null ? paramResult.toString() : null);
    }
    binding.setVariable("_editor",context.getEditor());
    script.setBinding(binding);
    Object o=script.run();
    return o != null ? StringUtil.convertLineSeparators(o.toString()) : null;
  }
 catch (  Exception e) {
    return new TextResult(StringUtil.convertLineSeparators(e.getLocalizedMessage()));
  }
}
