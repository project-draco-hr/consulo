def findrepo(p):
    while (not os.path.isdir(os.path.join(p, '.hg'))):
        (oldp, p) = (p, os.path.dirname(p))
        if (p == oldp):
            return None
    return p
