def logmessage(opts):
    ' get the log message according to -m and -l option '
    message = opts.get('message')
    logfile = opts.get('logfile')
    if (message and logfile):
        raise util.Abort(_('options --message and --logfile are mutually exclusive'))
    if ((not message) and logfile):
        try:
            if (logfile == '-'):
                message = sys.stdin.read()
            else:
                message = open(logfile).read()
        except IOError as inst:
            raise util.Abort((_("can't read commit message '%s': %s") % (logfile, inst.strerror)))
    return message
