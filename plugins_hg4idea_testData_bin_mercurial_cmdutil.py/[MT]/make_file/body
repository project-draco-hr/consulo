def make_file(repo, pat, node=None, total=None, seqno=None, revwidth=None, mode='wb', pathname=None):
    writable = (('w' in mode) or ('a' in mode))
    if ((not pat) or (pat == '-')):
        return ((writable and sys.stdout) or sys.stdin)
    if (hasattr(pat, 'write') and writable):
        return pat
    if (hasattr(pat, 'read') and ('r' in mode)):
        return pat
    return open(make_filename(repo, pat, node, total, seqno, revwidth, pathname), mode)
