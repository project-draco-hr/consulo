def __init__(self, ui, repo, patch, diffopts, mapfile, buffered):
    changeset_printer.__init__(self, ui, repo, patch, diffopts, buffered)
    formatnode = ((ui.debugflag and (lambda x: x)) or (lambda x: x[:12]))
    defaulttempl = {'parent': '{rev}:{node|formatnode} ', 'manifest': '{rev}:{node|formatnode}', 'file_copy': '{name} ({source})', 'extra': '{key}={value|stringescape}', }
    defaulttempl['filecopy'] = defaulttempl['file_copy']
    self.t = templater.templater(mapfile, {'formatnode': formatnode, }, cache=defaulttempl)
    self.cache = {}
