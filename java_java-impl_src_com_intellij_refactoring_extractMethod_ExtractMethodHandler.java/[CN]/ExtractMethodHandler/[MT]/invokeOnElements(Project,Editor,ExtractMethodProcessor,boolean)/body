{
  if (!CommonRefactoringUtil.checkReadOnlyStatus(project,processor.getTargetClass().getContainingFile()))   return false;
  if (processor.showDialog(directTypes)) {
    CommandProcessor.getInstance().executeCommand(project,new Runnable(){
      public void run(){
        PostprocessReformattingAspect.getInstance(project).postponeFormattingInside(new Runnable(){
          public void run(){
            ApplicationManager.getApplication().runWriteAction(new Runnable(){
              public void run(){
                try {
                  processor.doRefactoring();
                }
 catch (                IncorrectOperationException e) {
                  LOG.error(e);
                }
              }
            }
);
            DuplicatesImpl.processDuplicates(processor,project,editor);
          }
        }
);
      }
    }
,REFACTORING_NAME,null);
    return true;
  }
  return false;
}
