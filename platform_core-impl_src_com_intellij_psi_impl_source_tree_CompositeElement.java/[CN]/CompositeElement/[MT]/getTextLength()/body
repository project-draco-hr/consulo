{
  int cachedLength=myCachedLength;
  if (cachedLength >= 0)   return cachedLength;
synchronized (START_OFFSET_LOCK) {
    cachedLength=myCachedLength;
    if (cachedLength >= 0)     return cachedLength;
    ApplicationManager.getApplication().assertReadAccessAllowed();
    try {
      walkCachingLength();
    }
 catch (    AssertionError e) {
      myCachedLength=NOT_CACHED;
      String assertion=StringUtil.getThrowableText(e);
      throw new AssertionError("Walking failure: ===\n" + assertion + "\n=== Thread dump:\n"+ ThreadDumper.dumpThreadsToString()+ "\n===\n");
    }
    return myCachedLength;
  }
}
