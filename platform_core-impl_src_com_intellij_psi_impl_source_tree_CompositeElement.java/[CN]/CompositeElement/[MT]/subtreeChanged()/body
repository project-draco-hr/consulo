{
synchronized (PsiLock.LOCK) {
    CompositeElement compositeElement=this;
    while (compositeElement != null) {
      compositeElement.clearCaches();
      if (!(compositeElement instanceof PsiElement)) {
        final PsiElement psi=compositeElement.myWrapper;
        if (psi instanceof PsiElementWithSubtreeChangeNotifier) {
          ((PsiElementWithSubtreeChangeNotifier)psi).subtreeChanged();
        }
      }
      compositeElement=compositeElement.getTreeParent();
    }
  }
}
