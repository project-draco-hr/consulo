{
  final FileElement fileElement=TreeUtil.getFileElement(first);
  if (fileElement != null) {
    ChangeUtil.prepareAndRunChangeAction(new ChangeUtil.ChangeAction(){
      public void makeChange(      TreeChangeEvent destinationTreeChange){
        remove(destinationTreeChange,first,last);
        repairRemovedElement(fileElement,first);
      }
    }
,first.getTreeParent());
  }
 else {
    first.rawRemoveUpTo(last);
  }
}
