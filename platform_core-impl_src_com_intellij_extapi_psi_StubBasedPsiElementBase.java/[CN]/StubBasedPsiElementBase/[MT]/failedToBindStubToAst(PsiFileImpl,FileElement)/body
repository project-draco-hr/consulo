{
  VirtualFile vFile=file.getVirtualFile();
  StubTree stubTree=file.getStubTree();
  String stubString=stubTree != null ? ((PsiFileStubImpl)stubTree.getRoot()).printTree() : "is null";
  String astString=DebugUtil.treeToString(fileElement,true);
  if (!ourTraceStubAstBinding) {
    stubString=StringUtil.trimLog(stubString,1024);
    astString=StringUtil.trimLog(astString,1024);
  }
  @NonNls String message="Failed to bind stub to AST for element " + getClass() + " in "+ (vFile == null ? "<unknown file>" : vFile.getPath())+ "\nFile:\n"+ file+ "@"+ System.identityHashCode(file)+ "\nFile stub tree:\n"+ stubString+ "\nLoaded file AST:\n"+ astString;
  if (ourTraceStubAstBinding) {
    message+=dumpCreationTraces(fileElement);
  }
  throw new IllegalArgumentException(message);
}
