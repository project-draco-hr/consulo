{
  ArrayList<FilePath> result=new ArrayList<FilePath>();
  VirtualFile[] virtualFileArray=context.getSelectedFiles();
  if (virtualFileArray != null) {
    for (    VirtualFile virtualFile : virtualFileArray) {
      result.add(new FilePathImpl(virtualFile));
    }
  }
  File[] fileArray=context.getSelectedIOFiles();
  if (fileArray != null) {
    for (    File file : fileArray) {
      final File parentIoFile=file.getParentFile();
      if (parentIoFile == null)       continue;
      final VirtualFile parent=LocalFileSystem.getInstance().findFileByIoFile(parentIoFile);
      if (parent != null) {
        final FilePathImpl child=new FilePathImpl(parent,file.getName(),false);
        if (!result.contains(child)) {
          result.add(child);
        }
      }
    }
  }
  return result.toArray(new FilePath[result.size()]);
}
