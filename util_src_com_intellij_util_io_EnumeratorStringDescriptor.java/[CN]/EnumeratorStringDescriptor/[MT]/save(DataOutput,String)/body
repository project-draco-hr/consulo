{
  int len=value.length();
  if (len < STRING_LENGTH_THRESHOLD && isAscii(value)) {
    final byte[] buf=buffer;
    buf[0]=(byte)len;
    for (int i=0; i < len; i++) {
      buf[i + STRING_HEADER_SIZE]=(byte)value.charAt(i);
    }
    storage.write(buf,0,len + STRING_HEADER_SIZE);
  }
 else {
    storage.writeByte((byte)0xFF);
    storage.writeUTF(value);
  }
}
