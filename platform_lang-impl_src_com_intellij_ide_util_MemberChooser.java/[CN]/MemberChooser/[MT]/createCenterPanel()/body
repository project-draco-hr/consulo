{
  JPanel panel=new JPanel(new BorderLayout());
  DefaultActionGroup group=new DefaultActionGroup();
  fillToolbarActions(group);
  group.addSeparator();
  ExpandAllAction expandAllAction=new ExpandAllAction();
  expandAllAction.registerCustomShortcutSet(new CustomShortcutSet(KeyStroke.getKeyStroke(KeyEvent.VK_EQUALS,SystemInfo.isMac ? InputEvent.META_MASK : InputEvent.CTRL_MASK)),myTree);
  group.add(expandAllAction);
  CollapseAllAction collapseAllAction=new CollapseAllAction();
  collapseAllAction.registerCustomShortcutSet(new CustomShortcutSet(KeyStroke.getKeyStroke(KeyEvent.VK_MINUS,SystemInfo.isMac ? InputEvent.META_MASK : InputEvent.CTRL_MASK)),myTree);
  group.add(collapseAllAction);
  panel.add(ActionManager.getInstance().createActionToolbar(ActionPlaces.UNKNOWN,group,true).getComponent(),BorderLayout.NORTH);
  myTree.setCellRenderer(new ColoredTreeCellRenderer(){
    public void customizeCellRenderer(    JTree tree,    Object value,    boolean selected,    boolean expanded,    boolean leaf,    int row,    boolean hasFocus){
      if (value instanceof ElementNode) {
        ((ElementNode)value).getDelegate().renderTreeNode(this,tree);
      }
    }
  }
);
  UIUtil.setLineStyleAngled(myTree);
  myTree.setRootVisible(false);
  myTree.setShowsRootHandles(true);
  myTree.addKeyListener(new TreeKeyListener());
  myTree.addTreeSelectionListener(new MyTreeSelectionListener());
  if (!myAllowMultiSelection) {
    myTree.getSelectionModel().setSelectionMode(TreeSelectionModel.SINGLE_TREE_SELECTION);
  }
  if (getRootNode().getChildCount() > 0) {
    myTree.expandRow(0);
    myTree.setSelectionRow(1);
  }
  TreeUtil.expandAll(myTree);
  final TreeSpeedSearch treeSpeedSearch=new TreeSpeedSearch(myTree,new Convertor<TreePath,String>(){
    @Nullable public String convert(    TreePath path){
      final ElementNode lastPathComponent=(ElementNode)path.getLastPathComponent();
      if (lastPathComponent == null)       return null;
      final MemberChooserObject delegate=lastPathComponent.getDelegate();
      return delegate.getText();
    }
  }
);
  treeSpeedSearch.setComparator(new SpeedSearchComparator(false));
  treeSpeedSearch.addChangeListener(new PropertyChangeListener(){
    @Override public void propertyChange(    PropertyChangeEvent evt){
      myTree.repaint();
    }
  }
);
  new DoubleClickListener(){
    @Override protected boolean onDoubleClick(    MouseEvent e){
      if (myTree.getPathForLocation(e.getX(),e.getY()) != null) {
        doOKAction();
        return true;
      }
      return false;
    }
  }
.installOn(myTree);
  TreeUtil.installActions(myTree);
  JScrollPane scrollPane=ScrollPaneFactory.createScrollPane(myTree);
  scrollPane.setPreferredSize(new Dimension(350,450));
  panel.add(scrollPane,BorderLayout.CENTER);
  return panel;
}
