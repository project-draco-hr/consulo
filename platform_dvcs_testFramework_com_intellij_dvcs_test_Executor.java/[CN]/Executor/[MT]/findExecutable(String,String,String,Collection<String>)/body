{
  for (  String pathEnv : pathEnvs) {
    String exec=System.getenv(pathEnv);
    if (exec != null && new File(exec).canExecute()) {
      log(String.format("Using %s from %s: %s",programName,pathEnv,exec));
      return exec;
    }
  }
  String path=System.getenv(SystemInfo.isWindows ? "Path" : "PATH");
  if (path != null) {
    String name=SystemInfo.isWindows ? winExec : unixExec;
    for (    String dir : path.split(File.pathSeparator)) {
      File file=new File(dir,name);
      if (file.canExecute()) {
        log("Using " + programName + " from PATH");
        return file.getPath();
      }
    }
  }
  throw new IllegalStateException(programName + " executable not found. " + "Please define a valid environment variable "+ pathEnvs.iterator().next()+ " pointing to the "+ programName+ " executable.");
}
