{
  waitForPendingWriteForRecord(record);
synchronized (myLock) {
    byte[] result=super.readBytes(record);
    InflaterInputStream in=new InflaterInputStream(new UnsyncByteArrayInputStream(result));
    try {
      final BufferExposingByteArrayOutputStream outputStream=new BufferExposingByteArrayOutputStream();
      StreamUtil.copyStreamContent(in,outputStream);
      return outputStream;
    }
  finally {
      in.close();
    }
  }
}
