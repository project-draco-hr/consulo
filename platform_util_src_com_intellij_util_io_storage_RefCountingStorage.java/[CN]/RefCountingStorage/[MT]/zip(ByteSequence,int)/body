{
  BufferExposingByteArrayOutputStream s=new BufferExposingByteArrayOutputStream();
  DeflaterOutputStream out=new DeflaterOutputStream(s);
  try {
    out.write(bytes.getBytes(),bytes.getOffset(),bytes.getLength());
  }
  finally {
    out.close();
  }
synchronized (myLock) {
    myPendingZipRequests.remove(record);
    myPendingZipRequestsSize-=bytes.getLength();
  }
  return s;
}
