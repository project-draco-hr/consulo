{
synchronized (myLock) {
    myPendingWriteRequestsSize+=outputStream.size();
    myPendingWriteRequests.put(record,new Callable<Object>(){
      @Override public Void call() throws Exception {
        write(outputStream,record,fixedSize);
        return null;
      }
    }
);
    if (myPendingWriteRequestsSize > MAX_PENDING_WRITE_SIZE) {
      flushPendingWrites();
    }
  }
}
