{
  DataInputStream stream=new DataInputStream(new UnsyncByteArrayInputStream(bytes.getBytes(),bytes.getOffset(),bytes.getLength()));
  int pairs=DataInputOutputUtil.readINT(stream);
  if (pairs == 0)   return Collections.emptyMap();
  Map<Key,Value> result=new THashMap<Key,Value>(pairs);
  while (stream.available() > 0) {
    Value value=myValueExternalizer.read(stream);
    Collection<Key> keys=mySnapshotIndexExternalizer.read(stream);
    for (    Key k : keys)     result.put(k,value);
  }
  return result;
}
