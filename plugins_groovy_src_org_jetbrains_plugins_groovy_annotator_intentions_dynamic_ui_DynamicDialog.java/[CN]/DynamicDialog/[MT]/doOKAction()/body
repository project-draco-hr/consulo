{
  GrTypeElement typeElement=getEnteredTypeName();
  if (typeElement == null) {
    myDynamicElement.setType("java.lang.Object");
  }
 else {
    PsiType type=typeElement.getType();
    if (type instanceof PsiPrimitiveType) {
      type=TypesUtil.boxPrimitiveType(type,typeElement.getManager(),myProject.getAllScope());
    }
    final String typeQualifiedName=type.getCanonicalText();
    if (typeQualifiedName != null) {
      myDynamicElement.setType(typeQualifiedName);
    }
 else {
      myDynamicElement.setType(type.getPresentableText());
    }
  }
  final DynamicManager dynamicManager=DynamicManager.getInstance(myProject);
  final DClassElement classElement=dynamicManager.getOrCreateClassElement(myModule,getEnteredContaningClass().getContainingClass().getQualifiedName(),true);
  if (myDynamicElement instanceof DMethodElement) {
    dynamicManager.addMethod(classElement,((DMethodElement)myDynamicElement));
  }
 else   if (myDynamicElement instanceof DPropertyElement) {
    dynamicManager.addProperty(classElement,((DPropertyElement)myDynamicElement));
  }
  super.doOKAction();
}
