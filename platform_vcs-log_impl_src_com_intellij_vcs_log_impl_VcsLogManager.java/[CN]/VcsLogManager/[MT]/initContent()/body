{
  final Map<VirtualFile,VcsLogProvider> logProviders=findLogProviders();
  final VcsLogContainer mainPanel=new VcsLogContainer(myProject);
  myLogDataHolder=new VcsLogDataHolder(myProject,logProviders,mySettings);
  myLogDataHolder.initialize(new Consumer<VcsLogDataHolder>(){
    @Override public void consume(    VcsLogDataHolder vcsLogDataHolder){
      Disposer.register(VcsLogManager.this,vcsLogDataHolder);
      VcsLogUI logUI=new VcsLogUI(vcsLogDataHolder,myProject,mySettings,new VcsLogColorManagerImpl(logProviders.keySet()),myUiProperties);
      myLogDataHolder=vcsLogDataHolder;
      myUi=logUI;
      mainPanel.init(logUI.getMainFrame().getMainComponent());
      myLogRefresher=new PostponeableLogRefresher(myProject,vcsLogDataHolder);
      refreshLogOnVcsEvents(logProviders);
    }
  }
);
  return mainPanel;
}
