{
  return new PerformAction(){
    public void performAction(    VirtualFile rootDir,    VirtualFile rootAfter) throws Exception {
      final PsiManager manager=PsiManager.getInstance(myProject);
      final PsiClass aClass=manager.findClass(innerClassName,GlobalSearchScope.moduleScope(myModule));
      final MoveInnerProcessor moveInnerProcessor=new MoveInnerProcessor(myProject,null);
      final PsiElement targetContainer=MoveInnerImpl.getTargetContainer(aClass,false);
      assertNotNull(targetContainer);
      moveInnerProcessor.setup(aClass,newClassName,passOuterClass,parameterName,searchInComments,searchInNonJava,targetContainer);
      moveInnerProcessor.run();
      PostprocessReformattingAspect.getInstance(getProject()).doPostponedFormatting();
      PsiDocumentManager.getInstance(myProject).commitAllDocuments();
      FileDocumentManager.getInstance().saveAllDocuments();
    }
  }
;
}
