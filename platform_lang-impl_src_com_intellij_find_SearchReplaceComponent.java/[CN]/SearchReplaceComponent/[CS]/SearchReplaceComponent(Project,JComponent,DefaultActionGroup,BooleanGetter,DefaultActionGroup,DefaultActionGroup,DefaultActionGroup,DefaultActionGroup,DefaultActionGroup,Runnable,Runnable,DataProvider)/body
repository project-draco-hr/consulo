{
  myProject=project;
  myTargetComponent=targetComponent;
  mySearchFieldActions=searchFieldActions;
  myReplaceFieldActions=replaceFieldActions;
  myReplaceAction=replaceAction;
  myCloseAction=closeAction;
  mySearchToolbar1PopupStateModifier=new ActionToolbarImpl.PopupStateModifier(){
    @Override public int getModifiedPopupState(){
      return ActionButtonComponent.PUSHED;
    }
    @Override public boolean willModify(){
      return searchToolbar1ModifiedFlagGetter.get();
    }
  }
;
  mySearchFieldWrapper=new MyTextComponentWrapper(){
    @Override public void setContent(    JComponent wrapped){
      super.setContent(wrapped);
      mySearchTextComponent=unwrapTextComponent(wrapped);
    }
  }
;
  myReplaceFieldWrapper=new MyTextComponentWrapper(){
    @Override public void setContent(    JComponent wrapped){
      super.setContent(wrapped);
      myReplaceTextComponent=unwrapTextComponent(wrapped);
    }
  }
;
  myLeftPanel=new NonOpaquePanel(new BorderLayout());
  myLeftPanel.add(mySearchFieldWrapper,BorderLayout.NORTH);
  myLeftPanel.add(myReplaceFieldWrapper,BorderLayout.CENTER);
  mySearchActionsToolbar1=createSearchToolbar1(searchToolbar1Actions);
  Wrapper searchToolbarWrapper1=new NonOpaquePanel(new BorderLayout());
  searchToolbarWrapper1.add(mySearchActionsToolbar1,BorderLayout.WEST);
  mySearchActionsToolbar2=createSearchToolbar2(searchToolbar2Actions);
  Wrapper searchToolbarWrapper2=new Wrapper(mySearchActionsToolbar2);
  mySearchActionsToolbar2.setBorder(JBUI.Borders.emptyLeft(16));
  JPanel searchPair=new NonOpaquePanel(new BorderLayout()).setVerticalSizeReferent(mySearchFieldWrapper);
  searchPair.add(searchToolbarWrapper1,BorderLayout.WEST);
  searchPair.add(searchToolbarWrapper2,BorderLayout.CENTER);
  myReplaceActionsToolbar1=createReplaceToolbar1(replaceToolbar1Actions);
  Wrapper replaceToolbarWrapper1=new Wrapper(myReplaceActionsToolbar1).setVerticalSizeReferent(myReplaceFieldWrapper);
  myReplaceActionsToolbar2=createReplaceToolbar2(replaceToolbar2Actions);
  Wrapper replaceToolbarWrapper2=new Wrapper(myReplaceActionsToolbar2).setVerticalSizeReferent(myReplaceFieldWrapper);
  myReplaceActionsToolbar2.setBorder(JBUI.Borders.emptyLeft(16));
  myReplaceToolbarWrapper=new NonOpaquePanel(new BorderLayout());
  myReplaceToolbarWrapper.add(replaceToolbarWrapper1,BorderLayout.WEST);
  myReplaceToolbarWrapper.add(replaceToolbarWrapper2,BorderLayout.CENTER);
  searchToolbarWrapper1.setHorizontalSizeReferent(replaceToolbarWrapper1);
  JLabel closeLabel=new JLabel(null,AllIcons.Actions.Cross,SwingConstants.RIGHT);
  closeLabel.setBorder(JBUI.Borders.empty(5));
  closeLabel.setVerticalAlignment(SwingConstants.TOP);
  closeLabel.addMouseListener(new MouseAdapter(){
    @Override public void mousePressed(    final MouseEvent e){
      close();
    }
  }
);
  closeLabel.setToolTipText("Close search bar (Escape)");
  searchPair.add(new Wrapper.North(closeLabel),BorderLayout.EAST);
  myRightPanel=new NonOpaquePanel(new BorderLayout());
  myRightPanel.add(searchPair,BorderLayout.NORTH);
  myRightPanel.add(myReplaceToolbarWrapper,BorderLayout.CENTER);
  OnePixelSplitter splitter=new OnePixelSplitter(false,.25F);
  splitter.setFirstComponent(myLeftPanel);
  splitter.setSecondComponent(myRightPanel);
  splitter.setHonorComponentsMinimumSize(true);
  splitter.setAndLoadSplitterProportionKey("FindSplitterProportion");
  splitter.setOpaque(false);
  splitter.getDivider().setOpaque(false);
  add(splitter,BorderLayout.CENTER);
  update("","",false,false);
  myDataProviderDelegate=dataProvider;
}
