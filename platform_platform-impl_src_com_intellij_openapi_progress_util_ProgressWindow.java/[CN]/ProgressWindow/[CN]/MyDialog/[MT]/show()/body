{
  if (ApplicationManager.getApplication().isHeadlessEnvironment())   return;
  if (myParentWindow == null)   return;
  if (myPopup != null) {
    myPopup.close(DialogWrapper.CANCEL_EXIT_CODE);
  }
  myPopup=myParentWindow.isShowing() ? new MyDialogWrapper(myParentWindow,myShouldShowCancel) : new MyDialogWrapper(myProject,myShouldShowCancel);
  myPopup.setUndecorated(true);
  myPopup.pack();
  SwingUtilities.invokeLater(new Runnable(){
    public void run(){
      if (myPopup != null) {
        if (myPopup.getPeer() instanceof FocusTrackbackProvider) {
          final FocusTrackback focusTrackback=((FocusTrackbackProvider)myPopup.getPeer()).getFocusTrackback();
          if (focusTrackback != null) {
            focusTrackback.consume();
          }
        }
        getFocusManager().requestFocus(myCancelButton,true);
      }
    }
  }
);
  myPopup.show();
}
