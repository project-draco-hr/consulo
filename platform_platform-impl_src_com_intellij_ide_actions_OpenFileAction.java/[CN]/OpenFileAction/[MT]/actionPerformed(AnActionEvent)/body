{
  @Nullable final Project project=PlatformDataKeys.PROJECT.getData(e.getDataContext());
  if (project == null && PlatformProjectOpenProcessor.getInstanceIfItExists() == null) {
    return;
  }
  final FileChooserDescriptor descriptor=FileChooserDescriptorFactory.createMultipleFilesNoJarsDescriptor();
  descriptor.setTitle(IdeBundle.message("title.open.file"));
  final String lastFilePath=project != null ? getLastFilePath(project) : null;
  final VirtualFile toSelect=lastFilePath == null ? null : LocalFileSystem.getInstance().findFileByPath(lastFilePath);
  FileChooser.chooseFiles(descriptor,project,toSelect,new Consumer<List<VirtualFile>>(){
    @Override public void consume(    final List<VirtualFile> files){
      doOpenFile(project,files);
    }
  }
);
}
