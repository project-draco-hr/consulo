{
  for (  final VirtualFile file : result) {
    if (file.isDirectory()) {
      Project openedProject=ProjectUtil.openOrImport(file.getPath(),project,false);
      FileChooserUtil.setLastOpenedFile(openedProject,file);
      return;
    }
    if (OpenProjectFileChooserDescriptor.isProjectFile(file)) {
      int answer=Messages.showYesNoDialog(project,IdeBundle.message("message.open.file.is.project",file.getName()),IdeBundle.message("title.open.project"),Messages.getQuestionIcon());
      if (answer == 0) {
        FileChooserUtil.setLastOpenedFile(ProjectUtil.openOrImport(file.getPath(),project,false),file);
        return;
      }
    }
    FileType type=FileTypeChooser.getKnownFileTypeOrAssociate(file,project);
    if (type == null)     return;
    if (project != null) {
      openFile(file,project);
    }
 else {
      PlatformProjectOpenProcessor processor=PlatformProjectOpenProcessor.getInstanceIfItExists();
      if (processor != null) {
        processor.doOpenProject(file,null,false);
      }
    }
  }
}
