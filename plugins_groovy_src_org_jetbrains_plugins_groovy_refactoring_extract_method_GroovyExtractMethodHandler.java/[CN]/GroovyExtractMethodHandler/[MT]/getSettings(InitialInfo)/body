{
  if (ApplicationManager.getApplication().isUnitTestMode()) {
    final ExtractMethodInfoHelper helper=new ExtractMethodInfoHelper(initialInfo,"testMethod");
    final PsiType type=helper.getOutputType();
    if (type.equalsToText(CommonClassNames.JAVA_LANG_OBJECT) || type.equalsToText("void")) {
      helper.setSpecifyType(false);
    }
    return helper;
  }
  GroovyExtractMethodDialog dialog=new GroovyExtractMethodDialog(initialInfo);
  dialog.show();
  if (!dialog.isOK())   return null;
  return dialog.getHelper();
}
