{
  editor.getScrollingModel().scrollToCaret(ScrollType.MAKE_VISIBLE);
  final SelectionModel model=editor.getSelectionModel();
  if (!model.hasSelection()) {
    model.selectLineAtCaret();
  }
  try {
    final InitialInfo initialInfo=GroovyExtractChooser.invoke(project,editor,file,model.getSelectionStart(),model.getSelectionEnd());
    performRefactoring(initialInfo,editor);
  }
 catch (  GrRefactoringError e) {
    CommonRefactoringUtil.showErrorHint(project,editor,e.getMessage(),REFACTORING_NAME,HelpID.EXTRACT_METHOD);
  }
}
