{
  editor.getScrollingModel().scrollToCaret(ScrollType.MAKE_VISIBLE);
  final SelectionModel model=editor.getSelectionModel();
  if (!model.hasSelection()) {
    model.selectLineAtCaret();
  }
  try {
    invokeOnEditor(project,editor,file,model.getSelectionStart(),model.getSelectionEnd());
  }
 catch (  ExtractException e) {
    myInvokeResult=e.getMessage();
  }
}
