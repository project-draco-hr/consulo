{
  if (ApplicationManager.getApplication().isUnitTestMode()) {
    final ExtractMethodInfoHelper helper=new ExtractMethodInfoHelper(initialInfo,"testMethod",owner,true);
    final PsiType type=helper.getOutputType();
    if (type.equalsToText(CommonClassNames.JAVA_LANG_OBJECT) || PsiType.VOID.equals(type)) {
      helper.setSpecifyType(false);
    }
    return helper;
  }
  GroovyExtractMethodDialog dialog=new GroovyExtractMethodDialog(initialInfo,owner);
  dialog.show();
  if (!dialog.isOK())   return null;
  return dialog.getHelper();
}
