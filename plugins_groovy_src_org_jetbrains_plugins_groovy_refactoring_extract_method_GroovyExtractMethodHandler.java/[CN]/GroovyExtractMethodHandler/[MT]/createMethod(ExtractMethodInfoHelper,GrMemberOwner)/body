{
  final GrMethod method=ExtractUtil.createMethod(helper);
  PsiElement anchor=calculateAnchorToInsertBefore(owner,helper.getStatements()[0]);
  GrMethod newMethod=owner.addMemberDeclaration(method,anchor);
  renameParameterOccurrences(newMethod,helper);
  GrReferenceAdjuster.shortenReferences(newMethod);
  PsiElement prev=newMethod.getPrevSibling();
  IElementType elementType=prev.getNode().getElementType();
  if (!TokenSets.WHITE_SPACES_SET.contains(elementType) || !prev.getText().contains("\n")) {
    newMethod.getParent().getNode().addLeaf(GroovyTokenTypes.mNLS,"\n",newMethod.getNode());
  }
}
