{
  List<PsiElement> array=new ArrayList<PsiElement>();
  PsiImportList importList=getImportList();
  PsiImportStatement[] statements=importList.getImportStatements();
  for (int i=0; i < statements.length; i++) {
    PsiImportStatement statement=statements[i];
    if (statement.isOnDemand()) {
      PsiElement resolved=statement.resolve();
      if (resolved != null) {
        array.add(resolved);
      }
    }
  }
  if (includeImplicit) {
    PsiJavaCodeReferenceElement[] implicitRefs=getImplicitlyImportedPackageReferences();
    for (int i=0; i < implicitRefs.length; i++) {
      final PsiElement resolved=implicitRefs[i].resolve();
      if (resolved != null) {
        array.add(resolved);
      }
    }
  }
  return array.toArray(new PsiElement[array.size()]);
}
