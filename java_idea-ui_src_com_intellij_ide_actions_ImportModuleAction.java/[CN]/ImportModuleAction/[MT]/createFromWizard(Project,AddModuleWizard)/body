{
  if (wizard.getStepCount() > 0) {
    if (project != null) {
      Module module=new NewModuleAction().createModuleFromWizard(project,null,wizard);
      return Collections.singletonList(module);
    }
 else {
      Project newProject=NewProjectUtil.createFromWizard(wizard,project);
      return newProject == null ? Collections.<Module>emptyList() : Arrays.asList(ModuleManager.getInstance(newProject).getModules());
    }
  }
 else {
    return wizard.getProjectBuilder().commit(project);
  }
}
