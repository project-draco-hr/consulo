{
  final String path=getContentEntryPath();
  String iml;
  try {
    File dir=new File(path);
    ZipInputStream zipInputStream=myTemplate.getStream();
    ZipUtil.unzip(ProgressManager.getInstance().getProgressIndicator(),dir,zipInputStream);
    VirtualFile virtualFile=LocalFileSystem.getInstance().refreshAndFindFileByIoFile(dir);
    iml=ContainerUtil.find(dir.list(),new Condition<String>(){
      @Override public boolean value(      String s){
        return s.endsWith(".iml");
      }
    }
);
    new File(path,iml).renameTo(new File(getModuleFilePath()));
    RefreshQueue.getInstance().refresh(false,true,null,virtualFile);
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
  return ImportImlMode.setUpLoader(getModuleFilePath()).createModule(moduleModel);
}
