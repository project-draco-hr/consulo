{
  if (myProjectMode) {
    final Module[] modules=ModuleManager.getInstance(project).getModules();
    if (modules.length > 0) {
      final Module module=modules[0];
      ApplicationManager.getApplication().runWriteAction(new Runnable(){
        @Override public void run(){
          try {
            setupModule(module);
            ModifiableModuleModel modifiableModuleModel=ModuleManager.getInstance(project).getModifiableModel();
            modifiableModuleModel.renameModule(module,module.getProject().getName());
            modifiableModuleModel.commit();
            fixModuleName(module);
          }
 catch (          ConfigurationException e) {
            LOG.error(e);
          }
catch (          ModuleWithNameAlreadyExists exists) {
          }
        }
      }
);
      return module;
    }
    return null;
  }
 else {
    return super.commitModule(project,model);
  }
}
