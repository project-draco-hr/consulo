{
  this.tc=tc;
  this.blockSize=tc.getBlockSize();
  this.doEncrypt=doEncrypt;
  if (this.blockSize != iv.length)   throw new IllegalArgumentException("IV must be " + blockSize + " bytes long! (currently "+ iv.length+ ")");
  this.cbc_vector=new byte[blockSize];
  this.tmp_vector=new byte[blockSize];
  System.arraycopy(iv,0,cbc_vector,0,blockSize);
}
