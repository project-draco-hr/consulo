{
  if (window == null)   return window;
  final WindowManagerEx wndManager=getWndManager();
  if (wndManager == null)   return window;
  if (!wndManager.isAlphaModeEnabled(window))   return window;
  if (myAlpha != myLastAlpha) {
    wndManager.setAlphaModeRatio(window,myAlpha);
    myLastAlpha=myAlpha;
  }
  if (myMaskProvider != null) {
    final Dimension size=window.getSize();
    Shape mask=myLastSizeMask;
    if (!size.equals(myLastSize)) {
      mask=myMaskProvider.getMask(size);
    }
    wndManager.setWindowMask(window,mask);
  }
  return window;
}
