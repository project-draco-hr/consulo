{
  if (myPopup != null) {
    if (!canClose()) {
      return;
    }
    storeDimensionSize(myContent.getSize());
    if (myUseDimServiceForXYLocation) {
      final JRootPane root=myComponent.getRootPane();
      if (root != null) {
        final Container popupWindow=root.getParent();
        if (popupWindow != null && popupWindow.isShowing()) {
          storeLocation(popupWindow.getLocationOnScreen());
        }
      }
    }
    myPopup.hide();
    if (ApplicationManagerEx.getApplicationEx() != null) {
      StackingPopupDispatcher.getInstance().onPopupHidden(this);
    }
    if (myInStack) {
      myFocusTrackback.restoreFocus();
    }
    disposePopup();
    if (myListeners != null) {
      for (      JBPopupListener each : myListeners) {
        each.onClosed(this);
      }
    }
  }
  Disposer.dispose(this,false);
}
