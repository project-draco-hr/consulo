{
  BufferedImage capture=null;
  try {
    final Point onScreen=getLocationOnScreen();
    capture=new Robot().createScreenCapture(new Rectangle(onScreen.x,onScreen.y,getWidth() + 2 * POPUP_SIDE_SIZE,getHeight() + POPUP_TOP_SIZE + POPUP_BOTTOM_SIZE));
    final BufferedImage shadow=ShadowBorderPainter.createPopupShadow(this,getWidth(),getHeight());
    ((Graphics2D)capture.getGraphics()).drawImage(shadow,null,null);
  }
 catch (  Exception e) {
    e.printStackTrace();
  }
  if (capture != null)   g.drawImage(capture,0,0,null);
}
