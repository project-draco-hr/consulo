{
  myIndentOption=indentOptions;
  mySettings=settings;
  final InitialInfoBuilder builder=InitialInfoBuilder.buildBlocks(rootBlock,docModel,affectedRange,indentOptions,processHeadingWhitespace,interestingOffset);
  myInfos=builder.getBlockToInfoMap();
  myInterestingOffset=interestingOffset;
  myRootBlockWrapper=builder.getRootBlockWrapper();
  myFirstTokenBlock=builder.getFirstTokenBlock();
  myLastTokenBlock=builder.getLastTokenBlock();
  myCurrentBlock=myFirstTokenBlock;
  myTextRangeToWrapper=buildTextRangeToInfoMap(myFirstTokenBlock);
  myLastWhiteSpace=new WhiteSpace(getLastBlock().getEndOffset(),false);
  myLastWhiteSpace.append(docModel.getTextLength(),docModel,indentOptions);
}
