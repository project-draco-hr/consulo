{
  if (model instanceof DocumentBasedFormattingModel) {
    final Document document=((DocumentBasedFormattingModel)model).getDocument();
    final Project project=((DocumentBasedFormattingModel)model).getProject();
    final PsiFile psiFile=PsiDocumentManager.getInstance(project).getPsiFile(document);
    if (psiFile != null && psiFile.getVirtualFile() != null) {
      final FileEditor[] fileEditors=FileEditorManager.getInstance(project).getEditors(psiFile.getVirtualFile());
      if (fileEditors.length > 0) {
        for (        FileEditor feditor : fileEditors) {
          if (feditor instanceof TextEditor) {
            if (editorsWithBulkReformatNotified == null)             editorsWithBulkReformatNotified=new ArrayList<Editor>();
            editorsWithBulkReformatNotified.add(((TextEditor)feditor).getEditor());
          }
        }
      }
    }
  }
  return editorsWithBulkReformatNotified;
}
