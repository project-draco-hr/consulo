{
  FileType foo=new FakeFileType(){
    @Override public boolean isMyFileType(    VirtualFile file){
      return true;
    }
    @NotNull @Override public String getName(){
      return "foo";
    }
    @NotNull @Override public String getDescription(){
      return "";
    }
  }
;
  FileTypeIndex index=new FileTypeIndex(FileTypeManager.getInstance());
  int version=index.getVersion();
  try {
    FileTypeManagerEx.getInstanceEx().registerFileType(foo);
    assertNotSame(version,index.getVersion());
  }
  finally {
    FileTypeManagerEx.getInstanceEx().unregisterFileType(foo);
  }
}
