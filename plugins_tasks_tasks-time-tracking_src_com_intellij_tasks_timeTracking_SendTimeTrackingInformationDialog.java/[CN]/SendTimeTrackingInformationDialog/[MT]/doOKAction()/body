{
  String timeSpentText=myFromPreviousPostRadioButton.isSelected() ? myFromPreviousPostTextField.getText() : myTotallyRadioButton.isSelected() ? myTotallyTextField.getText() : myCustomTextField.getText();
  final Matcher matcher=PATTERN.matcher(timeSpentText);
  if (matcher.matches()) {
    final int timeSpent=Integer.valueOf(matcher.group(1)) * 24 * 60 + Integer.valueOf(matcher.group(2)) * 60 + Integer.valueOf(matcher.group(3));
    final TaskRepository repository=myTask.getRepository();
    if (repository != null && repository.isSupported(TaskRepository.TIME_MANAGEMENT)) {
      try {
        repository.updateTimeSpent(myTask,timeSpent,myCommentTextArea.getText());
        myTask.setLastPost(new Date());
      }
 catch (      Exception e1) {
        Messages.showErrorDialog(myProject,"<html>Could not send information for " + myTask.getPresentableName() + "<br/>"+ e1.getMessage(),"Error");
        LOG.warn(e1);
      }
    }
  }
  super.doOKAction();
}
