{
  NewKeyDialog dlg=new NewKeyDialog(getWindow());
  dlg.show();
  if (dlg.isOK()) {
    final Property property=PropertiesElementFactory.createProperty(myBundle.getProject(),dlg.getName(),dlg.getValue());
    final ReadonlyStatusHandler.OperationStatus operationStatus=ReadonlyStatusHandler.getInstance(myBundle.getProject()).ensureFilesWritable(myBundle.getVirtualFile());
    if (operationStatus.hasReadonlyFiles()) {
      return;
    }
    CommandProcessor.getInstance().executeCommand(myBundle.getProject(),new Runnable(){
      public void run(){
        ApplicationManager.getApplication().runWriteAction(new Runnable(){
          public void run(){
            try {
              myBundle.addProperty(property);
            }
 catch (            IncorrectOperationException e1) {
              LOG.error(e1);
            }
          }
        }
);
      }
    }
,null,null);
    fillPropertyList();
    myModel.update();
    selectKey(dlg.getName());
  }
}
