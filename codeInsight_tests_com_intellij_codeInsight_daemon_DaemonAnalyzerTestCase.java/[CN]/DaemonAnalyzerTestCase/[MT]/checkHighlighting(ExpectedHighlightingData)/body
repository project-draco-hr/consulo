{
  PsiDocumentManager.getInstance(myProject).commitAllDocuments();
  TreeUtil.clearCaches((TreeElement)myFile.getNode());
  myPsiManager.getCacheManager().getFilesWithWord("XXX",UsageSearchContext.IN_COMMENTS,GlobalSearchScope.allScope(myProject),true);
  VirtualFileFilter javaFilesFilter=new VirtualFileFilter(){
    public boolean accept(    VirtualFile file){
      FileType fileType=FileTypeManager.getInstance().getFileTypeByFile(file);
      return (fileType == StdFileTypes.JAVA || fileType == StdFileTypes.CLASS) && !file.getName().equals("package-info.java");
    }
  }
;
  final JavaPsiFacadeEx facade=getJavaFacade();
  if (facade != null) {
    facade.setAssertOnFileLoadingFilter(javaFilesFilter);
  }
  Collection<HighlightInfo> infos=doHighlighting();
  if (facade != null) {
    facade.setAssertOnFileLoadingFilter(VirtualFileFilter.NONE);
  }
  String text=myEditor.getDocument().getText();
  data.checkLineMarkers(DaemonCodeAnalyzerImpl.getLineMarkers(getDocument(getFile()),getProject()),text);
  data.checkResult(infos,text);
  return infos;
}
