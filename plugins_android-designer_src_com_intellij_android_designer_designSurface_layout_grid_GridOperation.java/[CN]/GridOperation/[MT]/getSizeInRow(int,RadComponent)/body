{
  int size=0;
  RadComponent[][] components=getGridInfo().components;
  if (rowIndex < components.length) {
    RadComponent[] rowComponents=components[rowIndex];
    for (int j=0; j < rowComponents.length; j++) {
      RadComponent cellComponent=rowComponents[j];
      if (cellComponent != null) {
        if (cellComponent != excludeComponent) {
          size++;
        }
        while (j + 1 < rowComponents.length && cellComponent == rowComponents[j + 1]) {
          j++;
        }
      }
    }
  }
  return size;
}
