{
  GridInfo gridInfo=getGridInfo();
  Point location=SwingUtilities.convertPoint(myContext.getArea().getFeedbackLayer(),myContext.getLocation(),myFeedback);
  myColumn=getLineIndex(gridInfo.vLines,location.x);
  myRow=getLineIndex(gridInfo.hLines,location.y);
  if (gridInfo.components == null) {
    myInsertType=GridInsertType.in_cell;
    myExist=false;
  }
 else {
    myExist=isExist(myRow,myColumn);
    myInsertType=GridInsertType.in_cell;
    Rectangle cellRect=getInsertRect(myExist);
    Rectangle inCellRect=getInsertInRect(cellRect);
    boolean isExistCell=gridInfo.components != null && myRow < gridInfo.components.length && myColumn < gridInfo.components[0].length;
    if (!inCellRect.contains(location)) {
      if (location.x <= inCellRect.x) {
        if (location.y <= inCellRect.y) {
          if (isExistCell) {
            myInsertType=GridInsertType.corner_top_left;
            myInsertFeedback.cross(myBounds.x + cellRect.x,myBounds.y + cellRect.y,CROSS_SIZE);
          }
        }
 else         if (inCellRect.y < location.y && location.y < inCellRect.getMaxY()) {
          if (myExist && (myColumn == 0 || isExist(myRow,myColumn - 1))) {
            boolean insert=true;
            if (isMoveOperation()) {
              if (myColumn != 0 || getMovedIndex(false) == 0) {
                insert=!isSingleMovedAxis(false);
              }
            }
            if (insert) {
              myInsertType=GridInsertType.before_v_cell;
              cellRect=getInsertRect(false);
              myInsertFeedback.vertical(myBounds.x + cellRect.x,myBounds.y + cellRect.y,cellRect.height);
            }
          }
        }
 else         if (isExistCell) {
          myInsertType=GridInsertType.corner_bottom_left;
          myInsertFeedback.cross(myBounds.x + cellRect.x,myBounds.y + cellRect.y + cellRect.height,CROSS_SIZE);
        }
      }
 else       if (location.x >= inCellRect.getMaxX()) {
        if (location.y <= inCellRect.y) {
          if (isExistCell) {
            myInsertType=GridInsertType.corner_top_right;
            myInsertFeedback.cross(myBounds.x + cellRect.x + cellRect.width,myBounds.y + cellRect.y,CROSS_SIZE);
          }
        }
 else         if (inCellRect.y < location.y && location.y < inCellRect.getMaxY()) {
          if (myExist && (myColumn == gridInfo.lastInsertColumn || isExist(myRow,myColumn + 1))) {
            if (!isMoveOperation() || !isSingleMovedAxis(false)) {
              myInsertType=GridInsertType.after_v_cell;
              cellRect=getInsertRect(false);
              myInsertFeedback.vertical(myBounds.x + cellRect.x + cellRect.width,myBounds.y + cellRect.y,cellRect.height);
            }
          }
        }
 else         if (isExistCell) {
          myInsertType=GridInsertType.corner_bottom_right;
          myInsertFeedback.cross(myBounds.x + cellRect.x + cellRect.width,myBounds.y + cellRect.y + cellRect.height,CROSS_SIZE);
        }
      }
 else       if (location.y <= inCellRect.y) {
        if (myExist && (myRow == 0 || isExist(myRow - 1,myColumn))) {
          boolean insert=true;
          if (isMoveOperation()) {
            if (myRow != 0 || getMovedIndex(true) == 0) {
              insert=!isSingleMovedAxis(true);
            }
          }
          if (insert) {
            myInsertType=GridInsertType.before_h_cell;
            cellRect=getInsertRect(false);
            myInsertFeedback.horizontal(myBounds.x + cellRect.x,myBounds.y + cellRect.y,cellRect.width);
          }
        }
      }
 else       if (location.y >= inCellRect.getMaxY()) {
        if (myExist && (myRow == gridInfo.lastInsertRow || isExist(myRow + 1,myColumn))) {
          if (!isMoveOperation() || !isSingleMovedAxis(true)) {
            myInsertType=GridInsertType.after_h_cell;
            cellRect=getInsertRect(false);
            myInsertFeedback.horizontal(myBounds.x + cellRect.x,myBounds.y + cellRect.y + cellRect.height,cellRect.width);
          }
        }
      }
    }
  }
  if (myInsertType == GridInsertType.in_cell) {
    myInsertFeedback.setVisible(false);
  }
}
