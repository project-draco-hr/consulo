{
  myProject=project;
  PsiTreeChangeListener changeListener=new PsiTreeChangeAdapter(){
    public void childAdded(    PsiTreeChangeEvent event){
      childrenChanged(event);
    }
    public void childRemoved(    PsiTreeChangeEvent event){
      childrenChanged(event);
    }
    public void childReplaced(    PsiTreeChangeEvent event){
      childrenChanged(event);
    }
    public void childMoved(    PsiTreeChangeEvent event){
      childrenChanged(event);
    }
    public void propertyChanged(    PsiTreeChangeEvent event){
      childrenChanged(event);
    }
    public void childrenChanged(    PsiTreeChangeEvent event){
      clearSyntaxErrorFlag(event);
    }
  }
;
  psiManager.addPsiTreeChangeListener(changeListener);
  VirtualFileListener virtualFileListener=new VirtualFileAdapter(){
    public void fileDeleted(    final VirtualFileEvent event){
      onDeleted(event.getFile());
    }
    public void fileMoved(    final VirtualFileMoveEvent event){
      onDeleted(event.getFile());
    }
    private void onDeleted(    final VirtualFile file){
      if (file.isDirectory()) {
        clearInvalidFiles();
      }
 else {
        doRemove(file);
      }
    }
  }
;
  virtualFileManager.addVirtualFileListener(virtualFileListener,myProject);
  FileStatusManager fileStatusManager=FileStatusManager.getInstance(myProject);
  if (fileStatusManager != null) {
    fileStatusManager.addFileStatusListener(new FileStatusListener(){
      public void fileStatusesChanged(){
        clearInvalidFiles();
      }
      public void fileStatusChanged(      @NotNull VirtualFile virtualFile){
        fileStatusesChanged();
      }
    }
);
  }
}
