{
  VirtualFile[] files;
synchronized (myProblems) {
    files=VfsUtil.toVirtualFileArray(myProblems.keySet());
  }
  for (  VirtualFile problemFile : files) {
    if (!problemFile.isValid() || !isToBeHighlighted(problemFile)) {
      doRemove(problemFile);
    }
  }
}
