{
  Project project=(Project)dataContext.getData(DataConstants.PROJECT);
  if (project == null)   return null;
  Module moduleContext=(Module)dataContext.getData(DataConstants.MODULE_CONTEXT);
  Object elements=collectSelectedElements(dataContext);
  if (elements == null)   return null;
  Collection<AbstractTreeNode> treeNodes=createNodes(project,moduleContext,elements,inProjectView,favoritesConfig);
  return treeNodes.size() == 0 ? null : treeNodes.toArray(new AbstractTreeNode[treeNodes.size()]);
}
