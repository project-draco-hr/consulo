{
  Project project=DataKeys.PROJECT.getData(dataContext);
  if (project == null)   return null;
  Module moduleContext=DataKeys.MODULE_CONTEXT.getData(dataContext);
  Collection<AbstractTreeNode> nodesToAdd=null;
  FavoriteNodeProvider[] providers=Extensions.getExtensions(FavoriteNodeProvider.EP_NAME);
  for (  FavoriteNodeProvider provider : providers) {
    nodesToAdd=provider.getFavoriteNodes(dataContext,ViewSettings.DEFAULT);
    if (nodesToAdd != null) {
      break;
    }
  }
  if (nodesToAdd == null) {
    Object elements=collectSelectedElements(dataContext);
    if (elements != null) {
      nodesToAdd=createNodes(project,moduleContext,elements,inProjectView,ViewSettings.DEFAULT);
    }
  }
  return nodesToAdd;
}
