{
  myFindModel=findModel;
  myProject=project;
  myEditor=editor;
  mySearchResults=new SearchResults(myEditor,myProject);
  myDefaultBackground=new JTextField().getBackground();
  configureLeadPanel();
  new SwitchToFind(this);
  new SwitchToReplace(this);
  myFindModel.addObserver(new FindModel.FindModelObserver(){
    @Override public void findModelChanged(    FindModel findModel){
      String stringToFind=myFindModel.getStringToFind();
      if (!wholeWordsApplicable(stringToFind)) {
        myFindModel.setWholeWordsOnly(false);
      }
      updateUIWithFindModel();
      updateResults(true);
      syncFindModels(FindManager.getInstance(myProject).getFindInFileModel(),myFindModel);
    }
  }
);
  updateUIWithFindModel();
  myEditor.getDocument().addDocumentListener(myDocumentListener);
  if (ApplicationManager.getApplication().isUnitTestMode()) {
    initLivePreview();
  }
}
