{
  JPanel myLeadPanel=createLeadPane();
  myRightComponent.add(myLeadPanel,BorderLayout.WEST);
  Ref<JComponent> ref=Ref.create();
  mySearchField=createTextField(BorderLayout.NORTH,ref);
  mySearchRootComponent=ref.get();
  SearchTextField searchTextField=(ref.get() instanceof SearchTextField) ? (SearchTextField)ref.get() : null;
  if (searchTextField != null) {
    setupHistoryToSearchField(searchTextField,FindSettings.getInstance().getRecentFindStrings());
  }
  UIUtil.addUndoRedoActions(mySearchField);
  setupSearchFieldListener();
  if (myActionsToolbar == null) {
    initToolbar();
  }
  JPanel centerPanel=new JPanel(new BorderLayout());
  centerPanel.setOpaque(false);
  centerPanel.add(myToolbarComponent,BorderLayout.CENTER);
  myRightComponent.add(centerPanel,BorderLayout.CENTER);
  if (myToolbarComponent instanceof ActionToolbarImpl) {
    new ShowMoreOptions(myToolbarComponent,mySearchField);
  }
  JPanel tailPanel=new NonOpaquePanel(new BorderLayout(5,0));
  JPanel tailContainer=new NonOpaquePanel(new BorderLayout(5,0));
  tailContainer.add(tailPanel,BorderLayout.EAST);
  centerPanel.add(tailContainer,BorderLayout.EAST);
  JLabel closeLabel=new JLabel(" ",AllIcons.Actions.Cross,SwingConstants.RIGHT);
  closeLabel.addMouseListener(new MouseAdapter(){
    @Override public void mousePressed(    final MouseEvent e){
      close();
    }
  }
);
  closeLabel.setToolTipText("Close search bar (Escape)");
  tailPanel.add(closeLabel,BorderLayout.EAST);
  Utils.setSmallerFont(mySearchField);
  mySearchField.registerKeyboardAction(new ActionListener(){
    @Override public void actionPerformed(    final ActionEvent e){
      if (StringUtil.isEmpty(mySearchField.getText())) {
        close();
      }
 else {
        requestFocus(myEditor.getContentComponent());
        addTextToRecent(EditorSearchComponent.this.mySearchField);
      }
    }
  }
,KeyStroke.getKeyStroke(KeyEvent.VK_ENTER,SystemInfo.isMac ? InputEvent.META_DOWN_MASK : InputEvent.CTRL_DOWN_MASK),JComponent.WHEN_FOCUSED);
  final String initialText=myFindModel.getStringToFind();
  ApplicationManager.getApplication().invokeLater(new Runnable(){
    @Override public void run(){
      setInitialText(initialText);
    }
  }
);
  new RestorePreviousSettingsAction(this,mySearchField);
  new VariantsCompletionAction(this,mySearchFieldGetter);
  Utils.setSmallerFontForChildren(myToolbarComponent);
}
