{
  JPanel replacement=createLeadPane();
  myReplaceField=createTextField();
  configureTextField(myReplaceField);
  myReplaceField.registerKeyboardAction(new ActionListener(){
    @Override public void actionPerformed(    ActionEvent actionEvent){
      myLivePreviewController.performReplace();
    }
  }
,KeyStroke.getKeyStroke(KeyEvent.VK_ENTER,0),JComponent.WHEN_FOCUSED);
  replacement.add(myReplaceField);
  add(replacement,BorderLayout.SOUTH);
  myPreserveCase=new JCheckBox("Preserve case");
  mySelectionOnly=new JCheckBox("Selection only");
  final FindModel findInFileModel=FindManager.getInstance(myProject).getFindInFileModel();
  myPreserveCase.addActionListener(new ActionListener(){
    @Override public void actionPerformed(    ActionEvent actionEvent){
      final boolean b=myPreserveCase.isSelected();
      findInFileModel.setPreserveCase(b);
      updateResults(true);
    }
  }
);
  myPreserveCase.setMnemonic('P');
  mySelectionOnly.addActionListener(new ActionListener(){
    @Override public void actionPerformed(    ActionEvent actionEvent){
      updateModelWithSelectionMode(findInFileModel);
      updateResults(true);
    }
  }
);
  mySelectionOnly.setMnemonic('S');
  updateModelWithSelectionMode(findInFileModel);
  mySelectionOnly.setSelected(!findInFileModel.isGlobal());
  myPreserveCase.setSelected(findInFileModel.isPreserveCase());
  myPreserveCase.setEnabled(!findInFileModel.isRegularExpressions());
  myReplaceButton=new JButton("Replace");
  myReplaceButton.addActionListener(new ActionListener(){
    @Override public void actionPerformed(    ActionEvent actionEvent){
      myLivePreviewController.performReplace();
    }
  }
);
  myReplaceButton.setMnemonic('p');
  myReplaceAllButton=new JButton("Replace all");
  myReplaceAllButton.addActionListener(new ActionListener(){
    @Override public void actionPerformed(    ActionEvent actionEvent){
      myLivePreviewController.performReplaceAll();
    }
  }
);
  myReplaceAllButton.setMnemonic('a');
  myExcludeButton=new JButton("");
  updateExcludeStatus();
  myExcludeButton.addActionListener(new ActionListener(){
    @Override public void actionPerformed(    ActionEvent actionEvent){
      myLivePreviewController.exclude();
    }
  }
);
  myExcludeButton.setMnemonic('l');
  replacement.add(myReplaceButton);
  replacement.add(myReplaceAllButton);
  replacement.add(myExcludeButton);
  myOptionsPane.add(mySelectionOnly);
  myOptionsPane.add(myPreserveCase);
  setSmallerFontAndOpaque(myReplaceButton);
  setSmallerFontAndOpaque(myReplaceAllButton);
  setSmallerFontAndOpaque(myExcludeButton);
  setSmallerFontAndOpaque(mySelectionOnly);
  setSmallerFontAndOpaque(myPreserveCase);
  setSmallerFont(myReplaceField);
}
