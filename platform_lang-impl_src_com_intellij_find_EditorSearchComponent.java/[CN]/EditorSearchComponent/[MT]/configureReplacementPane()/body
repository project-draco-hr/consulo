{
  myReplacementPane=createLeadPane();
  myReplaceField=createTextField(myReplacementPane);
  DocumentAdapter replaceFieldListener=new DocumentAdapter(){
    @Override public void documentChanged(    DocumentEvent event){
      setMatchesLimit(MATCHES_LIMIT);
      myFindModel.setStringToReplace(myReplaceField.getText());
    }
  }
;
  myReplaceField.addDocumentListener(replaceFieldListener);
  myDocumentListeners.put(myReplaceField,replaceFieldListener);
  new ReplaceOnEnterAction(this,myReplaceField);
  myReplaceField.setText(myFindModel.getStringToReplace());
  add(myReplacementPane,BorderLayout.SOUTH);
  myReplaceButton=new JButton("Replace");
  myReplaceButton.addActionListener(new ActionListener(){
    @Override public void actionPerformed(    ActionEvent actionEvent){
      replaceCurrent();
    }
  }
);
  myReplaceButton.setMnemonic('p');
  myReplaceAllButton=new JButton("Replace all");
  myReplaceAllButton.addActionListener(new ActionListener(){
    @Override public void actionPerformed(    ActionEvent actionEvent){
      myLivePreviewController.performReplaceAll();
    }
  }
);
  myReplaceAllButton.setMnemonic('a');
  myExcludeButton=new JButton("");
  myExcludeButton.addActionListener(new ActionListener(){
    @Override public void actionPerformed(    ActionEvent actionEvent){
      myLivePreviewController.exclude();
    }
  }
);
  myExcludeButton.setMnemonic('l');
  ActionGroup actionsGroup=new DefaultActionGroup(new ShowHistoryAction(myReplaceField,this));
  final ActionToolbar tb=ActionManager.getInstance().createActionToolbar("ReplaceBar",actionsGroup,true);
  tb.setLayoutPolicy(ActionToolbar.AUTO_LAYOUT_POLICY);
  final JComponent tbComponent=tb.getComponent();
  tbComponent.setOpaque(false);
  tbComponent.setBorder(null);
  myReplacementPane.add(tbComponent);
  myReplacementPane.add(myReplaceButton);
  myReplacementPane.add(myReplaceAllButton);
  myReplacementPane.add(myExcludeButton);
  setSmallerFontAndOpaque(myReplaceButton);
  setSmallerFontAndOpaque(myReplaceAllButton);
  setSmallerFontAndOpaque(myExcludeButton);
  setSmallerFont(myReplaceField);
  myReplaceField.putClientProperty("AuxEditorComponent",Boolean.TRUE);
  new VariantsCompletionAction(this,myReplaceField);
  new NextOccurrenceAction(this,myReplaceField);
  new PrevOccurrenceAction(this,myReplaceField);
  myReplaceRegexpFieldController=new RegexpFieldController(myReplaceField,myFindModel,this);
}
