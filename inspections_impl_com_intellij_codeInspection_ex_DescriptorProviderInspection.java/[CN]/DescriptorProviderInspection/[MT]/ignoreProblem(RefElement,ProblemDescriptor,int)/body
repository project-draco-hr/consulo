{
  if (refElement == null)   return;
  final Set<LocalQuickFix> localQuickFixes=myQuickFixActions.get(refElement);
  final LocalQuickFix[] fixes=problem.getFixes();
  if (isIgnoreProblem(fixes,localQuickFixes,idx)) {
    myProblemToElements.remove(problem);
    ProblemDescriptor[] descriptors=myProblemElements.get(refElement);
    if (descriptors != null) {
      ArrayList<ProblemDescriptor> newDescriptors=new ArrayList<ProblemDescriptor>(Arrays.asList(descriptors));
      newDescriptors.remove(problem);
      if (newDescriptors.size() > 0) {
        myProblemElements.put(refElement,newDescriptors.toArray(new ProblemDescriptor[newDescriptors.size()]));
      }
 else {
        myProblemElements.remove(refElement);
      }
    }
  }
  if (idx == -1) {
    myQuickFixActions.put(refElement,null);
  }
 else {
    if (localQuickFixes != null && fixes != null) {
      if (fixes.length > idx) {
        localQuickFixes.remove(fixes[idx]);
      }
    }
  }
}
