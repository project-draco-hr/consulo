{
  final Element parentNode=new Element(InspectionsBundle.message("inspection.problems"));
  exportResults(descriptions,refElement,parentNode);
  final List list=parentNode.getChildren();
  @NonNls final String ext=".xml";
  final String fileName=ourOutputPath + File.separator + getShortName()+ ext;
  final ReplacePathToMacroMap replacements=((ProjectEx)getContext().getProject()).getMacroReplacements();
  PrintWriter printWriter=null;
  try {
    new File(ourOutputPath).mkdirs();
    final File file=new File(fileName);
    final CharArrayWriter writer=new CharArrayWriter();
    for (    Object o : list) {
      final Element element=(Element)o;
      replacements.substitute(element,SystemInfo.isFileSystemCaseSensitive);
      JDOMUtil.writeElement(element,writer,"\n");
    }
    printWriter=new PrintWriter(new BufferedWriter(new FileWriter(file,true)));
    printWriter.append("\n");
    printWriter.append(writer.toString());
  }
 catch (  IOException e) {
    LOG.error(e);
  }
 finally {
    if (printWriter != null) {
      printWriter.close();
    }
  }
}
