{
  myClass=aClass;
  PsiElement parent=expression != null ? expression.getParent() : null;
  while (parent instanceof PsiParenthesizedExpression) {
    parent=parent.getParent();
  }
  if (parent instanceof PsiExpressionList) {
    final PsiElement gParent=parent.getParent();
    if (gParent instanceof PsiCall) {
      final Pair<PsiMethod,PsiSubstitutor> pair=MethodCandidateInfo.getCurrentMethod(parent);
      myMethod=pair != null ? pair.first : null;
      if (myMethod == null) {
        myMethod=((PsiCall)gParent).resolveMethod();
      }
      if (myMethod != null && PsiTreeUtil.isAncestor(myMethod,expression,false)) {
        myMethod=null;
      }
    }
  }
}
