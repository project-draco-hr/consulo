{
  if (file instanceof PsiJavaFile) {
    final PsiImportList newImportList=CodeStyleManager.getInstance(myProject).prepareOptimizeImportsResult(file);
    return new Runnable(){
      public void run(){
        try {
          if (newImportList != null) {
            final PsiDocumentManager manager=PsiDocumentManager.getInstance(file.getProject());
            final Document document=manager.getDocument(file);
            if (document != null) {
              manager.commitDocument(document);
            }
            ((PsiJavaFile)file).getImportList().replace(newImportList);
          }
        }
 catch (        IncorrectOperationException e) {
          LOG.error(e);
        }
      }
    }
;
  }
 else {
    return EmptyRunnable.getInstance();
  }
}
