{
  super(new BorderLayout());
  myProject=project;
  myCapableOfExcludingChanges=capableOfExcludingChanges;
  myViewer=new ChangesTreeList(myProject,changes,capableOfExcludingChanges,highlightProblems);
  myViewer.setDoubleClickHandler(new Runnable(){
    public void run(){
      showDiff();
    }
  }
);
  setInitialSelection(changeLists,changes,initialListSelection);
  rebuildList();
  myListPanel=new JPanel(new BorderLayout());
  myListPanel.add(myViewer,BorderLayout.CENTER);
  JComponent separator=SeparatorFactory.createSeparator(VcsBundle.message("commit.dialog.changed.files.label"),myViewer);
  myListPanel.add(separator,BorderLayout.NORTH);
  add(myListPanel,BorderLayout.CENTER);
  myHeaderPanel=new JPanel(new BorderLayout());
  myHeaderPanel.add(createToolbar(),BorderLayout.WEST);
  add(myHeaderPanel,BorderLayout.NORTH);
  myViewer.installPopupHandler(myToolBarGroup);
  myViewer.setShowFlatten(PropertiesComponent.getInstance(myProject).isTrueValue(FLATTEN_OPTION_KEY));
}
