{
  super(new BorderLayout());
  myProject=project;
  myCapableOfExcludingChanges=capableOfExcludingChanges;
  myViewer=new ChangesTreeList(myProject,changes,capableOfExcludingChanges,highlightProblems);
  myViewer.setDoubleClickHandler(new Runnable(){
    public void run(){
      showDiff();
    }
  }
);
  setInitialSelection(changeLists,changes,initialListSelection);
  rebuildList();
  JPanel listPanel=new JPanel(new BorderLayout());
  listPanel.add(myViewer);
  listPanel.setBorder(IdeBorderFactory.createTitledHeaderBorder(VcsBundle.message("commit.dialog.changed.files.label")));
  add(listPanel,BorderLayout.CENTER);
  myHeaderPanel=new JPanel(new BorderLayout());
  myHeaderPanel.add(createToolbar(),BorderLayout.WEST);
  add(myHeaderPanel,BorderLayout.NORTH);
  myViewer.installPopupHandler(myToolBarGroup);
  myViewer.setShowFlatten(PropertiesComponent.getInstance(myProject).isTrueValue(FLATTEN_OPTION_KEY));
}
