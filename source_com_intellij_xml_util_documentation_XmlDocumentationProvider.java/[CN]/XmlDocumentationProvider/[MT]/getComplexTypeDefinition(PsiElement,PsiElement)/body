{
  XmlElementDescriptor descriptor=element.getUserData(DESCRIPTOR_KEY);
  if (descriptor == null && originalElement.getParent() instanceof XmlTag) {
    descriptor=((XmlTag)originalElement.getParent()).getDescriptor();
  }
  if (descriptor instanceof XmlElementDescriptorImpl) {
    TypeDescriptor type=((XmlElementDescriptorImpl)descriptor).getType();
    if (type instanceof ComplexTypeDescriptor) {
      return ((ComplexTypeDescriptor)type).getDeclaration();
    }
  }
  return null;
}
