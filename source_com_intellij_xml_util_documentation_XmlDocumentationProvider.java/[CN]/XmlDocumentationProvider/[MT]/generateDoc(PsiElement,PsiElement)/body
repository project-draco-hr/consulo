{
  if (element instanceof XmlElementDecl) {
    PsiElement curElement=element;
    while (curElement != null && !(curElement instanceof XmlComment)) {
      curElement=curElement.getPrevSibling();
      if (curElement != null && curElement.getClass() == element.getClass()) {
        curElement=null;
        break;
      }
    }
    if (curElement != null) {
      String text=curElement.getText();
      text=text.substring("<!--".length(),text.length() - "-->".length()).trim();
      return generateDoc(text,((XmlElementDecl)element).getNameElement().getText(),null);
    }
  }
 else   if (element instanceof XmlTag) {
    XmlTag tag=(XmlTag)element;
    MyPsiElementProcessor processor=new MyPsiElementProcessor();
    XmlUtil.processXmlElements(tag,processor,true);
    String name=tag.getAttributeValue("name");
    String typeName=null;
    if (processor.result == null) {
      XmlElementDescriptor descriptor=element.getUserData(DESCRIPTOR_KEY);
      if (descriptor == null && originalElement.getParent() instanceof XmlTag) {
        descriptor=((XmlTag)originalElement.getParent()).getDescriptor();
      }
      if (descriptor instanceof XmlElementDescriptorImpl) {
        TypeDescriptor type=((XmlElementDescriptorImpl)descriptor).getType();
        if (type instanceof ComplexTypeDescriptor) {
          XmlTag declaration=((ComplexTypeDescriptor)type).getDeclaration();
          XmlUtil.processXmlElements(declaration,processor,true);
          typeName=declaration.getName();
        }
      }
    }
    return generateDoc(processor.result,name,typeName);
  }
  return null;
}
