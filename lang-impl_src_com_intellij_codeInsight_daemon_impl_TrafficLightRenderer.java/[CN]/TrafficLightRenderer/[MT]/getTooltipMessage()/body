{
  DaemonCodeAnalyzerStatus status=getDaemonCodeAnalyzerStatus(true);
  if (status == null)   return null;
  @NonNls String text=HTML_HEADER;
  if (status.noHighlightingRoots != null && status.noHighlightingRoots.length == status.rootsNumber) {
    text+=DaemonBundle.message("analysis.hasnot.been.run");
    text+=HTML_FOOTER;
    return text;
  }
  if (status.errorAnalyzingFinished) {
    text+=DaemonBundle.message("analysis.completed");
  }
 else {
    text+=DaemonBundle.message("performing.code.analysis");
    text+="<table>";
    for (    DaemonCodeAnalyzerStatus.PassStatus passStatus : status.passStati) {
      if (passStatus.finished)       continue;
      text+="<tr><td>" + passStatus.name + ":</td><td>"+ renderProgressHtml(passStatus.progress)+ "</td></tr>";
    }
    text+="</table>";
  }
  int currentSeverityErrors=0;
  for (int i=status.errorCount.length - 1; i >= 0; i--) {
    if (status.errorCount[i] > 0) {
      final HighlightSeverity severity=SeverityRegistrar.getInstance(myProject).getSeverityByIndex(i);
      text+=BR;
      String name=status.errorCount[i] > 1 ? StringUtil.pluralize(severity.toString().toLowerCase()) : severity.toString().toLowerCase();
      text+=status.errorAnalyzingFinished ? DaemonBundle.message("errors.found",status.errorCount[i],name) : DaemonBundle.message("errors.found.so.far",status.errorCount[i],name);
      currentSeverityErrors+=status.errorCount[i];
    }
  }
  if (currentSeverityErrors == 0) {
    text+=BR;
    text+=status.errorAnalyzingFinished ? DaemonBundle.message("no.errors.or.warnings.found") : DaemonBundle.message("no.errors.or.warnings.found.so.far");
  }
  text+=getMessageByRoots(status.noHighlightingRoots,status.rootsNumber,"no.syntax.highlighting.performed");
  text+=getMessageByRoots(status.noInspectionRoots,status.rootsNumber,"no.inspections.performed");
  text+=HTML_FOOTER;
  return text;
}
