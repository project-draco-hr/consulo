{
  final List<PsiVariable> inputVariables=ControlFlowUtil.getInputVariables(myControlFlow,myFlowStart,myFlowEnd);
  List<PsiVariable> myInputVariables;
  if (myGenerateConditionalExit) {
    List<PsiVariable> inputVariableList=new ArrayList<PsiVariable>(inputVariables);
    removeParametersUsedInExitsOnly(codeFragment,inputVariableList);
    myInputVariables=inputVariableList;
  }
 else {
    List<PsiVariable> inputVariableList=new ArrayList<PsiVariable>(inputVariables);
    for (Iterator<PsiVariable> iterator=inputVariableList.iterator(); iterator.hasNext(); ) {
      PsiVariable variable=iterator.next();
      for (      PsiElement element : elements) {
        if (PsiTreeUtil.isAncestor(element,variable,false)) {
          iterator.remove();
          break;
        }
      }
    }
    myInputVariables=inputVariableList;
  }
  Collections.sort(myInputVariables,new Comparator<PsiVariable>(){
    public int compare(    final PsiVariable v1,    final PsiVariable v2){
      if (v1.getType() instanceof PsiEllipsisType) {
        return 1;
      }
      if (v2.getType() instanceof PsiEllipsisType) {
        return -1;
      }
      return v1.getTextOffset() - v2.getTextOffset();
    }
  }
);
  return myInputVariables;
}
