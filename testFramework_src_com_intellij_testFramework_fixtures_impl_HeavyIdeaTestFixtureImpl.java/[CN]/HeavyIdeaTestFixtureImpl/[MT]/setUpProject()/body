{
  ProjectManagerEx projectManager=ProjectManagerEx.getInstanceEx();
  File projectFile=File.createTempFile(PROJECT_FILE_PREFIX,PROJECT_FILE_SUFFIX);
  myFilesToDelete.add(projectFile);
  LocalFileSystem.getInstance().refreshAndFindFileByIoFile(projectFile);
  myProject=projectManager.newProject(FileUtil.getNameWithoutExtension(projectFile),projectFile.getPath(),false,false);
  ByteArrayOutputStream buffer=new ByteArrayOutputStream();
  new Throwable(projectFile.getPath()).printStackTrace(new PrintStream(buffer));
  markProjectCreationPlace(myProject,buffer.toString());
  for (  ModuleFixtureBuilder moduleFixtureBuilder : myModuleFixtureBuilders) {
    moduleFixtureBuilder.getFixture().setUp();
  }
  StartupManagerImpl sm=(StartupManagerImpl)StartupManager.getInstance(myProject);
  sm.runStartupActivities();
  sm.runPostStartupActivities();
  ProjectManagerEx.getInstanceEx().setCurrentTestProject(myProject);
}
