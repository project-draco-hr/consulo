{
  TextRange textRange=((ProblemDescriptorImpl)problemDescriptor).getTextRange();
  PsiElement element=problemDescriptor.getPsiElement();
  HighlightInfo highlightInfo=HighlightInfo.createHighlightInfo(highlightInfoType,element,textRange.getStartOffset(),textRange.getEndOffset(),message,toolTip);
  highlightInfo.isAfterEndOfLine=problemDescriptor.isAfterEndOfLine();
  if (element instanceof PsiFile && textRange.equals(element.getTextRange())) {
    highlightInfo.isFileLevelAnnotation=true;
  }
  return highlightInfo;
}
