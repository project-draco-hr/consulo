{
  PsiElement psiElement=descriptor.getPsiElement();
  if (psiElement == null)   return null;
  @NonNls String message=renderDescriptionMessage(descriptor);
  final HighlightDisplayKey key=HighlightDisplayKey.find(tool.getShortName());
  final InspectionProfile inspectionProfile=InspectionProjectProfileManager.getInstance(myProject).getInspectionProfile(myFile);
  if (!inspectionProfile.isToolEnabled(key))   return null;
  HighlightInfoType type=new HighlightInfoType.HighlightInfoTypeImpl(inspectionProfile.getErrorLevel(key).getSeverity(),level.getAttributesKey());
  String plainMessage=message.startsWith("<html>") ? XmlUtil.unescape(message.replaceAll("<[^>]*>","")) : message;
  @NonNls String tooltip=message.startsWith("<html>") ? message : "<html><body>" + XmlStringUtil.escapeString(message) + "</body></html>";
  HighlightInfo highlightInfo=highlightInfoFromDescriptor(descriptor,type,plainMessage,tooltip);
  registerQuickFixes(tool,psiElement,descriptor,highlightInfo,emptyActionRegistered);
  return highlightInfo;
}
