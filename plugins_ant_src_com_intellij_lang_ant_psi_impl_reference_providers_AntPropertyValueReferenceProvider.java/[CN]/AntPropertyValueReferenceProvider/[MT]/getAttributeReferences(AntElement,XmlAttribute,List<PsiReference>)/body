{
  final String value=attr.getValue();
  final int offsetInPosition=attr.getValueElement().getTextRange().getStartOffset() - element.getTextRange().getStartOffset() + 1;
  int startIndex;
  int endIndex=-1;
  while ((startIndex=value.indexOf("${",endIndex + 1)) > endIndex) {
    endIndex=value.indexOf('}',startIndex);
    if (endIndex < 0)     break;
    startIndex+=2;
    if (endIndex > startIndex) {
      final String propName=value.substring(startIndex,endIndex);
      AntElement temp=element;
      AntProperty result=null;
      do {
        temp=temp.getAntParent();
        if (temp == null)         break;
      }
 while ((result=temp.getProperty(propName)) == null);
      if (result != null) {
        refs.add(new AntPropertyReference(this,element,propName,new TextRange(offsetInPosition + startIndex,offsetInPosition + endIndex),attr));
      }
    }
  }
}
