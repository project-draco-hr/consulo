{
  Project p;
  if (ProjectManager.getInstance().getOpenProjects().length > 0) {
    p=ProjectManager.getInstance().getOpenProjects()[0];
  }
 else {
    p=ProjectManager.getInstance().getDefaultProject();
  }
  final Project project=p;
  CheckoutDialog dialog=new CheckoutDialog(project);
  dialog.show();
  if (!dialog.isOK() || dialog.getSelectedURL() == null || dialog.getSelectedFile() == null) {
    return;
  }
  try {
    final SVNException[] exception=new SVNException[1];
    final SVNUpdateClient client=SvnVcs.getInstance(project).createUpdateClient();
    final String url=dialog.getSelectedURL();
    final File target=new File(dialog.getSelectedFile());
    ApplicationManager.getApplication().runProcessWithProgressSynchronously(new Runnable(){
      public void run(){
        ProgressIndicator progressIndicator=ProgressManager.getInstance().getProgressIndicator();
        client.setEventHandler(new CheckoutEventHandler(SvnVcs.getInstance(project),progressIndicator));
        try {
          progressIndicator.setText("Checking out files to '" + target.getAbsolutePath() + "'");
          client.doCheckout(url,target,SVNRevision.UNDEFINED,SVNRevision.HEAD,true);
        }
 catch (        SVNException e) {
          exception[0]=e;
        }
 finally {
          client.setEventHandler(null);
        }
      }
    }
,"Check Out from Subversion",false,null);
    if (exception[0] != null) {
      throw exception[0];
    }
  }
 catch (  SVNException e1) {
    Messages.showErrorDialog("Cannot checkout from svn: " + e1.getMessage(),"Check Out from Subversion");
  }
}
