{
  final PsiComment selectedComment=(PsiComment)element;
  PsiComment firstComment=selectedComment;
  while (true) {
    final PsiElement prevComment=getPrevNonWhiteSpace(firstComment);
    if (!isEndOfLineComment(prevComment)) {
      break;
    }
    firstComment=(PsiComment)prevComment;
  }
  final PsiManager manager=selectedComment.getManager();
  final PsiElementFactory factory=manager.getElementFactory();
  String text=getCommentContents(firstComment);
  final List<PsiElement> commentsToDelete=new ArrayList<PsiElement>();
  PsiElement nextComment=firstComment;
  while (true) {
    nextComment=getNextNonWhiteSpace(nextComment);
    if (!isEndOfLineComment(nextComment)) {
      break;
    }
    text+=nextComment.getPrevSibling().getText() + "  " + getCommentContents((PsiComment)nextComment);
    commentsToDelete.add(nextComment);
  }
  final PsiComment newComment=factory.createCommentFromText("/*" + text + " */",selectedComment.getParent());
  final PsiElement insertedElement=firstComment.replace(newComment);
  final CodeStyleManager codeStyleManager=manager.getCodeStyleManager();
  for (  PsiElement commentToDelete : commentsToDelete) {
    commentToDelete.delete();
  }
}
