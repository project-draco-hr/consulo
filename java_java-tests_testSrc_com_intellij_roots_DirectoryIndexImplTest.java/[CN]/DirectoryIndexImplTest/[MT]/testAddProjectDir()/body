{
  new WriteCommandAction.Simple(getProject()){
    @Override protected void run() throws Throwable {
      VirtualFile newDir=myModule1Dir.getParent().createChildDirectory(null,"newDir");
      newDir.createChildDirectory(null,"subdir");
      myIndex.checkConsistency();
      ModifiableRootModel rootModel=ModuleRootManager.getInstance(myModule).getModifiableModel();
      rootModel.addContentEntry(newDir);
      rootModel.commit();
    }
  }
.execute().throwException();
  myIndex.checkConsistency();
}
