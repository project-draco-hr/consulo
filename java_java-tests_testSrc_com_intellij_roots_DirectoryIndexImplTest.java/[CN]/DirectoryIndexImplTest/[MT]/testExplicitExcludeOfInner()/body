{
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    @Override public void run(){
      ModifiableRootModel rootModel=ModuleRootManager.getInstance(myModule).getModifiableModel();
      ContentEntry[] contentEntries=rootModel.getContentEntries();
      assertEquals(1,contentEntries.length);
      ContentEntry contentEntry=contentEntries[0];
      contentEntry.addExcludeFolder(myModule2Dir);
      rootModel.commit();
    }
  }
);
  myIndex.checkConsistency();
  checkInfo(myModule2Dir,myModule2,false,false,false,false,null,new Module[]{});
  checkInfo(mySrcDir2,myModule2,true,false,false,false,"",new Module[]{myModule2,myModule3});
}
