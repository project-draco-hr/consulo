{
  String rootPath=myModule1Dir.getPath();
  final File f=new File(rootPath,"excludedDir/dir/anotherContentRoot");
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    @Override public void run(){
      ModifiableRootModel rootModel=ModuleRootManager.getInstance(myModule).getModifiableModel();
      rootModel.getContentEntries()[0].addExcludeFolder(VfsUtilCore.pathToUrl(FileUtil.toSystemIndependentName(f.getParentFile().getParent())));
      rootModel.commit();
      rootModel=ModuleRootManager.getInstance(myModule2).getModifiableModel();
      rootModel.addContentEntry(VfsUtilCore.pathToUrl(FileUtil.toSystemIndependentName(f.getPath())));
      rootModel.commit();
      assertTrue(f.getPath(),f.exists() || f.mkdirs());
      LocalFileSystem.getInstance().refresh(false);
    }
  }
);
  assertNull(myIndex.getInfoForDirectory(LocalFileSystem.getInstance().findFileByIoFile(f.getParentFile().getParentFile())));
  assertNotNull(myIndex.getInfoForDirectory(LocalFileSystem.getInstance().findFileByIoFile(f)));
}
