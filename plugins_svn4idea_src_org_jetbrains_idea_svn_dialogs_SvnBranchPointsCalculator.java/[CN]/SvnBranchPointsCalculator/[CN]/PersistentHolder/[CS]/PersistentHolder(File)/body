{
  myLock=new Object();
  myPersistentMap=new PersistentHashMap<String,TreeMap<String,BranchCopyData>>(file,new EnumeratorStringDescriptor(),new BranchDataExternalizer());
  final Ref<IOException> excRef=new Ref<IOException>();
  myForSearchMap=new MultiMap<String,String>();
  myPersistentMap.processKeys(new Processor<String>(){
    public boolean process(    final String s){
      try {
        final TreeMap<String,BranchCopyData> map=myPersistentMap.get(s);
        if (map != null) {
          myForSearchMap.put(s,new ArrayList<String>(map.keySet()));
        }
      }
 catch (      IOException e) {
        excRef.set(e);
        return false;
      }
      return true;
    }
  }
);
  if (!excRef.isNull()) {
    throw excRef.get();
  }
  for (  String key : myForSearchMap.keySet()) {
    Collections.sort((List<String>)myForSearchMap.get(key));
  }
}
