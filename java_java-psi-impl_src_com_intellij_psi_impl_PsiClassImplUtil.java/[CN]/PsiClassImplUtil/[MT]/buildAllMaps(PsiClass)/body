{
  final List<Pair<PsiMember,PsiSubstitutor>> classes=new ArrayList<Pair<PsiMember,PsiSubstitutor>>();
  final List<Pair<PsiMember,PsiSubstitutor>> fields=new ArrayList<Pair<PsiMember,PsiSubstitutor>>();
  final List<Pair<PsiMember,PsiSubstitutor>> methods=new ArrayList<Pair<PsiMember,PsiSubstitutor>>();
  FilterScopeProcessor<MethodCandidateInfo> processor=new FilterScopeProcessor<MethodCandidateInfo>(new OrFilter(ElementClassFilter.METHOD,ElementClassFilter.FIELD,ElementClassFilter.CLASS)){
    @Override protected void add(    PsiElement element,    PsiSubstitutor substitutor){
      if (element instanceof PsiMethod) {
        methods.add(new Pair<PsiMember,PsiSubstitutor>((PsiMethod)element,substitutor));
      }
 else       if (element instanceof PsiField) {
        fields.add(new Pair<PsiMember,PsiSubstitutor>((PsiField)element,substitutor));
      }
 else       if (element instanceof PsiClass) {
        classes.add(new Pair<PsiMember,PsiSubstitutor>((PsiClass)element,substitutor));
      }
    }
  }
;
  processDeclarationsInClassNotCached(psiClass,processor,ResolveState.initial(),new THashSet<PsiClass>(),null,psiClass,false);
  Map<Class<? extends PsiMember>,Map<String,List<Pair<PsiMember,PsiSubstitutor>>>> result=new HashMap<Class<? extends PsiMember>,Map<String,List<Pair<PsiMember,PsiSubstitutor>>>>(3);
  result.put(PsiClass.class,generateMapByList(classes));
  result.put(PsiMethod.class,generateMapByList(methods));
  result.put(PsiField.class,generateMapByList(fields));
  return result;
}
