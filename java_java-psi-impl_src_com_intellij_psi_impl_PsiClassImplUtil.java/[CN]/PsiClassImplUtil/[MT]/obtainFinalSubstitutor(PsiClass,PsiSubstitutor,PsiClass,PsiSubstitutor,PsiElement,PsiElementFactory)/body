{
  if (PsiUtil.isRawSubstitutor(aClass,substitutor)) {
    return elementFactory.createRawSubstitutor(candidateClass);
  }
  final PsiType containingType=elementFactory.createType(candidateClass,candidateSubstitutor,PsiUtil.getLanguageLevel(place));
  PsiType type=substitutor.substitute(containingType);
  if (!(type instanceof PsiClassType))   return candidateSubstitutor;
  return ((PsiClassType)type).resolveGenerics().getSubstitutor();
}
