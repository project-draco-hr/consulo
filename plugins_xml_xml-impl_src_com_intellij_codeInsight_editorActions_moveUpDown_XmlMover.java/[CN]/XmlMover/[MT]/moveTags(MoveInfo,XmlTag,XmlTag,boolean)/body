{
  if (target.getParent() == moved) {
    XmlTag next=down ? PsiTreeUtil.getNextSiblingOfType(moved,XmlTag.class) : PsiTreeUtil.getPrevSiblingOfType(moved,XmlTag.class);
    if (next == null)     return info.prohibitMove();
    info.toMove=new LineRange(moved);
    info.toMove2=new LineRange(next);
    return true;
  }
 else   if (moved.getParent() == target) {
    return false;
  }
  LineRange targetRange=new LineRange(target);
  if (targetRange.contains(info.toMove2)) {
    XmlElementDescriptor descriptor=moved.getDescriptor();
    if (descriptor == null)     return false;
    XmlNSDescriptor nsDescriptor=descriptor.getNSDescriptor();
    if (nsDescriptor == null)     return false;
    XmlFile descriptorFile=nsDescriptor.getDescriptorFile();
    if (descriptorFile == null || XmlDocumentImpl.isAutoGeneratedSchema(descriptorFile))     return false;
    if (!TagNameVariantCollector.couldContain(target,moved)) {
      info.toMove=new LineRange(moved);
      info.toMove2=targetRange;
      return true;
    }
  }
  return false;
}
