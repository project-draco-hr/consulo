{
  final PsiClass[] classes=new PsiClass[classNames.length];
  for (int i=0; i < classes.length; i++) {
    String className=classNames[i];
    classes[i]=myJavaFacade.findClass(className,GlobalSearchScope.projectScope(getProject()));
    assertNotNull("Class " + className + " not found",classes[i]);
  }
  PsiPackage aPackage=JavaPsiFacade.getInstance(myPsiManager.getProject()).findPackage(newPackageName);
  assertNotNull("Package " + newPackageName + " not found",aPackage);
  final PsiDirectory[] dirs=aPackage.getDirectories();
  assertEquals(dirs.length,1);
  new MoveClassesOrPackagesProcessor(myProject,classes,new SingleSourceRootMoveDestination(PackageWrapper.create(JavaDirectoryService.getInstance().getPackage(dirs[0])),dirs[0]),true,true,null).run();
  PsiDocumentManager.getInstance(myProject).commitAllDocuments();
  FileDocumentManager.getInstance().saveAllDocuments();
}
