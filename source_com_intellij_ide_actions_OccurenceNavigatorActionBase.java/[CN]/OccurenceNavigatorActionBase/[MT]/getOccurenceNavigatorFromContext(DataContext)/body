{
  Window window=WindowManagerEx.getInstanceEx().getMostRecentFocusedWindow();
  if (window != null) {
    Component component=window.getFocusOwner();
    for (Component c=component; c != null; c=c.getParent()) {
      if (c instanceof OccurenceNavigator) {
        return c;
      }
    }
  }
  Project project=(Project)dataContext.getData(DataConstants.PROJECT);
  if (project == null) {
    return null;
  }
  ToolWindowManagerEx mgr=ToolWindowManagerEx.getInstanceEx(project);
  if (!mgr.isEditorComponentActive()) {
    return null;
  }
  String id=mgr.getLastActiveToolWindowId();
  if (id == null) {
    return null;
  }
  Component component=mgr.getToolWindow(id).getComponent();
  return component instanceof OccurenceNavigator ? component : null;
}
