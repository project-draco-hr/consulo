{
  final Collection<LocalFileSystem.WatchRequest> toRemove=new ArrayList<LocalFileSystem.WatchRequest>();
  keepActiveVcs(new Runnable(){
    public void run(){
      toRemove.addAll(myDirectoryMappingWatches.values());
      myDirectoryMappingWatches.clear();
      myVcsToPaths.clear();
      myActiveVcses=new AbstractVcs[0];
      mySortedMappings=new VcsDirectoryMapping[0];
    }
  }
);
  if (!toRemove.isEmpty()) {
    LocalFileSystem.getInstance().removeWatchedRoots(toRemove);
  }
}
