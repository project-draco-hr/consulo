{
  myIgnoreCase=ignoreCase;
  LOG.assertTrue(keywordSets.size() == CustomHighlighterTokenType.KEYWORD_TYPE_COUNT);
  StringBuilder regex=new StringBuilder();
  for (  Set<String> keywordSet : keywordSets) {
    myKeywordSets.add(getKeywordSet(keywordSet));
    for (    String word : keywordSet) {
      if (regex.length() > 0) {
        regex.append("|");
      }
      regex.append(escapeSpecialCharacters(word));
    }
  }
  Pattern pattern=null;
  try {
    String pat="(" + regex + ")($|[^\\w-])";
    pattern=Pattern.compile(pat,(ignoreCase ? Pattern.CASE_INSENSITIVE : 0) | Pattern.DOTALL);
  }
 catch (  PatternSyntaxException e) {
    LOG.info(e);
  }
  myPattern=pattern;
}
