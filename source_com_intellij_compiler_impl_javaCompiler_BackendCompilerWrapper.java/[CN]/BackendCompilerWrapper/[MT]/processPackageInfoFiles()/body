{
  if (myFilesToRecompile.size() > 0) {
    ApplicationManager.getApplication().runReadAction(new Runnable(){
      public void run(){
        final List<VirtualFile> packageInfoFiles=new ArrayList<VirtualFile>(myFilesToRecompile.size());
        for (Iterator<VirtualFile> it=myFilesToRecompile.iterator(); it.hasNext(); ) {
          final VirtualFile file=it.next();
          if (PACKAGE_ANNOTATION_FILE_NAME.equals(file.getName())) {
            packageInfoFiles.add(file);
          }
        }
        if (packageInfoFiles.size() > 0) {
          final Set<VirtualFile> badFiles=getFilesCompiledWithErrors();
          for (Iterator it=packageInfoFiles.iterator(); it.hasNext(); ) {
            final VirtualFile packageInfoFile=(VirtualFile)it.next();
            if (!badFiles.contains(packageInfoFile)) {
              myOutputItems.add(new OutputItemImpl(null,null,packageInfoFile));
              myFilesToRecompile.remove(packageInfoFile);
            }
          }
        }
      }
    }
);
  }
}
