{
  final List<VirtualFile> virtualFiles=isIntention ? IntentionDescriptionNotFoundInspection.getPotentialRoots(myModule) : InspectionDescriptionNotFoundInspection.getPotentialRoots(myModule);
  final VirtualFile[] roots=prepare(VfsUtil.toVirtualFileArray(virtualFiles));
  if (roots.length == 1) {
    ApplicationManager.getApplication().runWriteAction(new Runnable(){
      public void run(){
        createDescription(roots[0]);
      }
    }
);
  }
 else {
    List<String> options=new ArrayList<String>();
    for (    VirtualFile file : roots) {
      String path=file.getPresentableUrl() + File.separator + getDescriptionFolderName()+ File.separator+ myFilename;
      if (isIntention) {
        path+=File.separator + "description.html";
      }
      options.add(path);
    }
    final JList files=new JBList(ArrayUtil.toStringArray(options));
    final PopupChooserBuilder builder=JBPopupFactory.getInstance().createListPopupBuilder(files);
    final JBPopup popup=builder.setTitle(DevKitBundle.message("select.target.location.of.description",myFilename)).setItemChoosenCallback(new Runnable(){
      public void run(){
        final int index=files.getSelectedIndex();
        if (0 <= index && index < roots.length) {
          ApplicationManager.getApplication().runWriteAction(new Runnable(){
            public void run(){
              createDescription(roots[index]);
            }
          }
);
        }
      }
    }
).createPopup();
    final Editor editor=FileEditorManager.getInstance(myModule.getProject()).getSelectedTextEditor();
    if (editor == null)     return;
    popup.showInBestPositionFor(editor);
  }
}
