{
  if (another instanceof EmptySubstitutorImpl)   return this;
  final PsiSubstitutorImpl anotherImpl=(PsiSubstitutorImpl)another;
  Set<PsiTypeParameter> typeParameters=anotherImpl.mySubstitutionMap.keySet();
  final PsiTypeParameter[] params=typeParameters.toArray(new PsiTypeParameter[typeParameters.size()]);
  PsiSubstitutorImpl substitutor=new PsiSubstitutorImpl(new HashMap<PsiTypeParameter,PsiType>(mySubstitutionMap));
  for (  final PsiTypeParameter param : params) {
    substitutor.mySubstitutionMap.put(param,another.substitute(param));
  }
  return substitutor;
}
