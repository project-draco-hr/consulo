{
  if (another instanceof EmptySubstitutorImpl)   return this;
  final PsiSubstitutorImpl anotherImpl=(PsiSubstitutorImpl)another;
  final PsiTypeParameter[] params=anotherImpl.mySubstitutionMap.keySet().toArray(PsiTypeParameter.EMPTY_ARRAY);
  PsiSubstitutorImpl substitutor=new PsiSubstitutorImpl(new HashMap<PsiTypeParameter,PsiType>(mySubstitutionMap));
  for (int i=0; i < params.length; i++) {
    final PsiTypeParameter param=params[i];
    substitutor.mySubstitutionMap.put(param,another.substitute(param));
  }
  return substitutor;
}
