{
  PsiType t=mySubstitutionMap.get(typeParameter);
  if (myKind == SubstituteKind.SIMPLE) {
    return t;
  }
 else   if (myKind == SubstituteKind.ADD_BOUNDS) {
    return addBounds(t,typeParameter);
  }
 else   if (myKind == SubstituteKind.ADD_BOUNDS_AND_CAPTURE) {
    t=addBounds(t,typeParameter);
    if (t instanceof PsiWildcardType && typeParameter.getOwner() instanceof PsiClass) {
      return PsiCapturedWildcardType.create((PsiWildcardType)t);
    }
  }
  return t;
}
