{
  final ActionManagerEx actionManager=(ActionManagerEx)ActionManager.getInstance();
  final String actionId=ActionMacro.MACRO_ACTION_PREFIX + name;
  if (actionManager.getAction(actionId) != null) {
    if (Messages.showYesNoDialog("There is already a macro called '" + name + "'. Overwrite it?","Macro Name Already Used",Messages.getWarningIcon()) != 0) {
      return false;
    }
    actionManager.unregisterAction(actionId);
    removeMacro(name);
  }
  return true;
}
