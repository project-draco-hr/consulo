{
  final JBTabs.Max max=computeMaxSize();
  myHeaderFitSize=new Dimension(getSize().width,myHorizontalSide ? Math.max(max.myLabel.height,max.myToolbar.height) : max.myLabel.height);
  final TabInfo selected=getSelectedInfo();
  final JComponent selectedToolbar=myInfo2Toolbar.get(selected);
  Insets insets=getInsets();
  if (insets == null) {
    insets=new Insets(0,0,0,0);
  }
  int currentX=insets.left;
  int xAddin=0;
  if (!myHorizontalSide && selectedToolbar != null) {
    xAddin=selectedToolbar.getPreferredSize().width + 1;
  }
  mySelectedBounds=null;
  final int yComp=myHeaderFitSize.height + insets.top;
  for (  TabInfo eachInfo : myInfos) {
    final TabLabel label=myInfo2Label.get(eachInfo);
    final Dimension eachSize=label.getPreferredSize();
    label.setBounds(currentX,insets.top,eachSize.width,myHeaderFitSize.height);
    currentX+=eachSize.width;
    final JComponent comp=eachInfo.getComponent();
    if (selected == eachInfo) {
      comp.setBounds(insets.left + INNER + xAddin,yComp,getWidth() - insets.left - insets.right- INNER * 2 - xAddin,getHeight() - insets.top - insets.bottom- myHeaderFitSize.height- 1);
      mySelectedBounds=label.getBounds();
    }
 else {
      comp.setBounds(0,0,0,0);
    }
    final JComponent eachToolbar=myInfo2Toolbar.get(eachInfo);
    if (eachToolbar != null) {
      eachToolbar.setBounds(0,0,0,0);
    }
  }
  if (selectedToolbar != null) {
    final int toolbarInset=getArcSize() * 2;
    if (myHorizontalSide) {
      if (currentX + selectedToolbar.getMinimumSize().width + toolbarInset < getWidth()) {
        selectedToolbar.setBounds(currentX + toolbarInset,insets.top,getSize().width - currentX - insets.left- toolbarInset,myHeaderFitSize.height - 1);
      }
 else {
        selectedToolbar.setBounds(0,0,0,0);
      }
    }
 else {
      selectedToolbar.setBounds(insets.left + 1,yComp,selectedToolbar.getPreferredSize().width,getSize().height - yComp - insets.bottom- 1);
    }
  }
}
