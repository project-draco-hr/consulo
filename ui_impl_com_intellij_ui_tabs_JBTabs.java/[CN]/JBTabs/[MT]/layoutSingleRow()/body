{
  final TabInfo selected=getSelectedInfo();
  final JComponent selectedToolbar=myInfo2Toolbar.get(selected);
  LineLayoutData data=new LineLayoutData();
  boolean layoutLabels=true;
  if (myLastSingRowLayout != null && myLastSingRowLayout.contentCount == getTabCount() && myLastSingRowLayout.laayoutSize.equals(getSize())) {
    for (    TabInfo each : myInfos) {
      if (getSelectedInfo() == each) {
        final TabLabel eachLabel=myInfo2Label.get(each);
        if (eachLabel.getBounds().width != 0) {
          data=myLastSingRowLayout;
          layoutLabels=false;
        }
      }
    }
  }
  Insets insets=getLayoutInsets();
  resetLayout(layoutLabels);
  if (layoutLabels) {
    data.eachX=insets.left;
    if (!myHorizontalSide && selectedToolbar != null) {
      data.xAddin=selectedToolbar.getPreferredSize().width + 1;
    }
    recomputeToLayout(selectedToolbar,data,insets);
    layoutLabels(data,insets);
    if (data.toDrop.size() > 0) {
      data.moreRect=new Rectangle(data.eachX,insets.top,data.moreRectWidth - 1,myHeaderFitSize.height - 1);
    }
  }
  data.yComp=myHeaderFitSize.height + insets.top;
  if (selectedToolbar != null) {
    if (myHorizontalSide) {
      int toolbarX=data.eachX + getToolbarInset() + (data.moreRect != null ? data.moreRect.width : 0);
      selectedToolbar.setBounds(toolbarX,insets.top,getSize().width - insets.left - toolbarX,myHeaderFitSize.height - 1);
    }
 else {
      selectedToolbar.setBounds(insets.left + 1,data.yComp + 1,selectedToolbar.getPreferredSize().width,getSize().height - data.yComp - insets.bottom- 2);
    }
  }
  if (selected != null) {
    final JComponent comp=selected.getComponent();
    layoutComp(data.xAddin,data.yComp,comp);
  }
  if (data.toLayout.size() > 0 && myInfos.size() > 0) {
    final int left=myInfos.indexOf(data.toLayout.get(0));
    final int right=myInfos.indexOf(data.toLayout.get(data.toLayout.size() - 1));
    myMoreIcon.setPaintedIcons(left > 0,right < myInfos.size() - 1);
  }
 else {
    myMoreIcon.setPaintedIcons(false,false);
  }
  myLastSingRowLayout=data;
}
