{
  try {
    final String packaging=StringUtil.notNullize(template.getPackaging());
    final ArrayList<MavenArtifactInfo> artifacts=new ArrayList<MavenArtifactInfo>();
    final Gson gson=new Gson();
    final String className=template.getClassNames();
    if (className == null || className.length() == 0) {
      final boolean canTrySwitchGAV=template.getArtifactId() == null && template.getGroupId() != null;
      final InputStream stream=new Endpoint.Search.Gavc(url).getGavcSearchResultJson(template.getGroupId(),template.getArtifactId(),template.getVersion(),template.getClassifier(),null).getInputStream();
      final ArtifactoryModel.GavcResults results=gson.fromJson(new InputStreamReader(stream),ArtifactoryModel.GavcResults.class);
      if (results != null && results.results != null) {
        for (        ArtifactoryModel.GavcResult result : results.results) {
          if (!result.uri.endsWith(packaging))           continue;
          artifacts.add(convertArtifactInfo(result.uri,url,null));
        }
      }
      if (canTrySwitchGAV) {
        final InputStream stream2=new Endpoint.Search.Gavc(url).getGavcSearchResultJson(null,template.getGroupId(),template.getVersion(),template.getClassifier(),null).getInputStream();
        final ArtifactoryModel.GavcResults results2=gson.fromJson(new InputStreamReader(stream2),ArtifactoryModel.GavcResults.class);
        if (results2 != null && results2.results != null) {
          for (          ArtifactoryModel.GavcResult result : results2.results) {
            if (!result.uri.endsWith(packaging))             continue;
            artifacts.add(convertArtifactInfo(result.uri,url,null));
          }
        }
      }
    }
 else {
      final String searchString=className.endsWith("*") || className.endsWith("?") ? className : className + ".class";
      final InputStream stream=new Endpoint.Search.Archive(url).getArchiveSearchResultJson(searchString,null).getInputStream();
      final ArtifactoryModel.ArchiveResults results=gson.fromJson(new InputStreamReader(stream),ArtifactoryModel.ArchiveResults.class);
      if (results != null && results.results != null) {
        for (        ArtifactoryModel.ArchiveResult result : results.results) {
          for (          String uri : result.archiveUris) {
            if (!uri.endsWith(packaging))             continue;
            artifacts.add(convertArtifactInfo(uri,url,result.entry));
          }
        }
      }
    }
    return artifacts;
  }
 catch (  Exception e) {
    throw new IOException(e);
  }
}
