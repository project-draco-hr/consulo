{
  try {
    final String packaging=StringUtil.notNullize(template.getPackaging());
    final ArrayList<MavenArtifactInfo> artifacts=new ArrayList<MavenArtifactInfo>();
    final Gson gson=new Gson();
    final String className=template.getClassNames();
    if (className == null || className.length() == 0) {
      final String name=StringUtil.join(Arrays.asList(template.getGroupId(),template.getArtifactId(),template.getVersion()),":");
      final InputStream stream=new Endpoint.Search.Artifact(url).getArtifactSearchResultJson(name,null).getInputStream();
      final ArtifactoryModel.GavcResults results=gson.fromJson(new InputStreamReader(stream),ArtifactoryModel.GavcResults.class);
      if (results != null && results.results != null) {
        for (        ArtifactoryModel.GavcResult result : results.results) {
          if (!result.uri.endsWith(packaging))           continue;
          artifacts.add(convertArtifactInfo(result.uri,url,null));
        }
      }
    }
 else {
      final String searchString=className.endsWith("*") || className.endsWith("?") ? className : className + ".class";
      final InputStream stream=new Endpoint.Search.Archive(url).getArchiveSearchResultJson(searchString,null).getInputStream();
      final ArtifactoryModel.ArchiveResults results=gson.fromJson(new InputStreamReader(stream),ArtifactoryModel.ArchiveResults.class);
      if (results != null && results.results != null) {
        for (        ArtifactoryModel.ArchiveResult result : results.results) {
          for (          String uri : result.archiveUris) {
            if (!uri.endsWith(packaging))             continue;
            artifacts.add(convertArtifactInfo(uri,url,result.entry));
          }
        }
      }
    }
    return artifacts;
  }
 catch (  Exception e) {
    throw new IOException(e);
  }
}
