{
  Alphabet alphabet=new Alphabet();
  final Encoder encoder=new Encoder(alphabet);
  final CompressedDictionary dictionary=new CompressedDictionary(alphabet,encoder,loader.getName());
  loader.load(new Consumer<String>(){
    public void consume(    String s){
      String transformed=transform.transform(s);
      if (transformed != null) {
        UnitBitSet bs=encoder.encode(transformed,true);
        if (bs == null)         return;
        byte[] compressed=UnitBitSet.getBytes(bs);
        dictionary.addToDictionary(compressed);
      }
    }
  }
);
  dictionary.pack();
  return dictionary;
}
