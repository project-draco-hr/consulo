{
  parentNode.setAttribute(NAME_ATTR,getName());
  parentNode.setAttribute(VERSION_ATTR,Integer.toString(myVersion));
  if (myParentScheme != null) {
    parentNode.setAttribute(PARENT_SCHEME_ATTR,myParentScheme.getName());
  }
  Element element=new Element(OPTION_ELEMENT);
  element.setAttribute(NAME_ATTR,LINE_SPACING);
  element.setAttribute(VALUE_ELEMENT,String.valueOf(getLineSpacing()));
  parentNode.addContent(element);
  boolean useOldFontFormat=myFontPreferences.getEffectiveFontFamilies().size() <= 1;
  if (useOldFontFormat) {
    element=new Element(OPTION_ELEMENT);
    element.setAttribute(NAME_ATTR,EDITOR_FONT_SIZE);
    element.setAttribute(VALUE_ELEMENT,String.valueOf(getEditorFontSize() / JBUI.scale(1)));
    parentNode.addContent(element);
  }
 else {
    writeFontPreferences(EDITOR_FONT,parentNode,myFontPreferences);
  }
  if (!myFontPreferences.equals(myConsoleFontPreferences)) {
    if (myConsoleFontPreferences.getEffectiveFontFamilies().size() <= 1) {
      element=new Element(OPTION_ELEMENT);
      element.setAttribute(NAME_ATTR,CONSOLE_FONT_NAME);
      element.setAttribute(VALUE_ELEMENT,getConsoleFontName());
      parentNode.addContent(element);
      if (getConsoleFontSize() != getEditorFontSize()) {
        element=new Element(OPTION_ELEMENT);
        element.setAttribute(NAME_ATTR,CONSOLE_FONT_SIZE);
        element.setAttribute(VALUE_ELEMENT,Integer.toString(getConsoleFontSize() / JBUI.scale(1)));
        parentNode.addContent(element);
      }
    }
 else {
      writeFontPreferences(CONSOLE_FONT,parentNode,myConsoleFontPreferences);
    }
  }
  if (getConsoleLineSpacing() != getLineSpacing()) {
    element=new Element(OPTION_ELEMENT);
    element.setAttribute(NAME_ATTR,CONSOLE_LINE_SPACING);
    element.setAttribute(VALUE_ELEMENT,Float.toString(getConsoleLineSpacing()));
    parentNode.addContent(element);
  }
  if (DEFAULT_FONT_SIZE != getQuickDocFontSize()) {
    element=new Element(OPTION_ELEMENT);
    element.setAttribute(NAME_ATTR,EDITOR_QUICK_JAVADOC_FONT_SIZE);
    element.setAttribute(VALUE_ELEMENT,getQuickDocFontSize().toString());
    parentNode.addContent(element);
  }
  if (useOldFontFormat) {
    element=new Element(OPTION_ELEMENT);
    element.setAttribute(NAME_ATTR,EDITOR_FONT_NAME);
    element.setAttribute(VALUE_ELEMENT,getEditorFontName());
    parentNode.addContent(element);
  }
  Element colorElements=new Element(COLORS_ELEMENT);
  Element attrElements=new Element(ATTRIBUTES_ELEMENT);
  writeColors(colorElements);
  writeAttributes(attrElements);
  if (colorElements.getChildren().size() > 0) {
    parentNode.addContent(colorElements);
  }
  if (attrElements.getChildren().size() > 0) {
    parentNode.addContent(attrElements);
  }
}
