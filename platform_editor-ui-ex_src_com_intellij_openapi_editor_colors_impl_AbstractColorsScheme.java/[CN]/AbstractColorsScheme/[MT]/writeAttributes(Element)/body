{
  List<TextAttributesKey> list=new ArrayList<TextAttributesKey>(myAttributesMap.keySet());
  Collections.sort(list);
  for (  TextAttributesKey key : list) {
    TextAttributes defaultAttr=myParentScheme != null ? myParentScheme.getAttributes(key) : new TextAttributes();
    TextAttributes value=myAttributesMap.get(key);
    if (!haveToWrite(key,value,defaultAttr))     continue;
    Element element=new Element(OPTION_ELEMENT);
    element.setAttribute(NAME_ATTR,key.getExternalName());
    Element valueElement=new Element(VALUE_ELEMENT);
    value.writeExternal(valueElement);
    element.addContent(valueElement);
    attrElements.addContent(element);
  }
}
