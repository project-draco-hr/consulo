{
  if (ApplicationManager.getApplication().isUnitTestMode()) {
    return;
  }
  final GeneratingCompiler compilerToRun=ApplicationManager.getApplication().runReadAction(new Computable<GeneratingCompiler>(){
    @Nullable public GeneratingCompiler compute(){
      return computeCompilerToRun();
    }
  }
);
  if (compilerToRun == null) {
    return;
  }
  if (compilerToRun instanceof AndroidAptCompiler && AndroidRootUtil.getManifestFile(myFacet.getModule()) != myEvent.getFile()) {
    final HashSet<ResourceEntry> resourceSet=new HashSet<ResourceEntry>();
    DumbService.getInstance(myFacet.getModule().getProject()).waitForSmartMode();
    AndroidCompileUtil.collectAllResources(myFacet,resourceSet);
synchronized (RESOURCES_SET_LOCK) {
      if (resourceSet.equals(myResourceSet)) {
        return;
      }
      myResourceSet=resourceSet;
    }
  }
  AndroidCompileUtil.generate(myFacet.getModule(),compilerToRun,true);
}
