{
  if (ApplicationManager.getApplication().isUnitTestMode()) {
    return;
  }
  final List<AndroidAutogeneratorMode> autogenerationModes=ApplicationManager.getApplication().runReadAction(new Computable<List<AndroidAutogeneratorMode>>(){
    @Nullable public List<AndroidAutogeneratorMode> compute(){
      return computeCompilersToRunAndInvalidateLocalAttributesMap();
    }
  }
);
  if (autogenerationModes.isEmpty()) {
    return;
  }
  for (  AndroidAutogeneratorMode autogenerationMode : autogenerationModes) {
    if (autogenerationMode == AndroidAutogeneratorMode.AAPT && AndroidRootUtil.getManifestFile(myFacet) != myEvent.getFile()) {
      final HashSet<ResourceEntry> resourceSet=new HashSet<ResourceEntry>();
      DumbService.getInstance(myFacet.getModule().getProject()).waitForSmartMode();
      AndroidCompileUtil.collectAllResources(myFacet,resourceSet);
synchronized (RESOURCES_SET_LOCK) {
        if (resourceSet.equals(myResourceSet) && !myFacet.areSourcesGeneratedWithErrors(AndroidAutogeneratorMode.AAPT)) {
          return;
        }
        myResourceSet=resourceSet;
      }
    }
    AndroidCompileUtil.generate(myFacet.getModule(),autogenerationMode,true);
  }
}
