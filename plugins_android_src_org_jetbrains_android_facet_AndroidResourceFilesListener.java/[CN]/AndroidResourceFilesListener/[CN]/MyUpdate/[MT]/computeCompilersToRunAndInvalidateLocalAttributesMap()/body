{
  if (myFacet.isDisposed()) {
    return Collections.emptyList();
  }
  final Module myModule=myFacet.getModule();
  final Project project=myModule.getProject();
  if (project.isDisposed()) {
    return Collections.emptyList();
  }
  final VirtualFile file=myEvent.getFile();
  final Module module=ModuleUtil.findModuleForFile(file,project);
  if (module != myModule) {
    return Collections.emptyList();
  }
  VirtualFile parent=myEvent.getParent();
  if (parent == null) {
    return Collections.emptyList();
  }
  final VirtualFile gp=parent.getParent();
  final VirtualFile resourceDir=AndroidRootUtil.getResourceDir(myFacet);
  if (gp == resourceDir && ResourceFolderType.VALUES.getName().equals(AndroidCommonUtils.getResourceTypeByDirName(parent.getName()))) {
    myFacet.getLocalResourceManager().invalidateAttributeDefinitions();
  }
  final VirtualFile manifestFile=AndroidRootUtil.getManifestFile(myFacet);
  final List<AndroidAutogeneratorMode> modes=new ArrayList<AndroidAutogeneratorMode>();
  if (AndroidAptCompiler.isToCompileModule(module,myFacet.getConfiguration()) && (myFacet.getConfiguration().REGENERATE_R_JAVA && (gp == resourceDir || manifestFile == file))) {
    final Manifest manifest=myFacet.getManifest();
    final String aPackage=manifest != null ? manifest.getPackage().getValue() : null;
    if (myCachedPackage != null && !myCachedPackage.equals(aPackage)) {
      String aptGenDirPath=AndroidRootUtil.getAptGenSourceRootPath(myFacet);
      AndroidCompileUtil.removeDuplicatingClasses(myModule,myCachedPackage,AndroidUtils.R_CLASS_NAME,null,aptGenDirPath);
    }
    myCachedPackage=aPackage;
    modes.add(AndroidAutogeneratorMode.AAPT);
  }
  if (myFacet.getConfiguration().REGENERATE_JAVA_BY_AIDL && file.getFileType() == AndroidIdlFileType.ourFileType) {
    VirtualFile sourceRoot=findSourceRoot(myModule,file);
    if (sourceRoot != null && AndroidRootUtil.getAidlGenDir(myFacet) != sourceRoot) {
      modes.add(AndroidAutogeneratorMode.AIDL);
    }
  }
  if (file.getFileType() == AndroidRenderscriptFileType.INSTANCE) {
    final VirtualFile sourceRoot=findSourceRoot(myModule,file);
    if (sourceRoot != null && AndroidRootUtil.getRenderscriptGenDir(myFacet) != sourceRoot) {
      modes.add(AndroidAutogeneratorMode.RENDERSCRIPT);
    }
  }
  if (manifestFile == file) {
    modes.add(AndroidAutogeneratorMode.BUILDCONFIG);
  }
  return modes;
}
