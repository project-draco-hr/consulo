{
  TreePath[] paths=getSelectionPaths();
  if (paths == null)   return PsiElement.EMPTY_ARRAY;
  ArrayList<Object> list=new ArrayList<Object>(paths.length);
  for (  TreePath path : paths) {
    Object lastPathComponent=path.getLastPathComponent();
    if (lastPathComponent instanceof DefaultMutableTreeNode) {
      DefaultMutableTreeNode node=(DefaultMutableTreeNode)lastPathComponent;
      Object element=exhumeElementFromNode(node);
      if (element != null) {
        list.add(element);
      }
    }
  }
  return list.toArray(new Object[list.size()]);
}
