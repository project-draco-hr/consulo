{
  JobDescriptor progress=((GlobalInspectionContextImpl)context).FIND_EXTERNAL_USAGES;
  progress.setTotalAmount(getRequestCount());
  do {
    processSearchRequests(context);
    InspectionProfileEntry[] requestors=needRepeatSearchRequest.toArray(new InspectionProfileEntry[needRepeatSearchRequest.size()]);
    for (    InspectionProfileEntry requestor : requestors) {
      if (requestor instanceof InspectionTool && !((InspectionTool)requestor).queryExternalUsagesRequests(InspectionManager.getInstance(context.getProject()))) {
        needRepeatSearchRequest.remove(requestor);
      }
    }
    int oldSearchRequestCount=progress.getTotalAmount();
    int oldDoneAmount=progress.getDoneAmount();
    int totalAmount=oldSearchRequestCount + getRequestCount();
    progress.setTotalAmount(totalAmount);
    progress.setDoneAmount(oldDoneAmount);
  }
 while (!needRepeatSearchRequest.isEmpty());
}
