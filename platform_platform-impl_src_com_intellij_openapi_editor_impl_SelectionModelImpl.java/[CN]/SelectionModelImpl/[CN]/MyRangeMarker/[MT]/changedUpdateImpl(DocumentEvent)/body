{
  if (myIsReleased)   return;
  int startBefore=getStartOffset();
  int endBefore=getEndOffset();
  super.changedUpdateImpl(e);
  if (!isValid()) {
    myLastSelectionStart=myEditor.getCaretModel().getOffset();
    release();
    mySelectionMarker.set(null);
    fireSelectionChanged(startBefore,endBefore,myLastSelectionStart,myLastSelectionStart);
    return;
  }
  if (startBefore != getStartOffset() || endBefore != getStartOffset()) {
    fireSelectionChanged(startBefore,endBefore,getStartOffset(),getEndOffset());
  }
}
