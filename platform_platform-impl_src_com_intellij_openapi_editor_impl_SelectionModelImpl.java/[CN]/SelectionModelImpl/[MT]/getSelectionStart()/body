{
  validateContext(false);
  if (hasSelection()) {
    MyRangeMarker marker=mySelectionMarker;
    if (marker != null) {
      return marker.getStartOffset();
    }
  }
  return myEditor.getCaretModel().getOffset();
}
