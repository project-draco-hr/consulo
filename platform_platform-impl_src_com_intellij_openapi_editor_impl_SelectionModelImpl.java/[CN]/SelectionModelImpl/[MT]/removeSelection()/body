{
  validateContext(true);
  removeBlockSelection();
  myLastSelectionStart=myEditor.getCaretModel().getOffset();
  MyRangeMarker marker=mySelectionMarker.get();
  if (marker != null) {
    int startOffset=marker.getStartOffset();
    int endOffset=marker.getEndOffset();
    marker.release();
    mySelectionMarker.set(null);
    fireSelectionChanged(startOffset,endOffset,myLastSelectionStart,myLastSelectionStart);
  }
}
