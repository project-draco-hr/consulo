{
  LOG.assertTrue(offset >= myShreds.get(0).prefix.length());
  LOG.assertTrue(offset <= getTextLength() - myShreds.get(myShreds.size() - 1).suffix.length());
  if (isOneLine()) {
    s=StringUtil.replace(s.toString(),"\n","");
  }
  myDelegate.insertString(injectedToHost(offset),s);
}
