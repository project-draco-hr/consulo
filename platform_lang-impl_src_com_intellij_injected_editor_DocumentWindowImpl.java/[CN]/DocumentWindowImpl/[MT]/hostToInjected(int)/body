{
synchronized (myLock) {
    if (hostOffset < myShreds.get(0).getHostRangeMarker().getStartOffset())     return myShreds.get(0).prefix.length();
    int offset=0;
    for (int i=0; i < myShreds.size(); i++) {
      offset+=myShreds.get(i).prefix.length();
      RangeMarker currentRange=myShreds.get(i).getHostRangeMarker();
      RangeMarker nextRange=i == myShreds.size() - 1 ? null : myShreds.get(i + 1).getHostRangeMarker();
      if (nextRange == null || hostOffset < nextRange.getStartOffset()) {
        if (hostOffset >= currentRange.getEndOffset())         hostOffset=currentRange.getEndOffset();
        return offset + hostOffset - currentRange.getStartOffset();
      }
      offset+=currentRange.getEndOffset() - currentRange.getStartOffset();
      offset+=myShreds.get(i).suffix.length();
    }
    return getTextLength() - myShreds.get(myShreds.size() - 1).suffix.length();
  }
}
