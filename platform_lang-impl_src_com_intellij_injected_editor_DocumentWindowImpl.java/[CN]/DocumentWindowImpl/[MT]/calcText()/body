{
  StringBuilder text=new StringBuilder();
  CharSequence hostText=myDelegate.getCharsSequence();
synchronized (myLock) {
    for (    PsiLanguageInjectionHost.Shred shred : myShreds) {
      RangeMarker hostRange=shred.getHostRangeMarker();
      if (hostRange.isValid()) {
        text.append(shred.prefix);
        text.append(hostText,hostRange.getStartOffset(),hostRange.getEndOffset());
        text.append(shred.suffix);
      }
    }
  }
  return text.toString();
}
