{
  try {
    ShelveChangesManager.getInstance(myProject).shelveChanges(changes,commitMessage);
  }
 catch (  final IOException ex) {
    ApplicationManager.getApplication().invokeLater(new Runnable(){
      public void run(){
        Messages.showErrorDialog(myProject,VcsBundle.message("create.patch.error.title",ex.getMessage()),CommonBundle.getErrorTitle());
      }
    }
,ModalityState.NON_MODAL);
  }
}
