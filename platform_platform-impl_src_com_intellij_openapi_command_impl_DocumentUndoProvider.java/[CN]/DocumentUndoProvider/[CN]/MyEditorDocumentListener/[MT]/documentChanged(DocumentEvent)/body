{
  Document document=e.getDocument();
  if (shouldBeIgnored(document))   return;
  UndoManagerImpl undoManager=getUndoManager();
  if (undoManager.isActive() && isUndoable(document)) {
    registerUndoableAction(e);
  }
 else {
    registerNonUndoableAction(document);
  }
}
