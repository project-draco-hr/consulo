{
  ArrayList<PsiDirectory> dirs=new ArrayList<PsiDirectory>();
  for (  VirtualFile root : roots) {
    if (!root.isValid()) {
      LOG.error("Root " + root + " is not valid!");
    }
    PsiDirectory dir=fileManager.findDirectory(root);
    if (dir != null) {
      dirs.add(dir);
    }
  }
  return dirs.toArray(new PsiDirectory[dirs.size()]);
}
