{
synchronized (myBuilderToStampStorageMap) {
    try {
      for (      Map.Entry<String,TimestampStorage> entry : myBuilderToStampStorageMap.entrySet()) {
        final TimestampStorage storage=entry.getValue();
        try {
          storage.close();
        }
 catch (        IOException e) {
          LOG.error(e);
          final String builderName=entry.getKey();
          FileUtil.delete(getDataRoot(builderName,TIMESTAMP_STORAGE));
        }
      }
    }
  finally {
      myBuilderToStampStorageMap.clear();
    }
  }
}
