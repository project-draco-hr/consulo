{
  final PsiElement parent=e.getParent();
  if (e.getContainingFile() instanceof JspFile && e.getLanguage() instanceof JavaLanguage) {
    final JspFile psiFile=(JspFile)e.getContainingFile();
    if (e.getParent().getTextLength() == psiFile.getTextLength()) {
      final PsiFile[] psiRoots=psiFile.getPsiRoots();
      for (      PsiFile root : psiRoots) {
        if (root instanceof XmlFile) {
          XmlFile xmlFile=(XmlFile)root;
          XmlTag tag=PsiTreeUtil.getParentOfType(xmlFile.getDocument().findElementAt(e.getTextRange().getStartOffset()),XmlTag.class);
          while (tag != null && !tag.getTextRange().contains(selectionRange)) {
            tag=tag.getParentTag();
          }
          if (tag != null)           return tag;
        }
      }
    }
  }
  return parent;
}
