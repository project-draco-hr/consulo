{
  final AntTypeDefinitionImpl def=loadClassAndCreateDefinition(classname,name,uri);
  if (def == null)   return;
  myNewDefinitions=ArrayUtil.append(myNewDefinitions,def);
  def.setDefiningElement(this);
  final AntStructuredElement parent=getAntParent();
  if (parent != null) {
    parent.registerCustomType(def);
    final AntFile antFile=parent.getAntFile();
    if (antFile != null) {
      for (      final AntTypeId typeId : def.getNestedElements()) {
        final String nestedClassName=def.getNestedClassName(typeId);
        AntTypeDefinitionImpl nestedDef=(AntTypeDefinitionImpl)antFile.getBaseTypeDefinition(nestedClassName);
        if (nestedDef == null) {
          nestedDef=loadClassAndCreateDefinition(nestedClassName,typeId.getName(),uri);
        }
        if (nestedDef != null) {
          nestedDef.setDefiningElement(this);
          parent.registerCustomType(nestedDef);
        }
      }
    }
  }
}
