{
synchronized (STATE_LOCK) {
    if (myState == State.EMPTY || refresh) {
      collect(null);
    }
  }
  while (!isReady()) {
    try {
synchronized (WAITER_LOCK) {
        TimeUnit.MILLISECONDS.timedWait(WAITER_LOCK,100);
      }
    }
 catch (    InterruptedException e) {
      LOG.error(e);
    }
  }
  return getCommits();
}
