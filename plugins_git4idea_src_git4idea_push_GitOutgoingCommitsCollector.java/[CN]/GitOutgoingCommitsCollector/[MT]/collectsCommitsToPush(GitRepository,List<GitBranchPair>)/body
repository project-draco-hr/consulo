{
  Map<GitBranch,GitPushBranchInfo> commitsByBranch=new HashMap<GitBranch,GitPushBranchInfo>();
  for (  GitBranchPair sourceDest : sourcesDestinations) {
    GitLocalBranch source=sourceDest.getSource();
    GitRemoteBranch dest=sourceDest.getDest();
    List<GitCommit> commits=Collections.emptyList();
    GitPushBranchInfo.Type type;
    if (dest == null) {
      dest=GitPusher.NO_TARGET_BRANCH;
      type=GitPushBranchInfo.Type.NO_TRACKED_OR_TARGET;
    }
 else     if (GitUtil.repoContainsRemoteBranch(repository,dest)) {
      commits=collectCommitsToPush(repository,source.getName(),dest.getName());
      type=GitPushBranchInfo.Type.STANDARD;
    }
 else {
      type=GitPushBranchInfo.Type.NEW_BRANCH;
    }
    commitsByBranch.put(source,new GitPushBranchInfo(source,dest,commits,type));
  }
  return new GitCommitsByBranch(commitsByBranch);
}
