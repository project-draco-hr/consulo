{
  ApplicationManager.getApplication().assertWriteAccessAllowed();
  List<LibraryImpl> addedLibraries=new ArrayList<LibraryImpl>(model.myLibraries);
  addedLibraries.removeAll(myModel.myLibraries);
  List<LibraryImpl> removedLibraries=new ArrayList<LibraryImpl>(myModel.myLibraries);
  removedLibraries.removeAll(model.myLibraries);
  for (Iterator<LibraryImpl> iterator=removedLibraries.iterator(); iterator.hasNext(); ) {
    LibraryImpl library=iterator.next();
    fireBeforeLibraryRemoved(library);
  }
  myModel=model;
  for (Iterator<LibraryImpl> iterator=removedLibraries.iterator(); iterator.hasNext(); ) {
    LibraryImpl library=iterator.next();
    fireAfterLibraryRemoved(library);
  }
  for (Iterator<LibraryImpl> iterator=addedLibraries.iterator(); iterator.hasNext(); ) {
    LibraryImpl library=iterator.next();
    fireLibraryAdded(library);
  }
}
