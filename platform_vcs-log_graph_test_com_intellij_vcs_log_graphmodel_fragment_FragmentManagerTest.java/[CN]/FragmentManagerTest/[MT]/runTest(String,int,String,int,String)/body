{
  final MutableGraph graph=GraphTestUtils.getNewMutableGraph(inputGraph);
  FragmentManager fragmentManager=new FragmentManagerImpl(graph,new FragmentManagerImpl.CallBackFunction(){
    @Override public UpdateRequest runIntermediateUpdate(    @NotNull Node upNode,    @NotNull Node downNode){
      graph.updateVisibleRows();
      return UpdateRequest.ID_UpdateRequest;
    }
    @Override public void fullUpdate(){
      graph.updateVisibleRows();
    }
  }
);
  graph.setGraphDecorator(new GraphDecoratorImpl(fragmentManager.getGraphPreDecorator(),new Function<Node,Boolean>(){
    @NotNull @Override public Boolean fun(    @NotNull Node key){
      return true;
    }
  }
));
  Node node=getCommitNode(graph,hideNodeRowIndex);
  GraphFragment fragment=fragmentManager.relateFragment(node);
  assertEquals(fragmentStr,toStr(fragment));
  if (fragment == null) {
    return;
  }
  String saveGraphStr=toStr(graph);
  fragmentManager.changeVisibility(fragment);
  assertEquals(hideGraphStr,toStr(graph));
  fragment=fragmentManager.relateFragment(getCommitNode(graph,showNodeRowIndex));
  assertNotNull(fragment);
  fragmentManager.changeVisibility(fragment);
  assertEquals(saveGraphStr,toStr(graph));
}
