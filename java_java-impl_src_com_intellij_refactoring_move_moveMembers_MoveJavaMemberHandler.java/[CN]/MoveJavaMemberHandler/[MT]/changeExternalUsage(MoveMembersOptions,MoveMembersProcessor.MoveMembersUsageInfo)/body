{
  final PsiElement element=usage.getElement();
  if (element == null || !element.isValid())   return true;
  if (usage.reference instanceof PsiReferenceExpression) {
    PsiReferenceExpression refExpr=(PsiReferenceExpression)usage.reference;
    PsiExpression qualifier=refExpr.getQualifierExpression();
    if (qualifier != null) {
      if (usage.qualifierClass != null && PsiTreeUtil.getParentOfType(refExpr,PsiSwitchLabelStatement.class) == null) {
        changeQualifier(refExpr,usage.qualifierClass,usage.member);
      }
 else {
        refExpr.setQualifierExpression(null);
      }
    }
 else {
      if (usage.qualifierClass != null && PsiTreeUtil.getParentOfType(refExpr,PsiSwitchLabelStatement.class) == null) {
        changeQualifier(refExpr,usage.qualifierClass,usage.member);
      }
    }
    return true;
  }
  return false;
}
