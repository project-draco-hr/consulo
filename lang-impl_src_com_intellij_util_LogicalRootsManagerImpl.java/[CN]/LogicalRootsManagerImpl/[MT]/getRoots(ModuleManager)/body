{
  if (myRoots == null) {
    myRoots=new THashMap<Module,MultiValuesMap<LogicalRootType,LogicalRoot>>();
    final Module[] modules=moduleManager.getModules();
    for (    Module module : modules) {
      final MultiValuesMap<LogicalRootType,LogicalRoot> map=new MultiValuesMap<LogicalRootType,LogicalRoot>();
      for (      Map.Entry<LogicalRootType,Collection<NotNullFunction>> entry : myProviders.entrySet()) {
        final Collection<NotNullFunction> functions=entry.getValue();
        for (        NotNullFunction function : functions) {
          map.putAll(entry.getKey(),(List<LogicalRoot>)function.fun(module));
        }
      }
      myRoots.put(module,map);
    }
  }
  return myRoots;
}
