{
  if (ApplicationManager.getApplication().isUnitTestMode() && getUserData(DO_DOCUMENT_UPDATE_TEST) == null) {
    return new Dimension(1,1);
  }
  Dimension draft=getSizeWithoutCaret();
  int caretX=visualPositionToXY(getCaretModel().getVisualPosition()).x;
  draft.width=Math.max(caretX,draft.width) + mySettings.getAdditionalColumnsCount() * getSpaceWidth(Font.PLAIN);
  return draft;
}
