{
  int composedStartIndex=0;
  int composedEndIndex=0;
  if (composedText != null) {
    composedStartIndex=composedTextStart;
    composedEndIndex=composedTextEnd;
  }
  int caretIndex=getCaretModel().getOffset();
  if (caretIndex < composedStartIndex) {
    return caretIndex;
  }
 else {
    if (caretIndex < composedEndIndex) {
      return composedStartIndex;
    }
 else {
      return caretIndex - (composedEndIndex - composedStartIndex);
    }
  }
}
