{
  final NotificationsConfigurationImpl configuration=NotificationsConfigurationImpl.getInstanceImpl();
  if (!configuration.isRegistered(notification.getGroupId())) {
    configuration.register(notification.getGroupId(),displayType == null ? NotificationDisplayType.BALLOON : displayType);
  }
  final NotificationSettings settings=NotificationsConfigurationImpl.getSettings(notification.getGroupId());
  boolean shouldLog=settings.isShouldLog();
  boolean displayable=settings.getDisplayType() != NotificationDisplayType.NONE;
  boolean willBeShown=displayable && NotificationsConfigurationImpl.getInstanceImpl().SHOW_BALLOONS;
  if (!shouldLog && !willBeShown) {
    notification.expire();
  }
  if (NotificationsConfigurationImpl.getInstanceImpl().SHOW_BALLOONS) {
    final Runnable runnable=new DumbAwareRunnable(){
      @Override public void run(){
        showNotification(notification,project);
      }
    }
;
    if (project == null) {
      UIUtil.invokeLaterIfNeeded(runnable);
    }
 else     if (!project.isDisposed()) {
      StartupManager.getInstance(project).runWhenProjectIsInitialized(runnable);
    }
  }
}
