{
  final GroovyPsiElementFactory factory=GroovyPsiElementFactory.getInstance(field.getProject());
  StringBuilder builder=new StringBuilder(field.getTextLength());
  final GrClosableBlock block=(GrClosableBlock)field.getInitializerGroovy();
  final GrModifierList modifierList=field.getModifierList();
  if (modifierList.getModifiers().length > 0 || modifierList.getAnnotations().length > 0) {
    builder.append(modifierList.getText());
  }
 else {
    builder.append(GrModifier.DEF);
  }
  builder.append(' ').append(field.getName());
  builder.append('(');
  if (block.hasParametersSection()) {
    builder.append(block.getParameterList().getText());
  }
 else {
    builder.append("def it = null");
  }
  builder.append(") {");
  block.getParameterList().delete();
  block.getLBrace().delete();
  final PsiElement psiElement=PsiUtil.skipWhitespaces(block.getFirstChild(),true);
  if (psiElement != null && "->".equals(psiElement.getText())) {
    psiElement.delete();
  }
  builder.append(block.getText());
  final GrMethod method=GroovyPsiElementFactory.getInstance(field.getProject()).createMethodFromText(builder.toString());
  field.getParent().replace(method);
  for (  PsiElement usage : fieldUsages) {
    usage.replace(factory.createReferenceExpressionFromText("&" + usage.getText()));
  }
}
