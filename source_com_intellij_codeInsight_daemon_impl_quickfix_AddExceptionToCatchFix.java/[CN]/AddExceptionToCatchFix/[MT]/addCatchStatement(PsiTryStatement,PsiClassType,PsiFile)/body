{
  PsiElementFactory factory=tryStatement.getManager().getElementFactory();
  CodeStyleManager styleManager=tryStatement.getManager().getCodeStyleManager();
  String name=styleManager.suggestVariableName(VariableKind.PARAMETER,null,null,exceptionType).names[0];
  name=styleManager.suggestUniqueVariableName(name,tryStatement,false);
  PsiCatchSection catchSection=factory.createCatchSection(exceptionType,name,file);
  PsiCodeBlock finallyBlock=tryStatement.getFinallyBlock();
  if (finallyBlock == null) {
    tryStatement.add(catchSection);
  }
 else {
    PsiElement finallyElement=finallyBlock;
    while (!(finallyElement instanceof PsiKeyword) && !finallyElement.getText().equals(PsiKeyword.FINALLY)) {
      finallyElement=finallyElement.getPrevSibling();
    }
    tryStatement.addBefore(catchSection,finallyElement);
  }
  PsiParameter[] parameters=tryStatement.getCatchBlockParameters();
  parameters[parameters.length - 1].getTypeElement().replace(factory.createTypeElement(exceptionType));
  PsiCodeBlock[] catchBlocks=tryStatement.getCatchBlocks();
  PsiCodeBlock catchBlock=catchBlocks[catchBlocks.length - 1];
  return catchBlock;
}
