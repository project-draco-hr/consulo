{
  super(state);
  myState=state;
  myModuleName=moduleName;
  myModulesProvider=state.getModulesProvider();
  final VirtualFileManagerAdapter fileManagerListener=new VirtualFileManagerAdapter(){
    public void afterRefreshFinish(    boolean asynchronous){
      final Module module=getModule();
      if (module == null || module.isDisposed() || module.getProject().isDisposed())       return;
      for (      final ContentEntryEditor editor : myEntryToEditorMap.values()) {
        editor.update();
      }
    }
  }
;
  final VirtualFileManagerEx fileManager=(VirtualFileManagerEx)VirtualFileManager.getInstance();
  fileManager.addVirtualFileManagerListener(fileManagerListener);
  registerDisposable(new Disposable(){
    public void dispose(){
      fileManager.removeVirtualFileManagerListener(fileManagerListener);
    }
  }
);
}
