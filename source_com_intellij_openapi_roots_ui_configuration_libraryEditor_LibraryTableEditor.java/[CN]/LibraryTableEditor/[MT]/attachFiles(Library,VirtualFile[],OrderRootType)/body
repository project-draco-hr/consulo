{
  final VirtualFile[] filesToAttach=filterAlreadyAdded(library,files,rootType);
  if (filesToAttach.length > 0) {
    ApplicationManager.getApplication().runWriteAction(new Runnable(){
      public void run(){
        final LibraryEditor libraryEditor=getLibraryEditor(library);
        for (        VirtualFile aFilesToAttach : filesToAttach) {
          libraryEditor.addRoot(aFilesToAttach,rootType);
        }
        if (myEditingModuleLibraries) {
          commitChanges();
        }
      }
    }
);
    myTreeBuilder.updateFromRoot();
  }
}
