{
  final LibraryTableEditor libraryTableEditor=LibraryTableEditor.editLibraryTable(libraryTable);
  final MyDialogWrapper dialogWrapper=libraryTableEditor.new MyDialogWrapper(parent);
  if (selection != null) {
    ApplicationManager.getApplication().invokeLater(new Runnable(){
      public void run(){
        for (Iterator<Library> iterator=selection.iterator(); iterator.hasNext(); ) {
          final Library library=iterator.next();
          libraryTableEditor.selectLibrary(library,true);
        }
      }
    }
,ModalityState.stateForComponent(dialogWrapper.getContentPane()));
  }
  dialogWrapper.show();
  final boolean ok=dialogWrapper.isOK();
  if (selection != null && ok) {
    selection.clear();
    selection.addAll(Arrays.asList(libraryTableEditor.getSelectedLibraries()));
  }
  return ok;
}
