{
  if (myNameField != null) {
    final Library library=getSelectedLibrary();
    final String currentName=getLibraryEditor(library).getName();
    final String newName=myNameField.getText().trim();
    if (!newName.equals(currentName)) {
      if (libraryAlreadyExists(newName)) {
        Messages.showErrorDialog(ProjectBundle.message("library.name.already.exists.error",newName),ProjectBundle.message("library.name.already.exists.title"));
        return;
      }
      renameLibrary(library,newName);
    }
  }
  commitChanges();
  super.doOKAction();
  ApplicationManager.getApplication().invokeLater(new Runnable(){
    public void run(){
      Disposer.dispose(LibraryTableEditor.this);
    }
  }
);
}
