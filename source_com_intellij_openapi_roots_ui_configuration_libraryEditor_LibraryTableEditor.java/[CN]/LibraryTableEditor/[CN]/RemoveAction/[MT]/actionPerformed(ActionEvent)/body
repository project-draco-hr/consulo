{
  final Object[] selectedElements=getSelectedElements();
  if (selectedElements.length == 0) {
    return;
  }
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    public void run(){
      for (int idx=0; idx < selectedElements.length; idx++) {
        Object selectedElement=selectedElements[idx];
        if (selectedElement instanceof LibraryElement) {
          removeLibrary(((LibraryElement)selectedElement).getLibrary());
        }
 else         if (selectedElement instanceof ItemElement) {
          final ItemElement itemElement=((ItemElement)selectedElement);
          final Library library=itemElement.getLibrary();
          getLibraryEditor(library).removeRoot(itemElement.getUrl(),itemElement.getRootType());
        }
      }
      if (myEditingModuleLibraries) {
        commitChanges();
      }
    }
  }
);
  librariesChanged();
}
