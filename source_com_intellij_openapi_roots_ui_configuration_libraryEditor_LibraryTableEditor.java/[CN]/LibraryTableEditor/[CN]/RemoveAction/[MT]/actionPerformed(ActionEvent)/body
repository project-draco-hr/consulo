{
  final Object[] selectedElements=getSelectedElements();
  if (selectedElements.length == 0) {
    return;
  }
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    public void run(){
      for (      Object selectedElement : selectedElements) {
        if (selectedElement instanceof LibraryElement) {
          removeLibrary(((LibraryElement)selectedElement).getLibrary());
        }
 else         if (selectedElement instanceof ItemElement) {
          final ItemElement itemElement=(ItemElement)selectedElement;
          final Library library=itemElement.getLibrary();
          getLibraryEditor(library).removeRoot(itemElement.getUrl(),itemElement.getRootType());
        }
      }
      if (myEditingModuleLibraries) {
        commitChanges();
      }
    }
  }
);
  librariesChanged(true);
}
