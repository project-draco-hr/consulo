{
  Element newElement=new Element(CODE_SCHEME);
  newElement.setAttribute(NAME,getName());
  if (getParentScheme() != null) {
    CodeStyleSchemeImpl parentScheme=(CodeStyleSchemeImpl)getParentScheme();
    while (parentScheme.getParentScheme() != null) {
      parentScheme=(CodeStyleSchemeImpl)parentScheme.getParentScheme();
    }
    newElement.setAttribute(PARENT,parentScheme.getName());
  }
  (this).writeExternal(newElement);
  String filePath=dir.getAbsolutePath() + File.separator + getName()+ ".xml";
  try {
    JDOMUtil.writeDocument(new Document(newElement),filePath,getCodeStyleSettings().getLineSeparator());
  }
 catch (  IOException e) {
    Messages.showErrorDialog("Can't save code style scheme " + filePath + ". "+ e.getLocalizedMessage(),"Cannot Save File");
  }
}
