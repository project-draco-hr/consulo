{
  final Project project=method.getProject();
  PsiElementFactory factory=JavaPsiFacade.getInstance(project).getElementFactory();
  PsiComment comment=factory.createCommentFromText(javadoc,null);
  PsiDocComment doc=method.getDocComment();
  if (doc != null) {
    if (replace) {
      doc.replace(comment);
      final CodeStyleManager codeStyleManager=CodeStyleManager.getInstance(project);
      codeStyleManager.reformat(method);
      return comment;
    }
 else {
      return null;
    }
  }
 else {
    method.addBefore(comment,method.getFirstChild());
    final CodeStyleManager codeStyleManager=CodeStyleManager.getInstance(project);
    codeStyleManager.reformat(method);
    return comment;
  }
}
