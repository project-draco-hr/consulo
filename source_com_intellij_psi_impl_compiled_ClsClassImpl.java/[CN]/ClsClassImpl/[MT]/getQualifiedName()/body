{
synchronized (PsiLock.LOCK) {
    if (myQualifiedName == null) {
      long repositoryId=getRepositoryId();
      if (repositoryId < 0) {
        try {
          ClassFileData classFileData=getClassFileData();
          BytePointer ptr=new BytePointer(classFileData.getData(),classFileData.getConstantPoolEnd() + 2);
          ptr.offset=classFileData.getOffsetInConstantPool(ClsUtil.readU2(ptr));
          int tag=ClsUtil.readU1(ptr);
          if (tag != ClsUtil.CONSTANT_Class) {
            throw new ClsFormatException();
          }
          ptr.offset=classFileData.getOffsetInConstantPool(ClsUtil.readU2(ptr));
          String className=ClsUtil.readUtf8Info(ptr,'/','.');
          myQualifiedName=ClsUtil.convertClassName(className,false);
        }
 catch (        ClsFormatException e) {
          myQualifiedName="";
        }
      }
 else {
        myQualifiedName=getRepositoryManager().getClassView().getQualifiedName(repositoryId);
        if (myQualifiedName == null) {
          myQualifiedName="";
        }
      }
    }
  }
  return myQualifiedName;
}
