{
  ClassFileData classFileData=getClassFileData();
  int offset=classFileData.getConstantPoolEnd() + 6;
  byte[] data=classFileData.getData();
  if (offset + 2 > data.length) {
    throw new ClsFormatException();
  }
  int b1=data[offset++] & 0xFF;
  int b2=data[offset++] & 0xFF;
  int count=(b1 << 8) + b2;
  if (offset + count * 2 > data.length) {
    throw new ClsFormatException();
  }
  ClsJavaCodeReferenceElementImpl[] refs=count == 0 ? ClsJavaCodeReferenceElementImpl.EMPTY_ARRAY : new ClsJavaCodeReferenceElementImpl[count];
  for (int i=0; i < count; i++) {
    b1=data[offset++] & 0xFF;
    b2=data[offset++] & 0xFF;
    int index=(b1 << 8) + b2;
    refs[i]=classFileData.buildReference(index);
  }
  PsiReferenceList list=new ClsReferenceListImpl(this,refs,type);
  for (int i=0; i < count; i++) {
    refs[i].setParent(list);
  }
  return list;
}
