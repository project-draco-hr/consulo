{
  Document document=editor.getDocument();
  CharSequence text=document.getCharsSequence();
  if (offset >= document.getTextLength() - 1)   return offset;
  int newOffset=offset + 1;
  int lineNumber=editor.getCaretModel().getLogicalPosition().line;
  int maxOffset=document.getLineEndOffset(lineNumber);
  if (newOffset > maxOffset) {
    if (lineNumber + 1 >= document.getLineCount())     return offset;
    maxOffset=document.getLineEndOffset(lineNumber + 1);
  }
  boolean camel=editor.getSettings().isCamelWords();
  for (; newOffset < maxOffset; newOffset++) {
    if (EditorActionUtil.isWordEnd(text.charAt(newOffset - 1),text.charAt(newOffset),camel) || EditorActionUtil.isWordStart(text.charAt(newOffset - 1),text.charAt(newOffset),camel)) {
      break;
    }
  }
  return newOffset;
}
