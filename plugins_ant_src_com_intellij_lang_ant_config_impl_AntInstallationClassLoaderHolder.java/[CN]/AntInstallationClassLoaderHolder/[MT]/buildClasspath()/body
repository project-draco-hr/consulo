{
  final ArrayList<File> files=new ArrayList<File>();
  final List<AntClasspathEntry> cp=AntInstallation.CLASS_PATH.get(myOptions);
  for (  final AntClasspathEntry entry : cp) {
    entry.addFilesTo(files);
  }
  final String homeDir=System.getProperty(USER_HOME);
  if (homeDir != null && homeDir.length() > 0) {
    new AllJarsUnderDirEntry(new File(homeDir,ANT_LIB)).addFilesTo(files);
  }
  final List<URL> urls=new ArrayList<URL>(files.size());
  for (  File file : files) {
    try {
      urls.add(file.toURI().toURL());
    }
 catch (    MalformedURLException e) {
      LOG.debug(e);
    }
  }
  return new UrlClassLoader(urls,null);
}
