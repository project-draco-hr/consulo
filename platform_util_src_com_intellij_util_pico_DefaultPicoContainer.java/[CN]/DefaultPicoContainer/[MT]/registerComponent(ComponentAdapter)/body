{
  Object componentKey=componentAdapter.getComponentKey();
  if (componentKeyToAdapterCache.containsKey(componentKey)) {
    throw new DuplicateComponentKeyRegistrationException(componentKey);
  }
  if (componentAdapter instanceof AssignableToComponentAdapter) {
    String classKey=((AssignableToComponentAdapter)componentAdapter).getAssignableToClassName();
    classNameToAdapter.put(classKey,componentAdapter);
  }
 else {
    nonAssignableComponentAdapters.add(componentAdapter);
  }
  addElement(componentAdapters,componentAdapter);
  componentKeyToAdapterCache.put(componentKey,componentAdapter);
  return componentAdapter;
}
