{
  path=StringUtil.trimStart(StringUtil.trimEnd(path,"/"),"/");
  if (path.length() == 0)   return null;
  int index=path.lastIndexOf('/');
  String lastName=path.substring(index + 1);
  String parentPath=index != -1 ? path.substring(0,index) : "";
  final CompositePackagingElement<?> last=directory ? createDirectory(lastName) : createArchive(lastName);
  final Pair<? extends CompositePackagingElement<?>,? extends CompositePackagingElement<?>> parent=createDirectoryOrArchiveWithParents(parentPath,true);
  if (parent != null) {
    parent.getSecond().addChild(last);
    return Pair.create(parent.getFirst(),last);
  }
  return Pair.create(last,last);
}
