{
  try {
    if (myView.isProfileDefined()) {
      final ModifiableModel model=myView.getCurrentProfile().getModifiableModel();
      model.disableTool(myKey.toString());
      model.commit();
      myView.updateCurrentProfile();
    }
 else {
      final RefEntity[] selectedElements=myView.getTree().getSelectedElements();
      final Set<InspectionProfile> files=new HashSet<InspectionProfile>();
      final Project project=myView.getProject();
      final InspectionProjectProfileManager profileManager=InspectionProjectProfileManager.getInstance(project);
      for (      RefEntity selectedElement : selectedElements) {
        if (selectedElement instanceof RefElement) {
          final PsiElement element=((RefElement)selectedElement).getElement();
          files.add(profileManager.getInspectionProfile(element.getContainingFile()));
        }
      }
      for (      InspectionProfile inspectionProfile : files) {
        ModifiableModel model=inspectionProfile.getModifiableModel();
        model.disableTool(myKey.toString());
        model.commit();
      }
      DaemonCodeAnalyzer.getInstance(project).restart();
    }
  }
 catch (  IOException e1) {
    Messages.showErrorDialog(myView.getProject(),e1.getMessage(),CommonBundle.getErrorTitle());
  }
}
