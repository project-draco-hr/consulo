{
  final Module module=moduleOrderEntry.getModule();
  if (module != null && myProcessedModules.add(module)) {
    orderEntries.add(moduleOrderEntry);
    final ModifiableRootModel modifiableModel=ModuleRootManager.getInstance(module).getModifiableModel();
    final OrderEntry[] dependentOrderEntries=getDependentOrderEntries(modifiableModel,myProcessedModules);
    orderEntries.addAll(Arrays.asList(dependentOrderEntries));
  }
  return orderEntries;
}
