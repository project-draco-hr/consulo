{
  final Module module=moduleOrderEntry.getModule();
  if (module != null && myProcessedModules.add(module)) {
    orderEntries.add(moduleOrderEntry);
    final ModifiableRootModel modifiableModel=ModuleRootManager.getInstance(module).getModifiableModel();
    final Collection<OrderEntry> dependentOrderEntries=getDependentOrderEntries(modifiableModel,myProcessedModules);
    orderEntries.addAll(dependentOrderEntries);
  }
  return orderEntries;
}
