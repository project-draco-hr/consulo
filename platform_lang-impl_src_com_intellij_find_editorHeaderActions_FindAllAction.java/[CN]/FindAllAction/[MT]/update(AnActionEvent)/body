{
  Project project=e.getProject();
  Editor editor=e.getData(CommonDataKeys.EDITOR_EVEN_IF_INACTIVE);
  EditorSearchSession search=e.getData(EditorSearchSession.SESSION_KEY);
  updateTemplateIcon(search);
  e.getPresentation().setIcon(getTemplatePresentation().getIcon());
  e.getPresentation().setEnabled(editor != null && project != null && search != null && !project.isDisposed() && search.hasMatches() && PsiDocumentManager.getInstance(project).getPsiFile(editor.getDocument()) != null);
}
