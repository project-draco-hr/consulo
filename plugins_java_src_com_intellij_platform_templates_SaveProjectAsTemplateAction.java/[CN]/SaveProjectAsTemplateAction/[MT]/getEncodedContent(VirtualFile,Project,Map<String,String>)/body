{
  final FileTemplate template=FileTemplateManager.getInstance().getDefaultTemplate(FileHeaderChecker.FILE_HEADER_TEMPLATE_NAME);
  final String templateText=template.getText();
  final Pattern pattern=FileHeaderChecker.getTemplatePattern(template,project,new TIntObjectHashMap<String>());
  String text=VfsUtilCore.loadText(virtualFile);
  String result=convertTemplates(text,pattern,templateText);
  result=ProjectTemplateFileProcessor.encodeFile(result,virtualFile,project);
  for (  Map.Entry<String,String> entry : parameters.entrySet()) {
    result=result.replace(entry.getKey(),"${" + entry.getValue() + "}");
  }
  return result;
}
