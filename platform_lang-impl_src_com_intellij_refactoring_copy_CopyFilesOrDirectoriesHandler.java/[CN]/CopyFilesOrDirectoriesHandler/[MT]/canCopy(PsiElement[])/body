{
  HashSet<String> names=new HashSet<String>();
  for (  PsiElement element : elements) {
    if (!(element instanceof PsiFileSystemItem))     return false;
    String name=((PsiFileSystemItem)element).getName();
    if (names.contains(name)) {
      return false;
    }
    names.add(name);
    if (element instanceof PsiFile && !canCopyFile((PsiFile)element)) {
      return false;
    }
 else     if (element instanceof PsiDirectory && !canCopyDirectory((PsiDirectory)element)) {
      return false;
    }
  }
  PsiElement[] filteredElements=PsiTreeUtil.filterAncestors(elements);
  return filteredElements.length == elements.length;
}
