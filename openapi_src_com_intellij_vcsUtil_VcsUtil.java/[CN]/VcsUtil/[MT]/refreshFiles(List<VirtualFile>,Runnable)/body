{
  if (filesToRefresh.size() == 0) {
    runnable.run();
    return;
  }
  final int[] refreshed=new int[]{0};
  final Runnable afterRefresh=new Runnable(){
    public void run(){
synchronized (refreshed) {
        refreshed[0]+=1;
        if (refreshed[0] == filesToRefresh.size()) {
          runnable.run();
        }
      }
    }
  }
;
  for (  VirtualFile file : filesToRefresh) {
    file.refresh(true,true,afterRefresh);
  }
}
