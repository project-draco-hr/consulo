{
  PsiElement psiElement=context.getPsiElement();
  if (psiElement == null) {
    return null;
  }
  if (!psiElement.isValid()) {
    return null;
  }
  final String selectedAreaName;
  if (psiElement instanceof PsiClass) {
    selectedAreaName="Class";
  }
 else   if (psiElement instanceof PsiField) {
    selectedAreaName="Field";
  }
 else   if (psiElement instanceof PsiMethod) {
    selectedAreaName="Method";
  }
 else   if (psiElement instanceof XmlTag) {
    selectedAreaName="Tag";
  }
 else   if (psiElement instanceof XmlText) {
    selectedAreaName="Text";
  }
 else   if (psiElement instanceof PsiCodeBlock) {
    selectedAreaName="Code Block";
  }
 else   if (psiElement instanceof PsiStatement) {
    selectedAreaName="Statement";
  }
 else {
    return null;
  }
  TextRange textRange=psiElement.getTextRange();
  if (textRange == null) {
    return null;
  }
  VirtualFile virtualFile=psiElement.getContainingFile().getVirtualFile();
  if (virtualFile == null) {
    return null;
  }
  if (!virtualFile.isValid()) {
    return null;
  }
  Document document=FileDocumentManager.getInstance().getDocument(virtualFile);
  return new VcsSelection(document,textRange,selectedAreaName);
}
