{
  if (popup) {
    result.add(ActionManager.getInstance().getAction(IdeActions.ACTION_EDIT_SOURCE));
  }
  final MyDiffAction diffAction=new MyDiffAction();
  result.add(diffAction);
  if (!popup) {
    diffAction.registerCustomShortcutSet(new CustomShortcutSet(CommonShortcuts.getDiff().getShortcuts()[0],CommonShortcuts.DOUBLE_CLICK_1.getShortcuts()[0]),myDualView.getFlatView());
    diffAction.registerCustomShortcutSet(new CustomShortcutSet(CommonShortcuts.getDiff().getShortcuts()[0],CommonShortcuts.DOUBLE_CLICK_1.getShortcuts()[0]),myDualView.getTreeView());
  }
 else {
    diffAction.registerCustomShortcutSet(CommonShortcuts.getDiff(),this);
  }
  final MyShowDiffWithLocalAction showDiffWithLocalAction=new MyShowDiffWithLocalAction();
  result.add(showDiffWithLocalAction);
  final AnAction diffGroup=ActionManager.getInstance().getAction(VCS_HISTORY_ACTIONS_GROUP);
  if (diffGroup != null)   result.add(diffGroup);
  result.add(new MyCreatePatch());
  result.add(new MyGetVersionAction());
  result.add(new MyAnnotateAction());
  AnAction[] additionalActions=myProvider.getAdditionalActions(new Runnable(){
    public void run(){
      refreshImpl();
    }
  }
);
  if (additionalActions != null) {
    for (    AnAction additionalAction : additionalActions) {
      result.add(additionalAction);
    }
  }
  result.add(new RefreshFileHistoryAction());
  if (!myIsStaticAndEmbedded) {
    result.add(new ToggleAction("Show Details","Display details panel",AllIcons.Actions.ShowSource){
      @Override public boolean isSelected(      AnActionEvent e){
        return getConfiguration().SHOW_FILE_HISTORY_DETAILS;
      }
      @Override public void setSelected(      AnActionEvent e,      boolean state){
        getConfiguration().SHOW_FILE_HISTORY_DETAILS=state;
        setupDetails();
      }
    }
);
  }
  if (!popup && supportsTree()) {
    result.add(new MyShowAsTreeAction());
  }
  return result;
}
