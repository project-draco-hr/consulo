{
  if (popup) {
    result.add(ActionManager.getInstance().getAction(IdeActions.ACTION_EDIT_SOURCE));
  }
  final MyDiffAction diffAction=new MyDiffAction();
  result.add(diffAction);
  if (!popup) {
    diffAction.registerCustomShortcutSet(new CustomShortcutSet(CommonShortcuts.getDiff().getShortcuts()[0],CommonShortcuts.DOUBLE_CLICK_1.getShortcuts()[0]),myDualView.getFlatView());
    diffAction.registerCustomShortcutSet(new CustomShortcutSet(CommonShortcuts.getDiff().getShortcuts()[0],CommonShortcuts.DOUBLE_CLICK_1.getShortcuts()[0]),myDualView.getTreeView());
  }
 else {
    diffAction.registerCustomShortcutSet(CommonShortcuts.getDiff(),this);
  }
  result.add(ActionManager.getInstance().getAction("Vcs.ShowDiffWithLocal"));
  final AnAction diffGroup=ActionManager.getInstance().getAction(VCS_HISTORY_ACTIONS_GROUP);
  if (diffGroup != null)   result.add(diffGroup);
  result.add(new MyCreatePatch());
  result.add(new MyGetVersionAction());
  result.add(new MyAnnotateAction());
  AnAction[] additionalActions=myProvider.getAdditionalActions(new Runnable(){
    @Override public void run(){
      refreshImpl(true);
    }
  }
);
  if (additionalActions != null) {
    for (    AnAction additionalAction : additionalActions) {
      if (popup || additionalAction.getTemplatePresentation().getIcon() != null) {
        result.add(additionalAction);
      }
    }
  }
  result.add(new RefreshFileHistoryAction());
  if (!myIsStaticAndEmbedded) {
    result.add(new MyToggleAction());
  }
  if (!popup && supportsTree()) {
    result.add(new MyShowAsTreeAction());
  }
  return result;
}
