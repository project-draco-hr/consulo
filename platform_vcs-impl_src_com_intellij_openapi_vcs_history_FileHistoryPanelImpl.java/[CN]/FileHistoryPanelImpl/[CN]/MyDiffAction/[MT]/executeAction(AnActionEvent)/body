{
  List<TreeNodeOnVcsRevision> sel=getSelection();
  int selectionSize=sel.size();
  if (selectionSize > 1) {
    myDiffHandler.showDiffForTwo(e.getRequiredData(CommonDataKeys.PROJECT),myFilePath,sel.get(0).getRevision(),sel.get(sel.size() - 1).getRevision());
  }
 else   if (selectionSize == 1) {
    final TableView<TreeNodeOnVcsRevision> flatView=myDualView.getFlatView();
    final int selectedRow=flatView.getSelectedRow();
    VcsFileRevision revision=getFirstSelectedRevision();
    VcsFileRevision previousRevision;
    if (selectedRow == (flatView.getRowCount() - 1)) {
      previousRevision=myBottomRevisionForShowDiff != null ? myBottomRevisionForShowDiff : VcsFileRevision.NULL;
    }
 else {
      previousRevision=flatView.getRow(selectedRow + 1).getRevision();
    }
    if (revision != null) {
      myDiffHandler.showDiffForOne(e,e.getRequiredData(CommonDataKeys.PROJECT),myFilePath,previousRevision,revision);
    }
  }
}
