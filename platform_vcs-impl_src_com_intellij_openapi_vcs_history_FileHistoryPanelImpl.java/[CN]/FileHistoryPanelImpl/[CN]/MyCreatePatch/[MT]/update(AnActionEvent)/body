{
  e.getPresentation().setVisible(true);
  if (myFilePath.isNonLocal()) {
    e.getPresentation().setEnabled(false);
    return;
  }
  boolean enabled=(!myFilePath.isDirectory()) || myProvider.supportsHistoryForDirectories();
  final int selectionSize=getSelection().size();
  if (enabled && (!myFilePath.isDirectory())) {
    enabled=(selectionSize > 0) && (selectionSize < 3);
  }
 else   if (enabled) {
    enabled=selectionSize == 1 && getSelection().get(0).getChangedRepositoryPath() != null;
  }
  e.getPresentation().setEnabled(enabled);
}
