{
  if (processor instanceof ClassResolverProcessor && isPhysical() && (getUserData(PsiFileEx.BATCH_REFERENCE_PROCESSING) == Boolean.TRUE || myResolveCache.hasUpToDateValue())) {
    final ClassResolverProcessor hint=(ClassResolverProcessor)processor;
    String name=hint.getName(state);
    MostlySingularMultiMap<String,SymbolCollectingProcessor.ResultWithContext> cache=myResolveCache.getValue();
    MyResolveCacheProcessor cacheProcessor=new MyResolveCacheProcessor(processor,state);
    return name != null ? cache.processForKey(name,cacheProcessor) : cache.processAllValues(cacheProcessor);
  }
  return processDeclarationsNoGuess(processor,state,lastParent,place);
}
