{
  return new FileReferenceSet(text,element,offset,ReferenceType.FILE_TYPE,this,true){
    protected boolean isSoft(){
      return soft;
    }
    @NotNull public Collection<PsiFileSystemItem> computeDefaultContexts(){
      final Module module=ModuleUtil.findModuleForPsiElement(getElement());
      return getRoots(module,true);
    }
    public FileReference createFileReference(    final TextRange range,    final int index,    final String text){
      return FilePathReferenceProvider.this.createFileReference(this,range,index,text);
    }
    protected PsiScopeProcessor createProcessor(    final List<CandidateInfo> result,    List<Class> allowedClasses,    List<PsiConflictResolver> resolvers) throws ProcessorRegistry.IncompatibleReferenceTypeException {
      final PsiScopeProcessor baseProcessor=super.createProcessor(result,allowedClasses,resolvers);
      return new PsiScopeProcessor(){
        public boolean execute(        PsiElement element,        PsiSubstitutor substitutor){
          return element instanceof PsiJavaFile && element instanceof PsiCompiledElement || baseProcessor.execute(element,substitutor);
        }
        public <T>T getHint(        Class<T> hintClass){
          return baseProcessor.getHint(hintClass);
        }
        public void handleEvent(        Event event,        Object associated){
          baseProcessor.handleEvent(event,associated);
        }
      }
;
    }
  }
.getAllReferences();
}
