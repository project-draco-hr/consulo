{
  int toReplace=-1;
  for (int i=0; i < mySchemes.size(); i++) {
    T existingScheme=mySchemes.get(i);
    if (existingScheme.getName().equals(scheme.getName())) {
      toReplace=i;
      break;
    }
  }
  if (toReplace == -1) {
    mySchemes.add(scheme);
  }
 else   if (replaceExisting || !isExternalizable(scheme)) {
    mySchemes.set(toReplace,scheme);
  }
 else {
    renameScheme((E)scheme,UniqueNameGenerator.generateUniqueName(scheme.getName(),collectExistingNames(mySchemes)));
    mySchemes.add(scheme);
  }
  onSchemeAdded(scheme);
  checkCurrentScheme(scheme);
}
