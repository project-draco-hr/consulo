{
  List<PsiVariable> variables=new ArrayList<PsiVariable>();
  PsiStatement[] statements=method.getBody().getStatements();
  for (  PsiStatement statement : statements) {
    if (statement instanceof PsiDeclarationStatement) {
      PsiElement[] declaredElements=((PsiDeclarationStatement)statement).getDeclaredElements();
      for (      PsiElement declaredElement : declaredElements) {
        if (declaredElement instanceof PsiLocalVariable)         variables.add((PsiVariable)declaredElement);
      }
    }
  }
  PsiParameter[] parameters=method.getParameterList().getParameters();
  ContainerUtil.addAll(variables,parameters);
  return variables.toArray(new PsiVariable[variables.size()]);
}
