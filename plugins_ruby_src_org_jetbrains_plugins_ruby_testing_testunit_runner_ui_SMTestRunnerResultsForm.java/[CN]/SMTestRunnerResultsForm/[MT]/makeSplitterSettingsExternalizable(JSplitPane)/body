{
  final SplitterProportionsData splitterProportions=new SplitterProportionsDataImpl();
  splitterProportions.externalizeFromDimensionService(getSplitterPropertyName());
  final Container container=splitPane.getParent();
  GuiUtils.replaceJSplitPaneWithIDEASplitter(splitPane);
  final Splitter splitter=(Splitter)container.getComponent(0);
  SwingUtilities.invokeLater(new Runnable(){
    public void run(){
      splitterProportions.restoreSplitterProportions(container);
      splitter.addPropertyChangeListener(new PropertyChangeListener(){
        public void propertyChange(        final PropertyChangeEvent evt){
          if (evt.getPropertyName().equals(Splitter.PROP_PROPORTION)) {
            splitterProportions.saveSplitterProportions(container);
            splitterProportions.externalizeToDimensionService(getSplitterPropertyName());
          }
        }
      }
);
    }
  }
);
  Disposer.register(this,new Disposable(){
    public void dispose(){
      splitter.dispose();
    }
  }
);
}
