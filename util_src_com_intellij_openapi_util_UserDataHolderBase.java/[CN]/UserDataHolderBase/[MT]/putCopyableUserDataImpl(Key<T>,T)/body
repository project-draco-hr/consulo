{
  LockPoolSynchronizedMap<Key,Object> map=getOrCreateMap();
  map.getWriteLock().lock();
  try {
    Map<Key,Object> copyMap=getUserData(COPYABLE_USER_MAP_KEY);
    if (copyMap == null) {
      if (value == null)       return;
      copyMap=new LockPoolSynchronizedMap<Key,Object>(1,0.9f);
      putUserData(COPYABLE_USER_MAP_KEY,copyMap);
    }
    if (value != null) {
      copyMap.put(key,value);
    }
 else {
      copyMap.remove(key);
      if (copyMap.isEmpty()) {
        map.remove(COPYABLE_USER_MAP_KEY);
      }
    }
  }
  finally {
    map.getWriteLock().unlock();
  }
}
