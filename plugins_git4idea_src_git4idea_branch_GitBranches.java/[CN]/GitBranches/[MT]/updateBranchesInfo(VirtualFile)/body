{
  if (root == null) {
    Collection<VirtualFile> roots=new ArrayList<VirtualFile>(1);
    for (    VcsRoot vcsRoot : myVcsManager.getAllVcsRoots()) {
      if (vcsRoot.vcs != null && vcsRoot.vcs instanceof GitVcs && vcsRoot.path != null) {
        roots.add(vcsRoot.path);
      }
    }
    fullyUpdateBranchesInfo(roots);
    return;
  }
  final Task.Backgroundable task=new Task.Backgroundable(myProject,""){
    @Override public void run(    @NotNull ProgressIndicator indicator){
      try {
        GitBranch currentBranch=GitBranch.current(myProject,root);
synchronized (myCurrentBranchesLock) {
          myCurrentBranches.put(root,currentBranch);
        }
        notifyListeners();
      }
 catch (      VcsException e) {
        LOG.info("Exception while trying to get current branch for root " + root,e);
      }
    }
  }
;
  GitVcs.runInBackground(task);
}
