{
  if (myCalcedSubstitutor == null) {
    PsiSubstitutor incompleteSubstitutor=super.getSubstitutor();
    PsiMethod method=getElement();
    if (myTypeArguments == null) {
      myArgumentList.putUserData(CURRENT_CANDIDATE,getElement());
      try {
        myCalcedSubstitutor=inferTypeArguments(DefaultParameterTypeInferencePolicy.INSTANCE);
      }
  finally {
        myArgumentList.putUserData(CURRENT_CANDIDATE,null);
      }
    }
 else {
      PsiTypeParameter[] typeParams=method.getTypeParameters();
      for (int i=0; i < myTypeArguments.length && i < typeParams.length; i++) {
        incompleteSubstitutor=incompleteSubstitutor.put(typeParams[i],myTypeArguments[i]);
      }
      myCalcedSubstitutor=incompleteSubstitutor;
    }
  }
  return myCalcedSubstitutor;
}
