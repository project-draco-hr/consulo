{
  Application app=ApplicationManager.getApplication();
  if (app.isDispatchThread() || app.isWriteAccessAllowed()) {
    LOG.error("May block indefinitely: shouldn't be called from EDT or under write lock");
    return null;
  }
  if (surl == null)   return null;
  if (MyJavadocFetcher.isFree()) {
    final MyJavadocFetcher fetcher=new MyJavadocFetcher(surl,new MyDocBuilder(){
      @Override public void buildFromStream(      String surl,      Reader input,      StringBuffer result) throws IOException {
        doBuildFromStream(surl,input,result);
      }
    }
);
    final Future<?> fetcherFuture=app.executeOnPooledThread(fetcher);
    try {
      fetcherFuture.get();
    }
 catch (    Exception e) {
      return null;
    }
    final Exception exception=fetcher.getException();
    if (exception != null) {
      fetcher.cleanup();
      throw exception;
    }
    final String docText=correctRefs(ourAnchorsuffix.matcher(surl).replaceAll(""),fetcher.getData());
    if (LOG.isDebugEnabled()) {
      LOG.debug("Filtered JavaDoc: " + docText + "\n");
    }
    return PlatformDocumentationUtil.fixupText(docText);
  }
  return null;
}
