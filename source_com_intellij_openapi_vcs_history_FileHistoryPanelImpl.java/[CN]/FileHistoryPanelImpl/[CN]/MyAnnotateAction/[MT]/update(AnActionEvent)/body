{
  VirtualFile revisionVirtualFile=e.getData(VcsDataKeys.VCS_VIRTUAL_FILE);
  VcsFileRevision revision=e.getData(VcsDataKeys.VCS_FILE_REVISION);
  FileType fileType=revisionVirtualFile == null ? null : revisionVirtualFile.getFileType();
  e.getPresentation().setEnabled(revision != null && revisionVirtualFile != null && !fileType.isBinary() && myAnnotationProvider != null);
}
