{
  myVarToConstValueMapPhysical=new ConcurrentWeakHashMap<PsiVariable,Object>();
  myVarToConstValueMapNonPhysical=new ConcurrentWeakHashMap<PsiVariable,Object>();
  if (messageBus != null) {
    final MessageBusConnection connection=messageBus.connect();
    connection.subscribe(PsiManagerImpl.ANY_PSI_CHANGE_TOPIC,new AnyPsiChangeListener(){
      @Override public void beforePsiChanged(      boolean isPhysical){
        clearCaches(isPhysical);
      }
      @Override public void afterPsiChanged(      boolean isPhysical){
      }
    }
);
    connection.subscribe(PsiModificationTracker.TOPIC,new PsiModificationTracker.Listener(){
      @Override public void modificationCountChanged(){
        clearCaches(true);
      }
    }
);
  }
}
