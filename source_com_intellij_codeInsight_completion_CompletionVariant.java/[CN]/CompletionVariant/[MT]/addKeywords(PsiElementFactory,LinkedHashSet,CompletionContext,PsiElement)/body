{
  final Iterator iter=myCompletionsList.iterator();
  while (iter.hasNext()) {
    final CompletionVariantItem ce=(CompletionVariantItem)iter.next();
    final Object comp=ce.myCompletion;
    if (comp instanceof OffsetDependant) {
      ((OffsetDependant)comp).setOffset(context.startOffset);
    }
    if (comp instanceof String) {
      addKeyword(factory,set,ce,comp,context);
    }
 else     if (comp instanceof ContextGetter) {
      final Object[] elements=((ContextGetter)comp).get(position,context);
      for (int i=0; i < elements.length; i++) {
        addLookupItem(set,ce,elements[i],context.prefix);
      }
    }
 else     if (comp instanceof KeywordChooser) {
      final String[] keywords=((KeywordChooser)comp).getKeywords(context,position);
      for (int i=0; i < keywords.length; i++) {
        addKeyword(factory,set,ce,keywords[i],context);
      }
    }
  }
}
