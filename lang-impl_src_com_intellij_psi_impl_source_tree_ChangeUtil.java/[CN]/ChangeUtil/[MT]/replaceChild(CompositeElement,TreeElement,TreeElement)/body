{
  LOG.assertTrue(old.getTreeParent() == parent);
  final TreeElement oldChild=transformAll(old);
  final TreeElement newChildNext=newC.getTreeNext();
  final TreeElement newChild=transformAll(newC);
  if (oldChild == newChild)   return;
  final CharTable newCharTable=SharedImplUtil.findCharTableByTree(parent);
  final CharTable oldCharTable=SharedImplUtil.findCharTableByTree(newChild);
  removeChildrenInner(newChild,newChildNext,oldCharTable);
  if (oldCharTable != newCharTable)   registerLeafsInCharTab(newCharTable,newChild,oldCharTable);
  prepareAndRunChangeAction(new ChangeAction(){
    public void makeChange(    TreeChangeEvent destinationTreeChange){
      replace(destinationTreeChange,oldChild,newChild);
      repairRemovedElement(parent,newCharTable,oldChild);
    }
  }
,parent);
}
