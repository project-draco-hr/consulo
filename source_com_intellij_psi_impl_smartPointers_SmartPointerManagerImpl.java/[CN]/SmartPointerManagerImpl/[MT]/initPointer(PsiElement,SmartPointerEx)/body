{
  PsiFile file=element.getContainingFile();
  if (file != null) {
synchronized (file) {
      Document document=PsiDocumentManager.getInstance(myProject).getCachedDocument(file);
      if (document != null) {
        if (!(element instanceof PsiFile)) {
          LOG.assertTrue(!PsiDocumentManager.getInstance(myProject).isUncommited(document));
        }
      }
      ArrayList<WeakReference<SmartPointerEx>> pointers=file.getUserData(SMART_POINTERS_IN_PSI_FILE_KEY);
      if (pointers == null) {
        pointers=new ArrayList<WeakReference<SmartPointerEx>>();
        file.putUserData(SMART_POINTERS_IN_PSI_FILE_KEY,pointers);
      }
      pointers.add(new WeakReference<SmartPointerEx>(pointer));
      Boolean isFasten=file.getUserData(BELTS_ARE_FASTEN_KEY);
      if (isFasten == Boolean.TRUE) {
        pointer.fastenBelt();
      }
    }
  }
}
