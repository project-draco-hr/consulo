{
  final ActionCallback result=new ActionCallback();
  final ProjectView projectView=ProjectView.getInstance(project);
  if (ApplicationManager.getApplication().isUnitTestMode()) {
    AbstractProjectViewPane pane=projectView.getProjectViewPaneById(ProjectViewPane.ID);
    pane.select(toSelect,virtualFile,requestFocus);
    return result;
  }
  ToolWindowManager windowManager=ToolWindowManager.getInstance(project);
  final ToolWindow projectViewToolWindow=windowManager.getToolWindow(ToolWindowId.PROJECT_VIEW);
  final Runnable runnable=new Runnable(){
    @Override public void run(){
      if (requestFocus) {
        projectView.changeView(viewId,subviewId);
      }
      projectView.selectCB(toSelect,virtualFile,requestFocus).notify(result);
    }
  }
;
  if (requestFocus) {
    projectViewToolWindow.activate(runnable,false);
  }
 else {
    projectViewToolWindow.show(runnable);
  }
  return result;
}
