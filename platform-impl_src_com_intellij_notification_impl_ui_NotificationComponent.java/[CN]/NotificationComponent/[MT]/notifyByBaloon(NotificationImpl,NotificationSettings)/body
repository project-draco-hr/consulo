{
  if (NotificationDisplayType.BALOON.equals(settings.getDisplayType())) {
    final String html=String.format("%s",notification.getName());
    final Balloon balloon=JBPopupFactory.getInstance().createHtmlTextBalloonBuilder(html,NotificationUtil.getIcon(notification),NotificationUtil.getColor(notification),null).setCloseButtonEnabled(true).setShowCallout(false).setFadeoutTime(3000).setHideOnClickOutside(false).setHideOnKeyOutside(false).setHideOnFrameResize(false).setClickHandler(new ActionListener(){
      public void actionPerformed(      final ActionEvent e){
        performNotificationAction(notification);
      }
    }
,true).createBalloon();
    final Runnable show=new Runnable(){
      public void run(){
        final Window window=SwingUtilities.getWindowAncestor(NotificationComponent.this);
        if (window instanceof IdeFrameImpl) {
          final BalloonLayout balloonLayout=((IdeFrameImpl)window).getBalloonLayout();
          balloonLayout.add(balloon);
        }
      }
    }
;
    SwingUtilities.invokeLater(new Runnable(){
      public void run(){
        show.run();
      }
    }
);
  }
}
