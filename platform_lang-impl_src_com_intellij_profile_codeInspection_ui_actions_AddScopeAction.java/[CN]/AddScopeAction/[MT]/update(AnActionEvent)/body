{
  final Presentation presentation=e.getPresentation();
  presentation.setEnabled(false);
  if (getSelectedProfile() == null)   return;
  final Project project=PlatformDataKeys.PROJECT.getData(e.getDataContext());
  if (project == null)   return;
  final InspectionConfigTreeNode[] selectedNodes=myTree.getSelectedNodes(InspectionConfigTreeNode.class,null);
  if (selectedNodes == null)   return;
  final List<Descriptor> descriptors=new ArrayList<Descriptor>();
  for (  InspectionConfigTreeNode node : selectedNodes) {
    collect(descriptors,new ArrayList<InspectionConfigTreeNode>(),node);
  }
  presentation.setEnabled(!getAvailableScopes(project,descriptors).isEmpty());
}
