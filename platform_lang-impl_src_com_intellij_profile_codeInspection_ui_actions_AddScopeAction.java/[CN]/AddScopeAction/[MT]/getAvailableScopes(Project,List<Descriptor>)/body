{
  final ArrayList<NamedScope> scopes=new ArrayList<NamedScope>();
  for (  NamedScopesHolder holder : NamedScopesHolder.getAllNamedScopeHolders(project)) {
    Collections.addAll(scopes,holder.getScopes());
  }
  scopes.remove(CustomScopesProviderEx.getAllScope());
  CustomScopesProviderEx.filterNoSettingsScopes(project,scopes);
  final Set<NamedScope> used=new HashSet<NamedScope>();
  for (  Descriptor descriptor : descriptors) {
    final List<ScopeToolState> nonDefaultTools=getSelectedProfile().getNonDefaultTools(descriptor.getKey().toString(),project);
    if (nonDefaultTools != null) {
      for (      ScopeToolState state : nonDefaultTools) {
        used.add(state.getScope(project));
      }
    }
  }
  scopes.removeAll(used);
  final List<String> availableScopes=new ArrayList<String>();
  for (  NamedScope scope : scopes) {
    availableScopes.add(scope.getName());
  }
  return availableScopes;
}
