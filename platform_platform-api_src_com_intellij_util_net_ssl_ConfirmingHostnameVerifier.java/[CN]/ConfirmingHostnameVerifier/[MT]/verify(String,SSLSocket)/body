{
  if (host == null) {
    throw new NullPointerException("host to verify is null");
  }
  SSLSession session=ssl.getSession();
  if (session == null) {
    final InputStream in=ssl.getInputStream();
    in.available();
    session=ssl.getSession();
    if (session == null) {
      ssl.startHandshake();
      session=ssl.getSession();
    }
  }
  final Certificate[] certs=session.getPeerCertificates();
  final X509Certificate x509=(X509Certificate)certs[0];
  verify(host,x509);
}
