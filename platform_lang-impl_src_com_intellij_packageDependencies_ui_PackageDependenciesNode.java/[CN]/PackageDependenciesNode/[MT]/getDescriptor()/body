{
  if (getProject() == null)   return null;
  final PsiElement psiElement=getPsiElement();
  if (psiElement == null)   return null;
  final VirtualFile virtualFile=psiElement.getContainingFile().getVirtualFile();
  if (virtualFile == null || !virtualFile.isValid())   return null;
  return new OpenFileDescriptor(getProject(),virtualFile,psiElement.getTextOffset());
}
