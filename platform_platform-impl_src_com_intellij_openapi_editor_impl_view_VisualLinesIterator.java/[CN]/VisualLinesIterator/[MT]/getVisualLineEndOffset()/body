{
  checkEnd();
  if (myNextLocation == null) {
    myNextLocation=myLocation.clone();
    myNextLocation.advance();
  }
  return myNextLocation.atEnd() ? myDocument.getTextLength() : myNextLocation.softWrap == myLocation.softWrap ? myDocument.getLineEndOffset(myNextLocation.logicalLine - 2) : myNextLocation.offset;
}
