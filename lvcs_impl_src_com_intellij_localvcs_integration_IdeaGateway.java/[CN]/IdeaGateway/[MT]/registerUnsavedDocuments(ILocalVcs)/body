{
  vcs.beginChangeSet();
  for (  Document d : getUnsavedDocuments()) {
    VirtualFile f=getDocumentFile(d);
    if (!f.isValid() || !getFileFilter().isAllowedAndUnderContentRoot(f))     continue;
    vcs.changeFileContent(f.getPath(),contentFactoryFor(d),Clock.getCurrentTimestamp());
  }
  vcs.endChangeSet(null);
}
