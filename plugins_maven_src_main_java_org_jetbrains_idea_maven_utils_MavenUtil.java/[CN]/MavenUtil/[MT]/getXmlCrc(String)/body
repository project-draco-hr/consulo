{
  Lexer lexer=new XmlLexer();
  lexer.start(xmlText.trim());
  CRC32 crc=new CRC32();
  while (true) {
    IElementType tokenType=lexer.getTokenType();
    if (tokenType == null)     break;
    if (XmlTokenType.XML_REAL_WHITE_SPACE == tokenType || XmlTokenType.XML_WHITE_SPACE == tokenType || XmlTokenType.COMMENTS.contains(tokenType)) {
      crc.update(1);
      do {
        lexer.advance();
        tokenType=lexer.getTokenType();
      }
 while (XmlTokenType.XML_REAL_WHITE_SPACE == tokenType || XmlTokenType.XML_WHITE_SPACE == tokenType || XmlTokenType.COMMENTS.contains(tokenType));
    }
 else {
      for (int start=lexer.getTokenStart(), end=lexer.getTokenEnd(); start < end; start++) {
        char a=xmlText.charAt(start);
        crc.update(a);
        crc.update(a >>> 8);
      }
      lexer.advance();
    }
  }
  return (int)crc.getValue();
}
