{
  DropLocation dropLocation=null;
  if (selection.size() > 0) {
    RadComponent component=selection.get(0);
    final RadContainer container=component.getParent();
    if (container.isGrid()) {
      GridLayoutManager grid=(GridLayoutManager)container.getLayout();
      GridConstraints c=component.getConstraints();
      if (c.getColumn() + c.getColSpan() < grid.getColumnCount() && container.getComponentAtGrid(c.getRow(),c.getColumn() + c.getColSpan()) == null) {
        dropLocation=new GridDropLocation(container,c.getRow(),c.getColumn() + c.getColSpan());
      }
 else       if (c.getRow() + c.getRowSpan() < grid.getRowCount() && container.getComponentAtGrid(c.getRow() + c.getRowSpan(),c.getColumn()) == null) {
        dropLocation=new GridDropLocation(container,c.getRow() + c.getRowSpan(),c.getColumn());
      }
 else {
        dropLocation=new GridInsertLocation(container,c.getRow() + c.getRowSpan() - 1,c.getColumn(),GridInsertMode.RowAfter);
      }
    }
  }
  if (dropLocation == null) {
    dropLocation=GridInsertProcessor.getDropLocation(editor.getRootContainer(),editor.getMainProcessor().getLastMousePosition());
  }
  return dropLocation;
}
