{
  IdeView view=e.getData(LangDataKeys.IDE_VIEW);
  Project project=e.getData(CommonDataKeys.PROJECT);
  if (view == null || project == null) {
    return;
  }
  PsiDirectory directory=DirectoryChooserUtil.getOrChooseDirectory(view);
  if (directory == null) {
    return;
  }
  CreateType createType=CreateType.findCreateType(directory);
  CreateDirectoryOrPackageHandler validator=new CreateDirectoryOrPackageHandler(project,directory,createType == CreateType.Directory,createType.getSeparator());
  Messages.showInputDialog(project,IdeBundle.message("prompt.enter.new.name"),createType.getName(),Messages.getQuestionIcon(),"",validator);
  final PsiElement result=validator.getCreatedElement();
  if (result != null) {
    view.selectElement(result);
  }
}
