{
  if (directories.length == 0) {
    return Directory;
  }
  Project project=directories[0].getProject();
  PsiPackageManager packageManager=PsiPackageManager.getInstance(project);
  ProjectFileIndex projectFileIndex=ProjectFileIndex.SERVICE.getInstance(project);
  for (  PsiDirectory directory : directories) {
    if (projectFileIndex.isInResource(directory.getVirtualFile()) || projectFileIndex.isInTestResource(directory.getVirtualFile())) {
      continue;
    }
    PsiPackage anyPackage=packageManager.findAnyPackage(directory);
    if (anyPackage != null) {
      return projectFileIndex.isInTestSourceContent(directory.getVirtualFile()) ? TestPackage : Package;
    }
  }
  return Directory;
}
