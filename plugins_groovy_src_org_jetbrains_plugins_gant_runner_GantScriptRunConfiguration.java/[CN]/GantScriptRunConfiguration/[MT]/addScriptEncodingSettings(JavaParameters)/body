{
  Charset charset;
  final VirtualFile fileByUrl=VirtualFileManager.getInstance().findFileByUrl("file://" + scriptPath);
  charset=EncodingProjectManager.getInstance(getProject()).getEncoding(fileByUrl,true);
  if (charset == null) {
    charset=EncodingManager.getInstance().getDefaultCharset();
    if (!Comparing.equal(CharsetToolkit.getDefaultSystemCharset(),charset)) {
      params.getProgramParametersList().add("--encoding=" + charset.displayName());
    }
  }
 else {
    params.getProgramParametersList().add("--encoding=" + charset.displayName());
  }
}
