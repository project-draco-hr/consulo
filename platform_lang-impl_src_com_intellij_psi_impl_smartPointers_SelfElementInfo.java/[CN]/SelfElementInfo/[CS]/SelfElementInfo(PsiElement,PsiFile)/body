{
  LOG.assertTrue(anchor.isPhysical());
  LOG.assertTrue(anchor.isValid());
  PsiFile file=anchor.getContainingFile();
  myVirtualFile=file.getVirtualFile();
  TextRange range=anchor.getTextRange();
  LOG.assertTrue(range != null,anchor);
  range=getPersistentAnchorRange(anchor);
  myProject=file.getProject();
  PsiDocumentManager documentManager=PsiDocumentManager.getInstance(myProject);
  Document document=documentManager.getDocument(file);
  if (document == null || documentManager.isUncommited(document)) {
    mySyncMarkerIsValid=false;
    return;
  }
  if (documentManager.isUncommited(document)) {
    mySyncMarkerIsValid=false;
  }
 else {
    mySyncMarkerIsValid=true;
    myType=anchor.getClass();
  }
  mySyncStartOffset=range.getStartOffset();
  mySyncEndOffset=range.getEndOffset();
}
