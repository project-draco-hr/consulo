{
  RangeMarker marker=getMarker();
  if (marker != null) {
    return marker.getDocument();
  }
  return myVirtualFile == null ? null : FileDocumentManager.getInstance().getCachedDocument(myVirtualFile);
}
