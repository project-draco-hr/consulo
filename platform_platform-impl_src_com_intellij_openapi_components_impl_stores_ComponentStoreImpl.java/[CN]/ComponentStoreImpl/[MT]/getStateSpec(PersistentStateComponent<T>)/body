{
  final Class<? extends PersistentStateComponent> aClass=persistentStateComponent.getClass();
  final State stateSpec=aClass.getAnnotation(State.class);
  if (stateSpec == null) {
    final PluginId pluginId=PluginManagerCore.getPluginByClassName(aClass.getName());
    if (pluginId != null) {
      throw new PluginException("No @State annotation found in " + aClass,pluginId);
    }
    throw new RuntimeException("No @State annotation found in " + aClass);
  }
  return stateSpec;
}
