{
  try {
    final SaveSessionImpl session=createSaveSession();
    try {
      session.commit();
    }
 catch (    Throwable e) {
      try {
        session.reset();
      }
 catch (      Exception e1_ignored) {
        LOG.info(e1_ignored);
      }
      PluginId pluginId=IdeErrorsDialog.findPluginId(e);
      if (pluginId != null) {
        throw new PluginException(e,pluginId);
      }
      LOG.info(e);
      IOException ioException=new IOException(e.getMessage());
      ioException.initCause(e);
      throw ioException;
    }
    mySession=session;
    return mySession;
  }
 catch (  StateStorageException e) {
    LOG.info(e);
    throw new IOException(e.getMessage());
  }
}
