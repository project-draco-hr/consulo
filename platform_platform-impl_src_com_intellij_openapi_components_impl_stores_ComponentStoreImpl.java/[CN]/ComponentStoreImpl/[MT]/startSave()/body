{
  SaveSessionImpl session=createSaveSession();
  try {
    session.commit();
  }
 catch (  Throwable e) {
    try {
      session.reset();
    }
 catch (    Exception e1_ignored) {
      LOG.info(e1_ignored);
    }
    PluginId pluginId=IdeErrorsDialog.findPluginId(e);
    if (pluginId != null) {
      throw new PluginException(e,pluginId);
    }
    throw new StateStorageException(e);
  }
  mySession=session;
  return mySession;
}
