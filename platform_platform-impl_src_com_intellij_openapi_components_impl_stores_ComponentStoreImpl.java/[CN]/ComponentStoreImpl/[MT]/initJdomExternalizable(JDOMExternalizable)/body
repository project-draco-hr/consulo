{
  String componentName=ComponentManagerImpl.getComponentName(component);
  doAddComponent(componentName,component);
  if (optimizeTestLoading()) {
    return;
  }
  loadJdomDefaults(component,componentName);
  StateStorage stateStorage=getStateStorageManager().getOldStorage(component,componentName,StateStorageOperation.READ);
  if (stateStorage == null) {
    return;
  }
  Element element=stateStorage.getState(component,componentName,Element.class,null);
  if (element == null) {
    return;
  }
  try {
    if (LOG.isDebugEnabled()) {
      LOG.debug("Loading configuration for " + component.getClass());
    }
    component.readExternal(element);
  }
 catch (  InvalidDataException e) {
    LOG.error(e);
    return;
  }
  validateUnusedMacros(componentName,true);
}
