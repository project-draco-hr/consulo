{
  HgMQCommand mqCommand=new HgMQCommand(project);
  boolean foundAppliedPatches=!mqCommand.qapplied(repository).isEmpty();
  if (foundAppliedPatches) {
    throw new VcsException("Cannot update with applied MQ patches, please use rebase");
  }
 else {
    return new HgRegularUpdater(project,repository,configuration);
  }
}
