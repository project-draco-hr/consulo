{
  final Map<File,Set<File>> map=new HashMap<File,Set<File>>();
  final boolean compilingTests=context.isCompilingTests();
  for (  Module module : chunk.getModules()) {
    final String outputPath;
    final Collection<String> srcPaths;
    if (compilingTests) {
      outputPath=module.getTestOutputPath();
      srcPaths=(Collection<String>)module.getTestRoots();
    }
 else {
      outputPath=module.getOutputPath();
      srcPaths=(Collection<String>)module.getSourceRoots();
    }
    final Set<File> roots=new HashSet<File>();
    for (    String path : srcPaths) {
      roots.add(new File(path));
    }
    map.put(new File(outputPath),roots);
  }
  return map;
}
