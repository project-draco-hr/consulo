{
  final ClassProcessingConsumer classesConsumer=new ClassProcessingConsumer(context,outputSink);
  try {
    final JavacProxy proxy=createJavacProxy(context);
    return proxy.compile(options,files,classpath,platformCp,sourcePath,outs,diagnosticSink,classesConsumer);
  }
  finally {
    classesConsumer.ensurePendingTasksCompleted();
  }
}
