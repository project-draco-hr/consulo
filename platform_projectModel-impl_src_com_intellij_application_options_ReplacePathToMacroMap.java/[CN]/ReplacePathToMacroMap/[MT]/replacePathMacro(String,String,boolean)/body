{
  if (text.length() < path.length() || path.isEmpty()) {
    return text;
  }
  boolean startsWith=caseSensitive ? text.startsWith(path) : StringUtil.startsWithIgnoreCase(text,path);
  if (!startsWith)   return text;
  int endOfOccurrence=path.length();
  final boolean isWindowsRoot=path.endsWith(":/");
  if (!isWindowsRoot && endOfOccurrence < text.length() && text.charAt(endOfOccurrence) != '/' && !text.substring(endOfOccurrence).startsWith("!/")) {
    return text;
  }
  return myMacroMap.get(path) + text.substring(endOfOccurrence);
}
