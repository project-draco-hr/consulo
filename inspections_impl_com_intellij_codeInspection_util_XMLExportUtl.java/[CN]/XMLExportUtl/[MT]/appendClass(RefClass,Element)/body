{
  PsiClass psiClass=(PsiClass)refClass.getElement();
  PsiDocComment psiDocComment=psiClass.getDocComment();
  PsiFile psiFile=psiClass.getContainingFile();
  if (psiFile instanceof PsiJavaFile) {
    String packageName=((PsiJavaFile)psiFile).getPackageName();
    Element packageElement=new Element(InspectionsBundle.message("inspection.export.results.package"));
    packageElement.addContent(packageName.length() > 0 ? packageName : InspectionsBundle.message("inspection.export.results.default"));
    parentNode.addContent(packageElement);
  }
  Element classElement=new Element(InspectionsBundle.message("inspection.export.results.class"));
  if (psiDocComment != null) {
    PsiDocTag[] tags=psiDocComment.getTags();
    for (int i=0; i < tags.length; i++) {
      PsiDocTag tag=tags[i];
      if (InspectionsBundle.message("inspection.export.results.author").equals(tag.getName()) && tag.getValueElement() != null) {
        classElement.setAttribute(InspectionsBundle.message("inspection.export.results.author"),tag.getValueElement().getText());
      }
    }
  }
  String name=PsiFormatUtil.formatClass(psiClass,PsiFormatUtil.SHOW_NAME);
  Element nameElement=new Element(InspectionsBundle.message("inspection.export.results.name"));
  nameElement.addContent(name);
  classElement.addContent(nameElement);
  Element displayName=new Element(InspectionsBundle.message("inspection.export.results.display.name"));
  final RefUtil refUtil=RefUtil.getInstance();
  displayName.addContent(refUtil.getQualifiedName(refClass));
  classElement.addContent(displayName);
  parentNode.addContent(classElement);
  RefClass topClass=refUtil.getTopLevelClass(refClass);
  if (topClass != refClass) {
    appendClass(topClass,classElement);
  }
}
