{
  int startOffset=getStartOffset();
switch (getTargetArea()) {
case EXACT_RANGE:
    return startOffset;
case LINES_IN_RANGE:
  Document document=myModel.getDocument();
int textLength=document.getTextLength();
if (startOffset >= textLength) return textLength;
return document.getLineStartOffset(document.getLineNumber(startOffset));
default :
throw new IllegalStateException(getTargetArea().toString());
}
}
