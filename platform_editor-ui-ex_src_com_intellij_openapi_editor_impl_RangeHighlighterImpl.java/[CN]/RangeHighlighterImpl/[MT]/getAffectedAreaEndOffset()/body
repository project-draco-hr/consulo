{
  int endOffset=getEndOffset();
switch (getTargetArea()) {
case EXACT_RANGE:
    return endOffset;
case LINES_IN_RANGE:
  Document document=myModel.getDocument();
int textLength=document.getTextLength();
if (endOffset >= textLength) return endOffset;
return Math.min(textLength,document.getLineEndOffset(document.getLineNumber(endOffset)) + 1);
default :
throw new IllegalStateException(getTargetArea().toString());
}
}
