{
  myProject=project;
  final boolean multiModuleProject=ModuleManager.getInstance(project).getModules().length > 1;
  myShowModules=settings.UI_SHOW_MODULES && multiModuleProject;
  myGroupByScopeType=settings.UI_GROUP_BY_SCOPE_TYPE;
  myFlattenPackages=settings.UI_FLATTEN_PACKAGES;
  myShowFiles=settings.UI_SHOW_FILES;
  myShowIndividualLibs=showIndividualLibs;
  myShowModuleGroups=settings.UI_SHOW_MODULE_GROUPS && multiModuleProject;
  myMarker=marker;
  myAddUnmarkedFiles=!settings.UI_FILTER_LEGALS;
  myRoot=new RootNode(project);
  myFileIndex=ProjectRootManager.getInstance(project).getFileIndex();
  createMaps(ScopeType.LIB);
  createMaps(ScopeType.SOURCE);
  createMaps(ScopeType.TEST);
  if (myGroupByScopeType) {
    mySourceRoot=new GeneralGroupNode(PRODUCTION_NAME,PlatformIcons.PACKAGE_OPEN_ICON,PlatformIcons.PACKAGE_ICON,project);
    myTestRoot=new GeneralGroupNode(TEST_NAME,TEST_ICON,TEST_ICON,project);
    myLibsRoot=new GeneralGroupNode(LIBRARY_NAME,LIB_ICON_OPEN,LIB_ICON_CLOSED,project);
    myRoot.add(mySourceRoot);
    myRoot.add(myTestRoot);
    myRoot.add(myLibsRoot);
  }
  myJavaPsiFacade=JavaPsiFacade.getInstance(myProject);
}
