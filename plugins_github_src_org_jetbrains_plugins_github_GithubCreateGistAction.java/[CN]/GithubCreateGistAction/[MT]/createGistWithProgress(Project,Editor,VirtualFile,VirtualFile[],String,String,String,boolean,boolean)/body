{
  final AtomicReference<String> url=new AtomicReference<String>();
  ProgressManager.getInstance().runProcessWithProgressSynchronously(new Runnable(){
    @Override public void run(){
      List<NamedContent> contents=collectContents(project,editor,file,files);
      if (contents == null) {
        return;
      }
      String gistUrl=createGist(project,login,password,anonymous,contents,aPrivate,description);
      url.set(gistUrl);
    }
  }
,"Communicating With GitHub",false,project);
  return url.get();
}
