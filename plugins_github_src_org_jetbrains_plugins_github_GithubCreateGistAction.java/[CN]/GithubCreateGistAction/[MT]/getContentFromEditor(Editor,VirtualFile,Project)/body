{
  String text=ApplicationManager.getApplication().runReadAction(new Computable<String>(){
    @Nullable @Override public String compute(){
      return editor.getSelectionModel().getSelectedText();
    }
  }
);
  if (text == null) {
    text=editor.getDocument().getText();
  }
  if (StringUtil.isEmpty(text)) {
    showError(project,FAILED_TO_CREATE_GIST,"No text was selected to Gist",null,null);
    return null;
  }
  String name;
  if (selectedFile == null) {
    name="";
  }
 else {
    name=selectedFile.getName();
  }
  return new NamedContent(name,text);
}
