{
  final Project project=location.getProject();
  final PsiElement element=location.getPsiElement();
  myPackage=checkPackage(element);
  if (myPackage == null)   return null;
  RunnerAndConfigurationSettingsImpl settings=cloneTemplateConfiguration(project,context);
  final TestNGConfiguration configuration=(TestNGConfiguration)settings.getConfiguration();
  final TestData data=configuration.data;
  data.PACKAGE_NAME=myPackage.getQualifiedName();
  data.TEST_OBJECT=TestType.PACKAGE.getType();
  data.setScope(setupPackageConfiguration(context,project,configuration,data.getScope()));
  configuration.setGeneratedName();
  RunConfigurationExtension.patchCreatedConfiguration(configuration);
  return settings;
}
