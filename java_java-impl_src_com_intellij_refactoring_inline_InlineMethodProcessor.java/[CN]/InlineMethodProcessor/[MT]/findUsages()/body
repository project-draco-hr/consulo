{
  if (myInlineThisOnly)   return new UsageInfo[]{new UsageInfo(myReference)};
  Set<UsageInfo> usages=new HashSet<UsageInfo>();
  if (myReference != null) {
    usages.add(new UsageInfo(myReference));
  }
  for (  PsiReference reference : ReferencesSearch.search(myMethod)) {
    usages.add(new UsageInfo(reference.getElement()));
  }
  if (mySearchInComments || mySearchForTextOccurrences) {
    if (mySearchInComments) {
      String stringToSearch=ElementDescriptionUtil.getElementDescription(myMethod,NonCodeSearchDescriptionLocation.STRINGS_AND_COMMENTS);
      TextOccurrencesUtil.addUsagesInStringsAndComments(myMethod,stringToSearch,usages,new NonCodeUsageInfoFactory(myMethod,myMethod.getName()));
    }
    if (mySearchForTextOccurrences) {
      String stringToSearch=ElementDescriptionUtil.getElementDescription(myMethod,NonCodeSearchDescriptionLocation.NON_JAVA);
      TextOccurrencesUtil.addTextOccurences(myMethod,stringToSearch,GlobalSearchScope.projectScope(myProject),usages,new NonCodeUsageInfoFactory(myMethod,myMethod.getName()));
    }
  }
  return usages.toArray(new UsageInfo[usages.size()]);
}
