{
  VirtualFile root=dir.createChildDirectory(null,"root");
  final String url=root.getUrl();
  root.delete(null);
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    @Override public void run(){
      ModifiableRootModel m=getRootManager().getModifiableModel();
      m.addContentEntry(url);
      m.commit();
    }
  }
);
  assertNotNull(findContentEntry(url));
  root=dir.createChildDirectory(null,"root");
  assertSame(root,findContentEntry(url).getFile());
}
