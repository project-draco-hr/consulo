{
  final PainterSettings s=getSettings();
  final Font oldFont=g2.getFont();
  final int offset=c.getOffset() - pageOffset;
  final Color bg=s.getBackgroundColor(c);
  final int width=c.getWidth();
  if (bg != null) {
    g2.setColor(bg);
    g2.fillRoundRect(offset + 2,0,width - 4,height - 2,ROUND_VALUE,ROUND_VALUE);
  }
  final Color borderColor=s.getBorderColor(c);
  if (borderColor != null) {
    g2.setColor(borderColor);
    g2.drawRoundRect(offset + 1,0,width - 2,height - 2,ROUND_VALUE,ROUND_VALUE);
  }
  final Color textColor=s.getForegroundColor(c);
  if (textColor != null) {
    g2.setColor(textColor);
  }
  final Font font=s.getFont(g2,c);
  if (font != null) {
    g2.setFont(font);
  }
  final FontMetrics fm=g2.getFontMetrics();
  String string=c.getString();
  if (fm.stringWidth(string) > width) {
    final int dotsWidth=fm.stringWidth("...");
    final StringBuffer sb=new StringBuffer();
    int length=0;
    for (int i=0; i < string.length(); i++) {
      final int charWidth=fm.charWidth(string.charAt(i));
      if (length + charWidth + dotsWidth > width) {
        break;
      }
      length+=charWidth;
      sb.append(string.charAt(i));
    }
    string=sb.append("...").toString();
  }
  UIUtil.applyRenderingHints(g2);
  g2.drawString(string,offset + ROUND_VALUE,height - fm.getDescent() - 2);
  g2.setFont(oldFont);
}
