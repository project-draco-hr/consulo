{
  this.project=project;
  BrowseModuleValueActionListener[] browseListeners=new BrowseModuleValueActionListener[]{new PackageBrowser(project),new TestClassBrowser(project,this),new MethodBrowser(project,this),new GroupBrowser(project,this),new SuiteBrowser(project)};
  model=new TestNGConfigurationModel(project);
  model.setListener(this);
  createView();
  moduleSelector=new ConfigurationModuleSelector(project,getModulesComponent());
  commonJavaParameters.setModuleContext(moduleSelector.getModule());
  moduleClasspath.getComponent().addActionListener(new ActionListener(){
    public void actionPerformed(    ActionEvent e){
      commonJavaParameters.setModuleContext(moduleSelector.getModule());
    }
  }
);
  registerListener(new JRadioButton[]{packageTest,classTest,methodTest,groupTest,suiteTest},new ChangeListener(){
    public void stateChanged(    ChangeEvent e){
      ButtonModel buttonModel=(ButtonModel)e.getSource();
      if (buttonModel.isSelected()) {
        if (buttonModel == packageTest.getModel()) {
          model.setType(TestType.PACKAGE);
        }
 else         if (buttonModel == classTest.getModel()) {
          model.setType(TestType.CLASS);
        }
 else         if (buttonModel == methodTest.getModel()) {
          model.setType(TestType.METHOD);
        }
 else         if (buttonModel == groupTest.getModel()) {
          model.setType(TestType.GROUP);
        }
 else         if (buttonModel == suiteTest.getModel()) {
          model.setType(TestType.SUITE);
        }
        redisplay();
      }
    }
  }
);
  registerListener(new JRadioButton[]{packagesInProject,packagesInModule,packagesAcrossModules},null);
  packagesInProject.addChangeListener(new ChangeListener(){
    public void stateChanged(    ChangeEvent e){
      evaluateModuleClassPath();
    }
  }
);
  LabeledComponent[] components=new LabeledComponent[]{packageField,classField,methodField,groupField,suiteField};
  for (int i=0; i < components.length; i++) {
    TextFieldWithBrowseButton field=(TextFieldWithBrowseButton)components[i].getComponent();
    Document document=model.getDocument(i);
    field.getTextField().setDocument(document);
    browseListeners[i].setField(field);
  }
  model.setType(TestType.CLASS);
  addListener.addActionListener(new AddTestListenerListener());
  removeListener.addActionListener(new ActionListener(){
    public void actionPerformed(    ActionEvent event){
      int idx=listenersTable.getSelectedIndex() - 1;
      for (      int row : listenersTable.getSelectedIndices()) {
        listenerModel.removeListener(row);
      }
      if (idx > -1)       listenersTable.setSelectedIndex(idx);
    }
  }
);
  propertiesFile.getComponent().getTextField().setDocument(model.getPropertiesFileDocument());
  outputDirectory.getComponent().getTextField().setDocument(model.getOutputDirectoryDocument());
  commonJavaParameters.setProgramParametersLabel(ExecutionBundle.message("junit.configuration.test.runner.parameters.label"));
}
