{
  final Editor editor=PlatformDataKeys.EDITOR.getData(DataManager.getInstance().getDataContext());
  if (editor == null) {
    return;
  }
  int psiElementOffset=descriptor.getPsiElement().getTextRange().getStartOffset();
  editor.offsetToLogicalPosition(psiElementOffset + textRange.getStartOffset());
  editor.getSelectionModel().setSelection(psiElementOffset + textRange.getStartOffset(),psiElementOffset + textRange.getEndOffset());
  String word=editor.getSelectionModel().getSelectedText();
  if (word == null || StringUtil.isEmpty(word)) {
    return;
  }
  SpellCheckerManager manager=SpellCheckerManager.getInstance(project);
  List<String> variants=manager.getSuggestions(word);
  List<LookupItem<String>> lookupItems=new ArrayList<LookupItem<String>>();
  for (  String variant : variants) {
    final LookupItem<String> lookupItem=new LookupItem<String>(variant,variant);
    lookupItems.add(lookupItem);
  }
  LookupItem[] items=new LookupItem[lookupItems.size()];
  items=lookupItems.toArray(items);
  LookupManager lookupManager=LookupManager.getInstance(project);
  lookupManager.showLookup(editor,items,null);
}
