{
  final Editor editor=PlatformDataKeys.EDITOR.getData(DataManager.getInstance().getDataContext());
  if (editor == null) {
    return;
  }
  int psiElementOffset=descriptor.getPsiElement().getTextRange().getStartOffset();
  editor.offsetToLogicalPosition(psiElementOffset + textRange.getStartOffset());
  editor.getSelectionModel().setSelection(psiElementOffset + textRange.getStartOffset(),psiElementOffset + textRange.getEndOffset());
  String word=editor.getSelectionModel().getSelectedText();
  if (word == null || StringUtil.isEmpty(word)) {
    return;
  }
  List<LookupElement> lookupItems=new ArrayList<LookupElement>();
  for (  String variant : getSuggestions()) {
    lookupItems.add(LookupElementBuilder.create(variant));
  }
  LookupElement[] items=new LookupElement[lookupItems.size()];
  items=lookupItems.toArray(items);
  LookupManager lookupManager=LookupManager.getInstance(project);
  lookupManager.showLookup(editor,items);
}
