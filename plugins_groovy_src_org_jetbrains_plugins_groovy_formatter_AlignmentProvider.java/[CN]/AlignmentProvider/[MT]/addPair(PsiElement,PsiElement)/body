{
  LOG.assertTrue(e1 != e2);
  final Set<PsiElement> set1=myTree.get(e1);
  final Set<PsiElement> set2=myTree.get(e2);
  LOG.assertTrue(set1 == null || set2 == null || !myAlignments.containsKey(set1) || !myAlignments.containsKey(set2));
  if (set1 != null && set2 != null) {
    if (myAlignments.containsKey(set2)) {
      for (Iterator<PsiElement> iterator=set1.iterator(); iterator.hasNext(); ) {
        PsiElement element=iterator.next();
        iterator.remove();
        addInternal(set2,element);
      }
    }
 else {
      set1.addAll(set2);
      for (Iterator<PsiElement> iterator=set2.iterator(); iterator.hasNext(); ) {
        PsiElement element=iterator.next();
        iterator.remove();
        addInternal(set1,element);
      }
    }
  }
 else   if (set1 != null) {
    addInternal(set1,e2);
  }
 else   if (set2 != null) {
    addInternal(set2,e1);
  }
 else {
    final HashSet<PsiElement> set=createHashSet();
    addInternal(set,e1);
    addInternal(set,e2);
  }
}
