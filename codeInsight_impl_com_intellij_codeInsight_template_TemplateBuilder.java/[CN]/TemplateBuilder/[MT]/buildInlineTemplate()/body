{
  Template template=buildTemplate();
  template.setInline(true);
  ApplicationManager.getApplication().assertWriteAccessAllowed();
  PsiFile file=myContainerElement.getContainingFile();
  PsiDocumentManager documentManager=PsiDocumentManager.getInstance(file.getProject());
  Document document=documentManager.getDocument(file);
  LOG.assertTrue(!documentManager.isUncommited(document));
  PsiElement[] elements=myElements.toArray(new PsiElement[myElements.size()]);
  Arrays.sort(elements,new Comparator<PsiElement>(){
    public int compare(    PsiElement e1,    PsiElement e2){
      return e2.getTextRange().getStartOffset() - e1.getTextRange().getStartOffset();
    }
  }
);
  for (  PsiElement element : elements) {
    TextRange range=element.getTextRange();
    document.deleteString(range.getStartOffset(),range.getEndOffset());
  }
  return template;
}
