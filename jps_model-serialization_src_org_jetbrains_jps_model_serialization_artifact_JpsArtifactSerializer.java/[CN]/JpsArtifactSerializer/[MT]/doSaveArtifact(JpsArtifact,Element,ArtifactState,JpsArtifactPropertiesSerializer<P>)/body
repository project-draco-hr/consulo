{
  state.setArtifactType(serializer.getTypeId());
  state.setRootElement(savePackagingElement(artifact.getRootElement()));
  List<ArtifactPropertiesState> propertiesList=state.getPropertiesList();
  serializer.saveProperties((P)artifact.getProperties(),propertiesList);
  for (  JpsModelSerializerExtension serializerExtension : JpsModelSerializerExtension.getExtensions()) {
    for (    JpsArtifactExtensionSerializer<?> extensionSerializer : serializerExtension.getArtifactExtensionSerializers()) {
      JpsElement extension=artifact.getContainer().getChild(extensionSerializer.getRole());
      if (extension != null) {
        ArtifactPropertiesState propertiesState=new ArtifactPropertiesState();
        propertiesState.setId(extensionSerializer.getId());
        propertiesState.setOptions(saveExtension(extensionSerializer,extension));
        propertiesList.add(propertiesState);
      }
    }
  }
  componentElement.addContent(XmlSerializer.serialize(state,SERIALIZATION_FILTERS));
}
