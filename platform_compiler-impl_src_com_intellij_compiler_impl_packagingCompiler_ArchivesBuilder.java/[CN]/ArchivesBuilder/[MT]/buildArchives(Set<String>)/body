{
  myContext.getProgressIndicator().setText(CompilerBundle.message("packaging.compiler.message.building.archives"));
  final ArchivePackageInfo[] sortedArchives=sortArchives();
  if (sortedArchives == null) {
    return false;
  }
  myBuiltArchives=new HashMap<ArchivePackageInfo,File>();
  try {
    for (    ArchivePackageInfo archivePackageInfo : sortedArchives) {
      myContext.getProgressIndicator().checkCanceled();
      buildArchive(archivePackageInfo);
    }
    myContext.getProgressIndicator().setText(CompilerBundle.message("packaging.compiler.message.copying.archives"));
    copyJars(writtenPaths);
  }
  finally {
    deleteTemporaryJars();
  }
  return true;
}
