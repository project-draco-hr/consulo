{
  if (!myProject.isOpen())   return;
  ToolWindowManagerEx mgr=(ToolWindowManagerEx)ToolWindowManager.getInstance(myProject);
  String[] ids=mgr.getToolWindowIds();
  Insets border=new Insets(0,0,0,0);
  UISettings uiSettings=UISettings.getInstance();
  for (  String each : ids) {
    ToolWindow eachWnd=mgr.getToolWindow(each);
    if (!eachWnd.isAvailable())     continue;
    if (eachWnd.isVisible() && eachWnd.getType() == ToolWindowType.DOCKED) {
      ToolWindowAnchor eachAnchor=eachWnd.getAnchor();
      if (eachAnchor == ToolWindowAnchor.TOP) {
        border.top=1;
      }
 else       if (eachAnchor == ToolWindowAnchor.BOTTOM) {
        border.bottom=1;
      }
 else       if (eachAnchor == ToolWindowAnchor.LEFT) {
        border.left=1;
      }
 else       if (eachAnchor == ToolWindowAnchor.RIGHT) {
        border.right=1;
      }
    }
  }
  if (!uiSettings.HIDE_TOOL_STRIPES) {
    if (mgr.getIdsOn(ToolWindowAnchor.TOP).size() > 0) {
      border.top=1;
    }
    if (mgr.getIdsOn(ToolWindowAnchor.BOTTOM).size() > 0) {
      border.bottom=1;
    }
    if (mgr.getIdsOn(ToolWindowAnchor.LEFT).size() > 0) {
      border.left=1;
    }
    if (mgr.getIdsOn(ToolWindowAnchor.RIGHT).size() > 0) {
      border.right=1;
    }
    if (!uiSettings.SHOW_STATUS_BAR && !uiSettings.HIDE_TOOL_STRIPES) {
      border.bottom=1;
    }
  }
  myTabs.getComponent().setBorder(new EmptyBorder(1,0,0,0));
  myTabs.getPresentation().setPaintBorder(border.top,border.left,border.right,border.bottom).setTabSidePaintBorder(5);
}
