{
  boolean indexChanged=false;
  Set<VirtualFile> filesToRefresh=new HashSet<VirtualFile>();
  for (  VFileEvent event : events) {
    VirtualFile file=event.getFile();
    if (file == null || file.isDirectory()) {
      continue;
    }
    String path=file.getPath();
    if (myRepositoryFiles.isIndexFile(path)) {
      indexChanged=true;
    }
 else     if (event instanceof VFileCreateEvent || event instanceof VFileCopyEvent || event instanceof VFileDeleteEvent|| event instanceof VFileMoveEvent) {
      filesToRefresh.add(file);
    }
  }
  if (indexChanged) {
    asyncRefreshStatusAndUnversionedFiles();
  }
 else {
    asyncRefreshFiles(filesToRefresh);
  }
}
