{
  FileType fileType=getFileType(file,editor);
  QuoteHandler quoteHandler=getQuoteHandlerForType(fileType);
  if (quoteHandler == null) {
    FileType fileFileType=file.getFileType();
    if (fileFileType != fileType) {
      quoteHandler=getQuoteHandlerForType(fileFileType);
    }
  }
  if (quoteHandler == null) {
    final Language baseLanguage=file.getViewProvider().getBaseLanguage();
    for (    Map.Entry<Class<? extends Language>,QuoteHandler> entry : ourBaseLanguageQuoteHandlers.entrySet()) {
      if (entry.getKey().isInstance(baseLanguage)) {
        return entry.getValue();
      }
    }
  }
  return quoteHandler;
}
