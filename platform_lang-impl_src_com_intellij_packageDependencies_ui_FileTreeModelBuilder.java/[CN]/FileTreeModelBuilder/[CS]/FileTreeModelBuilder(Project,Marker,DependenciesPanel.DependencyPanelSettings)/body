{
  myProject=project;
  final boolean multiModuleProject=ModuleManager.getInstance(myProject).getModules().length > 1;
  myShowModules=settings.UI_SHOW_MODULES && multiModuleProject;
  myFlattenPackages=settings.UI_FLATTEN_PACKAGES;
  myCompactEmptyMiddlePackages=settings.UI_COMPACT_EMPTY_MIDDLE_PACKAGES;
  myShowFiles=settings.UI_SHOW_FILES;
  myShowModuleGroups=settings.UI_SHOW_MODULE_GROUPS && multiModuleProject;
  myMarker=marker;
  myAddUnmarkedFiles=!settings.UI_FILTER_LEGALS;
  myRoot=new RootNode(myProject);
  myFileIndex=ProjectRootManager.getInstance(project).getFileIndex();
  myPsiManager=PsiManager.getInstance(project);
}
