{
  final int origLength=inputStream.readInt();
  final int length;
  if (origLength > MAX_INPUT_LENGTH) {
    length=MAX_INPUT_LENGTH;
    LOG.info(String.format("Too large input: %d bytes. Reading %s bytes and skipping all other.",origLength,length));
  }
 else {
    length=origLength;
  }
  byte[] data=new byte[length];
  readAsMuchAsAvailable(inputStream,data,length);
  int skipped=inputStream.skipBytes(origLength - length);
  if (skipped > 0) {
    LOG.info(String.format("Skipped %s bytes",skipped));
  }
  return data;
}
