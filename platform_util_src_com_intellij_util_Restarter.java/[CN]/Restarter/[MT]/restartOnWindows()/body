{
  Kernel32 kernel32=(Kernel32)Native.loadLibrary("kernel32",Kernel32.class);
  WString cline=kernel32.GetCommandLineW();
  int pid=kernel32.GetCurrentProcessId();
  try {
    File restarterFile=new File(PathManager.getBinPath(),"restarter.exe");
    File restarterCopy=FileUtil.createTempFile("restarter",".exe");
    FileUtil.copy(restarterFile,restarterCopy);
    String command="\"" + restarterCopy + "\" "+ Integer.toString(pid)+ " "+ cline;
    Runtime.getRuntime().exec(command,null,new File(PathManager.getBinPath()));
  }
 catch (  IOException ex) {
    throw new CannotRestartException(ex);
  }
  try {
    Thread.sleep(500);
  }
 catch (  InterruptedException e1) {
  }
  return true;
}
