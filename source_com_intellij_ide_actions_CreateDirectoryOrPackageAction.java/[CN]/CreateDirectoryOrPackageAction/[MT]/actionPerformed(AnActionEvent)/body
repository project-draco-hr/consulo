{
  DataContext dataContext=e.getDataContext();
  IdeView view=(IdeView)dataContext.getData(DataConstantsEx.IDE_VIEW);
  Project project=(Project)dataContext.getData(DataConstants.PROJECT);
  PsiDirectory directory=PackageUtil.getOrChooseDirectory(view);
  if (directory == null)   return;
  boolean isDirectory=directory.getPackage() == null;
  MyInputValidator validator=new MyInputValidator(project,directory,isDirectory);
  Messages.showInputDialog(project,"Enter new " + (isDirectory ? "directory" : "package") + " name:","New " + (isDirectory ? "Directory" : "Package"),Messages.getQuestionIcon(),"",validator);
  if (validator.myCreatedElement == null)   return;
  view.selectElement(validator.myCreatedElement);
}
