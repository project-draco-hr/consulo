{
  return new Runnable(){
    private final Semaphore mySemaphore=new Semaphore();
    private final Runnable myProcessThread=new Runnable(){
      public void run(){
        try {
          final boolean finished=processHandler.waitFor(1000 * timeout);
          if (!finished) {
            LOG.error("Timeout (" + timeout + " sec) on executing: "+ processHandler.getCommandLine());
            processHandler.destroyProcess();
          }
        }
  finally {
          mySemaphore.up();
        }
      }
    }
;
    public void run(){
      mySemaphore.down();
      ApplicationManager.getApplication().executeOnPooledThread(myProcessThread);
      mySemaphore.waitFor();
    }
  }
;
}
