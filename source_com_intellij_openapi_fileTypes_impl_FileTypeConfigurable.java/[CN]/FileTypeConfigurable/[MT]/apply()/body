{
  for (Iterator iterator=myTempFileTypes.iterator(); iterator.hasNext(); ) {
    FileType fileType=(FileType)iterator.next();
    if (StdFileTypes.UNKNOWN != fileType && !hasAssociatedExtensions(fileType)) {
      throw new ConfigurationException("No default extension specified for type " + fileType.getName());
    }
  }
  Set<UserFileType> modifiedUserTypes=myOriginalToEditedMap.keySet();
  for (Iterator<UserFileType> iterator=modifiedUserTypes.iterator(); iterator.hasNext(); ) {
    UserFileType oldType=iterator.next();
    UserFileType newType=myOriginalToEditedMap.get(oldType);
    oldType.copyFrom(newType);
  }
  myOriginalToEditedMap.clear();
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    public void run(){
      myManager.setExtensionMap(myTempFileTypes,myTempExtension2TypeMap);
    }
  }
);
}
