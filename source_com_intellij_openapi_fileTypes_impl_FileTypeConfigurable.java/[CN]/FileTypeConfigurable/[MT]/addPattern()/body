{
  FileType type=myRecognizedFileType.getSelectedFileType();
  if (type == null)   return;
  String text=Messages.showInputDialog(myPatterns.myAddButton,FileTypesBundle.message("filetype.edit.add.pattern.prompt"),FileTypesBundle.message("filetype.edit.add.pattern.title"),Messages.getQuestionIcon());
  if (text == null || "".equals(text))   return;
  FileType registeredFileType=addNewPattern(type,text);
  if (registeredFileType != null) {
    if (registeredFileType.isReadOnly()) {
      Messages.showMessageDialog(myPatterns.myAddButton,FileTypesBundle.message("filetype.edit.add.pattern.exists.error",registeredFileType.getDescription()),FileTypesBundle.message("filetype.edit.add.pattern.exists.title"),Messages.getErrorIcon());
    }
 else {
      if (0 == Messages.showDialog(myPatterns.myAddButton,FileTypesBundle.message("filetype.edit.add.pattern.exists.message",registeredFileType.getDescription()),FileTypesBundle.message("filetype.edit.add.pattern.exists.title"),new String[]{FileTypesBundle.message("filetype.edit.add.pattern.reassign.button"),CommonBundle.getCancelButtonText()},0,Messages.getQuestionIcon())) {
        myTempPatternsTable.removeAssociation(FileTypeManager.parseFromString(text),registeredFileType);
        addNewPattern(type,text);
      }
    }
  }
}
