def shellquote(s):
    global _quotere
    if (_quotere is None):
        _quotere = re.compile('(\\\\*)("|\\\\$)')
    return ('"%s"' % _quotere.sub('\\1\\1\\\\\\2', s))
