def write(self, s):
    try:
        limit = 16000
        l = len(s)
        start = 0
        self.softspace = 0
        while (start < l):
            end = (start + limit)
            self.fp.write(s[start:end])
            start = end
    except IOError as inst:
        if (inst.errno != 0):
            raise
        self.close()
        raise IOError(errno.EPIPE, 'Broken pipe')
