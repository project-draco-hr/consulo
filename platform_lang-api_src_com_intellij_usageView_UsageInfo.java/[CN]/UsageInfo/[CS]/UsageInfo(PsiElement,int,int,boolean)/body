{
  LOG.assertTrue(element.isValid());
  element=element.getNavigationElement();
  SmartPointerManager smartPointerManager=SmartPointerManager.getInstance(element.getProject());
  mySmartPointer=smartPointerManager.createSmartPsiElementPointer(element);
  if (startOffset == -1 && endOffset == -1) {
    TextRange range=element.getTextRange();
    if (range == null) {
      LOG.error("text range null for " + element + "; "+ element.getClass());
    }
    startOffset=element.getTextOffset() - range.getStartOffset();
    endOffset=range.getEndOffset() - range.getStartOffset();
  }
  this.startOffset=startOffset;
  this.endOffset=endOffset;
  this.isNonCodeUsage=isNonCodeUsage;
  LOG.assertTrue(startOffset >= 0,startOffset);
  LOG.assertTrue(endOffset >= startOffset,endOffset - startOffset);
}
