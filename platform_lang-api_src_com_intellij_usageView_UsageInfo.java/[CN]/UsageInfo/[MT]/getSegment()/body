{
  PsiElement element=getElement();
  if (element == null)   return null;
  TextRange range=element.getTextRange();
  ProperTextRange.assertProperRange(range,element);
  ProperTextRange rangeInElement=getRangeInElement();
  if (rangeInElement == null)   return null;
  return new ProperTextRange(Math.min(range.getEndOffset(),range.getStartOffset() + rangeInElement.getStartOffset()),Math.min(range.getEndOffset(),range.getStartOffset() + rangeInElement.getEndOffset()));
}
