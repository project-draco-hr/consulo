{
  MigrationMap oldMap=getMigrationMap();
  if (oldMap == null) {
    return;
  }
  MigrationMap newMap=oldMap.cloneMap();
  if (editMap(newMap)) {
    if (newMap.getName() == null || newMap.getName().length() == 0 || newMap.getEntryCount() == 0) {
      String warningString;
      if (newMap.getEntryCount() == 0) {
        warningString="Migration map is empty.\n";
      }
 else {
        warningString="Migration map has empty name.\n";
      }
      int result=Messages.showYesNoDialog(warningString + "Do you want to delete it?","Empty Name",Messages.getWarningIcon());
      if (result == 0) {
        myMigrationMapSet.removeMap(oldMap);
        MigrationMap[] maps=myMigrationMapSet.getMaps();
        initMapCombobox();
        if (maps.length > 0) {
          myMapComboBox.setSelectedItem(maps[0]);
        }
        try {
          myMigrationMapSet.saveMaps();
        }
 catch (        IOException e) {
          LOG.error("Cannot save migration maps",e);
        }
      }
      return;
    }
    myMigrationMapSet.replaceMap(oldMap,newMap);
    initMapCombobox();
    myMapComboBox.setSelectedItem(newMap);
    try {
      myMigrationMapSet.saveMaps();
    }
 catch (    IOException e) {
      LOG.error("Cannot save migration maps",e);
    }
  }
}
