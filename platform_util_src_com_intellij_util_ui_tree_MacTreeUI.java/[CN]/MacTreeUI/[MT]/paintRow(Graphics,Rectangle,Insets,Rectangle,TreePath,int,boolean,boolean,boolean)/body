{
  final int containerWidth=tree.getParent() instanceof JViewport ? tree.getParent().getWidth() : tree.getWidth();
  final int xOffset=tree.getParent() instanceof JViewport ? ((JViewport)tree.getParent()).getViewPosition().x : 0;
  if (path != null && myWideSelection) {
    boolean selected=tree.isPathSelected(path);
    Graphics2D rowGraphics=(Graphics2D)g.create();
    rowGraphics.setClip(clipBounds);
    final Object sourceList=tree.getClientProperty(SOURCE_LIST_CLIENT_PROPERTY);
    Color background=tree.getBackground();
    if ((row % 2) == 0 && Boolean.TRUE.equals(tree.getClientProperty(STRIPED_CLIENT_PROPERTY))) {
      background=DECORATED_ROW_BG_COLOR;
    }
    if (sourceList != null && (Boolean)sourceList) {
      if (selected) {
        if (tree.hasFocus()) {
          LIST_FOCUSED_SELECTION_BACKGROUND_PAINTER.paintBorder(tree,rowGraphics,xOffset,bounds.y,containerWidth,bounds.height);
        }
 else {
          LIST_SELECTION_BACKGROUND_PAINTER.paintBorder(tree,rowGraphics,xOffset,bounds.y,containerWidth,bounds.height);
        }
      }
 else       if (myAlwaysPaintRowBackground) {
        rowGraphics.setColor(background);
        rowGraphics.fillRect(xOffset,bounds.y,containerWidth,bounds.height);
      }
    }
 else {
      Color bg=tree.hasFocus() ? UIUtil.getTreeSelectionBackground() : UIUtil.getListUnfocusedSelectionBackground();
      if (!selected) {
        bg=background;
      }
      if (myAlwaysPaintRowBackground || selected) {
        rowGraphics.setColor(bg);
        rowGraphics.fillRect(xOffset,bounds.y,containerWidth,bounds.height - 1);
      }
    }
    if (shouldPaintExpandControl(path,row,isExpanded,hasBeenExpanded,isLeaf)) {
      paintExpandControl(rowGraphics,bounds,insets,bounds,path,row,isExpanded,hasBeenExpanded,isLeaf);
    }
    super.paintRow(rowGraphics,clipBounds,insets,bounds,path,row,isExpanded,hasBeenExpanded,isLeaf);
    rowGraphics.dispose();
  }
 else {
    super.paintRow(g,clipBounds,insets,bounds,path,row,isExpanded,hasBeenExpanded,isLeaf);
  }
}
