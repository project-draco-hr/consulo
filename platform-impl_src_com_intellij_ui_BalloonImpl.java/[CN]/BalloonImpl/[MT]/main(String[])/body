{
  IconLoader.activate();
  final JFrame frame=new JFrame();
  frame.getContentPane().setLayout(new BorderLayout());
  final JPanel content=new JPanel(new BorderLayout());
  frame.getContentPane().add(content,BorderLayout.CENTER);
  final JTree tree=new JTree();
  content.add(tree);
  final Ref<BalloonImpl> balloon=new Ref<BalloonImpl>();
  tree.addMouseListener(new MouseAdapter(){
    @Override public void mousePressed(    final MouseEvent e){
      if (balloon.get() != null && balloon.get().isVisible()) {
        balloon.get().dispose();
      }
 else {
        final JEditorPane pane=new JEditorPane();
        pane.setBorder(new EmptyBorder(6,6,6,6));
        pane.setEditorKit(new HTMLEditorKit());
        pane.setText(UIUtil.toHtml("<html><body><center>Really cool balloon<br>Really fucking <a href=\\\"http://jetbrains.com\\\">big</a></center></body></html"));
        final Dimension size=new JLabel(pane.getText()).getPreferredSize();
        pane.setEditable(false);
        pane.setOpaque(false);
        pane.setBorder(null);
        pane.setPreferredSize(size);
        balloon.set(new BalloonImpl(pane,Color.black,MessageType.ERROR.getPopupBackground(),true,true,true,true,2000,true,null,false));
        balloon.get().setShowPointer(false);
        if (e.isControlDown()) {
          balloon.get().show(new RelativePoint(e),BalloonImpl.ABOVE);
        }
 else         if (e.isAltDown()) {
          balloon.get().show(new RelativePoint(e),BalloonImpl.BELOW);
        }
 else         if (e.isMetaDown()) {
          balloon.get().show(new RelativePoint(e),BalloonImpl.AT_LEFT);
        }
 else {
          balloon.get().show(new RelativePoint(e),BalloonImpl.AT_RIGHT);
        }
      }
    }
  }
);
  frame.setBounds(300,300,300,300);
  frame.show();
}
