{
  final ToolWindow toolWindow=ToolWindowManager.getInstance(myProject).getToolWindow(ToolWindowId.COMMANDER);
  if (toolWindow == null)   return;
  String title=null;
  final PsiElement element=activePanel.getSelectedElement();
  if (element != null) {
    if (!element.isValid())     return;
    if (element instanceof PsiDirectory) {
      final PsiDirectory directory=(PsiDirectory)element;
      title=UsageViewUtil.getPackageName(directory,true);
    }
 else     if (element instanceof PsiFile) {
      final PsiFile file=(PsiFile)element;
      title=file.getVirtualFile().getPresentableUrl();
    }
 else     if (element instanceof PsiClass) {
      final PsiClass psiClass=(PsiClass)element;
      title=psiClass.getQualifiedName();
    }
 else     if (element instanceof PsiMethod) {
      final PsiMethod method=(PsiMethod)element;
      final PsiClass aClass=method.getContainingClass();
      if (aClass != null) {
        title=aClass.getQualifiedName();
      }
 else {
        title=method.toString();
      }
    }
 else     if (element instanceof PsiField) {
      final PsiField field=(PsiField)element;
      final PsiClass aClass=field.getContainingClass();
      if (aClass != null) {
        title=aClass.getQualifiedName();
      }
 else {
        title=field.toString();
      }
    }
 else {
      final PsiFile file=element.getContainingFile();
      if (file != null) {
        title=file.getVirtualFile().getPresentableUrl();
      }
 else {
        title=element.toString();
      }
    }
  }
  toolWindow.setTitle(title);
}
