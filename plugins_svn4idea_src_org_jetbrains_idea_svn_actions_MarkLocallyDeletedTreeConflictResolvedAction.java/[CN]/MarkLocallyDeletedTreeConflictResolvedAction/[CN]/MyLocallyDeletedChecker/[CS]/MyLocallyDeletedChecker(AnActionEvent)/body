{
  final DataContext dc=e.getDataContext();
  myProject=PlatformDataKeys.PROJECT.getData(dc);
  if (myProject == null) {
    myPath=null;
    myEnabled=false;
    return;
  }
  final List<LocallyDeletedChange> missingFiles=e.getData(ChangesListView.LOCALLY_DELETED_CHANGES);
  if (missingFiles == null || missingFiles.size() != 1) {
    final Change[] changes=e.getData(VcsDataKeys.CHANGES);
    if (changes == null || changes.length != 1 || changes[0].getAfterRevision() != null) {
      myPath=null;
      myEnabled=false;
      return;
    }
    myEnabled=changes[0] instanceof ConflictedSvnChange && ((ConflictedSvnChange)changes[0]).getConflictState().isTree();
    if (myEnabled) {
      myPath=changes[0].getBeforeRevision().getFile();
    }
 else {
      myPath=null;
    }
    return;
  }
  final LocallyDeletedChange change=missingFiles.get(0);
  myEnabled=change instanceof SvnLocallyDeletedChange && ((SvnLocallyDeletedChange)change).getConflictState().isTree();
  if (myEnabled) {
    myPath=((SvnLocallyDeletedChange)change).getPath();
  }
 else {
    myPath=null;
  }
}
