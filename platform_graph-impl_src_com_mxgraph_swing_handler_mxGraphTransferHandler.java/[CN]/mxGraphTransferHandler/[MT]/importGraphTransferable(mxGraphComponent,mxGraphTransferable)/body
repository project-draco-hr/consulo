{
  boolean result=false;
  try {
    mxGraph graph=graphComponent.getGraph();
    double scale=graph.getView().getScale();
    mxRectangle bounds=gt.getBounds();
    double dx=0, dy=0;
    if (location != null && bounds != null) {
      mxPoint translate=graph.getView().getTranslate();
      dx=location.getX() - (bounds.getX() + translate.getX()) * scale;
      dy=location.getY() - (bounds.getY() + translate.getY()) * scale;
      dx=graph.snap(dx / scale);
      dy=graph.snap(dy / scale);
    }
 else {
      int gs=graph.getGridSize();
      dx=importCount * gs;
      dy=importCount * gs;
    }
    if (offset != null) {
      dx+=offset.x;
      dy+=offset.y;
    }
    importCells(graphComponent,gt,dx,dy);
    location=null;
    offset=null;
    result=true;
    graphComponent.requestFocus();
  }
 catch (  Exception e) {
    e.printStackTrace();
  }
  return result;
}
