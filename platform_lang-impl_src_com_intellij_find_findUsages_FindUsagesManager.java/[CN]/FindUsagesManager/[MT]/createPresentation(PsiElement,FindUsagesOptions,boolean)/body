{
  UsageViewPresentation presentation=new UsageViewPresentation();
  String scopeString=findUsagesOptions.searchScope != null ? findUsagesOptions.searchScope.getDisplayName() : null;
  presentation.setScopeText(scopeString);
  String usagesString=generateUsagesString(findUsagesOptions);
  presentation.setUsagesString(usagesString);
  String title;
  if (scopeString != null) {
    title=FindBundle.message("find.usages.of.element.in.scope.panel.title",usagesString,UsageViewUtil.getLongName(psiElement),scopeString);
  }
 else {
    title=FindBundle.message("find.usages.of.element.panel.title",usagesString,UsageViewUtil.getLongName(psiElement));
  }
  presentation.setTabText(title);
  presentation.setTabName(FindBundle.message("find.usages.of.element.tab.name",usagesString,UsageViewUtil.getShortName(psiElement)));
  presentation.setTargetsNodeText(StringUtil.capitalize(UsageViewUtil.getType(psiElement)));
  presentation.setOpenInNewTab(toOpenInNewTab);
  return presentation;
}
