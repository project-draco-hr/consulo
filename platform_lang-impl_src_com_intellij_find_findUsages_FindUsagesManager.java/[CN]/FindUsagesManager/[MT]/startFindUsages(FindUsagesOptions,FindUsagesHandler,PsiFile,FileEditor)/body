{
  boolean singleFile=scopeFile != null;
  clearFindingNextUsageInFile();
  LOG.assertTrue(handler.getPsiElement().isValid());
  PsiElement[] primaryElements=handler.getPrimaryElements();
  checkNotNull(primaryElements,handler,"getPrimaryElements()");
  PsiElement[] secondaryElements=handler.getSecondaryElements();
  checkNotNull(secondaryElements,handler,"getSecondaryElements()");
  if (singleFile) {
    findUsagesOptions=findUsagesOptions.clone();
    editor.putUserData(KEY_START_USAGE_AGAIN,null);
    findUsagesInEditor(primaryElements,secondaryElements,handler,scopeFile,FileSearchScope.FROM_START,findUsagesOptions,editor);
  }
 else {
    boolean skipResultsWithOneUsage=FindSettings.getInstance().isSkipResultsWithOneUsage();
    findUsages(primaryElements,secondaryElements,handler,findUsagesOptions,skipResultsWithOneUsage);
  }
}
