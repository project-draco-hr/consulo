{
  try {
    final File configRoot=getConfigRoot(true);
    final File[] files=configRoot.listFiles();
    if (files != null) {
      for (      File file : files) {
        if (file.getName().endsWith(TEMPLATE_EXTENSION_SUFFIX)) {
          FileUtil.delete(file);
        }
      }
    }
    final String lineSeparator=CodeStyleSettingsManager.getSettings(ProjectManagerEx.getInstanceEx().getDefaultProject()).getLineSeparator();
    for (    FileTemplateBase template : getAllTemplates(true)) {
      if (template instanceof BundledFileTemplate && !((BundledFileTemplate)template).isTextModified()) {
        continue;
      }
      saveTemplate(configRoot,template,lineSeparator);
    }
  }
 catch (  IOException e) {
    LOG.error("Unable to save templates",e);
  }
}
