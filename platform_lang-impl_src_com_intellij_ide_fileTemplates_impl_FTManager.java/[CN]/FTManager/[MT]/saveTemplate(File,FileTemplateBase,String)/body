{
  final File templateFile=new File(parentDir,template.getName() + "." + template.getExtension());
  FileOutputStream fileOutputStream;
  try {
    fileOutputStream=new FileOutputStream(templateFile);
  }
 catch (  FileNotFoundException e) {
    FileUtil.delete(templateFile);
    fileOutputStream=new FileOutputStream(templateFile);
  }
  OutputStreamWriter outputStreamWriter;
  try {
    outputStreamWriter=new OutputStreamWriter(fileOutputStream,CONTENT_ENCODING);
  }
 catch (  UnsupportedEncodingException e) {
    Messages.showMessageDialog(IdeBundle.message("error.unable.to.save.file.template.using.encoding",template.getName(),CONTENT_ENCODING),CommonBundle.getErrorTitle(),Messages.getErrorIcon());
    outputStreamWriter=new OutputStreamWriter(fileOutputStream);
  }
  String content=template.getText();
  if (!lineSeparator.equals("\n")) {
    content=StringUtil.convertLineSeparators(content,lineSeparator);
  }
  outputStreamWriter.write(content);
  outputStreamWriter.close();
  fileOutputStream.close();
}
