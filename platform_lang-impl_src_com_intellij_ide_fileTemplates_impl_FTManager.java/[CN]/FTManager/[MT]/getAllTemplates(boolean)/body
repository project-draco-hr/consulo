{
  List<FileTemplateBase> sorted=mySortedTemplates;
  if (sorted == null) {
    sorted=new ArrayList<FileTemplateBase>(myTemplates.values());
    Collections.sort(sorted,new Comparator<FileTemplateBase>(){
      @Override public int compare(      FileTemplateBase t1,      FileTemplateBase t2){
        return t1.getName().compareToIgnoreCase(t2.getName());
      }
    }
);
    mySortedTemplates=sorted;
  }
  if (includeDisabled) {
    return Collections.unmodifiableCollection(sorted);
  }
  final List<FileTemplateBase> list=new ArrayList<FileTemplateBase>(sorted.size());
  for (  FileTemplateBase template : sorted) {
    if (template instanceof BundledFileTemplate && !((BundledFileTemplate)template).isEnabled()) {
      continue;
    }
    list.add(template);
  }
  return list;
}
