{
  ModuleDescriptor newModule=null;
  for (  File root : contentsToExtract) {
    final Set<File> sources=descriptor.removeContentRoot(root);
    if (newModule == null) {
      newModule=new ModuleDescriptor(root,(sources != null) ? sources : new HashSet<File>());
    }
 else {
      if (sources != null && sources.size() > 0) {
        for (        File source : sources) {
          newModule.addSourceRoot(root,source);
        }
      }
 else {
        newModule.addContentRoot(root);
      }
    }
  }
  if (newModule != null) {
    newModule.setName(newModuleName);
    myModules.add(newModule);
  }
 else {
    return null;
  }
  final Map<File,ModuleDescriptor> contentRootToModule=new HashMap<File,ModuleDescriptor>();
  for (  ModuleDescriptor module : myModules) {
    final Set<File> roots=module.getContentRoots();
    for (    File root : roots) {
      contentRootToModule.put(root,module);
    }
    module.clearModuleDependencies();
    module.clearLibraryFiles();
  }
  buildModuleDependencies(contentRootToModule);
  return newModule;
}
