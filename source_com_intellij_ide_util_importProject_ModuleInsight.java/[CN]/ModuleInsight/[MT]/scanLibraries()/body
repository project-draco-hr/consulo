{
  myProgress.setIndeterminate(true);
  myProgress.pushState();
  try {
    try {
      for (      File root : myContentRoots) {
        myProgress.setText("Scanning for libraries " + root.getPath());
        scanRootForLibraries(root);
      }
    }
 catch (    ProcessCanceledException ignored) {
    }
    myProgress.setText("Building initial libraries layout...");
    final List<LibraryDescriptor> libraries=buildInitialLibrariesLayout(myJarToPackagesMap.keySet());
    final Set<String> libNames=new HashSet<String>();
    for (    LibraryDescriptor library : libraries) {
      final Collection<File> libJars=library.getJars();
      final String newName=suggestLibName(libNames,libJars.size() == 1 ? libJars.iterator().next().getName() : library.getName());
      library.setName(newName);
      libNames.add(newName);
    }
    myLibraries=libraries;
  }
  finally {
    myProgress.popState();
  }
}
