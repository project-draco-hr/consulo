{
  myElement=element;
  myManifestFileConfiguration=context.getManifestFile(element,context.getArtifactType());
  myContext=context;
  myMainClassField.addActionListener(new ActionListener(){
    public void actionPerformed(    ActionEvent e){
      final Project project=context.getProject();
      final TreeClassChooserFactory chooserFactory=TreeClassChooserFactory.getInstance(project);
      final GlobalSearchScope searchScope=GlobalSearchScope.allScope(project);
      final PsiClass aClass=JavaPsiFacade.getInstance(project).findClass(myMainClassField.getText(),searchScope);
      final TreeClassChooser chooser=chooserFactory.createWithInnerClassesScopeChooser("Select Main Class",searchScope,new MainClassFilter(),aClass);
      chooser.showDialog();
      final PsiClass selected=chooser.getSelectedClass();
      if (selected != null) {
        myMainClassField.setText(selected.getQualifiedName());
      }
    }
  }
);
  myMainClassField.getTextField().getDocument().addDocumentListener(new DocumentAdapter(){
    @Override protected void textChanged(    DocumentEvent e){
      createManifestFileIfNeeded();
    }
  }
);
  myClasspathField.addActionListener(new ActionListener(){
    public void actionPerformed(    ActionEvent e){
      Messages.showTextAreaDialog(myClasspathField.getTextField(),"Edit Classpath","classpath-attribute-editor");
    }
  }
);
  myManifestFilePathField.addBrowseFolderListener("Specify Path to MANIFEST.MF file","",context.getProject(),new FileChooserDescriptor(true,false,false,false,false,false){
    @Override public boolean isFileVisible(    VirtualFile file,    boolean showHiddenFiles){
      return super.isFileVisible(file,showHiddenFiles) && file.isDirectory() || file.getName().equalsIgnoreCase(ManifestFileUtil.MANIFEST_FILE_NAME);
    }
  }
);
  myClasspathField.getTextField().getDocument().addDocumentListener(new DocumentAdapter(){
    @Override protected void textChanged(    DocumentEvent e){
      createManifestFileIfNeeded();
      myContext.queueValidation();
    }
  }
);
}
