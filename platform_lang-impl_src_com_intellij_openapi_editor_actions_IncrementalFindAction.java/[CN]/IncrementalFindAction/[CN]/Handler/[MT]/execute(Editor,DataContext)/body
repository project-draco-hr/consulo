{
  final Project project=PlatformDataKeys.PROJECT.getData(DataManager.getInstance().getDataContext(editor.getComponent()));
  if (!editor.isOneLineMode()) {
    final JComponent headerComponent=editor.getHeaderComponent();
    if (headerComponent instanceof EditorSearchComponent) {
      EditorSearchComponent editorSearchComponent=(EditorSearchComponent)headerComponent;
      if (!myReplace) {
        headerComponent.requestFocus();
      }
      if (myReplace != editorSearchComponent.getFindModel().isReplaceState()) {
        editorSearchComponent.getFindModel().setReplaceState(myReplace);
      }
      configureFindModel(editor,editorSearchComponent.getFindModel());
    }
 else {
      FindManager findManager=FindManager.getInstance(project);
      FindModel model;
      if (myReplace) {
        model=findManager.createReplaceInFileModel();
      }
 else {
        model=new FindModel();
        model.copyFrom(findManager.getFindInFileModel());
      }
      configureFindModel(editor,model);
      final EditorSearchComponent header=new EditorSearchComponent(editor,project,model);
      editor.setHeaderComponent(header);
      header.requestFocus();
    }
  }
}
