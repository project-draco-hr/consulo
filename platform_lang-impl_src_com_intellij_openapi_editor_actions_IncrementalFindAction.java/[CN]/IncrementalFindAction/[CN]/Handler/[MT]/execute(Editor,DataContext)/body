{
  final Project project=PlatformDataKeys.PROJECT.getData(DataManager.getInstance().getDataContext(editor.getComponent()));
  if (!editor.isOneLineMode()) {
    final JComponent headerComponent=editor.getHeaderComponent();
    if (headerComponent instanceof EditorSearchComponent) {
      if (myReplace) {
        ((EditorSearchComponent)headerComponent).replaceCurrent();
      }
 else {
        ((EditorSearchComponent)headerComponent).setInitialText(editor.getSelectionModel().getSelectedText());
        headerComponent.requestFocus();
      }
    }
 else {
      final EditorSearchComponent header=new EditorSearchComponent(editor,project,myReplace);
      editor.setHeaderComponent(header);
      header.requestFocus();
    }
  }
}
