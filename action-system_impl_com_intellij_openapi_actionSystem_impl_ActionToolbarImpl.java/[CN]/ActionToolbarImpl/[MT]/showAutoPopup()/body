{
  if (isPopupShowing())   return;
  final Point location;
  final ActionGroup group;
  if (myOrientation == SwingConstants.HORIZONTAL) {
    location=getLocationOnScreen();
    group=myActionGroup;
  }
 else {
    final DefaultActionGroup outside=new DefaultActionGroup();
    for (int i=myFirstOusideIndex; i < myVisibleActions.size(); i++) {
      outside.add(myVisibleActions.get(i));
    }
    group=outside;
    location=myAutoPopupRec.getLocation();
    SwingUtilities.convertPointToScreen(location,this);
    location.x+=myAutoPopupRec.width;
  }
  myPopupToolbar=new PopupToolbar(myPlace,group,true,myDataManager,myActionManager,myKeymapManager){
    protected void onOtherActionPerformed(){
      hidePopup();
    }
  }
;
  myPopupToolbar.setLayoutPolicy(ActionToolbar.NOWRAP_LAYOUT_POLICY);
  final ComponentPopupBuilder builder=JBPopupFactory.getInstance().createComponentPopupBuilder(myPopupToolbar,null);
  builder.setResizable(false).setRequestFocus(false).setTitle(null).setCancelOnClickOutside(true).setCancelCallback(new Computable<Boolean>(){
    public Boolean compute(){
      return myActionManager.isActionPopupStackEmpty();
    }
  }
).setCancelOnMouseOutCallback(new Computable<Boolean>(){
    public Boolean compute(){
      return myActionManager.isActionPopupStackEmpty();
    }
  }
);
  myPopup=builder.createPopup();
  Disposer.register(myPopup,myPopupToolbar);
  myPopup.showInScreenCoordinates(this,location);
}
