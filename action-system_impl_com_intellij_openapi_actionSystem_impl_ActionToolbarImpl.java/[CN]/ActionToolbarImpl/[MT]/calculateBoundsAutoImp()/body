{
  if (calculateByDefaultIfNotLaidOutYet())   return;
  final int componentCount=getComponentCount();
  LOG.assertTrue(componentCount <= myComponentBounds.size());
  myAutoPopupRec=null;
  final int maxWidth=getMaxButtonWidth();
  final int maxHeight=getMaxButtonHeight();
  final Dimension size=getSize();
  int autoButtonSize=myAutoPopupIcon.getIconWidth();
  boolean full=false;
  if (myAdjustTheSameSize) {
  }
 else {
    if (myOrientation == SwingConstants.HORIZONTAL) {
      int eachX=0, eachY=0;
      for (int i=0; i < componentCount; i++) {
        final Rectangle eachBound=new Rectangle(getComponent(i).getPreferredSize());
        if (!full) {
          if (eachX + eachBound.width + autoButtonSize / 2 < size.width) {
            eachBound.x=eachX;
            eachBound.y=eachY;
            eachX+=eachBound.width;
          }
 else {
            full=true;
          }
        }
        if (full) {
          if (myAutoPopupRec == null) {
            myAutoPopupRec=new Rectangle(eachX,0,size.width - eachX - 1,size.height - 1);
          }
          eachBound.x=-1;
          eachBound.y=-1;
          eachBound.width=0;
          eachBound.height=0;
        }
        myComponentBounds.get(i).setBounds(eachBound);
      }
    }
  }
}
