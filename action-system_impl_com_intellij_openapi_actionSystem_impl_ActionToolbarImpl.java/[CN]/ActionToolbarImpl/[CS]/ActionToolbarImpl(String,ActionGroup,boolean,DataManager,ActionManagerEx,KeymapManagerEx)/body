{
  super(null);
  myActionManager=actionManager;
  myComponentBounds=new ArrayList<Rectangle>();
  myKeymapManager=keymapManager;
  setMinimumButtonSize(DEFAULT_MINIMUM_BUTTON_SIZE);
  setLayoutPolicy(AUTO_LAYOUT_POLICY);
  setBorder(BorderFactory.createEmptyBorder(2,2,2,2));
  myPlace=place;
  myActionGroup=actionGroup;
  myPresentationFactory=new PresentationFactory();
  myKeymapManagerListener=new MyKeymapManagerListener();
  myTimerListener=new MyTimerListener();
  myVisibleActions=new ArrayList<AnAction>();
  myNewVisibleActions=new ArrayList<AnAction>();
  myDataManager=dataManager;
  setLayout(new BorderLayout());
  setOrientation(horizontal ? SwingConstants.HORIZONTAL : SwingConstants.VERTICAL);
  updateActionsImmediately();
  keymapManager.addKeymapManagerListener(new WeakKeymapManagerListener(keymapManager,myKeymapManagerListener));
  actionManager.addTimerListener(500,new WeakTimerListener(actionManager,myTimerListener));
  enableEvents(MouseEvent.MOUSE_MOTION_EVENT_MASK | MouseEvent.MOUSE_EVENT_MASK);
}
