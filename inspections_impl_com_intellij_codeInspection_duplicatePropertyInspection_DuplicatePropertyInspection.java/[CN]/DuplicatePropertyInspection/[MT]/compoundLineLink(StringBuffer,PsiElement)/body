{
  final PsiFile file=psiElement.getContainingFile();
  if (file != null) {
    final VirtualFile vFile=file.getVirtualFile();
    if (vFile != null) {
      Document doc=FileDocumentManager.getInstance().getDocument(vFile);
      final int lineNumber=doc.getLineNumber(psiElement.getTextOffset()) + 1;
      lineAnchor.append(" ").append(InspectionsBundle.message("inspection.export.results.at.line")).append(" ");
      lineAnchor.append("<a HREF=\"");
      try {
        int offset=doc.getLineStartOffset(lineNumber - 1);
        offset=CharArrayUtil.shiftForward(doc.getCharsSequence(),offset," \t");
        lineAnchor.append(new URL(vFile.getUrl() + "#" + offset));
      }
 catch (      MalformedURLException e) {
        LOG.error(e);
      }
      lineAnchor.append("\">");
      lineAnchor.append(Integer.toString(lineNumber));
      lineAnchor.append("</a>");
    }
  }
}
