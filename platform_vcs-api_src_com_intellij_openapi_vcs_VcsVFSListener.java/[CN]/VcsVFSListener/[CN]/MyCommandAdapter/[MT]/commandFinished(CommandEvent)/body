{
  if (myProject != event.getProject())   return;
  myCommandLevel--;
  if (myCommandLevel == 0) {
    if (!myAddedFiles.isEmpty() || !myDeletedFiles.isEmpty() || !myDeletedWithoutConfirmFiles.isEmpty()|| !myMovedFiles.isEmpty()) {
      myCommandLevel++;
      try {
        FileDocumentManager.getInstance().saveAllDocuments();
      }
  finally {
        myCommandLevel--;
      }
      checkMovedAddedSourceBack();
      if (!myAddedFiles.isEmpty()) {
        executeAdd();
      }
      if (!myDeletedFiles.isEmpty() || !myDeletedWithoutConfirmFiles.isEmpty()) {
        executeDelete();
      }
      if (!myMovedFiles.isEmpty()) {
        executeMoveRename();
      }
    }
  }
}
