{
  myModule=context.mock(Module.class);
  myPathMacros=context.mock(PathMacrosImpl.class);
  myProject=context.mock(ProjectEx.class);
  final VirtualFile projectFile=context.mock(VirtualFile.class,"projectFile");
  final VirtualFile projectParentFile=context.mock(VirtualFile.class,"projectParentFile");
  final VirtualFile moduleFile=context.mock(VirtualFile.class,"moduleFile");
  final VirtualFile moduleParentFile=context.mock(VirtualFile.class,"moduleParentFile");
  context.checking(new Expectations(){
{
      allowing(myModule).isDisposed();
      will(returnValue(false));
      allowing(myProject).isDisposed();
      will(returnValue(false));
      allowing(projectFile).getPath();
      will(returnValue(projectPath));
      allowing(projectFile).getParent();
      will(returnValue(projectParentFile));
      allowing(projectParentFile).getPath();
      will(returnValue(StringUtil.getPackageName(projectPath,'/')));
      final String moduleFilePath=projectPath + "/module/module.iml";
      allowing(moduleFile).getPath();
      will(returnValue(moduleFilePath));
      allowing(moduleFile).getParent();
      will(returnValue(moduleParentFile));
      allowing(projectParentFile).getPath();
      will(returnValue(StringUtil.getPackageName(moduleFilePath,'/')));
      allowing(myApplication).getComponent(with(equal(PathMacros.class)));
      will(returnValue(myPathMacros));
      allowing(myPathMacros).addMacroReplacements(with(any(ReplacePathToMacroMap.class)));
      allowing(myProject).getBaseDir();
      will(returnValue(projectFile));
      allowing(myModule).getModuleFilePath();
      will(returnValue(moduleFilePath));
      allowing(myModule).getProject();
      will(returnValue(myProject));
    }
  }
);
}
