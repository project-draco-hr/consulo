{
  myModule=context.mock(Module.class);
  myPathMacros=context.mock(PathMacrosImpl.class);
  myProject=context.mock(ProjectEx.class);
  final VirtualFile projectFile=context.mock(VirtualFile.class,"projectFile");
  context.checking(new Expectations(){
{
      allowing(myModule).isDisposed();
      will(returnValue(false));
      allowing(myProject).isDisposed();
      will(returnValue(false));
      allowing(projectFile).getPath();
      will(returnValue(projectPath));
      final String moduleFilePath=projectPath + "/module/module.iml";
      allowing(myApplication).getComponent(with(equal(PathMacros.class)));
      will(returnValue(myPathMacros));
      allowing(myPathMacros).addMacroReplacements(with(any(ReplacePathToMacroMap.class)));
      allowing(myProject).getBaseDir();
      will(returnValue(projectFile));
      allowing(myModule).getModuleDir();
      will(returnValue(moduleFilePath));
      allowing(myModule).getProject();
      will(returnValue(myProject));
    }
  }
);
}
