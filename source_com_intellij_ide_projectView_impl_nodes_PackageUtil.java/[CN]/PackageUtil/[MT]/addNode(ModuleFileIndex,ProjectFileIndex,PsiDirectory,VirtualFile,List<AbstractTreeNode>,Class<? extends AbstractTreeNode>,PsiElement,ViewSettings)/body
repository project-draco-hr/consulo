{
  if (vFile == null) {
    return;
  }
  if (moduleFileIndex != null && !moduleFileIndex.isInContent(vFile)) {
    return;
  }
  final boolean childInLibraryClasses=projectFileIndex.isInLibraryClasses(vFile);
  if (!projectFileIndex.isInSourceContent(vFile)) {
    if (childInLibraryClasses) {
      final VirtualFile psiDirVFile=psiDir.getVirtualFile();
      final boolean parentInLibraryContent=projectFileIndex.isInLibraryClasses(psiDirVFile) || projectFileIndex.isInLibrarySource(psiDirVFile);
      if (!parentInLibraryContent) {
        return;
      }
    }
  }
  if (childInLibraryClasses && !projectFileIndex.isInContent(vFile) && projectFileIndex.isJavaSourceFile(vFile)) {
    return;
  }
  try {
    container.add(ProjectViewNode.createTreeNode(nodeClass,element.getManager().getProject(),element,settings));
  }
 catch (  Exception e) {
    LOG.error(e);
  }
}
