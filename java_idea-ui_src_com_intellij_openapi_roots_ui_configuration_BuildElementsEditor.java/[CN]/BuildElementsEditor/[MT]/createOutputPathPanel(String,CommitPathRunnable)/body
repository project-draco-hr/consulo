{
  final JTextField textField=new JTextField();
  final FileChooserDescriptor outputPathsChooserDescriptor=FileChooserDescriptorFactory.createSingleFolderDescriptor();
  outputPathsChooserDescriptor.setHideIgnored(false);
  InsertPathAction.addTo(textField,outputPathsChooserDescriptor);
  FileChooserFactory.getInstance().installFileCompletion(textField,outputPathsChooserDescriptor,true,null);
  final Runnable commitRunnable=new Runnable(){
    public void run(){
      if (!getModel().isWritable()) {
        return;
      }
      final String path=textField.getText().trim();
      if (path.length() == 0) {
        commitPathRunnable.saveUrl(null);
      }
 else {
        String canonicalPath;
        try {
          canonicalPath=FileUtil.resolveShortWindowsName(path);
        }
 catch (        IOException e) {
          canonicalPath=path;
        }
        commitPathRunnable.saveUrl(VfsUtil.pathToUrl(FileUtil.toSystemIndependentName(canonicalPath)));
      }
    }
  }
;
  textField.getDocument().addDocumentListener(new DocumentAdapter(){
    protected void textChanged(    DocumentEvent e){
      commitRunnable.run();
    }
  }
);
  return new CommitableFieldPanel(textField,null,null,new BrowseFilesListener(textField,title,"",outputPathsChooserDescriptor){
    public void actionPerformed(    ActionEvent e){
      super.actionPerformed(e);
      commitRunnable.run();
    }
  }
,null,commitRunnable);
}
