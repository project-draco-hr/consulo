{
  if (LOG.isDebugEnabled()) {
    LOG.debug("offset=" + offset);
    LOG.debug("textlength=" + text.length());
    LOG.debug(model.toString());
  }
  final char[] textArray=CharArrayUtil.fromSequenceWithoutCopying(text);
  while (true) {
    FindResult result=doFindString(text,textArray,offset,model,file);
    if (!model.isWholeWordsOnly()) {
      return result;
    }
    if (!result.isStringFound()) {
      return result;
    }
    if (isWholeWord(text,result.getStartOffset(),result.getEndOffset())) {
      return result;
    }
    offset=model.isForward() ? result.getStartOffset() + 1 : result.getEndOffset() - 1;
  }
}
