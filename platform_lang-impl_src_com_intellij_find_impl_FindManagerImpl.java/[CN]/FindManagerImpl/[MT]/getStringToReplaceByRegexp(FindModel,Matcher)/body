{
  StringBuffer replaced=new StringBuffer();
  if (matcher == null)   return null;
  try {
    String toReplace=StringUtil.unescapeStringCharacters(model.getStringToReplace());
    matcher.appendReplacement(replaced,toReplace);
    return replaced.substring(matcher.start());
  }
 catch (  Exception e) {
    throw createMalformedReplacementException(model,e);
  }
}
