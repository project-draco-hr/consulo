{
  final JPanel mainPanel=new JPanel(new GridBagLayout());
  mainPanel.add(new JLabel("Label:"),new GridBagConstraints(0,GridBagConstraints.RELATIVE,1,1,0.0,0.0,GridBagConstraints.WEST,GridBagConstraints.NONE,new Insets(0,0,0,0),0,0));
  mainPanel.add(myTextMarkupField,new GridBagConstraints(1,GridBagConstraints.RELATIVE,2,1,1.0,0.0,GridBagConstraints.NORTHWEST,GridBagConstraints.HORIZONTAL,new Insets(0,0,0,0),0,0));
  final JPanel samplePanel=new JPanel(new BorderLayout());
  samplePanel.add(myColorSample,BorderLayout.CENTER);
  samplePanel.setBorder(BorderFactory.createEtchedBorder());
  final FixedSizeButton chooseColorButton=new FixedSizeButton(samplePanel);
  double weighty=mySuggestAdditionalMarkup ? 0.0 : 1.0;
  mainPanel.add(new JLabel("Preview: "),new GridBagConstraints(0,GridBagConstraints.RELATIVE,1,1,0.0,weighty,GridBagConstraints.WEST,GridBagConstraints.NONE,new Insets(5,0,0,0),0,0));
  mainPanel.add(samplePanel,new GridBagConstraints(1,GridBagConstraints.RELATIVE,1,1,1.0,weighty,GridBagConstraints.NORTHWEST,GridBagConstraints.HORIZONTAL,new Insets(5,0,0,0),0,0));
  mainPanel.add(chooseColorButton,new GridBagConstraints(2,GridBagConstraints.RELATIVE,1,1,0.0,weighty,GridBagConstraints.NORTHWEST,GridBagConstraints.NONE,new Insets(5,0,0,0),0,0));
  if (mySuggestAdditionalMarkup) {
    final JPanel panel=new JPanel(new BorderLayout());
    panel.add(new MultiLineLabel("If the value is referenced by a constant field of an abstract class,\nIDEA could additionally mark all values referenced from this class with the names of referencing fields."),BorderLayout.CENTER);
    panel.add(myCbMarkAdditionalFields,BorderLayout.SOUTH);
    myCbMarkAdditionalFields.setMnemonic('M');
    mainPanel.add(panel,new GridBagConstraints(0,GridBagConstraints.RELATIVE,3,1,0.0,1.0,GridBagConstraints.WEST,GridBagConstraints.HORIZONTAL,new Insets(10,0,0,0),0,0));
  }
  myTextMarkupField.getDocument().addDocumentListener(new DocumentAdapter(){
    protected void textChanged(    final DocumentEvent e){
      updateLabelSample(UPDATE_DELAY);
    }
  }
);
  chooseColorButton.addActionListener(new ActionListener(){
    public void actionPerformed(    final ActionEvent e){
      final Color color=ColorChooser.chooseColor(myColorSample,"Choose label color",null);
      myAttributes=createAttributes(color);
      updateLabelSample(UPDATE_DELAY);
    }
  }
);
  return mainPanel;
}
