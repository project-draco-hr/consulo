{
  final PsiStatement body=getBody(foreachStatement);
  if (!(body instanceof PsiExpressionStatement)) {
    return null;
  }
  final PsiExpressionStatement expressionStatement=(PsiExpressionStatement)body;
  final PsiMethodCallExpression methodCallExpression=(PsiMethodCallExpression)expressionStatement.getExpression();
  final PsiReferenceExpression methodExpression=methodCallExpression.getMethodExpression();
  final PsiElement collection=methodExpression.getQualifier();
  if (collection == null) {
    return null;
  }
  final String collectionText=collection.getText();
  final PsiExpression iteratedValue=foreachStatement.getIteratedValue();
  if (iteratedValue == null) {
    return null;
  }
  final String arrayText=iteratedValue.getText();
  @NonNls final StringBuilder buffer=new StringBuilder();
  if (PsiUtil.isLanguageLevel5OrHigher(foreachStatement)) {
    buffer.append("java.util.Collections.addAll(");
    buffer.append(collectionText);
    buffer.append(',');
    buffer.append(arrayText);
    buffer.append(");");
  }
 else {
    buffer.append(collectionText);
    buffer.append(".addAll(java.util.Arrays.asList(");
    buffer.append(arrayText);
    buffer.append("));");
  }
  return buffer.toString();
}
