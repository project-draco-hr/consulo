{
  mxPoint fromConstraint=null;
  mxPoint toConstraint=null;
  Object source=cellsMap.get(edge.getEdgeSource());
  Object target=cellsMap.get(edge.getEdgeTarget());
  String sourcePort=edge.getEdgeSourcePort();
  String targetPort=edge.getEdgeTargetPort();
  fromConstraint=portValue(sourcePort);
  toConstraint=portValue(targetPort);
  mxGraphMlData data=dataEdgeKey(edge);
  String style="";
  String label="";
  if (data != null) {
    mxGraphMlShapeEdge shEdge=data.getDataShapeEdge();
    style=shEdge.getStyle();
    label=shEdge.getText();
  }
 else {
    style=edge.getEdgeStyle();
  }
  mxCell e=(mxCell)graph.insertEdge(parent,null,label,source,target,style);
  graph.setConnectionConstraint(e,source,true,new mxConnectionConstraint(fromConstraint,false));
  graph.setConnectionConstraint(e,target,false,new mxConnectionConstraint(toConstraint,false));
  return e;
}
