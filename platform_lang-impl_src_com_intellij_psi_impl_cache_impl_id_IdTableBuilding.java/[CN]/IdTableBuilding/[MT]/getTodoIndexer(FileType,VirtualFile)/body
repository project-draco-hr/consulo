{
  final DataIndexer<TodoIndexEntry,Integer,FileContent> indexer=ourTodoIndexers.get(fileType);
  if (indexer != null) {
    return indexer;
  }
  final DataIndexer<TodoIndexEntry,Integer,FileContent> extIndexer=TodoIndexers.INSTANCE.forFileType(fileType);
  if (extIndexer != null) {
    return extIndexer;
  }
  if (fileType instanceof LanguageFileType) {
    final Language lang=((LanguageFileType)fileType).getLanguage();
    final ParserDefinition parserDef=LanguageParserDefinitions.INSTANCE.forLanguage(lang);
    final TokenSet commentTokens=parserDef != null ? parserDef.getCommentTokens() : null;
    if (commentTokens != null) {
      return new TokenSetTodoIndexer(commentTokens,virtualFile);
    }
  }
  if (fileType instanceof AbstractFileType) {
    return new TokenSetTodoIndexer(ABSTRACT_FILE_COMMENT_TOKENS,virtualFile);
  }
  return null;
}
