{
  ArrayList<ModuleWizardStep> result=new ArrayList<ModuleWizardStep>();
  ArrayList<AddSupportContext> contexts=new ArrayList<AddSupportContext>();
  final AddSupportStepsProvider[] providers=ProjectWizardStepFactory.getInstance().getAddSupportProviders(moduleBuilder.getModuleType());
  if (providers.length > 0) {
    for (    AddSupportStepsProvider provider : providers) {
      final AddSupportStep[] wizardSteps=provider.createAddSupportSteps(wizardContext,moduleBuilder,modulesProvider);
      result.addAll(Arrays.asList(wizardSteps));
      contexts.add(wizardSteps[0].myContext);
    }
    final AddSupportContext[] supportContexts=contexts.toArray(new AddSupportContext[contexts.size()]);
    final AddSupportFeaturesStep featuresStep=new AddSupportFeaturesStep(providers,supportContexts,icon);
    result.add(0,featuresStep);
  }
  return result.toArray(ModuleWizardStep.EMPTY_ARRAY);
}
