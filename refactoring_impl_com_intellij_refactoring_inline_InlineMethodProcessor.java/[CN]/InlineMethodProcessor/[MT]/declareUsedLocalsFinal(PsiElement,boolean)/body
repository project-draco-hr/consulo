{
  if (expr instanceof PsiReferenceExpression) {
    PsiElement refElement=((PsiReferenceExpression)expr).resolve();
    if (refElement instanceof PsiLocalVariable || refElement instanceof PsiParameter) {
      if (strictlyFinal || RefactoringUtil.canBeDeclaredFinal((PsiVariable)refElement)) {
        PsiUtil.setModifierProperty(((PsiVariable)refElement),PsiModifier.FINAL,true);
      }
    }
  }
  PsiElement[] children=expr.getChildren();
  for (  PsiElement child : children) {
    declareUsedLocalsFinal(child,strictlyFinal);
  }
}
