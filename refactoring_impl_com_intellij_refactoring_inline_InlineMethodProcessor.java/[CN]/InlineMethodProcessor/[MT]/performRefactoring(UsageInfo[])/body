{
  int col=-1;
  int line=-1;
  if (myEditor != null) {
    col=myEditor.getCaretModel().getLogicalPosition().column;
    line=myEditor.getCaretModel().getLogicalPosition().line;
    LogicalPosition pos=new LogicalPosition(0,0);
    myEditor.getCaretModel().moveToLogicalPosition(pos);
  }
  final LocalHistoryAction lvcsAction=LvcsIntegration.checkinFilesBeforeRefactoring(myProject,getCommandName());
  try {
    doRefactoring(usages);
  }
  finally {
    LvcsIntegration.checkinFilesAfterRefactoring(myProject,lvcsAction);
  }
  if (myEditor != null) {
    LogicalPosition pos=new LogicalPosition(line,col);
    myEditor.getCaretModel().moveToLogicalPosition(pos);
  }
}
