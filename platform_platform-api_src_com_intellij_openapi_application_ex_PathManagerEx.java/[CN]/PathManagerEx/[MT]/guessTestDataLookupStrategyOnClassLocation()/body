{
  if (isLocatedInCommunity())   return TestDataLookupStrategy.COMMUNITY;
  Class<?> testClass=null;
  Class<?> abstractTestClass=null;
  StackTraceElement[] stackTrace=new Exception().getStackTrace();
  for (  StackTraceElement stackTraceElement : stackTrace) {
    String className=stackTraceElement.getClassName();
    Class<?> clazz=loadClass(className);
    if (clazz == null || TestCase.class == clazz || !isJUnitClass(clazz)) {
      continue;
    }
    if (determineLookupStrategy(clazz) == TestDataLookupStrategy.ULTIMATE)     return TestDataLookupStrategy.ULTIMATE;
    if ((clazz.getModifiers() & Modifier.ABSTRACT) == 0) {
      testClass=clazz;
    }
 else {
      abstractTestClass=clazz;
    }
  }
  Class<?> classToUse=testClass == null ? abstractTestClass : testClass;
  return classToUse == null ? null : determineLookupStrategy(classToUse);
}
