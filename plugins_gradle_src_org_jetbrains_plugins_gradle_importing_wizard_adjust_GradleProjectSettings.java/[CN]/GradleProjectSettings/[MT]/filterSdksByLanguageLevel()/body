{
  Object selectedItem=mySdkModel.getSelectedItem();
  myRegisteredSdksButton.setEnabled(true);
  mySdkModel.removeAllElements();
  LanguageLevel languageLevel=myProject.getLanguageLevel();
  boolean restoreSelection=false;
  if (myUseOnlyRegisteredSdks) {
    JavaSdk javaSdk=JavaSdk.getInstance();
    List<Sdk> javaSdks=ProjectJdkTable.getInstance().getSdksOfType(javaSdk);
    for (    Sdk sdk : javaSdks) {
      JavaSdkVersion version=javaSdk.getVersion(sdk);
      if (version == null || !version.getMaxLanguageLevel().isAtLeast(languageLevel)) {
        continue;
      }
      mySdkModel.addElement(sdk.getName());
      if (sdk.getName().equals(selectedItem)) {
        restoreSelection=true;
      }
    }
    if (mySdkModel.getSize() <= 0) {
      myAllSdksButton.setSelected(true);
      myRegisteredSdksButton.setEnabled(false);
      return;
    }
  }
 else {
    for (    JavaSdkVersion version : JavaSdkVersion.values()) {
      if (!version.getMaxLanguageLevel().isAtLeast(languageLevel)) {
        continue;
      }
      mySdkModel.addElement(version.getDescription());
      if (version.getDescription().equals(selectedItem)) {
        restoreSelection=true;
      }
    }
  }
  if (restoreSelection) {
    mySdkModel.setSelectedItem(selectedItem);
  }
}
