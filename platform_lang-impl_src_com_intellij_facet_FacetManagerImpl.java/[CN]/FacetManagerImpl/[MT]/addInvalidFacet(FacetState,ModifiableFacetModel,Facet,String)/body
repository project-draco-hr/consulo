{
  final String typeId=StringUtil.notNullize(state.getFacetType());
  final InvalidFacetType type=InvalidFacetManager.getInstance(myModule.getProject()).getOrCreateType(typeId);
  final InvalidFacetConfiguration configuration=new InvalidFacetConfiguration(state,errorMessage);
  final InvalidFacet facet=createFacet(type,StringUtil.notNullize(state.getName()),configuration,underlyingFacet);
  model.addFacet(facet);
  FacetLoadingErrorDescription description=new FacetLoadingErrorDescription(facet);
  ProjectLoadingErrorsNotifier.getInstance(myModule.getProject()).registerError(description);
}
