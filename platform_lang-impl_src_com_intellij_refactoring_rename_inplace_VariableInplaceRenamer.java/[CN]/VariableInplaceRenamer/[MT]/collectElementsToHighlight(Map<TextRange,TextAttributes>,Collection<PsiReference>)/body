{
  EditorColorsManager colorsManager=EditorColorsManager.getInstance();
  if (myElementToRename instanceof PsiNameIdentifierOwner) {
    PsiElement nameId=((PsiNameIdentifierOwner)myElementToRename).getNameIdentifier();
    LOG.assertTrue(nameId != null);
    rangesToHighlight.put(nameId.getTextRange().shiftRight(PsiUtilBase.findInjectedElementOffsetInRealDocument(nameId)),colorsManager.getGlobalScheme().getAttributes(EditorColors.WRITE_SEARCH_RESULT_ATTRIBUTES));
  }
  for (  PsiReference ref : refs) {
    final PsiElement element=ref.getElement();
    TextRange range=ref.getRangeInElement().shiftRight(element.getTextRange().getStartOffset() + PsiUtilBase.findInjectedElementOffsetInRealDocument(element));
    ReadWriteAccessDetector writeAccessDetector=ReadWriteAccessDetector.findDetector(element);
    boolean isForWrite=writeAccessDetector != null && ReadWriteAccessDetector.Access.Write == writeAccessDetector.getExpressionAccess(element);
    TextAttributes attributes=colorsManager.getGlobalScheme().getAttributes(isForWrite ? EditorColors.WRITE_SEARCH_RESULT_ATTRIBUTES : EditorColors.SEARCH_RESULT_ATTRIBUTES);
    rangesToHighlight.put(range,attributes);
  }
}
