{
  if (myCaretRangeMarker.isValid()) {
    if (myCaretRangeMarker.getStartOffset() <= offset && myCaretRangeMarker.getEndOffset() >= offset) {
      return offset;
    }
    return myCaretRangeMarker.getEndOffset();
  }
  return offset;
}
