{
  final String fileName=name != null ? (name + "." + file.getViewProvider().getVirtualFile().getExtension()) : file.getName();
  if (relativePath != null) {
    return buildRelativeDir(directory,relativePath).findOrCreateTargetDirectory().copyFileFrom(fileName,file);
  }
  return directory.copyFileFrom(fileName,file);
}
