{
  final VirtualFile f=root.createChildData(null,"file.java");
  f.setBinaryContent("before".getBytes());
  ContentChangesListener l=new ContentChangesListener(f);
  addFileListenerDuring(l,new RunnableAdapter(){
    @Override public void doRun() throws IOException {
      f.setBinaryContent("after".getBytes());
    }
  }
);
  assertEquals("before",l.getContentBefore());
  assertEquals("after",l.getContentAfter());
}
