{
  final Graph<Chunk<Module>> graph=toChunkGraph(moduleGraph);
  final List<Chunk<Module>> chunks=new ArrayList<Chunk<Module>>(moduleGraph.getNodes().size());
  for (  final Chunk<Module> chunk : graph.getNodes()) {
    chunks.add(chunk);
  }
  DFSTBuilder<Chunk<Module>> builder=new DFSTBuilder<Chunk<Module>>(graph);
  if (!builder.isAcyclic()) {
    LOG.error("Acyclic graph expected");
    return null;
  }
  Collections.sort(chunks,builder.comparator());
  final Set<Module> modulesSet=new HashSet<Module>(Arrays.asList(modules));
  for (Iterator<Chunk<Module>> it=chunks.iterator(); it.hasNext(); ) {
    final Chunk<Module> chunk=it.next();
    if (!intersects(chunk.getNodes(),modulesSet)) {
      it.remove();
    }
  }
  return chunks;
}
