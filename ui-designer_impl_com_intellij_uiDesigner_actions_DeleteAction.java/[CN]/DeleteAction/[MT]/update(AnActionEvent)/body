{
  final Presentation presentation=e.getPresentation();
  CaptionSelection selection=(CaptionSelection)e.getDataContext().getData(CaptionSelection.class.getName());
  if (selection == null || selection.getContainer() == null) {
    presentation.setVisible(false);
    return;
  }
  presentation.setVisible(true);
  presentation.setText(!selection.isRow() ? UIDesignerBundle.message("action.delete.column") : UIDesignerBundle.message("action.delete.row"));
  if (selection.isRow() && selection.getContainer().getGridRowCount() < 2) {
    presentation.setEnabled(false);
  }
 else   if (!selection.isRow() && selection.getContainer().getGridColumnCount() < 2) {
    presentation.setEnabled(false);
  }
 else   if (selection.getFocusedIndex() < 0) {
    presentation.setEnabled(false);
  }
 else {
    presentation.setEnabled(true);
  }
}
