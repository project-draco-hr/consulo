{
  final Presentation presentation=e.getPresentation();
  CaptionSelection selection=e.getData(CaptionSelection.DATA_KEY);
  if (selection == null || selection.getContainer() == null) {
    presentation.setVisible(false);
    return;
  }
  presentation.setVisible(true);
  if (selection.getSelection().length > 1) {
    presentation.setText(!selection.isRow() ? UIDesignerBundle.message("action.delete.columns") : UIDesignerBundle.message("action.delete.rows"));
  }
 else {
    presentation.setText(!selection.isRow() ? UIDesignerBundle.message("action.delete.column") : UIDesignerBundle.message("action.delete.row"));
  }
  if (selection.isRow() && selection.getContainer().getGridRowCount() <= selection.getSelection().length) {
    presentation.setEnabled(false);
  }
 else   if (!selection.isRow() && selection.getContainer().getGridColumnCount() <= selection.getSelection().length) {
    presentation.setEnabled(false);
  }
 else   if (selection.getFocusedIndex() < 0) {
    presentation.setEnabled(false);
  }
 else {
    presentation.setEnabled(true);
  }
}
