{
  if (!CommonRefactoringUtil.checkReadOnlyStatus(file))   return;
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    @Override public void run(){
      try {
        PsiDocumentManager.getInstance(file.getProject()).commitAllDocuments();
        PsiMethod method=generateDummyMethod(editor,file);
        if (method == null)         return;
        TestIntegrationUtils.runTestMethodTemplate(myMethodKind,framework,editor,targetClass,method,"name",false);
      }
 catch (      IncorrectOperationException e) {
        HintManager.getInstance().showErrorHint(editor,"Cannot generate method: " + e.getMessage());
        LOG.warn(e);
      }
    }
  }
);
}
