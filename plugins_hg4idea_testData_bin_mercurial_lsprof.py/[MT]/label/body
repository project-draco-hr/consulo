def label(code):
    if isinstance(code, str):
        return code
    try:
        mname = _fn2mod[code.co_filename]
    except KeyError:
        for (k, v) in list(sys.modules.iteritems()):
            if (v is None):
                continue
            if (not hasattr(v, '__file__')):
                continue
            if (not isinstance(v.__file__, str)):
                continue
            if v.__file__.startswith(code.co_filename):
                mname = _fn2mod[code.co_filename] = k
                break
        else:
            mname = _fn2mod[code.co_filename] = ('<%s>' % code.co_filename)
    return ('%s:%d(%s)' % (mname, code.co_firstlineno, code.co_name))
