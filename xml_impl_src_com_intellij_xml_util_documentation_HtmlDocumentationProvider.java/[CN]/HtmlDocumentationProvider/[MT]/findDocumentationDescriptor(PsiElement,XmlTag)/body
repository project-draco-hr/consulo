{
  boolean isTag=true;
  PsiElement nameElement=null;
  String key=null;
  if (element instanceof XmlElementDecl) {
    nameElement=((XmlElementDecl)element).getNameElement();
  }
 else   if (element instanceof XmlAttributeDecl) {
    nameElement=((XmlAttributeDecl)element).getNameElement();
    isTag=false;
  }
 else   if (element instanceof XmlTag) {
    final XmlTag xmlTag=((XmlTag)element);
    final PsiMetaDataBase metaData=xmlTag.getMetaData();
    key=(metaData != null) ? metaData.getName() : null;
    isTag=xmlTag.getLocalName().equals(ELEMENT_ELEMENT_NAME);
    if (metaData instanceof TldAttributeDescriptor || metaData instanceof TldDescriptor) {
      key=null;
    }
  }
 else   if (element.getParent() instanceof XmlAttributeValue) {
    isTag=false;
    key=((XmlAttribute)element.getParent().getParent()).getName();
  }
 else   if (element instanceof XmlAttributeValue) {
    isTag=false;
    key=((XmlAttribute)element.getParent()).getName();
  }
 else   if (element instanceof XmlAttribute) {
    isTag=false;
    key=((XmlAttribute)element).getName();
  }
 else {
    nameElement=element;
    isTag=!(element.getParent() instanceof XmlAttribute);
  }
  if (nameElement != null) {
    key=nameElement.getText();
  }
  key=(key != null) ? key.toLowerCase() : "";
  if (isTag) {
    return HtmlDescriptorsTable.getTagDescriptor(key);
  }
 else {
    return getDescriptor(key,context);
  }
}
