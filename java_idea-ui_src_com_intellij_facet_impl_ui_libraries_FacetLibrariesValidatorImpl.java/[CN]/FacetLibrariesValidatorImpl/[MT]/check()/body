{
  if (myRequiredLibraries == null) {
    return ValidationResult.OK;
  }
  ModuleRootModel rootModel=myContext.getRootModel();
  List<VirtualFile> roots=collectRoots(rootModel);
  RequiredLibrariesInfo.RequiredClassesNotFoundInfo info=myRequiredLibraries.checkLibraries(VfsUtil.toVirtualFileArray(roots));
  if (info == null) {
    return ValidationResult.OK;
  }
  String missingJars=IdeBundle.message("label.missed.libraries.prefix") + " " + info.getMissingJarsText();
  LibraryInfo[] missingLibraries=info.getLibraryInfos();
  VirtualFile baseDir=myContext.getModule().getProject().getBaseDir();
  final String baseDirPath=baseDir != null ? baseDir.getPath() : "";
  CustomLibraryDescription description=new CustomLibraryDescriptionImpl(missingLibraries,myDescription.getDefaultLibraryName());
  return new ValidationResult(missingJars,new LibrariesQuickFix(description,baseDirPath));
}
