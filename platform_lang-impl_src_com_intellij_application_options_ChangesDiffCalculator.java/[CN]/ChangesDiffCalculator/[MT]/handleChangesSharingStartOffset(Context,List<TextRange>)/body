{
  int lengthDiff=getLength(context.currentChange) - getLength(context.beforeChange);
  if (lengthDiff != 0 || !StringUtil.equals(context.beforeChange.getText(),context.currentChange.getText())) {
    storage.add(new TextRange(context.currentChange.getStart(),context.currentChange.getEnd()));
    context.beforeShiftToCurrent-=getDiff(context.currentChange) - getDiff(context.beforeChange);
  }
  context.proceedToNextChange(Context.ChangeType.BEFORE);
  context.proceedToNextChange(Context.ChangeType.CURRENT);
}
