{
  MultiMap<Project,VirtualFile> addedVFiles=new MultiMap<Project,VirtualFile>();
  for (  AddedFileInfo addedFileInfo : myAddedFiles) {
    VirtualFile addedFile=addedFileInfo.myDir.findChild(addedFileInfo.myName);
    if (addedFile != null) {
      final SVNStatus fileStatus=getFileStatus(new File(getIOFile(addedFileInfo.myDir),addedFileInfo.myName));
      if (fileStatus == null || fileStatus.getContentsStatus() != SVNStatusType.STATUS_IGNORED) {
        addedVFiles.putValue(addedFileInfo.myProject,addedFile);
      }
    }
  }
  for (  Project project : addedVFiles.keySet()) {
    SvnVcs vcs=SvnVcs.getInstance(project);
    final VcsShowConfirmationOption.Value value=vcs.getAddConfirmation().getValue();
    if (value != VcsShowConfirmationOption.Value.DO_NOTHING_SILENTLY) {
      final AbstractVcsHelper vcsHelper=AbstractVcsHelper.getInstance(project);
      List<VirtualFile> vFiles=addedVFiles.get(project);
      Collection<VirtualFile> filesToProcess;
      if (value == VcsShowConfirmationOption.Value.DO_ACTION_SILENTLY) {
        filesToProcess=vFiles;
      }
 else {
        filesToProcess=vcsHelper.selectFilesToProcess(vFiles,SvnBundle.message("confirmation.title.add.multiple.files"),null,SvnBundle.message("confirmation.title.add.file"),SvnBundle.message("confirmation.text.add.file"),vcs.getAddConfirmation());
      }
      if (filesToProcess != null) {
        List<VcsException> exceptions=new ArrayList<VcsException>();
        SVNWCClient wcClient=new SVNWCClient(null,vcs.getSvnOptions());
        for (        VirtualFile file : filesToProcess) {
          File ioFile=new File(file.getPath());
          try {
            wcClient.doAdd(ioFile,false,false,false,false);
          }
 catch (          SVNException e) {
            exceptions.add(new VcsException(e));
          }
        }
        if (!exceptions.isEmpty()) {
          vcsHelper.showErrors(exceptions,"Errors Adding Files");
        }
      }
    }
  }
}
