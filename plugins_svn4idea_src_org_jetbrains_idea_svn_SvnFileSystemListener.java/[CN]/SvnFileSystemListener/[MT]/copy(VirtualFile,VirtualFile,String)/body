{
  SvnVcs vcs=getVCS(toDir);
  if (vcs == null) {
    vcs=getVCS(file);
  }
  if (vcs == null) {
    return null;
  }
  File srcFile=new File(file.getPath());
  File destFile=new File(new File(toDir.getPath()),copyName);
  if (!SVNWCUtil.isVersionedDirectory(destFile.getParentFile())) {
    return null;
  }
  if (!SVNWCUtil.isVersionedDirectory(srcFile.getParentFile())) {
    myAddedFiles.add(new AddedFileInfo(vcs.getProject(),toDir,copyName));
    return null;
  }
  final SVNStatus fileStatus=getFileStatus(srcFile);
  if (fileStatus != null && fileStatus.getContentsStatus() == SVNStatusType.STATUS_ADDED) {
    myAddedFiles.add(new AddedFileInfo(vcs.getProject(),toDir,copyName));
    return null;
  }
  SVNCopyClient client=vcs.createCopyClient();
  try {
    client.doCopy(srcFile,SVNRevision.WORKING,destFile,false,false);
  }
 catch (  SVNException e) {
    return null;
  }
  return destFile;
}
