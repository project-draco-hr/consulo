{
  final List<Pair<PsiElement,TextRange>> result=new SmartList<Pair<PsiElement,TextRange>>();
  enumerate(host,new PsiLanguageInjectionHost.InjectedPsiVisitor(){
    public void visit(    @NotNull PsiFile injectedPsi,    @NotNull List<PsiLanguageInjectionHost.Shred> places){
      for (      PsiLanguageInjectionHost.Shred place : places) {
        if (place.host == host) {
          result.add(new Pair<PsiElement,TextRange>(injectedPsi,place.rangeInsideHost));
        }
      }
    }
  }
,true);
  return result.isEmpty() ? null : result;
}
