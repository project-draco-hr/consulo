{
  Document document=PsiDocumentManager.getInstance(project).getDocument(file);
  Editor editor=FileEditorManager.getInstance(project).openTextEditor(new OpenFileDescriptor(project,file.getVirtualFile(),-1),false);
  if (editor instanceof EditorDelegate)   editor=((EditorDelegate)editor).getDelegate();
  if (editor == null)   return null;
  if (document instanceof DocumentRange) {
    return EditorDelegate.create((DocumentRange)document,(EditorImpl)editor,file);
  }
  return editor;
}
