{
  if (!CodeInsightUtil.prepareFileForWrite(myFile))   return;
  try {
    final PsiElementFactory factory=myFile.getManager().getElementFactory();
    if (myTargetPackage.getQualifiedName().equals("")) {
      if (myStatement != null) {
        myStatement.delete();
      }
    }
 else {
      if (myStatement != null) {
        final PsiJavaCodeReferenceElement packageReferenceElement=factory.createPackageReferenceElement(myTargetPackage);
        myStatement.getPackageReference().replace(packageReferenceElement);
      }
 else {
        final PsiPackageStatement packageStatement=factory.createPackageStatement(myTargetPackage.getQualifiedName());
        myFile.addAfter(packageStatement,null);
      }
    }
  }
 catch (  IncorrectOperationException e) {
    LOG.error(e);
  }
}
