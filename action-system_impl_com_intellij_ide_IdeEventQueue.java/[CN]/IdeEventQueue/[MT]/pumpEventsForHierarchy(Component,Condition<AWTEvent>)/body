{
  AWTEvent event;
  do {
    try {
      boolean eventOk=true;
      event=getNextEvent();
      final Object s=event.getSource();
      if (s instanceof Component) {
        Component c=(Component)s;
        while (c != null && c != modalComponent)         c=c.getParent();
        if (c == null)         eventOk=false;
      }
      if (eventOk) {
        dispatchEvent(event);
      }
    }
 catch (    Throwable e) {
      LOG.error(e);
      event=null;
    }
  }
 while (!exitCondition.value(event));
}
