{
  PsiElement element;
  final PsiDirectory[] directories=aPackage.getDirectories();
  final VirtualFile[] virtualFiles=aPackage.occursInPackagePrefixes();
  if (directories.length > 1 || virtualFiles.length > 0) {
    final StringBuffer message=new StringBuffer();
    RenameUtil.buildPackagePrefixChangedMessage(virtualFiles,message,aPackage.getQualifiedName());
    if (directories.length > 1) {
      RenameUtil.buildMultipleDirectoriesInPackageMessage(message,aPackage,directories);
      message.append("\n\nAll these directories will be moved and all references to \n");
      message.append(aPackage.getQualifiedName());
      message.append("\nwill be changed.");
    }
    message.append("\nDo you wish to continue?");
    int ret=Messages.showYesNoDialog(project,message.toString(),"Warning",Messages.getWarningIcon());
    if (ret != 0) {
      return null;
    }
  }
  checkMove(aPackage,readOnly);
  element=aPackage;
  return element;
}
