{
  final Runnable command=new Runnable(){
    public void run(){
      Document document=myEditor.getDocument();
      StringBuilder buffer=new StringBuilder();
      for (      Line line : lines) {
        buffer.append(line.getValue());
      }
      int endBefore=document.getTextLength();
      int endBeforeLine=endBefore;
      document.insertString(endBefore,buffer.toString());
      for (      Line line : lines) {
        myEditor.getMarkupModel().addRangeHighlighter(endBeforeLine,endBeforeLine + line.getValue().length(),HighlighterLayer.ADDITIONAL_SYNTAX,line.getAttributes(),HighlighterTargetArea.EXACT_RANGE);
        endBeforeLine+=line.getValue().length();
      }
      shiftCursorToTheEndOfDocument();
    }
  }
;
  return new Runnable(){
    public void run(){
      CommandProcessor.getInstance().executeCommand(myProject,command,"",null,UndoConfirmationPolicy.DEFAULT,myEditor.getDocument());
    }
  }
;
}
