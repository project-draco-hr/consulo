{
  final Semaphore startSemaphore=new Semaphore();
  final Semaphore finishSemaphore=new Semaphore();
  final ProgressIndicator[] indicator=new ProgressIndicator[1];
  startSemaphore.down();
  finishSemaphore.down();
  ProgressManager.getInstance().run(new Task.Backgroundable(project,title,canBeCancelled){
    public void run(    @NotNull ProgressIndicator i){
      try {
        indicator[0]=i;
        startSemaphore.up();
        task.run(new MavenProcess(i));
      }
 catch (      MavenProcessCanceledException ignore) {
      }
 finally {
        finishSemaphore.up();
      }
    }
    @Override public boolean shouldStartInBackground(){
      return task.shouldStartInBackground();
    }
    @Override public void processRestoredToForeground(){
      task.setStartInForeground();
    }
    @Override public void processSentToBackground(){
      task.setStartInBackground();
    }
  }
);
  return new MavenTaskHandler(startSemaphore,finishSemaphore,indicator);
}
