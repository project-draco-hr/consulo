{
  ModelWithProblems cachedModelWithValidity=myRawModelsAndProblemsCache.get(file);
  if (cachedModelWithValidity == null) {
    cachedModelWithValidity=doReadProjectModel(file,false);
    myRawModelsAndProblemsCache.put(file,cachedModelWithValidity);
  }
  Model model=cachedModelWithValidity.model;
  Collection<MavenProjectProblem> problems=cachedModelWithValidity.problems;
  repairModelHeader(model);
  resolveInheritance(generalSettings,model,file,activeProfiles,recursionGuard,locator,problems);
  addSettingsProfiles(generalSettings,model,problems);
  List<Profile> activatedProfiles=applyProfiles(model,getBaseDir(file),activeProfiles);
  repairModelBody(model);
  return Pair.create(new ModelWithProblems(model,problems),activatedProfiles);
}
