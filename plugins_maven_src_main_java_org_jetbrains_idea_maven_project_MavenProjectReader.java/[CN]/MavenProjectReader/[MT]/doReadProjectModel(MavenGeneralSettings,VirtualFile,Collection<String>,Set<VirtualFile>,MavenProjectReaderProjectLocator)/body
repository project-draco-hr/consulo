{
  RawModelReadResult cachedModel=myRawModelsCache.get(file);
  if (cachedModel == null) {
    cachedModel=doReadProjectModel(file,false);
    myRawModelsCache.put(file,cachedModel);
  }
  Model model=cachedModel.model;
  Collection<String> alwaysOnProfiles=cachedModel.alwaysOnProfiles;
  Collection<MavenProjectProblem> problems=cachedModel.problems;
  repairModelHeader(model);
  resolveInheritance(generalSettings,model,file,explicitProfiles,recursionGuard,locator,problems);
  addSettingsProfiles(generalSettings,model,alwaysOnProfiles,problems);
  Collection<Profile> activatedProfiles=applyProfiles(model,getBaseDir(file),explicitProfiles,alwaysOnProfiles);
  repairModelBody(model);
  return Pair.create(cachedModel,activatedProfiles);
}
