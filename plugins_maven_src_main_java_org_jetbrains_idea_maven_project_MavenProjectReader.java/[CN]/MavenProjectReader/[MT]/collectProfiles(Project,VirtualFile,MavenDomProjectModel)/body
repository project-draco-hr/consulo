{
  MavenProjectsManager mavenManager=MavenProjectsManager.getInstance(project);
  List<Profile> result=new ArrayList<Profile>();
  collectProfiles(domProject.getProfiles(),result);
  VirtualFile profilesFile=file.getParent().findChild(MavenConstants.PROFILES_XML);
  if (profilesFile != null) {
    DomFileElement<MavenDomProfiles> domProfilesFile=getDomFile(project,profilesFile,MavenDomProfiles.class);
    if (domProfilesFile != null) {
      collectProfiles(domProfilesFile.getRootElement(),result);
    }
  }
  MavenGeneralSettings settings=mavenManager.getGeneralSettings();
  File userSettings=MavenEmbedderFactory.resolveUserSettingsFile(settings.getMavenSettingsFile());
  collectProfilesFromSettingsFile(project,userSettings,result);
  File globalSettings=MavenEmbedderFactory.resolveGlobalSettingsFile(settings.getMavenHome());
  collectProfilesFromSettingsFile(project,globalSettings,result);
  return result;
}
