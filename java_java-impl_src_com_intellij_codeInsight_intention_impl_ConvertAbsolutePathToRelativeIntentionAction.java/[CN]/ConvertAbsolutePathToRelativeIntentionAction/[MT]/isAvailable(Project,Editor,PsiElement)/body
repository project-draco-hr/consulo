{
  if (element == null)   return false;
  final PsiFile containingFile=element.getContainingFile();
  if (containingFile == null)   return false;
  final PsiReference reference=containingFile.findReferenceAt(editor.getCaretModel().getOffset());
  final FileReference fileReference=reference == null ? null : findFileReference(reference);
  if (fileReference != null) {
    final FileReferenceSet set=fileReference.getFileReferenceSet();
    final FileReference lastReference=set.getLastReference();
    return set.couldBeConvertedTo(isConvertToRelative()) && lastReference != null && (!isConvertToRelative() && !set.isAbsolutePathReference() || isConvertToRelative() && set.isAbsolutePathReference()) && lastReference.resolve() != null;
  }
  return false;
}
