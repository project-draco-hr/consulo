{
  final PsiCodeBlock containingScope=PsiTreeUtil.getParentOfType(variable,PsiCodeBlock.class);
  if (containingScope == null) {
    return false;
  }
  final PsiDeclarationStatement declarationStatement=PsiTreeUtil.getParentOfType(variable,PsiDeclarationStatement.class);
  if (declarationStatement == null) {
    return false;
  }
  PsiStatement nextStatement=null;
  int followingStatementNumber=0;
  final PsiStatement[] statements=containingScope.getStatements();
  for (int i=0; i < statements.length - 1; i++) {
    if (statements[i].equals(declarationStatement)) {
      nextStatement=statements[i + 1];
      followingStatementNumber=i + 2;
    }
  }
  if (nextStatement instanceof PsiDeclarationStatement) {
    boolean referenceFound=false;
    for (    PsiElement declaration : ((PsiDeclarationStatement)nextStatement).getDeclaredElements()) {
      if (!(declaration instanceof PsiVariable)) {
        continue;
      }
      final PsiExpression initializer=((PsiVariable)declaration).getInitializer();
      if (!referenceFound) {
        if (initializer instanceof PsiReferenceExpression) {
          final PsiElement referent=((PsiReference)initializer).resolve();
          if (variable.equals(referent)) {
            referenceFound=true;
            continue;
          }
        }
      }
      if (VariableAccessUtils.variableIsUsed(variable,initializer)) {
        return false;
      }
    }
    if (!referenceFound) {
      return false;
    }
  }
 else   if (nextStatement instanceof PsiTryStatement) {
    final PsiTryStatement tryStatement=(PsiTryStatement)nextStatement;
    final PsiResourceList resourceList=tryStatement.getResourceList();
    if (resourceList == null) {
      return false;
    }
    boolean referenceFound=false;
    for (    PsiResourceVariable resourceVariable : resourceList.getResourceVariables()) {
      final PsiExpression initializer=resourceVariable.getInitializer();
      if (!referenceFound) {
        if (initializer instanceof PsiReferenceExpression) {
          final PsiElement referent=((PsiReferenceExpression)initializer).resolve();
          if (variable.equals(referent)) {
            referenceFound=true;
            continue;
          }
        }
      }
      if (VariableAccessUtils.variableIsUsed(variable,initializer)) {
        return false;
      }
    }
    if (!referenceFound) {
      return false;
    }
    if (VariableAccessUtils.variableIsUsed(variable,tryStatement.getTryBlock()) || VariableAccessUtils.variableIsUsed(variable,tryStatement.getFinallyBlock())) {
      return false;
    }
    for (    PsiCatchSection section : tryStatement.getCatchSections()) {
      if (VariableAccessUtils.variableIsUsed(variable,section)) {
        return false;
      }
    }
  }
 else {
    return false;
  }
  for (int i=followingStatementNumber; i < statements.length; i++) {
    if (VariableAccessUtils.variableIsUsed(variable,statements[i])) {
      return false;
    }
  }
  return true;
}
