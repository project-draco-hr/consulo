{
  PsiType type=variable.getType();
  PsiElementFactory factory=JavaPsiFacade.getInstance(myClass.getProject()).getElementFactory();
  PsiType newType=type.createArrayType();
  PsiDeclarationStatement variableDeclarationStatement;
  PsiExpression initializer=variable.getInitializer();
  if (initializer == null) {
    String expression="[1]";
    while (type instanceof PsiArrayType) {
      expression+="[1]";
      type=((PsiArrayType)type).getComponentType();
    }
    PsiExpression init=factory.createExpressionFromText("new " + type.getCanonicalText() + expression,variable);
    variableDeclarationStatement=factory.createVariableDeclarationStatement(variable.getName(),newType,init);
  }
 else {
    PsiExpression init=factory.createExpressionFromText(" { " + initializer.getText() + " }",variable);
    variableDeclarationStatement=factory.createVariableDeclarationStatement(variable.getName(),newType,init);
  }
  PsiVariable newVariable=(PsiVariable)variableDeclarationStatement.getDeclaredElements()[0];
  PsiUtil.setModifierProperty(newVariable,PsiModifier.FINAL,true);
  PsiElement newExpression=factory.createExpressionFromText(variable.getName() + "[0]",variable);
  PsiElement outerCodeBlock=PsiUtil.getVariableCodeBlock(variable,null);
  if (outerCodeBlock == null)   return;
  List<PsiReferenceExpression> outerReferences=new ArrayList<PsiReferenceExpression>();
  collectReferences(outerCodeBlock,variable,outerReferences);
  replaceReferences(outerReferences,newExpression);
  variable.replace(newVariable);
}
