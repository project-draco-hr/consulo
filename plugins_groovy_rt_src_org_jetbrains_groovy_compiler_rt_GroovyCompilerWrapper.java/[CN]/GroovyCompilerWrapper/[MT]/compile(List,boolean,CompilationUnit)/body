{
  List compiledFiles=new ArrayList();
  try {
    unit.compile(forStubs ? Phases.CONVERSION : Phases.ALL);
    addCompiledFiles(unit,compiledFiles,forStubs);
  }
 catch (  CompilationFailedException e) {
    processCompilationException(e,collector,forStubs);
  }
catch (  IOException e) {
    processException(e,collector,forStubs);
  }
catch (  NoClassDefFoundError e) {
    final String className=e.getMessage();
    if (className.startsWith("org/apache/ivy/")) {
      addMessageWithoutLocation(collector,"Cannot @Grab without Ivy, please add it to your module dependencies (NoClassDefFoundError: " + className + ")",true);
    }
 else {
      throw e;
    }
  }
 finally {
    addWarnings(unit.getErrorCollector(),collector);
  }
  return compiledFiles;
}
