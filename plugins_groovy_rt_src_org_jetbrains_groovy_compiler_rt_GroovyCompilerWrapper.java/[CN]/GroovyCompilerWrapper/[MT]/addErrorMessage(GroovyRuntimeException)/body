{
  ASTNode astNode=exception.getNode();
  ModuleNode module=exception.getModule();
  if (module == null) {
    module=findModule(astNode);
  }
  String moduleName=module == null ? "<no module>" : module.getDescription();
  int lineNumber=astNode == null ? -1 : astNode.getLineNumber();
  int columnNumber=astNode == null ? -1 : astNode.getColumnNumber();
  String message=exception.getMessageWithoutLocationText();
  if (message == null) {
    StringWriter stringWriter=new StringWriter();
    PrintWriter writer=new PrintWriter(stringWriter);
    exception.printStackTrace(writer);
    message=stringWriter.getBuffer().toString();
  }
  collector.add(new CompilerMessage(GroovyCompilerMessageCategories.ERROR,message,moduleName,lineNumber,columnNumber));
}
