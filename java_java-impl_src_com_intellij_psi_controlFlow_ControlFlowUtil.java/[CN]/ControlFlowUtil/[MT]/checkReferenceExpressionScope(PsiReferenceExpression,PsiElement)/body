{
  final JavaResolveResult resolveResult=ref.advancedResolve(false);
  final PsiElement def=resolveResult.getElement();
  if (def != null) {
    PsiElement parent=def.getParent();
    PsiElement commonParent=parent == null ? null : PsiTreeUtil.findCommonParent(parent,targetClassMember);
    if (commonParent == null) {
      parent=resolveResult.getCurrentFileResolveScope();
    }
    if (parent instanceof PsiClass) {
      final PsiClass clss=(PsiClass)parent;
      if (PsiTreeUtil.isAncestor(targetClassMember,clss,false))       return false;
    }
  }
  return true;
}
