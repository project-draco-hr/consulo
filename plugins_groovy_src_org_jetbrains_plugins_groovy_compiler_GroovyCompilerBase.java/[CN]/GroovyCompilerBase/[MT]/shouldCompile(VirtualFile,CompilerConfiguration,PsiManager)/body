{
  if (configuration.isResourceFile(file)) {
    return false;
  }
  final FileType fileType=file.getFileType();
  if (fileType == GroovyFileType.GROOVY_FILE_TYPE) {
    return ApplicationManager.getApplication().runReadAction(new Computable<Boolean>(){
      public Boolean compute(){
        PsiFile psiFile=manager.findFile(file);
        if (psiFile instanceof GroovyFile && ((GroovyFile)psiFile).isScript()) {
          final GroovyScriptType scriptType=GroovyScriptTypeDetector.getScriptType((GroovyFile)psiFile);
          return scriptType.shouldBeCompiled((GroovyFile)psiFile);
        }
        return true;
      }
    }
);
  }
  return fileType == StdFileTypes.JAVA;
}
