{
  final StringBuffer buffer=new StringBuffer();
  ApplicationManager.getApplication().runReadAction(new Runnable(){
    public void run(){
      ModuleRootManager manager=ModuleRootManager.getInstance(module);
      for (      OrderEntry entry : manager.getOrderEntries()) {
        if (entry instanceof LibraryOrderEntry) {
          Library library=((LibraryOrderEntry)entry).getLibrary();
          if (library == null)           continue;
          for (          VirtualFile file : library.getFiles(OrderRootType.CLASSES)) {
            String path=file.getPath();
            if (path != null && path.endsWith(".jar!/")) {
              buffer.append(StringUtil.trimEnd(path,"!/")).append(File.pathSeparator);
            }
          }
        }
      }
    }
  }
);
  return buffer.toString();
}
