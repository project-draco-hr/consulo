{
  if (myFileTypeRegistry.isFileIgnored(file))   return true;
  if (myExclusionManager != null && myExclusionManager.isExcluded(file))   return true;
  VirtualFile dir=file.isDirectory() ? file : file.getParent();
  if (dir == null)   return false;
  DirectoryInfo info=getInfoForFileOrDirectory(dir);
  if (info != null)   return false;
  if (myDirectoryIndex.isProjectExcludeRoot(dir))   return true;
  VirtualFile parent=dir.getParent();
  while (true) {
    if (parent == null)     return false;
    DirectoryInfo parentInfo=getInfoForFileOrDirectory(parent);
    if (parentInfo != null)     return true;
    if (myDirectoryIndex.isProjectExcludeRoot(parent))     return true;
    parent=parent.getParent();
  }
}
