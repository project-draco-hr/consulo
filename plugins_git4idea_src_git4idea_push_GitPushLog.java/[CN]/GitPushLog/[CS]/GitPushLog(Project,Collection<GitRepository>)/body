{
  myProject=project;
  myAllRepositories=repositories;
  myRootNode=new CheckedTreeNode(null);
  myTreeModel=new DefaultTreeModel(myRootNode);
  myTree=new CheckboxTree(new MyTreeCellRenderer(),myRootNode);
  myTree.setRootVisible(false);
  TreeUtil.expandAll(myTree);
  myTree.getSelectionModel().setSelectionMode(TreeSelectionModel.SINGLE_TREE_SELECTION);
  myTree.addTreeSelectionListener(new TreeSelectionListener(){
    @Override public void valueChanged(    TreeSelectionEvent e){
      DefaultMutableTreeNode node=(DefaultMutableTreeNode)myTree.getLastSelectedPathComponent();
      if (node != null) {
        Object nodeInfo=node.getUserObject();
        if (nodeInfo instanceof GitCommit) {
          myChangesBrowser.setChangesToDisplay(((GitCommit)nodeInfo).getChanges());
          return;
        }
      }
      myChangesBrowser.setChangesToDisplay(Collections.<Change>emptyList());
    }
  }
);
  myChangesBrowser=new ChangesBrowser(project,null,Collections.<Change>emptyList(),null,false,true,null,ChangesBrowser.MyUseCase.LOCAL_CHANGES,null);
  myChangesBrowser.getDiffAction().registerCustomShortcutSet(CommonShortcuts.getDiff(),myTree);
  Splitter splitter=new Splitter(false,0.7f);
  splitter.setFirstComponent(ScrollPaneFactory.createScrollPane(myTree));
  splitter.setSecondComponent(myChangesBrowser);
  setLayout(new BorderLayout());
  add(splitter);
}
