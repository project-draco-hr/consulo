def checklink(path):
    'check whether the given path is on a symlink-capable filesystem'
    name = tempfile.mktemp(dir=path, prefix='hg-checklink-')
    try:
        os.symlink('.', name)
        os.unlink(name)
        return True
    except (OSError, AttributeError):
        return False
