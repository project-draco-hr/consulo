def makedirs(name, mode=None):
    'recursive directory creation with parent mode inheritance'
    try:
        os.mkdir(name)
        if (mode is not None):
            os.chmod(name, mode)
        return
    except OSError as err:
        if (err.errno == errno.EEXIST):
            return
        if (err.errno != errno.ENOENT):
            raise
    parent = os.path.abspath(os.path.dirname(name))
    makedirs(parent, mode)
    makedirs(name, mode)
