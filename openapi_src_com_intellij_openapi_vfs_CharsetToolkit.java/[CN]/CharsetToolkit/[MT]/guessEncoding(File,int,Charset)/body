{
  FileInputStream fis=new FileInputStream(f);
  byte[] buffer=new byte[bufferLength];
  try {
    fis.read(buffer);
  }
  finally {
    fis.close();
  }
  CharsetToolkit toolkit=new CharsetToolkit(buffer);
  toolkit.setDefaultCharset(defaultCharset);
  return toolkit.guessEncoding(bufferLength);
}
