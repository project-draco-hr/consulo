{
  Icon icon=item.getIcon();
  final Color bg=item.isSelected() && item.isFocused() ? UIUtil.getListSelectionBackground() : (UIUtil.isUnderGTKLookAndFeel() ? Color.WHITE : UIUtil.getListBackground());
  final Color c=UIUtil.getListSelectionBackground();
  final Color selBg=new Color(c.getRed(),c.getGreen(),c.getBlue(),getSelectionAlpha());
  int w=item.getWidth();
  int h=item.getHeight();
  if (navbar.isInFloatingMode() || (item.isSelected() && navbar.hasFocus())) {
    g.setPaint(item.isSelected() && item.isFocused() ? selBg : bg);
    g.fillRect(0,0,w - (item.isLastElement() ? 0 : getDecorationOffset()),h);
  }
  final int offset=item.isFirstElement() ? getFirstElementLeftOffset() : 0;
  final int iconOffset=getElementPadding().left + offset;
  icon.paintIcon(item,g,iconOffset,(h - icon.getIconHeight()) / 2);
  final int textOffset=icon.getIconWidth() + getElementPadding().width() + offset;
  int x=item.doPaintText(g,textOffset);
  g.setRenderingHint(RenderingHints.KEY_ANTIALIASING,RenderingHints.VALUE_ANTIALIAS_ON);
  g.translate(x,0);
  Path2D.Double path;
  int off=getDecorationOffset();
  if (item.isFocused()) {
    if (item.isSelected() && !item.isLastElement()) {
      path=new Path2D.Double();
      g.translate(2,0);
      path.moveTo(0,0);
      path.lineTo(off,h / 2);
      path.lineTo(0,h);
      path.lineTo(0,0);
      g.setColor(selBg);
      g.fill(path);
      g.translate(-2,0);
    }
    if (navbar.isInFloatingMode() || item.isNextSelected()) {
      if (!item.isLastElement()) {
        path=new Path2D.Double();
        path.moveTo(0,0);
        path.lineTo(off,h / 2);
        path.lineTo(0,h);
        path.lineTo(off + 2,h);
        path.lineTo(off + 2,0);
        path.lineTo(0,0);
        g.setColor(item.isNextSelected() ? selBg : UIUtil.getListBackground());
        g.fill(path);
      }
    }
  }
  if (!item.isLastElement() && ((!item.isSelected() && !item.isNextSelected()) || !navbar.hasFocus())) {
    Image img=SEPARATOR_PASSIVE;
    final UISettings settings=UISettings.getInstance();
    if (settings.SHOW_NAVIGATION_BAR) {
      img=SEPARATOR_GRADIENT;
    }
    g.drawImage(img,null,null);
  }
}
