{
  VirtualFile[] ff=e.getData(PlatformDataKeys.VIRTUAL_FILE_ARRAY);
  if (ff == null || ff.length == 0)   return null;
  VirtualFile commonParent=ff[0];
  for (int i=1; i < ff.length; i++) {
    commonParent=VfsUtil.getCommonAncestor(commonParent,ff[i]);
    if (commonParent == null)     break;
  }
  return commonParent;
}
