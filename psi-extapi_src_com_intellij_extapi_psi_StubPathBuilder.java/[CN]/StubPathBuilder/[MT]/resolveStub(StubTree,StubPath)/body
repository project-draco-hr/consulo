{
  if (path == null) {
    return tree.getRoot();
  }
  StubElement parentStub=resolveStub(tree,path.getParentPath());
  if (parentStub == null) {
    return null;
  }
  final StubPathElement elt=path.getLastElement();
  final String id=elt.getId();
  final IStubElementType type=(IStubElementType)elt.getType();
  final List<StubElement> children=parentStub.getChildrenStubs();
  if (id.startsWith("#")) {
    int count=Integer.parseInt(id.substring(1));
    for (    StubElement child : children) {
      if (child.getStubType() == type) {
        count--;
        if (count == 0) {
          return child;
        }
      }
    }
    return null;
  }
  for (  StubElement child : children) {
    if (child.getStubType() == type && id.equals(type.getId(child))) {
      return child;
    }
  }
  return null;
}
