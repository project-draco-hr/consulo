{
  LinkedHashSet<LookupElement> result=new LinkedHashSet<>();
  result.addAll(getPrefixItems(true));
  result.addAll(getPrefixItems(false));
  List<LookupElement> items=getMatchingItems();
  for (  LookupElement item : items) {
    if (CompletionServiceImpl.isStartMatch(item,this)) {
      result.add(item);
    }
  }
  result.addAll(items);
  ArrayList<LookupElement> list=new ArrayList<>(result);
  int selected=!lookup.isSelectionTouched() && onExplicitAction ? 0 : list.indexOf(lookup.getCurrentItem());
  return new Pair<>(list,selected >= 0 ? selected : 0);
}
