{
  final String subDirName=inputString;
  if (subDirName.length() == 0) {
    showErrorDialog(IdeBundle.message("error.name.should.be.specified"));
    return false;
  }
  final boolean multiCreation=StringUtil.containsAnyChar(subDirName,myDelimiters);
  if (!multiCreation) {
    try {
      myDirectory.checkCreateSubdirectory(subDirName);
    }
 catch (    IncorrectOperationException ex) {
      showErrorDialog(CreateElementActionBase.filterMessage(ex.getMessage()));
      return false;
    }
  }
  Runnable command=new Runnable(){
    @Override public void run(){
      final Runnable run=new Runnable(){
        @Override public void run(){
          LocalHistoryAction action=LocalHistoryAction.NULL;
          try {
            String actionName;
            String dirPath=myDirectory.getVirtualFile().getPresentableUrl();
            actionName=IdeBundle.message("progress.creating.directory",dirPath,File.separator,subDirName);
            action=LocalHistory.getInstance().startAction(actionName);
            createDirectories(subDirName);
          }
 catch (          final IncorrectOperationException ex) {
            ApplicationManager.getApplication().invokeLater(new Runnable(){
              @Override public void run(){
                showErrorDialog(CreateElementActionBase.filterMessage(ex.getMessage()));
              }
            }
);
          }
 finally {
            action.finish();
          }
        }
      }
;
      ApplicationManager.getApplication().runWriteAction(run);
    }
  }
;
  CommandProcessor.getInstance().executeCommand(myProject,command,myIsDirectory ? IdeBundle.message("command.create.directory") : IdeBundle.message("command.create.package"),null);
  return myCreatedElement != null;
}
