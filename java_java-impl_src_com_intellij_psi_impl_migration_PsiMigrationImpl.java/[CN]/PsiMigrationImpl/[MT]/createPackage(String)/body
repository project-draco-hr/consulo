{
  assertValid();
  ApplicationManager.getApplication().assertWriteAccessAllowed();
  final MigrationPackageImpl migrationPackage=new MigrationPackageImpl(this,qualifiedName);
  final MigrationPackageImpl oldMigrationPackage=myQNameToPackageMap.put(qualifiedName,migrationPackage);
  LOG.assertTrue(oldMigrationPackage == null,qualifiedName);
  final String parentName=parentPackageName(qualifiedName);
  final PsiPackage aPackage=myFacade.findPackage(parentName);
  if (aPackage == null) {
    createPackage(parentName);
  }
  List<PsiPackage> psiPackages=getSubpackagesList(parentName);
  psiPackages.add(migrationPackage);
  myMigrationManager.migrationModified(false);
  return migrationPackage;
}
