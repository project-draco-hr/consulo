{
  if (carret < 2 || text.length() < Math.min(carret - 2,2)) {
    return false;
  }
  if (text.charAt(carret - 1) == '%' && text.charAt(carret - 2) == '<') {
    int position=carret;
    for (; position < text.length() && isWhiteSpace(text,position); position++) {
    }
    if (position < text.length() && text.charAt(position) == '%') {
      return false;
    }
 else {
      EditorModificationUtil.insertStringAtCaret(editor,"%>");
      editor.getCaretModel().moveCaretRelatively(-2,0,false,false,true);
      myOriginalHandler.execute(editor,dataContext);
      myOriginalHandler.execute(editor,dataContext);
      editor.getCaretModel().moveCaretRelatively(0,-1,false,false,true);
      return true;
    }
  }
 else {
    return false;
  }
}
