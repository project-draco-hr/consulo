{
  final Project project=DataKeys.PROJECT.getData(dataContext);
  PsiFile file=DataKeys.PSI_FILE.getData(dataContext);
  if (project == null)   return false;
  if (!(file instanceof GspFile))   return false;
  int carret=editor.getCaretModel().getOffset();
  if (carret < 1)   return false;
  final EditorHighlighter highlighter=((EditorEx)editor).getHighlighter();
  HighlighterIterator iterator=highlighter.createIterator(carret - 1);
  if (iterator.getTokenType() != GspTokenTypesEx.JSCRIPT_BEGIN) {
    return false;
  }
  String text=editor.getDocument().getText();
  if (handleJspLikeScriptlet(editor,text,carret,dataContext)) {
    GspEditorActionUtil.insertSpacesByIndent(editor,project);
    return true;
  }
  return false;
}
