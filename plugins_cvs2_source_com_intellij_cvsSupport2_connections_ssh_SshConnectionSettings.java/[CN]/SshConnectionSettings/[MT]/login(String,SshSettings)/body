{
  if (!settings.USE_PPK) {
    SSHPasswordProvider sshPasswordProvider=SSHPasswordProvider.getInstance();
    String password=sshPasswordProvider.getPasswordForCvsRoot(cvsRoot);
    if (password == null) {
      SshPasswordDialog sshPasswordDialog=new SshPasswordDialog(cvsRoot,"Enter password for ");
      sshPasswordDialog.show();
      if (!sshPasswordDialog.isOK())       return false;
      password=sshPasswordDialog.getPassword();
      sshPasswordProvider.storePasswordForCvsRoot(cvsRoot,password,sshPasswordDialog.saveThisPassword());
    }
    if (password == null)     return false;
  }
 else {
    SSHPasswordProvider sshPasswordProvider=SSHPasswordProvider.getInstance();
    String password=sshPasswordProvider.getPPKPasswordForCvsRoot(cvsRoot);
    if (password == null) {
      SshPasswordDialog sshPasswordDialog=new SshPasswordDialog(cvsRoot,"Enter private key password for ");
      sshPasswordDialog.show();
      if (!sshPasswordDialog.isOK())       return false;
      password=sshPasswordDialog.getPassword();
      sshPasswordProvider.storePPKPasswordForCvsRoot(cvsRoot,password,sshPasswordDialog.saveThisPassword());
    }
    if (password == null)     return false;
  }
  return true;
}
