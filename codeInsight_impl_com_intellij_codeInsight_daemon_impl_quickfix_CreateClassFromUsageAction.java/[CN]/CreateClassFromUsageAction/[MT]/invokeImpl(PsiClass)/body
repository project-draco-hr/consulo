{
  if (CreateFromUsageUtils.isValidReference(getRefElement(),true)) {
    return;
  }
  final String superClassName;
  if (getRefElement().getParent().getParent() instanceof PsiMethod) {
    PsiMethod method=(PsiMethod)getRefElement().getParent().getParent();
    if (method.getThrowsList() == getRefElement().getParent()) {
      superClassName="java.lang.Exception";
    }
 else     superClassName=null;
  }
 else   superClassName=null;
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    public void run(){
      PsiJavaCodeReferenceElement refElement=getRefElement();
      final PsiClass aClass=CreateFromUsageUtils.createClass(refElement,myKind,superClassName);
      if (aClass == null)       return;
      try {
        refElement=(PsiJavaCodeReferenceElement)refElement.bindToElement(aClass);
      }
 catch (      IncorrectOperationException e) {
        LOG.error(e);
      }
      OpenFileDescriptor descriptor=new OpenFileDescriptor(refElement.getProject(),aClass.getContainingFile().getVirtualFile(),aClass.getTextOffset());
      FileEditorManager.getInstance(aClass.getProject()).openTextEditor(descriptor,true);
    }
  }
);
}
