{
  Iterator<? extends CharSequence> iterator=myContext.getPreviousLinesIterable().iterator();
  if (iterator.hasNext()) {
    CharSequence contextLine=iterator.next();
    while (myChangedLinesIterator.hasNext()) {
      Pair<Integer,? extends CharSequence> pair=myChangedLinesIterator.next();
      if (StringUtil.equalsTrimWhitespaces(pair.getSecond(),contextLine)) {
        if (!iterator.hasNext())         break;
        contextLine=iterator.next();
      }
    }
  }
  if (iterator.hasNext())   return -1;
  if (!myChangedLinesIterator.hasNext())   return -1;
  CharSequence targetLine=myContext.getTargetString();
  while (myChangedLinesIterator.hasNext()) {
    Pair<Integer,? extends CharSequence> pair=myChangedLinesIterator.next();
    if (StringUtil.equalsTrimWhitespaces(pair.getSecond(),targetLine)) {
      return pair.getFirst();
    }
  }
  return -1;
}
