{
synchronized (PersistentEnumerator.ourLock) {
    myEnumerator.markDirty(true);
    myAppendCache.remove(key);
    final AppendStream record=new AppendStream();
    myValueExternalizer.save(record,value);
    final ByteSequence bytes=record.getInternalBuffer();
    final int id=enumerate(key);
    HeaderRecord oldheader=readValueId(id);
    if (oldheader != HeaderRecord.EMPTY)     myLiveAndGarbageKeysCounter++;
 else     myLiveAndGarbageKeysCounter+=LIVE_KEY_MASK;
    HeaderRecord header=new HeaderRecord(myValueStorage.appendBytes(bytes,0));
    updateValueId(id,header,oldheader,key,0);
  }
}
