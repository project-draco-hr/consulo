{
synchronized (ourLock) {
    markDirty(true);
    myAppendCache.remove(key);
    final int id=enumerate(key);
    final AppendStream record=new AppendStream();
    myValueExternalizer.save(record,value);
    final ByteSequence bytes=record.getInternalBuffer();
    HeaderRecord header=readValueId(id);
    if (header != null) {
      myGarbageSize+=header.size;
    }
 else {
      header=new HeaderRecord();
    }
    header.size=bytes.getLength();
    header.address=myValueStorage.appendBytes(bytes,0);
    updateValueId(id,header);
  }
}
