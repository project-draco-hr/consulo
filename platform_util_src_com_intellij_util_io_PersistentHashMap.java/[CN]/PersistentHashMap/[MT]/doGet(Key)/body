{
synchronized (PersistentEnumerator.ourLock) {
    myAppendCache.remove(key);
    final int id=tryEnumerate(key);
    if (id == PersistentEnumerator.NULL_ID) {
      return null;
    }
    final HeaderRecord oldHeader=readValueId(id);
    if (oldHeader.address == PersistentEnumerator.NULL_ID) {
      return null;
    }
    Pair<Long,byte[]> readResult=myValueStorage.readBytes(oldHeader.address);
    if (readResult.first != null && readResult.first != oldHeader.address) {
      myEnumerator.markDirty(true);
      updateValueId(id,new HeaderRecord(readResult.first),oldHeader,key,0);
      if (oldHeader != HeaderRecord.EMPTY) {
        myLiveAndGarbageKeysCounter++;
      }
    }
    final DataInputStream input=new DataInputStream(new ByteArrayInputStream(readResult.second));
    try {
      return myValueExternalizer.read(input);
    }
  finally {
      input.close();
    }
  }
}
