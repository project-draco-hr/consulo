{
synchronized (ourLock) {
    markDirty(true);
    final AppendStream stream=myAppendCache.get(key);
    final int sizeBefore=stream.getBufferSize();
    appender.append(stream);
    myBytesInMemoryCount+=(stream.getBufferSize() - sizeBefore);
    if (myBytesInMemoryCount > APPEND_CACHE_DATA_THRESHOLD) {
      LOG.warn("PersistentHashMap: OVER " + APPEND_CACHE_DATA_THRESHOLD + " BYTES IN APPEND STREAM CACHE, FORCING CACHE FLUSH (not optimal serialization format?) File: "+ getDataFile(myFile).getPath());
      myAppendCache.clear();
    }
  }
}
