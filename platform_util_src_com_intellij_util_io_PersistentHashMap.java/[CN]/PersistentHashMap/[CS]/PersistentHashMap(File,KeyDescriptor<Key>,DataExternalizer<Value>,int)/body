{
  super(checkDataFiles(file),keyDescriptor,initialSize);
  myParentValueRefOffset=getRecordSize();
  myRecordBuffer=new byte[myParentValueRefOffset + 8 + 4];
  try {
    myValueExternalizer=valueExternalizer;
    myValueStorage=PersistentHashMapValueStorage.create(getDataFile(file).getPath());
    myGarbageSize=getMetaData();
    if (makesSenseToCompact()) {
      compact();
    }
  }
 catch (  IOException e) {
    throw e;
  }
catch (  Throwable t) {
    LOG.error(t);
    throw new CorruptedException(file);
  }
}
