{
  super(checkDataFile(file),keyDescriptor,initialSize);
  try {
    myFile=file;
    myValueExternalizer=valueExternalizer;
    myValueStorage=PersistentHashMapValueStorage.create(getDataFile(myFile).getPath());
    myGarbageSize=getMetaData();
    if (makesSenceToCompact()) {
      compact();
    }
  }
 catch (  IOException e) {
    throw e;
  }
catch (  Throwable t) {
    LOG.error(t);
    throw new CorruptedException(file);
  }
}
