{
  final StatisticsManager manager=StatisticsManager.getInstance();
  manager.incUseCount(CompletionService.STATISTICS_KEY,item,myLocation);
  final List<LookupElement> items=lookup.getItems();
  final LookupImpl lookupImpl=(LookupImpl)lookup;
  final int count=Math.min(lookupImpl.getPreferredItemsCount(),lookupImpl.getList().getSelectedIndex());
  for (int i=0; i < count; i++) {
    final LookupElement element=items.get(i);
    StatisticsInfo baseInfo=StatisticsManager.serialize(CompletionService.STATISTICS_KEY,element,myLocation);
    if (baseInfo != null && baseInfo != StatisticsInfo.EMPTY && manager.getUseCount(baseInfo) == 0) {
      manager.incUseCount(new StatisticsInfo(composeContextWithValue(baseInfo),IGNORED));
    }
  }
  StatisticsInfo info=StatisticsManager.serialize(CompletionService.STATISTICS_KEY,item,myLocation);
  if (info != null && info != StatisticsInfo.EMPTY) {
    manager.incUseCount(new StatisticsInfo(composeContextWithValue(info),SELECTED));
  }
}
