{
  final CompletionPreselectSkipper[] skippers=CompletionPreselectSkipper.EP_NAME.getExtensions();
  nextItem:   for (int i=0; i < sorted.size(); i++) {
    LookupElement item=sorted.get(i);
    final Object obj=item.getObject();
    if (obj instanceof PsiElement && !((PsiElement)obj).isValid())     continue;
    for (    final CompletionPreselectSkipper skipper : skippers) {
      if (skipper.skipElement(item,myLocation)) {
        continue nextItem;
      }
    }
    return i;
  }
  return sorted.size() - 1;
}
