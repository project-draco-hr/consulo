{
  JList list=lookup.getList();
  final boolean testMode=ApplicationManager.getApplication().isUnitTestMode();
  final int limit=Math.max(list.getLastVisibleIndex(),model.size()) + list.getVisibleRowCount() * 3;
  addSomeItems(model,byRelevance,new Condition<LookupElement>(){
    @Override public boolean value(    LookupElement lastAdded){
      return !testMode && model.size() >= limit;
    }
  }
);
}
