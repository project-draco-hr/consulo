{
  if (element instanceof XmlElementDecl) {
    PsiElement curElement=findPreviousComment(element);
    if (curElement != null) {
      return formatDocFromComment(curElement,((XmlElementDecl)element).getNameElement().getText());
    }
  }
 else   if (element instanceof XmlTag) {
    XmlTag tag=(XmlTag)element;
    MyPsiElementProcessor processor=new MyPsiElementProcessor();
    XmlUtil.processXmlElements(tag,processor,true);
    String name=tag.getAttributeValue(NAME_ATTR_NAME);
    String typeName=null;
    if (processor.result == null) {
      XmlTag declaration=getComplexOrSimpleTypeDefinition(element,originalElement);
      if (declaration != null) {
        XmlUtil.processXmlElements(declaration,processor,true);
        name=declaration.getAttributeValue(NAME_ATTR_NAME);
        typeName=declaration.getName();
      }
    }
    if (processor.result == null) {
      final String s=super.generateDoc(element,originalElement);
      if (s != null) {
        return s;
      }
      final PsiElement comment=findPreviousComment(element);
      if (comment != null) {
        return formatDocFromComment(comment,((XmlTag)element).getName());
      }
    }
    String doc=generateDoc(processor.result,name,typeName,processor.version);
    if (doc != null) {
      doc+=generateHtmlAdditionalDocTemplate(originalElement);
    }
    return doc;
  }
 else   if (element instanceof XmlAttributeDecl) {
    final PsiElement parent=element.getParent();
    final PsiElement previousComment=findPreviousComment(parent);
    final String referenceName=((XmlAttributeDecl)element).getNameElement().getText();
    if (previousComment instanceof PsiComment) {
      final PsiElement prevSibling=previousComment.getPrevSibling();
      if (prevSibling == null || (prevSibling instanceof PsiWhiteSpace && prevSibling.getText().indexOf('\n') >= 0)) {
        return formatDocFromComment(previousComment,referenceName);
      }
    }
    return findDocRightAfterElement(parent,referenceName);
  }
 else   if (element instanceof XmlEntityDecl) {
    final XmlEntityDecl entityDecl=(XmlEntityDecl)element;
    return findDocRightAfterElement(element,entityDecl.getName());
  }
  return super.generateDoc(element,originalElement);
}
