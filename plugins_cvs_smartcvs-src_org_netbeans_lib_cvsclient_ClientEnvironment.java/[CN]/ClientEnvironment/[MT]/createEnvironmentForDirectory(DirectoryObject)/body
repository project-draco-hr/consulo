{
  IConnection connection=cvsRootProvider.getConnection(directory,cvsFileSystem);
  if (connection == null)   return null;
  CvsRoot cvsRoot=cvsRootProvider.getCvsRoot(directory,cvsFileSystem);
  if (cvsRoot == null)   return null;
  return new ClientEnvironment(connection,cvsFileSystem.getLocalFileSystem().getFile(directory),cvsFileSystem.getAdminFileSystem().getFile(directory),cvsRoot,getLocalFileReader(),getLocalFileWriter(),getAdminReader(),getAdminWriter(),getIgnoreFileFilter(),getFileReadOnlyHandler(),getCharset(),cvsRootProvider);
}
