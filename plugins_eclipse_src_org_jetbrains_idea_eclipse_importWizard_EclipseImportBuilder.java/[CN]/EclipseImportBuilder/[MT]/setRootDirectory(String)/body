{
  ProgressManager.getInstance().run(new Task.Modal(getCurrentProject(),EclipseBundle.message("eclipse.import.scanning"),true){
    public void run(    @NotNull ProgressIndicator indicator){
      final ArrayList<String> roots=new ArrayList<String>();
      EclipseProjectFinder.findModuleRoots(roots,path,new Processor<String>(){
        @Override public boolean process(        String path){
          final ProgressIndicator progressIndicator=ProgressManager.getInstance().getProgressIndicator();
          if (progressIndicator != null) {
            if (progressIndicator.isCanceled())             return false;
            progressIndicator.setText2(path);
          }
          return true;
        }
      }
);
      Collections.sort(roots,new Comparator<String>(){
        @Override public int compare(        String path1,        String path2){
          final String projectName1=EclipseProjectFinder.findProjectName(path1);
          final String projectName2=EclipseProjectFinder.findProjectName(path2);
          return projectName1 != null && projectName2 != null ? projectName1.compareToIgnoreCase(projectName2) : 0;
        }
      }
);
      getParameters().workspace=roots;
      getParameters().root=path;
    }
    public void onCancel(){
      getParameters().workspace=null;
      getParameters().root=null;
    }
  }
);
  return getParameters().workspace != null;
}
