{
  final FileChooserDescriptor descriptor=new FileChooserDescriptor(false,true,false,false,false,false){
    public void validateSelectedFiles(    VirtualFile[] files) throws Exception {
      if (files.length != 0) {
        boolean valid=sdkType.isValidSdkHome(files[0].getPath());
        if (!valid) {
          if (SystemInfo.isMac) {
            valid=sdkType.isValidSdkHome(files[0].getPath() + MAC_HOME_PATH);
          }
          if (!valid) {
            throw new Exception(ProjectBundle.message("sdk.configure.home.invalid.error",sdkType.getPresentableName()));
          }
        }
      }
    }
  }
;
  descriptor.setTitle(ProjectBundle.message("sdk.configure.home.title",sdkType.getPresentableName()));
  VirtualFile[] files=FileChooser.chooseFiles(parentComponent,descriptor,getSuggestedSdkRoot(sdkType));
  if (files.length != 0) {
    final String path=files[0].getPath();
    if (sdkType.isValidSdkHome(path))     return path;
    return SystemInfo.isMac && sdkType.isValidSdkHome(path + MAC_HOME_PATH) ? path + MAC_HOME_PATH : null;
  }
  return null;
}
