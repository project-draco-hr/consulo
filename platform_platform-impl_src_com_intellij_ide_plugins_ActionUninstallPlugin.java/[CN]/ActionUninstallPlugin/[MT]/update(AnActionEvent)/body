{
  Presentation presentation=e.getPresentation();
  if (!pluginTable.isShowing()) {
    presentation.setEnabled(false);
    return;
  }
  IdeaPluginDescriptor[] selection=pluginTable.getSelectedObjects();
  boolean enabled=(selection != null);
  if (enabled) {
    for (    IdeaPluginDescriptor descriptor : selection) {
      if (descriptor instanceof IdeaPluginDescriptorImpl) {
        final IdeaPluginDescriptorImpl ideaPluginDescriptor=(IdeaPluginDescriptorImpl)descriptor;
        if (ideaPluginDescriptor.isDeleted() || ideaPluginDescriptor.isBundled()) {
          enabled=false;
          break;
        }
      }
      if (descriptor instanceof PluginNode) {
        enabled&=PluginManagerColumnInfo.getRealNodeState((PluginNode)descriptor) == PluginNode.STATUS_DOWNLOADED;
      }
    }
  }
  presentation.setEnabled(enabled);
}
