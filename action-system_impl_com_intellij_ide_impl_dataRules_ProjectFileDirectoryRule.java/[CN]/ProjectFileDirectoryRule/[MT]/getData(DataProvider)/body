{
  VirtualFile dir=(VirtualFile)dataProvider.getData(DataConstantsEx.PROJECT_FILE_DIRECTORY);
  if (dir == null) {
    final Project project=(Project)dataProvider.getData(DataConstants.PROJECT);
    if (project != null) {
      final VirtualFile projectFile=project.getProjectFile();
      if (projectFile != null && projectFile.isValid()) {
        dir=projectFile.getParent();
      }
    }
  }
  return dir;
}
