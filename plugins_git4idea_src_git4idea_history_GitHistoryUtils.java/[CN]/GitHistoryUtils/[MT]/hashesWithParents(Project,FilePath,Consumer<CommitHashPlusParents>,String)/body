{
  path=getLastCommitName(project,path);
  final VirtualFile root=GitUtil.getGitRoot(path);
  GitSimpleHandler h=new GitSimpleHandler(project,root,GitCommand.LOG);
  h.setNoSSH(true);
  h.setStdoutSuppressed(true);
  h.addParameters(parameters);
  h.addParameters("--name-only","--pretty=format:%x01%h%x00%ct%x00%p","--encoding=UTF-8");
  h.endOptions();
  h.addRelativePaths(path);
  String output=h.run();
  final List<CommitHashPlusParents> rc=new ArrayList<CommitHashPlusParents>();
  StringTokenizer tk=new StringTokenizer(output,"\u0001",false);
  while (tk.hasMoreTokens()) {
    final String line=tk.nextToken();
    final String[] subLines=line.split("\n");
    final StringTokenizer tk2=new StringTokenizer(subLines[0],"\u0000",false);
    final String hash=tk2.nextToken();
    final long time;
    if (tk2.hasMoreTokens()) {
      final String dateString=tk2.nextToken();
      time=Long.parseLong(dateString.trim());
    }
 else {
      time=0;
    }
    final String[] parents;
    if (tk2.hasMoreTokens()) {
      parents=tk2.nextToken().split(" ");
    }
 else {
      parents=ArrayUtil.EMPTY_STRING_ARRAY;
    }
    consumer.consume(new CommitHashPlusParents(hash,parents,time));
  }
}
