{
  if (options.isUsages) {
    ReferencesSearch.search(element,options.searchScope,false).forEach(new ReadActionProcessor<PsiReference>(){
      public boolean processInReadAction(      final PsiReference ref){
        TextRange rangeInElement=ref.getRangeInElement();
        return processor.process(new UsageInfo(ref.getElement(),rangeInElement.getStartOffset(),rangeInElement.getEndOffset(),false));
      }
    }
);
  }
  if (options.isSearchForTextOccurences && options.searchScope instanceof GlobalSearchScope) {
    processUsages(element,processor,options);
  }
}
