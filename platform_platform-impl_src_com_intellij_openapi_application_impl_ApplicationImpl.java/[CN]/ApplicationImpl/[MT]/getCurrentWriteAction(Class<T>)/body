{
  assertCanRunWriteAction();
  for (int i=myWriteActionsStack.size() - 1; i >= 0; i--) {
    Runnable action=myWriteActionsStack.get(i);
    if (actionClass == null || ReflectionCache.isAssignable(actionClass,action.getClass()))     return (T)action;
  }
  return null;
}
