{
  if (myHandlingInitComponentError) {
    return;
  }
  myHandlingInitComponentError=true;
  try {
    PluginId pluginId=config == null ? PluginManagerCore.getPluginByClassName(componentClassName) : config.getPluginId();
    if (pluginId != null) {
      LOG.warn(ex);
      @NonNls final String errorMessage="Plugin " + pluginId.getIdString() + " failed to initialize and will be disabled:\n"+ ex.getMessage()+ "\nPlease restart "+ ApplicationNamesInfo.getInstance().getFullProductName()+ ".";
      PluginManagerCore.disablePlugin(pluginId.getIdString());
      if (!myHeadlessMode) {
        JOptionPane.showMessageDialog(null,errorMessage);
      }
 else       if (!isUnitTestMode()) {
        System.out.println(errorMessage);
        System.exit(1);
      }
      return;
    }
    if (fatal) {
      LOG.error(ex);
      @NonNls final String errorMessage="Fatal error initializing class " + componentClassName + ":\n"+ StringUtil.trimLog(ex.toString(),239)+ "\nComplete error stacktrace was written to "+ PathManager.getLogPath()+ "/idea.log";
      if (!myHeadlessMode) {
        JOptionPane.showMessageDialog(null,errorMessage);
      }
 else {
        System.out.println(errorMessage);
      }
    }
    super.handleInitComponentError(ex,fatal,componentClassName,config);
  }
  finally {
    myHandlingInitComponentError=false;
  }
}
