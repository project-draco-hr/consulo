{
  final boolean hasUnsafeBgTasks=ProgressManager.getInstance().hasUnsafeProgressIndicator();
  if (hasUnsafeBgTasks || GeneralSettings.getInstance().isConfirmExit()) {
    String message=ApplicationBundle.message(hasUnsafeBgTasks ? "exit.confirm.prompt.tasks" : "exit.confirm.prompt",ApplicationNamesInfo.getInstance().getFullProductName());
    if (DialogWrapper.OK_EXIT_CODE != Messages.showYesNoDialog(message,ApplicationBundle.message("exit.confirm.title"),ApplicationBundle.message("command.exit"),"Cancel",Messages.getQuestionIcon())) {
      return false;
    }
  }
  return true;
}
