{
  final Component frame=UIUtil.findUltimateParent(window);
  if (frame instanceof IdeFrame) {
    final IdeFrame ideFrame=(IdeFrame)frame;
    if (isActive() != active) {
      myActive=Boolean.valueOf(active);
      System.setProperty("idea.active",Boolean.valueOf(myActive).toString());
      ApplicationActivationListener publisher=getMessageBus().syncPublisher(ApplicationActivationListener.TOPIC);
      if (active) {
        publisher.applicationActivated(ideFrame);
      }
 else {
        publisher.applicationDeactivated(ideFrame);
      }
      return true;
    }
  }
  return false;
}
