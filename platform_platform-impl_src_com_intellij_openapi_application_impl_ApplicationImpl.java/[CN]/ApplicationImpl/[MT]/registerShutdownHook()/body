{
  ShutDownTracker.getInstance();
  ShutDownTracker.getInstance().registerShutdownTask(new Runnable(){
    public void run(){
      if (isDisposed() || isDisposeInProgress()) {
        return;
      }
      try {
        SwingUtilities.invokeAndWait(new Runnable(){
          public void run(){
            ApplicationManagerEx.setApplication(ApplicationImpl.this);
            try {
              saveAll();
            }
  finally {
              disposeSelf();
            }
          }
        }
);
      }
 catch (      InterruptedException e) {
        LOG.error(e);
      }
catch (      InvocationTargetException e) {
        LOG.error(e);
      }
    }
  }
);
}
