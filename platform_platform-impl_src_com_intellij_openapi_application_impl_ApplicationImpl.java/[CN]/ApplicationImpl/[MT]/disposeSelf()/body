{
  myDisposeInProgress=true;
  final CommandProcessor commandProcessor=CommandProcessor.getInstance();
  final Ref<Boolean> canClose=new Ref<Boolean>(Boolean.TRUE);
  for (  final Project project : ProjectManagerEx.getInstanceEx().getOpenProjects()) {
    try {
      commandProcessor.executeCommand(project,new Runnable(){
        public void run(){
          canClose.set(ProjectUtil.closeAndDispose(project));
        }
      }
,ApplicationBundle.message("command.exit"),null);
    }
 catch (    Throwable e) {
      LOG.error(e);
    }
    if (!canClose.get()) {
      myDisposeInProgress=false;
      return false;
    }
  }
  Disposer.dispose(this);
  Disposer.assertIsEmpty();
  return true;
}
