{
  for (Iterator iterator=elements.iterator(); iterator.hasNext(); ) {
    PsiElement element=(PsiElement)iterator.next();
    if (!result.contains(element)) {
      if (LOG.isDebugEnabled()) {
        LOG.debug(element.toString());
      }
      result.add(element);
      if (sourceElement != null) {
        HashSet<PsiElement> relations=relationMap.get(element);
        if (relations == null) {
          relations=new HashSet<PsiElement>();
          relationMap.put(element,relations);
        }
        relations.add(sourceElement);
      }
      if (recurse && !mySelectedAbstract.contains(element)) {
        buildDeps(element,myMemberDependenciesStorage.getMemberDependencies(element),result,relationMap,myRecursive);
      }
    }
  }
}
