{
  final GrReferenceExpression qualifier=getQualifier();
  if (qualifier == null) {
    GroovyPsiElement context=PsiTreeUtil.getParentOfType(this,GrTypeDefinition.class,GroovyFileBase.class);
    if (context instanceof GrTypeDefinition) {
      final PsiClass superClass=((GrTypeDefinition)context).getSuperClass();
      if (superClass != null) {
        return JavaPsiFacade.getInstance(getProject()).getElementFactory().createType(superClass);
      }
    }
 else     if (context instanceof GroovyFileBase) {
      PsiClass scriptClass=((GroovyFileBase)context).getScriptClass();
      if (scriptClass != null) {
        PsiClass superClass=scriptClass.getSuperClass();
        if (superClass != null) {
          return JavaPsiFacade.getInstance(getProject()).getElementFactory().createType(superClass);
        }
      }
      return GrClassImplUtil.getGroovyObjectType(this);
    }
  }
 else {
    final PsiElement resolved=qualifier.resolve();
    if (resolved instanceof PsiClass) {
      return getSuperType((PsiClass)resolved);
    }
  }
  return null;
}
