{
  ApplicationManager.getApplication().assertIsDispatchThread();
  RangeHighlighterEx highlighter=isPersistent ? new PersistentRangeHighlighterImpl(this,startOffset,layer,targetArea,textAttributes) : new RangeHighlighterImpl(this,startOffset,endOffset,layer,targetArea,textAttributes,false,false);
  myCachedHighlighters=null;
  if (changeAttributesAction != null) {
    ((RangeHighlighterImpl)highlighter).changeAttributesNoEvents(changeAttributesAction);
  }
  fireAfterAdded(highlighter);
  return highlighter;
}
