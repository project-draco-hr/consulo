{
  final Set<XmlFile> files=getFilesToMerge(element);
  final XmlFile xmlFile=element.getRoot().getFile();
  if (xmlFile != null) {
    files.add(xmlFile);
  }
  ArrayList<T> roots=new ArrayList<T>(files.size());
  for (  XmlFile file : files) {
    roots.add(element.getManager().<T>getFileElement(file).getRootElement());
  }
  if (roots.size() == 1) {
    return roots.iterator().next();
  }
  if (myMerger == null) {
    myMerger=element.getManager().createModelMerger();
  }
  return myMerger.mergeModels(getRootElementClass(),roots);
}
