{
  try {
    progress.setText("Updating [" + i.getId() + "]");
    if (i.isRemote()) {
      IndexingContext c=myContexts.get(i);
      Proxy proxy=myEmbedder.getSettings().getActiveProxy();
      ProxyInfo proxyInfo=null;
      if (proxy != null) {
        proxyInfo=new ProxyInfo();
        proxyInfo.setHost(proxy.getHost());
        proxyInfo.setPort(proxy.getPort());
        proxyInfo.setNonProxyHosts(proxy.getNonProxyHosts());
        proxyInfo.setUserName(proxy.getUsername());
        proxyInfo.setPassword(proxy.getPassword());
      }
      progress.setIndeterminate(false);
      myUpdater.fetchAndUpdateIndex(c,new TransferListenerAdapter(progress),proxyInfo);
    }
 else {
      progress.setIndeterminate(true);
      deleteContext(myContexts.get(i));
      IndexingContext c=createContext(i);
      myContexts.put(i,c);
      myIndexer.scan(c);
    }
  }
 catch (  IOException e) {
    throw new MavenRepositoryException(e);
  }
catch (  UnsupportedExistingLuceneIndexException e) {
    throw new MavenRepositoryException(e);
  }
}
