{
  final EditorColorsScheme colorsScheme=EditorColorsManager.getInstance().getGlobalScheme();
  if (colorsScheme instanceof DefaultColorsScheme) {
    final int res=Messages.showYesNoCancelDialog(myPanel,InspectionsBundle.message("highlight.severity.default.color.scheme.warning"),ApplicationBundle.message("title.cannot.modify.default.scheme"),Messages.getQuestionIcon());
    if (res == DialogWrapper.OK_EXIT_CODE) {
      ShowSettingsUtil.getInstance().editConfigurable(myPanel,ApplicationManager.getApplication().getComponent(ColorAndFontOptions.class));
      return;
    }
 else     if (res != DialogWrapper.CANCEL_EXIT_CODE) {
      return;
    }
  }
  processListValueChanged((MyHighlightInfoTypeWithAtrributesDescription)myOptionsList.getSelectedValue(),true);
  final Collection<HighlightInfoType.HighlightInfoTypeImpl> infoTypes=new HashSet<HighlightInfoType.HighlightInfoTypeImpl>(SeverityRegistrar.getRegisteredHighlightingInfoTypes());
  Set<HighlightInfoType.HighlightInfoTypeImpl> currentTypes=new HashSet<HighlightInfoType.HighlightInfoTypeImpl>();
  final ListModel listModel=myOptionsList.getModel();
  for (int i=0; i < listModel.getSize(); i++) {
    final MyHighlightInfoTypeWithAtrributesDescription info=(MyHighlightInfoTypeWithAtrributesDescription)listModel.getElementAt(i);
    info.getSeverity().setVal((listModel.getSize() - i) * 100);
    if (!isDefaultSetting(info.getHighlightInfoType())) {
      currentTypes.add(info.getHighlightInfoType());
      final Color stripeColor=info.getAttributes().getErrorStripeColor();
      SeverityRegistrar.registerSeverity(info.getHighlightInfoType(),stripeColor != null ? stripeColor : LightColors.YELLOW);
    }
    colorsScheme.setAttributes(info.getHighlightInfoType().getAttributesKey(),info.getAttributes());
  }
  infoTypes.removeAll(currentTypes);
  for (  HighlightInfoType.HighlightInfoTypeImpl info : infoTypes) {
    SeverityRegistrar.unregisterSeverity(info.getSeverity(null));
  }
  super.doOKAction();
}
