{
  PsiBuilder.Marker refElement=builder.mark();
  if (annotations) {
    DeclarationParser.parseAnnotations(builder);
  }
  if (!expect(builder,JavaTokenType.IDENTIFIER)) {
    refElement.rollbackTo();
    return null;
  }
  if (parameterList) {
    typeInfo.isParameterized=(builder.getTokenType() == JavaTokenType.LT);
    parseReferenceParameterList(builder,true);
  }
 else {
    emptyElement(builder,JavaElementType.REFERENCE_PARAMETER_LIST);
  }
  boolean hasIdentifier;
  while (builder.getTokenType() == JavaTokenType.DOT) {
    refElement.done(JavaElementType.JAVA_CODE_REFERENCE);
    final PsiBuilder.Marker dotPos=builder.mark();
    builder.advanceLexer();
    if (expect(builder,JavaTokenType.IDENTIFIER)) {
      hasIdentifier=true;
    }
 else {
      if (!eatLastDot) {
        dotPos.rollbackTo();
        return refElement;
      }
      hasIdentifier=false;
    }
    dotPos.drop();
    refElement=refElement.precede();
    if (!hasIdentifier) {
      error(builder,JavaErrorMessages.message("expected.identifier"));
      break;
    }
    if (parameterList) {
      typeInfo.isParameterized=(builder.getTokenType() == JavaTokenType.LT);
      parseReferenceParameterList(builder,true);
    }
 else {
      emptyElement(builder,JavaElementType.REFERENCE_PARAMETER_LIST);
    }
  }
  refElement.done(JavaElementType.JAVA_CODE_REFERENCE);
  return refElement;
}
