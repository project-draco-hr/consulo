{
  if (myInRebuildList)   return;
  try {
    myInRebuildList=true;
    if (myChangesToDisplay == null) {
      final ChangeListManager manager=ChangeListManager.getInstance(myProject);
      myChangeListsMap=new HashMap<Change,LocalChangeList>();
      final List<LocalChangeList> lists=manager.getChangeListsCopy();
      Collection<Change> allChanges=new ArrayList<Change>();
      for (      LocalChangeList list : lists) {
        final Collection<Change> changes=list.getChanges();
        allChanges.addAll(changes);
        for (        Change change : changes) {
          myChangeListsMap.put(change,list);
        }
      }
      myAllChanges=allChanges;
      updateListsInChooser();
    }
    super.rebuildList();
  }
  finally {
    myInRebuildList=false;
  }
}
