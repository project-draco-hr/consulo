{
  myKeymapListModel.removeAllElements();
  KeymapManagerEx keymapManager=KeymapManagerEx.getInstanceEx();
  Keymap[] keymaps=keymapManager.getAllKeymaps();
  for (  Keymap keymap1 : keymaps) {
    KeymapImpl keymap=(KeymapImpl)keymap1;
    if (keymap.canModify()) {
      keymap=keymap.copy();
    }
    myKeymapListModel.addElement(keymap);
    if (keymapManager.getActiveKeymap() == keymap1) {
      myActiveKeymap=keymap;
    }
  }
  if (myKeymapListModel.getSize() == 0) {
    KeymapImpl keymap=new KeymapImpl();
    keymap.setName(KeyMapBundle.message("keymap.no.name"));
    myKeymapListModel.addElement(keymap);
  }
  myQuickListsModel.removeAllElements();
  QuickList[] allQuickLists=QuickListsManager.getInstance().getAllQuickLists();
  for (  QuickList list : allQuickLists) {
    myQuickListsModel.addElement(list);
  }
  mySelectedKeymap=(KeymapImpl)myKeymapListModel.elementAt(0);
  myKeymapList.setSelectedValue(myActiveKeymap,true);
}
