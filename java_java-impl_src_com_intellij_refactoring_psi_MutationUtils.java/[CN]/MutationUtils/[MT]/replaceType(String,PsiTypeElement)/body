{
  final PsiManager mgr=typeElement.getManager();
  final PsiElementFactory factory=JavaPsiFacade.getInstance(mgr.getProject()).getElementFactory();
  final PsiType newType=factory.createTypeFromText(newExpression,null);
  final PsiTypeElement newTypeElement=factory.createTypeElement(newType);
  final PsiElement insertedElement=typeElement.replace(newTypeElement);
  final CodeStyleManager codeStyleManager=mgr.getCodeStyleManager();
  final PsiElement shortenedElement=JavaCodeStyleManager.getInstance(mgr.getProject()).shortenClassReferences(insertedElement);
  codeStyleManager.reformat(shortenedElement);
}
