{
  final INameEnvironment environment=getEnvironment();
  Compiler batchCompiler=new Compiler(environment,getHandlingPolicy(),getCompilerOptions(),getBatchRequestor(),getProblemFactory());
  batchCompiler.compile(getCompilationUnits());
synchronized (END_OF_STREAM) {
    myCompilationResults.offer(END_OF_STREAM);
    END_OF_STREAM.wait();
  }
  environment.cleanup();
}
