{
synchronized (PsiLock.LOCK) {
    ASTNode child=scope.getFirstChildNode();
    while (child != null) {
      if (child instanceof LeafElement && ((LeafElement)child).isChameleon()) {
        LeafElement leaf=(LeafElement)child;
        if (leaf.searchWord(0,searcher) >= 0) {
          ASTNode next=child.getTreeNext();
          child=ChameleonTransforming.transform((LeafElement)child);
          if (child == null) {
            child=next;
          }
          continue;
        }
      }
      child=child.getTreeNext();
    }
  }
  ASTNode child=null;
  while (true) {
synchronized (PsiLock.LOCK) {
      child=child != null ? child.getTreeNext() : scope.getFirstChildNode();
      while (child instanceof LeafElement && ((LeafElement)child).isChameleon()) {
        child=child.getTreeNext();
      }
      if (child == null)       break;
    }
    if (!processElementsContainingWordInElement(processor,child,searcher,progress,searchContext)) {
      return false;
    }
  }
  return true;
}
