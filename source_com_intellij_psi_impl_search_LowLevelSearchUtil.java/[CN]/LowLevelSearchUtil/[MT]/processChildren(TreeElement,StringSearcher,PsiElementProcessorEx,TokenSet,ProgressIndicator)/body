{
synchronized (PsiLock.LOCK) {
    TreeElement child=((CompositeElement)scope).firstChild;
    while (child != null) {
      if (child instanceof ChameleonElement) {
        LeafElement leaf=(LeafElement)child;
        if (leaf.searchWord(0,searcher) >= 0) {
          TreeElement next=child.getTreeNext();
          child=ChameleonTransforming.transform((ChameleonElement)child);
          if (child == null) {
            child=next;
          }
          continue;
        }
      }
      child=child.getTreeNext();
    }
  }
  TreeElement child=null;
  while (true) {
synchronized (PsiLock.LOCK) {
      child=child != null ? child.getTreeNext() : ((CompositeElement)scope).firstChild;
      while (child instanceof ChameleonElement) {
        child=child.getTreeNext();
      }
      if (child == null)       break;
    }
    if (!processElementsContainingWordInElement(processor,child,searcher,elementTypes,progress))     return false;
  }
  return true;
}
