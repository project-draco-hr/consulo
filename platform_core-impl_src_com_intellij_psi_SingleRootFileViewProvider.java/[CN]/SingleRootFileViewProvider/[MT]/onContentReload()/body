{
  List<PsiFile> files=getCachedPsiFiles();
  List<PsiTreeChangeEventImpl> events=ContainerUtil.newArrayList();
  List<PsiTreeChangeEventImpl> genericEvents=ContainerUtil.newArrayList();
  for (  PsiFile file : files) {
    genericEvents.add(createChildrenChangeEvent(file,true));
    events.add(createChildrenChangeEvent(file,false));
  }
  beforeContentsSynchronized();
  for (  PsiTreeChangeEventImpl event : genericEvents) {
    ((PsiManagerImpl)getManager()).beforeChildrenChange(event);
  }
  for (  PsiTreeChangeEventImpl event : events) {
    ((PsiManagerImpl)getManager()).beforeChildrenChange(event);
  }
  for (  PsiFile psiFile : files) {
    if (psiFile instanceof PsiFileEx) {
      ((PsiFileEx)psiFile).onContentReload();
    }
  }
  for (  PsiTreeChangeEventImpl event : events) {
    ((PsiManagerImpl)getManager()).childrenChanged(event);
  }
  for (  PsiTreeChangeEventImpl event : genericEvents) {
    ((PsiManagerImpl)getManager()).childrenChanged(event);
  }
  contentsSynchronized();
}
