def get_caps(self):
    if (self.caps is None):
        try:
            self.caps = set(self.do_read('capabilities').split())
        except error.RepoError:
            self.caps = set()
        self.ui.debug(('capabilities: %s\n' % ' '.join((self.caps or ['none']))))
    return self.caps
