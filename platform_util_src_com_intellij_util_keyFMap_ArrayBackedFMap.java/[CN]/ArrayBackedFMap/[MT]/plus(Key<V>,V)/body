{
  int oldSize=size();
  int keyCode=key.hashCode();
  int[] newKeys=null;
  Object[] newValues=null;
  int i;
  for (i=0; i < oldSize; i++) {
    int oldKey=keys[i];
    if (keyCode == oldKey) {
      if (value == values[i])       return this;
      newKeys=new int[oldSize];
      newValues=new Object[oldSize];
      System.arraycopy(keys,0,newKeys,0,oldSize);
      System.arraycopy(values,0,newValues,0,oldSize);
      newValues[i]=value;
      break;
    }
  }
  if (i == oldSize) {
    if (oldSize == ARRAY_THRESHOLD) {
      return new MapBackedFMap(keys,keyCode,values,value);
    }
    int newSize=oldSize + 1;
    newKeys=new int[newSize];
    newValues=new Object[newSize];
    System.arraycopy(keys,0,newKeys,0,oldSize);
    System.arraycopy(values,0,newValues,0,oldSize);
    newKeys[oldSize]=keyCode;
    newValues[oldSize]=value;
  }
  return new ArrayBackedFMap(newKeys,newValues);
}
