{
  Collection<String> rejectedBranches=simplePushResult.getRejectedBranches();
  Map<GitBranch,GitPushBranchResult> resultMap=new HashMap<GitBranch,GitPushBranchResult>();
  GitCommitsByBranch commitsByBranch=commits.get(repository);
  boolean pushedBranchWasRejected=false;
  for (  GitBranch branch : commitsByBranch.getBranches()) {
    GitPushBranchResult branchResult;
    if (branchInRejected(branch,rejectedBranches)) {
      branchResult=GitPushBranchResult.rejected();
      pushedBranchWasRejected=true;
    }
 else {
      branchResult=successfulResultForBranch(commitsByBranch,branch);
    }
    resultMap.put(branch,branchResult);
  }
  if (pushedBranchWasRejected) {
    return GitPushRepoResult.someRejected(resultMap,simplePushResult.getOutput());
  }
 else {
    return GitPushRepoResult.success(resultMap,simplePushResult.getOutput());
  }
}
