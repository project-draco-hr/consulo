{
  if (pushSpec.getDest() == NO_TARGET_BRANCH) {
    return GitSimplePushResult.notPushed();
  }
  GitRemote remote=pushSpec.getDest().getRemote();
  String httpUrl=null;
  for (  String pushUrl : remote.getPushUrls()) {
    if (GitHttpAdapter.shouldUseJGit(pushUrl)) {
      httpUrl=pushUrl;
      break;
    }
  }
  GitSimplePushResult pushResult;
  boolean pushOverHttp=httpUrl != null;
  if (pushOverHttp) {
    pushResult=GitHttpAdapter.push(repository,remote.getName(),httpUrl,formPushSpec(pushSpec,remote));
  }
 else {
    pushResult=pushNatively(repository,pushSpec);
  }
  if (pushResult.getType() == GitSimplePushResult.Type.SUCCESS) {
    setUpstream(repository,pushSpec.getSource(),pushSpec.getDest().getRemote(),pushSpec.getDest());
  }
  return pushResult;
}
