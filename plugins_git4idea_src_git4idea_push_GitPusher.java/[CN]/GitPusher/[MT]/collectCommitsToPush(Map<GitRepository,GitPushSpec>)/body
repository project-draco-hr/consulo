{
  Map<GitRepository,List<GitBranchPair>> reposAndBranchesToPush=prepareRepositoriesAndBranchesToPush(pushSpecs);
  Map<GitRepository,GitCommitsByBranch> commitsByRepoAndBranch=new HashMap<GitRepository,GitCommitsByBranch>();
  for (  GitRepository repository : myRepositories) {
    List<GitBranchPair> branchPairs=reposAndBranchesToPush.get(repository);
    if (branchPairs == null) {
      continue;
    }
    GitCommitsByBranch commitsByBranch=collectsCommitsToPush(repository,branchPairs);
    commitsByRepoAndBranch.put(repository,commitsByBranch);
  }
  return new GitCommitsByRepoAndBranch(commitsByRepoAndBranch);
}
