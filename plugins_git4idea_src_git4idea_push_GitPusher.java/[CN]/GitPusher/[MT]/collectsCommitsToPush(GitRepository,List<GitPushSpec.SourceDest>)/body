{
  Map<GitBranch,List<GitCommit>> commitsByBranch=new HashMap<GitBranch,List<GitCommit>>();
  for (  GitPushSpec.SourceDest sourceDest : sourcesDestinations) {
    GitReference source=sourceDest.getSource();
    List<GitCommit> commits=collectCommitsToPush(repository,source.getName(),sourceDest.getDest().getName());
    if (!commits.isEmpty()) {
      commitsByBranch.put((GitBranch)source,commits);
    }
  }
  return new GitCommitsByBranch(commitsByBranch);
}
