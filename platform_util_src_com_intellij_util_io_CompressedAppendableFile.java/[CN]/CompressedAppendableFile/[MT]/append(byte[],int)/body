{
  if (size == 0)   return;
  if (myNextChunkBuffer == null)   loadAppendBuffer();
  int newBufferSize=calcBufferSize(myBufferPosition + size);
  if (newBufferSize != myNextChunkBuffer.length) {
    myNextChunkBuffer=Arrays.copyOf(myNextChunkBuffer,newBufferSize);
  }
  int bufferPosition=0;
  int sizeToWrite=size;
  while (sizeToWrite > 0) {
    int bytesToWriteInTheBuffer=Math.min(myNextChunkBuffer.length - myBufferPosition,sizeToWrite);
    System.arraycopy(buffer,bufferPosition,myNextChunkBuffer,myBufferPosition,bytesToWriteInTheBuffer);
    myBufferPosition+=bytesToWriteInTheBuffer;
    bufferPosition+=bytesToWriteInTheBuffer;
    sizeToWrite-=bytesToWriteInTheBuffer;
    saveNextChunkIfNeeded();
  }
  myUncompressedFileLength+=size;
  myDirty=true;
}
