{
  if (bytesFromCompressedBlock == null) {
    byte[] decompressedBytes=myCurrentPageNumber < myChunkLengthTableSnapshotLength ? ourDecompressedCache.get(CompressedAppendableFile.this,myCurrentPageNumber) : ArrayUtil.EMPTY_BYTE_ARRAY;
    bytesFromCompressedBlock=new ByteArrayInputStream(decompressedBytes,myPageOffset,decompressedBytes.length);
  }
  int readBytesCount=0;
  if (bytesFromCompressedBlock.available() > 0) {
    readBytesCount=bytesFromCompressedBlock.read(b,off,len);
    myPageOffset+=readBytesCount;
    if (myPageOffset == myAppendBufferLength) {
      ++myCurrentPageNumber;
      myPageOffset=0;
    }
    if (readBytesCount == len)     return readBytesCount;
  }
  while (myCurrentPageNumber < myChunkLengthTableSnapshotLength) {
    byte[] decompressedBytes=ourDecompressedCache.get(CompressedAppendableFile.this,myCurrentPageNumber);
    bytesFromCompressedBlock=new ByteArrayInputStream(decompressedBytes,0,decompressedBytes.length);
    int read=bytesFromCompressedBlock.read(b,off + readBytesCount,len - readBytesCount);
    myPageOffset+=read;
    if (myPageOffset == myAppendBufferLength) {
      ++myCurrentPageNumber;
      myPageOffset=0;
    }
    readBytesCount+=read;
    if (readBytesCount == len)     return readBytesCount;
  }
  if (bytesFromTempAppendBlock == null) {
    bytesFromTempAppendBlock=new ByteArrayInputStream(myNextChunkBufferSnapshot,myPageOffset,myBufferPositionSnapshot);
  }
  return readBytesCount + bytesFromTempAppendBlock.read(b,off + readBytesCount,len - readBytesCount);
}
