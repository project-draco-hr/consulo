{
synchronized (PsiLock.LOCK) {
    final Map<String,CachedValue<XmlEntityDecl>> cachingMap=getCachingMap(file);
    final String name=decl.getName();
    cachingMap.put(name,file.getManager().getCachedValuesManager().createCachedValue(new CachedValueProvider<XmlEntityDecl>(){
      public Result<XmlEntityDecl> compute(){
        if (decl.isValid() && name.equals(decl.getName()))         return new Result<XmlEntityDecl>(decl,decl);
        cachingMap.put(name,null);
        return new Result<XmlEntityDecl>(null,null);
      }
    }
,false));
  }
}
