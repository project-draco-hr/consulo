{
  UIDefaults defaults=UIManager.getDefaults();
  Enumeration<Object> keys=defaults.keys();
  if (inPresentation) {
    while (keys.hasMoreElements()) {
      Object key=keys.nextElement();
      if (key instanceof String) {
        String name=(String)key;
        if (name.endsWith(".font")) {
          Font font=defaults.getFont(key);
          ourSavedValues.put(key,font);
        }
 else         if (name.endsWith(".rowHeight")) {
          ourSavedValues.put(key,defaults.getInt(key));
        }
      }
    }
    float scaleFactor=settings.PRESENTATION_MODE_FONT_SIZE / 12f;
    ourSavedScaleFactor=JBUI.scale(1f);
    JBUI.setScaleFactor(scaleFactor);
    for (    Object key : ourSavedValues.keySet()) {
      Object v=ourSavedValues.get(key);
      if (v instanceof Font) {
        Font font=(Font)v;
        defaults.put(key,new FontUIResource(font.getName(),font.getStyle(),JBUI.scale(font.getSize())));
      }
 else       if (v instanceof Integer) {
        defaults.put(key,JBUI.scale(((Integer)v).intValue()));
      }
    }
  }
 else {
    for (    Object key : ourSavedValues.keySet()) {
      defaults.put(key,ourSavedValues.get(key));
    }
    JBUI.setScaleFactor(ourSavedScaleFactor);
    ourSavedValues.clear();
  }
}
