{
  UISettings settings=UISettings.getInstance();
  Project project=e.getProject();
  if (project != null) {
    HideAllToolWindowsAction.performAction(project);
  }
  settings.PRESENTATION_MODE=!settings.PRESENTATION_MODE;
  settings.fireUISettingsChanged();
  if (project != null) {
    Window frame=IdeFrameImpl.getActiveFrame();
    if (frame instanceof IdeFrameImpl) {
      final PropertiesComponent propertiesComponent=PropertiesComponent.getInstance(project);
      if (settings.PRESENTATION_MODE) {
        propertiesComponent.setValue("full.screen.before.presentation.mode",String.valueOf(((IdeFrameImpl)frame).isInFullScreen()));
        ((IdeFrameImpl)frame).toggleFullScreen(true);
      }
 else {
        final String value=propertiesComponent.getValue("full.screen.before.presentation.mode");
        ((IdeFrameImpl)frame).toggleFullScreen("true".equalsIgnoreCase(value));
      }
    }
  }
  EditorUtil.reinitSettings();
}
