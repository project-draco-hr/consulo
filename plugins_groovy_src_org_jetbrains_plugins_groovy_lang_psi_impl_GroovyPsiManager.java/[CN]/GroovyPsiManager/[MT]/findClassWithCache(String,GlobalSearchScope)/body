{
  SoftReference<Map<GlobalSearchScope,PsiClass>> reference=myClassCache.get(fqName);
  Map<GlobalSearchScope,PsiClass> map=reference == null ? null : reference.get();
  if (map == null) {
    map=new ConcurrentHashMap<GlobalSearchScope,PsiClass>();
    myClassCache.put(fqName,new SoftReference<Map<GlobalSearchScope,PsiClass>>(map));
  }
  PsiClass cached=map.get(resolveScope);
  if (cached != null) {
    return cached;
  }
  PsiClass result=JavaPsiFacade.getInstance(myProject).findClass(fqName,resolveScope);
  if (result != null) {
    map.put(resolveScope,result);
  }
  return result;
}
