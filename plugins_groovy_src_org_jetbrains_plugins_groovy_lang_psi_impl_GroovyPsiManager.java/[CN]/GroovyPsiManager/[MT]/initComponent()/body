{
  ((PsiManagerEx)PsiManager.getInstance(myProject)).registerRunnableToRunOnAnyChange(new Runnable(){
    public void run(){
      myCalculatedTypes.clear();
    }
  }
);
  StartupManager.getInstance(myProject).registerPostStartupActivity(new Runnable(){
    public void run(){
      fillDefaultGroovyMethods();
    }
  }
);
  myRootConnection=myProject.getMessageBus().connect();
  ModuleRootListener moduleRootListener=new ModuleRootListener(){
    public void beforeRootsChange(    ModuleRootEvent event){
    }
    public void rootsChanged(    ModuleRootEvent event){
      if (!ApplicationManager.getApplication().isUnitTestMode() && myProject.isInitialized()) {
        ApplicationManager.getApplication().invokeLater(new Runnable(){
          public void run(){
            fillDefaultGroovyMethods();
          }
        }
);
      }
    }
  }
;
  myRootConnection.subscribe(ProjectTopics.PROJECT_ROOTS,moduleRootListener);
}
