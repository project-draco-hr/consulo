{
  String path=file.getPath();
  try {
    if (file.isInLocalFileSystem()) {
      if (SystemInfo.isWindows && path.charAt(0) != '/') {
        path='/' + path;
      }
      return new URI(file.getFileSystem().getProtocol(),"",path,null,null);
    }
    return new URI(file.getFileSystem().getProtocol(),path,null);
  }
 catch (  URISyntaxException e) {
    throw new IllegalArgumentException(e);
  }
}
