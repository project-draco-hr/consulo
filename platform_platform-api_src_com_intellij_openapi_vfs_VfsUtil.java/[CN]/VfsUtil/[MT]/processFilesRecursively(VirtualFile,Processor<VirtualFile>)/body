{
  if (!processor.process(root))   return false;
  if (root.isDirectory()) {
    final LinkedList<VirtualFile[]> queue=new LinkedList<VirtualFile[]>();
    queue.add(root.getChildren());
    do {
      final VirtualFile[] files=queue.removeFirst();
      for (      VirtualFile file : files) {
        if (!processor.process(file))         return false;
        if (file.isDirectory()) {
          queue.add(file.getChildren());
        }
      }
    }
 while (!queue.isEmpty());
  }
  return true;
}
