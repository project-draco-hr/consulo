{
  List<VirtualFile> result=null;
  for (  VirtualFile child : dir.getChildren()) {
    if (filter.accept(child)) {
      if (result == null)       result=ContainerUtil.newSmartList();
      result.add(child);
    }
  }
  return result != null ? result : ContainerUtil.<VirtualFile>emptyList();
}
