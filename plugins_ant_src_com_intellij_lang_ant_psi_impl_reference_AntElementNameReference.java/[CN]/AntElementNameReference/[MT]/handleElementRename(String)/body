{
  final AntStructuredElement element=getElement();
  final AntTypeDefinition typeDef=element.getTypeDefinition();
  if (typeDef == null)   return element;
  if (!(element instanceof AntTask)) {
    final AntStructuredElement defElement=(AntStructuredElement)typeDef.getDefiningElement();
    if (defElement != null && (defElement instanceof AntPresetDef || (defElement.getParent() instanceof AntMacroDef && "element".equals(defElement.getSourceElement().getName())))) {
      element.getSourceElement().setName(newElementName);
    }
  }
 else {
    AntTask task=(AntTask)element;
    if (task.isMacroDefined() || task.isPresetDefined()) {
      final XmlAttribute attr=getAttribute();
      if (attr == null) {
        task.getSourceElement().setName(newElementName);
      }
 else {
        attr.setName(newElementName);
      }
    }
  }
  return element;
}
