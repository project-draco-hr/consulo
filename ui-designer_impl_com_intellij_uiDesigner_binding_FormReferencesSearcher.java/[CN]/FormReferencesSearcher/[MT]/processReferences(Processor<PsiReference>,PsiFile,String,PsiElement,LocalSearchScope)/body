{
  if (filterScope != null) {
    boolean isInScope=false;
    for (    PsiElement filterElement : filterScope.getScope()) {
      if (PsiTreeUtil.isAncestor(filterElement,file,false)) {
        isInScope=true;
        break;
      }
    }
    if (!isInScope)     return true;
  }
  CharSequence chars=file.getViewProvider().getContents();
  int index=0;
  final int offset=name.lastIndexOf('.');
  while (true) {
    index=CharArrayUtil.indexOf(chars,name,index);
    if (index < 0)     break;
    PsiReference ref=file.findReferenceAt(index + offset + 1);
    if (ref != null && ref.isReferenceTo(element)) {
      if (!processor.process(ref))       return false;
    }
    index++;
  }
  return true;
}
