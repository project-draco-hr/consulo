{
  myProfiles=new ArrayList<String>();
  MavenEmbedderWrapper e=MavenEmbedderFactory.createEmbedderForRead(getCoreState());
  try {
    for (    VirtualFile f : myFiles) {
      MavenProjectHolder holder=MavenReader.readProject(e,f,new ArrayList<String>());
      if (!holder.isValid)       continue;
      Set<String> profiles=new LinkedHashSet<String>();
      ProjectUtil.collectProfileIds(holder.mavenProject.getModel(),profiles);
      if (!profiles.isEmpty())       myProfiles.addAll(profiles);
    }
  }
 catch (  CanceledException ignore) {
  }
 finally {
    e.release();
  }
}
