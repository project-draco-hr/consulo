{
  final Ref<T> created=Ref.create(null);
  myDialog.getKindCombo().setSelectedName(selectedTemplateName);
  myDialog.myCreator=new ElementCreator(myProject,errorTitle){
    @Override protected void checkBeforeCreate(    String newName) throws IncorrectOperationException {
      creator.checkBeforeCreate(newName,myDialog.getKindCombo().getSelectedName());
    }
    @Override protected PsiElement[] create(    String newName) throws Exception {
      final T element=creator.createFile(myDialog.getEnteredName(),myDialog.getKindCombo().getSelectedName());
      created.set(element);
      if (element != null) {
        return new PsiElement[]{element};
      }
      return PsiElement.EMPTY_ARRAY;
    }
    @Override protected String getActionName(    String newName){
      return creator.getActionName(newName,myDialog.getKindCombo().getSelectedName());
    }
  }
;
  myDialog.show();
  if (myDialog.getExitCode() == OK_EXIT_CODE) {
    return created.get();
  }
  return null;
}
