{
  if (embeddedLexer != null) {
    return embeddedLexer.getTokenType();
  }
 else {
    IElementType tokenType=super.getTokenType();
    if (tokenType == null)     return tokenType;
    if (tokenType == XmlTokenType.XML_NAME) {
      final int state=getState() & BASE_STATE_MASK;
      if (isHtmlTagState(state)) {
        tokenType=XmlTokenType.XML_TAG_NAME;
      }
    }
 else     if (tokenType == XmlTokenType.XML_WHITE_SPACE) {
      tokenType=(getState() != 0) ? XmlTokenType.TAG_WHITE_SPACE : XmlTokenType.XML_REAL_WHITE_SPACE;
    }
    return tokenType;
  }
}
