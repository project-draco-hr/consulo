{
  if (!hasSeenStyle() && !hasSeenScript() || hasNoEmbeddments)   return;
  final IElementType tokenType=lexer.getTokenType();
  if ((tokenType == XmlTokenType.XML_ATTRIBUTE_VALUE_TOKEN && hasSeenAttribute()) || (tokenType == XmlTokenType.XML_DATA_CHARACTERS && hasSeenTag()) || tokenType == XmlTokenType.XML_COMMENT_CHARACTERS && hasSeenTag()) {
    setEmbeddedLexer();
    if (embeddedLexer != null) {
      embeddedLexer.start(getBufferSequence(),HtmlHighlightingLexer.super.getTokenStart(),skipToTheEndOfTheEmbeddment(),embeddedLexer instanceof EmbedmentLexer ? ((EmbedmentLexer)embeddedLexer).getEmbeddedInitialState(tokenType) : 0);
      if (embeddedLexer.getTokenType() == null) {
        embeddedLexer=null;
      }
    }
  }
}
