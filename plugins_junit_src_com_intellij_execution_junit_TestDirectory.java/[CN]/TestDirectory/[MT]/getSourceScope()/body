{
  final String dirName=myConfiguration.getPersistentData().getDirName();
  final VirtualFile file=LocalFileSystem.getInstance().findFileByPath(FileUtil.toSystemIndependentName(dirName));
  final GlobalSearchScope globalSearchScope=file == null ? GlobalSearchScope.EMPTY_SCOPE : GlobalSearchScopes.directoryScope(myProject,file,true);
  return new SourceScope(){
    @Override public GlobalSearchScope getGlobalSearchScope(){
      return globalSearchScope;
    }
    @Override public Project getProject(){
      return myProject;
    }
    @Override public GlobalSearchScope getLibrariesScope(){
      final Module module=myConfiguration.getConfigurationModule().getModule();
      LOG.assertTrue(module != null);
      return GlobalSearchScope.moduleWithLibrariesScope(module);
    }
    @Override public Module[] getModulesToCompile(){
      final Collection<Module> validModules=myConfiguration.getValidModules();
      return validModules.toArray(new Module[validModules.size()]);
    }
  }
;
}
