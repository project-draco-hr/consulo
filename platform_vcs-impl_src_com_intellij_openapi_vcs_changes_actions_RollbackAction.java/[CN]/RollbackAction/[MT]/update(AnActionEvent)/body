{
  Project project=e.getData(PlatformDataKeys.PROJECT);
  final boolean visible=project != null && ProjectLevelVcsManager.getInstance(project).hasActiveVcss();
  e.getPresentation().setVisible(visible);
  if (!visible)   return;
  final Change[] leadSelection=e.getData(VcsDataKeys.CHANGE_LEAD_SELECTION);
  boolean isEnabled=(leadSelection != null && leadSelection.length > 0) || Boolean.TRUE.equals(e.getData(VcsDataKeys.HAVE_LOCALLY_DELETED)) || Boolean.TRUE.equals(e.getData(VcsDataKeys.HAVE_MODIFIED_WITHOUT_EDITING))|| Boolean.TRUE.equals(e.getData(VcsDataKeys.HAVE_SELECTED_CHANGES))|| hasReversibleFiles(e,project);
  e.getPresentation().setEnabled(isEnabled);
  String operationName=RollbackUtil.getRollbackOperationName(project);
  e.getPresentation().setText(operationName + "...");
  if (isEnabled) {
    e.getPresentation().setDescription(UIUtil.removeMnemonic(operationName) + " selected changes");
  }
}
