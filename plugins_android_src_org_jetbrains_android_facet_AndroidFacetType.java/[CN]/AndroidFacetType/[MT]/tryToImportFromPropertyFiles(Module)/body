{
  final String targetHashString=getPropertyValue(module,SdkConstants.FN_DEFAULT_PROPERTIES,"target");
  if (targetHashString == null) {
    return false;
  }
  String sdkDir=getPropertyValue(module,SdkConstants.FN_LOCAL_PROPERTIES,"sdk.dir");
  if (sdkDir != null) {
    sdkDir=FileUtil.toSystemIndependentName(sdkDir);
  }
  final Sdk sdk=findSuitableAndroidSdk(targetHashString,sdkDir);
  if (sdk != null) {
    setSdk(module,sdk);
    return true;
  }
  if (sdkDir != null && tryToCreateAndSetAndroidSdk(module,sdkDir,targetHashString)) {
    return true;
  }
  final String androidHomeValue=System.getenv(AndroidSdkUtils.ANDROID_HOME_ENV);
  if (androidHomeValue != null && tryToCreateAndSetAndroidSdk(module,FileUtil.toSystemIndependentName(androidHomeValue),targetHashString)) {
    return true;
  }
  for (  String dir : AndroidSdkUtils.getAndroidSdkPathsFromExistingPlatforms()) {
    if (tryToCreateAndSetAndroidSdk(module,dir,targetHashString)) {
      return true;
    }
  }
  return false;
}
