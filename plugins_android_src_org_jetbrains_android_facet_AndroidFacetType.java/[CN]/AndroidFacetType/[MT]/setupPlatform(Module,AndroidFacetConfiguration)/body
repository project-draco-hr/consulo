{
  for (  OrderEntry entry : ModuleRootManager.getInstance(module).getOrderEntries()) {
    if (entry instanceof LibraryOrderEntry) {
      LibraryOrderEntry libEntry=(LibraryOrderEntry)entry;
      Library library=libEntry.getLibrary();
      if (library != null && LibraryTablesRegistrar.APPLICATION_LEVEL.equals(libEntry.getLibraryLevel()) && tryToSetAndroidPlatform(configuration,library)) {
        return;
      }
    }
  }
  PropertiesComponent component=PropertiesComponent.getInstance();
  LibraryTable libraryTable=LibraryTablesRegistrar.getInstance().getLibraryTable();
  if (component.isValueSet(AndroidSdkUtils.DEFAULT_PLATFORM_NAME_PROPERTY)) {
    Library defaultLib=libraryTable.getLibraryByName(component.getValue(AndroidSdkUtils.DEFAULT_PLATFORM_NAME_PROPERTY));
    if (defaultLib != null && tryToSetAndroidPlatform(configuration,defaultLib)) {
      return;
    }
    for (    Library library : libraryTable.getLibraries()) {
      if (tryToSetAndroidPlatform(configuration,library)) {
        component.setValue(AndroidSdkUtils.DEFAULT_PLATFORM_NAME_PROPERTY,library.getName());
        return;
      }
    }
  }
}
