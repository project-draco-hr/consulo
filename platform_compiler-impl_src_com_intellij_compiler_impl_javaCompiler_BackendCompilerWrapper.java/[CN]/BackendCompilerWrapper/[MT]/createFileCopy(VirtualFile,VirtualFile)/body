{
  final String fileName=file.getName();
  if (tempDir.findChild(fileName) != null) {
    int idx=0;
    while (true) {
      final String dirName="dir" + idx++;
      final VirtualFile dir=tempDir.findChild(dirName);
      if (dir == null) {
        tempDir=tempDir.createChildDirectory(this,dirName);
        break;
      }
      if (dir.findChild(fileName) == null) {
        tempDir=dir;
        break;
      }
    }
  }
  return VfsUtilCore.copyFile(this,file,tempDir);
}
