{
  PsiElement targetElement=TargetElementUtil.findTargetElement(editor,TargetElementUtil.REFERENCED_ELEMENT_ACCEPTED | TargetElementUtil.ELEMENT_NAME_ACCEPTED | TargetElementUtil.LOOKUP_ITEM_ACCEPTED,offset);
  PsiType type=null;
  if (targetElement instanceof PsiVariable) {
    type=((PsiVariable)targetElement).getType();
  }
 else   if (targetElement instanceof PsiMethod) {
    type=((PsiMethod)targetElement).getReturnType();
  }
 else {
    return null;
  }
  if (type == null)   return null;
  return PsiUtil.resolveClassInType(type);
}
