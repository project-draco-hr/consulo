{
  assertDispatchThread();
  if (isInternalMode) {
    recordCommand(command,new Throwable(),forced);
  }
  final ActionCallback result=new ActionCallback();
  myActivityMonitor.addActivity(FOCUS,ModalityState.any());
  if (!forced) {
    if (!myFocusRequests.contains(command)) {
      myFocusRequests.add(command);
    }
    SwingUtilities.invokeLater(new Runnable(){
      public void run(){
        resetUnforcedCommand(command);
        _requestFocus(command,forced,result);
      }
    }
);
  }
 else {
    _requestFocus(command,forced,result);
  }
  result.doWhenProcessed(new Runnable(){
    public void run(){
      restartIdleAlarm();
    }
  }
);
  return result;
}
