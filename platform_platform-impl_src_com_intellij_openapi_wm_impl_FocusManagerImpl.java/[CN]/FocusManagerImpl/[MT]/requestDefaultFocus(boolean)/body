{
  Component toFocus=null;
  if (myLastFocusedFrame != null) {
    WeakReference<Component> c=myLastFocused.get(myLastFocusedFrame);
    if (c != null && c.get() != null && c.get().isShowing()) {
      toFocus=c.get();
    }
 else {
      toFocus=getFocusTargetFor(myLastFocusedFrame.getComponent());
    }
  }
 else {
    Window[] windows=Window.getWindows();
    for (    Window each : windows) {
      if (each.isActive()) {
        if (each instanceof JFrame) {
          toFocus=getFocusTargetFor(((JFrame)each).getRootPane());
          break;
        }
 else         if (each instanceof JDialog) {
          toFocus=getFocusTargetFor(((JDialog)each).getRootPane());
          break;
        }
 else         if (each instanceof JWindow) {
          toFocus=getFocusTargetFor(((JWindow)each).getRootPane());
          break;
        }
      }
    }
  }
  if (toFocus != null) {
    return requestFocus(new FocusCommand.ByComponent(toFocus).setToInvalidateRequestors(false),forced);
  }
  return new ActionCallback.Done();
}
