{
  List<AnAction> newVisibleActions=ContainerUtil.newArrayListWithCapacity(myVisibleActions.size());
  DataContext dataContext=DataManager.getInstance().getDataContext(this);
  Utils.expandActionGroup(myActionGroup,newVisibleActions,myPresentationFactory,dataContext,ActionPlaces.TOOLWINDOW_TITLE,myUpdater.getActionManager(),transparentOnly);
  if (forced || !newVisibleActions.equals(myVisibleActions)) {
    myVisibleActions=newVisibleActions;
    myButtonPanel.removeAll();
    boolean actionAdded=false;
    for (    final AnAction action : newVisibleActions) {
      if (action == null)       continue;
      final Presentation presentation=myPresentationFactory.getPresentation(action);
      myButtonPanel.add(new ActionButton(action,presentation.getIcon()){
        @Override protected Icon getActiveHoveredIcon(){
          Icon icon=presentation.getHoveredIcon();
          return icon != null ? icon : super.getActiveHoveredIcon();
        }
      }
);
      myButtonPanel.add(Box.createHorizontalStrut(9));
      actionAdded=true;
    }
    if (actionAdded) {
      myButtonPanel.add(new JLabel(AllIcons.General.Divider));
      myButtonPanel.add(Box.createHorizontalStrut(6));
    }
    addDefaultActions(myButtonPanel);
    revalidate();
    repaint();
  }
}
