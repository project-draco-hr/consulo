{
  if (tree.isExpanded(new TreePath(node.getPath()))) {
    List<PackagingTreeNode> children=node.getChildren();
    if (!children.isEmpty()) {
      PackagingNodeState nodeState=new PackagingNodeState(node.getOutputFileName());
      for (      PackagingTreeNode child : children) {
        PackagingNodeState childState=saveState(tree,child);
        if (childState != null) {
          nodeState.addChild(childState);
        }
      }
      return nodeState;
    }
  }
  return null;
}
