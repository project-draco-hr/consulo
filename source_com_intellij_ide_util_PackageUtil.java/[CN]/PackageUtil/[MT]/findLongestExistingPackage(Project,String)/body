{
  PsiManager manager=PsiManager.getInstance(project);
  String nameToMatch=packageName;
  while (true) {
    PsiPackage aPackage=JavaPsiFacade.getInstance(manager.getProject()).findPackage(nameToMatch);
    if (aPackage != null && isWritablePackage(aPackage))     return aPackage;
    int lastDotIndex=nameToMatch.lastIndexOf(".");
    if (lastDotIndex >= 0) {
      nameToMatch=nameToMatch.substring(0,lastDotIndex);
    }
 else {
      return null;
    }
  }
}
