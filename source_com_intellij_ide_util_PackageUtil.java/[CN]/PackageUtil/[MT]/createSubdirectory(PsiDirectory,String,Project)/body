{
  final PsiDirectory[] psiDirectory=new PsiDirectory[1];
  final IncorrectOperationException[] exception=new IncorrectOperationException[1];
  CommandProcessor.getInstance().executeCommand(project,new Runnable(){
    public void run(){
      psiDirectory[0]=ApplicationManager.getApplication().runWriteAction(new Computable<PsiDirectory>(){
        public PsiDirectory compute(){
          try {
            return oldDirectory.createSubdirectory(name);
          }
 catch (          IncorrectOperationException e) {
            exception[0]=e;
            return null;
          }
        }
      }
);
    }
  }
,IdeBundle.message("command.create.new.subdirectory"),null);
  if (exception[0] != null)   throw exception[0];
  return psiDirectory[0];
}
