{
  final PsiType bound=wildcardType.getBound();
  if (bound == null) {
    return wildcardType;
  }
 else {
    final PsiType newBound=bound.accept(this);
    if (newBound == null) {
      return null;
    }
    if (newBound instanceof PsiWildcardType) {
      return handleBoundComposition(wildcardType,(PsiWildcardType)newBound);
    }
    if (newBound instanceof PsiCapturedWildcardType && wildcardType.isExtends() != ((PsiCapturedWildcardType)newBound).getWildcard().isExtends()) {
      return handleBoundComposition(wildcardType,((PsiCapturedWildcardType)newBound).getWildcard());
    }
    return PsiWildcardType.changeBound(wildcardType,newBound);
  }
}
