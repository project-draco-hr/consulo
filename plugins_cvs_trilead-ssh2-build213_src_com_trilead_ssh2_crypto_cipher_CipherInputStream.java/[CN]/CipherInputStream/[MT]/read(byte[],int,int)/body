{
  int count=0;
  while (len > 0) {
    if (pos >= blockSize)     getBlock();
    int avail=blockSize - pos;
    int copy=Math.min(avail,len);
    System.arraycopy(buffer,pos,dst,off,copy);
    pos+=copy;
    off+=copy;
    len-=copy;
    count+=copy;
  }
  return count;
}
