{
  if (input_buffer_size < 0)   return -1;
  if (input_buffer_pos >= input_buffer_size) {
    if (fill_buffer() <= 0)     return -1;
  }
  int avail=input_buffer_size - input_buffer_pos;
  int thiscopy=(len > avail) ? avail : len;
  System.arraycopy(input_buffer,input_buffer_pos,b,off,thiscopy);
  input_buffer_pos+=thiscopy;
  return thiscopy;
}
