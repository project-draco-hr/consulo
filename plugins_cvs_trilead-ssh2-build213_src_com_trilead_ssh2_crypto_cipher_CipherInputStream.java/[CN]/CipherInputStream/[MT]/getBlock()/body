{
  int n=0;
  while (n < blockSize) {
    int len=internal_read(enc,n,blockSize - n);
    if (len < 0)     throw new IOException("Cannot read full block, EOF reached.");
    n+=len;
  }
  try {
    currentCipher.transformBlock(enc,0,buffer,0);
  }
 catch (  Exception e) {
    throw new IOException("Error while decrypting block.");
  }
  pos=0;
}
