{
  if (pos != blockSize)   throw new IOException("Cannot read plain since crypto buffer is not aligned.");
  int n=0;
  while (n < len) {
    int cnt=internal_read(b,off + n,len - n);
    if (cnt < 0)     throw new IOException("Cannot fill buffer, EOF reached.");
    n+=cnt;
  }
  return n;
}
