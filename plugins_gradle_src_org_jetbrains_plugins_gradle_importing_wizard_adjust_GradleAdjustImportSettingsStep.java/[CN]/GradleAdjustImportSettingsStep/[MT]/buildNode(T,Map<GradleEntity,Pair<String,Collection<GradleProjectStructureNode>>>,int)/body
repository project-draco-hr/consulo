{
  GradleProjectStructureNode result=new GradleProjectStructureNode(myFactory.buildDescriptor(entity));
  Pair<String,Collection<GradleProjectStructureNode>> pair=processed.get(entity);
  if (pair == null) {
    String cardName=String.valueOf(counter);
    List<GradleProjectStructureNode> nodes=new ArrayList<GradleProjectStructureNode>();
    nodes.add(result);
    processed.put(entity,new Pair<String,Collection<GradleProjectStructureNode>>(cardName,nodes));
    GradleProjectStructureNodeSettings settings=myFactory.buildSettings(entity,myTreeModel,nodes);
    myCards.put(result,new Pair<String,GradleProjectStructureNodeSettings>(cardName,settings));
    mySettingsPanel.add(settings.getComponent(),cardName);
  }
 else {
    pair.second.add(result);
    for (    GradleProjectStructureNode node : pair.second) {
      Pair<String,GradleProjectStructureNodeSettings> settingsPair=myCards.get(node);
      if (settingsPair != null) {
        myCards.put(result,settingsPair);
        break;
      }
    }
  }
  return result;
}
