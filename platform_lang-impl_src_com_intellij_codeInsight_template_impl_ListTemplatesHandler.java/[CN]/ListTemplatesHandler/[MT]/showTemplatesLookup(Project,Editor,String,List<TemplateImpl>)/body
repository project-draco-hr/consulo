{
  final LookupImpl lookup=(LookupImpl)LookupManager.getInstance(project).createLookup(editor,LookupElement.EMPTY_ARRAY,prefix,LookupArranger.DEFAULT);
  lookup.setArranger(new LookupArranger(){
    @Override public Classifier<LookupElement> createRelevanceClassifier(){
      return new ComparingClassifier<LookupElement>(ClassifierFactory.<LookupElement>listClassifier(),"preferPrefix"){
        @NotNull @Override public Comparable getWeight(        LookupElement element){
          return !element.getLookupString().startsWith(lookup.itemPattern(element));
        }
      }
;
    }
  }
);
  for (  TemplateImpl template : matchingTemplates) {
    lookup.addItem(createTemplateElement(template),new PlainPrefixMatcher(prefix));
  }
  showLookup(lookup,null);
}
