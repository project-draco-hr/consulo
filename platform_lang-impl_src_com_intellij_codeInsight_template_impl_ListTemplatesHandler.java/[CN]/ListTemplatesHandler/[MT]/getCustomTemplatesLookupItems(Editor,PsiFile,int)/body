{
  final MultiMap<String,CustomLiveTemplateLookupElement> result=MultiMap.create();
  CustomTemplateCallback customTemplateCallback=new CustomTemplateCallback(editor,file);
  for (  CustomLiveTemplate customLiveTemplate : TemplateManagerImpl.listApplicableCustomTemplates(editor,file,false)) {
    if (customLiveTemplate instanceof CustomLiveTemplateBase) {
      String customTemplatePrefix=((CustomLiveTemplateBase)customLiveTemplate).computeTemplateKeyWithoutContextChecking(customTemplateCallback);
      if (customTemplatePrefix != null) {
        result.putValues(customTemplatePrefix,((CustomLiveTemplateBase)customLiveTemplate).getLookupElements(file,editor,offset));
      }
    }
  }
  return result;
}
