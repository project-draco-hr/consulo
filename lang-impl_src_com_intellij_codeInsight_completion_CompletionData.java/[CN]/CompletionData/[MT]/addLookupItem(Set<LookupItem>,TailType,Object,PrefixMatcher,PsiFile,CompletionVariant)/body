{
  LookupItem ret=LookupItemUtil.objectToLookupItem(completion);
  if (ret == null)   return null;
  final InsertHandler insertHandler=variant.getInsertHandler();
  if (insertHandler != null && ret.getInsertHandler() == null) {
    ret.setAttribute(LookupItem.INSERT_HANDLER_ATTR,insertHandler);
    ret.setTailType(TailType.UNKNOWN);
  }
 else   if (tailType != TailType.NONE) {
    ret.setTailType(tailType);
  }
  if (matcher.prefixMatches(ret)) {
    set.add(ret);
    return ret;
  }
  return null;
}
