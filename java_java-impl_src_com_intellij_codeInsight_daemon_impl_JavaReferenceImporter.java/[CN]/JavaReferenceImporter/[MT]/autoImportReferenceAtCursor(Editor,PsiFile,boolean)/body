{
  if (!file.getViewProvider().getLanguages().contains(StdLanguages.JAVA))   return false;
  int caretOffset=editor.getCaretModel().getOffset();
  Document document=editor.getDocument();
  int lineNumber=document.getLineNumber(caretOffset);
  int startOffset=document.getLineStartOffset(lineNumber);
  int endOffset=document.getLineEndOffset(lineNumber);
  List<PsiElement> elements=CollectHighlightsUtil.getElementsInRange(file,startOffset,endOffset);
  for (  PsiElement element : elements) {
    if (element instanceof PsiJavaCodeReferenceElement) {
      PsiJavaCodeReferenceElement ref=(PsiJavaCodeReferenceElement)element;
      if (ref.multiResolve(true).length == 0) {
        new ImportClassFix(ref).doFix(editor,false,allowCaretNearRef);
        return true;
      }
    }
  }
  return false;
}
