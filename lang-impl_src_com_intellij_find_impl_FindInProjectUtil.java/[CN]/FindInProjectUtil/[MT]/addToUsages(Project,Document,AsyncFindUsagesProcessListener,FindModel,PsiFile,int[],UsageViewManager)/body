{
  CharSequence text=document.getCharsSequence();
  if (text == null)   return;
  int textLength=document.getTextLength();
  int offset=0;
  FindManager findManager=FindManager.getInstance(project);
  while (offset < textLength) {
    usageViewManager.checkSearchCanceled();
    FindResult result=findManager.findString(text,offset,findModel);
    if (!result.isStringFound())     break;
    UsageInfo info=new UsageInfo(psiFile,result.getStartOffset(),result.getEndOffset());
    consumer.foundUsage(info);
    count[0]++;
    final int prevOffset=offset;
    offset=result.getEndOffset();
    if (prevOffset == offset) {
      ++offset;
    }
  }
}
