{
  final long[] length=new long[]{-1L};
  ApplicationManager.getApplication().runReadAction(new Runnable(){
    public void run(){
      if (!virtualFile.isValid())       return;
      if (FileTypeManager.getInstance().getFileTypeByFile(virtualFile).isBinary())       return;
      length[0]=virtualFile.getLength();
    }
  }
);
  return length[0];
}
