{
  final PsiPackage aPackage=JavaPsiFacade.getInstance(myProject).findPackage(getTargetPackageName());
  if (aPackage != null) {
    final PsiDirectory[] directories=aPackage.getDirectories(mySourceClass.getResolveScope());
    if (directories.length >= 1) {
      myTargetDirectory=getDirUnderSameSourceRoot(directories);
    }
  }
  myTargetDirectory=PackageUtil.findOrCreateDirectoryForPackage(myProject,getTargetPackageName(),myTargetDirectory,true);
  if (myTargetDirectory == null) {
    throw new OperationFailedException("");
  }
  String error=RefactoringMessageUtil.checkCanCreateClass(myTargetDirectory,getExtractedSuperName());
  if (error != null) {
    throw new OperationFailedException(error);
  }
}
