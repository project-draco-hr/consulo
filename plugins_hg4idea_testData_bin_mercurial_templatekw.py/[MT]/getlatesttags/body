def getlatesttags(repo, ctx, cache):
    'return date, distance and name for the latest tag of rev'
    if ('latesttags' not in cache):
        cache['latesttags'] = {(-1): (0, 0, 'null'), }
    latesttags = cache['latesttags']
    rev = ctx.rev()
    todo = [rev]
    while todo:
        rev = todo.pop()
        if (rev in latesttags):
            continue
        ctx = repo[rev]
        tags = [t for t in ctx.tags() if (repo.tagtype(t) == 'global')]
        if tags:
            latesttags[rev] = (ctx.date()[0], 0, ':'.join(sorted(tags)))
            continue
        try:
            (pdate, pdist, ptag) = max((latesttags[p.rev()] for p in ctx.parents()))
        except KeyError:
            todo.append(rev)
            todo.extend((p.rev() for p in ctx.parents()))
            continue
        latesttags[rev] = (pdate, (pdist + 1), ptag)
    return latesttags[rev]
