{
  location=JavaExecutionUtil.stepIntoSingleClass(location);
  final Project project=location.getProject();
  final PsiElement element=location.getPsiElement();
  final PsiClass aClass=getAppletClass(element,PsiManager.getInstance(project));
  if (aClass == null)   return null;
  RunnerAndConfigurationSettings settings=RunManagerEx.getInstanceEx(project).createConfiguration("",getConfigurationFactories()[0]);
  final AppletConfiguration configuration=(AppletConfiguration)settings.getConfiguration();
  configuration.MAIN_CLASS_NAME=JavaExecutionUtil.getRuntimeQualifiedName(aClass);
  configuration.setModule(new JUnitUtil.ModuleOfClass().convert(aClass));
  configuration.setName(configuration.getGeneratedName());
  return settings;
}
