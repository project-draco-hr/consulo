{
  mySharedProviderList.clear();
  boolean doNotShowTextEditor=false;
  final boolean dumb=DumbService.getInstance().isDumb();
  for (int i=myProviders.size() - 1; i >= 0; i--) {
    FileEditorProvider provider=myProviders.get(i);
    if ((!dumb || provider instanceof DumbAware) && provider.accept(project,file)) {
      mySharedProviderList.add(provider);
      doNotShowTextEditor|=provider.getPolicy() == FileEditorPolicy.HIDE_DEFAULT_EDITOR;
    }
  }
  if (doNotShowTextEditor) {
    for (int i=mySharedProviderList.size() - 1; i >= 0; i--) {
      if (mySharedProviderList.get(i) instanceof TextEditorProvider) {
        mySharedProviderList.remove(i);
      }
    }
  }
  Collections.sort(mySharedProviderList,MyComparator.ourInstance);
  if (!mySharedProviderList.isEmpty()) {
    return mySharedProviderList.toArray(new FileEditorProvider[mySharedProviderList.size()]);
  }
 else {
    return EMPTY_ARRAY;
  }
}
