{
  String host=url.getHost();
  String proxyHost=getServersPropertyIdea(host,"http-proxy-host");
  if ((proxyHost == null) || "".equals(proxyHost.trim())) {
    if (myConfig.isIsUseDefaultProxy()) {
      final HttpConfigurable httpConfigurable=HttpConfigurable.getInstance();
      final String ideaWideProxyHost=httpConfigurable.PROXY_HOST;
      String ideaWideProxyPort=String.valueOf(httpConfigurable.PROXY_PORT);
      if (ideaWideProxyPort == null) {
        ideaWideProxyPort="3128";
      }
      if ((ideaWideProxyHost != null) && (!"".equals(ideaWideProxyHost.trim()))) {
        return new MyPromptingProxyManager(ideaWideProxyHost,ideaWideProxyPort);
      }
    }
    return null;
  }
  String proxyExceptions=getServersPropertyIdea(host,"http-proxy-exceptions");
  String proxyExceptionsSeparator=",";
  if (proxyExceptions == null) {
    proxyExceptions=System.getProperty("http.nonProxyHosts");
    proxyExceptionsSeparator="|";
  }
  if (proxyExceptions != null) {
    for (StringTokenizer exceptions=new StringTokenizer(proxyExceptions,proxyExceptionsSeparator); exceptions.hasMoreTokens(); ) {
      String exception=exceptions.nextToken().trim();
      if (DefaultSVNOptions.matches(exception,host)) {
        return null;
      }
    }
  }
  String proxyPort=getServersPropertyIdea(host,"http-proxy-port");
  String proxyUser=getServersPropertyIdea(host,"http-proxy-username");
  String proxyPassword=getServersPropertyIdea(host,"http-proxy-password");
  return new MySimpleProxyManager(proxyHost,proxyPort,proxyUser,proxyPassword);
}
