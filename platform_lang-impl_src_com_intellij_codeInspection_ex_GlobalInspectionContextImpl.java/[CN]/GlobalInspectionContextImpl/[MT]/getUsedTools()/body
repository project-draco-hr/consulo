{
  InspectionProfileImpl profile=new InspectionProfileImpl((InspectionProfileImpl)getCurrentProfile());
  List<ToolsImpl> tools=profile.getAllEnabledInspectionTools(myProject);
  THashSet<ToolsImpl> set=null;
  for (  ToolsImpl tool : tools) {
    String id=tool.getTool().getMainToolId();
    if (id != null) {
      InspectionProfileEntry mainTool=profile.getInspectionTool(id);
      LOG.assertTrue(mainTool != null,"Can't find main tool: " + id);
      if (set == null) {
        set=new THashSet<ToolsImpl>(tools,TOOLS_HASHING_STRATEGY);
      }
      set.add(new ToolsImpl(mainTool,mainTool.getDefaultLevel(),true));
    }
  }
  return set == null ? tools : new ArrayList<ToolsImpl>(set);
}
