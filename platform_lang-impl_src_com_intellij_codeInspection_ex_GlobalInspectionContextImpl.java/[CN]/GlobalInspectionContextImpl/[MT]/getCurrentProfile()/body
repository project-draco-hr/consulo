{
  if (myExternalProfile != null)   return myExternalProfile;
  InspectionManagerEx managerEx=(InspectionManagerEx)InspectionManager.getInstance(myProject);
  final InspectionProjectProfileManager inspectionProfileManager=InspectionProjectProfileManager.getInstance(myProject);
  Profile profile=inspectionProfileManager.getProfile(managerEx.getCurrentProfile(),false);
  if (profile == null) {
    profile=InspectionProfileManager.getInstance().getProfile(managerEx.getCurrentProfile());
    if (profile != null)     return (InspectionProfile)profile;
    final String[] availableProfileNames=inspectionProfileManager.getAvailableProfileNames();
    if (availableProfileNames == null || availableProfileNames.length == 0) {
      return null;
    }
    profile=inspectionProfileManager.getProfile(availableProfileNames[0]);
  }
  return (InspectionProfile)profile;
}
