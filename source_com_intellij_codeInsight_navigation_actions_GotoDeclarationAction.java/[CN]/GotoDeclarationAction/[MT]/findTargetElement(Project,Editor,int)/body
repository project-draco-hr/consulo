{
  int flags=TargetElementUtil.REFERENCED_ELEMENT_ACCEPTED | TargetElementUtil.NEW_AS_CONSTRUCTOR | TargetElementUtil.LOOKUP_ITEM_ACCEPTED| TargetElementUtil.THIS_ACCEPTED| TargetElementUtil.SUPER_ACCEPTED;
  PsiElement element=TargetElementUtil.findTargetElement(editor,flags,offset);
  if (element instanceof PsiPackage)   return null;
  if (element != null)   return element;
  PsiFile file=PsiDocumentManager.getInstance(project).getPsiFile(editor.getDocument());
  if (file == null) {
    return null;
  }
  PsiElement elementAt=file.findElementAt(offset);
  if (elementAt instanceof PsiKeyword) {
    IElementType type=((PsiKeyword)elementAt).getTokenType();
    if (type == JavaTokenType.CONTINUE_KEYWORD) {
      if (elementAt.getParent() instanceof PsiContinueStatement) {
        PsiStatement statement=((PsiContinueStatement)elementAt.getParent()).findContinuedStatement();
        return statement;
      }
    }
 else     if (type == JavaTokenType.BREAK_KEYWORD) {
      if (elementAt.getParent() instanceof PsiBreakStatement) {
        PsiStatement statement=((PsiBreakStatement)elementAt.getParent()).findExitedStatement();
        if (statement == null)         return null;
        if (statement.getParent() instanceof PsiLabeledStatement) {
          statement=(PsiStatement)statement.getParent();
        }
        PsiElement nextSibling=statement.getNextSibling();
        while (!(nextSibling instanceof PsiStatement) && nextSibling != null)         nextSibling=nextSibling.getNextSibling();
        return nextSibling != null ? nextSibling : statement.getNextSibling();
      }
    }
  }
 else   if (elementAt instanceof PsiIdentifier) {
    PsiElement parent=elementAt.getParent();
    PsiStatement statement=null;
    if (parent instanceof PsiContinueStatement) {
      statement=((PsiContinueStatement)parent).findContinuedStatement();
    }
 else     if (parent instanceof PsiBreakStatement) {
      statement=((PsiBreakStatement)parent).findExitedStatement();
    }
    if (statement == null)     return null;
    LOG.assertTrue(statement.getParent() instanceof PsiLabeledStatement);
    return ((PsiLabeledStatement)statement.getParent()).getLabelIdentifier();
  }
  return null;
}
