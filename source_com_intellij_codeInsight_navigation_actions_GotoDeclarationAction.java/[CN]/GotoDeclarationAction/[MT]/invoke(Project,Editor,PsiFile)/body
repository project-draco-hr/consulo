{
  PsiDocumentManager.getInstance(project).commitAllDocuments();
  int offset=getOffset(editor);
  PsiElement element=findTargetElement(project,editor,offset);
  if (element == null) {
    FeatureUsageTracker.getInstance().triggerFeatureUsed("navigation.goto.declaration");
    chooseAmbigousTarget(project,editor,offset);
    return;
  }
  FeatureUsageTracker.getInstance().triggerFeatureUsed("navigation.goto.declaration");
  PsiElement navElement=element.getNavigationElement();
  if (navElement == element && element instanceof PsiCompiledElement && element instanceof PsiMethod) {
    PsiMethod method=(PsiMethod)element;
    if (method.isConstructor() && method.getParameterList().getParameters().length == 0) {
      PsiClass aClass=method.getContainingClass();
      PsiElement navClass=aClass.getNavigationElement();
      if (aClass != navClass)       navElement=navClass;
    }
  }
  if (navElement instanceof Navigatable) {
    ((Navigatable)navElement).navigate(true);
  }
}
