{
  if (!isNativeFileType(file))   return null;
  final Ext ext=getExtension(file);
  final String filePath=file.getPath();
  Icon icon;
synchronized (myIconCache) {
    if (!myCustomIconExtensions.contains(ext)) {
      icon=ext != null ? myIconCache.get(ext) : null;
    }
 else {
      icon=filePath != null ? myCustomIconCache.get(filePath) : null;
    }
  }
  if (icon != null) {
    return icon;
  }
  final File f=new File(filePath);
  if (!f.exists()) {
    return null;
  }
  try {
    icon=getNativeIcon(f);
  }
 catch (  Exception e) {
    return null;
  }
  if (ext != null) {
synchronized (myIconCache) {
      if (!myCustomIconExtensions.contains(ext)) {
        myIconCache.put(ext,icon);
      }
 else       if (filePath != null) {
        myCustomIconCache.put(filePath,icon);
      }
    }
  }
  return icon;
}
