{
  final PsiManager psiManager=PsiManager.getInstance(myProject);
  final List<VirtualFile> roots=new ArrayList<VirtualFile>();
  final List<VirtualFile> sourceRoots=new ArrayList<VirtualFile>();
  if (module == null) {
    final ProjectRootManager projectRootManager=ProjectRootManager.getInstance(myProject);
    roots.addAll(Arrays.asList(projectRootManager.getContentRoots()));
    sourceRoots.addAll(Arrays.asList(projectRootManager.getContentSourceRoots()));
  }
 else {
    ModuleRootManager moduleRootManager=ModuleRootManager.getInstance(module);
    roots.addAll(Arrays.asList(moduleRootManager.getContentRoots()));
    sourceRoots.addAll(Arrays.asList(moduleRootManager.getSourceRoots()));
  }
  roots.removeAll(sourceRoots);
  for (  VirtualFile dir : roots) {
    final PsiDirectory directory=psiManager.findDirectory(dir);
    if (directory == null) {
      continue;
    }
    final Iterator<PsiFile> files=builder.getFiles(directory);
    if (!files.hasNext())     continue;
    TodoDirNode dirNode=new TodoDirNode(myProject,directory,builder);
    if (!children.contains(dirNode)) {
      children.add(dirNode);
    }
  }
}
