{
  super(elementToRename,editor,elementToRename.getProject(),initialName,oldName);
  mySubstituted=substituted;
  if (mySubstituted != null && mySubstituted != myElementToRename && mySubstituted.getTextRange() != null) {
    final PsiFile containingFile=mySubstituted.getContainingFile();
    if (!notSameFile(containingFile.getVirtualFile(),containingFile)) {
      mySubstitutedRange=myEditor.getDocument().createRangeMarker(mySubstituted.getTextRange());
    }
  }
 else {
    mySubstitutedRange=null;
  }
  showDialogAdvertisement("RenameElement");
}
