{
  if (mySubstituted != null && mySubstituted.isValid())   return mySubstituted;
  if (mySubstitutedRange != null) {
    final PsiFile psiFile=PsiDocumentManager.getInstance(myProject).getPsiFile(myEditor.getDocument());
    if (psiFile != null) {
      return PsiTreeUtil.getParentOfType(psiFile.findElementAt(mySubstitutedRange.getStartOffset()),PsiNameIdentifierOwner.class);
    }
  }
  return getVariable();
}
