{
  extend(CompletionType.BASIC,PsiJavaPatterns.psiElement(PsiDocToken.DOC_TAG_NAME),new TagChooser());
  extend(CompletionType.BASIC,PsiJavaPatterns.psiElement().inside(PsiDocTagValue.class),new CompletionProvider<CompletionParameters>(false,true){
    protected void addCompletions(    @NotNull final CompletionParameters parameters,    final ProcessingContext context,    @NotNull final CompletionResultSet result){
      final PsiElement position=parameters.getPosition();
      boolean isArg=PsiJavaPatterns.psiElement().afterLeaf("(").accepts(position);
      PsiDocTag tag=PsiTreeUtil.getParentOfType(position,PsiDocTag.class);
      boolean onlyConstants=!isArg && tag != null && tag.getName().equals(VALUE_TAG);
      final PsiReference ref=position.getContainingFile().findReferenceAt(parameters.getOffset());
      if (ref != null) {
        for (        final LookupElement item : JavaSmartCompletionContributor.completeReference(position,ref,parameters.getOriginalFile(),TailType.NONE,TrueFilter.INSTANCE,result)) {
          if (onlyConstants) {
            Object o=item.getObject();
            if (!(o instanceof PsiField))             continue;
            PsiField field=(PsiField)o;
            if (!(field.hasModifierProperty(PsiModifier.STATIC) && field.getInitializer() != null && ConstantExpressionEvaluator.computeConstantExpression(field.getInitializer(),false) != null))             continue;
          }
          ((LookupItem)item).setAttribute(LookupItem.FORCE_SHOW_SIGNATURE_ATTR,Boolean.TRUE);
          if (isArg) {
            ((LookupItem)item).setAutoCompletionPolicy(AutoCompletionPolicy.NEVER_AUTOCOMPLETE);
          }
          ((LookupItem)item).setInsertHandler(new MethodSignatureInsertHandler());
          result.addElement(item);
        }
      }
    }
  }
);
}
