{
  if (isLocal() && myFile != null) {
    try {
      Element root=new Element(ROOT_ELEMENT_TAG);
      root.setAttribute(PROFILE_NAME_TAG,myName);
      writeExternal(root);
      myVisibleTreeState.writeExternal(root);
      JDOMUtil.writeDocument(new Document(root),myFile,CodeStyleSettingsManager.getSettings(null).getLineSeparator());
    }
 catch (    WriteExternalException e) {
      LOG.error(e);
    }
catch (    IOException e) {
      LOG.error(e);
    }
  }
  InspectionProfileManager.getInstance().fireProfileChanged(this);
}
