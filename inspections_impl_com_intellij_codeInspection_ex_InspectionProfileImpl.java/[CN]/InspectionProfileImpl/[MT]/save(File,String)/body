{
  try {
    Element root=new Element(ROOT_ELEMENT_TAG);
    root.setAttribute(PROFILE_NAME_TAG,name);
    writeExternal(root);
    myVisibleTreeState.writeExternal(root);
    if (file != null) {
      JDOMUtil.writeDocument(new Document(root),file,CodeStyleSettingsManager.getSettings(null).getLineSeparator());
    }
  }
 catch (  WriteExternalException e) {
    LOG.error(e);
  }
catch (  IOException e) {
    LOG.error(e);
  }
}
