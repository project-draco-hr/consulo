{
  try {
    Element root=new Element("designer");
    root.setAttribute("target",myDesigner.getPlatformTarget());
    List<RadComponent> components=RadComponent.getPureSelection(getArea(dataContext).getSelection());
    RadComponent rootComponent=myDesigner.getRootComponent();
    if (rootComponent instanceof IComponentCopyProvider) {
      IComponentCopyProvider copyProvider=(IComponentCopyProvider)rootComponent;
      copyProvider.copyTo(root,components);
    }
 else {
      for (      RadComponent component : components) {
        component.copyTo(root);
      }
    }
    SerializedComponentData data=new SerializedComponentData(new XMLOutputter().outputString(root));
    CopyPasteManager.getInstance().setContents(new SimpleTransferable(data,DATA_FLAVOR));
    return true;
  }
 catch (  Throwable e) {
    myDesigner.showError("Copy error",e);
    return false;
  }
}
