{
  JPanel scrollablePanel=new JPanel(new GridBagLayout());
  scrollablePanel.setBackground(UIUtil.getListBackground());
  GridBagConstraints gc=new GridBagConstraints(GridBagConstraints.RELATIVE,1,1,1,0,1,GridBagConstraints.WEST,GridBagConstraints.NONE,new Insets(0,0,0,0),0,0);
  int width=0;
  int widthToTheRight=0;
  final int wholeWidth=getWidth();
  if (mySelectedIndex != -1) {
    for (int i=0; i < myList.size(); i++) {
      final JLabel linkLabel=myList.get(i);
      final int labelWidth=linkLabel.getFontMetrics(linkLabel.getFont()).stringWidth(linkLabel.getText());
      width+=labelWidth;
      if (i + 1 > myFirstIndex) {
        widthToTheRight+=labelWidth;
        if (widthToTheRight < wholeWidth) {
          scrollablePanel.add(linkLabel,gc);
        }
      }
    }
    gc.weightx=1;
    gc.fill=GridBagConstraints.HORIZONTAL;
    scrollablePanel.add(Box.createHorizontalBox(),gc);
  }
 else   if (!myModel.isEmpty()) {
    scrollablePanel.setComponentOrientation(ComponentOrientation.RIGHT_TO_LEFT);
    gc.weightx=1;
    gc.fill=GridBagConstraints.HORIZONTAL;
    scrollablePanel.add(Box.createHorizontalBox(),gc);
    gc.weightx=0;
    gc.fill=GridBagConstraints.NONE;
    final JLabel preselected=myList.get(myModel.size() - 1);
    installDottedBorder(preselected);
    for (int i=myModel.size() - 1; i >= 0; i--) {
      final JLabel linkLabel=myList.get(i);
      width+=linkLabel.getFontMetrics(linkLabel.getFont()).stringWidth(linkLabel.getText());
      if (width > wholeWidth) {
        myFirstIndex=i + 1;
      }
 else {
        if (i == 0)         gc.insets.left=0;
        scrollablePanel.add(linkLabel,gc);
      }
    }
  }
  JScrollPane scrollPane=ScrollPaneFactory.createScrollPane(scrollablePanel);
  scrollPane.setHorizontalScrollBarPolicy(ScrollPaneConstants.HORIZONTAL_SCROLLBAR_NEVER);
  scrollPane.setVerticalScrollBarPolicy(ScrollPaneConstants.VERTICAL_SCROLLBAR_NEVER);
  removeAll();
  add(scrollPane,BorderLayout.CENTER);
  add(myLeftButton,BorderLayout.WEST);
  add(myRightButton,BorderLayout.EAST);
  revalidate();
  repaint();
  final boolean scrollBarVisible=width > wholeWidth;
  myLeftButton.setVisible(scrollBarVisible);
  myRightButton.setVisible(scrollBarVisible);
  myLeftButton.setEnabled(widthToTheRight > wholeWidth && myFirstIndex < myModel.size() - 2);
  myRightButton.setEnabled(myFirstIndex > 0);
}
