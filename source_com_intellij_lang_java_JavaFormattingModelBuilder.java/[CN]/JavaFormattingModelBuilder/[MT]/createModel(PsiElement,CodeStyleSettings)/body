{
  final FileElement fileElement=TreeUtil.getFileElement((TreeElement)SourceTreeToPsiMap.psiElementToTree(element));
  LOG.assertTrue(fileElement != null,"File element should not be null for " + element);
  return new PsiBasedFormatterModelWithShiftIndentInside(element.getContainingFile(),AbstractJavaBlock.createJavaBlock(fileElement,settings),FormattingDocumentModelImpl.createOn(element.getContainingFile()));
}
