{
  LogicalPosition pos=editor.getCaretModel().getLogicalPosition();
  final DataContext dataContext=((EditorEx)editor).getDataContext();
  final Rectangle dominantArea=(Rectangle)dataContext.getData(DataConstants.DOMINANT_HINT_AREA_RECTANGLE);
  LOG.assertTrue(SwingUtilities.isEventDispatchThread());
  if (dominantArea == null) {
    for (    HintInfo info : myHintsStack) {
      if (!info.hint.isSelectingHint())       continue;
      final Rectangle rectangle=info.hint.getBounds();
      if (rectangle != null) {
        return getHintPositionRelativeTo(hint,editor,constraint,rectangle,pos);
      }
    }
  }
 else {
    return getHintPositionRelativeTo(hint,editor,constraint,dominantArea,pos);
  }
  return getHintPosition(hint,editor,pos,constraint);
}
