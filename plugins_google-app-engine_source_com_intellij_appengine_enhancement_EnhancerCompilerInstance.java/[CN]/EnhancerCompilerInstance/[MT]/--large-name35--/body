{
  CompilerUtil.runInContext(myContext,"Enhancing classes...",new ThrowableRunnable<RuntimeException>(){
    @Override public void run(){
      List<ClassFileItem> toEnhance=new ArrayList<ClassFileItem>();
      for (      GenericCompilerProcessingItem<ClassFileItem,VirtualFileWithDependenciesState,DummyPersistentState> item : changedItems) {
        final ClassFileItem classFileItem=item.getItem();
        if (myContext.getCompileScope().belongs(classFileItem.getSourceFile().getUrl())) {
          toEnhance.add(classFileItem);
        }
      }
      if (!toEnhance.isEmpty()) {
        if (runEnhancer(target.getFacet(),toEnhance,myContext)) {
          for (          ClassFileItem item : toEnhance) {
            consumer.addProcessedItem(item);
          }
        }
      }
    }
  }
);
}
