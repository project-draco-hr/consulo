{
  checkSetModifierProperty(name,value);
  PsiElement methodCandidate=getParent();
  if (methodCandidate instanceof PsiMethod) {
    PsiMethod method=(PsiMethod)methodCandidate;
    CodeEditUtil.markToReformat(method.getParameterList().getNode(),true);
  }
  IElementType type=NAME_TO_KEYWORD_TYPE_MAP.get(name);
  CompositeElement treeElement=(CompositeElement)getNode();
  ASTNode parentTreeElement=treeElement.getTreeParent();
  if (value) {
    if (parentTreeElement.getElementType() == JavaElementType.FIELD && parentTreeElement.getTreeParent().getElementType() == JavaElementType.CLASS && ((PsiClass)SourceTreeToPsiMap.treeElementToPsi(parentTreeElement.getTreeParent())).isInterface()) {
      if (type == JavaTokenType.PUBLIC_KEYWORD || type == JavaTokenType.STATIC_KEYWORD || type == JavaTokenType.FINAL_KEYWORD)       return;
    }
 else     if (parentTreeElement.getElementType() == JavaElementType.METHOD && parentTreeElement.getTreeParent().getElementType() == JavaElementType.CLASS && ((PsiClass)SourceTreeToPsiMap.treeElementToPsi(parentTreeElement.getTreeParent())).isInterface()) {
      if (type == JavaTokenType.PUBLIC_KEYWORD || type == JavaTokenType.ABSTRACT_KEYWORD)       return;
    }
 else     if (parentTreeElement.getElementType() == JavaElementType.CLASS && parentTreeElement.getTreeParent().getElementType() == JavaElementType.CLASS && ((PsiClass)SourceTreeToPsiMap.treeElementToPsi(parentTreeElement.getTreeParent())).isInterface()) {
      if (type == JavaTokenType.PUBLIC_KEYWORD)       return;
    }
 else     if (parentTreeElement.getElementType() == JavaElementType.ANNOTATION_METHOD && parentTreeElement.getTreeParent().getElementType() == JavaElementType.CLASS && ((PsiClass)SourceTreeToPsiMap.treeElementToPsi(parentTreeElement.getTreeParent())).isAnnotationType()) {
      if (type == JavaTokenType.PUBLIC_KEYWORD || type == JavaTokenType.ABSTRACT_KEYWORD)       return;
    }
    if (type == JavaTokenType.PUBLIC_KEYWORD || type == JavaTokenType.PRIVATE_KEYWORD || type == JavaTokenType.PROTECTED_KEYWORD || type == null) {
      if (type != JavaTokenType.PUBLIC_KEYWORD) {
        setModifierProperty(PsiModifier.PUBLIC,false);
      }
      if (type != JavaTokenType.PRIVATE_KEYWORD) {
        setModifierProperty(PsiModifier.PRIVATE,false);
      }
      if (type != JavaTokenType.PROTECTED_KEYWORD) {
        setModifierProperty(PsiModifier.PROTECTED,false);
      }
      if (type == null)       return;
    }
    if (treeElement.findChildByType(type) == null) {
      TreeElement keyword=Factory.createSingleLeafElement(type,name,null,getManager());
      treeElement.addInternal(keyword,keyword,null,null);
    }
    if ((type == JavaTokenType.ABSTRACT_KEYWORD || type == JavaTokenType.NATIVE_KEYWORD) && parentTreeElement.getElementType() == JavaElementType.METHOD) {
    }
  }
 else {
    if (type == null) {
      throw new IncorrectOperationException("Cannot reset package local modifier.");
    }
    ASTNode child=treeElement.findChildByType(type);
    if (child != null) {
      SourceTreeToPsiMap.treeElementToPsi(child).delete();
    }
  }
}
