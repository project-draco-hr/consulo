{
synchronized (LOCK) {
    ModalityState currentModality=getCurrentModalityState();
    while (ourQueueSkipCount < ourQueue.size()) {
      RunnableInfo info=ourQueue.get(ourQueueSkipCount);
      if (info.expired.value(null)) {
        ourQueue.remove(ourQueueSkipCount);
        info.callback.setDone();
        continue;
      }
      if (!currentModality.dominates(info.modalityState)) {
        if (remove) {
          ourQueue.remove(ourQueueSkipCount);
        }
        return info;
      }
      ourQueueSkipCount++;
    }
    return null;
  }
}
