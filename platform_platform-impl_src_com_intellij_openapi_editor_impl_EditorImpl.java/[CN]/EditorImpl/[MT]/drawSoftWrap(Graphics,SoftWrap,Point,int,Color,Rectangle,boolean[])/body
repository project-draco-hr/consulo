{
  CharSequence softWrapText=softWrap.getText();
  int activeRowY=getCaretModel().getVisualPosition().line * getLineHeight();
  if (position.y == activeRowY) {
    Color caretRowColor=getColorsScheme().getColor(EditorColors.CARET_ROW_COLOR);
    drawBackground(g,caretRowColor,clip.x + clip.width - position.x,position,defaultBackground,clip);
    caretRowPainted[0]=true;
  }
  int i=CharArrayUtil.lastIndexOf(softWrapText,"\n",softWrapText.length()) + 1;
  position.x=getTextSegmentWidth(softWrapText.subSequence(i,softWrapText.length()),0,fontType,clip);
  position.x+=getSoftWrapModel().getMinDrawingWidthInPixels(SoftWrapDrawingType.AFTER_SOFT_WRAP);
  position.y+=getLineHeight();
  if (position.y == activeRowY) {
    Color caretRowColor=getColorsScheme().getColor(EditorColors.CARET_ROW_COLOR);
    drawBackground(g,caretRowColor,position.x,new Point(0,activeRowY),defaultBackground,clip);
  }
}
