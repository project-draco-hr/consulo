{
  Point p1=offsetToXY(begin,false);
  Point p2=offsetToXY(end,false);
  int x2=p1.y == p2.y ? p2.x : Math.max(p1.x,myEditorComponent.getWidth() - getVerticalScrollBar().getWidth());
  return new Rectangle(p1.x,p1.y,x2 - p1.x,getLineHeight());
}
