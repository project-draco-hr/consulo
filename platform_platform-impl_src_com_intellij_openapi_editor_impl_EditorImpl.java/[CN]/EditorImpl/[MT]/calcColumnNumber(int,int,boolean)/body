{
  if (myDocument.getTextLength() == 0)   return 0;
  if (softWrapAware) {
    return mySoftWrapModel.offsetToLogicalPosition(offset).column;
  }
 else {
    CharSequence text=myDocument.getCharsSequence();
    int start=myDocument.getLineStartOffset(lineIndex);
    if (start == offset)     return 0;
    return EditorUtil.calcColumnNumber(this,text,start,offset,EditorUtil.getTabSize(this));
  }
}
