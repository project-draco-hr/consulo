{
  ApplicationManager.getApplication().assertIsDispatchThread();
  myDocumentChangeInProgress=true;
  if (isStickySelection()) {
    setStickySelection(false);
  }
  if (myDocument.isInBulkUpdate()) {
    return;
  }
  saveCaretRelativePosition();
  if (!mySoftWrapModel.isSoftWrappingEnabled() && !myUseNewRendering) {
    mySizeContainer.beforeChange(e);
  }
  myImmediatePainter.beforeUpdate(e);
}
