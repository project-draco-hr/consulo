{
  MarkupModel mm=myMarkupModel;
  int clipStartOffset=logicalPositionToOffset(xyToLogicalPosition(new Point(0,clip.y)));
  int clipEndOffset=logicalPositionToOffset(xyToLogicalPosition(new Point(0,clip.y + clip.height + getLineHeight())));
  for (  RangeHighlighter highlighter : mm.getAllHighlighters()) {
    if (highlighter.isValid()) {
      final CustomHighlighterRenderer customRenderer=highlighter.getCustomRenderer();
      if (customRenderer != null && clipStartOffset < highlighter.getEndOffset() && clipEndOffset > highlighter.getStartOffset()) {
        customRenderer.paint(this,highlighter,g);
      }
    }
  }
}
