{
  if (myDocument.getTextLength() == 0)   return 0;
  int start=myDocument.getLineStartOffset(lineIndex);
  if (start == offset)   return 0;
  int column=EditorUtil.calcColumnNumber(this,documentCharSequence,start,offset,EditorUtil.getTabSize(this));
  if (softWrapAware) {
    int line=offsetToLogicalLine(offset,false);
    return mySoftWrapModel.adjustLogicalPosition(new LogicalPosition(line,column),offset).column;
  }
 else {
    return column;
  }
}
