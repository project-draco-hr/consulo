{
  DebuggerManagerThreadImpl.assertIsManagerThread();
  checkValid();
  if (myAllValues == null) {
    try {
      final StackFrame stackFrame=getStackFrame();
      final Map<LocalVariable,Value> values=stackFrame.getValues(stackFrame.visibleVariables());
      myAllValues=new HashMap<LocalVariable,Value>(values.size());
      for (Iterator<LocalVariable> it=values.keySet().iterator(); it.hasNext(); ) {
        final LocalVariable variable=it.next();
        final Value value=values.get(variable);
        myAllValues.put(variable,(value instanceof ObjectReference) ? ObjectReferenceCachingProxy.wrap((ObjectReference)value) : value);
      }
    }
 catch (    InconsistentDebugInfoException e) {
      clearCaches();
      throw EvaluateExceptionUtil.INCONSISTEND_DEBUG_INFO;
    }
catch (    AbsentInformationException e) {
      throw EvaluateExceptionUtil.createEvaluateException(e);
    }
  }
  return myAllValues;
}
