{
  if (messageBusConnection != null) {
    return;
  }
  messageBusConnection=project.getMessageBus().connect();
  messageBusConnection.subscribe(VirtualFileManager.VFS_CHANGES,new BulkFileListener(){
    @Override public void before(    @NotNull List<? extends VFileEvent> events){
    }
    @Override public void after(    @NotNull List<? extends VFileEvent> events){
      for (      VFileEvent event : events) {
        if (event instanceof VFileDeleteEvent) {
synchronized (changedFiles) {
            changedFiles.remove(event.getFile());
          }
        }
      }
    }
  }
);
  EditorFactory.getInstance().getEventMulticaster().addDocumentListener(listener,project);
}
