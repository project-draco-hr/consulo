{
  FileDocumentManager.getInstance().saveAllDocuments();
  Change[] changes=e.getData(VcsDataKeys.CHANGES);
  Project project=e.getData(PlatformDataKeys.PROJECT);
  final ChangesBrowser browser=e.getData(ChangesBrowser.DATA_KEY);
  RollbackChangesDialog.rollbackChanges(project,Arrays.asList(changes),true);
  ChangeListManager.getInstance(project).invokeAfterUpdate(new Runnable(){
    public void run(){
      if (browser != null) {
        browser.rebuildList();
      }
    }
  }
,InvokeAfterUpdateMode.BACKGROUND_NOT_CANCELLABLE,VcsBundle.message("changes.action.rollback.text"));
}
