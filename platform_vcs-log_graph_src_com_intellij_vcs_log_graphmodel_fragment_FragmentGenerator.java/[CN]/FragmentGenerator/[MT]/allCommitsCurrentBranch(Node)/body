{
  Set<Node> nodes=new HashSet<Node>();
  Set<Node> downNodes=new HashSet<Node>();
  downNodes.add(node);
  while (!downNodes.isEmpty()) {
    Iterator<Node> iteratorNode=downNodes.iterator();
    Node nextNode=iteratorNode.next();
    iteratorNode.remove();
    if (nodes.add(nextNode)) {
      for (      Edge edge : nextNode.getDownEdges()) {
        downNodes.add(edge.getDownNode());
      }
    }
  }
  Set<Node> upNodes=new HashSet<Node>();
  upNodes.add(node);
  nodes.remove(node);
  while (!upNodes.isEmpty()) {
    Iterator<Node> nodeIterator=upNodes.iterator();
    Node nextNode=nodeIterator.next();
    nodeIterator.remove();
    if (nodes.add(nextNode)) {
      for (      Edge edge : nextNode.getUpEdges()) {
        upNodes.add(edge.getUpNode());
      }
    }
  }
  return nodes;
}
