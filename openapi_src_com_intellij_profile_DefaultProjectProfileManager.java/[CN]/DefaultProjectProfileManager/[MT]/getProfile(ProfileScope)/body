{
  if (!USE_PROJECT_LEVEL_SETTINGS)   return myApplicationProfileManager.getRootProfile().getName();
  final String profile=myScopeToProfileMap.get(scope);
  if (profile != null) {
    return profile;
  }
  ProfileScope parentScope=scope.getParentScope(myProject);
  while (parentScope != null) {
    if (myScopeToProfileMap.containsKey(parentScope)) {
      return myScopeToProfileMap.get(parentScope);
    }
    parentScope=parentScope.getParentScope(myProject);
  }
  return null;
}
