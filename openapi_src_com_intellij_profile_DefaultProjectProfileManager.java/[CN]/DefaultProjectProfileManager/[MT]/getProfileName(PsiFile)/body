{
  if (USE_PROJECT_LEVEL_SETTINGS) {
    final NamedScopesHolder scopeManager=DependencyValidationManager.getInstance(myProject);
    for (    NamedScope scope : myScopeToProfileMap.keySet()) {
      if (scope.getValue().contains(psiFile,scopeManager)) {
        return myScopeToProfileMap.get(scope);
      }
    }
    final Profile profile=myProfiles.get(PROJECT_PROFILE);
    if (profile != null)     return profile.getName();
  }
  return myApplicationProfileManager.getRootProfile().getName();
}
