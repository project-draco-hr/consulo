{
  final String basePath=JavaTestUtil.getJavaTestDataPath() + "/psi/libraryOrder/";
  final VirtualFile lib1SrcFile=refreshAndFindFile(basePath + "lib1/src");
  final VirtualFile lib1classes=refreshAndFindFile(basePath + "lib1/classes");
  final VirtualFile lib2SrcFile=refreshAndFindFile(basePath + "lib2/src");
  final VirtualFile lib2classes=refreshAndFindFile(basePath + "lib2/classes");
  assertTrue(lib1SrcFile != null);
  assertTrue(lib2SrcFile != null);
  final ModifiableRootModel rootModel=ModuleRootManager.getInstance(myModule).getModifiableModel();
  final LibraryTable libraryTable=rootModel.getModuleLibraryTable();
  addLibraryWithSourcePath("lib1",libraryTable,lib1SrcFile,lib1classes);
  addLibraryWithSourcePath("lib2",libraryTable,lib2SrcFile,lib2classes);
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    @Override public void run(){
      rootModel.commit();
    }
  }
);
  final List<VirtualFile> list=Arrays.asList(OrderEnumerator.orderEntries(myModule).getClassesRoots());
  assertTrue(list.contains(lib1classes));
  assertTrue(list.contains(lib2classes));
}
