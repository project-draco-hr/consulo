def sigwalk(repo):
    '\n    walk over every sigs, yields a couple\n    ((node, version, sig), (filename, linenumber))\n    '

    def parsefile(fileiter, context):
        ln = 1
        for l in fileiter:
            if (not l):
                continue
            yield (l.split(' ', 2), (context, ln))
            ln += 1
    fl = repo.file('.hgsigs')
    for r in reversed(fl.heads()):
        fn = ('.hgsigs|%s' % hgnode.short(r))
        for item in parsefile(fl.read(r).splitlines(), fn):
            yield item
    try:
        fn = 'localsigs'
        for item in parsefile(repo.opener(fn), fn):
            yield item
    except IOError:
        pass
