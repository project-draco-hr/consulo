def sigs(ui, repo):
    'list signed changesets'
    mygpg = newgpg(ui)
    revs = {}
    for (data, context) in sigwalk(repo):
        (node, version, sig) = data
        (fn, ln) = context
        try:
            n = repo.lookup(node)
        except KeyError:
            ui.warn((_('%s:%d node does not exist\n') % (fn, ln)))
            continue
        r = repo.changelog.rev(n)
        keys = getkeys(ui, repo, mygpg, data, context)
        if (not keys):
            continue
        revs.setdefault(r, [])
        revs[r].extend(keys)
    for rev in sorted(revs, reverse=True):
        for k in revs[rev]:
            r = ('%5d:%s' % (rev, hgnode.hex(repo.changelog.node(rev))))
            ui.write(('%-30s %s\n' % (keystr(ui, k), r)))
