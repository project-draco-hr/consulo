def check(ui, repo, rev):
    'verify all the signatures there may be for a particular revision'
    mygpg = newgpg(ui)
    rev = repo.lookup(rev)
    hexrev = hgnode.hex(rev)
    keys = []
    for (data, context) in sigwalk(repo):
        (node, version, sig) = data
        if (node == hexrev):
            k = getkeys(ui, repo, mygpg, data, context)
            if k:
                keys.extend(k)
    if (not keys):
        ui.write((_('No valid signature for %s\n') % hgnode.short(rev)))
        return
    ui.write(('%s is signed by:\n' % hgnode.short(rev)))
    for key in keys:
        ui.write((' %s\n' % keystr(ui, key)))
