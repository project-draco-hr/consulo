{
  if (!grid.isGrid()) {
    throw new IllegalArgumentException("container must be grid");
  }
  final GridLayoutManager layout=(GridLayoutManager)grid.getLayout();
  final int cellCount=isRow ? layout.getRowCount() : layout.getColumnCount();
  if (cellIndex < 0 || cellIndex >= cellCount) {
    throw new IllegalArgumentException("invalid index: " + cellIndex);
  }
}
