{
  if (file.getParent() == null) {
    throw new IOException(VfsBundle.message("cannot.delete.root.directory",file.getPath()));
  }
  if (!auxDelete(file)) {
    File ioFile=convertToIOFile(file);
    if (!FileUtil.delete(ioFile)) {
      throw new IOException(VfsBundle.message("delete.failed.error",ioFile.getPath()));
    }
  }
  auxNotifyCompleted(new ThrowableConsumer<LocalFileOperationsHandler,IOException>(){
    @Override public void consume(    LocalFileOperationsHandler handler) throws IOException {
      handler.delete(file);
    }
  }
);
}
