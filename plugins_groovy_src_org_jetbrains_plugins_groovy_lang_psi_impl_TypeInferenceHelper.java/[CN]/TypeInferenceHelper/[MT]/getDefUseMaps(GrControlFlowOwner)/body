{
  return CachedValuesManager.getManager(scope.getProject()).getCachedValue(scope,new CachedValueProvider<Pair<ReachingDefinitionsDfaInstance,List<TIntObjectHashMap<TIntHashSet>>>>(){
    @Override public Result<Pair<ReachingDefinitionsDfaInstance,List<TIntObjectHashMap<TIntHashSet>>>> compute(){
      final Instruction[] flow=scope.getControlFlow();
      final ReachingDefinitionsDfaInstance dfaInstance=new ReachingDefinitionsDfaInstance(flow){
        @Override public void fun(        TIntObjectHashMap<TIntHashSet> m,        Instruction instruction){
          if (instruction instanceof AssertionInstruction) {
            final AssertionInstruction assertionInstruction=(AssertionInstruction)instruction;
            final PsiElement element=assertionInstruction.getElement();
            if (element instanceof GrInstanceOfExpression && !assertionInstruction.isNegate()) {
              final GrExpression operand=((GrInstanceOfExpression)element).getOperand();
              final GrTypeElement typeElement=((GrInstanceOfExpression)element).getTypeElement();
              if (typeElement != null) {
                final int varIndex=getVarIndex(operand.getText());
                if (varIndex >= 0) {
                  registerDef(m,instruction,varIndex);
                }
              }
            }
          }
 else {
            super.fun(m,instruction);
          }
        }
      }
;
      final ReachingDefinitionsSemilattice lattice=new ReachingDefinitionsSemilattice();
      final DFAEngine<TIntObjectHashMap<TIntHashSet>> engine=new DFAEngine<TIntObjectHashMap<TIntHashSet>>(flow,dfaInstance,lattice);
      final List<TIntObjectHashMap<TIntHashSet>> dfaResult=engine.performDFAWithTimeout();
      return Result.create(Pair.create(dfaInstance,dfaResult),PsiModificationTracker.MODIFICATION_COUNT);
    }
  }
);
}
