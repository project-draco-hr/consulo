{
  super.setUp();
  if (ourTestCase != null) {
    String message="Previous test " + ourTestCase + " hasn't called tearDown(). Probably overridden without super call.";
    ourTestCase=null;
    fail(message);
  }
  IdeaLogger.ourErrorsOccurred=null;
  LOGGER.info(getClass().getName() + ".setUp()");
  initApplication();
  myEditorListenerTracker=new EditorListenerTracker();
  myThreadTracker=new ThreadTracker();
  setUpProject();
  storeSettings();
  ourTestCase=this;
  if (myProject != null) {
    ProjectManagerEx.getInstanceEx().openTestProject(myProject);
    CodeStyleSettingsManager.getInstance(myProject).setTemporarySettings(new CodeStyleSettings());
    InjectedLanguageManagerImpl.pushInjectors(getProject());
  }
  DocumentCommitThread.getInstance().clearQueue();
  DocumentImpl.CHECK_DOCUMENT_CONSISTENCY=!isPerformanceTest();
}
