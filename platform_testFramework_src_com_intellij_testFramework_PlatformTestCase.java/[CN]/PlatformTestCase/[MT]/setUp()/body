{
  super.setUp();
  if (ourTestCase != null) {
    String message="Previous test " + ourTestCase + " hasn't called tearDown(). Probably overridden without super call.";
    ourTestCase=null;
    fail(message);
  }
  IdeaLogger.ourErrorsOccurred=null;
  LOG.info(getClass().getName() + ".setUp()");
  initApplication();
  myEditorListenerTracker=new EditorListenerTracker();
  myThreadTracker=new ThreadTracker();
  setUpProject();
  ProjectManagerEx.getInstanceEx().setCurrentTestProject(myProject);
  storeSettings();
  ourTestCase=this;
  if (myProject != null) {
    CodeStyleSettingsManager.getInstance(myProject).setTemporarySettings(new CodeStyleSettings());
    ((InjectedLanguageManagerImpl)InjectedLanguageManager.getInstance(myProject)).pushInjectors();
  }
  DocumentCommitThread.getInstance().clearQueue();
  DocumentImpl.CHECK_DOCUMENT_CONSISTENCY=!isPerformanceTest();
}
