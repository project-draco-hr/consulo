{
  final Exception[] e=new Exception[1];
  Runnable runnable1=new Runnable(){
    @Override public void run(){
      try {
        if (ApplicationManager.getApplication().isDispatchThread() && isRunInWriteAction()) {
          ApplicationManager.getApplication().runWriteAction(runnable);
        }
 else {
          runnable.run();
        }
      }
 catch (      Exception e1) {
        e[0]=e1;
      }
    }
  }
;
  if (annotatedWith(WrapInCommand.class)) {
    CommandProcessor.getInstance().executeCommand(myProject,runnable1,"",null);
  }
 else {
    runnable1.run();
  }
  if (e[0] != null) {
    throw e[0];
  }
}
