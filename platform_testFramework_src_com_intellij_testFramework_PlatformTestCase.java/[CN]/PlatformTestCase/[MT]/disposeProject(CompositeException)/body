{
  try {
    DocumentCommitThread.getInstance().clearQueue();
    UIUtil.dispatchAllInvocationEvents();
  }
 catch (  Exception e) {
    result.add(e);
  }
  try {
    if (myProject != null) {
      ApplicationManager.getApplication().runWriteAction(new Runnable(){
        @Override public void run(){
          Disposer.dispose(myProject);
          ProjectManagerEx projectManager=ProjectManagerEx.getInstanceEx();
          if (projectManager != null) {
            projectManager.setCurrentTestProject(null);
          }
        }
      }
);
    }
  }
 catch (  Exception e) {
    result.add(e);
  }
 finally {
    if (myProject != null) {
      try {
        PsiDocumentManager documentManager=myProject.getComponent(PsiDocumentManager.class,null);
        if (documentManager != null)         EditorFactory.getInstance().getEventMulticaster().removeDocumentListener((DocumentListener)documentManager);
      }
 catch (      Exception ignored) {
      }
      myProject=null;
    }
  }
}
