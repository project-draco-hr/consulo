{
  final boolean currentIsDirectory=child.isDirectory();
  final boolean currentIsSymlink=child.isSymLink();
  final boolean currentIsSpecial=child.isSpecialFile();
  final String currentLinkTarget=child instanceof SymlinkDirectory ? ((SymlinkDirectory)child).getTargetPath() : null;
  final boolean upToDateIsDirectory=(childAttributes & FileUtil.BA_DIRECTORY) != 0;
  final boolean upToDateIsSymlink=delegate.isSymLink(child);
  final boolean upToDateIsSpecial=(childAttributes & SPECIAL_MASK) == FileUtil.BA_EXISTS;
  final String upToDateLinkTarget=currentLinkTarget != null ? delegate.resolveSymLink(child) : null;
  if (currentIsDirectory != upToDateIsDirectory || currentIsSymlink != upToDateIsSymlink || currentIsSpecial != upToDateIsSpecial || !Comparing.equal(currentLinkTarget,upToDateLinkTarget)) {
    scheduleDeletion(child);
    scheduleReCreation(parent,child.getName(),upToDateIsDirectory);
  }
 else   if (myIsRecursive || !upToDateIsDirectory) {
    myRefreshQueue.addLast(child);
  }
}
