{
  JPanel panel=new JPanel(new GridBagLayout());
  GridBagConstraints gbConstraints=new GridBagConstraints();
  gbConstraints.fill=GridBagConstraints.HORIZONTAL;
  gbConstraints.weightx=1;
  gbConstraints.weighty=0;
  gbConstraints.gridwidth=1;
  gbConstraints.gridx=0;
  gbConstraints.gridy=0;
  gbConstraints.insets=new Insets(0,0,0,0);
  panel.add(createVisibilityPanel(),gbConstraints);
  ItemListener itemListener=new ItemListener(){
    public void itemStateChanged(    ItemEvent e){
      updateTypeSelector();
      myNameField.requestFocusInWindow();
    }
  }
;
  if (myOccurrencesCount > 1) {
    myCbReplaceAll=new NonFocusableCheckBox("Replace all occurrences of expression (" + myOccurrencesCount + " occurrences)");
    myCbReplaceAll.setMnemonic('A');
    myCbReplaceAll.setFocusable(false);
    gbConstraints.gridy++;
    panel.add(myCbReplaceAll,gbConstraints);
    myCbReplaceAll.addItemListener(itemListener);
  }
  if (myLocalVariable != null) {
    gbConstraints.gridy++;
    if (myCbReplaceAll != null) {
      gbConstraints.insets=new Insets(0,8,0,0);
    }
    myCbDeleteVariable=new StateRestoringCheckBox("Delete variable declaration");
    myCbDeleteVariable.setFocusable(false);
    panel.add(myCbDeleteVariable,gbConstraints);
    myCbDeleteVariable.setMnemonic(KeyEvent.VK_D);
    if (myInvokedOnDeclaration) {
      myCbDeleteVariable.setEnabled(false);
      myCbDeleteVariable.setSelected(true);
    }
 else     if (myCbReplaceAll != null) {
      updateCbDeleteVariable();
      myCbReplaceAll.addItemListener(new ItemListener(){
        public void itemStateChanged(        ItemEvent e){
          updateCbDeleteVariable();
        }
      }
);
    }
  }
  updateTypeSelector();
  return panel;
}
