{
  final ModuleEx module=createModule(moduleLoadItem.getName(),moduleLoadItem.getDirUrl(),progressIndicator);
  moduleModel.initModule(module);
  collapseOrExpandMacros(module,moduleLoadItem.getElement(),false);
  final ModuleRootManagerImpl moduleRootManager=(ModuleRootManagerImpl)ModuleRootManager.getInstance(module);
  ApplicationManager.getApplication().runReadAction(new Runnable(){
    @Override public void run(){
      moduleRootManager.loadState(moduleLoadItem.getElement(),progressIndicator);
    }
  }
);
  return module;
}
