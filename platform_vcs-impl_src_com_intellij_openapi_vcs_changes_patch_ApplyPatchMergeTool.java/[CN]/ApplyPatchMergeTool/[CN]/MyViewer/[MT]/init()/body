{
  final Project project=myMergeContext.getProject();
  final Document document=myMergeRequest.getDocument();
  DiffUtil.executeWriteCommand(document,project,"Init merge content",new Runnable(){
    @Override public void run(){
      document.setText(myMergeRequest.getPatchedContent());
      UndoManager undoManager=project != null ? UndoManager.getInstance(project) : UndoManager.getGlobalInstance();
      if (undoManager != null) {
        DocumentReference ref=DocumentReferenceManager.getInstance().create(document);
        undoManager.nonundoableActionPerformed(ref,false);
      }
    }
  }
);
  ToolbarComponents components=new ToolbarComponents();
  FrameDiffTool.ToolbarComponents init=myViewer.init();
  components.statusPanel=init.statusPanel;
  components.toolbarActions=init.toolbarActions;
  components.closeHandler=new BooleanGetter(){
    @Override public boolean get(){
      return MergeUtil.showExitWithoutApplyingChangesDialog(MyViewer.this,myMergeRequest,myMergeContext);
    }
  }
;
  return components;
}
