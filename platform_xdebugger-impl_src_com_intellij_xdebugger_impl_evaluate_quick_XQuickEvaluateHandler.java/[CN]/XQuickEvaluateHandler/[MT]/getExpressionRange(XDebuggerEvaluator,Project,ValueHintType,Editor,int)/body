{
  SelectionModel selectionModel=editor.getSelectionModel();
  int selectionStart=selectionModel.getSelectionStart();
  int selectionEnd=selectionModel.getSelectionEnd();
  if ((type == ValueHintType.MOUSE_CLICK_HINT || type == ValueHintType.MOUSE_ALT_OVER_HINT) && selectionModel.hasSelection() && selectionStart <= offset && offset <= selectionEnd) {
    return Pair.create(new TextRange(selectionStart,selectionEnd),null);
  }
  return evaluator.getExpressionAtOffset(project,editor.getDocument(),offset,false);
}
