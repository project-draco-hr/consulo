{
  DebuggerManagerThreadImpl.assertIsManagerThread();
  try {
    myVirtualMachine.redefineClasses(map);
  }
  finally {
    clearCaches();
    if (myNestedClassesCache.size() > 0) {
      myNestedClassesCache=new THashMap<ReferenceType,List<ReferenceType>>(myNestedClassesCache.size());
    }
  }
}
