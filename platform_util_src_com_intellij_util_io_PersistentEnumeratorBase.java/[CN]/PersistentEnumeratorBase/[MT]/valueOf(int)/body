{
  lockStorage();
  try {
    int addr=indexToAddr(idx);
    if (myKeyReadStream == null)     return ((InlineKeyDescriptor<Data>)myDataDescriptor).fromInt(addr);
    if (myKeyStoreFileLength <= addr) {
      return myDataDescriptor.read(new DataInputStream(new UnsyncByteArrayInputStream(myKeyStoreFileBuffer,addr - myKeyStoreFileLength,myKeyStoreBufferPosition)));
    }
    myKeyReadStream.setup(addr,myKeyStoreFileLength);
    return myDataDescriptor.read(myKeyReadStream);
  }
 catch (  IOException io) {
    markCorrupted();
    throw io;
  }
catch (  Throwable e) {
    markCorrupted();
    throw new RuntimeException(e);
  }
 finally {
    unlockStorage();
  }
}
