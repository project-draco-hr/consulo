{
  myProject=project;
  myMessageBus=messageBus;
  myFileStatusManager=fileStatusManager;
  myExcludedFileIndex=excludedFileIndex;
  myLock=new Object();
  myVcsToPaths=new HashMap<String,List<VcsDirectoryMapping>>();
  myFileWatchRequestsManager=new FileWatchRequestsManager(myProject,this,LocalFileSystem.getInstance());
  myDefaultVcsRootPolicy=DefaultVcsRootPolicy.getInstance(project);
  myActiveVcses=new AbstractVcs[0];
  if (!myProject.isDefault()) {
    final ArrayList<VcsDirectoryMapping> listStr=new ArrayList<VcsDirectoryMapping>();
    final VcsDirectoryMapping mapping=new VcsDirectoryMapping("","");
    listStr.add(mapping);
    myVcsToPaths.put("",listStr);
    mySortedMappings=new VcsDirectoryMapping[]{mapping};
  }
 else {
    mySortedMappings=VcsDirectoryMapping.EMPTY_ARRAY;
  }
  myActivated=false;
  vcsManager.addInitializationRequest(VcsInitObject.MAPPINGS,new DumbAwareRunnable(){
    public void run(){
      if (!myProject.isDisposed()) {
        activateActiveVcses();
      }
    }
  }
);
}
