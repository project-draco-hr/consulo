{
  final List<VirtualFile> result=new ArrayList<VirtualFile>();
  final String vcsName=vcs.getName();
  if (ChangeListManagerImpl.DEBUG) {
    System.out.println("NewMappings.getMappingsAsFilesUnderVcs");
    System.out.println("vcsName = " + vcsName);
  }
  final List<VcsDirectoryMapping> mappings;
synchronized (myLock) {
    final List<VcsDirectoryMapping> vcsMappings=myVcsToPaths.get(vcsName);
    if (vcsMappings == null)     return result;
    mappings=new ArrayList<VcsDirectoryMapping>(vcsMappings);
  }
  for (  VcsDirectoryMapping mapping : mappings) {
    if (mapping.isDefaultMapping()) {
      myDefaultVcsRootPolicy.addDefaultVcsRoots(this,vcsName,result);
    }
 else {
      final VirtualFile file=LocalFileSystem.getInstance().findFileByPath(mapping.getDirectory());
      if (ChangeListManagerImpl.DEBUG) {
        System.out.println("NewMappings.getMappingsAsFilesUnderVcs");
        System.out.println("mapping.getDirectory() = " + mapping.getDirectory());
        System.out.println("file = " + file);
      }
      if (file != null) {
        result.add(file);
      }
    }
  }
  return result;
}
