{
  final Lexer lexer=new FilterLexer(originalLexer,new FilterLexer.SetFilter(XML_WHITE_SPACE_OR_COMMENT_BIT_SET));
  lexer.start(text,start,end,_OldXmlLexer.DOCTYPE);
  final FileElement dummyRoot=DummyHolderFactory.createHolder(manager,null,myContext.getCharTable()).getTreeElement();
  parseMarkupContent(lexer,dummyRoot);
  while (lexer.getTokenType() != null) {
    final TreeElement children;
    if (lexer.getTokenType() == XML_ENTITY_REF_TOKEN) {
      children=parseEntityRef(lexer);
    }
 else     if (lexer.getTokenType() == XML_ENTITY_DECL_START) {
      children=parseEntityDecl(lexer);
    }
 else {
      children=createTokenElement(lexer,dummyRoot.getCharTable());
      lexer.advance();
    }
    TreeUtil.addChildren(dummyRoot,children);
  }
  originalLexer.start(text,start,end,_OldXmlLexer.DOCTYPE);
  insertMissingTokens(dummyRoot,originalLexer,start,end,_OldXmlLexer.DOCTYPE,WhiteSpaceAndCommentsProcessor.INSTANCE,myContext);
  return (TreeElement)dummyRoot.getFirstChildNode();
}
