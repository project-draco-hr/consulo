{
  final DataContext dc=e.getDataContext();
  final Project project=CommonDataKeys.PROJECT.getData(dc);
  final ProjectLevelVcsManager manager=ProjectLevelVcsManager.getInstance(project);
  if (project == null || !manager.checkVcsIsActive(SvnVcs.getKey().getName())) {
    sc.hide();
    return;
  }
  final VirtualFile vf=PlatformDataKeys.VIRTUAL_FILE.getData(dc);
  final VirtualFile[] files=PlatformDataKeys.VIRTUAL_FILE_ARRAY.getData(dc);
  if (vf == null || files == null || files.length != 1 || !vf.isDirectory()) {
    sc.disable();
    return;
  }
  final AbstractVcs vcsFor=manager.getVcsFor(vf);
  if (vcsFor == null || !SvnVcs.getKey().equals(vcsFor.getKeyInstanceMethod())) {
    sc.disable();
    return;
  }
  final FileStatus status=FileStatusManager.getInstance(project).getStatus(vf);
  if (status == null || FileStatus.DELETED.equals(status) || FileStatus.IGNORED.equals(status) || FileStatus.MERGED_WITH_PROPERTY_CONFLICTS.equals(status) || FileStatus.OBSOLETE.equals(status) || FileStatus.UNKNOWN.equals(status)) {
    sc.disable();
    return;
  }
  sc.enable();
}
