{
  final DataManagerImpl dataManager=(DataManagerImpl)DataManager.getInstance();
  final Component focusedComponent=WindowManagerEx.getInstanceEx().getFocusedComponent(myProject);
  final JBPopup childPopup=JBPopupFactory.getInstance().getChildPopup(this);
  final boolean nodePopupShowing=focusedComponent == null || focusedComponent == this || isAncestorOf(focusedComponent) || (myNodePopup != null && myNodePopup.isVisible());
  if (nodePopupShowing || (childPopup != null && childPopup.isFocused())) {
    immediateUpdateList(false);
  }
 else {
    final DataContext dataContext=dataManager.getDataContextTest(this);
    immediateUpdateList(myModel.updateModel(dataContext));
  }
}
