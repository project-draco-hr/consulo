{
  final PsiFile psiFile=session.getPsiFile();
  final Project project=psiFile.getProject();
  final Document document=PsiDocumentManager.getInstance(project).getDocument(psiFile);
  if (document == null)   return;
  final long modificationStamp=document.getModificationStamp();
  UIUtil.invokeLaterIfNeeded(new Runnable(){
    @Override public void run(){
      if (project.isDisposed() || modificationStamp != document.getModificationStamp())       return;
      EditorColorsScheme scheme=session.getColorsScheme();
      UpdateHighlightersUtil.setHighlightersOutsideRange(project,document,psiFile,infos,scheme,restrictedRange.getStartOffset(),restrictedRange.getEndOffset(),ProperTextRange.create(priorityRange),groupId);
      Editor editor=session.getEditor();
      if (editor != null) {
        DaemonListeners.repaintErrorStripeRenderer(editor,project);
      }
    }
  }
);
}
