{
  final PsiElement psiInitializer=descriptor.getPsiElement();
  if (!(psiInitializer instanceof PsiExpression))   return;
  if (!(psiInitializer.getParent() instanceof PsiVariable))   return;
  if (!FileModificationService.getInstance().prepareFileForWrite(psiInitializer.getContainingFile()))   return;
  final PsiVariable variable=(PsiVariable)psiInitializer.getParent();
  final PsiDeclarationStatement declaration=(PsiDeclarationStatement)variable.getParent();
  final List<PsiElement> sideEffects=new ArrayList<PsiElement>();
  boolean hasSideEffects=RemoveUnusedVariableFix.checkSideEffects(psiInitializer,variable,sideEffects);
  int res=SideEffectWarningDialog.DELETE_ALL;
  if (hasSideEffects) {
    hasSideEffects=PsiUtil.isStatement(psiInitializer);
    res=RemoveUnusedVariableFix.showSideEffectsWarning(sideEffects,variable,FileEditorManager.getInstance(project).getSelectedTextEditor(),hasSideEffects,sideEffects.get(0).getText(),variable.getTypeElement().getText() + " " + variable.getName()+ ";<br>"+ PsiExpressionTrimRenderer.render((PsiExpression)psiInitializer));
  }
  try {
    if (res == SideEffectWarningDialog.DELETE_ALL) {
      psiInitializer.delete();
    }
 else     if (res == SideEffectWarningDialog.MAKE_STATEMENT) {
      final PsiElementFactory factory=JavaPsiFacade.getInstance(variable.getProject()).getElementFactory();
      final PsiStatement statementFromText=factory.createStatementFromText(psiInitializer.getText() + ";",null);
      declaration.getParent().addAfter(statementFromText,declaration);
      psiInitializer.delete();
    }
  }
 catch (  IncorrectOperationException e) {
    LOG.error(e);
  }
}
