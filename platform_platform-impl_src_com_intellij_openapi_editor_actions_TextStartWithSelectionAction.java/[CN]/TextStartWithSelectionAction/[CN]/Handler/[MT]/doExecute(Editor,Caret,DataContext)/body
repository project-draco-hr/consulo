{
  List<Caret> carets=editor.getCaretModel().getAllCarets();
  if (editor.isColumnMode() && editor.getCaretModel().supportsMultipleCarets()) {
    if (caret == null) {
      caret=carets.get(0) == editor.getCaretModel().getPrimaryCaret() ? carets.get(carets.size() - 1) : carets.get(0);
    }
    LogicalPosition leadSelectionPosition=editor.visualToLogicalPosition(caret.getLeadSelectionPosition());
    LogicalPosition targetPosition=new LogicalPosition(0,0);
    editor.getSelectionModel().setBlockSelection(leadSelectionPosition,targetPosition);
  }
 else {
    if (caret == null) {
      caret=carets.get(carets.size() - 1);
    }
    int selectionStart=caret.getLeadSelectionOffset();
    caret.moveToOffset(0);
    caret.setSelection(selectionStart,0);
  }
  ScrollingModel scrollingModel=editor.getScrollingModel();
  scrollingModel.disableAnimation();
  scrollingModel.scrollToCaret(ScrollType.RELATIVE);
  scrollingModel.enableAnimation();
}
