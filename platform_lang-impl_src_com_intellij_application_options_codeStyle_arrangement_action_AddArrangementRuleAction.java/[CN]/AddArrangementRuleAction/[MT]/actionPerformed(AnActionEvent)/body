{
  ArrangementMatchingRulesControl control=getRulesControl(e);
  if (control == null) {
    return;
  }
  control.hideEditor();
  TIntArrayList rows=control.getSelectedModelRows();
  ArrangementMatchingRulesModel model=control.getModel();
  int rowToEdit;
  if (rows.size() == 1) {
    rowToEdit=rows.get(0) + 1;
    model.insertRow(rowToEdit,new Object[]{createNewRule(control)});
  }
 else {
    rowToEdit=model.getSize();
    model.add(createNewRule(control));
  }
  showEditor(control,rowToEdit);
  control.getSelectionModel().setSelectionInterval(rowToEdit,rowToEdit);
  scrollRowToVisible(control,rowToEdit);
}
