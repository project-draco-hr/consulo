{
  ArrangementMatchingRulesControl control=ArrangementConstants.MATCHING_RULES_CONTROL_KEY.getData(e.getDataContext());
  if (control == null) {
    return;
  }
  control.hideEditor();
  TIntArrayList rows=control.getSelectedModelRows();
  ArrangementMatchingRulesModel model=control.getModel();
  int rowToEdit;
  if (rows.size() == 1) {
    rowToEdit=rows.get(0) + 1;
    model.insertRow(rowToEdit,new Object[]{new EmptyArrangementRuleComponent(control.getRowHeight(rowToEdit))});
  }
 else {
    rowToEdit=model.getSize();
    model.add(new EmptyArrangementRuleComponent(control.getRowHeight(rowToEdit)));
  }
  control.showEditor(rowToEdit);
  control.getSelectionModel().setSelectionInterval(rowToEdit,rowToEdit);
}
