{
  ArrangementMatchingRulesControl control=ArrangementConstants.MATCHING_RULES_CONTROL_KEY.getData(e.getDataContext());
  if (control == null) {
    return;
  }
  TIntArrayList rows=control.getSelectedModelRows();
  ArrangementMatchingRulesModel model=control.getModel();
  int rowToEdit;
  if (rows.size() == 1) {
    rowToEdit=rows.get(0) + 1;
    model.insertRow(rowToEdit,new Object[]{new EmptyArrangementRuleComponent()});
  }
 else {
    model.add(new EmptyArrangementRuleComponent());
    rowToEdit=model.getSize() - 1;
  }
  control.showEditor(rowToEdit);
}
