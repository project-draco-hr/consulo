{
  if (!CodeInsightUtil.preparePsiElementForWrite(myClass))   return;
  try {
    final PsiReferenceList extendsList=myMakeInterface ? myClass.getExtendsList() : myClass.getImplementsList();
    final PsiReferenceList implementsList=myMakeInterface ? myClass.getImplementsList() : myClass.getExtendsList();
    if (extendsList != null) {
      for (      PsiJavaCodeReferenceElement referenceElement : extendsList.getReferenceElements()) {
        referenceElement.delete();
      }
      if (implementsList != null) {
        for (        PsiJavaCodeReferenceElement referenceElement : implementsList.getReferenceElements()) {
          extendsList.addAfter(referenceElement,null);
          referenceElement.delete();
        }
      }
    }
    convertPsiClass(myClass,myMakeInterface);
    UndoUtil.markPsiFileForUndo(file);
  }
 catch (  IncorrectOperationException e) {
    LOG.error(e);
  }
}
