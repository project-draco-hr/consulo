{
  final Module dep=createModule("dep");
  final VirtualFile depSrcRoot=addSourceRoot(dep,false);
  final VirtualFile depTestRoot=addSourceRoot(dep,true);
  final VirtualFile depOutput=setModuleOutput(dep,false);
  final VirtualFile depTestOutput=setModuleOutput(dep,true);
  addLibraryDependency(dep,createJDomLibrary(),DependencyScope.COMPILE,true);
  addModuleDependency(myModule,dep,DependencyScope.COMPILE,true);
  final VirtualFile srcRoot=addSourceRoot(myModule,false);
  final VirtualFile testRoot=addSourceRoot(myModule,true);
  final VirtualFile output=setModuleOutput(myModule,false);
  final VirtualFile testOutput=setModuleOutput(myModule,true);
  assertClassRoots(orderEntries(myModule).withoutSdk(),testOutput,output,depTestOutput,depOutput);
  assertClassRoots(orderEntries(myModule).withoutSdk().recursively(),testOutput,output,depTestOutput,depOutput,getJDomJar());
  assertSourceRoots(orderEntries(myModule),srcRoot,testRoot,depSrcRoot,depTestRoot);
  assertSourceRoots(orderEntries(myModule).recursively(),srcRoot,testRoot,depSrcRoot,depTestRoot,getJDomSources());
  assertEnumeratorRoots(orderEntries(myModule).withoutSdk().recursively().classes().withoutSelfModuleOutput(),output,depTestOutput,depOutput,getJDomJar());
  assertEnumeratorRoots(orderEntries(myModule).productionOnly().withoutSdk().recursively().classes().withoutSelfModuleOutput(),depOutput,getJDomJar());
  assertClassRoots(orderEntries(myModule).withoutSdk().withoutModuleSourceEntries().recursively(),getJDomJar());
  assertSourceRoots(orderEntries(myModule).withoutSdk().withoutModuleSourceEntries().recursively(),getJDomSources());
  assertEnumeratorRoots(orderEntries(myModule).withoutSdk().withoutModuleSourceEntries().recursively().classes(),getJDomJar());
  assertEnumeratorRoots(orderEntries(myModule).withoutSdk().withoutModuleSourceEntries().recursively().sources(),getJDomSources());
}
