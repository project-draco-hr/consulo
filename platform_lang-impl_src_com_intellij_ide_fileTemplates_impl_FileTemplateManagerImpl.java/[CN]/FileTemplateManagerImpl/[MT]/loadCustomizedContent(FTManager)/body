{
  final File configRoot=manager.getConfigRoot(false);
  File[] configFiles=configRoot.listFiles();
  if (configFiles == null) {
    return;
  }
  final List<File> oldFormatTemplates=new ArrayList<File>();
  final Set<String> processedNames=new HashSet<String>();
  for (  File file : configFiles) {
    if (file.isDirectory() || myTypeManager.isFileIgnored(file.getName()) || file.isHidden()) {
      continue;
    }
    String name=file.getName();
    if (!name.endsWith(FTManager.TEMPLATE_EXTENSION_SUFFIX)) {
      oldFormatTemplates.add(file);
      continue;
    }
    name=name.substring(0,name.length() - FTManager.TEMPLATE_EXTENSION_SUFFIX.length());
    processedNames.add(name);
    addTemplateFromFile(manager,name,file);
  }
  for (  File oldFile : oldFormatTemplates) {
    final String name=oldFile.getName();
    if (!processedNames.contains(name)) {
      addTemplateFromFile(manager,name,oldFile);
    }
    FileUtil.delete(oldFile);
  }
}
