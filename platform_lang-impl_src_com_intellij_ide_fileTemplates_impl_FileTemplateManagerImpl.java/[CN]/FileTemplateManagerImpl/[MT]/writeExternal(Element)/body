{
  for (  FTManager child : myAllManagers) {
    child.saveTemplates();
  }
  validateRecentNames();
  final Element recentElement=new Element(ELEMENT_RECENT_TEMPLATES);
  element.addContent(recentElement);
  myRecentList.writeExternal(recentElement);
  for (  FTManager manager : myAllManagers) {
    final Element templatesGroup=new Element(getXmlElementGroupName(manager));
    element.addContent(templatesGroup);
    for (    FileTemplateBase template : manager.getAllTemplates(true)) {
      boolean shouldSave=template.isReformatCode() != FileTemplateBase.DEFAULT_REFORMAT_CODE_VALUE;
      if (template instanceof BundledFileTemplate) {
        shouldSave|=((BundledFileTemplate)template).isEnabled() != FileTemplateBase.DEFAULT_ENABLED_VALUE;
      }
      if (!shouldSave) {
        continue;
      }
      final Element templateElement=new Element(ELEMENT_TEMPLATE);
      templateElement.setAttribute(ATTRIBUTE_NAME,template.getQualifiedName());
      templateElement.setAttribute(ATTRIBUTE_REFORMAT,Boolean.toString(template.isReformatCode()));
      if (template instanceof BundledFileTemplate) {
        templateElement.setAttribute(ATTRIBUTE_ENABLED,Boolean.toString(((BundledFileTemplate)template).isEnabled()));
      }
      templatesGroup.addContent(templateElement);
    }
  }
}
