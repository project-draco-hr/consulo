{
  Editor textEditor=FileEditorManager.getInstance(project).getSelectedTextEditor();
  if (textEditor != null) {
    Document document=textEditor.getDocument();
    VirtualFile file=FileDocumentManager.getInstance().getFile(document);
    VirtualFile repo=VcsUtil.getVcsRootFor(project,file);
    if (repo != null) {
      HgTagBranchCommand hgTagBranchCommand=new HgTagBranchCommand(project,repo);
      String branch=hgTagBranchCommand.getCurrentBranch();
      List<HgRevisionNumber> parents=new HgWorkingCopyRevisionsCommand(project).parents(repo);
      hgCurrentBranchStatus.updateFor(branch,parents);
      return;
    }
  }
  hgCurrentBranchStatus.updateFor(null,Collections.<HgRevisionNumber>emptyList());
}
