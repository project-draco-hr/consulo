{
  List result=new ArrayList();
  DataInputStream in=new DataInputStream(stream);
  String rootName=in.readUTF();
  LOG.assertTrue(root.getName().equals(rootName));
  _readFileIndex(in,root,filter,result);
  return (VirtualFile[])result.toArray(new VirtualFile[result.size()]);
}
