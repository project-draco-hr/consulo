{
  DiffRequest diffData=getDiffData(e.getDataContext());
  boolean enabled=diffData != null && (!diffData.isSafeToCallFromUpdate() || (diffData.getContents() != null && DiffManager.getInstance().getDiffTool().canShow(diffData)));
  Presentation presentation=e.getPresentation();
  presentation.setEnabled(enabled);
  if (enabled)   presentation.setVisible(true);
 else   disableAction(presentation);
}
