{
  File parent=new File(getTempDirectory());
  final String originalFileName=file.getName();
  File tempFile=getTempFile(originalFileName,parent);
  if (!file.renameTo(tempFile)) {
    parent=file.getParentFile();
    tempFile=getTempFile(originalFileName,parent);
    if (!file.renameTo(tempFile)) {
      delete(file);
      return null;
    }
  }
  return tempFile;
}
