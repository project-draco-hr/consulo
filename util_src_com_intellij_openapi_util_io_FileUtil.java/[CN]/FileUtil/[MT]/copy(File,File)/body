{
  if (!toFile.exists()) {
    File parentFile=toFile.getParentFile();
    if (parentFile == null) {
      return;
    }
    parentFile.mkdirs();
    toFile.createNewFile();
  }
  FileInputStream fis=new FileInputStream(fromFile);
  FileOutputStream fos=new FileOutputStream(toFile);
  if (Patches.FILE_CHANNEL_TRANSFER_BROKEN) {
    try {
      copy(fis,fos);
    }
  finally {
      fis.close();
      fos.close();
    }
  }
 else {
    FileChannel fromChannel=fis.getChannel();
    FileChannel toChannel=fos.getChannel();
    try {
      fromChannel.transferTo(0,fromFile.length(),toChannel);
    }
  finally {
      fromChannel.close();
      toChannel.close();
    }
  }
  toFile.setLastModified(fromFile.lastModified());
}
