{
  final Object object=treeNode.getUserObject();
  Assert.assertNotNull(object);
  if (!(object instanceof NodeDescriptor))   return null;
  final NodeElement element=(NodeElement)((NodeDescriptor)object).getElement();
  if (toFind.equals(element))   return treeNode;
  for (int i=0; i < treeNode.getChildCount(); i++) {
    final DefaultMutableTreeNode result=findNode((DefaultMutableTreeNode)treeNode.getChildAt(i),toFind,shouldBeSelected);
    if (result != null) {
      if (shouldBeSelected) {
        final TreePath path=new TreePath(result.getPath());
        Assert.assertTrue("Path should be selected: " + path,myTree.isPathSelected(path));
      }
      return result;
    }
  }
  return null;
}
