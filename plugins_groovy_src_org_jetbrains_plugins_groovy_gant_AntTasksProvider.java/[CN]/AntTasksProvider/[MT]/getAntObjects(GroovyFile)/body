{
  return CachedValuesManager.getManager(groovyFile.getProject()).getCachedValue(groovyFile,ANT_OBJECTS,new CachedValueProvider<Map<String,Class>>(){
    @Override public Result<Map<String,Class>> compute(){
      final Module module=ModuleUtil.findModuleForPsiElement(groovyFile);
      Set<VirtualFile> jars=new HashSet<VirtualFile>();
      if (module != null) {
        ContainerUtil.addAll(jars,OrderEnumerator.orderEntries(module).getAllLibrariesAndSdkClassesRoots());
      }
      if (groovyFile.isScript() && GroovyScriptTypeDetector.getScriptType(groovyFile) instanceof GantScriptType) {
        jars.addAll(GantScriptType.additionalScopeFiles(groovyFile));
      }
      final ArrayList<URL> urls=new ArrayList<URL>();
      for (      VirtualFile jar : jars) {
        urls.add(VfsUtil.convertToURL(PathUtil.getLocalFile(jar).getUrl()));
      }
      final ClassLoader loader=new UrlClassLoader(urls,null,false,false,true);
      final ReflectedProject antProject=ReflectedProject.getProject(loader);
      final Map<String,Class> result=new HashMap<String,Class>();
      final Map<String,Class> taskDefinitions=antProject.getTaskDefinitions();
      if (taskDefinitions != null) {
        result.putAll(taskDefinitions);
      }
      final Map<String,Class> dataTypeDefinitions=antProject.getDataTypeDefinitions();
      if (dataTypeDefinitions != null) {
        result.putAll(dataTypeDefinitions);
      }
      return Result.create(result,ProjectRootManager.getInstance(groovyFile.getProject()));
    }
  }
,false);
}
