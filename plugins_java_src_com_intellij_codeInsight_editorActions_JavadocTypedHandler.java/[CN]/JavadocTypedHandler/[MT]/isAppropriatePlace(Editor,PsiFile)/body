{
  FileViewProvider provider=file.getViewProvider();
  int offset=editor.getCaretModel().getOffset();
  final PsiElement elementAtCaret;
  if (offset < editor.getDocument().getTextLength()) {
    elementAtCaret=provider.findElementAt(offset);
  }
 else {
    elementAtCaret=provider.findElementAt(editor.getDocument().getTextLength() - 1);
  }
  PsiElement element=elementAtCaret;
  while (element instanceof PsiWhiteSpace) {
    element=element.getPrevSibling();
  }
  if (element == null) {
    return false;
  }
  if (element instanceof PsiDocParamRef) {
    element=element.getParent();
  }
  if (element instanceof PsiDocTag) {
    PsiDocTag tag=(PsiDocTag)element;
    if ("param".equals(tag.getName())) {
      final PsiDocTagValue value=tag.getValueElement();
      if (value == null || value.getTextRange().getEndOffset() == offset) {
        return false;
      }
    }
  }
  ASTNode node=element.getNode();
  return node != null && (JavaDocTokenType.ALL_JAVADOC_TOKENS.contains(node.getElementType()) || JavaDocElementType.ALL_JAVADOC_ELEMENTS.contains(node.getElementType()));
}
