{
  int maxIndex=-1;
  ClassLoader bestLoader=null;
  if (interfaces != null && interfaces.length > 0) {
    for (    final Class anInterface : interfaces) {
      final ClassLoader loader=anInterface.getClassLoader();
      if (loader instanceof PluginClassLoader) {
        final int order=PluginManager.getPluginLoadingOrder(((PluginClassLoader)loader).getPluginId());
        if (maxIndex < order) {
          maxIndex=order;
          bestLoader=loader;
        }
      }
    }
  }
  ClassLoader superLoader=null;
  if (superclass != null) {
    superLoader=superclass.getClassLoader();
    if (superLoader instanceof PluginClassLoader && maxIndex < PluginManager.getPluginLoadingOrder(((PluginClassLoader)superLoader).getPluginId())) {
      return superLoader;
    }
  }
  if (bestLoader != null)   return bestLoader;
  return superLoader;
}
