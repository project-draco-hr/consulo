{
  if (expression instanceof PsiSuperExpression || expression instanceof PsiThisExpression)   return JavaResolveResult.EMPTY;
  PsiType type=expression.getType();
  if (type instanceof PsiClassType) {
    return ((PsiClassType)type).resolveGenerics();
  }
  if (type instanceof PsiDisjunctionType) {
    final PsiType lub=((PsiDisjunctionType)type).getLeastUpperBound();
    if (lub instanceof PsiClassType) {
      return ((PsiClassType)lub).resolveGenerics();
    }
  }
  if (type == null && expression instanceof PsiReferenceExpression) {
    JavaResolveResult resolveResult=((PsiReferenceExpression)expression).advancedResolve(false);
    if (resolveResult.getElement() instanceof PsiClass) {
      return resolveResult;
    }
  }
  return JavaResolveResult.EMPTY;
}
