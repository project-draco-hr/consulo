{
  final Ref<Boolean> refCannotEvaluate=new Ref<Boolean>();
  expression.accept(new PsiRecursiveElementVisitor(){
    public void visitReferenceExpression(    final PsiReferenceExpression expression){
      super.visitReferenceExpression(expression);
      final PsiElement element=expression.resolve();
      if (!canEvaluate(expression,element,elementsToReplace)) {
        refCannotEvaluate.set(Boolean.TRUE);
      }
    }
  }
);
  return refCannotEvaluate.isNull();
}
