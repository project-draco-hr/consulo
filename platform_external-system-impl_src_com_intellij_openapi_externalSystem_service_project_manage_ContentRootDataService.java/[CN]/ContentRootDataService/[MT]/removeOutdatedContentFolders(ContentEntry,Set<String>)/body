{
  final List<ContentFolder> sourceFolders=ContainerUtilRt.newArrayList(entry.getFolders(ContentFolderType.ALL_SOURCE_ROOTS));
  for (  final ContentFolder sourceFolder : sourceFolders) {
    final String path=VirtualFileManager.extractPath(sourceFolder.getUrl());
    if (!retainedContentFolders.contains(path)) {
      entry.removeFolder(sourceFolder);
    }
  }
  final List<ContentFolder> excludeFolders=ContainerUtilRt.newArrayList(entry.getFolders(ContentFolderType.EXCLUDED));
  for (  final ContentFolder excludeFolder : excludeFolders) {
    final String path=VirtualFileManager.extractPath(excludeFolder.getUrl());
    if (!(excludeFolder.isSynthetic()) && !retainedContentFolders.contains(path)) {
      entry.removeFolder(excludeFolder);
    }
  }
}
