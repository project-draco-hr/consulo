{
  final ThreadReferenceProxyImpl currentThreadProxy=suspendContext.getThread();
  if (currentThreadProxy == null || !currentThreadProxy.isSuspended())   return false;
  if (LOG.isDebugEnabled()) {
    LOG.debug("DO_STEP: creating step request for " + currentThreadProxy.getThreadReference());
  }
  deleteStepRequests(suspendContext.getThread());
  EventRequestManager requestManager=getVirtualMachineProxy().eventRequestManager();
  StepRequest stepRequest=requestManager.createStepRequest(currentThreadProxy.getThreadReference(),StepRequest.STEP_LINE,depth);
  DebuggerSettings settings=DebuggerSettings.getInstance();
  if (!(hint != null && hint.isIgnoreFilters()) && depth == StepRequest.STEP_INTO) {
    if (settings.TRACING_FILTERS_ENABLED) {
      String currentClassName=getCurrentClassName(currentThreadProxy);
      if (currentClassName == null || !settings.isNameFiltered(currentClassName)) {
        ClassFilter[] filters=settings.getFilters();
        for (int idx=0; idx < filters.length; idx++) {
          if (filters[idx].isEnabled()) {
            stepRequest.addClassExclusionFilter(filters[idx].getPattern());
          }
        }
      }
    }
  }
  stepRequest.setSuspendPolicy(getSuspendPolicy());
  if (hint != null) {
    stepRequest.putProperty("hint",hint);
  }
  stepRequest.enable();
  return true;
}
