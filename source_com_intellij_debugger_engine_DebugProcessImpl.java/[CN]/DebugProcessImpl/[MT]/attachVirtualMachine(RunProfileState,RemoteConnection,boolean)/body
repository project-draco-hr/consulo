{
  myWaitFor.down();
  LOG.assertTrue(SwingUtilities.isEventDispatchThread());
  LOG.assertTrue(myState == STATE_INITIAL);
  myConnection=remoteConnection;
  createVirtualMachine(pollConnection);
  try {
synchronized (myProcessListeners) {
      myExecution=state.execute();
      for (Iterator<ProcessListener> iterator=myProcessListeners.iterator(); iterator.hasNext(); ) {
        ProcessListener processListener=iterator.next();
        myExecution.getProcessHandler().addProcessListener(processListener);
      }
      myProcessListeners.clear();
    }
  }
 catch (  ExecutionException e) {
    stop(false);
    throw e;
  }
  if (ApplicationManager.getApplication().isUnitTestMode()) {
    return myExecution;
  }
  final Alarm debugPortTimeout=new Alarm(Alarm.ThreadToUse.SHARED_THREAD);
  myExecution.getProcessHandler().addProcessListener(new ProcessAdapter(){
    public void processTerminated(    ProcessEvent event){
      debugPortTimeout.cancelAllRequests();
    }
    public void startNotified(    ProcessEvent event){
      debugPortTimeout.addRequest(new Runnable(){
        public void run(){
          if (myState == STATE_INITIAL) {
            ApplicationManager.getApplication().invokeLater(new Runnable(){
              public void run(){
                String message=createConnectionStatusMessage("Check your run/debug configuration. Failed to establish connection to the target VM",remoteConnection);
                Messages.showErrorDialog(myProject,message,"Cannot Debug Application");
              }
            }
);
          }
        }
      }
,LOCAL_START_TIMEOUT);
    }
  }
);
  return myExecution;
}
