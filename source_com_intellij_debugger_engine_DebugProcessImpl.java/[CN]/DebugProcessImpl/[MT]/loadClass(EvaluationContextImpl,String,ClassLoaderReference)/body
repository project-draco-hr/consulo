{
  DebuggerManagerThreadImpl.assertIsManagerThread();
  qName=reformatArrayName(qName);
  ReferenceType refType=null;
  VirtualMachine virtualMachine=getVirtualMachineProxy().getVirtualMachine();
  final List classClasses=virtualMachine.classesByName("java.lang.Class");
  if (classClasses.size() > 0) {
    ClassType classClassType=(ClassType)classClasses.get(0);
    final Method forNameMethod;
    if (classLoader != null) {
      forNameMethod=classClassType.concreteMethodByName("forName","(Ljava/lang/String;ZLjava/lang/ClassLoader;)Ljava/lang/Class;");
    }
 else {
      forNameMethod=classClassType.concreteMethodByName("forName","(Ljava/lang/String;)Ljava/lang/Class;");
    }
    final List args=new ArrayList();
    final StringReference qNameMirror=virtualMachine.mirrorOf(qName);
    qNameMirror.disableCollection();
    args.add(qNameMirror);
    if (classLoader != null) {
      args.add(virtualMachine.mirrorOf(true));
      args.add(classLoader);
    }
    try {
      final Value value=invokeMethod(evaluationContext,classClassType,forNameMethod,args);
      if (value instanceof ClassObjectReference) {
        refType=((ClassObjectReference)value).reflectedType();
      }
    }
  finally {
      qNameMirror.enableCollection();
    }
  }
  return refType;
}
