{
  final ArrayList<GrImportStatement> importStatements=new ArrayList<GrImportStatement>(Arrays.asList(myFile.getImportStatements()));
  myFile.accept(new GroovyRecursiveElementVisitor(){
    public void visitCodeReferenceElement(    GrCodeReferenceElement refElement){
      visitRefElement(refElement);
    }
    public void visitReferenceExpression(    GrReferenceExpression referenceExpression){
      visitRefElement(referenceExpression);
    }
    private void visitRefElement(    GrReferenceElement refElement){
      final GroovyResolveResult resolveResult=refElement.advancedResolve();
      final GrImportStatement importStatement=resolveResult.getImportStatementContext();
      if (importStatement != null) {
        importStatements.remove(importStatement);
      }
    }
  }
);
  for (  GrImportStatement importStatement : importStatements) {
    try {
      myFile.removeImport(importStatement);
    }
 catch (    IncorrectOperationException e) {
      LOG.error(e);
    }
  }
}
