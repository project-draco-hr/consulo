{
  String text;
  int offset;
  if (element instanceof XmlAttributeValue) {
    text=((XmlAttributeValue)element).getValue();
    String s=element.getText();
    offset=StringUtil.startsWithChar(s,'"') || StringUtil.startsWithChar(s,'\'') ? 1 : 0;
  }
 else   if (element instanceof XmlTag) {
    final XmlTag tag=((XmlTag)element);
    final XmlTagValue value=tag.getValue();
    final String s=value.getText();
    text=s.trim();
    offset=value.getTextRange().getStartOffset() + s.indexOf(text) - element.getTextOffset();
  }
 else {
    return null;
  }
  if (text == null) {
    return null;
  }
  for (  final FileReferenceHelper helper : FileReferenceHelperRegistrar.getHelpers()) {
    text=helper.trimUrl(text);
  }
  return new FileReferenceSet(text,element,offset,ReferenceType.FILE_TYPE,null,true,endingSlashNotAllowed,true){
    protected boolean isSoft(){
      return soft;
    }
  }
;
}
