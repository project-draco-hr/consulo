{
  final Editor editor=context.getEditor();
  final TailType tailType=getTailType(item,context);
  final PsiFile file=context.getFile();
  context.setAddCompletionChar(false);
  final boolean needLeftParenth=isToInsertParenth(file.findElementAt(context.getStartOffset()));
  final boolean needRightParenth=tailType != TailType.SMART_COMPLETION && CodeInsightSettings.getInstance().AUTOINSERT_PAIR_BRACKET;
  if (needLeftParenth) {
    final CodeStyleSettings styleSettings=CodeStyleSettingsManager.getSettings(context.getProject());
    ParenthesesInsertHandler.getInstance(hasParams,styleSettings.SPACE_BEFORE_METHOD_CALL_PARENTHESES,styleSettings.SPACE_WITHIN_METHOD_CALL_PARENTHESES && hasParams,needRightParenth,styleSettings.METHOD_PARAMETERS_LPAREN_ON_NEXT_LINE).handleInsert(context,item);
  }
  if (needLeftParenth && hasParams) {
    AutoPopupController.getInstance(file.getProject()).autoPopupParameterInfo(editor,overloadsMatter ? null : (PsiElement)item.getObject());
  }
  if (tailType == TailType.SEMICOLON) {
    if (!needRightParenth) {
      return;
    }
    PsiDocumentManager.getInstance(file.getProject()).commitAllDocuments();
    if (psiElement().beforeLeaf(psiElement().withText(".")).accepts(file.findElementAt(context.getTailOffset() - 1))) {
      return;
    }
  }
  if (tailType == TailType.SMART_COMPLETION || needLeftParenth && needRightParenth) {
    tailType.processTail(editor,context.getTailOffset());
  }
}
