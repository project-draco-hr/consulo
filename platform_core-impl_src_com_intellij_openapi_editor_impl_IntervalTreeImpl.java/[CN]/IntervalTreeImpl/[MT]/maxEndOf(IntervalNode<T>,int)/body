{
  if (node == null) {
    return 0;
  }
  if (node.isValid()) {
    return node.maxEnd + node.delta + deltaUpToRootExclusive;
  }
  return Math.max(maxEndOf(node.getLeft(),deltaUpToRootExclusive),maxEndOf(node.getRight(),deltaUpToRootExclusive));
}
