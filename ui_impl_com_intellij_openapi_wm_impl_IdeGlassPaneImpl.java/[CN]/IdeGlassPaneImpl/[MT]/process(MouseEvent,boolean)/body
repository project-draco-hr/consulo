{
  final boolean processingDragEnd=getMousePressedComponent() != null && e.getID() == MouseEvent.MOUSE_RELEASED;
  boolean repaint=true;
  if (processingDragEnd) {
    final Point releasePoint=SwingUtilities.convertPoint(e.getComponent(),e.getPoint(),getMousePressedComponent());
    redispatch(convertEvent(e,getMousePressedComponent(),releasePoint,MouseEvent.MOUSE_RELEASED),motionEvent,getMousePressedComponent());
  }
 else {
    final boolean processingDrag=getMousePressedComponent() != null && e.getID() == MouseEvent.MOUSE_DRAGGED;
    final JLayeredPane lp=myRootPane.getLayeredPane();
    final Point lpPoint=SwingUtilities.convertPoint(e.getComponent(),e.getPoint(),lp);
    if (!processForContainer(e,motionEvent,lp,lpPoint)) {
      boolean processed=false;
      final Container cp=myRootPane.getContentPane();
      final Point cpPoint=SwingUtilities.convertPoint(e.getComponent(),e.getPoint(),cp);
      if (!processingDrag && cpPoint.y < 0) {
        final JMenuBar mb=myRootPane.getJMenuBar();
        if (mb != null) {
          processed=processForContainer(e,motionEvent,mb,SwingUtilities.convertPoint(e.getComponent(),e.getPoint(),mb));
          if (processed) {
            repaint=false;
          }
        }
      }
      if (!processed) {
        processForContainer(e,motionEvent,cp,cpPoint);
      }
    }
  }
  if (repaint) {
    for (    Painter eachPainter : myPainters) {
      if (eachPainter.needsRepaint()) {
        repaint();
        break;
      }
    }
  }
}
