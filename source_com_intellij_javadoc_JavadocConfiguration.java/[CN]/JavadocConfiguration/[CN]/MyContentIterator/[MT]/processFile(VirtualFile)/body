{
  if (!fileOrDir.isInLocalFileSystem()) {
    return true;
  }
  final Module module=ModuleUtil.findModuleForFile(fileOrDir,myPsiManager.getProject());
  final PsiDirectory directory=getPsiDirectory(fileOrDir);
  if (directory == null) {
    if (!StdFileTypes.JAVA.equals(FileTypeManager.getInstance().getFileTypeByFile(fileOrDir))) {
      return true;
    }
    PsiPackage psiPackage=getPsiPackage(fileOrDir.getParent());
    if (psiPackage != null) {
      if (psiPackage.getQualifiedName().length() == 0 || ModuleUtil.containsPackagePrefix(module,psiPackage.getQualifiedName())) {
        mySourceFiles.add(PathUtil.getLocalPath(fileOrDir));
      }
    }
    return true;
  }
 else {
    processDirWithJavaFiles(directory,myPackages,mySourceFiles,module);
  }
  return true;
}
