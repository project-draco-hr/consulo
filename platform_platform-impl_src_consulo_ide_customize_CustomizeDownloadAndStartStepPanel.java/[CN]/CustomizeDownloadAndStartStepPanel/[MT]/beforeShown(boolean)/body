{
  final Set<IdeaPluginDescriptor> pluginsForDownload=myPluginsStepPanel == null ? Collections.<IdeaPluginDescriptor>emptySet() : myPluginsStepPanel.getPluginsForDownload();
  if (pluginsForDownload.isEmpty()) {
    add(createStartButton());
  }
 else {
    JPanel panel=new JPanel(new VerticalFlowLayout(VerticalFlowLayout.MIDDLE,true,true));
    JBLabel infoLabel=new JBLabel("");
    panel.add(infoLabel);
    JProgressBar progressBar=new JProgressBar();
    panel.add(progressBar);
    add(panel);
    final ProgressIndicator indicator=new MyProgressIndicator(infoLabel,progressBar);
    ApplicationManager.getApplication().executeOnPooledThread(new Runnable(){
      @Override public void run(){
        for (        IdeaPluginDescriptor ideaPluginDescriptor : pluginsForDownload) {
          try {
            PluginDownloader downloader=PluginDownloader.createDownloader(ideaPluginDescriptor);
            downloader.prepareToInstall(indicator);
            downloader.install(true);
          }
 catch (          Exception e) {
            CustomizeDownloadAndStartStepPanel.LOGGER.warn(e);
          }
        }
        myDone=true;
        UIUtil.invokeLaterIfNeeded(new Runnable(){
          @Override public void run(){
            placeStartButton();
          }
        }
);
      }
    }
);
  }
  return true;
}
