{
  myProject=project;
  myDumbService=dumbService;
  final ExtensionPoint<MultiHostInjectorExtensionPoint> multiPoint=Extensions.getArea(project).getExtensionPoint(MultiHostInjector.EP_NAME);
  multiPoint.addExtensionPointListener(new ExtensionPointListener<MultiHostInjectorExtensionPoint>(){
    @Override public void extensionAdded(    @NotNull MultiHostInjectorExtensionPoint ep,    @Nullable PluginDescriptor pluginDescriptor){
      registerMultiHostInjector(ep.getInstance(project),ep.getKey());
    }
    @Override public void extensionRemoved(    @NotNull MultiHostInjectorExtensionPoint ep,    @Nullable PluginDescriptor pluginDescriptor){
      unregisterMultiHostInjector(ep.getInstance(project));
    }
  }
,this);
  final ExtensionPointListener<LanguageInjector> myListener=new ExtensionPointListener<LanguageInjector>(){
    @Override public void extensionAdded(    @NotNull LanguageInjector extension,    @Nullable PluginDescriptor pluginDescriptor){
      psiManagerInjectorsChanged();
    }
    @Override public void extensionRemoved(    @NotNull LanguageInjector extension,    @Nullable PluginDescriptor pluginDescriptor){
      psiManagerInjectorsChanged();
    }
  }
;
  final ExtensionPoint<LanguageInjector> psiManagerPoint=Extensions.getRootArea().getExtensionPoint(LanguageInjector.EXTENSION_POINT_NAME);
  psiManagerPoint.addExtensionPointListener(myListener,this);
  myProgress=new DaemonProgressIndicator();
  project.getMessageBus().connect(this).subscribe(DaemonCodeAnalyzer.DAEMON_EVENT_TOPIC,new DaemonCodeAnalyzer.DaemonListenerAdapter(){
    @Override public void daemonCancelEventOccurred(    @NotNull String reason){
      myProgress.cancel();
    }
  }
);
}
