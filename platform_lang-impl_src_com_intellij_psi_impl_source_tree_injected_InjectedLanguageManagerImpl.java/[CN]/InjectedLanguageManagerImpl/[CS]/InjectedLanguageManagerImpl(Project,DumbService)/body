{
  myProject=project;
  myDumbService=dumbService;
  final ExtensionPoint<MultiHostInjector> multiPoint=Extensions.getArea(project).getExtensionPoint(MultiHostInjector.MULTIHOST_INJECTOR_EP_NAME);
  multiPoint.addExtensionPointListener(new ExtensionPointListener<MultiHostInjector>(){
    @Override public void extensionAdded(    @NotNull MultiHostInjector injector,    @Nullable PluginDescriptor pluginDescriptor){
      registerMultiHostInjector(injector);
    }
    @Override public void extensionRemoved(    @NotNull MultiHostInjector injector,    @Nullable PluginDescriptor pluginDescriptor){
      unregisterMultiHostInjector(injector);
    }
  }
,this);
  final ExtensionPointListener<LanguageInjector> myListener=new ExtensionPointListener<LanguageInjector>(){
    @Override public void extensionAdded(    @NotNull LanguageInjector extension,    @Nullable PluginDescriptor pluginDescriptor){
      psiManagerInjectorsChanged();
    }
    @Override public void extensionRemoved(    @NotNull LanguageInjector extension,    @Nullable PluginDescriptor pluginDescriptor){
      psiManagerInjectorsChanged();
    }
  }
;
  final ExtensionPoint<LanguageInjector> psiManagerPoint=Extensions.getRootArea().getExtensionPoint(LanguageInjector.EXTENSION_POINT_NAME);
  psiManagerPoint.addExtensionPointListener(myListener,this);
  myProgress=new DaemonProgressIndicator();
  project.getMessageBus().connect(this).subscribe(DaemonCodeAnalyzer.DAEMON_EVENT_TOPIC,new DaemonCodeAnalyzer.DaemonListener(){
    @Override public void daemonFinished(){
    }
    @Override public void daemonCancelEventOccurred(){
      myProgress.cancel();
    }
  }
);
}
