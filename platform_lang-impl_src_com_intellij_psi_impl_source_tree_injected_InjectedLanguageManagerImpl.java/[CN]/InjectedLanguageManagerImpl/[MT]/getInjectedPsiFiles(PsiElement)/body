{
  if (!(host instanceof PsiLanguageInjectionHost) || !((PsiLanguageInjectionHost)host).isValidHost()) {
    return null;
  }
  final PsiElement inTree=InjectedLanguageUtil.loadTree(host,host.getContainingFile());
  final List<Pair<PsiElement,TextRange>> result=new SmartList<Pair<PsiElement,TextRange>>();
  InjectedLanguageUtil.enumerate(inTree,new PsiLanguageInjectionHost.InjectedPsiVisitor(){
    @Override public void visit(    @NotNull PsiFile injectedPsi,    @NotNull List<PsiLanguageInjectionHost.Shred> places){
      for (      PsiLanguageInjectionHost.Shred place : places) {
        if (place.getHost() == inTree) {
          result.add(new Pair<PsiElement,TextRange>(injectedPsi,place.getRangeInsideHost()));
        }
      }
    }
  }
);
  return result.isEmpty() ? null : result;
}
