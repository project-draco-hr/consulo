{
  if (offset < 0 || offset > getTextLength())   throw new IndexOutOfBoundsException("Wrong offset: " + offset);
  ApplicationManager.getApplication().assertWriteAccessAllowed();
  assertValidSeparators(s);
  if (!isWritable())   throw new ReadOnlyModificationException(this);
  if (s.length() == 0)   return;
  RangeMarker marker=getRangeGuard(offset,offset);
  if (marker != null) {
    throwGuardedFragment(marker,offset,null,s.toString());
  }
  myText.insert(s,offset);
}
