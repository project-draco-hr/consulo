{
  CompilerConfiguration compilerConfiguration=new CompilerConfiguration();
  compilerConfiguration.setOutput(new PrintWriter(System.err));
  compilerConfiguration.setWarningLevel(WarningMessage.PARANOIA);
  if (encoding != null) {
    compilerConfiguration.setSourceEncoding(encoding);
  }
  compilerConfiguration.setClasspath(classpath);
  compilerConfiguration.setTargetDirectory(outputPath);
  CompilationUnit compilationUnit=new CompilationUnit(compilerConfiguration,null,buildClassLoaderFor(compilerConfiguration)){
    public void gotoPhase(    int phase) throws CompilationFailedException {
      super.gotoPhase(phase);
      if (phase <= Phases.ALL) {
        System.out.println(PRESENTABLE_MESSAGE + "Groovy compiler: " + getPhaseDescription());
      }
    }
  }
;
  if (isGrailsModule) {
    PhaseOperationUtil.addGrailsAwareInjectionOperation(class2File,compilationUnit,compilerConfiguration);
  }
  return compilationUnit;
}
