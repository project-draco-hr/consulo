{
  return AccessController.doPrivileged(new PrivilegedAction<GroovyClassLoader>(){
    public GroovyClassLoader run(){
      return new GroovyClassLoader(getClass().getClassLoader(),compilerConfiguration){
        public Class loadClass(        String name,        boolean lookupScriptFiles,        boolean preferClassOverScript) throws ClassNotFoundException, CompilationFailedException {
          try {
            return super.loadClass(name,lookupScriptFiles,preferClassOverScript);
          }
 catch (          NoClassDefFoundError e) {
            final String ncdfe=e.getMessage();
            throw new RuntimeException("Groovyc error: " + ncdfe + " class not found while resolving class "+ name,e);
          }
catch (          LinkageError e) {
            throw new RuntimeException("Problem loading class " + name,e);
          }
        }
      }
;
    }
  }
);
}
