{
  final TreePath[] paths=getSelectionPaths();
  if (paths == null)   return null;
  InspectionToolWrapper toolWrapper=null;
  for (  TreePath path : paths) {
    Object[] nodes=path.getPath();
    for (int j=nodes.length - 1; j >= 0; j--) {
      Object node=nodes[j];
      if (node instanceof InspectionNode) {
        InspectionToolWrapper wrapper=((InspectionNode)node).getToolWrapper();
        if (toolWrapper == null) {
          toolWrapper=wrapper;
        }
 else         if (toolWrapper != wrapper) {
          return null;
        }
        break;
      }
    }
  }
  return toolWrapper;
}
