{
  myFilePointerManager=filePointerManager;
  myModuleRootManager=moduleRootManager;
  myProjectRootManager=projectRootManager;
  myModuleLibraryTable=new ModuleLibraryTable(this,myProjectRootManager,myFilePointerManager);
  myWritable=writable;
  myConfigurationAccessor=rootConfigurationAccessor;
  LOG.assertTrue(!writable || virtualFilePointerListener == null);
  myVirtualFilePointerListener=virtualFilePointerListener;
  if (rootModel.myExplodedDirectoryPointer != null) {
    myExplodedDirectoryPointer=pointerFactory().duplicate(rootModel.myExplodedDirectoryPointer);
  }
  myExplodedDirectory=rootModel.myExplodedDirectory;
  myExcludeExploded=rootModel.myExcludeExploded;
  final TreeSet<ContentEntry> thatContent=rootModel.myContent;
  for (  ContentEntry contentEntry : thatContent) {
    if (contentEntry instanceof ClonableContentEntry) {
      myContent.add(((ClonableContentEntry)contentEntry).cloneEntry(this));
    }
  }
  final List<OrderEntry> order=rootModel.myOrderEntries;
  for (  OrderEntry orderEntry : order) {
    if (orderEntry instanceof ClonableOrderEntry) {
      myOrderEntries.add(((ClonableOrderEntry)orderEntry).cloneEntry(this,myProjectRootManager,myFilePointerManager));
    }
  }
  myOrderEntryProperties=rootModel.myOrderEntryProperties.copy(this);
  for (  OrderRootType orderRootType : OrderRootType.getAllTypes()) {
    final VirtualFilePointerContainer otherContainer=rootModel.getOrderRootContainer(orderRootType);
    if (otherContainer != null) {
      VirtualFilePointerContainer container=myFilePointerManager.createContainer(myVirtualFilePointerFactory);
      container.addAll(otherContainer);
      myOrderRootPointerContainers.put(orderRootType,container);
    }
  }
  for (  ModuleExtension extension : rootModel.myExtensions) {
    myExtensions.add(writable ? extension.getModifiableModel(writable) : extension);
  }
}
