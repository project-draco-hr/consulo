{
  final List<Module> result=new ArrayList<Module>();
  for (  OrderEntry entry : getOrderEntries()) {
    if (entry instanceof ModuleOrderEntry) {
      ModuleOrderEntry moduleOrderEntry=(ModuleOrderEntry)entry;
      if (!includeTests && moduleOrderEntry.getScope() == DependencyScope.TEST) {
        continue;
      }
      final Module module1=moduleOrderEntry.getModule();
      if (module1 != null) {
        result.add(module1);
      }
    }
  }
  return ContainerUtil.toArray(result,new Module[result.size()]);
}
