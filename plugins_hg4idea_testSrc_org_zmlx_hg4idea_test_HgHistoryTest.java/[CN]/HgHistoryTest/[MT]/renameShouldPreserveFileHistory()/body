{
  int versions=0;
  fillFile(myProjectDir,new String[]{AFILE},INITIAL_FILE_CONTENT);
  addAll();
  commitAll("initial content");
  versions++;
  runHgOnProjectRepo("rename",AFILE,BFILE);
  commitAll("file renamed");
  versions++;
  fillFile(myProjectDir,new String[]{BFILE},UPDATED_FILE_CONTENT);
  commitAll("updated content");
  versions++;
  final VcsHistorySession session=getHistorySession(BFILE);
  final List<VcsFileRevision> revisions=session.getRevisionList();
  loadAllRevisions(revisions);
  assertEquals(revisions.size(),versions);
  assertTrue(session.isCurrentRevision(revisions.get(0).getRevisionNumber()));
  assertEquals(revisions.get(0).getContent(),UPDATED_FILE_CONTENT.getBytes());
  assertEquals(revisions.get(2).getContent(),INITIAL_FILE_CONTENT.getBytes());
}
