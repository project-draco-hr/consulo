{
  StringBuilder buffer=new StringBuilder();
  final boolean hasModifiers=ModifierListGenerator.writeModifiers(buffer,superMethod.getModifierList(),GROOVY_MODIFIERS,false);
  final PsiTypeParameter[] superTypeParameters=superMethod.getTypeParameters();
  final List<PsiTypeParameter> typeParameters=new ArrayList<PsiTypeParameter>();
  final Map<PsiTypeParameter,PsiType> map=substitutor.getSubstitutionMap();
  for (  PsiTypeParameter parameter : superTypeParameters) {
    if (!map.containsKey(parameter)) {
      typeParameters.add(parameter);
    }
  }
  final PsiType returnType=substitutor.substitute(getSuperReturnType(superMethod));
  boolean isConstructor=superMethod.isConstructor();
  if (!isConstructor && (!hasModifiers && returnType == null || typeParameters.size() > 0)) {
    buffer.append("def ");
  }
  if (typeParameters.size() > 0) {
    LOG.assertTrue(!isConstructor);
    buffer.append('<');
    for (    PsiTypeParameter parameter : typeParameters) {
      buffer.append(parameter.getText());
      buffer.append(", ");
    }
    buffer.replace(buffer.length() - 2,buffer.length(),">");
  }
  final String name;
  if (isConstructor) {
    name=aClass.getName();
  }
 else {
    if (returnType != null) {
      buffer.append(returnType.getCanonicalText()).append(" ");
    }
    name=superMethod.getName();
  }
  buffer.append(name);
  buffer.append("(");
  final PsiParameter[] parameters=superMethod.getParameterList().getParameters();
  for (int i=0; i < parameters.length; i++) {
    if (i > 0)     buffer.append(", ");
    PsiParameter parameter=parameters[i];
    if (!(parameter instanceof GrParameter && ((GrParameter)parameter).getTypeElementGroovy() == null)) {
      final PsiType parameterType=substitutor.substitute(parameter.getType());
      buffer.append(parameterType.getCanonicalText());
      buffer.append(" ");
    }
    final String paramName=parameter.getName();
    if (paramName != null) {
      buffer.append(paramName);
    }
 else     if (parameter instanceof PsiCompiledElement) {
      buffer.append(((PsiParameter)((PsiCompiledElement)parameter).getMirror()).getName());
    }
  }
  buffer.append(") {}");
  final GroovyPsiElementFactory factory=GroovyPsiElementFactory.getInstance(project);
  if (isConstructor) {
    return factory.createConstructorFromText(name,buffer.toString(),aClass);
  }
 else {
    return factory.createMethodFromText(buffer.toString(),aClass);
  }
}
