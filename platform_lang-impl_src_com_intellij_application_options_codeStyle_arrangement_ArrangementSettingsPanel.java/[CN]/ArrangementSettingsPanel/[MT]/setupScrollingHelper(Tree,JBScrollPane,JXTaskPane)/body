{
  final JViewport viewport=scrollPane.getViewport();
  viewport.addChangeListener(new ChangeListener(){
    private boolean mySkip;
    private int myYToRestore;
    @Override public void stateChanged(    ChangeEvent e){
      if (mySkip) {
        return;
      }
      myYToRestore=-1;
      if (editorPane.isCollapsed()) {
        if (myYToRestore >= 0) {
          scroll(myYToRestore);
          myYToRestore=-1;
        }
      }
 else {
        myYToRestore=-1;
      }
    }
    private void scroll(    int y){
      mySkip=true;
      try {
        viewport.setViewPosition(new Point(0,y));
      }
  finally {
        mySkip=false;
      }
    }
  }
);
}
