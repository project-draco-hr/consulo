{
  final JViewport viewport=scrollPane.getViewport();
  viewport.addChangeListener(new ChangeListener(){
    private int myWidth;
    @Override public void stateChanged(    ChangeEvent e){
      Rectangle visibleRect=viewport.getVisibleRect();
      if (visibleRect == null || visibleRect.width <= 0) {
        return;
      }
      if (myWidth != visibleRect.width) {
        myWidth=visibleRect.width;
        myRuleTree.updateCanvasWidth(myWidth);
      }
    }
  }
);
}
