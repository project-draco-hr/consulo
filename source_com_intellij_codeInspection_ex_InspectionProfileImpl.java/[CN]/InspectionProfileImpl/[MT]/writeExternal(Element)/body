{
  element.setAttribute("version",VALID_VERSION);
  for (Iterator<HighlightDisplayKey> iterator=myDisplayLevelMap.keySet().iterator(); iterator.hasNext(); ) {
    final HighlightDisplayKey key=iterator.next();
    Element inspectionElement=new Element("inspection_tool");
    final String toolName=key.toString();
    inspectionElement.setAttribute("class",toolName);
    inspectionElement.setAttribute("level",getErrorLevel(key).toString());
    inspectionElement.setAttribute("enabled",isToolEnabled(key) ? "true" : "false");
    final InspectionTool tool=getInspectionTool(toolName);
    if (tool != null) {
      tool.writeExternal(inspectionElement);
    }
    element.addContent(inspectionElement);
  }
  myVisibleTreeState.writeExternal(element);
  if (myAdditionalJavadocTags != null && myAdditionalJavadocTags.length() != 0) {
    final Element additionalTags=new Element("ADDITIONAL_JAVADOC_TAGS");
    additionalTags.setAttribute("value",myAdditionalJavadocTags);
    element.addContent(additionalTags);
  }
  if (myAdditionalHtmlTags != null && myAdditionalHtmlTags.length() != 0) {
    final Element additionalTags=new Element("ADDITIONAL_HTML_TAGS");
    additionalTags.setAttribute("value",myAdditionalHtmlTags);
    element.addContent(additionalTags);
  }
  if (myAdditionalHtmlAttributes != null && myAdditionalHtmlAttributes.length() != 0) {
    final Element additionalAttributes=new Element("ADDITIONAL_HTML_ATTRIBUTES");
    additionalAttributes.setAttribute("value",myAdditionalHtmlAttributes);
    element.addContent(additionalAttributes);
  }
  if (myAdditionalRequiredHtmlAttributes != null && myAdditionalRequiredHtmlAttributes.length() != 0) {
    final Element additionalAttributes=new Element("ADDITIONAL_REQUIRED_HTML_ATTRIBUTES");
    additionalAttributes.setAttribute("value",myAdditionalRequiredHtmlAttributes);
    element.addContent(additionalAttributes);
  }
  final Element unusedSymbolSettings=new Element("UNUSED_SYMBOL_SETTINGS");
  myUnusedSymbolSettings.writeExternal(unusedSymbolSettings);
  element.addContent(unusedSymbolSettings);
  if (myBaseProfile != null) {
    element.setAttribute("base_profile",myBaseProfile.getName());
  }
}
