{
  element.setAttribute("version",VALID_VERSION);
  for (Iterator<HighlightDisplayKey> iterator=myDisplayLevelMap.keySet().iterator(); iterator.hasNext(); ) {
    final HighlightDisplayKey key=iterator.next();
    Element inspectionElement=new Element("inspection_tool");
    final String toolName=key.toString();
    inspectionElement.setAttribute("class",toolName);
    inspectionElement.setAttribute("level",getErrorLevel(key).toString());
    inspectionElement.setAttribute("enabled",isToolEnabled(key) ? "true" : "false");
    final InspectionTool tool=getInspectionTool(toolName);
    if (tool != null) {
      tool.writeExternal(inspectionElement);
    }
    element.addContent(inspectionElement);
  }
  myVisibleTreeState.writeExternal(element);
  if (myAdditionalJavadocTags != null && myAdditionalJavadocTags.length() != 0) {
    final Element additionalTags=new Element("ADDITIONAL_JAVADOC_TAGS");
    additionalTags.setAttribute("value",myAdditionalJavadocTags);
    element.addContent(additionalTags);
  }
  if (myBaseProfile != null) {
    element.setAttribute("base_profile",myBaseProfile.getName());
  }
}
