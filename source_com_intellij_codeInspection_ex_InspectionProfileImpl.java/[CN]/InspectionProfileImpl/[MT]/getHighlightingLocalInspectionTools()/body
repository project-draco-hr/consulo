{
  ArrayList<LocalInspectionTool> enabled=new ArrayList<LocalInspectionTool>();
  final LocalInspectionToolWrapper[] tools=myLocalTools.isEmpty() ? getLocalInspectionToolWrappers() : myLocalTools.values().toArray(new LocalInspectionToolWrapper[myLocalTools.values().size()]);
  for (int i=0; i < tools.length; i++) {
    LocalInspectionToolWrapper tool=tools[i];
    final ToolState state=getToolState(HighlightDisplayKey.find(tool.getShortName()));
    if (state.isEnabled()) {
      enabled.add(tool.getTool());
    }
  }
  return enabled.toArray(new LocalInspectionTool[enabled.size()]);
}
