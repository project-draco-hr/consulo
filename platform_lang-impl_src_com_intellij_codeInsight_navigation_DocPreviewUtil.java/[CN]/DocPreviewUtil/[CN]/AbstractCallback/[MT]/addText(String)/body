{
  boolean addSpace=false;
  if (!text.isEmpty() && (text.startsWith(" ") || text.startsWith("\t"))) {
    myContext.buffer.append(text.charAt(0));
    myContext.currentColumn++;
  }
  String tailText=(!text.isEmpty() && (text.endsWith(" ") || text.endsWith("\t"))) ? text.substring(text.length() - 1) : null;
  text=text.trim();
  if (myInsidePre && text.contains("\n")) {
    boolean addLf=false;
    for (    String s : text.split("\n")) {
      if (addLf) {
        newLine();
        if (myContext.currentRow >= myContext.rows) {
          return false;
        }
      }
 else {
        addLf=true;
      }
      addText(s);
      if (myContext.currentRow >= myContext.rows) {
        return false;
      }
    }
    return myContext.currentRow < myContext.rows;
  }
  for (  String s : text.split(" ")) {
    s=s.trim();
    if (s.length() <= 0) {
      continue;
    }
    if (myScheduleNewLine && canBreakBeforeText(s)) {
      newLine();
      addSpace=false;
      if (myContext.currentRow >= myContext.rows) {
        return false;
      }
    }
    if (addSpace) {
      myContext.buffer.append(" ");
      myContext.currentColumn++;
    }
 else {
      addSpace=true;
    }
    myContext.currentColumn+=s.length();
    myContext.buffer.append(s);
    if (myContext.currentColumn < myContext.columnsPerRow) {
      continue;
    }
    myScheduleNewLine=true;
  }
  if (tailText != null) {
    myContext.buffer.append(tailText);
    myContext.currentColumn+=tailText.length();
  }
  return true;
}
