{
  if (fullText == null) {
    return header;
  }
  int bodyStart=fullText.indexOf("<body>");
  if (bodyStart < 0) {
    return header;
  }
  bodyStart+="<body>".length();
  int bodyEnd=fullText.indexOf("</body>");
  if (bodyEnd < 0) {
    return header;
  }
  int headerEnd=fullText.indexOf("</PRE>");
  if (headerEnd < 0) {
    return header;
  }
  String headerWithLinks=fullText.substring(bodyStart,headerEnd);
  String docText=fullText.substring(headerEnd + "</PRE>".length(),bodyEnd);
  final Context context=new Context(desiredRowsNumber);
  int columnsPerRow=parseHeader(header,headerWithLinks,context);
  process(docText,new BodyCallback(context,qName,columnsPerRow));
  while (!context.openTags.isEmpty()) {
    context.buffer.append("</").append(context.openTags.pop()).append('>');
  }
  return context.buffer.toString();
}
