{
  int len=text.length();
  int h=0;
  int nonSpace=0;
  boolean newline=false;
  int offset=startOffset;
  while (offset < len) {
    char c=text.charAt(offset);
    if (c == '\n') {
      offset++;
      newline=true;
      break;
    }
    if (!isWhiteSpace(c))     nonSpace++;
    h=31 * h + c;
    offset++;
  }
  return new Line(text,startOffset,offset,Mode.DEFAULT,h,nonSpace,newline);
}
