{
  int len=text.length();
  int nonSpace=0;
  boolean newline=false;
  int offset=startOffset;
  while (offset < len) {
    char c=text.charAt(offset);
    if (c == '\n') {
      offset++;
      newline=true;
      break;
    }
    if (!isWhiteSpace(c))     nonSpace++;
    offset++;
  }
  int h=calcTrimHash(text,startOffset,offset);
  return new Line(text,startOffset,offset,Mode.TRIM,h,nonSpace,newline);
}
