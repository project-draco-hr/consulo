{
  int threshold=Registry.intValue("diff.unimportant.line.char.count");
  if (threshold == 0)   return diff(lines1,lines2,indicator);
  Pair<List<Line>,TIntArrayList> bigLines1=getBigLines(lines1,threshold);
  Pair<List<Line>,TIntArrayList> bigLines2=getBigLines(lines2,threshold);
  FairDiffIterable changes=diff(bigLines1.first,bigLines2.first,indicator);
  return new ChangeCorrector.SmartLineChangeCorrector(bigLines1.second,bigLines2.second,lines1,lines2,changes,indicator).build();
}
