{
  final JavaCodeStyleManager codeStyleManager=JavaCodeStyleManager.getInstance(project);
  final String name=codeStyleManager.suggestUniqueVariableName("e",myTryStatement.getTryBlock(),false);
  final PsiElementFactory factory=JavaPsiFacade.getInstance(project).getElementFactory();
  final PsiCatchSection section=factory.createCatchSection((PsiClassType)myThrown,name,myTryStatement);
  final PsiCatchSection element=(PsiCatchSection)myTryStatement.addBefore(section,myBeforeCatchSection);
  codeStyleManager.shortenClassReferences(element);
  if (isOnTheFly()) {
    final TextRange range=getRangeToSelect(element.getCatchBlock());
    final PsiFile file=element.getContainingFile();
    final Editor editor=FileEditorManager.getInstance(project).getSelectedTextEditor();
    if (editor == null) {
      return;
    }
    final Document document=PsiDocumentManager.getInstance(project).getDocument(file);
    if (editor.getDocument() != document) {
      return;
    }
    editor.getCaretModel().moveToOffset(range.getStartOffset());
    editor.getScrollingModel().scrollToCaret(ScrollType.RELATIVE);
    editor.getSelectionModel().setSelection(range.getStartOffset(),range.getEndOffset());
  }
}
