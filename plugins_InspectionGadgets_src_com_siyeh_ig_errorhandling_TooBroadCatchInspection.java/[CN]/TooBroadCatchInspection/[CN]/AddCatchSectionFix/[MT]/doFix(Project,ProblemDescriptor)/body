{
  JavaCodeStyleManager codeStyleManager=JavaCodeStyleManager.getInstance(project);
  String name=codeStyleManager.suggestUniqueVariableName("e",myTryStatement.getTryBlock(),false);
  PsiCatchSection section=myTryStatement.getManager().getElementFactory().createCatchSection((PsiClassType)myThrown,name,myTryStatement);
  PsiCatchSection element=(PsiCatchSection)myTryStatement.addBefore(section,myBeforeCatchSection);
  codeStyleManager.shortenClassReferences(element);
  if (isOnTheFly()) {
    TextRange range=getRangeToSelect(element.getCatchBlock());
    PsiFile file=element.getContainingFile();
    Editor editor=FileEditorManager.getInstance(project).getSelectedTextEditor();
    if (editor == null)     return;
    Document document=PsiDocumentManager.getInstance(project).getDocument(file);
    if (editor.getDocument() != document)     return;
    editor.getCaretModel().moveToOffset(range.getStartOffset());
    editor.getScrollingModel().scrollToCaret(ScrollType.RELATIVE);
    editor.getSelectionModel().setSelection(range.getStartOffset(),range.getEndOffset());
  }
}
