{
  Element element;
  try {
    element=DefaultStateSerializer.serializeState(state,storageSpec);
  }
 catch (  WriteExternalException e) {
    LOG.debug(e);
    return;
  }
catch (  Throwable e) {
    LOG.error("Unable to serialize " + componentName + " state",e);
    return;
  }
  if (myCopiedStorageData == null) {
    myCopiedStorageData=StorageData.setStateAndCloneIfNeed(componentName,element,myOriginalStorageData,myNewLiveStates);
  }
 else {
    myCopiedStorageData.setState(componentName,element,myNewLiveStates);
  }
}
