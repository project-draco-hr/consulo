{
  Element element=data.save(newLiveStates);
  if (element == null || JDOMUtil.isEmpty(element)) {
    return null;
  }
  if (collapsePaths && myPathMacroSubstitutor != null) {
    try {
      myPathMacroSubstitutor.collapsePaths(element);
    }
  finally {
      myPathMacroSubstitutor.reset();
    }
  }
  return element;
}
