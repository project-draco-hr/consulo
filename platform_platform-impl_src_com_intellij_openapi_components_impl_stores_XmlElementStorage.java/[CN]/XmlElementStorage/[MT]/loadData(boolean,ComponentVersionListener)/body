{
  Document document=loadDocument();
  StorageData result=createStorageData();
  if (document != null) {
    loadState(result,document.getRootElement());
  }
 else {
    LOG.info("Document was not loaded for " + myFileSpec);
  }
  if (!myIsProjectSettings && useProvidersData) {
    for (    RoamingType roamingType : RoamingType.values()) {
      if (roamingType != RoamingType.DISABLED && roamingType != RoamingType.GLOBAL) {
        try {
          if (myStreamProvider.isEnabled()) {
            final Document sharedDocument=StorageUtil.loadDocument(myStreamProvider.loadContent(myFileSpec,roamingType));
            if (sharedDocument != null) {
              filterComponentsDisabledForRoaming(sharedDocument.getRootElement(),roamingType);
              filterOutOfDateComponents(sharedDocument.getRootElement());
              loadState(result,sharedDocument.getRootElement());
            }
          }
        }
 catch (        Exception e) {
          LOG.warn(e);
        }
      }
    }
  }
  return result;
}
