{
  final StorageData storageData=loadData(false);
  final StorageData oldLoadedData=myLoadedData;
  if (oldLoadedData != null) {
    Set<String> componentsToRetain=new THashSet<String>(oldLoadedData.myComponentStates.keySet());
    componentsToRetain.addAll(changedComponents);
    for (    String componentToRetain : componentsToRetain) {
      if (!storageData.myComponentStates.containsKey(componentToRetain) && myStorageComponentStates.containsKey(componentToRetain)) {
        Element emptyElement=new Element("component");
        LOG.info("Create empty component element for " + componentsToRetain);
        emptyElement.setAttribute(StorageData.NAME,componentToRetain);
        storageData.myComponentStates.put(componentToRetain,emptyElement);
      }
    }
    storageData.myComponentStates.keySet().retainAll(componentsToRetain);
  }
  myLoadedData=storageData;
}
