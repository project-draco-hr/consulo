{
  final Element element=data.save();
  if (myPathMacroSubstitutor != null) {
    try {
      myPathMacroSubstitutor.collapsePaths(element);
    }
  finally {
      myPathMacroSubstitutor.reset();
    }
  }
  return new Document(element);
}
