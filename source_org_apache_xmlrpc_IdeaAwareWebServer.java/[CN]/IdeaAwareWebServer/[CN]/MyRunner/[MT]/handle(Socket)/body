{
  con=new Connection(socket);
  count=0;
  try {
    final Class<?> aClass=Class.forName("com.intellij.openapi.application.ApplicationManager");
    final Method getApplicationMethod=aClass.getMethod("getApplication");
    final Object application=getApplicationMethod.invoke(null);
    final Method executeOnPooledThreadMethod=application.getClass().getMethod("executeOnPooledThread",Runnable.class);
    executeOnPooledThreadMethod.invoke(application,this);
  }
 catch (  Exception e) {
    e.printStackTrace();
  }
}
