{
  if (isInjectedFragment(file))   return null;
  final PsiDocumentManager documentManager=PsiDocumentManager.getInstance(file.getProject());
  documentManager.commitAllDocuments();
  PsiElement element=file.getViewProvider().findElementAt(offset,file.getLanguage());
  PsiElement inj=element == null ? null : findInside(element,file,offset,documentManager);
  if (inj != null)   return inj;
  if (offset != 0) {
    PsiElement element1=file.findElementAt(offset - 1);
    if (element1 != element && element1 != null)     return findInside(element1,file,offset,documentManager);
  }
  return null;
}
