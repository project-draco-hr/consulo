{
  if (!containingFile.isPhysical() && containingFile.getOriginalFile() == null) {
    final PsiElement context=containingFile.getContext();
    if (context == null)     return;
    final PsiFile file=context.getContainingFile();
    if (file == null || (!file.isPhysical() && file.getOriginalFile() == null))     return;
  }
  Places places=probeElementsUp(host,containingFile,probeUp);
  if (places == null)   return;
  for (  Place place : places) {
    PsiFile injectedPsi=place.myInjectedPsi;
    List<PsiLanguageInjectionHost.Shred> pairs=place.myShreds;
    visitor.visit(injectedPsi,pairs);
  }
}
