{
  if (!isInjectedFragment(file)) {
    PsiElement injected=findInjectedElementAt(file,offset);
    if (injected != null) {
      return injected;
    }
  }
  FileViewProvider viewProvider=file.getViewProvider();
  PsiElement result=viewProvider.findElementAt(offset,viewProvider.getBaseLanguage());
  return result;
}
