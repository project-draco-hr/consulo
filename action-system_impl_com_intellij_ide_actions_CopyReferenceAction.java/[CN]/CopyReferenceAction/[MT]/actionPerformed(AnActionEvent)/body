{
  DataContext dataContext=e.getDataContext();
  Editor editor=(Editor)dataContext.getData(DataConstants.EDITOR);
  Project project=(Project)dataContext.getData(DataConstants.PROJECT);
  PsiElement element;
  if (editor == null) {
    element=(PsiElement)dataContext.getData(DataConstants.PSI_ELEMENT);
  }
 else {
    PsiFile file=PsiDocumentManager.getInstance(project).getPsiFile(editor.getDocument());
    element=file.findElementAt(editor.getCaretModel().getOffset());
  }
  PsiElement member=findElementToCopy(element);
  if (member == null)   return;
  doCopy(member,project);
  HighlightManager highlightManager=HighlightManager.getInstance(project);
  EditorColorsManager manager=EditorColorsManager.getInstance();
  TextAttributes attributes=manager.getGlobalScheme().getAttributes(EditorColors.SEARCH_RESULT_ATTRIBUTES);
  if (editor != null) {
    highlightManager.addOccurrenceHighlights(editor,new PsiElement[]{element},attributes,true,null);
  }
}
