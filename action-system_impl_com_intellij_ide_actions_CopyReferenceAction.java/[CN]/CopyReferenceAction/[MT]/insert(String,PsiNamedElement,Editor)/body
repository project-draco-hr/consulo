{
  final PsiFile file=PsiDocumentManager.getInstance(editor.getProject()).getPsiFile(editor.getDocument());
  if (!CodeInsightUtil.prepareFileForWrite(file))   return;
  final Project project=editor.getProject();
  CommandProcessor.getInstance().executeCommand(project,new Runnable(){
    public void run(){
      ApplicationManager.getApplication().runWriteAction(new Runnable(){
        public void run(){
          try {
            doInsert(fqn,element,editor,project);
          }
 catch (          IncorrectOperationException e1) {
            LOG.error(e1);
          }
        }
      }
);
    }
  }
,IdeBundle.message("command.pasting.reference"),null);
  final StatusBarEx statusBar=(StatusBarEx)WindowManager.getInstance().getStatusBar(project);
  statusBar.setInfo(IdeBundle.message("message.reference.to.fqn.has.been.pasted",fqn));
}
