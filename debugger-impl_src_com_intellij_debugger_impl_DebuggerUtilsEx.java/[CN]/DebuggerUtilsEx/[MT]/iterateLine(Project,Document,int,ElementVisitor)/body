{
  PsiFile file=PsiDocumentManager.getInstance(project).getPsiFile(document);
  int lineStart;
  int lineEnd;
  try {
    lineStart=document.getLineStartOffset(line);
    lineEnd=document.getLineEndOffset(line);
  }
 catch (  IndexOutOfBoundsException e) {
    return;
  }
  PsiElement element;
  for (int off=lineStart; off < lineEnd; ) {
    element=file.findElementAt(off);
    if (element != null) {
      if (visitor.acceptElement(element)) {
        return;
      }
 else {
        off=element.getTextRange().getEndOffset() + 1;
      }
    }
 else {
      off++;
    }
  }
}
