{
synchronized (lock) {
    if (!blockedDocumentRoots.keySet().contains(w)) {
      throw new RuntimeException("Window should be in th list.");
    }
    int openedSheetsForWindow=blockedDocumentRoots.get(w);
    if (openedSheetsForWindow < 1) {
      throw new RuntimeException("We should have at least one window in the list");
    }
    if (openedSheetsForWindow == 1) {
      blockedDocumentRoots.remove(w);
    }
 else {
      blockedDocumentRoots.put(w,openedSheetsForWindow - 1);
    }
  }
}
