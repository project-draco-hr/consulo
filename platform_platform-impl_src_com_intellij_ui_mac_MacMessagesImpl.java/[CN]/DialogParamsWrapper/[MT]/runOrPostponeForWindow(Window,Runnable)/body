{
synchronized (lock) {
    MacMessagesQueue<Runnable> queue=queuesFromDocumentRoot.get(documentRoot);
    if (queue == null) {
      queue=new MacMessagesQueue<Runnable>();
      queuesFromDocumentRoot.put(documentRoot,queue);
    }
    queue.runOrEnqueue(task);
  }
}
