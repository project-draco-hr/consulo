{
  if (isFileReadOnly(project,file)) {
    return;
  }
  final PsiJavaToken token=(PsiJavaToken)findMatchingElement(file,editor);
  final PsiStatement containingStatement=(PsiStatement)PsiTreeUtil.getParentOfType(token,PsiStatement.class);
  if (ExpandBooleanPredicate.isBooleanAssignment(containingStatement)) {
    final PsiExpressionStatement assignmentStatement=(PsiExpressionStatement)containingStatement;
    final PsiAssignmentExpression assignmentExpression=(PsiAssignmentExpression)assignmentStatement.getExpression();
    final PsiExpression rhs=assignmentExpression.getRExpression();
    final String rhsText=rhs.getText();
    final PsiExpression lhs=assignmentExpression.getLExpression();
    final String lhsText=lhs.getText();
    final String statement="if(" + rhsText + "){"+ lhsText+ " = true;}else{"+ lhsText+ " = false;}";
    replaceStatement(project,statement,containingStatement);
  }
 else   if (ExpandBooleanPredicate.isBooleanReturn(containingStatement)) {
    final PsiReturnStatement returnStatement=(PsiReturnStatement)containingStatement;
    final PsiExpression returnValue=returnStatement.getReturnValue();
    final String valueText=returnValue.getText();
    final String statement="if(" + valueText + "){return true;}else{return false;}";
    replaceStatement(project,statement,containingStatement);
  }
}
