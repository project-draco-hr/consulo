{
  if (LOG.isDebugEnabled()) {
    LOG.debug("enter: propertyChange(" + e + ")");
  }
  if (!"focusedWindow".equals(e.getPropertyName())) {
    throw new IllegalArgumentException("unknown property name: " + e.getPropertyName());
  }
synchronized (myLock) {
    final Window window=(Window)e.getNewValue();
    if (window == null) {
      return;
    }
    if (!myWindow2Info.containsKey(window)) {
      myWindow2Info.put(window,new WindowInfo(window,true));
    }
    myFocusedWindow=window;
    final Project project=(Project)DataManager.getInstance().getDataContext(myFocusedWindow).getData(DataConstants.PROJECT);
    for (Iterator i=myFocusedWindows.iterator(); i.hasNext(); ) {
      final Window w=(Window)i.next();
      if (project == DataManager.getInstance().getDataContext(w).getData(DataConstants.PROJECT)) {
        i.remove();
      }
    }
    myFocusedWindows.add(myFocusedWindow);
    final IdeFrame frame;
    if (window instanceof IdeFrame) {
      frame=(IdeFrame)window;
    }
 else {
      frame=(IdeFrame)SwingUtilities.getAncestorOfClass(IdeFrame.class,window);
    }
    if (frame != null) {
      JOptionPane.setRootFrame(frame);
    }
  }
  if (LOG.isDebugEnabled()) {
    LOG.debug("exit: propertyChange()");
  }
}
