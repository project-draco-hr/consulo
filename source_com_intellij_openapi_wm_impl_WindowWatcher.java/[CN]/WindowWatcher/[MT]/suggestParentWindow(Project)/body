{
synchronized (myLock) {
    Window window=getFocusedWindowForProject(project);
    if (window == null) {
      if (project != null) {
        return WindowManagerEx.getInstanceEx().getFrame(project);
      }
 else {
        return null;
      }
    }
    LOG.assertTrue(window.isDisplayable());
    LOG.assertTrue(window.isShowing());
    while (window != null) {
      if (!(window instanceof Dialog) && !(window instanceof Frame)) {
        window=window.getOwner();
        continue;
      }
      if (!window.isDisplayable() || !window.isShowing()) {
        window=window.getOwner();
        continue;
      }
      final WindowInfo info=myWindow2Info.get(window);
      if (info == null) {
        window=window.getOwner();
        continue;
      }
      if (info.mySuggestAsParent) {
        return window;
      }
 else {
        window=window.getOwner();
      }
    }
    return null;
  }
}
