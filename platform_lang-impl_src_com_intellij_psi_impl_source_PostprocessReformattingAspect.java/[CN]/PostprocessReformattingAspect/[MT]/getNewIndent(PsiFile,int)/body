{
  final IndentHelper formatIndentHelper=HelperFactory.createHelper(psiFile.getFileType(),psiFile.getProject());
  final Document document=psiFile.getViewProvider().getDocument();
  final int startOffset=document.getLineStartOffset(document.getLineNumber(firstWhitespace));
  int endOffset=startOffset;
  final CharSequence charsSequence=document.getCharsSequence();
  while (Character.isWhitespace(charsSequence.charAt(endOffset++)))   ;
  final String newIndentStr=charsSequence.subSequence(startOffset,endOffset - 1).toString();
  return formatIndentHelper.getIndent(newIndentStr,true);
}
