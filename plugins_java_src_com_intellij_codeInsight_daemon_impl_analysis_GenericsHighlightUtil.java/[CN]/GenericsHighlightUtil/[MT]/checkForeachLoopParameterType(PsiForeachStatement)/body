{
  final PsiParameter parameter=statement.getIterationParameter();
  final PsiExpression expression=statement.getIteratedValue();
  if (expression == null || expression.getType() == null)   return null;
  final PsiType itemType=JavaGenericsUtil.getCollectionItemType(expression);
  if (itemType == null) {
    String description=JavaErrorMessages.message("foreach.not.applicable",JavaHighlightUtil.formatType(expression.getType()));
    return HighlightInfo.newHighlightInfo(HighlightInfoType.ERROR).range(expression).descriptionAndTooltip(description).create();
  }
  final int start=parameter.getTextRange().getStartOffset();
  final int end=expression.getTextRange().getEndOffset();
  final PsiType parameterType=parameter.getType();
  HighlightInfo highlightInfo=HighlightUtil.checkAssignability(parameterType,itemType,null,new TextRange(start,end),0);
  if (highlightInfo != null) {
    HighlightUtil.registerChangeVariableTypeFixes(parameter,itemType,highlightInfo);
  }
  return highlightInfo;
}
