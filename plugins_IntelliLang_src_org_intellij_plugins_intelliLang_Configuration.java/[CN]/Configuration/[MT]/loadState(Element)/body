{
  final THashMap<String,LanguageInjectorSupport> supports=new THashMap<String,LanguageInjectorSupport>();
  for (  LanguageInjectorSupport support : Extensions.getExtensions(LanguageInjectorSupport.EP_NAME)) {
    supports.put(support.getId(),support);
  }
  myInjections.get(LanguageInjectorSupport.XML_SUPPORT_ID).addAll(readExternal(element.getChild(TAG_INJECTION_NAME),new Factory<XmlTagInjection>(){
    public XmlTagInjection create(){
      return new XmlTagInjection();
    }
  }
));
  myInjections.get(LanguageInjectorSupport.XML_SUPPORT_ID).addAll(readExternal(element.getChild(ATTRIBUTE_INJECTION_NAME),new Factory<XmlAttributeInjection>(){
    public XmlAttributeInjection create(){
      return new XmlAttributeInjection();
    }
  }
));
  myInjections.get(LanguageInjectorSupport.JAVA_SUPPORT_ID).addAll(readExternal(element.getChild(PARAMETER_INJECTION_NAME),new Factory<MethodParameterInjection>(){
    public MethodParameterInjection create(){
      return new MethodParameterInjection();
    }
  }
));
  for (  Element child : (List<Element>)element.getChildren("injection")) {
    final String key=child.getAttributeValue("injector-id");
    final LanguageInjectorSupport support=supports.get(key);
    final BaseInjection injection=support == null ? new BaseInjection(key) : support.createInjection(child);
    injection.loadState(child);
    myInjections.get(key).add(injection);
  }
  setInstrumentationType(JDOMExternalizerUtil.readField(element,INSTRUMENTATION_TYPE_NAME));
  setLanguageAnnotation(JDOMExternalizerUtil.readField(element,LANGUAGE_ANNOTATION_NAME));
  setPatternAnnotation(JDOMExternalizerUtil.readField(element,PATTERN_ANNOTATION_NAME));
  setSubstAnnotation(JDOMExternalizerUtil.readField(element,SUBST_ANNOTATION_NAME));
  final String resolveReferences=JDOMExternalizerUtil.readField(element,RESOLVE_REFERENCES);
  setResolveReferences(resolveReferences == null || Boolean.parseBoolean(resolveReferences));
  if (myMergeWithDefault) {
    mergeWithDefaultConfiguration();
  }
}
