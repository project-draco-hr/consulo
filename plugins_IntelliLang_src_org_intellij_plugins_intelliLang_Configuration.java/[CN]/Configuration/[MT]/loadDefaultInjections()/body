{
  final ArrayList<Configuration> cfgList=new ArrayList<Configuration>();
  for (  LanguageInjectionSupport support : InjectorUtils.getActiveInjectionSupports()) {
    final String config=support.getDefaultConfigUrl();
    final URL url=config == null ? null : support.getClass().getResource(config);
    if (url != null) {
      try {
        cfgList.add(load(url.openStream()));
      }
 catch (      Exception e) {
        LOG.warn(e);
      }
    }
  }
  final THashSet<Object> visited=new THashSet<Object>();
  for (  IdeaPluginDescriptor pluginDescriptor : PluginManager.getPlugins()) {
    if (pluginDescriptor instanceof IdeaPluginDescriptorImpl && !((IdeaPluginDescriptorImpl)pluginDescriptor).isEnabled())     continue;
    final ClassLoader loader=pluginDescriptor.getPluginClassLoader();
    if (!visited.add(loader))     continue;
    if (loader instanceof PluginClassLoader && ((PluginClassLoader)loader).getUrls().isEmpty())     continue;
    try {
      final Enumeration<URL> enumeration=loader.getResources("META-INF/languageInjections.xml");
      if (enumeration == null)       continue;
      while (enumeration.hasMoreElements()) {
        URL url=enumeration.nextElement();
        if (!visited.add(url.getFile()))         continue;
        try {
          cfgList.add(load(url.openStream()));
        }
 catch (        Exception e) {
          LOG.warn(e);
        }
      }
    }
 catch (    Exception e) {
      LOG.warn(e);
    }
  }
  final ArrayList<BaseInjection> defaultInjections=new ArrayList<BaseInjection>();
  for (  String supportId : InjectorUtils.getActiveInjectionSupportIds()) {
    for (    Configuration cfg : cfgList) {
      final List<BaseInjection> imported=cfg.getInjections(supportId);
      defaultInjections.addAll(imported);
    }
  }
  return defaultInjections;
}
