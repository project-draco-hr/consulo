{
  final HashMap<RefEntity,List<CommonProblemDescriptor>> holder=new HashMap<RefEntity,List<CommonProblemDescriptor>>();
  globalContext.getRefManager().iterate(new RefVisitor(){
    public void visitElement(    RefEntity refEntity){
      if (globalContext.isSuppressed(refEntity,getShortName()))       return;
      CommonProblemDescriptor[] descriptors=checkElement(refEntity,scope,manager,globalContext);
      if (descriptors != null) {
        List<CommonProblemDescriptor> problemDescriptors=holder.get(refEntity);
        if (problemDescriptors == null) {
          problemDescriptors=new ArrayList<CommonProblemDescriptor>();
          holder.put(refEntity,problemDescriptors);
        }
        problemDescriptors.addAll(Arrays.asList(descriptors));
      }
    }
  }
);
  for (  RefEntity refElement : holder.keySet()) {
    final List<CommonProblemDescriptor> descriptors=holder.get(refElement);
    problemDescriptionsProcessor.addProblemElement(refElement,descriptors.toArray(new CommonProblemDescriptor[descriptors.size()]));
  }
}
