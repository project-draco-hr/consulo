{
  try {
    URL url=new URL(dtdUrl);
    HttpURLConnection urlConnection=(HttpURLConnection)url.openConnection();
    urlConnection.addRequestProperty("accept","text/xml,application/xml,text/html,*/*");
    int contentLength=urlConnection.getContentLength();
    ByteArrayOutputStream out=new ByteArrayOutputStream();
    InputStream in=urlConnection.getInputStream();
    String contentType;
    try {
      contentType=urlConnection.getContentType();
      NetUtils.copyStreamContent(indicator,in,out,contentLength);
    }
  finally {
      in.close();
    }
    FetchResult result=new FetchResult();
    result.bytes=out.toByteArray();
    result.contentType=contentType;
    return result;
  }
 catch (  MalformedURLException e) {
    if (!ApplicationManager.getApplication().isUnitTestMode()) {
      ApplicationManager.getApplication().invokeLater(new Runnable(){
        public void run(){
          Messages.showMessageDialog(project,XmlBundle.message("invalid.url.message",dtdUrl),XmlBundle.message("invalid.url.title"),Messages.getErrorIcon());
        }
      }
,indicator.getModalityState());
    }
  }
  return null;
}
