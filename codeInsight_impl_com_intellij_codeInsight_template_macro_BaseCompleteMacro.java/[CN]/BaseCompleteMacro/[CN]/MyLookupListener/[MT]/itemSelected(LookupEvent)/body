{
  LookupItem item=event.getItem();
  if (item == null)   return;
  final Project project=myContext.getProject();
  final LookupManager lookupManager=LookupManager.getInstance(project);
  if (item.getAttribute(Expression.AUTO_POPUP_NEXT_LOOKUP) != null) {
    ApplicationManager.getApplication().invokeLater(new Runnable(){
      public void run(){
        invokeCompletion(myContext);
      }
    }
);
    return;
  }
  final PsiElement[] elements=lookupManager.getAllElementsForItem(item);
  boolean goNextTab;
  if (elements == null) {
    goNextTab=true;
  }
 else {
    if (elements.length != 1) {
      goNextTab=false;
    }
 else {
      if (elements[0] instanceof PsiMethod) {
        PsiMethod method=(PsiMethod)elements[0];
        goNextTab=method.getParameterList().getParameters().length == 0;
      }
 else       if (elements[0] instanceof WebDirectoryElement) {
        VirtualFile originalVirtualFile=((WebDirectoryElement)elements[0]).getOriginalVirtualFile();
        goNextTab=originalVirtualFile == null || !originalVirtualFile.isDirectory();
      }
 else       if (elements[0] instanceof PsiDirectory) {
        goNextTab=false;
      }
 else {
        goNextTab=true;
      }
    }
  }
  if (goNextTab) {
    final Editor editor=myContext.getEditor();
    if (editor != null) {
      TemplateState templateState=TemplateManagerImpl.getTemplateState(editor);
      if (templateState != null) {
        templateState.nextTab();
      }
    }
  }
}
