{
  final Artifact[] artifacts=ArtifactManager.getInstance(myProject).getArtifacts();
  Set<ArtifactPointer> pointers=new THashSet<ArtifactPointer>();
  for (  Artifact artifact : artifacts) {
    pointers.add(ArtifactPointerUtil.getPointerManager(myProject).createPointer(artifact));
  }
  pointers.addAll(task.getArtifactPointers());
  ArtifactChooser chooser=new ArtifactChooser(new ArrayList<ArtifactPointer>(pointers));
  chooser.markElements(task.getArtifactPointers());
  chooser.setPreferredSize(new Dimension(400,300));
  DialogBuilder builder=new DialogBuilder(myProject);
  builder.setTitle(CompilerBundle.message("build.artifacts.before.run.selector.title"));
  builder.setDimensionServiceKey("#BuildArtifactsBeforeRunChooser");
  builder.addOkAction();
  builder.addCancelAction();
  builder.setCenterPanel(chooser);
  builder.setPreferredFocusComponent(chooser);
  if (builder.show() == DialogWrapper.OK_EXIT_CODE) {
    task.setArtifactPointers(chooser.getMarkedElements());
    return true;
  }
  return false;
}
