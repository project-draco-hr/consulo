{
  boolean foundInsideSegment=false;
  GwtTextRange highlightTextRange=highlightInfo.getTextRange();
  for (int i=0; i < mySegments.size(); i++) {
    Segment segment=mySegments.get(i);
    if (segment.getTextRange().containsRange(highlightTextRange)) {
      insertHighlightInsideSegment(highlightInfo,i,segment,highlightTextRange,flag);
      foundInsideSegment=true;
      break;
    }
  }
  if (!foundInsideSegment) {
    for (int i=0; i < mySegments.size(); i++) {
      Segment segment=mySegments.get(i);
      GwtTextRange textRange=highlightInfo.getTextRange();
      if (textRange.containsRange(segment.getTextRange())) {
        WrappedStyledSegment wrappedStyledSegment=new WrappedStyledSegment(segment);
        add(wrappedStyledSegment,highlightInfo,flag);
        copy(segment,wrappedStyledSegment);
        mySegments.set(i,wrappedStyledSegment);
      }
    }
  }
}
