{
  final ProjectLevelVcsManager vcsManager=ProjectLevelVcsManager.getInstance(vcs.getProject());
  final VcsOutgoingChangesProvider provider=vcs.getOutgoingChangesProvider();
  if (provider == null)   return Collections.emptyList();
  final VirtualFile[] files=ChangesUtil.getFilesFromChanges(changes);
  final Set<VirtualFile> roots=new HashSet<VirtualFile>();
  for (  VirtualFile file : files) {
    final VirtualFile root=vcsManager.getVcsRootFor(file);
    if (root != null) {
      roots.add(root);
    }
  }
  final Collection<Pair<VcsRevisionNumber,List<T>>> result=new ArrayList<Pair<VcsRevisionNumber,List<T>>>(roots.size());
  for (  VirtualFile root : roots) {
    final Pair<VcsRevisionNumber,List<T>> pair=provider.getOutgoingChanges(root,true);
    result.add(pair);
  }
  return result;
}
