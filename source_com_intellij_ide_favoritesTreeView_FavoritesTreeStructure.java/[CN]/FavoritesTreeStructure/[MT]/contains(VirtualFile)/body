{
  LOG.assertTrue(vFile != null);
  final ProjectFileIndex projectFileIndex=ProjectRootManager.getInstance(myProject).getFileIndex();
  final Set<Boolean> find=new HashSet<Boolean>();
  final ContentIterator contentIterator=new ContentIterator(){
    public boolean processFile(    VirtualFile fileOrDir){
      if (fileOrDir == null ? vFile == null : fileOrDir.getPath().equals(vFile.getPath())) {
        find.add(Boolean.TRUE);
      }
      return true;
    }
  }
;
  for (Iterator<AbstractTreeNode> iterator=myRoot.getChildren().iterator(); iterator.hasNext(); ) {
    AbstractTreeNode node=iterator.next();
    if (node.getValue() instanceof PsiElement) {
      final VirtualFile virtualFile=BasePsiNode.getVirtualFile(((PsiElement)node.getValue()));
      if (virtualFile == null)       continue;
      if (vFile.getPath().equals(virtualFile.getPath())) {
        return true;
      }
      if (!virtualFile.isDirectory()) {
        continue;
      }
      projectFileIndex.iterateContentUnderDirectory(virtualFile,contentIterator);
    }
    if (node.getValue() instanceof Module) {
      ModuleRootManager.getInstance(((Module)node.getValue())).getFileIndex().iterateContent(contentIterator);
    }
    if (node.getValue() instanceof LibraryGroupElement) {
      final boolean inLibrary=ModuleRootManager.getInstance(((LibraryGroupElement)node.getValue()).getModule()).getFileIndex().isInContent(vFile) && projectFileIndex.isInLibraryClasses(vFile);
      if (inLibrary) {
        return true;
      }
    }
    if (node.getValue() instanceof NamedLibraryElement) {
      NamedLibraryElement namedLibraryElement=(NamedLibraryElement)node.getValue();
      final VirtualFile[] files=namedLibraryElement.getOrderEntry().getFiles(OrderRootType.CLASSES);
      if (files != null && ArrayUtil.find(files,vFile) > -1) {
        return true;
      }
    }
    if (node.getValue() instanceof Form) {
      Form form=(Form)node.getValue();
      PsiFile[] forms=form.getClassToBind().getManager().getSearchHelper().findFormsBoundToClass(form.getClassToBind().getQualifiedName());
      for (int i=0; i < forms.length; i++) {
        PsiFile psiFile=forms[i];
        final VirtualFile virtualFile=psiFile.getVirtualFile();
        if (virtualFile == null ? vFile == null : virtualFile.equals(vFile)) {
          return true;
        }
      }
    }
    if (node.getValue() instanceof ModuleGroup) {
      ModuleGroup group=(ModuleGroup)node.getValue();
      final Module[] modules=group.modulesInGroup(myProject,true);
      for (int i=0; i < modules.length; i++) {
        Module module=modules[i];
        ModuleRootManager.getInstance(module).getFileIndex().iterateContent(contentIterator);
      }
    }
    if (!find.isEmpty()) {
      return true;
    }
  }
  return false;
}
