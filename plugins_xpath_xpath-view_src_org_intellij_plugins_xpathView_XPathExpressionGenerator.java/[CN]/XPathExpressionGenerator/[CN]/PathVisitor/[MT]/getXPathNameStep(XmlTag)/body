{
  String uri=tag.getNamespace();
  if ((uri.length() == 0)) {
    return tag.getName();
  }
  if (MyPsiUtil.isInDeclaredNamespace(tag,uri,tag.getNamespacePrefix())) {
    String prefix=tag.getNamespacePrefix();
    if (prefix.length() == 0) {
      final String guessedPrefix=guessPrefix(tag);
      return guessedPrefix != null ? guessedPrefix + ":" + tag.getLocalName() : "*[name()='" + tag.getName() + "']";
    }
  }
  return tag.getName();
}
