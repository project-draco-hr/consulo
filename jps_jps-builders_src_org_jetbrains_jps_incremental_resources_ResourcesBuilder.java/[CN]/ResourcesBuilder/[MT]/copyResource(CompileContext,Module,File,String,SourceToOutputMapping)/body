{
  final String outputRoot=context.isCompilingTests() ? module.getTestOutputPath() : module.getOutputPath();
  final String relativePath=FileUtil.getRelativePath(sourceRoot,FileUtil.toSystemIndependentName(file.getPath()),'/');
  final String prefix=module.getSourceRootPrefixes().get(sourceRoot);
  final StringBuilder targetPath=new StringBuilder();
  targetPath.append(outputRoot);
  if (prefix != null && prefix.length() > 0) {
    targetPath.append('/').append(prefix.replace('.','/'));
  }
  targetPath.append('/').append(relativePath);
  final String outputPath=targetPath.toString();
  FileUtil.copyContent(file,new File(outputPath));
  try {
    outputToSourceMapping.update(file.getPath(),outputPath);
  }
 catch (  Exception e) {
    context.processMessage(new CompilerMessage(BUILDER_NAME,e));
  }
}
