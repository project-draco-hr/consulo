{
  final boolean result=((ApplicationEx)ApplicationManager.getApplication()).runProcessWithProgressSynchronously(new Runnable(){
    public void run(){
      task.run(ProgressManager.getInstance().getProgressIndicator());
    }
  }
,task.getTitle(),task.isCancellable(),task.getProject());
  if (result) {
    final Task.NotificationInfo notificationInfo=task.getNotificationInfo();
    if (notificationInfo != null) {
      final JFrame frame=WindowManager.getInstance().getFrame(task.getProject());
      if (!frame.hasFocus()) {
        Notifications.notify(notificationInfo.getNotificationName(),notificationInfo.getNotificationTitle(),notificationInfo.getNotificationText());
      }
    }
    task.onSuccess();
  }
 else {
    task.onCancel();
  }
  return result;
}
