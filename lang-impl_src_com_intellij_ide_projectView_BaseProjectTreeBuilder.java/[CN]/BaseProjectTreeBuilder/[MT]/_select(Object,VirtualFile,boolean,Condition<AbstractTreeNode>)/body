{
  final ActionCallback result=new ActionCallback();
  DefaultMutableTreeNode selected=alreadySelectedNode(element);
  final Runnable onDone=new Runnable(){
    public void run(){
      if (requestFocus) {
        IdeFocusManager.getInstance(myProject).requestFocus(getTree(),true);
      }
      result.setDone();
    }
  }
;
  if (selected == null) {
    expandPathTo(file,(AbstractTreeNode)getTreeStructure().getRootElement(),element,nonStopCondition).doWhenDone(new AsyncResult.Handler<AbstractTreeNode>(){
      public void run(      AbstractTreeNode node){
        select(node,onDone);
      }
    }
).notifyWhenRejected(result);
  }
 else {
    onDone.run();
  }
  return result;
}
