{
  List<VirtualFile> result=new ArrayList<VirtualFile>();
  final Module[] modules=ModuleManager.getInstance(psiPackage.getProject()).getModules();
  for (  final Module module : modules) {
    final ContentEntry[] contentEntries=ModuleRootManager.getInstance(module).getContentEntries();
    for (    final ContentEntry contentEntry : contentEntries) {
      final SourceFolder[] sourceFolders=contentEntry.getSourceFolders();
      for (      final SourceFolder sourceFolder : sourceFolders) {
        final String packagePrefix=sourceFolder.getPackagePrefix();
        if (packagePrefix.startsWith(psiPackage.getQualifiedName())) {
          final VirtualFile file=sourceFolder.getFile();
          if (file != null) {
            result.add(file);
          }
        }
      }
    }
  }
  return VfsUtil.toVirtualFileArray(result);
}
