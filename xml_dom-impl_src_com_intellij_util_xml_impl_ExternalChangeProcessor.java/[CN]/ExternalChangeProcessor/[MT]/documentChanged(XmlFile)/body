{
  myDocumentChanged=true;
  final DomFileElementImpl oldElement=DomManagerImpl.getCachedFileElement(xmlFile);
  if (oldElement != null) {
    final DomEvent[] events=myDomManager.recomputeFileElement(xmlFile);
    if (myDomManager.getFileElement(xmlFile) != oldElement) {
      for (      final DomEvent event : events) {
        myDomManager.fireEvent(event);
      }
      return;
    }
    final DomInvocationHandler rootHandler=oldElement.getRootHandler();
    rootHandler.detach();
    final XmlTag rootTag=oldElement.getRootTag();
    if (rootTag != null) {
      LOG.assertTrue(rootTag.isValid());
      rootHandler.setXmlElement(rootTag);
    }
    myDomManager.fireEvent(new ElementChangedEvent(oldElement.getRootElement()));
  }
}
