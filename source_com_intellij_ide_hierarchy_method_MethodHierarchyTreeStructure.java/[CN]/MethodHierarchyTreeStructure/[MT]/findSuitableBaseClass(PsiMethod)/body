{
  final PsiClass containingClass=method.getContainingClass();
  if (containingClass instanceof PsiAnonymousClass) {
    return containingClass;
  }
  final PsiClass superClass=containingClass.getSuperClass();
  if (superClass == null) {
    return containingClass;
  }
  final boolean isContainingClassesMethod=MethodHierarchyUtil.findBaseMethodInClass(method,superClass,true) != null;
  if (!isContainingClassesMethod) {
    final PsiClass[] interfaces=containingClass.getInterfaces();
    for (int i=0; i < interfaces.length; i++) {
      final PsiClass anInterface=interfaces[i];
      if (MethodHierarchyUtil.findBaseMethodInClass(method,anInterface,true) != null) {
        return anInterface;
      }
    }
  }
  return containingClass;
}
