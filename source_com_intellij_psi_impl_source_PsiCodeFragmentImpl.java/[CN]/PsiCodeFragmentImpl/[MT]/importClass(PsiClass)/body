{
  final String className=aClass.getName();
  final String qName=aClass.getQualifiedName();
  if (qName == null)   return false;
  myPseudoImports.put(className,qName);
  myManager.nonPhysicalChange();
  if (isPhysical()) {
    final Project project=myManager.getProject();
    UndoManager.getInstance(project).undoableActionPerformed(new UndoableAction(){
      public boolean isComplex(){
        return false;
      }
      public void undo(){
        myPseudoImports.remove(className);
      }
      public void redo(){
        myPseudoImports.put(className,qName);
      }
      public DocumentReference[] getAffectedDocuments(){
        PsiDocumentManager psiDocumentManager=PsiDocumentManager.getInstance(project);
        Document document=psiDocumentManager.getDocument(PsiCodeFragmentImpl.this);
        return new DocumentReference[]{DocumentReferenceByDocument.createDocumentReference(document)};
      }
    }
);
  }
  return true;
}
