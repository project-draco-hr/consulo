{
  final PsiCodeFragmentImpl clone=(PsiCodeFragmentImpl)cloneImpl((RepositoryTreeElement)calcTreeElement().clone());
  clone.myPhysical=false;
  clone.myOriginalFile=this;
  clone.myPseudoImports=new LinkedHashMap<String,String>(myPseudoImports);
  final SingleRootFileViewProvider dummyHolderViewProvider=new SingleRootFileViewProvider(getManager(),new MockVirtualFile(getName(),getLanguage(),getText()),false);
  dummyHolderViewProvider.forceCachedPsi(clone);
  clone.myViewProvider=dummyHolderViewProvider;
  return clone;
}
