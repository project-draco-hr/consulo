{
  final PsiCodeFragmentImpl clone=(PsiCodeFragmentImpl)cloneImpl(getTreeElement());
  clone.myPhysical=false;
  clone.myOriginalFile=this;
  clone.myPseudoImports=new LinkedHashMap<String,String>(myPseudoImports);
  final SingleRootFileViewProvider dummyHolderViewProvider=new SingleRootFileViewProvider(getManager(),new MockVirtualFile(getName(),FileTypeManager.getInstance().getFileTypeByFileName(getName()),getText()),false);
  dummyHolderViewProvider.forceCachedPsi(clone);
  clone.myViewProvider=dummyHolderViewProvider;
  return clone;
}
