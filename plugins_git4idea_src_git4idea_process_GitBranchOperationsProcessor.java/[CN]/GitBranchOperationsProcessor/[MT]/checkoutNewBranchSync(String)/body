{
  GitUnmergedFilesDetector unmergedDetector=new GitUnmergedFilesDetector();
  GitCommandResult result=Git.checkoutNewBranch(myRepository,name,null,unmergedDetector);
  if (result.success()) {
    updateRepository();
    notifySuccess(String.format("Branch <b><code>%s</code></b> was created",name));
  }
 else   if (unmergedDetector.isUnmergedFilesDetected()) {
    boolean allMerged=new GitConflictResolver(myProject,Collections.singleton(myRoot),new GitConflictResolver.Params()).merge();
    if (!allMerged) {
      showErrorMessage("Can't create new branch until all conflicts are resolved",Collections.<String>emptyList());
    }
 else {
      checkoutNewBranchSync(name);
    }
  }
 else {
    showErrorMessage("Couldn't create new branch " + name,result.getErrorOutput());
  }
}
