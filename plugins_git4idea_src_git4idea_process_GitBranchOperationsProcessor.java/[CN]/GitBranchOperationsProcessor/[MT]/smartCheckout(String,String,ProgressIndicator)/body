{
  final GitChangesSaver saver=configureSaver(reference,indicator);
  GitComplexProcess.Operation checkoutOperation=new GitComplexProcess.Operation(){
    @Override public void run(    ContinuationContext context){
      if (saveOrNotify(saver)) {
        try {
          checkoutOrNotify(reference,newBranch);
        }
  finally {
          saver.restoreLocalChanges(context);
        }
      }
    }
  }
;
  GitComplexProcess.execute(myProject,"checkout",checkoutOperation);
}
