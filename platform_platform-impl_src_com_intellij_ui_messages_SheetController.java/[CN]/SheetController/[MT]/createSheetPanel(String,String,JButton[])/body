{
  JPanel sheetPanel=new JPanel(){
    @Override protected void paintComponent(    @NotNull Graphics g2d){
      final Graphics2D g=(Graphics2D)g2d.create();
      super.paintComponent(g);
      g.setComposite(AlphaComposite.getInstance(AlphaComposite.SRC_OVER,getSheetAlpha()));
      g.setColor(new JBColor(Gray._230,UIUtil.getPanelBackground()));
      Rectangle2D dialog=new Rectangle2D.Double(SHADOW_BORDER,0,SHEET_WIDTH,SHEET_HEIGHT);
      paintShadow(g);
      if (UIUtil.isUnderDarcula()) {
        g.fillRoundRect((int)dialog.getX(),(int)dialog.getY() - 5,(int)dialog.getWidth(),(int)(5 + dialog.getHeight()),5,5);
      }
 else {
        g.fill(dialog);
      }
      paintShadowFromParent(g);
    }
  }
;
  sheetPanel.setOpaque(false);
  sheetPanel.setLayout(null);
  JPanel ico=new JPanel(){
    @Override protected void paintComponent(    @NotNull Graphics g){
      super.paintComponent(g);
      myIcon.paintIcon(this,g,0,0);
    }
  }
;
  JEditorPane headerLabel=new JEditorPane();
  headerLabel.putClientProperty(JEditorPane.HONOR_DISPLAY_PROPERTIES,Boolean.TRUE);
  headerLabel.setFont(boldFont);
  headerLabel.setEditable(false);
  headerLabel.setContentType("text/html");
  headerLabel.setSize(250,Short.MAX_VALUE);
  headerLabel.setText(title);
  headerLabel.setSize(250,headerLabel.getPreferredSize().height);
  headerLabel.setOpaque(false);
  headerLabel.setFocusable(false);
  sheetPanel.add(headerLabel);
  headerLabel.repaint();
  messageTextPane.putClientProperty(JEditorPane.HONOR_DISPLAY_PROPERTIES,Boolean.TRUE);
  messageTextPane.setFont(regularFont);
  messageTextPane.setEditable(false);
  messageTextPane.setContentType("text/html");
  messageTextPane.addHyperlinkListener(new HyperlinkListener(){
    @Override public void hyperlinkUpdate(    HyperlinkEvent he){
      if (he.getEventType() == HyperlinkEvent.EventType.ACTIVATED) {
        if (Desktop.isDesktopSupported()) {
          try {
            URL url=he.getURL();
            if (url != null) {
              Desktop.getDesktop().browse(url.toURI());
            }
 else {
              LOG.warn("URL is null; HyperlinkEvent: " + he.toString());
            }
          }
 catch (          IOException e) {
            LOG.error(e);
          }
catch (          URISyntaxException e) {
            LOG.error(e);
          }
        }
      }
    }
  }
);
  FontMetrics fontMetrics=sheetPanel.getFontMetrics(regularFont);
  int widestWordWidth=250;
  String[] words=(message == null) ? ArrayUtil.EMPTY_STRING_ARRAY : message.split(SPACE_OR_LINE_SEPARATOR_PATTERN);
  for (  String word : words) {
    widestWordWidth=Math.max(fontMetrics.stringWidth(word),widestWordWidth);
  }
  messageTextPane.setSize(widestWordWidth,Short.MAX_VALUE);
  messageTextPane.setText(handleBreaks(message));
  messageArea.setSize(widestWordWidth,messageTextPane.getPreferredSize().height);
  SHEET_WIDTH=Math.max(LEFT_SHEET_OFFSET + widestWordWidth + RIGHT_OFFSET,SHEET_WIDTH);
  messageTextPane.setSize(messageArea);
  messageTextPane.setOpaque(false);
  messageTextPane.setFocusable(false);
  sheetPanel.add(messageTextPane);
  messageTextPane.repaint();
  ico.setOpaque(false);
  ico.setSize(new Dimension(AllIcons.Logo_welcomeScreen.getIconWidth(),AllIcons.Logo_welcomeScreen.getIconHeight()));
  ico.setLocation(LEFT_SHEET_PADDING,TOP_SHEET_PADDING);
  sheetPanel.add(ico);
  headerLabel.setLocation(LEFT_SHEET_OFFSET,TOP_SHEET_PADDING);
  messageTextPane.setLocation(LEFT_SHEET_OFFSET,TOP_SHEET_PADDING + headerLabel.getPreferredSize().height + GAP_BETWEEN_LINES);
  SHEET_HEIGHT=TOP_SHEET_PADDING + headerLabel.getPreferredSize().height + GAP_BETWEEN_LINES+ messageArea.height+ GAP_BETWEEN_LINES;
  if (myDoNotAskOption != null) {
    layoutDoNotAskCheckbox(sheetPanel);
  }
  layoutWithAbsoluteLayout(buttons,sheetPanel);
  int BOTTOM_SHEET_PADDING=10;
  SHEET_HEIGHT+=BOTTOM_SHEET_PADDING;
  if (SHEET_HEIGHT < SHEET_MINIMUM_HEIGHT) {
    SHEET_HEIGHT=SHEET_MINIMUM_HEIGHT;
    shiftButtonsToTheBottom(SHEET_MINIMUM_HEIGHT - SHEET_HEIGHT);
  }
  sheetPanel.setFocusCycleRoot(true);
  recalculateShadow();
  sheetPanel.setSize(SHEET_NC_WIDTH,SHEET_NC_HEIGHT);
  return sheetPanel;
}
