{
  super(context.project,true);
  myContext=context;
  toRemoveCBs=new TObjectIntHashMap<JCheckBox>(parametersToRemove.size());
  for (  Object p : parametersToRemove.keys()) {
    JCheckBox cb=new JCheckBox(GroovyRefactoringBundle.message("remove.parameter.0.no.longer.used",((GrParameter)p).getName()));
    toRemoveCBs.put(cb,parametersToRemove.get((GrParameter)p));
    cb.setSelected(true);
  }
  JavaRefactoringSettings settings=JavaRefactoringSettings.getInstance();
  if (context.occurrences.length < 2) {
    myReplaceAllOccurrencesCheckBox.setSelected(true);
    myReplaceAllOccurrencesCheckBox.setVisible(false);
  }
  if (myContext.var == null) {
    myRemoveLocalVariableCheckBox.setSelected(false);
    myRemoveLocalVariableCheckBox.setVisible(false);
  }
 else {
    myRemoveLocalVariableCheckBox.setSelected(settings.INTRODUCE_PARAMETER_DELETE_LOCAL_VARIABLE);
  }
  initReplaceFieldsWithGetters(settings);
  myDeclareFinalCheckBox.setSelected(hasFinalModifier());
  myChangeVarUsages.setVisible(context.toReplaceIn instanceof GrClosableBlock && context.toSearchFor instanceof GrVariable);
  setTitle(RefactoringBundle.message("introduce.parameter.title"));
  init();
}
