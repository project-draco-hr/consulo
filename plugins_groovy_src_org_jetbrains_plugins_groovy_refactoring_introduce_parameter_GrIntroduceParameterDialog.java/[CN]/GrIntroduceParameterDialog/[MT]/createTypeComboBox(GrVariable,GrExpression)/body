{
  GrTypeComboBox box;
  if (var != null) {
    box=GrTypeComboBox.createTypeComboBoxWithDefType(var.getDeclaredType());
  }
 else   if (expr != null) {
    box=GrTypeComboBox.createTypeComboBoxFromExpression(expr);
  }
 else {
    box=GrTypeComboBox.createEmptyTypeComboBox();
  }
  final ExtractClosureHelperImpl mockHelper=new ExtractClosureHelperImpl(myInfo,"__test___n_",false,new TIntArrayList(),false,0);
  final PsiType returnType;
  final AccessToken token=WriteAction.start();
  try {
    returnType=ExtractClosureProcessorBase.generateClosure(mockHelper).getReturnType();
  }
  finally {
    token.finish();
  }
  box.addClosureTypesFrom(returnType,mockHelper.getContext());
  if (expr == null && var == null) {
    box.setSelectedIndex(box.getItemCount() - 1);
  }
  return box;
}
