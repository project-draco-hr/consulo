{
  saveSettings();
  final GrParametersOwner toReplaceIn=myInfo.getToReplaceIn();
  final PsiType selectedType=myTypeComboBox.getSelectedType();
  final GrExpression expr=findExpr();
  final GrVariable var=findVar();
  if ((expr == null && var == null) || selectedType != null && selectedType.equalsToText(GroovyCommonClassNames.GROOVY_LANG_CLOSURE)) {
    GrIntroduceParameterSettings settings=new ExtractClosureHelperImpl(myInfo,myNameSuggestionsField.getEnteredName(),myDeclareFinalCheckBox.isSelected(),getParametersToRemove(),myDelegateViaOverloadingMethodCheckBox.isSelected(),getReplaceFieldsWithGetter());
    invokeRefactoring(new ExtractClosureFromMethodProcessor(settings));
  }
 else {
    GrIntroduceExpressionSettings settings=new GrIntroduceExpressionSettingsImpl(myInfo,myNameSuggestionsField.getEnteredName(),myDeclareFinalCheckBox.isSelected(),getParametersToRemove(),myDelegateViaOverloadingMethodCheckBox.isSelected(),getReplaceFieldsWithGetter(),expr,var,myTypeComboBox.getSelectedType());
    if (toReplaceIn instanceof GrMethod) {
      invokeRefactoring(new GrIntroduceParameterProcessor(settings));
    }
 else {
      invokeRefactoring(new GrIntroduceClosureParameterProcessor(settings));
    }
  }
}
