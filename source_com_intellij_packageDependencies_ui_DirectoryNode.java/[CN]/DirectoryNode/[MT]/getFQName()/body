{
  final StringBuffer buf=new StringBuffer();
  final Project project=myDirectory.getProject();
  final ProjectFileIndex index=ProjectRootManager.getInstance(project).getFileIndex();
  VirtualFile directory=myDirectory.getVirtualFile();
  VirtualFile contentRoot=index.getContentRootForFile(directory);
  if (directory == contentRoot) {
    return myShowModules ? "" : directory.getName() + "/";
  }
  if (contentRoot == null) {
    return "";
  }
  if (myShowModules) {
    while (directory != null && contentRoot != directory) {
      buf.insert(0,directory.getName() + "/");
      directory=directory.getParent();
    }
  }
 else {
    while (directory != null && contentRoot.getParent() != directory) {
      buf.insert(0,directory.getName() + "/");
      directory=directory.getParent();
    }
  }
  return buf.toString();
}
