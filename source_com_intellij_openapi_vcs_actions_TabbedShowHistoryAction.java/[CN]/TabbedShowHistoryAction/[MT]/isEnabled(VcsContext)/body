{
  FilePath[] selectedFiles=getSelectedFiles(context);
  if (selectedFiles == null)   return false;
  if (selectedFiles.length != 1)   return false;
  if (selectedFiles[0].isDirectory())   return false;
  FilePath path=selectedFiles[0];
  Project project=context.getProject();
  if (project == null)   return false;
  VirtualFile someVFile=path.getVirtualFile() != null ? path.getVirtualFile() : path.getVirtualFileParent();
  AbstractVcs vcs=ProjectLevelVcsManager.getInstance(project).getVcsFor(someVFile);
  if (vcs == null)   return false;
  VcsHistoryProvider vcsHistoryProvider=getProvider(vcs);
  if (vcsHistoryProvider == null)   return false;
  return vcs.fileExistsInVcs(path) && isVisible(context);
}
