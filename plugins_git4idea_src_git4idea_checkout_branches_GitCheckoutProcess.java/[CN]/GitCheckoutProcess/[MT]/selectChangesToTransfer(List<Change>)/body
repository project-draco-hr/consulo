{
  final Ref<GitSwitchBranchesDialog.Result> t=new Ref<GitSwitchBranchesDialog.Result>();
  UIUtil.invokeAndWaitIfNeeded(new Runnable(){
    @Override public void run(){
      try {
        t.set(GitSwitchBranchesDialog.showDialog(myProject,myNewConfiguration,changes,myRoots,myRemoteConfiguration,myConfig,myIsModify));
      }
 catch (      VcsException e) {
        myExceptions.add(e);
      }
catch (      Throwable e) {
        LOG.error("Unexpected error",e);
        myExceptions.add(new VcsException("Selecting changes failed",e));
      }
    }
  }
);
  if (t.get() == null) {
    return null;
  }
 else {
    myNewBranchMapping=t.get().referencesToUse;
    myNewConfiguration=t.get().target;
    return t.get().changes;
  }
}
