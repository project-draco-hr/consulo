{
  final Project project=getEventProject(e);
  if (project == null) {
    return;
  }
  Object dataFromContext=prepareDataFromContext(e);
  String defaultPath=null;
  final VirtualFile virtualFile=e.getData(PlatformDataKeys.VIRTUAL_FILE);
  if (virtualFile != null && virtualFile.isDirectory()) {
    defaultPath=virtualFile.getPath();
  }
  final AddModuleWizard wizard=Registry.is("new.project.wizard") ? new AddModuleWizardPro(project,new DefaultModulesProvider(project),defaultPath) : new AddModuleWizard(project,new DefaultModulesProvider(project),defaultPath);
  wizard.show();
  if (wizard.isOK()) {
    createModuleFromWizard(project,dataFromContext,wizard);
  }
}
