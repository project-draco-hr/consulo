{
  if (topElementIsSelected()) {
    goUp();
    return;
  }
  if (getSelectedValue() == null) {
    return;
  }
  final AbstractTreeNode element=getSelectedNode();
  if (element.getChildren().size() == 0) {
    if (!shouldDrillDownOnEmptyElement(element.getValue())) {
      navigateSelectedElement();
      return;
    }
  }
  if (myBuilder == null) {
    return;
  }
  updateHistory(false);
  myBuilder.drillDown();
  updateHistory(true);
}
