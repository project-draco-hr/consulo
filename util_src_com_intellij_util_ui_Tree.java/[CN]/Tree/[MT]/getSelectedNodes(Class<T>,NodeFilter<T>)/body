{
  TreePath[] paths=getSelectionPaths();
  if (paths == null)   return (T[])Array.newInstance(nodeType,0);
  ArrayList<T> nodes=new ArrayList<T>();
  for (int i=0; i < paths.length; i++) {
    Object last=paths[i].getLastPathComponent();
    if (nodeType.isAssignableFrom(last.getClass())) {
      if (filter != null && !filter.accept((T)last))       continue;
      nodes.add((T)last);
    }
  }
  T[] result=(T[])Array.newInstance(nodeType,nodes.size());
  nodes.toArray(result);
  return result;
}
