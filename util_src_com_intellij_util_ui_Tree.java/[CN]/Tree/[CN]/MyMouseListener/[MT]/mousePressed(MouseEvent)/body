{
  if (!SwingUtilities.isLeftMouseButton(mouseevent) && (SwingUtilities.isRightMouseButton(mouseevent) || SwingUtilities.isMiddleMouseButton(mouseevent))) {
    TreePath treepath=getPathForLocation(mouseevent.getX(),mouseevent.getY());
    if (treepath != null) {
      if (getSelectionModel().getSelectionMode() != TreeSelectionModel.SINGLE_TREE_SELECTION) {
        TreePath[] selectionPaths=getSelectionModel().getSelectionPaths();
        if (selectionPaths != null) {
          for (int i=0; i < selectionPaths.length; i++) {
            if (selectionPaths[i] == treepath)             return;
          }
        }
      }
      getSelectionModel().setSelectionPath(treepath);
    }
  }
}
