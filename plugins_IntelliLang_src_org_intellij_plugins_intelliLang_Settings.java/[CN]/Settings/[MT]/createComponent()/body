{
  final ProjectManager projectManager=ProjectManager.getInstance();
  final Project[] projects=projectManager.getOpenProjects();
  Project project=null;
  if (projects.length == 0) {
    project=projectManager.getDefaultProject();
  }
 else {
    final WindowManagerEx windowManager=WindowManagerEx.getInstanceEx();
    final Window focusedWindow=windowManager.getMostRecentFocusedWindow();
    if (focusedWindow != null) {
      for (      Project p : projects) {
        final Window w=windowManager.suggestParentWindow(p);
        if (w == focusedWindow || w.isAncestorOf(focusedWindow) || focusedWindow.isAncestorOf(w)) {
          project=p;
          break;
        }
      }
    }
    if (project == null) {
      project=projectManager.getDefaultProject();
    }
  }
  mySettingsUI=new SettingsUI(project,myConfiguration);
  return mySettingsUI.createComponent();
}
