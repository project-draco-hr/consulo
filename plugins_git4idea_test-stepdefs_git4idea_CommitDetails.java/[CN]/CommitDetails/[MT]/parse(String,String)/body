{
  CommitDetails commit=new CommitDetails();
  commit.myHash=hash;
  StringBuilder message=new StringBuilder();
  Collection<Change> changes=new ArrayList<Change>();
  ParsingStage stage=ParsingStage.MESSAGE;
  for (  String line : details.split("\n")) {
    if (line.equals("-----")) {
      stage=ParsingStage.DATA;
      continue;
    }
 else     if (line.equals("Changes:")) {
      stage=ParsingStage.CHANGES;
      continue;
    }
    if (stage == ParsingStage.MESSAGE) {
      message.append(line);
    }
 else     if (stage == ParsingStage.CHANGES) {
      changes.add(parseChange(line));
    }
 else     if (line.toLowerCase().startsWith("author: ")) {
      commit.myAuthor=line.substring("author: ".length());
    }
  }
  commit.myMessage=message.toString();
  commit.myChanges=changes;
  return commit;
}
