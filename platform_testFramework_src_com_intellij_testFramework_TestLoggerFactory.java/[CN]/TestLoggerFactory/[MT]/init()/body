{
  try {
    File logXmlFile=new File(PathManager.getHomePath(),"test-log.xml");
    if (!logXmlFile.exists()) {
      logXmlFile=new File(PathManager.getBinPath(),"log.xml");
    }
    if (!logXmlFile.exists()) {
      return;
    }
    final String logDir=getTestLogDir();
    String text=FileUtil.loadFile(logXmlFile);
    text=StringUtil.replace(text,SYSTEM_MACRO,StringUtil.replace(PathManager.getSystemPath(),"\\","\\\\"));
    text=StringUtil.replace(text,APPLICATION_MACRO,StringUtil.replace(PathManager.getHomePath(),"\\","\\\\"));
    text=StringUtil.replace(text,LOG_DIR_MACRO,StringUtil.replace(logDir,"\\","\\\\"));
    final File logDirFile=new File(logDir);
    if (!logDirFile.mkdirs() && !logDirFile.exists()) {
      throw new IOException("Unable to create log dir: " + logDirFile);
    }
    System.setProperty("log4j.defaultInitOverride","true");
    final DOMConfigurator domConfigurator=new DOMConfigurator();
    try {
      domConfigurator.doConfigure(new StringReader(text),LogManager.getLoggerRepository());
    }
 catch (    ClassCastException e) {
      System.err.println("log.xml content:\n" + text);
      throw e;
    }
    myInitialized=true;
  }
 catch (  Exception e) {
    e.printStackTrace();
  }
}
