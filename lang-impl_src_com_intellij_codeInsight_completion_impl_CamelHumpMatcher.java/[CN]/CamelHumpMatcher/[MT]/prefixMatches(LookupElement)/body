{
  LookupElement toAsk=element;
  while (toAsk instanceof LookupElementDecorator) {
    toAsk=((LookupElementDecorator)toAsk).getDelegate();
  }
  boolean itemCaseInsensitive=toAsk instanceof LookupItem && Boolean.TRUE.equals(((LookupItem)toAsk).getAttribute(LookupItem.CASE_INSENSITIVE));
  boolean result=prefixMatchersInternal(element,itemCaseInsensitive);
  if (result && itemCaseInsensitive) {
    final String currentString=ContainerUtil.find(element.getAllLookupStrings(),new Condition<String>(){
      public boolean value(      final String s){
        return StringUtil.startsWithIgnoreCase(s,myPrefix);
      }
    }
);
    if (currentString != null) {
      final String newString=handleCaseInsensitiveVariant(myPrefix,currentString);
      final LookupItem<?> item=(LookupItem)toAsk;
      item.setLookupString(newString);
      if (item.getObject().equals(currentString)) {
        ((LookupItem)item).setObject(newString);
      }
    }
  }
  return result;
}
