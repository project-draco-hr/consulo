{
  Object copy;
  try {
    BufferExposingByteArrayOutputStream baos=new BufferExposingByteArrayOutputStream();
    ObjectOutputStream os=new ObjectOutputStream(baos);
    try {
      os.writeObject(original);
    }
  finally {
      os.close();
    }
    InputStream bais=new ByteArrayInputStream(baos.getInternalBuffer(),0,baos.size());
    ObjectInputStream is=new ObjectInputStream(bais);
    try {
      copy=is.readObject();
    }
  finally {
      is.close();
    }
  }
 catch (  Exception e) {
    throw new RuntimeException(e);
  }
  return copy;
}
