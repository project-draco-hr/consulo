{
  Assert.assertTrue(wc1.isDirectory());
  final VirtualFile vf=LocalFileSystem.getInstance().refreshAndFindFileByIoFile(wc1);
  final UpdatedFiles files=UpdatedFiles.create();
  final UpdateSession session=myVcs.getUpdateEnvironment().updateDirectories(new FilePath[]{new FilePathImpl(vf)},files,new EmptyProgressIndicator(),new Ref<SequentialUpdatesContext>());
  Assert.assertTrue(session.getExceptions() != null && !session.getExceptions().isEmpty());
  Assert.assertTrue(!session.isCanceled());
  Assert.assertTrue(session.getExceptions().get(0).getMessage().contains(expectedText));
  if (myIsSecure) {
    ++myExpectedCreds;
    ++myExpectedCert;
  }
}
