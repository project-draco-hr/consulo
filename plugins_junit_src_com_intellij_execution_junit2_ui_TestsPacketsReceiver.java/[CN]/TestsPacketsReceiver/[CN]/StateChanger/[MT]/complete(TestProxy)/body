{
  testProxy.flush();
  final int magnitude=testProxy.getState().getMagnitude();
  TestProxy parent=testProxy.getParent();
  TestProxy child=testProxy;
  while (parent != null) {
    final List<TestProxy> children=parent.getChildren();
    final TestState parentState=parent.getState();
    if (parentState instanceof SuiteState) {
      if (!child.isInProgress() && child.equals(children.get(children.size() - 1))) {
        ((SuiteState)parentState).setRunning(false);
        parent.fireStateChanged();
        parent.flush();
      }
      ((SuiteState)parentState).updateMagnitude(magnitude);
    }
    child=parent;
    parent=parent.getParent();
  }
}
