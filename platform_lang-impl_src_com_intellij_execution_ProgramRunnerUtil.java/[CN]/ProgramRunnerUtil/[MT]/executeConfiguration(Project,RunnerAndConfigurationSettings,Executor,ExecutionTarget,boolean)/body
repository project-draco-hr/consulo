{
  ProgramRunner runner=getRunner(executor.getId(),configuration);
  if (runner == null) {
    LOG.error("Runner MUST not be null! Cannot find runner for " + executor.getId() + " and "+ configuration.getConfiguration().getFactory().getName());
    return;
  }
  if (ExecutorRegistry.getInstance().isStarting(project,executor.getId(),runner.getRunnerId())) {
    return;
  }
  if (!ExecutionTargetManager.canRun(configuration,target)) {
    ExecutionUtil.handleExecutionError(project,executor.getToolWindowId(),configuration.getConfiguration(),new ExecutionException(StringUtil.escapeXml("Cannot run '" + configuration.getName() + "' on '"+ target.getDisplayName()+ "'")));
    return;
  }
  if (!RunManagerImpl.canRunConfiguration(configuration,executor) || (showSettings && RunManagerImpl.isEditBeforeRun(configuration))) {
    if (!RunDialog.editConfiguration(project,configuration,"Edit configuration",executor.getActionName(),executor.getIcon())) {
      return;
    }
    while (!RunManagerImpl.canRunConfiguration(configuration,executor)) {
      if (0 == Messages.showYesNoDialog(project,"Configuration is still incorrect. Do you want to edit it again?","Change Configuration Settings","Edit","Continue Anyway",Messages.getErrorIcon())) {
        if (!RunDialog.editConfiguration(project,configuration,"Edit configuration",executor.getActionName(),executor.getIcon())) {
          return;
        }
      }
 else {
        break;
      }
    }
  }
  final ConfigurationType configurationType=configuration.getType();
  if (configurationType != null) {
    UsageTrigger.trigger("execute." + ConvertUsagesUtil.ensureProperKey(configurationType.getId()) + "."+ executor.getId());
  }
  try {
    runner.execute(executor,new ExecutionEnvironment(runner,target,configuration,project));
  }
 catch (  ExecutionException e) {
    ExecutionUtil.handleExecutionError(project,executor.getToolWindowId(),configuration.getConfiguration(),e);
  }
}
