{
  final int maxSize=VcsUtil.getMaxVcsLoadedFileSize();
  ByteArrayOutputStream buffer=new ByteArrayOutputStream(){
    @Override public synchronized void write(    int b){
      if (buf.length > maxSize)       throw new FileTooBigRuntimeException();
      super.write(b);
    }
    @Override public synchronized void write(    byte[] b,    int off,    int len){
      if (buf.length > maxSize)       throw new FileTooBigRuntimeException();
      super.write(b,off,len);
    }
    @Override public synchronized void writeTo(    OutputStream out) throws IOException {
      if (buf.length > maxSize)       throw new FileTooBigRuntimeException();
      super.writeTo(out);
    }
  }
;
  SVNWCClient wcClient=vcs.createWCClient();
  try {
    if (isUrl) {
      wcClient.doGetFileContents(SVNURL.parseURIEncoded(path),pegRevision,revision,true,buffer);
    }
 else {
      wcClient.doGetFileContents(new File(path),pegRevision,revision,true,buffer);
    }
    ContentRevisionCache.checkContentsSize(path,buffer.size());
  }
 catch (  FileTooBigRuntimeException e) {
    ContentRevisionCache.checkContentsSize(path,buffer.size());
  }
catch (  SVNException e) {
    throw new VcsException(e);
  }
  return buffer.toByteArray();
}
