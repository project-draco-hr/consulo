{
  File current=file;
  boolean wcDbFound=false;
  while (current != null) {
    File wcDb;
    if ((wcDb=getWcDb(current)).exists() && wcDb.isDirectory()) {
      wcDbFound=true;
      break;
    }
    current=current.getParentFile();
  }
  if (!wcDbFound)   return null;
  while (current != null) {
    try {
      final SvnWcGeneration svnWcGeneration=SvnOperationFactory.detectWcGeneration(current,false);
      if (SvnWcGeneration.V17.equals(svnWcGeneration))       return current;
      if (SvnWcGeneration.V16.equals(svnWcGeneration))       return null;
      if (upperBound != null && FileUtil.filesEqual(upperBound,current))       return null;
      current=current.getParentFile();
    }
 catch (    SVNException e) {
      return null;
    }
  }
  return null;
}
