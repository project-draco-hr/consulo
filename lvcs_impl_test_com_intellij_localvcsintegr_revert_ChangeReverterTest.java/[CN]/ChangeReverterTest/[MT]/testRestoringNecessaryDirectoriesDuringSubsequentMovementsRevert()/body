{
  VirtualFile dir1=root.createChildDirectory(null,"dir1");
  VirtualFile dir2=root.createChildDirectory(null,"dir2");
  VirtualFile dir3=root.createChildDirectory(null,"dir3");
  VirtualFile f=dir2.createChildData(null,"f.java");
  dir1.move(null,dir3);
  f.move(null,dir1);
  dir2.delete(null);
  revertChange(dir1,1);
  dir2=root.findChild("dir2");
  assertNotNull(dir2);
  assertEquals(dir2,f.getParent());
  assertEquals(root,dir1.getParent());
}
