{
  if (expression instanceof PsiReferenceExpression) {
    final PsiReferenceExpression referenceExpression=(PsiReferenceExpression)expression;
    final PsiElement target=referenceExpression.resolve();
    if (target instanceof PsiEnumConstant) {
      final PsiEnumConstant enumConstant=(PsiEnumConstant)target;
      return enumConstant.getName();
    }
  }
  if (castToInt) {
    final PsiType type=expression.getType();
    if (!PsiType.INT.equals(type)) {
      return "(int)" + expression.getText();
    }
  }
  return expression.getText();
}
