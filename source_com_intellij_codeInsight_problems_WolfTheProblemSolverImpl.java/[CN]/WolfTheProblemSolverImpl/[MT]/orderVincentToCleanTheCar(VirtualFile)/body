{
  final Document document=FileDocumentManager.getInstance().getDocument(file);
  if (willBeHighlightedAnyway(file))   return;
  final PsiFile psiFile=PsiManager.getInstance(myProject).findFile(file);
  if (psiFile == null)   return;
  ProgressManager.getInstance().runProcess(new Runnable(){
    public void run(){
      StatusBar statusBar=WindowManager.getInstance().getStatusBar(myProject);
      try {
        if (statusBar != null) {
          statusBar.setInfo("Checking '" + file.getPresentableUrl() + "'");
        }
        GeneralHighlightingPass pass=new GeneralHighlightingPass(myProject,psiFile,document,0,document.getTextLength(),false,true);
        pass.doCollectInformation(myProgress);
      }
  finally {
        if (statusBar != null) {
          statusBar.setInfo("");
        }
      }
    }
  }
,myProgress);
}
