{
  if (hasSyntaxErrors(file)) {
    return;
  }
  if (!myProject.isOpen())   return;
  if (willBeHighlightedAnyway(file))   return;
  final PsiFile psiFile=PsiManager.getInstance(myProject).findFile(file);
  if (psiFile == null)   return;
  final Document document=FileDocumentManager.getInstance().getDocument(file);
  if (document == null)   return;
  StatusBar statusBar=WindowManager.getInstance().getStatusBar(myProject);
  String oldInfo=null;
  try {
    if (statusBar instanceof StatusBarEx) {
      oldInfo=((StatusBarEx)statusBar).getInfo();
      statusBar.setInfo("Checking '" + file.getPresentableUrl() + "'");
    }
    GeneralHighlightingPass pass=new GeneralHighlightingPass(myProject,psiFile,document,0,document.getTextLength(),true){
      protected HighlightInfoHolder createInfoHolder(){
        final HighlightInfoFilter[] filters=ApplicationManager.getApplication().getComponents(HighlightInfoFilter.class);
        return new HighlightInfoHolder(psiFile,filters){
          public boolean add(          HighlightInfo info){
            if (info != null && info.getSeverity() == HighlightSeverity.ERROR) {
              throw new HaveGotErrorException(info,myHasErrorElement);
            }
            return super.add(info);
          }
        }
;
      }
    }
;
    pass.doCollectInformation(progressIndicator);
  }
 catch (  HaveGotErrorException e) {
    ProblemImpl problem=new ProblemImpl(file,e.myHighlightInfo,e.myHasErrorElement);
    reportProblems(file,Collections.<Problem>singleton(problem));
  }
 finally {
    if (statusBar instanceof StatusBarEx) {
      statusBar.setInfo(oldInfo);
    }
  }
}
