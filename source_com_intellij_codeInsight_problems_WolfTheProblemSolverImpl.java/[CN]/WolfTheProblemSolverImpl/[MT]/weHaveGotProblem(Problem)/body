{
  VirtualFile virtualFile=problem == null ? null : problem.getVirtualFile();
  if (!isToBeHighlighted(virtualFile))   return;
synchronized (myProblems) {
    ProblemFileInfo storedProblems=myProblems.get(virtualFile);
    if (storedProblems == null) {
      storedProblems=new ProblemFileInfo();
      myProblems.put(virtualFile,storedProblems);
      fireProblemListeners.problemsAppeared(virtualFile);
    }
    storedProblems.problems.add(problem);
    myCheckingQueue.addIfAbsent(virtualFile);
  }
}
