{
  LOG.assertTrue(element instanceof GrReferenceElement);
  final GrReferenceElement ref=(GrReferenceElement)element;
  final PsiElement resolved=ref.resolve();
  LOG.assertTrue(resolved instanceof PsiClass);
  final String qname=((PsiClass)resolved).getQualifiedName();
  final GrImportStatement importStatement=GroovyPsiElementFactory.getInstance(project).createImportStatementFromText(qname,true,true,null);
  final PsiFile containingFile=element.getContainingFile();
  LOG.assertTrue(containingFile instanceof GroovyFile);
  ((GroovyFile)containingFile).addImport(importStatement);
  for (  PsiReference reference : ReferencesSearch.search(resolved,new LocalSearchScope(containingFile),true)) {
    final PsiElement refElement=reference.getElement();
    if (refElement == null)     continue;
    final PsiElement parent=refElement.getParent();
    if (parent instanceof GrQualifiedReference) {
      GrReferenceAdjuster.shortenReference((GrQualifiedReference)parent);
    }
  }
}
