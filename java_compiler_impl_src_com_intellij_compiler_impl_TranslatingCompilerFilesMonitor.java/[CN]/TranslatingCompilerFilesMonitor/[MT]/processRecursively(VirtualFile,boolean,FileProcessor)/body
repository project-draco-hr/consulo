{
  if (!(file.getFileSystem() instanceof LocalFileSystem)) {
    return;
  }
  final FileTypeManager fileTypeManager=FileTypeManager.getInstance();
  VfsUtilCore.visitChildrenRecursively(file,new VirtualFileVisitor(){
    @NotNull @Override public Result visitFileEx(    @NotNull VirtualFile file){
      if (fileTypeManager.isFileIgnored(file)) {
        return SKIP_CHILDREN;
      }
      if (!file.isDirectory()) {
        processor.execute(file);
      }
      return CONTINUE;
    }
    @Nullable @Override public Iterable<VirtualFile> getChildrenIterable(    @NotNull VirtualFile file){
      return file.isDirectory() && dbOnly ? ((NewVirtualFile)file).iterInDbChildren() : null;
    }
  }
);
}
