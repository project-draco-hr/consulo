{
  final int maxLine=editor.offsetToLogicalPosition(editor.getDocument().getTextLength()).line;
  if (range.startLine <= 1 && !isDown)   return -1;
  if (range.endLine >= maxLine - 1 && isDown)   return -1;
  int nearLine=isDown ? range.endLine + 2 : range.startLine - 1;
  return editor.logicalPositionToOffset(new LogicalPosition(nearLine,0));
}
