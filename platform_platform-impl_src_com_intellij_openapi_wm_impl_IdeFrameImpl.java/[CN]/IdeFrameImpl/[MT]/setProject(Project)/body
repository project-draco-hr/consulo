{
  if (SystemInfo.isMacOSLion && myProject != project && project != null) {
    myRestoreFullscreen=myProject == null && shouldRestoreFullScreen(project);
    if (myProject != null) {
      storeFullScreenStateIfNeeded(false);
    }
  }
  myProject=project;
  if (project != null) {
    if (myRootPane != null) {
      myRootPane.installNorthComponents(project);
    }
    project.getMessageBus().connect().subscribe(StatusBar.Info.TOPIC,myRootPane.getStatusBar());
    installDefaultProjectStatusBarWidgets(myProject);
  }
 else {
    if (myRootPane != null) {
      myRootPane.deinstallNorthComponents();
    }
  }
  if (project == null) {
    FocusTrackback.release(this);
  }
  if (isVisible() && myRestoreFullscreen) {
    MacMainFrameDecorator.toggleFullScreen(this);
    myRestoreFullscreen=false;
    storeFullScreenStateIfNeeded(false);
  }
}
