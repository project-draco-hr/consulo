{
  if (myBaseStructureViewDescriptor == null || !myProject.isOpen())   return;
  final StructureViewComponent view=(StructureViewComponent)myBaseStructureViewDescriptor.structureView;
  if (view.isDisposed())   return;
  StructureViewState state=view.getState();
  List<PsiAnchor> expanded=collectAnchors(state.getExpandedElements());
  List<PsiAnchor> selected=collectAnchors(state.getSelectedElements());
  updateTemplateDataFileView();
  if (view.isDisposed())   return;
  for (  PsiAnchor pointer : expanded) {
    PsiElement element=pointer.retrieve();
    if (element != null) {
      view.expandPathToElement(element);
    }
  }
  for (  PsiAnchor pointer : selected) {
    PsiElement element=pointer.retrieve();
    if (element != null) {
      view.addSelectionPathTo(element);
    }
  }
}
