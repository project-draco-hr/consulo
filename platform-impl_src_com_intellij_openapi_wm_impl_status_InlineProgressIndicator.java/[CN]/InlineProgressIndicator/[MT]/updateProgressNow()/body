{
  if (myLastTimeProgressWasAtZero == 0 && getFraction() == 0) {
    myLastTimeProgressWasAtZero=System.currentTimeMillis();
  }
  final long delta=System.currentTimeMillis() - myLastTimeProgressWasAtZero;
  boolean forcedIndeterminite=false;
  boolean indeterminate=isIndeterminate();
  if (!indeterminate && getFraction() == 0) {
    if (delta > 2000 && !myCompact) {
      indeterminate=true;
      forcedIndeterminite=true;
    }
 else {
      forcedIndeterminite=false;
    }
  }
  final boolean visible=getFraction() > 0 || (indeterminate || forcedIndeterminite);
  updateVisibility(myProgress,visible);
  if (indeterminate || forcedIndeterminite) {
    myProgress.setIndeterminate(true);
  }
 else {
    myProgress.setIndeterminate(false);
    myProgress.setMinimum(0);
    myProgress.setMaximum(100);
  }
  if (getFraction() > 0) {
    myProgress.setValue((int)(getFraction() * 99 + 1));
  }
  myText.setText(getText() != null ? getText() : "");
  myText2.setText(getText2() != null ? getText2() : "");
  if (myCompact && myText.getText().length() == 0) {
    myText.setText(myInfo.getTitle());
  }
  myCancelButton.setPainting(isCancelable());
  if (getFraction() == 0) {
    if (!myLastTimeProgressWasZero) {
      myLastTimeProgressWasAtZero=System.currentTimeMillis();
      myLastTimeProgressWasZero=true;
    }
  }
 else {
    myLastTimeProgressWasZero=false;
  }
  final boolean isStopping=wasStarted() && (isCanceled() || !isRunning()) && !isFinished();
  if (isStopping) {
    if (myCompact) {
      myText.setText("Stopping - " + myText.getText());
    }
 else {
      myProcessName.setText("Stopping - " + myInfo.getTitle());
    }
    myText.setEnabled(false);
    myText2.setEnabled(false);
    myProgress.setEnabled(false);
    myCancelButton.setPainting(false);
  }
 else {
    myText.setEnabled(true);
    myText2.setEnabled(true);
    myProgress.setEnabled(true);
    myCancelButton.setPainting(true);
  }
}
