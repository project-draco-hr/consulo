{
  super(tree);
  tree.getSelectionModel().addTreeSelectionListener(new TreeSelectionListener(){
    public void valueChanged(    TreeSelectionEvent e){
      try {
        updateSelection(tree);
      }
 catch (      Exception e1) {
      }
    }
  }
);
  final TreeModelListener l=new TreeModelListener(){
    @Override public void treeNodesChanged(    TreeModelEvent e){
      updateSelection(tree);
    }
    @Override public void treeNodesInserted(    TreeModelEvent e){
      updateSelection(tree);
    }
    @Override public void treeNodesRemoved(    TreeModelEvent e){
      updateSelection(tree);
    }
    @Override public void treeStructureChanged(    TreeModelEvent e){
      updateSelection(tree);
    }
  }
;
  tree.getModel().addTreeModelListener(l);
  tree.addPropertyChangeListener("model",new PropertyChangeListener(){
    @Override public void propertyChange(    PropertyChangeEvent evt){
      updateSelection(tree);
      if (evt.getOldValue() != null) {
        ((TreeModel)evt.getOldValue()).removeTreeModelListener(l);
      }
      if (evt.getNewValue() != null) {
        ((TreeModel)evt.getNewValue()).addTreeModelListener(l);
      }
    }
  }
);
}
