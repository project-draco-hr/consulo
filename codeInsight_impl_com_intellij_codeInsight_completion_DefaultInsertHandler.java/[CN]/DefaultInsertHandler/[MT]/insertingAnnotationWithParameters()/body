{
  if (insertingAnnotation()) {
    final Document document=myContext.getEditor().getDocument();
    PsiDocumentManager.getInstance(myContext.getProject()).commitDocument(document);
    PsiElement elementAt=myFile.findElementAt(myContext.getStartOffset());
    if (elementAt instanceof PsiIdentifier) {
      if (insertingNotRuntimeAnnotation() || PsiTreeUtil.getParentOfType(elementAt,PsiAnnotationParameterList.class) != null) {
        final PsiElement parent=PsiTreeUtil.getParentOfType(elementAt,PsiModifierListOwner.class,PsiCodeBlock.class);
        if (parent instanceof PsiModifierListOwner) {
          final PsiClass psiClass=(PsiClass)myLookupItem.getObject();
          for (          PsiMethod m : psiClass.getMethods()) {
            if (!(m instanceof PsiAnnotationMethod))             continue;
            final PsiAnnotationMemberValue defaultValue=((PsiAnnotationMethod)m).getDefaultValue();
            if (defaultValue == null)             return true;
          }
        }
      }
    }
  }
  return false;
}
