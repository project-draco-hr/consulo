{
  int offset=Integer.MAX_VALUE;
  FindResult firstOccurrence=null;
  FindResult firstVisibleOccurrence=null;
  for (  FindResult o : getOccurrences()) {
    if (insideVisibleArea(myEditor,o)) {
      if (firstVisibleOccurrence == null || o.getStartOffset() < firstVisibleOccurrence.getStartOffset()) {
        firstVisibleOccurrence=o;
      }
    }
    if (o.getStartOffset() < offset) {
      offset=o.getStartOffset();
      firstOccurrence=o;
    }
  }
  return firstVisibleOccurrence != null ? firstVisibleOccurrence : firstOccurrence;
}
