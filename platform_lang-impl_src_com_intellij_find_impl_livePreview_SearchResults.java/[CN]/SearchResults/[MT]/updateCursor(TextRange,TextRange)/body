{
  boolean justReplaced=next != null;
  boolean toPush=true;
  if (justReplaced || (toPush=!repairCursorFromStack())) {
    if (justReplaced || !tryToRepairOldCursor(oldCursorRange)) {
      if (myFindModel != null) {
        if (oldCursorRange != null && !myFindModel.isGlobal()) {
          myCursor=firstOccurrenceAfterOffset(oldCursorRange.getEndOffset());
        }
 else {
          if (justReplaced) {
            nextOccurrence(false,next,false,justReplaced);
          }
 else {
            FindResult afterCaret=oldCursorRange == null ? firstOccurrenceAtOrAfterCaret() : firstOccurrenceAfterCaret();
            if (afterCaret != null) {
              myCursor=afterCaret;
            }
 else {
              myCursor=null;
            }
          }
        }
      }
 else {
        myCursor=null;
      }
    }
  }
  if (!justReplaced && myCursor == null && hasMatches()) {
    nextOccurrence(true,oldCursorRange,false,false);
  }
  if (toPush && myCursor != null) {
    push();
  }
}
