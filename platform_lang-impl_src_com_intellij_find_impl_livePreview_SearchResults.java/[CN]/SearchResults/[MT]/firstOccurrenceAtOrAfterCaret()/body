{
  int offset=getEditor().getCaretModel().getOffset();
  for (  FindResult occurrence : myOccurrences) {
    if (offset <= occurrence.getEndOffset() && offset >= occurrence.getStartOffset()) {
      return occurrence;
    }
  }
  int selectionStartOffset=getEditor().getSelectionModel().getSelectionStart();
  int selectionEndOffset=getEditor().getSelectionModel().getSelectionEnd();
  for (  FindResult occurrence : myOccurrences) {
    if (selectionEndOffset >= occurrence.getEndOffset() && selectionStartOffset <= occurrence.getStartOffset()) {
      return occurrence;
    }
  }
  return firstOccurrenceAfterCaret();
}
