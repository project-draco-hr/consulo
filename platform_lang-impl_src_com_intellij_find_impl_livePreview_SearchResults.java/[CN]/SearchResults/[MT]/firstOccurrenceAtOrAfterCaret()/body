{
  int offset=getEditor().getCaretModel().getOffset();
  for (  LiveOccurrence occurrence : myOccurrences) {
    if (offset <= occurrence.getPrimaryRange().getEndOffset() && offset >= occurrence.getPrimaryRange().getStartOffset()) {
      return occurrence;
    }
  }
  return firstOccurrenceAfterCaret();
}
