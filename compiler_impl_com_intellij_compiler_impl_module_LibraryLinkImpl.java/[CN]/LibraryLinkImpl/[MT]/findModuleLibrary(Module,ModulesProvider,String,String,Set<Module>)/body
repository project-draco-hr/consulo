{
  if (!visited.add(module)) {
    return null;
  }
  ModuleRootModel rootModel=provider.getRootModel(module);
  OrderEntry[] orderEntries=rootModel.getOrderEntries();
  for (  OrderEntry orderEntry : orderEntries) {
    if (orderEntry instanceof ModuleOrderEntry) {
      final Module dependency=((ModuleOrderEntry)orderEntry).getModule();
      if (dependency != null) {
        final Library library=findModuleLibrary(dependency,provider,url,name,visited);
        if (library != null) {
          return library;
        }
      }
    }
 else     if (orderEntry instanceof LibraryOrderEntry) {
      LibraryOrderEntry libraryOrderEntry=((LibraryOrderEntry)orderEntry);
      Library library=libraryOrderEntry.getLibrary();
      if (library == null)       continue;
      if (name != null && library.getTable() == null && name.equals(library.getName())) {
        return library;
      }
      if (name == null) {
        String[] urls=library.getUrls(OrderRootType.CLASSES);
        if (urls.length == 1 && Comparing.strEqual(urls[0],url))         return library;
      }
    }
  }
  return null;
}
