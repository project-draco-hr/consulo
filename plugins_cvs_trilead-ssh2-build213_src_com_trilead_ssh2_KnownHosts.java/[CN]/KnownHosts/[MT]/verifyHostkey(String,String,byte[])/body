{
  Object remoteKey=null;
  if ("ssh-rsa".equals(serverHostKeyAlgorithm)) {
    remoteKey=RSASHA1Verify.decodeSSHRSAPublicKey(serverHostKey);
  }
 else   if ("ssh-dss".equals(serverHostKeyAlgorithm)) {
    remoteKey=DSASHA1Verify.decodeSSHDSAPublicKey(serverHostKey);
  }
 else   throw new IllegalArgumentException("Unknown hostkey type " + serverHostKeyAlgorithm);
  int result=checkKey(hostname,remoteKey);
  if (result == HOSTKEY_IS_OK)   return result;
  InetAddress[] ipAdresses=null;
  try {
    ipAdresses=InetAddress.getAllByName(hostname);
  }
 catch (  UnknownHostException e) {
    return result;
  }
  for (int i=0; i < ipAdresses.length; i++) {
    int newresult=checkKey(ipAdresses[i].getHostAddress(),remoteKey);
    if (newresult == HOSTKEY_IS_OK)     return newresult;
    if (newresult == HOSTKEY_HAS_CHANGED)     result=HOSTKEY_HAS_CHANGED;
  }
  return result;
}
