{
  if ((hostnames == null) || (hostnames.length == 0))   throw new IllegalArgumentException("Need at least one hostname specification");
  if ((serverHostKeyAlgorithm == null) || (serverHostKey == null))   throw new IllegalArgumentException();
  CharArrayWriter writer=new CharArrayWriter();
  for (int i=0; i < hostnames.length; i++) {
    if (i != 0)     writer.write(',');
    writer.write(hostnames[i]);
  }
  writer.write(' ');
  writer.write(serverHostKeyAlgorithm);
  writer.write(' ');
  writer.write(Base64.encode(serverHostKey));
  writer.write("\n");
  char[] entry=writer.toCharArray();
  RandomAccessFile raf=new RandomAccessFile(knownHosts,"rw");
  long len=raf.length();
  if (len > 0) {
    raf.seek(len - 1);
    int last=raf.read();
    if (last != '\n')     raf.write('\n');
  }
  raf.write(new String(entry).getBytes("ISO-8859-1"));
  raf.close();
}
