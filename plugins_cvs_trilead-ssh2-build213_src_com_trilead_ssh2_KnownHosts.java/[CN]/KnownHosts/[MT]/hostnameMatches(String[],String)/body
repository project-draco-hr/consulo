{
  boolean isMatch=false;
  boolean negate=false;
  hostname=hostname.toLowerCase();
  for (int k=0; k < hostpatterns.length; k++) {
    if (hostpatterns[k] == null)     continue;
    String pattern=null;
    if ((hostpatterns[k].length() > 0) && (hostpatterns[k].charAt(0) == '!')) {
      pattern=hostpatterns[k].substring(1);
      negate=true;
    }
 else {
      pattern=hostpatterns[k];
      negate=false;
    }
    if ((isMatch) && (negate == false))     continue;
    if (pattern.charAt(0) == '|') {
      if (checkHashed(pattern,hostname)) {
        if (negate)         return false;
        isMatch=true;
      }
    }
 else {
      pattern=pattern.toLowerCase();
      if ((pattern.indexOf('?') != -1) || (pattern.indexOf('*') != -1)) {
        if (pseudoRegex(pattern.toCharArray(),0,hostname.toCharArray(),0)) {
          if (negate)           return false;
          isMatch=true;
        }
      }
 else       if (pattern.compareTo(hostname) == 0) {
        if (negate)         return false;
        isMatch=true;
      }
    }
  }
  return isMatch;
}
