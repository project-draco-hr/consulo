{
  int result=HOSTKEY_IS_NEW;
synchronized (publicKeys) {
    Iterator i=publicKeys.iterator();
    while (i.hasNext()) {
      KnownHostsEntry ke=(KnownHostsEntry)i.next();
      if (hostnameMatches(ke.patterns,remoteHostname) == false)       continue;
      boolean res=matchKeys(ke.key,remoteKey);
      if (res == true)       return HOSTKEY_IS_OK;
      result=HOSTKEY_HAS_CHANGED;
    }
  }
  return result;
}
