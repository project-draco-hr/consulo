{
  PsiFile file=PsiDocumentManager.getInstance(project).getPsiFile(document);
  if (file == null)   return null;
  offset=CharArrayUtil.shiftForward(document.getCharsSequence(),offset," \t");
  PsiElement element=file.findElementAt(offset);
  if (element == null)   return null;
  PsiField field=PsiTreeUtil.getParentOfType(element,PsiField.class,false);
  int line=document.getLineNumber(offset);
  if (field == null) {
    final PsiField[] fld=new PsiField[]{null};
    XDebuggerUtil.getInstance().iterateLine(project,document,line,new Processor<PsiElement>(){
      public boolean process(      PsiElement element){
        PsiField field=PsiTreeUtil.getParentOfType(element,PsiField.class,false);
        if (field != null) {
          fld[0]=field;
          return false;
        }
        return true;
      }
    }
);
    field=fld[0];
  }
  return field;
}
