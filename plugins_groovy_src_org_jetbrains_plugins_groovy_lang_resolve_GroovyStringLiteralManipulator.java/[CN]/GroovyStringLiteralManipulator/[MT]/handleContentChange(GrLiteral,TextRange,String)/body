{
  if (!(expr.getValue() instanceof String)) {
    throw new IncorrectOperationException("cannot handle content change, expr.getValue()=" + expr.getValue());
  }
  LOG.assertTrue(expr instanceof GrLiteralImpl);
  String oldText=expr.getText();
  final String quote=GrStringUtil.getStartQuote(oldText);
  if (StringUtil.startsWithChar(quote,'\'')) {
    newContent=GrStringUtil.escapeSymbolsForString(newContent,!quote.equals("'''"),true);
  }
 else   if (StringUtil.startsWithChar(quote,'\"')) {
    newContent=GrStringUtil.escapeSymbolsForGString(newContent,!quote.equals("\"\"\""),true);
  }
 else   if ("/".equals(quote)) {
    newContent=GrStringUtil.escapeSymbolsForSlashyStrings(newContent);
  }
 else   if ("$/".equals(quote)) {
    newContent=GrStringUtil.escapeSymbolsForDollarSlashyStrings(newContent);
  }
  String newText=oldText.substring(0,range.getStartOffset()) + newContent + oldText.substring(range.getEndOffset());
  return ((GrLiteralImpl)expr).updateText(newText);
}
