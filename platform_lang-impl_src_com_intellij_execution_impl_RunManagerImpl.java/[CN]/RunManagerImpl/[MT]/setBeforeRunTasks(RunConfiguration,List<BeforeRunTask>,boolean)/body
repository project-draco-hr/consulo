{
  List<BeforeRunTask> result=new SmartList<BeforeRunTask>(tasks);
  if (addEnabledTemplateTasksIfAbsent) {
    List<BeforeRunTask> templates=getTemplateBeforeRunTasks(runConfiguration);
    Set<Key<BeforeRunTask>> idsToSet=new THashSet<Key<BeforeRunTask>>();
    for (    BeforeRunTask task : tasks) {
      idsToSet.add(task.getProviderId());
    }
    int i=0;
    for (    BeforeRunTask template : templates) {
      if (!idsToSet.contains(template.getProviderId())) {
        result.add(i,template);
        i++;
      }
    }
  }
  myConfigurationToBeforeTasksMap.put(runConfiguration,result.isEmpty() ? Collections.<BeforeRunTask>emptyList() : result);
  fireBeforeRunTasksUpdated();
}
