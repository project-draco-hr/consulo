{
  Element parentNode=new Element("state");
  writeContext(parentNode);
  for (  RunnerAndConfigurationSettings configuration : myTemplateConfigurationsMap.values()) {
    if (configuration.getConfiguration() instanceof UnknownRunConfiguration && ((UnknownRunConfiguration)configuration.getConfiguration()).isDoNotStore()) {
      continue;
    }
    addConfigurationElement(parentNode,configuration);
  }
  for (  RunnerAndConfigurationSettings configuration : getStableConfigurations(false)) {
    addConfigurationElement(parentNode,configuration);
  }
  JDOMExternalizableStringList order=null;
  for (  RunnerAndConfigurationSettings each : myConfigurations.values()) {
    if (each.getType() instanceof UnknownConfigurationType) {
      continue;
    }
    if (order == null) {
      order=new JDOMExternalizableStringList();
    }
    order.add(each.getUniqueID());
  }
  if (order != null) {
    order.writeExternal(parentNode);
  }
  final JDOMExternalizableStringList recentList=new JDOMExternalizableStringList();
  for (  RunConfiguration each : myRecentlyUsedTemporaries) {
    if (each.getType() instanceof UnknownConfigurationType) {
      continue;
    }
    RunnerAndConfigurationSettings settings=getSettings(each);
    if (settings == null) {
      continue;
    }
    recentList.add(settings.getUniqueID());
  }
  if (!recentList.isEmpty()) {
    Element recent=new Element(RECENT);
    parentNode.addContent(recent);
    recentList.writeExternal(recent);
  }
  if (myUnknownElements != null) {
    for (    Element unloadedElement : myUnknownElements) {
      parentNode.addContent(unloadedElement.clone());
    }
  }
  return parentNode;
}
