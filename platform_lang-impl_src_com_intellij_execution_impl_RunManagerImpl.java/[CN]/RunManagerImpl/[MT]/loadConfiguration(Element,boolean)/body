{
  RunnerAndConfigurationSettingsImpl settings=new RunnerAndConfigurationSettingsImpl(this);
  settings.readExternal(element);
  ConfigurationFactory factory=settings.getFactory();
  if (factory == null) {
    return null;
  }
  final Element methodsElement=element.getChild(METHOD);
  final List<BeforeRunTask> tasks=readStepsBeforeRun(methodsElement,settings);
  if (settings.isTemplate()) {
    myTemplateConfigurationsMap.put(factory.getType().getId() + "." + factory.getName(),settings);
    setBeforeRunTasks(settings.getConfiguration(),tasks,true);
  }
 else {
    addConfiguration(settings,isShared,tasks,true);
    if (Boolean.valueOf(element.getAttributeValue(SELECTED_ATTR)).booleanValue()) {
      setSelectedConfiguration(settings);
    }
  }
  return settings;
}
