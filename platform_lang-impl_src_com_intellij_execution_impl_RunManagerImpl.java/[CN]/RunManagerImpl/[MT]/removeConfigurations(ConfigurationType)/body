{
  List<RunnerAndConfigurationSettings> removed=new ArrayList<RunnerAndConfigurationSettings>();
  for (Iterator<RunnerAndConfigurationSettings> it=getSortedConfigurations().iterator(); it.hasNext(); ) {
    final RunnerAndConfigurationSettings configuration=it.next();
    final ConfigurationType configurationType=configuration.getType();
    if (configurationType != null && type.getId().equals(configurationType.getId())) {
      removed.add(configuration);
      invalidateConfigurationIcon(configuration);
      it.remove();
    }
  }
  fireRunConfigurationsRemoved(removed);
  final RunnerAndConfigurationSettings selectedConfiguration=getSelectedConfiguration();
  if (selectedConfiguration != null && removed.contains(selectedConfiguration)) {
    final Collection<RunnerAndConfigurationSettings> sortedConfigurations=getSortedConfigurations();
    RunnerAndConfigurationSettings toSelect=null;
    if (sortedConfigurations.size() > 0) {
      toSelect=sortedConfigurations.iterator().next();
    }
    setSelectedConfiguration(toSelect);
  }
}
