{
  Handler handler=getHandler(e);
  boolean enabled=handler != null;
  boolean selected=enabled && handler.isPinned;
  e.getPresentation().setIcon(ActionPlaces.isToolbarPlace(e.getPlace()) ? AllIcons.General.Pin_tab : null);
  e.getPresentation().putClientProperty(SELECTED_PROPERTY,selected);
  String text;
  if (ActionPlaces.isMainMenuOrActionSearch(e.getPlace()) || handler != null && !handler.isActiveTab) {
    text=selected ? IdeBundle.message("action.unpin.active.tab") : IdeBundle.message("action.pin.active.tab");
  }
 else {
    text=selected ? IdeBundle.message("action.unpin.tab") : IdeBundle.message("action.pin.tab");
  }
  e.getPresentation().setText(text);
  e.getPresentation().setEnabledAndVisible(enabled);
}
