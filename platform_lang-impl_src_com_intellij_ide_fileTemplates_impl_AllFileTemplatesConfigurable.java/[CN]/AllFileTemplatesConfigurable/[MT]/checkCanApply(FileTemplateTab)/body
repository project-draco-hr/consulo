{
  final FileTemplate[] templates=myCurrentTab.getTemplates();
  final List<String> allNames=new ArrayList<String>();
  FileTemplate itemWithError=null;
  boolean errorInName=true;
  String errorString=null;
  for (  FileTemplate template : templates) {
    if (isInternalTemplateName(template.getName())) {
      continue;
    }
    final String currName=template.getName();
    final String currExt=template.getExtension();
    if (currName.length() == 0) {
      itemWithError=template;
      errorString=IdeBundle.message("error.please.specify.template.name");
      break;
    }
    if (allNames.contains(currName)) {
      itemWithError=template;
      errorString=IdeBundle.message("error.template.with.such.name.already.exists");
      break;
    }
    if (currExt.length() == 0) {
      itemWithError=template;
      errorString=IdeBundle.message("error.please.specify.template.extension");
      errorInName=false;
      break;
    }
    allNames.add(currName);
  }
  if (itemWithError != null) {
    final boolean _errorInName=errorInName;
    myTabbedPane.setSelectedIndex(Arrays.asList(myTabs).indexOf(list));
    selectTemplate(itemWithError);
    list.selectTemplate(itemWithError);
    ApplicationManager.getApplication().invokeLater(new Runnable(){
      @Override public void run(){
        if (_errorInName) {
          myEditor.focusToNameField();
        }
 else {
          myEditor.focusToExtensionField();
        }
      }
    }
);
    throw new ConfigurationException(errorString);
  }
}
