{
  if (disposable == null) {
    return delegate;
  }
  if (delegate instanceof DumbAware) {
    return new DumbAwareRunnable(delegate,disposable);
  }
  if (delegate instanceof PossiblyDumbAware) {
    return new PossiblyDumbAwareRunnable(delegate,disposable);
  }
  return new DisposeAwareRunnable(delegate,disposable);
}
