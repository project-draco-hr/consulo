def __del__(self):
    if self.held:
        warnings.warn('use lock.release instead of del lock', category=DeprecationWarning, stacklevel=2)
        self.held = 1
    self.release()
