{
synchronized (ourParser) {
    final Ref<String> localNameRef=new Ref<String>();
    final Ref<String> nsRef=new Ref<String>("");
    final DefaultHandler handler=new DefaultHandler(){
      public InputSource resolveEntity(      final String publicId,      final String systemId) throws IOException, SAXException {
        nsRef.set(systemId);
        return super.resolveEntity(publicId,systemId);
      }
      public void startElement(      final String uri,      final String localName,      final String qName,      final Attributes attributes) throws SAXException {
        localNameRef.set(localName);
        if (StringUtil.isNotEmpty(uri) && StringUtil.isEmpty(nsRef.get())) {
          nsRef.set(uri);
        }
        throw new SAXException();
      }
    }
;
    ourParser.setContentHandler(handler);
    ourParser.setEntityResolver(handler);
    ourParser.setErrorHandler(handler);
    try {
      ourParser.setProperty("http://apache.org/xml/properties/internal/entity-resolver",new XMLEntityResolver(){
        public XMLInputSource resolveEntity(        final XMLResourceIdentifier resourceIdentifier) throws XNIException, IOException {
          return null;
        }
      }
);
      ourParser.setFeature("http://xml.org/sax/features/namespaces",true);
      ourParser.setFeature("http://apache.org/xml/features/allow-java-encodings",true);
      ourParser.setFeature("http://apache.org/xml/features/nonvalidating/load-external-dtd",false);
      ourParser.setFeature("http://xml.org/sax/features/external-general-entities",false);
      ourParser.setFeature("http://xml.org/sax/features/external-parameter-entities",false);
    }
 catch (    SAXNotRecognizedException e) {
    }
catch (    SAXNotSupportedException e) {
    }
    try {
      ourParser.parse(source);
    }
 catch (    SAXException e) {
    }
 finally {
      ourParser.reset();
      closeStream(source.getByteStream());
      closeStream(source.getCharacterStream());
      ourParser.setContentHandler(null);
      ourParser.setEntityResolver(null);
      ourParser.setErrorHandler(null);
    }
    return Pair.create(localNameRef.get(),nsRef.get());
  }
}
