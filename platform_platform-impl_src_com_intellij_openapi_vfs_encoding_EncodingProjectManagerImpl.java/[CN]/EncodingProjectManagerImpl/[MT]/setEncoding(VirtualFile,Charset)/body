{
  if (charset == null) {
    myMapping.remove(virtualFileOrDir);
  }
 else {
    myMapping.put(virtualFileOrDir,charset);
  }
  myModificationCount++;
  if (virtualFileOrDir != null) {
    virtualFileOrDir.setCharset(virtualFileOrDir.getBOM() == null ? charset : null);
  }
  reloadAllFilesUnder(virtualFileOrDir);
}
