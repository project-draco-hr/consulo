{
  if (occurences.length == 0)   return null;
  PsiElement candidate;
  if (occurences.length == 1 || !replaceAllOccurences) {
    candidate=expr;
  }
 else {
    sortOccurences(occurences);
    candidate=occurences[0];
  }
  while (candidate != null && !container.equals(candidate.getParent())) {
    candidate=candidate.getParent();
  }
  return candidate;
}
