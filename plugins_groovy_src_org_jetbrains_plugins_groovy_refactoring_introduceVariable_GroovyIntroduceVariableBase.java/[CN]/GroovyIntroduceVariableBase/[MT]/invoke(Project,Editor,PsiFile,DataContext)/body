{
  if (!editor.getSelectionModel().hasSelection()) {
    editor.getSelectionModel().selectLineAtCaret();
  }
  GroovyRefactoringUtil.trimSpacesAndComments(editor,file,true);
  if (invoke(project,editor,file,editor.getSelectionModel().getSelectionStart(),editor.getSelectionModel().getSelectionEnd())) {
    editor.getSelectionModel().removeSelection();
  }
}
