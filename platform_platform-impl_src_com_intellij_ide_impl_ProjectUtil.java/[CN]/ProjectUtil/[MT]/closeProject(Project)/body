{
  return ApplicationManager.getApplication().runWriteAction(new Computable<Boolean>(){
    public Boolean compute(){
      if (!ProjectManagerEx.getInstanceEx().closeProject(project))       return false;
      Disposer.dispose(project);
      return true;
    }
  }
);
}
