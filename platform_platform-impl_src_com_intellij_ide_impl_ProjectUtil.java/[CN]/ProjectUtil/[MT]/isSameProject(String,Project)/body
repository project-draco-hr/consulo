{
  final IProjectStore projectStore=((ProjectEx)p).getStateStore();
  final String toOpen=FileUtil.toSystemIndependentName(path);
  final VirtualFile projectFile=projectStore.getProjectFile();
  if (projectFile == null)   return false;
  final String existing=projectFile.getPath();
  final VirtualFile existingBaseDir=projectStore.getProjectBaseDir();
  if (existingBaseDir == null)   return false;
  final File openFile=new File(toOpen);
  if (openFile.isDirectory()) {
    return FileUtil.pathsEqual(toOpen,existingBaseDir.getPath());
  }
  if (StorageScheme.DIRECTORY_BASED == projectStore.getStorageScheme()) {
    return FileUtil.pathsEqual(FileUtil.toSystemIndependentName(openFile.getParentFile().getPath()),existingBaseDir.getPath());
  }
  return FileUtil.pathsEqual(toOpen,existing);
}
