{
  if (ReadonlyStatusHandler.getInstance(project).ensureFilesWritable(new VirtualFile[]{file.getVirtualFile()}).hasReadonlyFiles())   return;
  final PsiConditionalExpression exp=(PsiConditionalExpression)findMatchingElement(file,editor);
  final PsiExpression condition=exp.getCondition();
  final PsiExpression elseExpression=exp.getElseExpression();
  final PsiExpression thenExpression=exp.getThenExpression();
  final String newExpression=BoolUtils.getNegatedExpressionText(condition) + '?' + elseExpression.getText()+ ':'+ thenExpression.getText();
  replaceExpression(project,newExpression,exp);
}
