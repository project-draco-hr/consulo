{
  DefaultMutableTreeNode node=(DefaultMutableTreeNode)value;
  Descriptor descriptor=(Descriptor)node.getUserObject();
  myCheckbox.setSelected(descriptor.isChecked());
  myCheckbox.setBackground(UIUtil.getTreeTextBackground());
  setBackground(selected ? UIUtil.getTreeSelectionBackground() : UIUtil.getTreeTextBackground());
  Color foreground=selected ? UIUtil.getTreeSelectionForeground() : UIUtil.getTreeTextForeground();
  setForeground(foreground);
  myCheckbox.setForeground(foreground);
  myLabel.setForeground(foreground);
  myCheckbox.setEnabled(true);
  if (descriptor instanceof ConfigurationTypeDescriptor) {
    ConfigurationTypeDescriptor configurationTypeDescriptor=(ConfigurationTypeDescriptor)descriptor;
    myLabel.setFont(tree.getFont());
    myLabel.setText(configurationTypeDescriptor.getConfigurationType().getDisplayName());
    myLabel.setIcon(configurationTypeDescriptor.getIcon());
  }
 else   if (descriptor instanceof ConfigurationDescriptor) {
    ConfigurationDescriptor configurationTypeDescriptor=(ConfigurationDescriptor)descriptor;
    myLabel.setFont(tree.getFont());
    myLabel.setText(configurationTypeDescriptor.getName());
    myLabel.setIcon(null);
    if (((ConfigurationTypeDescriptor)((DefaultMutableTreeNode)node.getParent()).getUserObject()).isChecked()) {
      Color foregrnd=tree.getForeground();
      Color backgrnd=tree.getBackground();
      if (foregrnd == null)       foregrnd=Color.black;
      if (backgrnd == null)       backgrnd=Color.white;
      int red=(foregrnd.getRed() + backgrnd.getRed()) / 2;
      int green=(foregrnd.getGreen() + backgrnd.getGreen()) / 2;
      int blue=(foregrnd.getBlue() + backgrnd.getBlue()) / 2;
      Color halftone=new Color(red,green,blue);
      setForeground(halftone);
      myCheckbox.setForeground(halftone);
      myLabel.setForeground(halftone);
      myCheckbox.setEnabled(false);
    }
  }
  return this;
}
