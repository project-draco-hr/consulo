{
  final LinkedHashSet<XmlElementDescriptor> result=new LinkedHashSet<XmlElementDescriptor>();
  final XmlElementContentSpec contentSpecElement=myElementDecl.getContentSpecElement();
  final XmlNSDescriptor nsDescriptor=getNSDescriptor();
  final XmlNSDescriptor NSDescriptor=nsDescriptor != null ? nsDescriptor : getNsDescriptorFrom(context);
  XmlUtil.processXmlElements(contentSpecElement,new PsiElementProcessor(){
    public boolean execute(    @NotNull PsiElement child){
      if (child instanceof XmlToken) {
        final XmlToken token=(XmlToken)child;
        if (token.getTokenType() == XmlTokenType.XML_NAME) {
          final String text=child.getText();
          XmlElementDescriptor element=getElementDescriptor(text,NSDescriptor);
          if (element != null) {
            result.add(element);
          }
        }
 else         if (token.getTokenType() == XmlTokenType.XML_CONTENT_ANY) {
          if (NSDescriptor instanceof XmlNSDescriptorImpl) {
            ContainerUtil.addAll(result,((XmlNSDescriptorImpl)NSDescriptor).getElements());
          }
 else           if (NSDescriptor instanceof XmlNSDescriptorSequence) {
            for (            XmlNSDescriptor xmlNSDescriptor : ((XmlNSDescriptorSequence)NSDescriptor).getSequence()) {
              if (xmlNSDescriptor instanceof XmlNSDescriptorImpl) {
                ContainerUtil.addAll(result,((XmlNSDescriptorImpl)xmlNSDescriptor).getElements());
              }
            }
          }
        }
      }
      return true;
    }
  }
,true,false,XmlUtil.getContainingFile(getDeclaration()));
  return result.toArray(new XmlElementDescriptor[result.size()]);
}
