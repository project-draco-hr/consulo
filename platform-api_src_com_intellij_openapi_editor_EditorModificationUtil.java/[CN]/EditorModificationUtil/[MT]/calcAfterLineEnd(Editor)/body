{
  Document document=editor.getDocument();
  LogicalPosition logicalPosition=editor.getCaretModel().getLogicalPosition();
  int columnNumber=logicalPosition.column;
  int lineNumber=logicalPosition.line;
  if (lineNumber >= document.getLineCount()) {
    return columnNumber;
  }
  int lineEndOffset=document.getLineEndOffset(lineNumber);
  int lineEndColumnNumber=editor.offsetToLogicalPosition(lineEndOffset).column;
  return columnNumber - lineEndColumnNumber;
}
