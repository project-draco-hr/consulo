{
  if (editor == null)   return null;
  final Project project=editor.getProject();
  if (project == null || project.isDisposed())   return null;
  final LookupEx lookup=getInstance(project).getActiveLookup();
  if (lookup == null)   return null;
  return InjectedLanguageUtil.getTopLevelEditor(lookup.getEditor()) == InjectedLanguageUtil.getTopLevelEditor(editor) ? lookup : null;
}
