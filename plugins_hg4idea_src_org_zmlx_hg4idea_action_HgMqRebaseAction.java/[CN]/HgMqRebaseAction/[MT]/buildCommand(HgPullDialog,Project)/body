{
  final VirtualFile repository=dialog.getRepository();
  return new HgGlobalCommand(){
    public VirtualFile getRepo(){
      return repository;
    }
    public void execute(){
      HgMQCommand mqCommand=new HgMQCommand(project);
      boolean notFoundAppliedPatches=mqCommand.qapplied(repository).isEmpty();
      if (notFoundAppliedPatches) {
        return;
      }
      HgPullCommand pullCommand=new HgPullCommand(project,repository);
      pullCommand.setSource(dialog.getSource());
      pullCommand.setRebase(true);
      pullCommand.setUpdate(false);
    }
  }
;
}
