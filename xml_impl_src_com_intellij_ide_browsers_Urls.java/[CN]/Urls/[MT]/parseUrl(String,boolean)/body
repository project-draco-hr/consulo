{
  Matcher matcher=URI_PATTERN.matcher(url);
  if (!matcher.matches()) {
    LOG.warn("Cannot parse url " + url);
    return null;
  }
  String scheme=matcher.group(1);
  String authority=StringUtil.nullize(matcher.group(2));
  String path=StringUtil.nullize(matcher.group(3));
  String parameters=matcher.group(4);
  if (authority != null && StandardFileSystems.FILE_PROTOCOL.equals(scheme)) {
    path=path == null ? authority : (authority + path);
    authority=null;
  }
  return new UrlImpl(urlAsRaw ? url : null,scheme,authority,path,parameters);
}
