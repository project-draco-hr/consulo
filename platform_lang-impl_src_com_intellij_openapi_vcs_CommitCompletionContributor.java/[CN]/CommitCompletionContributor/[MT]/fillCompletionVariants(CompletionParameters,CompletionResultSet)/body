{
  if (parameters.getInvocationCount() == 0)   return;
  PsiFile file=parameters.getOriginalFile();
  Document document=PsiDocumentManager.getInstance(file.getProject()).getDocument(file);
  if (document != null) {
    DataContext dataContext=document.getUserData(CommitMessage.DATA_CONTEXT_KEY);
    if (dataContext != null) {
      ChangeList[] lists=VcsDataKeys.CHANGE_LISTS.getData(dataContext);
      if (lists != null) {
        for (        ChangeList list : lists) {
          for (          Change change : list.getChanges()) {
            VirtualFile virtualFile=change.getVirtualFile();
            if (virtualFile != null) {
              result.addElement(LookupElementBuilder.create(virtualFile.getName()).setIcon(virtualFile.getIcon()));
            }
          }
        }
      }
    }
  }
}
