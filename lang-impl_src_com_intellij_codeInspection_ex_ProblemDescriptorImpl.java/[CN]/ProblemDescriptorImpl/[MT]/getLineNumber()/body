{
  PsiElement psiElement=getPsiElement();
  if (psiElement == null)   return -1;
  if (!psiElement.isValid())   return -1;
  LOG.assertTrue(psiElement.isPhysical());
  Document document=PsiDocumentManager.getInstance(psiElement.getProject()).getDocument(psiElement.getContainingFile());
  if (document == null)   return -1;
  final TextRange textRange=getTextRange();
  if (textRange == null)   return -1;
  return document.getLineNumber(textRange.getStartOffset()) + 1;
}
