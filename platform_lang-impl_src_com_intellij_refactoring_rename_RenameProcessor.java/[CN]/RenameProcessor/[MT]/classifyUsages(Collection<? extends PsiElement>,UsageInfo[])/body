{
  final MultiMap<PsiElement,UsageInfo> result=new MultiMap<PsiElement,UsageInfo>();
  for (  UsageInfo usage : usages) {
    LOG.assertTrue(usage instanceof MoveRenameUsageInfo);
    if (usage.getReference() instanceof LightElement) {
      continue;
    }
    MoveRenameUsageInfo usageInfo=(MoveRenameUsageInfo)usage;
    if (usage instanceof RelatedUsageInfo) {
      final PsiElement relatedElement=((RelatedUsageInfo)usage).getRelatedElement();
      if (elements.contains(relatedElement)) {
        result.putValue(relatedElement,usage);
      }
    }
 else {
      PsiElement referenced=usageInfo.getReferencedElement();
      if (elements.contains(referenced)) {
        result.putValue(referenced,usage);
      }
 else       if (referenced != null) {
        PsiElement indirect=referenced.getNavigationElement();
        if (elements.contains(indirect)) {
          result.putValue(indirect,usage);
        }
      }
    }
  }
  return result;
}
