{
  final Project project=PlatformDataKeys.PROJECT.getData(DataManager.getInstance().getDataContext(myMainPanel));
  super.doOKAction();
  myPreviewEditor.disposeUIResources();
  myPreviewOptions.disposeUIResources();
  ((KeymapManagerImpl)KeymapManager.getInstance()).setActiveKeymap((Keymap)myKeymapComboBox.getSelectedItem());
  EditorColorsManager.getInstance().setGlobalScheme((EditorColorsScheme)myColorSchemeComboBox.getSelectedItem());
  TodoConfiguration.getInstance().resetToDefaultTodoPatterns();
  final boolean createScript=myCreateScriptCheckbox.isSelected();
  final boolean createEntry=myCreateEntryCheckBox.isSelected();
  if (createScript || createEntry) {
    final String pathName=myScriptPathTextField.getText();
    final boolean globalEntry=myGlobalEntryCheckBox.isSelected();
    ProgressManager.getInstance().run(new Task.Backgroundable(project,getTitle()){
      @Override public void run(      @NotNull final ProgressIndicator indicator){
        indicator.setFraction(0.0);
        if (createScript) {
          indicator.setText("Creating launcher script...");
          CreateLauncherScriptAction.createLauncherScript(project,pathName);
          indicator.setFraction(0.5);
        }
        if (createEntry) {
          CreateDesktopEntryAction.createDesktopEntry(project,indicator,globalEntry);
        }
        indicator.setFraction(1.0);
      }
    }
);
  }
}
