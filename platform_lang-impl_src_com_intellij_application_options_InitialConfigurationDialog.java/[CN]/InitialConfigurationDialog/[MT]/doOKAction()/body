{
  final Project project=PlatformDataKeys.PROJECT.getData(DataManager.getInstance().getDataContext(myMainPanel));
  super.doOKAction();
  myPreviewEditor.disposeUIResources();
  myPreviewOptions.disposeUIResources();
  ((KeymapManagerImpl)KeymapManager.getInstance()).setActiveKeymap((Keymap)myKeymapComboBox.getSelectedItem());
  EditorColorsManager.getInstance().setGlobalScheme((EditorColorsScheme)myColorSchemeComboBox.getSelectedItem());
  TodoConfiguration.getInstance().resetToDefaultTodoPatterns();
  if (myCreateScriptCheckbox.isSelected()) {
    final String pathname=myScriptPathTextField.getText();
    ApplicationManager.getApplication().invokeLater(new Runnable(){
      @Override public void run(){
        CreateLauncherScriptAction.createLauncherScript(project,pathname);
      }
    }
);
  }
}
