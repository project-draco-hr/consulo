{
  return ApplicationManager.getApplication().runReadAction(new Computable<RangeMarker>(){
    @Override public RangeMarker compute(){
      FileDocumentManager fdm=FileDocumentManager.getInstance();
      final Document document=fdm.getCachedDocument(file);
      if (document != null) {
        int _offset=Math.min(offset,document.getTextLength());
        return document.createRangeMarker(_offset,_offset);
      }
      final LazyMarker marker=new OffsetLazyMarker(file,offset);
      addToLazyMarkersList(marker,file);
      return marker;
    }
  }
);
}
