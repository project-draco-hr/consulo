{
  super(project);
  EditorFactory.getInstance().getEventMulticaster().addDocumentListener(new DocumentAdapter(){
    @Override public void beforeDocumentChange(    DocumentEvent e){
      VirtualFile docFile=fileDocumentManager.getFile(e.getDocument());
      if (docFile == null)       return;
      WeakList<LazyMarker> lazyMarkers=myMarkers.get(docFile);
      if (lazyMarkers == null)       return;
      List<LazyMarker> markers=lazyMarkers.toStrongList();
      List<LazyMarker> markersToRemove=new ArrayList<LazyMarker>();
      for (      final LazyMarker marker : markers) {
        if (Comparing.equal(marker.getFile(),docFile)) {
          marker.getOrCreateDelegate();
          markersToRemove.add(marker);
        }
      }
      lazyMarkers.removeAll(markersToRemove);
    }
  }
,project);
}
