{
  if (disableEndVariable) {
    String varName=null;
    for (    VarOccurence occurence : myVariableOccurences) {
      if (!isEndVariable(occurence.myName)) {
        continue;
      }
      if (occurence.myOffset == offset) {
        varName=occurence.myName;
        break;
      }
    }
    if (varName != null) {
      for (      Variable variable : myVariables) {
        if (varName.equals(variable.getName())) {
          variable.setAlwaysStopAt(false);
          variable.setDefaultValueString("\"\"");
          break;
        }
      }
    }
  }
  int delta=text.length();
  for (  VarOccurence occurence : myVariableOccurences) {
    if (occurence.myOffset > offset || !disableEndVariable && occurence.myOffset == offset) {
      occurence.myOffset+=delta;
    }
  }
  myText.insert(offset,text);
  updateMarkers(offset,text);
}
