def recode(self, s, encoding=None):
    'This version of recode tries to encode unicode to bytecode,\n        and preferably using the UTF-8 codec.\n        Other types than Unicode are silently returned, this is by\n        intention, e.g. the None-type is not going to be encoded but instead\n        just passed through\n        '
    if (not encoding):
        encoding = (self.encoding or 'utf-8')
    if isinstance(s, unicode):
        return s.encode(encoding)
    else:
        return s
