{
  final Project project=module.getProject();
  final ProjectProfileManager profileManager=ProjectProfileManager.getProjectProfileManager(project,Profile.INSPECTION);
  LOG.assertTrue(profileManager != null);
  final VirtualFile[] files=ModuleRootManager.getInstance(module).getContentRoots();
  final PsiDirectory[] dirs=new PsiDirectory[files.length];
  final PsiManager psiManager=PsiManager.getInstance(project);
  int i=0;
  for (  final VirtualFile file : files) {
    dirs[i++]=ApplicationManager.getApplication().runReadAction(new Computable<PsiDirectory>(){
      @Nullable public PsiDirectory compute(){
        return psiManager.findDirectory(file);
      }
    }
);
  }
  processDirectories(dirs,result,profileManager);
}
