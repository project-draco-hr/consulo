{
  if (!CodeInsightUtil.prepareFileForWrite(variable.getContainingFile()))   return;
  PsiVariable refVariable=findPreviousVariable();
  if (refVariable == null)   return;
  refVariable.getModifierList().setModifierProperty(PsiModifier.FINAL,false);
  if (variable.getInitializer() == null) {
    variable.delete();
    return;
  }
  PsiDeclarationStatement declaration=(PsiDeclarationStatement)variable.getParent();
  final PsiElementFactory factory=variable.getManager().getElementFactory();
  final PsiStatement statement=factory.createStatementFromText(variable.getName() + " = " + variable.getInitializer().getText()+ ";",variable);
  declaration.replace(statement);
}
