{
  PsiElementFactory factory=JavaPsiFacade.getInstance(manager.getProject()).getElementFactory();
  if (qualifierClass != null) {
    PsiThisExpression qualifiedThis=(PsiThisExpression)factory.createExpressionFromText("q.this",null);
    qualifiedThis=(PsiThisExpression)CodeStyleManager.getInstance(manager.getProject()).reformat(qualifiedThis);
    PsiJavaCodeReferenceElement thisQualifier=qualifiedThis.getQualifier();
    LOG.assertTrue(thisQualifier != null);
    thisQualifier.bindToElement(qualifierClass);
    return qualifiedThis;
  }
 else {
    return (PsiThisExpression)factory.createExpressionFromText("this",null);
  }
}
