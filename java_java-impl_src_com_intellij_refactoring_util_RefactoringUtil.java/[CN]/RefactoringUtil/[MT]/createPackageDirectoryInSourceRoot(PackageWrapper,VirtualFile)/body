{
  final PsiDirectory[] directories=aPackage.getDirectories();
  for (  PsiDirectory directory : directories) {
    if (VfsUtil.isAncestor(sourceRoot,directory.getVirtualFile(),false)) {
      return directory;
    }
  }
  String qNameToCreate=qNameToCreateInSourceRoot(aPackage,sourceRoot);
  final String[] shortNames=qNameToCreate.split("\\.");
  PsiDirectory current=aPackage.getManager().findDirectory(sourceRoot);
  LOG.assertTrue(current != null);
  for (  String shortName : shortNames) {
    PsiDirectory subdirectory=current.findSubdirectory(shortName);
    if (subdirectory == null) {
      subdirectory=current.createSubdirectory(shortName);
    }
    current=subdirectory;
  }
  return current;
}
