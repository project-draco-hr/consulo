{
  final long timestamp=root.getRootFile().lastModified();
  root.processEntries(new JarBasedArtifactSourceRoot.EntryProcessor(){
    @Override public void process(    @Nullable InputStream inputStream,    @NotNull String relativePath) throws IOException {
      String pathInJar=addParentDirectories(jarOutputStream,writtenPaths,PathUtil.appendToPath(relativeOutputPath,relativePath));
      if (!writtenPaths.add(pathInJar))       return;
      if (inputStream != null) {
        ZipEntry entry=new ZipEntry(pathInJar);
        entry.setTime(timestamp);
        jarOutputStream.putNextEntry(entry);
        FileUtil.copy(inputStream,jarOutputStream);
        jarOutputStream.closeEntry();
      }
 else {
        addDirectoryEntry(jarOutputStream,pathInJar + "/");
      }
    }
  }
);
}
