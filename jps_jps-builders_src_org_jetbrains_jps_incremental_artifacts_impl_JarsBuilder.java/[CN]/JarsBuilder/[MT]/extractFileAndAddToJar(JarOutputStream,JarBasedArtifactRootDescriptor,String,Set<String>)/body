{
  final long timestamp=root.getRootFile().lastModified();
  root.processEntries(new JarBasedArtifactRootDescriptor.EntryProcessor(){
    @Override public void process(    @Nullable InputStream inputStream,    @NotNull String relativePath) throws IOException {
      String pathInJar=addParentDirectories(jarOutputStream,writtenPaths,JpsPathUtil.appendToPath(relativeOutputPath,relativePath));
      if (inputStream == null) {
        addDirectoryEntry(jarOutputStream,pathInJar + "/",writtenPaths);
      }
 else       if (writtenPaths.add(pathInJar)) {
        ZipEntry entry=new ZipEntry(pathInJar);
        entry.setTime(timestamp);
        jarOutputStream.putNextEntry(entry);
        FileUtil.copy(inputStream,jarOutputStream);
        jarOutputStream.closeEntry();
      }
    }
  }
);
}
