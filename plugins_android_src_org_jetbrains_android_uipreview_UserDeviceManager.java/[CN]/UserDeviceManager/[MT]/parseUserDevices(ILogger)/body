{
  final File userDevicesFile=getUserDevicesFile(logger);
  if (userDevicesFile == null) {
    return Collections.emptyList();
  }
  final VirtualFile vUserDeviceFile=LocalFileSystem.getInstance().findFileByIoFile(userDevicesFile);
  if (vUserDeviceFile == null) {
    return Collections.emptyList();
  }
  final ArrayList<Device> userDevices=new ArrayList<Device>();
  try {
    if (userDevicesFile.exists()) {
      userDevices.addAll(DeviceParser.parse(userDevicesFile));
    }
  }
 catch (  SAXException e) {
    if (myUserDevicesParsed) {
      logger.error(e,"Error parsing " + userDevicesFile.getAbsolutePath());
    }
 else {
      final String newName=userDevicesFile.getAbsoluteFile() + ".old";
      File renamedConfig=new File(newName);
      int i=0;
      while (renamedConfig.exists()) {
        renamedConfig=new File(newName + '.' + i);
        i++;
      }
      logger.error(e,"Error parsing " + userDevicesFile.getAbsolutePath() + ", backing up to "+ renamedConfig.getAbsolutePath());
      if (!userDevicesFile.renameTo(renamedConfig)) {
        logger.error(e,"Cannot rename file " + userDevicesFile.getAbsolutePath() + " to "+ renamedConfig.getAbsolutePath());
      }
    }
  }
catch (  ParserConfigurationException e) {
    logger.error(null,"Error parsing " + userDevicesFile.getAbsolutePath());
  }
catch (  IOException e) {
    logger.error(null,"Error parsing " + userDevicesFile.getAbsolutePath());
  }
 finally {
    myUserDevicesParsed=true;
  }
  return userDevices;
}
