{
  if (workingKey == null) {
    throw new IllegalStateException("Blowfish not initialised");
  }
  if (doEncrypt) {
    encryptBlock(in,inOff,out,outOff);
  }
 else {
    decryptBlock(in,inOff,out,outOff);
  }
}
