{
  if (isAvailable(project,null,file)) {
    new WriteCommandAction(project){
      protected void run(      Result result) throws Throwable {
        final PsiDirectory directory=chooseDirectory(project,file);
        if (directory == null)         return;
        ApplicationManager.getApplication().runWriteAction(new Runnable(){
          public void run(){
            doCreate(directory,startElement);
          }
        }
);
      }
    }
.execute();
  }
}
