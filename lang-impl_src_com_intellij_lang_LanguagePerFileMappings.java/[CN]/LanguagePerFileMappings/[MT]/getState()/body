{
synchronized (myMappings) {
    cleanup();
    final Element element=new Element("x");
    final List<VirtualFile> files=new ArrayList<VirtualFile>(myMappings.keySet());
    Collections.sort(files,new Comparator<VirtualFile>(){
      public int compare(      final VirtualFile o1,      final VirtualFile o2){
        if (o1 == null || o2 == null)         return o1 == null ? o2 == null ? 0 : 1 : -1;
        return o1.getPath().compareTo(o2.getPath());
      }
    }
);
    for (    VirtualFile file : files) {
      final T dialect=myMappings.get(file);
      final Element child=new Element("file");
      element.addContent(child);
      child.setAttribute("url",file == null ? "PROJECT" : file.getUrl());
      child.setAttribute("dialect",serialize(dialect));
    }
    return element;
  }
}
