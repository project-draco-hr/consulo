{
  myToolWindowForm=new AndroidLayoutPreviewToolWindowForm(myProject,this);
  myToolWindow=ToolWindowManager.getInstance(myProject).registerToolWindow(AndroidBundle.message("android.layout.preview.tool.window.title"),false,ToolWindowAnchor.RIGHT,myProject,true);
  ((ToolWindowManagerEx)ToolWindowManager.getInstance(myProject)).addToolWindowManagerListener(new ToolWindowManagerAdapter(){
    @Override public void stateChanged(){
      if (myToolWindow.isAvailable()) {
        final boolean visible=myToolWindow.isVisible();
        AndroidLayoutPreviewToolWindowSettings.getInstance(myProject).getState().setVisible(visible);
      }
    }
  }
);
  final JPanel contentPanel=myToolWindowForm.getContentPanel();
  final ContentManager contentManager=myToolWindow.getContentManager();
  final Content content=contentManager.getFactory().createContent(contentPanel,null,false);
  content.setDisposer(myToolWindowForm);
  content.setCloseable(false);
  content.setPreferredFocusableComponent(contentPanel);
  contentManager.addContent(content);
  contentManager.setSelectedContent(content,true);
  myToolWindow.setAvailable(false,null);
}
