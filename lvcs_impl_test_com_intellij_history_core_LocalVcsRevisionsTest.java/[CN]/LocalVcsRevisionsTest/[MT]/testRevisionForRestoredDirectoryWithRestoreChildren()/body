{
  vcs.createDirectory("dir");
  long timestamp=-1;
  vcs.createFile("dir/f",cf("one"),timestamp,false);
  int dirId=vcs.getEntry("dir").getId();
  int fileId=vcs.getEntry("dir/f").getId();
  vcs.delete("dir");
  vcs.beginChangeSet();
  vcs.restoreDirectory(dirId,"dir");
  long timestamp1=-1;
  vcs.restoreFile(fileId,"dir/f",cf("one"),timestamp1,false);
  vcs.endChangeSet(null);
  List<Revision> rr=vcs.getRevisionsFor("dir");
  assertEquals(3,rr.size());
  assertEquals(1,rr.get(0).getEntry().getChildren().size());
  assertEquals(1,rr.get(1).getEntry().getChildren().size());
  assertEquals(0,rr.get(2).getEntry().getChildren().size());
  assertEquals(2,vcs.getRevisionsFor("dir/f").size());
}
