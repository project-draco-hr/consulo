{
  final Module[] modules=ModuleManager.getInstance(myProject).getModules();
  for (  Module module : modules) {
    if (module.isDisposed())     continue;
    final Library[] libraries=GroovyConfigUtils.getInstance().getSDKLibrariesByModule(module);
    if ((libraries.length > 0 && !groovyModules.contains(module))) {
      final Application app=ApplicationManager.getApplication();
      if (app.isRestartCapable()) {
        if (Messages.showYesNoDialog(myProject,"You have added Groovy SDK library '" + libraries[0].getName() + "' to module '"+ module.getName()+ "'. To add Groovy support "+ ApplicationNamesInfo.getInstance().getFullProductName()+ " must be restarted. Would you like to add Groovy support and restart now?","Add Groovy support",Messages.getInformationIcon()) == 0) {
          FSRecords.invalidateCaches();
          app.restart();
        }
      }
 else {
        Messages.showMessageDialog(myProject,"You have added Groovy SDK library '" + libraries[0].getName() + "' to module '"+ module.getName()+ "'. To add Groovy support you need to restart "+ ApplicationNamesInfo.getInstance().getFullProductName()+ ".","Add Groovy support",Messages.getInformationIcon());
      }
    }
 else     if ((libraries.length == 0 && groovyModules.contains(module))) {
      groovyModules.remove(module);
    }
  }
}
