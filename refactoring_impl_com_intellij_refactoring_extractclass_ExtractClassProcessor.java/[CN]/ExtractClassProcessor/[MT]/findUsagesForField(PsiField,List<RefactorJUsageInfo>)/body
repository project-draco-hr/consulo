{
  final PsiManager psiManager=field.getManager();
  final Project project=psiManager.getProject();
  final GlobalSearchScope scope=GlobalSearchScope.allScope(project);
  final Iterable<PsiReference> references=SearchUtils.findAllReferences(field,scope);
  for (  PsiReference reference : references) {
    final PsiReferenceExpression exp=(PsiReferenceExpression)reference.getElement();
    if (isInMovedElement(exp)) {
      continue;
    }
    if (field.hasModifierProperty(PsiModifier.STATIC)) {
      final String qualifiedName=ClassUtil.createQualifiedName(newPackageName,newClassName);
      final String capitalizedName=StringUtil.capitalize(calculateStrippedName(field));
      final PsiType fieldType=field.getType();
      @NonNls final String getter;
      if (PsiType.BOOLEAN.equals(fieldType)) {
        getter="is" + capitalizedName;
      }
 else {
        getter="get" + capitalizedName;
      }
      @NonNls final String setter="set" + capitalizedName;
      final boolean isPublic=field.hasModifierProperty(PsiModifier.PUBLIC);
      if (AssignmentUtil.isPreIncrementedOrDecremented(exp)) {
        usages.add(new ReplaceStaticVariablePreIncrementDecrement(exp,qualifiedName,setter,getter,isPublic));
        if (!isPublic) {
          fieldsRequiringSetters.add(field);
        }
      }
 else       if (AssignmentUtil.isPostIncrementedOrDecremented(exp)) {
        usages.add(new ReplaceStaticVariablePostIncrementDecrement(exp,qualifiedName,setter,getter,isPublic));
        if (!isPublic) {
          fieldsRequiringSetters.add(field);
        }
      }
 else       if (AssignmentUtil.isOnLHS(exp)) {
        usages.add(new ReplaceStaticVariableAssignment(exp,qualifiedName,setter,getter,isPublic));
        if (!isPublic) {
          fieldsRequiringSetters.add(field);
        }
      }
 else {
        usages.add(new ReplaceStaticVariableAccess(exp,qualifiedName,getter,isPublic));
      }
      if (!isPublic) {
        fieldsRequiringGetters.add(field);
      }
    }
 else {
      final String capitalizedName=StringUtil.capitalize(calculateStrippedName(field));
      final PsiType fieldType=field.getType();
      @NonNls final String getter;
      if (PsiType.BOOLEAN.equals(fieldType)) {
        getter="is" + capitalizedName;
      }
 else {
        getter="get" + capitalizedName;
      }
      @NonNls final String setter="set" + capitalizedName;
      if (AssignmentUtil.isPreIncrementedOrDecremented(exp)) {
        usages.add(new ReplaceInstanceVariablePreIncrementDecrement(exp,delegateFieldName,setter,getter));
        fieldsRequiringSetters.add(field);
      }
 else       if (AssignmentUtil.isPostIncrementedOrDecremented(exp)) {
        usages.add(new ReplaceInstanceVariablePostIncrementDecrement(exp,delegateFieldName,setter,getter));
        fieldsRequiringSetters.add(field);
      }
 else       if (AssignmentUtil.isOnLHS(exp)) {
        final PsiAssignmentExpression assignment=PsiTreeUtil.getParentOfType(exp,PsiAssignmentExpression.class);
        usages.add(new ReplaceInstanceVariableAssignment(assignment,delegateFieldName,setter,getter));
        fieldsRequiringSetters.add(field);
      }
 else {
        usages.add(new ReplaceInstanceVariableAccess(exp,delegateFieldName,getter));
      }
      fieldsRequiringGetters.add(field);
    }
  }
}
