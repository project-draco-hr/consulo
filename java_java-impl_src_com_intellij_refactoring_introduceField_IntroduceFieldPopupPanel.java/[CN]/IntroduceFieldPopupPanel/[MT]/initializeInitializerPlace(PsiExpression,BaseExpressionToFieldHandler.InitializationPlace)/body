{
  if (initializerExpression != null) {
    setEnabledInitializationPlaces(initializerExpression,initializerExpression);
    if (!myAllowInitInMethod) {
      myInitialisersPlaceModel.removeElement(BaseExpressionToFieldHandler.InitializationPlace.IN_CURRENT_METHOD);
    }
  }
 else {
    myInitialisersPlaceModel.removeAllElements();
  }
  final PsiMethod setUpMethod=TestUtil.findSetUpMethod(myParentClass);
  final boolean setupEnabled=myInitialisersPlaceModel.getIndexOf(BaseExpressionToFieldHandler.InitializationPlace.IN_SETUP_METHOD) > -1;
  if (myInitializerExpression != null && PsiTreeUtil.isAncestor(setUpMethod,myInitializerExpression,false) && setupEnabled || ourLastInitializerPlace == BaseExpressionToFieldHandler.InitializationPlace.IN_SETUP_METHOD && TestUtil.isTestClass(myParentClass) && setupEnabled) {
    myInitialisersPlaceModel.setSelectedItem(BaseExpressionToFieldHandler.InitializationPlace.IN_SETUP_METHOD);
  }
 else   if (ourLastInitializerPlace == BaseExpressionToFieldHandler.InitializationPlace.IN_CONSTRUCTOR) {
    if (myInitialisersPlaceModel.getIndexOf(BaseExpressionToFieldHandler.InitializationPlace.IN_CONSTRUCTOR) > -1) {
      myInitialisersPlaceModel.setSelectedItem(BaseExpressionToFieldHandler.InitializationPlace.IN_CONSTRUCTOR);
    }
 else {
      selectInCurrentMethod();
    }
  }
 else   if (ourLastInitializerPlace == BaseExpressionToFieldHandler.InitializationPlace.IN_FIELD_DECLARATION) {
    if (myInitialisersPlaceModel.getIndexOf(BaseExpressionToFieldHandler.InitializationPlace.IN_FIELD_DECLARATION) > -1) {
      myInitialisersPlaceModel.setSelectedItem(BaseExpressionToFieldHandler.InitializationPlace.IN_FIELD_DECLARATION);
    }
 else {
      selectInCurrentMethod();
    }
  }
 else {
    selectInCurrentMethod();
  }
}
