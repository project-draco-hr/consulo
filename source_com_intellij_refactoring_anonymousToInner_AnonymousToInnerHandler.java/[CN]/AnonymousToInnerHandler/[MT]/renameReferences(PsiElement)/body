{
  PsiSearchHelper helper=myManager.getSearchHelper();
  PsiElementFactory factory=myManager.getElementFactory();
  for (int i=0; i < myVariableInfos.length; i++) {
    VariableInfo info=myVariableInfos[i];
    PsiReference[] references=helper.findReferences(info.variable,new LocalSearchScope(scope),false);
    if (references.length > 0) {
      for (int j=0; j < references.length; j++) {
        PsiElement ref=references[j].getElement();
        PsiIdentifier identifier=(PsiIdentifier)((PsiJavaCodeReferenceElement)ref).getReferenceNameElement();
        boolean renameToFieldName=!isUsedInInitializer(ref);
        PsiIdentifier newNameIdentifier=factory.createIdentifier(renameToFieldName ? info.fieldName : info.parameterName);
        if (renameToFieldName) {
          identifier.replace(newNameIdentifier);
        }
 else {
          if (info.passAsParameter) {
            identifier.replace(newNameIdentifier);
          }
        }
      }
    }
  }
}
