{
  int fastIndex=myCachedLastIndex != -1 && myIsBatchFoldingProcessing ? myCachedLastIndex + 1 : Collections.binarySearch(myRegions,range,OUR_COMPARATOR);
  if (fastIndex < 0)   fastIndex=-fastIndex - 1;
  for (int i=fastIndex; i < myRegions.size(); i++) {
    final FoldRegion region=myRegions.get(i);
    if (region.isValid() && intersects(region,range)) {
      return false;
    }
    if (range.getStartOffset() < region.getStartOffset() || (range.getStartOffset() == region.getStartOffset() && range.getEndOffset() > region.getEndOffset())) {
      for (int j=i + 1; j < myRegions.size(); j++) {
        final FoldRegion next=myRegions.get(j);
        if (next.getEndOffset() >= range.getEndOffset() && next.isValid()) {
          if (next.getStartOffset() < range.getStartOffset()) {
            return false;
          }
 else {
            break;
          }
        }
      }
      myRegions.add(myCachedLastIndex=i,range);
      return true;
    }
  }
  myRegions.add(myCachedLastIndex=myRegions.size(),range);
  return true;
}
