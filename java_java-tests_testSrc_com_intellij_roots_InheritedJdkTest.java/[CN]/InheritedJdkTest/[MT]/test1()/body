{
  final Sdk jdk=JavaSdkImpl.getMockJdk("java 1.4");
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    public void run(){
      ProjectJdkTable.getInstance().addJdk(jdk);
    }
  }
);
  final ModuleRootManager rootManager=ModuleRootManager.getInstance(myModule);
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    public void run(){
      final ProjectRootManagerEx rootManagerEx=ProjectRootManagerEx.getInstanceEx(myProject);
      rootManagerEx.setProjectJdkName(jdk.getName());
      final ModifiableRootModel rootModel=rootManager.getModifiableModel();
      rootModel.inheritSdk();
      rootModel.commit();
    }
  }
);
  assertTrue("JDK is inherited after explicit inheritSdk()",rootManager.isSdkInherited());
  assertTrue("Correct jdk inherited",jdk.equals(rootManager.getSdk()));
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    public void run(){
      final ModifiableRootModel rootModel=rootManager.getModifiableModel();
      rootModel.setSdk(null);
      rootModel.commit();
    }
  }
);
  assertFalse("JDK is not inherited after setJdk(null)",rootManager.isSdkInherited());
  assertTrue("No JDK assigned",null == rootManager.getSdk());
  final Sdk jdk1=JavaSdkImpl.getMockJdk("jjj");
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    public void run(){
      ProjectJdkTable.getInstance().addJdk(jdk1);
    }
  }
);
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    public void run(){
      final ModifiableRootModel rootModel=rootManager.getModifiableModel();
      rootModel.setSdk(jdk1);
      rootModel.commit();
    }
  }
);
  assertFalse("JDK is not inherited after setJdk(jdk1)",rootManager.isSdkInherited());
  assertTrue("jdk1 is assigned",jdk1.equals(rootManager.getSdk()));
}
