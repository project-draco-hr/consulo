{
  final PsiElementFactory factory=JavaPsiFacade.getInstance(project).getElementFactory();
  final PsiElement parent=expression.getParent();
  final PsiConditionalExpression conditionalExpression=(PsiConditionalExpression)factory.createExpressionFromText(condition + " ? " + expression.getText()+ " : "+ defaultValue,parent);
  final CodeStyleManager codeStyleManager=CodeStyleManager.getInstance(project);
  return (PsiConditionalExpression)expression.replace(codeStyleManager.reformat(conditionalExpression));
}
