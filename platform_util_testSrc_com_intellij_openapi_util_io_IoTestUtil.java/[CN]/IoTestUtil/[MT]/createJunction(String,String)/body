{
  assertTrue(SystemInfo.isWindows);
  final File targetFile=new File(target);
  assertTrue(targetFile.getPath(),targetFile.isDirectory());
  final String exePath=getJunctionExePath();
  final boolean isAbsolute=junction.matches("^[c-zC-Z]:[/\\\\].*$");
  final File junctionFile=isAbsolute ? new File(junction) : new File(FileUtil.getTempDirectory(),junction);
  assertTrue(junction,!junctionFile.exists() || junctionFile.delete());
  final File parentDir=junctionFile.getParentFile();
  assertTrue("junction=" + junction + ", parent="+ parentDir,parentDir != null && (parentDir.isDirectory() || parentDir.mkdirs()));
  final ProcessBuilder command=new ProcessBuilder(exePath,junctionFile.getAbsolutePath(),target);
  final int res=runCommand(command);
  assertEquals(command.command().toString(),0,res);
  assertTrue(junctionFile.getPath(),junctionFile.isDirectory());
  return junctionFile;
}
