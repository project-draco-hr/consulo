{
  visited.push(id);
  try {
    final IdeaPluginDescriptor ideaPluginDescriptor=idToDescriptorMap.get(id);
    if (ideaPluginDescriptor == null) {
      return;
    }
    final PluginId[] parentIds=ideaPluginDescriptor.getDependentPluginIds();
    for (    final PluginId parentId : parentIds) {
      if (visited.contains(parentId)) {
        throw new Exception(IdeBundle.message("error.plugins.should.not.have.cyclic.dependencies") + id + "->"+ parentId+ "->...->"+ id);
      }
    }
    for (    PluginId parentId1 : parentIds) {
      assignNumbers(parentId1,idToDescriptorMap,visited);
    }
    if (!myIdToNumberMap.contains(id)) {
      myIdToNumberMap.put(id,myAvailableNumber++);
    }
  }
  finally {
    visited.pop();
  }
}
