{
  Document document=myEditor.getDocument();
  if (offset >= myLastEntryOffset || offset >= document.getTextLength()) {
    return build(position);
  }
  T result=buildIfExceeds(position,offset);
  if (result != null) {
    return result;
  }
  int linesDiff=document.getLineNumber(offset) - position.logicalLine;
  position.logicalLine+=linesDiff;
  position.visualLine+=linesDiff;
  if (linesDiff <= 0) {
    int columnsDiff=offset - position.offset;
    position.visualColumn+=columnsDiff;
    position.logicalColumn+=columnsDiff;
  }
 else {
    int lineStartOffset=document.getLineStartOffset(position.logicalLine);
    int column=offset - lineStartOffset;
    position.visualColumn=column;
    position.logicalColumn=column;
    position.softWrapLinesBefore+=position.softWrapLinesCurrent;
    position.softWrapLinesCurrent=0;
    position.softWrapColumnDiff=0;
    position.foldingColumnDiff=0;
  }
  position.offset=offset;
  return null;
}
