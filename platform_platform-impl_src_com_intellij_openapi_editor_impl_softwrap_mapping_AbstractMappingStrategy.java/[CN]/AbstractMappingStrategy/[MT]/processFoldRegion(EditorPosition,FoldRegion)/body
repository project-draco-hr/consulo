{
  T result=buildIfExceeds(position,foldRegion);
  if (result != null) {
    return result;
  }
  Document document=myEditor.getDocument();
  int endOffsetLogicalLine=document.getLineNumber(foldRegion.getEndOffset());
  int collapsedSymbolsWidthInColumns=-1;
  if (position.logicalLine == endOffsetLogicalLine) {
    FoldingData foldingData=getFoldRegionData(foldRegion);
    if (foldingData != null) {
      collapsedSymbolsWidthInColumns=foldingData.getCollapsedSymbolsWidthInColumns();
    }
 else {
      String details="";
      if (myEditor instanceof EditorImpl) {
        details=((EditorImpl)myEditor).dumpState();
      }
      LogMessageEx.error(LOG,"Unexpected fold region is found: " + foldRegion,details);
    }
  }
 else {
    position.softWrapColumnDiff=0;
    position.softWrapLinesBefore+=position.softWrapLinesCurrent;
    position.softWrapLinesCurrent=0;
  }
  if (collapsedSymbolsWidthInColumns < 0) {
    collapsedSymbolsWidthInColumns=myRepresentationHelper.toVisualColumnSymbolsNumber(document.getCharsSequence(),foldRegion.getStartOffset(),foldRegion.getEndOffset(),0);
  }
  position.advance(foldRegion,collapsedSymbolsWidthInColumns);
  return null;
}
