{
  Diff.Change change=Diff.buildChanges(myResult.getSource(),myCurrentVersion.getSource());
  while (change != null) {
    shiftIndices(change.line1,change.line1,change.line0);
    shiftIndices(change.line1,change.line1 + change.inserted,change.line0 + change.deleted);
    change=change.link;
  }
  if (myResult.getEnd() >= myResult.getSource().length) {
    myResult.setEnd(myResult.getSource().length - 1);
  }
  return myResult;
}
