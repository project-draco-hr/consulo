{
  LOG.assertTrue(ApplicationManager.getApplication().isReadAccessAllowed());
  HighlightInfo[] highlights=getHighlights(document,project);
  if (highlights == null)   return HighlightInfo.EMPTY_ARRAY;
  Collection<HighlightInfo> array=new ArrayList<HighlightInfo>();
  final SeverityRegistrar instance=SeverityRegistrar.getInstance(project);
  for (  HighlightInfo info : highlights) {
    if (instance.compare(info.getSeverity(),minSeverity) >= 0 && info.startOffset >= startOffset && info.endOffset <= endOffset) {
      array.add(info);
    }
  }
  return array.toArray(new HighlightInfo[array.size()]);
}
