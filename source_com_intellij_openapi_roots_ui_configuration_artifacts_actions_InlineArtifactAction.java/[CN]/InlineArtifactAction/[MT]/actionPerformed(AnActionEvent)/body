{
  final LayoutTreeComponent treeComponent=myEditor.getLayoutTreeComponent();
  final LayoutTreeSelection selection=treeComponent.getSelection();
  final PackagingElement<?> element=selection.getElementIfSingle();
  final PackagingElementNode<?> node=selection.getNodeIfSingle();
  if (node == null || !(element instanceof ArtifactPackagingElement))   return;
  CompositePackagingElement<?> parent=node.getParentElement(element);
  if (parent == null) {
    return;
  }
  if (!treeComponent.checkCanRemove(selection.getNodes()))   return;
  if (!treeComponent.checkCanAdd(null,parent,node))   return;
  treeComponent.ensureRootIsWritable();
  parent.removeChild(element);
  final Artifact artifact=((ArtifactPackagingElement)element).findArtifact(myEditor.getContext());
  if (artifact != null) {
    final CompositePackagingElement<?> rootElement=artifact.getRootElement();
    if (rootElement instanceof ArtifactRootElement<?>) {
      for (      PackagingElement<?> child : rootElement.getChildren()) {
        parent.addOrFindChild(ArtifactUtil.copyWithChildren(child));
      }
    }
 else {
      parent.addOrFindChild(ArtifactUtil.copyWithChildren(rootElement));
    }
  }
  treeComponent.rebuildTree();
}
