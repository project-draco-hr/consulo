{
  final PsiElement leftBrace=descriptor.getPsiElement();
  final PsiCodeBlock block=(PsiCodeBlock)leftBrace.getParent();
  final PsiBlockStatement blockStatement=(PsiBlockStatement)block.getParent();
  final PsiElement containingElement=blockStatement.getParent();
  try {
    final PsiManager psiManager=PsiManager.getInstance(project);
    final CodeStyleManager styleManager=psiManager.getCodeStyleManager();
    final PsiElement[] children=block.getChildren();
    for (int i=1; i < children.length - 1; i++) {
      final PsiElement child=children[i];
      final PsiElement childCopy=child.copy();
      final PsiElement copiedElement=containingElement.addBefore(childCopy,blockStatement);
      styleManager.reformat(copiedElement);
    }
    blockStatement.delete();
    styleManager.reformat(containingElement);
  }
 catch (  IncorrectOperationException e) {
    final Class aClass=getClass();
    final String className=aClass.getName();
    final Logger logger=Logger.getInstance(className);
    logger.error(e);
  }
}
