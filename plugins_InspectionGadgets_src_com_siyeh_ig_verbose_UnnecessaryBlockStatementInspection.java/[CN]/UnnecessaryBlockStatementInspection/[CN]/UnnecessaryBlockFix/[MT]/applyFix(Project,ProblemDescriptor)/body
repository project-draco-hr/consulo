{
  if (ReadonlyStatusHandler.getInstance(project).ensureFilesWritable(new VirtualFile[]{descriptor.getPsiElement().getContainingFile().getVirtualFile()}).hasReadonlyFiles())   return;
  final PsiElement leftBrace=descriptor.getPsiElement();
  final PsiCodeBlock block=(PsiCodeBlock)leftBrace.getParent();
  final PsiBlockStatement blockStatement=(PsiBlockStatement)block.getParent();
  final PsiElement containingElement=blockStatement.getParent();
  try {
    final PsiElement[] children=block.getChildren();
    if (children.length > 2) {
      final PsiElement added=containingElement.addRangeBefore(children[1],children[children.length - 2],blockStatement);
      CodeStyleManager.getInstance(project).reformat(added);
    }
    blockStatement.delete();
  }
 catch (  IncorrectOperationException e) {
    final Class aClass=getClass();
    final String className=aClass.getName();
    final Logger logger=Logger.getInstance(className);
    logger.error(e);
  }
}
