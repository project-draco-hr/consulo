{
  myCurrentVariableNumber=variableNumber;
  ((DocumentEx)myDocument).setStripTrailingSpacesEnabled(variableNumber < 0);
  if (variableNumber < 0) {
    myCurrentSegmentNumber=-1;
    releaseAll();
  }
 else {
    myCurrentSegmentNumber=getCurrentSegmentNumber();
    if (myCurrentSegmentNumber >= 0) {
      mySegments.setCurrentSegment(myCurrentSegmentNumber);
    }
  }
}
