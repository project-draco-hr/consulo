{
  Project project=e.getRequiredData(CommonDataKeys.PROJECT);
  VcsRepositoryManager manager=ServiceManager.getService(project,VcsRepositoryManager.class);
  Collection<Repository> repositories=e.getData(CommonDataKeys.EDITOR) != null ? ContainerUtil.<Repository>emptyList() : collectRepositories(manager,e.getData(CommonDataKeys.VIRTUAL_FILE_ARRAY));
  VirtualFile selectedFile=DvcsUtil.getSelectedFile(project);
  new VcsPushDialog(project,DvcsUtil.sortRepositories(repositories),selectedFile != null ? manager.getRepositoryForFile(selectedFile) : null).show();
}
