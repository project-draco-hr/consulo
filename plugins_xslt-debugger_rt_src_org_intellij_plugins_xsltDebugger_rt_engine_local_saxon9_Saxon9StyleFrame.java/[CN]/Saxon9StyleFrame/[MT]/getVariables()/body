{
  final ArrayList<Debugger.Variable> variables=new ArrayList<Debugger.Variable>();
  XPathContext context=myXPathContext;
  while (context != null) {
    final StackFrame frame=context.getStackFrame();
    final SlotManager map=frame.getStackFrameMap();
    final int numberOfVariables=map.getNumberOfVariables();
    System.out.println("numberOfVariables = " + numberOfVariables);
    for (int i=0; i < numberOfVariables; i++) {
      final ValueRepresentation valueRepresentation=context.evaluateLocalVariable(i);
      System.out.println("valueRepresentation = " + valueRepresentation);
    }
    final ValueRepresentation[] values=frame.getStackFrameValues();
    System.out.println("values = " + Arrays.toString(values));
    for (int i=0, valuesLength=values.length; i < valuesLength; i++) {
      final ValueRepresentation value=values[i];
      variables.add(new VariableImpl(map.getVariableMap().get(i).getDisplayName(),new Value(){
        public Object getValue(){
          try {
            return value.getStringValue();
          }
 catch (          XPathException e) {
            return " - error: " + e.getMessage() + " - ";
          }
        }
        public Type getType(){
          return XPathType.UNKNOWN;
        }
      }
,false,Debugger.Variable.Kind.VARIABLE,"",-1));
    }
    context=context.getCaller();
    System.out.println("context = " + context);
  }
  return variables;
}
