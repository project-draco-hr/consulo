{
  LOG.info("Initializing cache for " + cacheFile.getLocation());
  final CachingCommittedChangesProvider provider=cacheFile.getProvider();
  final RepositoryLocation location=cacheFile.getLocation();
  final ChangeBrowserSettings settings=provider.createDefaultSettings();
  int maxCount=0;
  if (isMaxCountSupportedForProject()) {
    maxCount=myState.getInitialCount();
  }
 else {
    settings.USE_DATE_AFTER_FILTER=true;
    Calendar calendar=Calendar.getInstance();
    calendar.add(Calendar.DAY_OF_YEAR,-myState.getInitialDays());
    settings.setDateAfter(calendar.getTime());
  }
  List<CommittedChangeList> changes=provider.getCommittedChanges(settings,location,maxCount);
  writeChangesInReadAction(cacheFile,changes);
  if (maxCount > 0 && changes.size() < myState.getInitialCount()) {
    cacheFile.setHaveCompleteHistory(true);
  }
  if (changes.size() > 0) {
    myBus.syncPublisher(COMMITTED_TOPIC).changesLoaded(location,changes);
  }
  return changes;
}
