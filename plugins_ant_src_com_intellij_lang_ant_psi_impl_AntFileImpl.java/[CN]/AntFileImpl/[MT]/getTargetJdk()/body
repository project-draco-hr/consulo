{
  final XmlFile xmlFile=getSourceElement();
  final AntBuildFileImpl buildFile=(AntBuildFileImpl)AntConfigurationBase.getInstance(xmlFile.getProject()).getAntBuildFile(xmlFile);
  if (buildFile == null) {
    return ProjectRootManager.getInstance(getProject()).getProjectSdk();
  }
  String jdkName=AntBuildFileImpl.CUSTOM_JDK_NAME.get(buildFile.getAllOptions());
  if (jdkName == null || jdkName.length() == 0) {
    jdkName=AntConfigurationImpl.DEFAULT_JDK_NAME.get(buildFile.getAllOptions());
  }
  if (jdkName != null && jdkName.length() > 0) {
    return ProjectJdkTable.getInstance().findJdk(jdkName);
  }
  return ProjectRootManager.getInstance(getProject()).getProjectSdk();
}
