{
synchronized (PsiLock.LOCK) {
    if (myNeedPropertiesRebuild) {
      buildPropertiesMap();
    }
    if (myProperties == null) {
      return AntProperty.EMPTY_ARRAY;
    }
    if (myPropertiesArray == null) {
      final List<AntProperty> props=new ArrayList<AntProperty>(myProperties.size());
      for (      List<AntProperty> list : myProperties.values()) {
        if (!list.isEmpty()) {
          props.add(list.get(0));
        }
      }
      myPropertiesArray=props.toArray(new AntProperty[props.size()]);
    }
    return myPropertiesArray;
  }
}
