{
synchronized (PsiLock.LOCK) {
    buildTypeDefinitions();
    addTypeDefinition(def);
    if (myTargetDefinition != null && myTargetDefinition != def) {
      if (canBeUsedInTarget(def)) {
        myTargetDefinition.registerNestedType(def.getTypeId(),def.getClassName());
      }
    }
  }
}
