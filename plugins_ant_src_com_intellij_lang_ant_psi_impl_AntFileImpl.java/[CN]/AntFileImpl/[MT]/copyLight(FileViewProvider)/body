{
synchronized (PsiLock.LOCK) {
    final AntFileImpl copy=new AntFileImpl(viewProvider);
    final HashMap<String,AntTypeDefinition> defs;
    if (myTypeDefinitions != null) {
      defs=new HashMap<String,AntTypeDefinition>();
      for (      Map.Entry<String,AntTypeDefinition> entry : myTypeDefinitions.entrySet()) {
        final AntTypeDefinitionImpl original=(AntTypeDefinitionImpl)entry.getValue();
        if (original != null) {
          defs.put(entry.getKey(),new AntTypeDefinitionImpl(original));
        }
      }
    }
 else {
      defs=null;
    }
    copy.myTypeDefinitions=defs;
    copy.myProjectElements=myProjectElements == null ? null : new HashMap<AntTypeId,String>(myProjectElements);
    copy.myClassLoader=myClassLoader;
    copy.myExternalProperties=myExternalProperties != null ? new HashMap<String,String>(myExternalProperties) : null;
    if (myProperties != null) {
      final HashMap<String,List<AntProperty>> map=new HashMap<String,List<AntProperty>>();
      for (      Map.Entry<String,List<AntProperty>> entry : myProperties.entrySet()) {
        map.put(entry.getKey(),new ArrayList<AntProperty>(entry.getValue()));
      }
      copy.myProperties=map;
    }
 else {
      copy.myProperties=null;
    }
    return copy;
  }
}
