{
  if (bases.size() != 0)   bases.peek();
  Element result=new Element(original.getName(),original.getNamespace());
  Iterator attributes=original.getAttributes().iterator();
  while (attributes.hasNext()) {
    Attribute a=(Attribute)attributes.next();
    result.setAttribute((Attribute)a.clone());
  }
  for (  Object o : original.getContent()) {
    if (o instanceof Element) {
      Element element=(Element)o;
      if (isIncludeElement(element)) {
        result.addContent(resolveXIncludeElement(element,bases));
      }
 else {
        result.addContent(resolveNonXIncludeElement(element,bases));
      }
    }
 else     if (o instanceof String) {
      result.addContent((String)o);
    }
 else     if (o instanceof Content) {
      result.addContent((Content)((Content)o).clone());
    }
 else {
      throw new XIncludeException("Unexpected Type " + o.getClass());
    }
  }
  return result;
}
