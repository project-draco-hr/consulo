{
  TextRange currentTextRange=getCurrentTextRange(range);
  if (range.getType() == Range.INSERTED) {
    myDocument.replaceString(currentTextRange.getStartOffset(),Math.min(currentTextRange.getEndOffset() + 1,myDocument.getTextLength()),"");
  }
 else   if (range.getType() == Range.DELETED) {
    String upToDateContent=getUpToDateContent(range);
    myDocument.insertString(currentTextRange.getStartOffset(),upToDateContent);
  }
 else {
    String upToDateContent=getUpToDateContent(range);
    myDocument.replaceString(currentTextRange.getStartOffset(),Math.min(currentTextRange.getEndOffset() + 1,myDocument.getTextLength()),upToDateContent);
  }
}
