{
  ApplicationManager.getApplication().invokeLater(new Runnable(){
    @Override public void run(){
      if (ApplicationManager.getApplication().isDisposed()) {
        return;
      }
      final Document[] unsavedDocuments=getUnsavedDocuments();
      for (      Document document : unsavedDocuments) {
        VirtualFile file=getFile(document);
        if (file == null)         continue;
        Project project=ProjectUtil.guessProjectForFile(file);
        if (project == null)         continue;
        if (PsiDocumentManager.getInstance(project).isDocumentBlockedByPsi(document))         continue;
        saveDocument(document);
      }
    }
  }
);
}
