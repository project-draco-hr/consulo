{
  final VirtualFile file=getInstance().getFile(document);
  if (project != null && file != null && file.isValid()) {
    return !file.getFileType().isBinary() && ReadonlyStatusHandler.ensureFilesWritable(project,file);
  }
  if (document.isWritable()) {
    return true;
  }
  document.fireReadOnlyModificationAttempt();
  return false;
}
