{
  EditorSettingsExternalizable editorSettings=EditorSettingsExternalizable.getInstance();
  String trailer=editorSettings.getStripTrailingSpaces();
  boolean ensureEOLonEOF=editorSettings.isEnsureNewLineAtEOF();
  editorSettings.setStripTrailingSpaces(EditorSettingsExternalizable.STRIP_TRAILING_SPACES_NONE);
  editorSettings.setEnsureNewLineAtEOF(false);
  try {
    saveDocument(document);
  }
  finally {
    editorSettings.setStripTrailingSpaces(trailer);
    editorSettings.setEnsureNewLineAtEOF(ensureEOLonEOF);
  }
}
