{
  String path=file.getPath();
  String[] options={"Restore","Save under a different name","Discard changes"};
  String message="File has been deleted on disk: " + FileUtil.toSystemDependentName(path);
  int result=Messages.showDialog(message,"File Deleted",options,0,Messages.getQuestionIcon());
  File newFile;
  if (result == 0) {
    newFile=new File(path);
  }
 else   if (result == 1) {
    VirtualFile validParent=file;
    while (validParent != null && !validParent.isValid()) {
      validParent=validParent.getParent();
    }
    final VirtualFileWrapper wrapper=FileChooserFactory.getInstance().createSaveFileDialog(new FileSaverDescriptor("Save File As...","Save file under a different name"),(Project)null).save(validParent,file.getName());
    if (wrapper == null) {
      return null;
    }
    newFile=wrapper.getFile();
  }
 else {
    return null;
  }
  if (!FileUtil.createIfDoesntExist(newFile)) {
    return null;
  }
  return LocalFileSystem.getInstance().refreshAndFindFileByIoFile(newFile);
}
