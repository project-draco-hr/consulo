{
  final ContentRevision beforeRevision=change.getBeforeRevision();
  final ContentRevision afterRevision=change.getAfterRevision();
  File beforeFile=beforeRevision == null ? null : beforeRevision.getFile().getIOFile();
  File afterFile=afterRevision == null ? null : afterRevision.getFile().getIOFile();
  String shelvedPath=null;
  if (afterFile != null) {
    String shelvedName=FileUtil.getNameWithoutExtension(afterFile.getName());
    String shelvedExt=FileUtilRt.getExtension(afterFile.getName());
    File shelvedFile=FileUtil.findSequentNonexistentFile(myFileProcessor.getBaseIODir(),shelvedName,shelvedExt);
    myFileProcessor.saveFile(afterRevision.getFile().getIOFile(),shelvedFile);
    shelvedPath=shelvedFile.getPath();
  }
  String beforePath=ChangesUtil.getProjectRelativePath(myProject,beforeFile);
  String afterPath=ChangesUtil.getProjectRelativePath(myProject,afterFile);
  return new ShelvedBinaryFile(beforePath,afterPath,shelvedPath);
}
