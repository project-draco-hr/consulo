{
  List content=e.getContent();
  for (int i=0; i < content.size(); i++) {
    Object o=content.get(i);
    if (o instanceof Element) {
      Element element=(Element)o;
      substitute(element,caseSensitive);
    }
 else     if (o instanceof Text) {
      Text t=(Text)o;
      t.setText(substitute(t.getText(),caseSensitive));
    }
 else     if (o instanceof Comment) {
      Comment c=(Comment)o;
      c.setText(substitute(c.getText(),caseSensitive));
    }
 else {
      LOG.error("Wrong content: " + o.getClass());
    }
  }
  List attributes=e.getAttributes();
  for (Iterator i=attributes.iterator(); i.hasNext(); ) {
    Attribute attribute=(Attribute)i.next();
    attribute.setValue(substitute(attribute.getValue(),caseSensitive));
  }
}
