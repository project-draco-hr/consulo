{
  if (mySpans != null) {
    return;
  }
  RadComponent container=getContainer();
  GridInfo gridInfo=((IGridProvider)container).getVirtualGridInfo();
  RadComponent[][] components=gridInfo.components;
  Point cellInfo=getCellInfo();
  int row=cellInfo.y;
  myContainerBounds=container.getBounds(myContext.getArea().getFeedbackLayer());
  IntArrayList spans=new IntArrayList();
  IntArrayList offsets=new IntArrayList();
  if (bottom) {
    int span=1;
    for (int i=row; i < row + mySpan; i++) {
      spans.add(span++);
      offsets.add(myContainerBounds.y + gridInfo.hLines[i + 1]);
    }
    for (int i=row + mySpan; i < components.length; i++) {
      if (components[i][cellInfo.x] == null) {
        spans.add(span++);
        offsets.add(myContainerBounds.y + gridInfo.hLines[i + 1]);
      }
 else {
        break;
      }
    }
  }
 else {
    IntArrayList columns=new IntArrayList();
    int span=mySpan;
    for (int i=row; i < row + mySpan; i++) {
      spans.add(span--);
      offsets.add(myContainerBounds.y + gridInfo.hLines[i]);
      columns.add(i);
    }
    span=mySpan;
    for (int i=row - 1; i >= 0; i--) {
      if (components[i][cellInfo.x] == null) {
        spans.add(0,++span);
        offsets.add(0,myContainerBounds.y + gridInfo.hLines[i]);
        columns.add(0,i);
      }
 else {
        break;
      }
    }
    myCells=columns.toArray();
  }
  mySpans=spans.toArray();
  myOffsets=offsets.toArray();
}
