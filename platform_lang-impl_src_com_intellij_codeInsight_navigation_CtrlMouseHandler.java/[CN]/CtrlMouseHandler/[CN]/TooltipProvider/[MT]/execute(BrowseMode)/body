{
  myBrowseMode=browseMode;
  Document document=myEditor.getDocument();
  final PsiFile file=PsiDocumentManager.getInstance(myProject).getPsiFile(document);
  if (file == null)   return;
  PsiDocumentManager.getInstance(myProject).commitAllDocuments();
  if (EditorUtil.inVirtualSpace(myEditor,myPosition)) {
    return;
  }
  final int offset=myEditor.logicalPositionToOffset(myPosition);
  int selStart=myEditor.getSelectionModel().getSelectionStart();
  int selEnd=myEditor.getSelectionModel().getSelectionEnd();
  if (offset >= selStart && offset < selEnd)   return;
  ApplicationManager.getApplication().executeOnPooledThread(new Runnable(){
    public void run(){
      ProgressIndicatorUtils.runWithWriteActionPriority(new Runnable(){
        public void run(){
          doExecute(file,offset);
        }
      }
);
    }
  }
);
}
