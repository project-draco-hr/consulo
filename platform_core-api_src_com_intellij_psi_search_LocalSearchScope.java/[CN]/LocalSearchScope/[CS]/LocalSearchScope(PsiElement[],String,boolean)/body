{
  myIgnoreInjectedPsi=ignoreInjectedPsi;
  myDisplayName=displayName;
  Set<PsiElement> localScope=new LinkedHashSet<PsiElement>(scope.length);
  for (  final PsiElement element : scope) {
    LOG.assertTrue(element != null,"null element");
    LOG.assertTrue(element.getContainingFile() != null,element.getClass().getName());
    if (element instanceof PsiFile) {
      List<PsiFile> files=((PsiFile)element).getViewProvider().getAllFiles();
      ContainerUtil.addAll(localScope,files);
    }
 else {
      localScope.add(element);
    }
  }
  myScope=PsiUtilCore.toPsiElementArray(localScope);
}
