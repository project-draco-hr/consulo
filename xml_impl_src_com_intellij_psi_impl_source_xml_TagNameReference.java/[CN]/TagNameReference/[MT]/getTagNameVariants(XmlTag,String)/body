{
  final List<String> namespaces;
  if (prefix.isEmpty()) {
    namespaces=new ArrayList<String>(Arrays.asList(tag.knownNamespaces()));
    namespaces.add(XmlUtil.EMPTY_URI);
  }
 else {
    namespaces=new ArrayList<String>(Collections.singletonList(tag.getNamespace()));
  }
  final String[] variants=getTagNameVariants(tag,namespaces,null);
  return ContainerUtil.map2Array(variants,LookupElement.class,new Function<String,LookupElement>(){
    public LookupElement fun(    String qname){
      if (!prefix.isEmpty() && qname.startsWith(prefix)) {
        qname=qname.substring(prefix.length() + 1);
      }
      final MutableLookupElement<String> lookupElement=LookupElementFactory.getInstance().createLookupElement(qname);
      final int separator=qname.indexOf(':');
      if (separator > 0) {
        lookupElement.addLookupStrings(qname.substring(separator + 1));
      }
      lookupElement.setInsertHandler(XmlTagInsertHandler.INSTANCE);
      return lookupElement;
    }
  }
);
}
