{
  ArtifactsTreeNode node=getSelectedNode();
  if (node == null) {
    return null;
  }
  final Object sourceObject=node.getElementPresentation().getSourceObject();
  final StructureConfigurableContext context=ProjectStructureConfigurable.getInstance(getContext().getProject()).getContext();
  if (sourceObject instanceof Module) {
    return new ModuleProjectStructureElement(context,(Module)sourceObject);
  }
 else   if (sourceObject instanceof Library) {
    return new LibraryProjectStructureElement(context,(Library)sourceObject);
  }
 else   if (sourceObject instanceof Artifact) {
    return myArtifactContext.getOrCreateArtifactElement((Artifact)sourceObject);
  }
  return null;
}
