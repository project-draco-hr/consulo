{
  if (isHeadlessMode()) {
    return;
  }
  if (myIndicator.isCanceled()) {
    return;
  }
  final CompilerMessage[] deferred;
synchronized (myMessageViewLock) {
    if (myErrorTreeView != null) {
      return;
    }
    myErrorTreeView=new CompilerErrorTreeView(myProject);
    myErrorTreeView.setProcessController(new NewErrorTreeViewPanel.ProcessController(){
      public void stopProcess(){
        cancel();
      }
      public boolean isProcessStopped(){
        return !myIndicator.isRunning();
      }
    }
);
  }
  final Window window=getWindow();
  final ModalityState modalityState=window != null ? ModalityState.stateForComponent(window) : ModalityState.NON_MODAL;
  ApplicationManager.getApplication().invokeLater(new Runnable(){
    public void run(){
      final MessageView messageView=myProject.getComponent(MessageView.class);
      final JComponent component;
synchronized (myMessageViewLock) {
        component=myErrorTreeView.getComponent();
      }
      final Content content=PeerFactory.getInstance().getContentFactory().createContent(component,myContentName,true);
      content.putUserData(CONTENT_ID_KEY,myContentId);
      messageView.getContentManager().addContent(content);
      new CloseListener(content,messageView.getContentManager());
      removeAllContents(myProject,content);
      messageView.getContentManager().setSelectedContent(content);
      updateProgressText();
    }
  }
,modalityState);
}
