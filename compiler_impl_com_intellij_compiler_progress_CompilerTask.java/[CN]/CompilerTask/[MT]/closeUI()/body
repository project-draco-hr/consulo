{
  if (isHeadlessMode()) {
    return;
  }
  Window window=getWindow();
  ModalityState modalityState=window != null ? ModalityState.stateForComponent(window) : ModalityState.NON_MODAL;
  final Application application=ApplicationManager.getApplication();
  application.invokeLater(new Runnable(){
    public void run(){
      closeProgressDialog();
      final boolean closeViewOnSuccess=CompilerWorkspaceConfiguration.getInstance(myProject).CLOSE_MESSAGE_VIEW_IF_SUCCESS;
synchronized (myMessageViewLock) {
        if (myErrorTreeView != null) {
          final boolean hasMessagesToRead=myErrorCount > 0 || (myWarningCount > 0 && !myErrorTreeView.isHideWarnings());
          final boolean shouldRetainView=hasMessagesToRead || !closeViewOnSuccess;
          if (shouldRetainView) {
            addMessage(null,new CompilerMessageImpl(myProject,CompilerMessageCategory.STATISTICS,CompilerBundle.message("statistics.error.count",myErrorCount),null,-1,-1,null));
            addMessage(null,new CompilerMessageImpl(myProject,CompilerMessageCategory.STATISTICS,CompilerBundle.message("statistics.warnings.count",myWarningCount),null,-1,-1,null));
            activateMessageView();
            myErrorTreeView.selectFirstMessage();
          }
 else {
            removeAllContents(myProject,null);
          }
        }
      }
    }
  }
,modalityState);
}
