{
  final int[] count=new int[]{0};
  fileBasedIndex.getData(TodoIndex.NAME,new TodoIndexEntry(indexPattern.getPatternString(),indexPattern.isCaseSensitive()),myProject,new FileBasedIndex.DataFilter<TodoIndexEntry,Integer>(){
    public List<Integer> process(    final TodoIndexEntry entry,    final ValueContainer<Integer> container){
      for (final Iterator<Integer> valueIterator=container.getValueIterator(); valueIterator.hasNext(); ) {
        final Integer value=valueIterator.next();
        if (container.isAssociated(value,fileId)) {
          count[0]=value.intValue();
          return Collections.emptyList();
        }
      }
      return Collections.emptyList();
    }
  }
);
  return count[0];
}
