{
  JPanel panel=new JPanel(new GridBagLayout());
  GridBagConstraints gbConstraints=new GridBagConstraints();
  panel.setBorder(IdeBorderFactory.createBorder());
  gbConstraints.insets=new Insets(4,8,4,8);
  gbConstraints.weighty=1;
  gbConstraints.weightx=1;
  gbConstraints.gridwidth=GridBagConstraints.REMAINDER;
  gbConstraints.fill=GridBagConstraints.BOTH;
  myNameLabel=new JLabel();
  panel.add(myNameLabel,gbConstraints);
  gbConstraints.insets=new Insets(4,8,4,"".equals(myNewNamePrefix.getText()) ? 0 : 1);
  gbConstraints.gridwidth=1;
  gbConstraints.fill=GridBagConstraints.NONE;
  gbConstraints.weightx=0;
  gbConstraints.gridx=0;
  gbConstraints.anchor=GridBagConstraints.WEST;
  panel.add(myNewNamePrefix,gbConstraints);
  gbConstraints.insets=new Insets(4,8,4,8);
  gbConstraints.gridwidth=2;
  gbConstraints.fill=GridBagConstraints.BOTH;
  gbConstraints.weightx=1;
  gbConstraints.gridx=0;
  panel.add(myNameSuggestionsField.getComponent(),gbConstraints);
  gbConstraints.insets=new Insets(4,8,4,8);
  gbConstraints.gridwidth=1;
  gbConstraints.gridx=0;
  gbConstraints.weightx=1;
  gbConstraints.fill=GridBagConstraints.BOTH;
  myCbSearchInComments=new NonFocusableCheckBox();
  myCbSearchInComments.setText(RefactoringBundle.getSearchInCommentsAndStringsText());
  myCbSearchInComments.setSelected(true);
  panel.add(myCbSearchInComments,gbConstraints);
  gbConstraints.insets=new Insets(4,4,4,8);
  gbConstraints.gridwidth=GridBagConstraints.REMAINDER;
  gbConstraints.gridx=1;
  gbConstraints.weightx=1;
  gbConstraints.fill=GridBagConstraints.BOTH;
  myCbSearchTextOccurences=new NonFocusableCheckBox();
  myCbSearchTextOccurences.setText(RefactoringBundle.getSearchForTextOccurrencesText());
  myCbSearchTextOccurences.setSelected(true);
  panel.add(myCbSearchTextOccurences,gbConstraints);
  if (!TextOccurrencesUtil.isSearchTextOccurencesEnabled(myPsiElement)) {
    myCbSearchTextOccurences.setEnabled(false);
    myCbSearchTextOccurences.setSelected(false);
    myCbSearchTextOccurences.setVisible(false);
  }
  for (  AutomaticRenamerFactory factory : Extensions.getExtensions(AutomaticRenamerFactory.EP_NAME)) {
    if (factory.isApplicable(myPsiElement) && factory.getOptionName() != null) {
      gbConstraints.insets=new Insets(4,8,4,8);
      gbConstraints.gridwidth=(myAutomaticRenamers.size() % 2 == 0) ? 1 : GridBagConstraints.REMAINDER;
      gbConstraints.gridx=myAutomaticRenamers.size() % 2;
      gbConstraints.weightx=1;
      gbConstraints.fill=GridBagConstraints.BOTH;
      JCheckBox checkBox=new NonFocusableCheckBox();
      checkBox.setText(factory.getOptionName());
      checkBox.setSelected(factory.isEnabled());
      panel.add(checkBox,gbConstraints);
      myAutomaticRenamers.put(factory,checkBox);
    }
  }
  return panel;
}
