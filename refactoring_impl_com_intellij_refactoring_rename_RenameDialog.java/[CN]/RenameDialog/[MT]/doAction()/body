{
  LOG.assertTrue(myPsiElement.isValid());
  final JavaRefactoringSettings settings=JavaRefactoringSettings.getInstance();
  settings.setToSearchInCommentsForRename(myPsiElement,isSearchInComments());
  if (myCbSearchTextOccurences.isEnabled()) {
    settings.setToSearchInNonJavaFilesForRename(myPsiElement,isSearchInNonJavaFiles());
  }
  if (mySuggestedNameInfo != null) {
    mySuggestedNameInfo.nameChoosen(getNewName());
  }
  if (myCbRenameInheritors != null) {
    settings.setRenameInheritors(myCbRenameInheritors.isSelected());
  }
  if (myCbRenameVariables != null) {
    settings.setRenameVariables(myCbRenameVariables.isSelected());
  }
  final RenameProcessor processor=new RenameProcessor(getProject(),myPsiElement,getNewName(),isSearchInComments(),isSearchInNonJavaFiles());
  processor.setShouldRenameInheritors(shouldRenameInheritors());
  processor.setShouldRenameVariables(shouldRenameVariables());
  for (  Map.Entry<AutomaticRenamerFactory,JCheckBox> e : myAutomaticRenamers.entrySet()) {
    if (e.getValue().isSelected()) {
      processor.addRenamerFactory(e.getKey());
    }
  }
  invokeRefactoring(processor);
}
