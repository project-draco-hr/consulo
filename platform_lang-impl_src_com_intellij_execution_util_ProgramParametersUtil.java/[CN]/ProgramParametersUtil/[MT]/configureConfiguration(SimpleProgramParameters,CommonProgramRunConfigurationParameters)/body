{
  Project project=configuration.getProject();
  Module module=getModule(configuration);
  parameters.getProgramParametersList().addParametersString(configuration.getProgramParameters());
  String workingDirectory=configuration.getWorkingDirectory();
  VirtualFile baseDir=project.getBaseDir();
  if (workingDirectory == null || workingDirectory.trim().length() == 0) {
    workingDirectory=PathUtil.getLocalPath(baseDir);
  }
  workingDirectory=expandPath(workingDirectory,module,project);
  if (!FileUtil.isAbsolute(workingDirectory) && baseDir != null) {
    workingDirectory=baseDir.getPath() + "/" + workingDirectory;
  }
  parameters.setWorkingDirectory(workingDirectory);
}
