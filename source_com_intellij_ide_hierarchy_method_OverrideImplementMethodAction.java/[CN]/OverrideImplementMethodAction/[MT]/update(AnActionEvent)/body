{
  final Presentation presentation=e.getPresentation();
  final DataContext dataContext=e.getDataContext();
  final MethodHierarchyBrowser methodHierarchyBrowser=(MethodHierarchyBrowser)dataContext.getData(MethodHierarchyBrowser.METHOD_HIERARCHY_BROWSER_DATA_CONSTANT);
  if (methodHierarchyBrowser == null) {
    presentation.setEnabled(false);
    presentation.setVisible(false);
    return;
  }
  final Project project=DataKeys.PROJECT.getData(dataContext);
  if (project == null) {
    presentation.setEnabled(false);
    presentation.setVisible(false);
    return;
  }
  final MethodHierarchyNodeDescriptor[] selectedDescriptors=methodHierarchyBrowser.getSelectedDescriptors();
  int toImplement=0;
  int toOverride=0;
  for (  final MethodHierarchyNodeDescriptor descriptor : selectedDescriptors) {
    if (canImplementOverride(descriptor,methodHierarchyBrowser,true)) {
      if (toOverride > 0) {
        presentation.setEnabled(false);
        presentation.setVisible(false);
        return;
      }
      toImplement++;
    }
 else     if (canImplementOverride(descriptor,methodHierarchyBrowser,false)) {
      if (toImplement > 0) {
        presentation.setEnabled(false);
        presentation.setVisible(false);
        return;
      }
      toOverride++;
    }
 else {
      presentation.setEnabled(false);
      presentation.setVisible(false);
      return;
    }
  }
  presentation.setVisible(true);
  update(presentation,toImplement,toOverride);
}
