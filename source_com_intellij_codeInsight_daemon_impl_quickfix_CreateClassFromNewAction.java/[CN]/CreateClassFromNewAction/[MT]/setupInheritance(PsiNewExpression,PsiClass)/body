{
  if ((element.getParent() instanceof PsiReferenceExpression))   return;
  ExpectedTypeInfo[] expectedTypes=ExpectedTypesProvider.getInstance(myNewExpression.getProject()).getExpectedTypes(element,false);
  for (  ExpectedTypeInfo expectedType : expectedTypes) {
    PsiType type=expectedType.getType();
    PsiClass aClass=PsiUtil.resolveClassInType(type);
    if (aClass == null)     continue;
    if (aClass.equals(targetClass) || aClass.hasModifierProperty(PsiModifier.FINAL))     continue;
    PsiElementFactory factory=aClass.getManager().getElementFactory();
    if (aClass.isInterface()) {
      PsiReferenceList implementsList=targetClass.getImplementsList();
      implementsList.add(factory.createClassReferenceElement(aClass));
    }
 else {
      PsiReferenceList extendsList=targetClass.getExtendsList();
      if (extendsList.getReferencedTypes().length > 0)       continue;
      extendsList.add(factory.createClassReferenceElement(aClass));
    }
  }
}
