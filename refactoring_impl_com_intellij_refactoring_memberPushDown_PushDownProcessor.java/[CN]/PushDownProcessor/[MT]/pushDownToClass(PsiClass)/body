{
  PsiElementFactory factory=JavaPsiFacade.getInstance(myClass.getProject()).getElementFactory();
  for (  MemberInfo memberInfo : myMemberInfos) {
    final PsiMember member=memberInfo.getMember();
    PsiMember newMember=null;
    if (member instanceof PsiField) {
      ((PsiField)member).normalizeDeclaration();
      newMember=(PsiMember)targetClass.add(member);
    }
 else     if (member instanceof PsiMethod) {
      PsiMethod method=(PsiMethod)member;
      if (targetClass.findMethodBySignature(method,false) == null) {
        final PsiSubstitutor substitutor=TypeConversionUtil.getSuperClassSubstitutor(myClass,targetClass,PsiSubstitutor.EMPTY);
        final ArrayList<ParameterInfo> newParameters=new ArrayList<ParameterInfo>();
        final PsiParameter[] oldParameters=method.getParameterList().getParameters();
        for (int i=0; i < oldParameters.length; i++) {
          final PsiParameter oldParameter=oldParameters[i];
          newParameters.add(new ParameterInfo(i,oldParameter.getName(),substitutor.substitute(oldParameter.getType())));
        }
        final ChangeSignatureProcessor csp=new ChangeSignatureProcessor(method.getProject(),method,false,null,method.getName(),substitutor.substitute(method.getReturnType()),newParameters.toArray(new ParameterInfo[newParameters.size()]));
        csp.run();
        newMember=(PsiMethod)targetClass.add(method);
        if (memberInfo.isToAbstract()) {
          if (newMember.hasModifierProperty(PsiModifier.PRIVATE)) {
            newMember.getModifierList().setModifierProperty(PsiModifier.PROTECTED,true);
          }
          myJavaDocPolicy.processNewJavaDoc(((PsiMethod)newMember).getDocComment());
        }
      }
    }
 else     if (member instanceof PsiClass) {
      if (Boolean.FALSE.equals(memberInfo.getOverrides())) {
        final PsiClass aClass=(PsiClass)member;
        if (!targetClass.isInheritor(aClass,false)) {
          PsiJavaCodeReferenceElement classRef=factory.createClassReferenceElement(aClass);
          targetClass.getImplementsList().add(classRef);
        }
      }
 else {
        newMember=(PsiMember)targetClass.add(member);
      }
    }
    if (newMember != null) {
      decodeRefs(newMember,targetClass);
      final JavaRefactoringListenerManager listenerManager=JavaRefactoringListenerManager.getInstance(newMember.getProject());
      ((JavaRefactoringListenerManagerImpl)listenerManager).fireMemberMoved(myClass,newMember);
    }
  }
}
