{
  final long contentLength=content.getLength();
  boolean counterUpdated=false;
  try {
synchronized (this) {
      while (myTotalSize > SIZE_THRESHOLD) {
        indicator.checkCanceled();
        wait(300L);
      }
      myTotalSize+=contentLength;
      counterUpdated=true;
    }
    content.getBytes();
    return true;
  }
 catch (  Throwable e) {
    if (counterUpdated) {
synchronized (this) {
        myTotalSize-=contentLength;
        notifyAll();
      }
    }
    if (e instanceof ProcessCanceledException) {
      throw (ProcessCanceledException)e;
    }
 else     if (e instanceof InterruptedException) {
      throw (InterruptedException)e;
    }
 else     if (e instanceof IOException || e instanceof InvalidVirtualFileAccessException) {
      LOG.info(e);
    }
 else     if (ApplicationManager.getApplication().isUnitTestMode()) {
      e.printStackTrace();
    }
 else {
      LOG.error(e);
    }
    return false;
  }
}
