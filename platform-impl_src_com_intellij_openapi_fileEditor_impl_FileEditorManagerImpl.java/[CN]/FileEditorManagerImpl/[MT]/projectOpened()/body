{
  getSplitters().startListeningFocus();
  myConnection=myProject.getMessageBus().connect();
  final FileStatusManager fileStatusManager=FileStatusManager.getInstance(myProject);
  if (fileStatusManager != null) {
    fileStatusManager.addFileStatusListener(myFileStatusListener);
  }
  myConnection.subscribe(AppTopics.FILE_TYPES,new MyFileTypeListener());
  VirtualFileManager.getInstance().addVirtualFileListener(myVirtualFileListener);
  UISettings.getInstance().addUISettingsListener(myUISettingsListener);
  StartupManager.getInstance(myProject).registerPostStartupActivity(new DumbAwareRunnable(){
    public void run(){
      ToolWindowManager.getInstance(myProject).invokeLater(new Runnable(){
        public void run(){
          CommandProcessor.getInstance().executeCommand(myProject,new Runnable(){
            public void run(){
              setTabsMode(UISettings.getInstance().EDITOR_TAB_PLACEMENT != UISettings.TABS_NONE);
              getSplitters().openFiles();
              LaterInvocator.invokeLater(new Runnable(){
                public void run(){
                  long currentTime=System.nanoTime();
                  Long startTime=myProject.getUserData(ProjectImpl.CREATION_TIME);
                  if (startTime != null) {
                    LOG.info("Project opening took " + (currentTime - startTime.longValue()) / 1000000 + " ms");
                    PluginManager.dumpPluginClassStatistics();
                  }
                }
              }
);
            }
          }
,"",null);
        }
      }
);
    }
  }
);
}
