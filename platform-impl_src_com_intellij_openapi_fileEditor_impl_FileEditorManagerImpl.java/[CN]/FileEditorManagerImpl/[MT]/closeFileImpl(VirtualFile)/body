{
  assertDispatchThread();
  getSplitters().runChange(new Runnable(){
    public void run(){
      final List<EditorWindow> windows=getSplitters().findWindows(file);
      if (!windows.isEmpty()) {
        final VirtualFile nextFile=findNextFile(file);
        for (        final EditorWindow window : windows) {
          LOG.assertTrue(window.getSelectedEditor() != null);
          window.closeFile(file,false);
          if (window.getTabCount() == 0 && nextFile != null) {
            EditorWithProviderComposite newComposite=newEditorComposite(nextFile);
            window.setEditor(newComposite,true);
          }
        }
        for (        final EditorWindow window : windows) {
          if (window.isDisposed()) {
            continue;
          }
          if (window.getTabCount() == 0) {
            window.unsplit();
          }
        }
      }
    }
  }
);
}
