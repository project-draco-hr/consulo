{
  Alphabet alphabet=new Alphabet();
  final Encoder encoder=new Encoder(alphabet);
  final Compressor compressor=new Compressor(2);
  final CompressedDictionary dictionary=new CompressedDictionary(alphabet,compressor,encoder,loader.getName());
  loader.load(new Consumer<String>(){
    public void consume(    String s){
      String transformed=transform.transform(s);
      if (transformed != null) {
        UnitBitSet bs=encoder.encode(transformed,true);
        byte[] compressed=compressor.compress(bs);
        dictionary.addToDictionary(compressed);
      }
    }
  }
);
  dictionary.pack();
  return dictionary;
}
