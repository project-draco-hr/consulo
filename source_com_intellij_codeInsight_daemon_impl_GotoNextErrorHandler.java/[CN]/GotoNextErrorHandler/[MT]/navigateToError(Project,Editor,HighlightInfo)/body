{
  if (IS_OPTIMIZE_IMPORTS && info.type == HighlightInfoType.UNUSED_IMPORT && editor.getDocument().isWritable()) {
    ApplicationManager.getApplication().runWriteAction(new Runnable(){
      public void run(){
        PsiFile file=PsiDocumentManager.getInstance(project).getPsiFile(editor.getDocument());
        PsiDocumentManager.getInstance(project).commitAllDocuments();
        try {
          CodeStyleManager.getInstance(project).optimizeImports(file);
        }
 catch (        IncorrectOperationException e) {
          LOG.error(e);
        }
      }
    }
);
    return false;
  }
  int oldOffset=editor.getCaretModel().getOffset();
  final int offset=getNavigationPositionFor(info);
  final int endOffset=info.highlighter.getEndOffset();
  final ScrollingModel scrollingModel=editor.getScrollingModel();
  if (offset != oldOffset) {
    ScrollType scrollType=offset > oldOffset ? ScrollType.CENTER_DOWN : ScrollType.CENTER_UP;
    editor.getSelectionModel().removeSelection();
    editor.getCaretModel().moveToOffset(offset);
    scrollingModel.scrollToCaret(scrollType);
  }
  scrollingModel.runActionOnScrollingFinished(new Runnable(){
    public void run(){
      scrollingModel.scrollTo(editor.offsetToLogicalPosition(endOffset),ScrollType.MAKE_VISIBLE);
      scrollingModel.scrollTo(editor.offsetToLogicalPosition(offset),ScrollType.MAKE_VISIBLE);
    }
  }
);
  IdeDocumentHistory.getInstance(project).includeCurrentCommandAsNavigation();
  return true;
}
