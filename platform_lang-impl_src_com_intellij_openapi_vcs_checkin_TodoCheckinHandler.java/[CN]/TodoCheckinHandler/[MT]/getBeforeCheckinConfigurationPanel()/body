{
  final JCheckBox checkBox=new JCheckBox(VcsBundle.message("before.checkin.new.todo.check",""));
  return new RefreshableOnComponent(){
    public JComponent getComponent(){
      JPanel panel=new JPanel();
      final BoxLayout boxLayout=new BoxLayout(panel,BoxLayout.X_AXIS);
      panel.setLayout(boxLayout);
      panel.add(checkBox);
      setFilterText(myConfiguration.myTodoPanelSettings.getTodoFilterName());
      if (myConfiguration.myTodoPanelSettings.getTodoFilterName() != null) {
        myTodoFilter=TodoConfiguration.getInstance().getTodoFilter(myConfiguration.myTodoPanelSettings.getTodoFilterName());
      }
      final DefaultActionGroup group=new DefaultActionGroup();
      group.add(new SetTodoFilterAction(myProject,myConfiguration.myTodoPanelSettings,new Consumer<TodoFilter>(){
        @Override public void consume(        TodoFilter todoFilter){
          myTodoFilter=todoFilter;
          final String name=todoFilter == null ? null : todoFilter.getName();
          myConfiguration.myTodoPanelSettings.setTodoFilterName(name);
          setFilterText(name);
        }
      }
));
      panel.add(ActionManager.getInstance().createActionToolbar("commit dialog todo handler",group,true).getComponent());
      refreshEnable(checkBox);
      return panel;
    }
    private void setFilterText(    final String filterName){
      if (filterName == null) {
        checkBox.setText(VcsBundle.message("before.checkin.new.todo.check",IdeBundle.message("action.todo.show.all")));
      }
 else {
        checkBox.setText(VcsBundle.message("before.checkin.new.todo.check","Filter: " + filterName));
      }
    }
    public void refresh(){
    }
    public void saveState(){
      myConfiguration.CHECK_NEW_TODO=checkBox.isSelected();
    }
    public void restoreState(){
      checkBox.setSelected(myConfiguration.CHECK_NEW_TODO);
    }
  }
;
}
