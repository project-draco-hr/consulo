{
  String commitButtonText=executor != null ? executor.getActionText() : myCheckinProjectPanel.getCommitActionName();
  if (commitButtonText.endsWith("...")) {
    commitButtonText=commitButtonText.substring(0,commitButtonText.length() - 3);
  }
  final String text=createMessage(worker);
  final String[] buttons;
  final boolean thereAreTodoFound=worker.getAddedOrEditedTodos().size() + worker.getInChangedTodos().size() > 0;
  if (thereAreTodoFound) {
    buttons=new String[]{VcsBundle.message("todo.in.new.review.button"),commitButtonText,CommonBundle.getCancelButtonText()};
  }
 else {
    buttons=new String[]{commitButtonText,CommonBundle.getCancelButtonText()};
  }
  final int answer=Messages.showOkCancelDialog(myCheckinProjectPanel.getComponent(),text,"TODO",buttons[0],buttons[1],UIUtil.getWarningIcon());
  if (thereAreTodoFound && answer == 0) {
    showTodo(worker);
    return ReturnResult.CLOSE_WINDOW;
  }
 else   if (thereAreTodoFound && ((answer == 2 || answer == -1)) || (!thereAreTodoFound) && answer == 1) {
    return ReturnResult.CANCEL;
  }
 else {
    return ReturnResult.COMMIT;
  }
}
