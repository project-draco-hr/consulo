{
  Object component=e.getData(PlatformDataKeys.CONTEXT_COMPONENT);
  if (!(component instanceof JComponent))   return false;
  Editor editor=e.getData(CommonDataKeys.EDITOR);
  if (editor != null)   return !editor.isViewer();
  Action pasteAction=((JComponent)component).getActionMap().get(DefaultEditorKit.pasteAction);
  return pasteAction != null;
}
