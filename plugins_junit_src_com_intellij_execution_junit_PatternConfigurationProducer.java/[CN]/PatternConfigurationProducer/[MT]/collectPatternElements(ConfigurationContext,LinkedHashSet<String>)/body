{
  final DataContext dataContext=context.getDataContext();
  PsiElement[] elements=LangDataKeys.PSI_ELEMENT_ARRAY.getData(dataContext);
  if (elements != null) {
    for (    PsiMember psiClass : collectTestMembers(elements)) {
      classes.add(getQName(psiClass));
    }
    return elements;
  }
 else {
    final VirtualFile[] files=PlatformDataKeys.VIRTUAL_FILE_ARRAY.getData(dataContext);
    if (files != null) {
      final List<PsiFile> psiFiles=new ArrayList<PsiFile>();
      final PsiManager psiManager=PsiManager.getInstance(context.getProject());
      for (      VirtualFile file : files) {
        final PsiFile psiFile=psiManager.findFile(file);
        if (psiFile instanceof PsiClassOwner) {
          for (          PsiMember psiMember : collectTestMembers(((PsiClassOwner)psiFile).getClasses())) {
            classes.add(((PsiClass)psiMember).getQualifiedName());
          }
          psiFiles.add(psiFile);
        }
      }
      return psiFiles.toArray(new PsiElement[psiFiles.size()]);
    }
  }
  return null;
}
