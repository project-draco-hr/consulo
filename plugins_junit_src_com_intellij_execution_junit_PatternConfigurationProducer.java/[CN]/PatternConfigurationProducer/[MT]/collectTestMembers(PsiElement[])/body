{
  final Set<PsiMember> foundMembers=new LinkedHashSet<PsiMember>();
  for (  PsiElement psiElement : psiElements) {
    if (psiElement instanceof PsiClassOwner) {
      final PsiClass[] classes=((PsiClassOwner)psiElement).getClasses();
      for (      PsiClass aClass : classes) {
        if (JUnitUtil.isTestClass(aClass)) {
          foundMembers.add(aClass);
        }
      }
    }
 else     if (psiElement instanceof PsiClass) {
      if (JUnitUtil.isTestClass((PsiClass)psiElement)) {
        foundMembers.add((PsiClass)psiElement);
      }
    }
 else     if (psiElement instanceof PsiMethod) {
      if (JUnitUtil.getTestMethod(psiElement) != null) {
        foundMembers.add((PsiMethod)psiElement);
      }
    }
  }
  return foundMembers;
}
