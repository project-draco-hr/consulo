{
  myMap.clear();
  myFileTree.clear();
  myDirtyFileSet.clear();
  myFile2Highlighter.clear();
  TodoTreeStructure treeStructure=getTodoTreeStructure();
  PsiFile[] psiFiles=myPsiTodoSearchHelper.findFilesWithTodoItems();
  for (int i=0; i < psiFiles.length; i++) {
    PsiFile psiFile=psiFiles[i];
    if (myPsiTodoSearchHelper.getTodoItemsCount(psiFile) > 0 && treeStructure.accept(psiFile)) {
      myFileTree.add(psiFile.getVirtualFile());
    }
  }
  treeStructure.validateCache();
}
