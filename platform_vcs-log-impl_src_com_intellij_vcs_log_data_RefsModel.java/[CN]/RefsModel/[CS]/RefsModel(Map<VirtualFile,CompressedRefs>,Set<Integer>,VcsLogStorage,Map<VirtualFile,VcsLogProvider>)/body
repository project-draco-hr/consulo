{
  myRefs=refs;
  myHashMap=hashMap;
  myBestRefForHead=new TIntObjectHashMap<>();
  myRootForHead=new TIntObjectHashMap<>();
  for (  int head : heads) {
    CommitId commitId=myHashMap.getCommitId(head);
    if (commitId != null) {
      VirtualFile root=commitId.getRoot();
      myRootForHead.put(head,root);
      Optional<VcsRef> bestRef=myRefs.get(root).refsToCommit(head).stream().min(providers.get(root).getReferenceManager().getBranchLayoutComparator());
      if (bestRef.isPresent()) {
        myBestRefForHead.put(head,bestRef.get());
      }
 else {
        LOG.warn("No references at head " + commitId);
      }
    }
  }
}
