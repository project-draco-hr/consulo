{
synchronized (treeLock) {
    checkValid(child);
    final ObjectNode<T> parentNode=getOrCreateNodeFor(parent);
    final ObjectNode<T> childNode=getOrCreateNodeFor(child);
    ObjectNode<T> childParent=childNode.getParent();
    if (childParent != parentNode && childParent != null) {
      childParent.removeChild(childNode);
      parentNode.addChild(childNode);
    }
 else     if (myRootObjects.contains(child)) {
      parentNode.addChild(childNode);
      myRootObjects.remove(child);
    }
 else {
      parentNode.addChild(child);
    }
  }
}
