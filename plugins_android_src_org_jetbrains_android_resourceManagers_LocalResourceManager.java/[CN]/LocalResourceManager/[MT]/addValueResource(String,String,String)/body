{
  String resourceFileName=AndroidResourceUtil.getDefaultResourceFileName(type);
  if (resourceFileName == null) {
    throw new IllegalArgumentException("Incorrect resource type");
  }
  VirtualFile resFile=findOrCreateResourceFile(resourceFileName);
  if (resFile == null || !ReadonlyStatusHandler.ensureFilesWritable(myModule.getProject(),resFile)) {
    return null;
  }
  final Resources resources=loadDomElement(myModule,resFile,Resources.class);
  if (resources == null) {
    if (ApplicationManager.getApplication().isUnitTestMode()) {
      throw new IncorrectOperationException("invalid strings.xml");
    }
    Messages.showErrorDialog(myModule.getProject(),AndroidBundle.message("not.resource.file.error",resourceFileName),CommonBundle.getErrorTitle());
    return null;
  }
  ResourceElement element=AndroidResourceUtil.addValueResource(type,resources);
  element.getName().setValue(name);
  if (value != null) {
    element.setStringValue(value);
  }
  return element;
}
