{
  final StringBuilder buffer=new StringBuilder();
  ((TreeElement)ref.getNode()).acceptTree(new RecursiveTreeElementWalkingVisitor(){
    @Override public void visitLeaf(    LeafElement leaf){
      if (!REF_FILTER.contains(leaf.getElementType())) {
        buffer.append(leaf.getText());
      }
    }
    @Override public void visitComposite(    CompositeElement composite){
      if (!REF_FILTER.contains(composite.getElementType())) {
        super.visitComposite(composite);
      }
    }
  }
);
  return buffer.toString();
}
