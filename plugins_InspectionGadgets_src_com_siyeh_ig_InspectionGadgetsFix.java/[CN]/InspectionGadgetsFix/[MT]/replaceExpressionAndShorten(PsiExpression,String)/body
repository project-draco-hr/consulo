{
  final PsiManager psiManager=expression.getManager();
  final PsiElementFactory factory=JavaPsiFacade.getInstance(psiManager.getProject()).getElementFactory();
  final PsiExpression newExpression=factory.createExpressionFromText(newExpressionText,expression);
  final PsiElement replacementExp=expression.replace(newExpression);
  JavaCodeStyleManager.getInstance(psiManager.getProject()).shortenClassReferences(replacementExp);
  final CodeStyleManager styleManager=psiManager.getCodeStyleManager();
  styleManager.reformat(replacementExp);
}
