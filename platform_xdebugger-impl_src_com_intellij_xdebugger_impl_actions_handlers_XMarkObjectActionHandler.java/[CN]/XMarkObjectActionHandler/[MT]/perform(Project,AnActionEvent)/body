{
  XDebugSession session=XDebuggerManager.getInstance(project).getCurrentSession();
  if (session == null)   return;
  XValueMarkers<?,?> markers=((XDebugSessionImpl)session).getValueMarkers();
  XValueNodeImpl node=XDebuggerTreeActionBase.getSelectedNode(event.getDataContext());
  if (markers == null || node == null)   return;
  XValue value=node.getValueContainer();
  ValueMarkup existing=markers.getMarkup(value);
  if (existing != null) {
    markers.unmarkValue(value);
  }
 else {
    ValueMarkerPresentationDialog dialog=new ValueMarkerPresentationDialog(node.getName());
    dialog.show();
    ValueMarkup markup=dialog.getConfiguredMarkup();
    if (dialog.isOK() && markup != null) {
      markers.markValue(value,markup);
    }
  }
  session.rebuildViews();
}
