{
  Reference<SmartPsiElementPointer> data=element.getUserData(CACHED_SMART_POINTER_KEY);
  SmartPsiElementPointer cachedPointer=data == null ? null : data.get();
  if (cachedPointer instanceof SmartPointerEx) {
    PsiElement cachedElement=((SmartPointerEx)cachedPointer).getCachedElement();
    if (cachedElement != null && cachedElement != element) {
      return null;
    }
  }
  return cachedPointer;
}
