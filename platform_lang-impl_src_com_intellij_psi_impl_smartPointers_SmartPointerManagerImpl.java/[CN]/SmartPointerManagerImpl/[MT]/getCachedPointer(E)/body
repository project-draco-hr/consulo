{
  Reference<SmartPsiElementPointer> data=element.getUserData(CACHED_SMART_POINTER_KEY);
  SmartPsiElementPointer cachedPointer=data == null ? null : data.get();
  if (cachedPointer instanceof SmartPointerEx && ((SmartPointerEx)cachedPointer).getElementInfo().restoreElement() != element) {
    return null;
  }
  return cachedPointer;
}
