{
  final FileChooserDescriptor chooserDescriptor=myDescriptor.createAttachFilesChooserDescriptor();
  final String name=getLibraryEditor().getName();
  chooserDescriptor.setTitle(StringUtil.isEmpty(name) ? ProjectBundle.message("library.attach.files.action") : ProjectBundle.message("library.attach.files.to.library.action",name));
  chooserDescriptor.setDescription(ProjectBundle.message("library.attach.files.description"));
  if (myContextModule != null) {
    chooserDescriptor.putUserData(LangDataKeys.MODULE_CONTEXT,myContextModule);
  }
  final VirtualFile[] files=FileChooser.chooseFiles(chooserDescriptor,myPanel,myProject,initialSelection);
  if (files.length == 0)   return Collections.emptyList();
  return RootDetectionUtil.detectRoots(Arrays.asList(files),myPanel,myProject,myDescriptor);
}
