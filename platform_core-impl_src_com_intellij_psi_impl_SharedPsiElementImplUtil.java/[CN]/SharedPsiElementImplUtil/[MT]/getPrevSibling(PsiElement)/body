{
  if (element instanceof PsiFile) {
    final FileViewProvider viewProvider=((PsiFile)element).getViewProvider();
    element=viewProvider.getPsi(viewProvider.getBaseLanguage());
  }
  if (element == null)   return null;
  final PsiElement parent=element.getParent();
  if (parent == null)   return null;
  final PsiElement[] children=parent.getChildren();
  final int index=getChildIndex(children,element);
  return index > 0 ? children[index - 1] : null;
}
