{
  final int startOffset=parameters.getOffset();
  final PsiReference ref=parameters.getPosition().getContainingFile().findReferenceAt(startOffset);
  if (ref instanceof PsiMultiReference) {
    for (    final PsiReference reference : CompletionData.getReferences((PsiMultiReference)ref)) {
      processReference(result,startOffset,consumer,reference);
    }
  }
 else   if (ref instanceof PsiDynaReference) {
    for (    final PsiReference reference : ((PsiDynaReference<?>)ref).getReferences()) {
      processReference(result,startOffset,consumer,reference);
    }
  }
 else   if (ref != null) {
    processReference(result,startOffset,consumer,ref);
  }
}
