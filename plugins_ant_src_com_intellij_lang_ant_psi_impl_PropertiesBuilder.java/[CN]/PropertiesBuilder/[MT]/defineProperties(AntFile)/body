{
  final AntProject project=file.getAntProject();
  LOG.assertTrue(project != null);
  final PropertiesBuilder builder=new PropertiesBuilder(file);
  file.acceptAntElementVisitor(builder);
  final AntTarget entryTarget=project.getDefaultTarget();
  if (entryTarget != null) {
    entryTarget.acceptAntElementVisitor(builder);
  }
  for (  AntTarget antTarget : builder.getUnvisitedTargets()) {
    antTarget.acceptAntElementVisitor(builder);
  }
  for (  AntTarget target : builder.myVisitedTargets) {
    if (target instanceof AntTargetImpl) {
      definePseudoProperties((AntTargetImpl)target,file);
    }
  }
}
