{
  final Project project=event.getData(PlatformDataKeys.PROJECT);
  if (project == null)   return;
  FileDocumentManager.getInstance().saveAllDocuments();
  final List<VirtualFile> files=getFilesToPackage(event,project);
  try {
    for (    VirtualFile file : files) {
      PackageFileWorker.packageFile(file,project);
    }
    setStatusText(project,files.toArray(new VirtualFile[files.size()]));
  }
 catch (  IOException e) {
    Messages.showErrorDialog(CompilerBundle.message("message.tect.package.file.io.error",e),CommonBundle.getErrorTitle());
  }
}
