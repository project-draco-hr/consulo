{
  final FileTypeChooser chooser=new FileTypeChooser(suggestPatternText(fileName),fileName);
  chooser.show();
  if (!chooser.isOK())   return null;
  final FileType type=chooser.getSelectedType();
  if (type == FileTypes.UNKNOWN)   return null;
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    public void run(){
      FileTypeManagerEx.getInstanceEx().associatePattern(type,chooser.myPattern.getText());
    }
  }
);
  return type;
}
