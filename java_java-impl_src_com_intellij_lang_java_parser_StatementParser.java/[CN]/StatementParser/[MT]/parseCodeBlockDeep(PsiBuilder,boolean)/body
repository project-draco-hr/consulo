{
  if (builder.getTokenType() != JavaTokenType.LBRACE)   return null;
  final PsiBuilder.Marker codeBlock=builder.mark();
  builder.advanceLexer();
  parseStatements(builder,(parseUntilEof ? BraceMode.TILL_LAST : BraceMode.TILL_FIRST));
  final boolean greedyBlock=!expectOrError(builder,JavaTokenType.RBRACE,JavaErrorMessages.message("expected.rbrace"));
  done(codeBlock,JavaElementType.CODE_BLOCK);
  if (greedyBlock) {
    codeBlock.setCustomEdgeProcessors(null,GREEDY_RIGHT_EDGE_PROCESSOR);
  }
  return codeBlock;
}
