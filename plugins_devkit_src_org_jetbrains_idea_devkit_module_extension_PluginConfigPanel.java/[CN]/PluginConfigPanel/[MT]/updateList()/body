{
  ApplicationManager.getApplication().executeOnPooledThread(new Runnable(){
    @Override public void run(){
      updateBusy(true,Collections.<IdeaPluginDescriptorImpl>emptyList());
      List<IdeaPluginDescriptorImpl> items=null;
      final Sdk sdk=myMutableModuleExtension.getSdk();
      if (sdk == null) {
        items=Collections.emptyList();
      }
 else {
        final String pluginPath=sdk.getHomePath() + "/plugins";
        final int pluginCount=PluginManager.countPlugins(pluginPath);
        items=new ArrayList<IdeaPluginDescriptorImpl>(pluginCount);
        PluginManager.loadDescriptors(pluginPath,items,null,pluginCount);
        final Iterator<IdeaPluginDescriptorImpl> iterator=items.iterator();
        while (iterator.hasNext()) {
          final IdeaPluginDescriptorImpl next=iterator.next();
          if (next.getPluginId().getIdString().equals(PluginManager.CORE_PLUGIN_ID)) {
            iterator.remove();
            break;
          }
        }
      }
      updateBusy(false,items);
    }
  }
);
}
