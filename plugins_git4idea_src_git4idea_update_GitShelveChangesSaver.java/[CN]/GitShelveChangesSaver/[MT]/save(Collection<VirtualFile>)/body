{
  ArrayList<Change> changes=new ArrayList<Change>();
  for (  LocalChangeList l : myChangeLists) {
    changes.addAll(filterChangesByRoots(l.getChanges(),rootsToSave));
  }
  if (!changes.isEmpty()) {
    myProgressIndicator.setText(GitBundle.getString("update.shelving.changes"));
    List<VcsException> exceptions=new ArrayList<VcsException>(1);
    myShelvedChangeList=GitStashUtils.shelveChanges(myProject,myShelveManager,changes,myStashMessage,exceptions);
    if (!exceptions.isEmpty()) {
      throw exceptions.get(0);
    }
  }
}
