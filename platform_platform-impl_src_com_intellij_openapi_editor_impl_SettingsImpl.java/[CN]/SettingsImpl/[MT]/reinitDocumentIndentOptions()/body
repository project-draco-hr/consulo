{
  if (myEditor == null)   return;
  final Project project=myEditor.getProject();
  final DocumentEx document=myEditor.getDocument();
  if (project == null || project.isDisposed())   return;
  final PsiDocumentManager psiManager=PsiDocumentManager.getInstance(project);
  final PsiFile file=psiManager.getPsiFile(document);
  if (file == null)   return;
  CodeStyleSettings settings=CodeStyleSettingsManager.getInstance(project).getCurrentSettings();
  CommonCodeStyleSettings.IndentOptions options=settings.getIndentOptionsByFile(file);
  if (CodeStyleSettings.isRecalculateForCommittedDocument(options)) {
    PsiDocumentManager.getInstance(project).performForCommittedDocument(document,new Runnable(){
      @Override public void run(){
        CodeStyleSettingsManager.updateDocumentIndentOptions(project,document);
      }
    }
);
  }
 else {
    CodeStyleSettingsManager.updateDocumentIndentOptions(project,document);
  }
}
