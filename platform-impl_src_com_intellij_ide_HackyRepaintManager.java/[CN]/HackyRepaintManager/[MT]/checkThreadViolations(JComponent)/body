{
  if (!SwingUtilities.isEventDispatchThread() && c.isShowing()) {
    boolean repaint=false;
    boolean fromSwing=false;
    boolean imageUpdate=false;
    final Exception exception=new Exception();
    StackTraceElement[] stackTrace=exception.getStackTrace();
    for (    StackTraceElement st : stackTrace) {
      if (repaint && st.getClassName().startsWith("javax.swing.")) {
        fromSwing=true;
      }
      if (repaint && "imageUpdate".equals(st.getMethodName())) {
        imageUpdate=true;
      }
      if ("repaint".equals(st.getMethodName())) {
        repaint=true;
        fromSwing=false;
      }
    }
    if (imageUpdate) {
      return;
    }
    if (repaint && !fromSwing) {
      return;
    }
    if (myLastComponent != null && c == myLastComponent.get()) {
      return;
    }
    myLastComponent=new WeakReference<JComponent>(c);
    LOG.warn("Access to realized UI components should be done only from AWT event dispatch thread," + " revalidate() and repaint() is ok from any thread",exception);
  }
}
