{
  final PsiClass psiClass=psiElement instanceof PsiMethod ? ((PsiMethod)psiElement).getContainingClass() : (PsiClass)psiElement;
  PsiCall callToInline=findCallToInline(editor);
  String errorMessage=getCannotInlineMessage(psiClass);
  if (errorMessage != null) {
    CommonRefactoringUtil.showErrorHint(project,editor,errorMessage,RefactoringBundle.message("inline.to.anonymous.refactoring"),null);
    return;
  }
  InlineToAnonymousClassDialog dlg=new InlineToAnonymousClassDialog(project,psiClass,callToInline);
  dlg.show();
}
