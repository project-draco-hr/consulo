{
  if (content instanceof FileContent) {
    VirtualFile file=((FileContent)content).getFile();
    Document document=FileDocumentManager.getInstance().getCachedDocument(file);
    if (document != null) {
      FileDocumentManager.getInstance().saveDocument(document);
    }
    if (file.isInLocalFileSystem()) {
      return new LocalOutputFile(file);
    }
    String tempFileName=getFileName(null,windowTitle,content.getContentType());
    File tempFile=createTempFile(file,tempFileName);
    return new NonLocalOutputFile(file,tempFile);
  }
 else   if (content instanceof DocumentContent) {
    String tempFileName=getFileName(null,windowTitle,content.getContentType());
    File tempFile=createTempFile(((DocumentContent)content),tempFileName);
    return new DocumentOutputFile(((DocumentContent)content).getDocument(),((DocumentContent)content).getCharset(),tempFile);
  }
  throw new IllegalArgumentException(content.toString());
}
