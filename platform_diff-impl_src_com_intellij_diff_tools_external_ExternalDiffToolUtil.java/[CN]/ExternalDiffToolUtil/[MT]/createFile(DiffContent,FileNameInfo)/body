{
  if (content instanceof EmptyContent) {
    return new TempInputFile(createFile(new byte[0],fileName));
  }
 else   if (content instanceof FileContent) {
    VirtualFile file=((FileContent)content).getFile();
    Document document=FileDocumentManager.getInstance().getCachedDocument(file);
    if (document != null) {
      FileDocumentManager.getInstance().saveDocument(document);
    }
    if (file.isInLocalFileSystem()) {
      return new LocalInputFile(file);
    }
    return new TempInputFile(createTempFile(file,fileName));
  }
 else   if (content instanceof DocumentContent) {
    return new TempInputFile(createTempFile((DocumentContent)content,fileName));
  }
 else   if (content instanceof DirectoryContent) {
    VirtualFile file=((DirectoryContent)content).getFile();
    if (file.isInLocalFileSystem()) {
      return new LocalInputFile(file);
    }
    throw new IllegalArgumentException(content.toString());
  }
  throw new IllegalArgumentException(content.toString());
}
