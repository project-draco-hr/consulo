{
  PsiElement selectedElement=getSelectedElement(editor,file);
  PsiElement sourceElement=TestFinderHelper.findSourceElement(selectedElement);
  if (sourceElement == null)   return null;
  List<AdditionalAction> actions=new SmartList<AdditionalAction>();
  Collection<PsiElement> candidates;
  if (TestFinderHelper.isTest(selectedElement)) {
    candidates=TestFinderHelper.findClassesForTest(selectedElement);
  }
 else {
    candidates=TestFinderHelper.findTestsForClass(selectedElement);
    final TestCreator creator=LanguageTestCreators.INSTANCE.forLanguage(file.getLanguage());
    if (creator != null && creator.isAvailable(file.getProject(),editor,file)) {
      actions.add(new AdditionalAction(){
        @Override public String getText(){
          return "Create New Test...";
        }
        @Override public Icon getIcon(){
          return AllIcons.Actions.IntentionBulb;
        }
        @Override public void execute(){
          creator.createTest(file.getProject(),editor,file);
        }
      }
);
    }
  }
  return new GotoData(sourceElement,PsiUtilBase.toPsiElementArray(candidates),actions);
}
