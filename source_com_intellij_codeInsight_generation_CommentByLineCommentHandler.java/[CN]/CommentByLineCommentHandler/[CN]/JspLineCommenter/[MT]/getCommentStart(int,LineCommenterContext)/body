{
  final Document myDocument=context.getDocument();
  if (offset > myDocument.getTextLength() - "//".length())   return -1;
  if (CharArrayUtil.regionMatches(myDocument.getCharsSequence(),offset,"//")) {
    PsiDocumentManager.getInstance(context.getProject()).commitDocument(myDocument);
    PsiElement element=context.getFile().findElementAt(offset);
    if (element instanceof PsiComment && element.getTextRange().getStartOffset() == offset) {
      return offset;
    }
  }
 else {
    if (offset > myDocument.getTextLength() - "<%--".length())     return -1;
    if (CharArrayUtil.regionMatches(myDocument.getCharsSequence(),offset,"<%--"))     return offset;
  }
  return -1;
}
