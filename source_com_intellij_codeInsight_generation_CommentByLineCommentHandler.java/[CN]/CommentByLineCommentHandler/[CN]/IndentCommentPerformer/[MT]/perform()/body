{
  CharSequence chars=myDocument.getCharsSequence();
  final FileType fileType=myFile.getFileType();
  Indent minIndent=computeMinIndent(myLine1,myLine2,chars,myCodeStyleManager,fileType,myCommenter);
  for (int line=myLine2; line >= myLine1; line--) {
    int lineStart=myDocument.getLineStartOffset(line);
    int offset=lineStart;
    StringBuffer buffer=new StringBuffer();
    while (true) {
      String space=buffer.toString();
      Indent indent=myCodeStyleManager.getIndent(space,fileType);
      if (indent.isGreaterThan(minIndent) || indent.equals(minIndent))       break;
      char c=chars.charAt(offset);
      if (c != ' ' && c != '\t') {
        String newSpace=myCodeStyleManager.fillIndent(minIndent,fileType);
        myDocument.replaceString(lineStart,offset,newSpace);
        offset=lineStart + newSpace.length();
        break;
      }
      buffer.append(c);
      offset++;
    }
    myCommenter.doComment(offset,line,CommentByLineCommentHandler.this);
  }
}
