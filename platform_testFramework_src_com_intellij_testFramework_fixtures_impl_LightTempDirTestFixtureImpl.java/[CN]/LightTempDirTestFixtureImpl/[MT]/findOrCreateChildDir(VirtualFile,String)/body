{
  if (relativePath.length() == 0)   return root;
  String trimPath=StringUtil.trimStart(relativePath,"/");
  final List<String> dirs=StringUtil.split(trimPath,"/");
  for (  String dirName : dirs) {
    if (dirName.equals("."))     continue;
    if (dirName.equals("..")) {
      root=root.getParent();
      if (root == null)       throw new IllegalArgumentException("Invalid path: " + relativePath);
      continue;
    }
    VirtualFile dir=root.findChild(dirName);
    if (dir != null) {
      root=dir;
    }
 else {
      try {
        root=root.createChildDirectory(this,dirName);
      }
 catch (      IOException e) {
        throw new RuntimeException(e);
      }
    }
  }
  return root;
}
