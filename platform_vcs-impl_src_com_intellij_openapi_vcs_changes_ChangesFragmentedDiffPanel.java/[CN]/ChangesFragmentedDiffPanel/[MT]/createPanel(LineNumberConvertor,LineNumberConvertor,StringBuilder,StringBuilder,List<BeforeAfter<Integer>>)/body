{
  final DiffPanel diffPanel=myMyDiffPanelHolder.createAndCache();
  final FragmentedDiffPanelState diffPanelState=(FragmentedDiffPanelState)((DiffPanelImpl)diffPanel).getDiffPanelState();
  diffPanelState.setRanges(ranges);
  diffPanel.setContents(new SimpleContent(sbOld.toString()),new SimpleContent(sbNew.toString()));
  ((DiffPanelImpl)diffPanel).setLineNumberConvertors(oldConvertor,newConvertor);
  ((DiffPanelImpl)diffPanel).prefferedSizeByContents(-1);
  diffPanel.removeStatusBar();
  return diffPanel;
}
