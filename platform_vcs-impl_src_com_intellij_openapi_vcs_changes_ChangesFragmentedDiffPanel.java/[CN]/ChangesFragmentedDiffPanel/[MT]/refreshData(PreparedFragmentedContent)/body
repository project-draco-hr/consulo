{
  myPresentationState=new PresentationState();
  myFragmentedContent=fragmentedContent;
  boolean navigationEnabled=!myFragmentedContent.isOneSide();
  myNextDiff.setEnabled(navigationEnabled);
  myPreviousDiff.setEnabled(navigationEnabled);
  adjustPanelData((DiffPanelImpl)myHorizontal);
  adjustPanelData((DiffPanelImpl)myVertical);
  if (((DiffPanelImpl)myHorizontal).getEditor1() != null) {
    myNavigateAction.registerCustomShortcutSet(CommonShortcuts.getEditSource(),((DiffPanelImpl)myHorizontal).getEditor1().getComponent());
    myNavigateAction.registerCustomShortcutSet(CommonShortcuts.getEditSource(),((DiffPanelImpl)myVertical).getEditor1().getComponent());
  }
  if (((DiffPanelImpl)myHorizontal).getEditor2() != null) {
    myNavigateAction.registerCustomShortcutSet(CommonShortcuts.getEditSource(),((DiffPanelImpl)myHorizontal).getEditor2().getComponent());
    myNavigateAction.registerCustomShortcutSet(CommonShortcuts.getEditSource(),((DiffPanelImpl)myVertical).getEditor2().getComponent());
  }
  DiffPanel currentPanel=getCurrentPanel();
  FragmentedDiffPanelState state=(FragmentedDiffPanelState)((DiffPanelImpl)currentPanel).getDiffPanelState();
  myTitleLabel.setText(titleText((DiffPanelImpl)currentPanel));
  myLeftLines=state.getLeftLines();
  myRightLines=state.getRightLines();
  FragmentedEditorHighlighter bh=fragmentedContent.getBeforeHighlighter();
  if (bh != null) {
    ((EditorEx)((DiffPanelImpl)currentPanel).getEditor1()).setHighlighter(bh);
  }
  FragmentedEditorHighlighter ah=fragmentedContent.getAfterHighlighter();
  if (ah != null) {
    ((EditorEx)((DiffPanelImpl)currentPanel).getEditor2()).setHighlighter(ah);
  }
  if (((DiffPanelImpl)currentPanel).getEditor1() != null) {
    highlightTodo(true,fragmentedContent.getBeforeTodoRanges());
  }
  if (((DiffPanelImpl)currentPanel).getEditor2() != null) {
    highlightTodo(false,fragmentedContent.getAfterTodoRanges());
  }
  ensurePresentation();
  softWraps(myConfiguration.SOFT_WRAPS_IN_SHORT_DIFF);
}
