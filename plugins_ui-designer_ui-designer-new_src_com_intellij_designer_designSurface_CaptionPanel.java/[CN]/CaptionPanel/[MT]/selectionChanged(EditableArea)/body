{
  List<RadComponent> selection=area.getSelection();
  if (selection.size() != 1) {
    return;
  }
  List<RadComponent> children=myRootComponent.getChildren();
  boolean update=!children.isEmpty();
  children.clear();
  myRootComponent.setLayout(null);
  ICaption caption=null;
  RadComponent component=selection.get(0);
  RadComponent parent=component.getParent();
  if (parent != null && parent.getLayout() instanceof ICaption) {
    caption=(ICaption)parent.getLayout();
  }
  if (caption == null && component instanceof ICaption) {
    caption=(ICaption)component;
  }
  if (caption != null) {
    myRootComponent.setLayout(caption.getCaptionLayout(area,myHorizontal));
    caption.addCaptionChildren(area,myHorizontal,children);
    update=true;
  }
  if (update) {
    revalidate();
    repaint();
  }
}
