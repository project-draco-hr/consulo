{
  if (!"true".equals(System.getProperty("idea.no.jre.check"))) {
    try {
      Class.forName("com.sun.jdi.Field");
    }
 catch (    ClassNotFoundException e) {
      showError("Error","'tools.jar' is not in " + ApplicationNamesInfo.getInstance().getProductName() + " classpath.\n"+ "Please ensure JAVA_HOME points to JDK rather than JRE.");
      return false;
    }
  }
  if (!"true".equals(System.getProperty("idea.no.jdk.check"))) {
    final String version=System.getProperty("java.version");
    if (!SystemInfo.isJavaVersionAtLeast("1.6")) {
      showError("Java Version Mismatch","The JDK version is " + version + ".\n"+ ApplicationNamesInfo.getInstance().getProductName()+ " requires JDK 1.6 or higher.");
      return false;
    }
  }
  return true;
}
