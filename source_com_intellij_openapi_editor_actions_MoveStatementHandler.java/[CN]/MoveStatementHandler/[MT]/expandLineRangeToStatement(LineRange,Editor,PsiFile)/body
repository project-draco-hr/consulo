{
  final int startOffset=editor.logicalPositionToOffset(new LogicalPosition(range.startLine,0));
  PsiElement startingElement=firstNonWhiteElement(startOffset,file,true);
  if (startingElement == null)   return null;
  final int endOffset=editor.logicalPositionToOffset(new LogicalPosition(range.endLine + 1,0)) - 1;
  PsiElement endingElement=firstNonWhiteElement(endOffset,file,false);
  if (endingElement == null)   return null;
  final PsiElement element=PsiTreeUtil.findCommonParent(startingElement,endingElement);
  Pair<PsiElement,PsiElement> elementRange=getElementRange(element,startingElement,endingElement);
  return new LineRange(editor.offsetToLogicalPosition(elementRange.getFirst().getTextOffset()).line,editor.offsetToLogicalPosition(elementRange.getSecond().getTextRange().getEndOffset()).line);
}
