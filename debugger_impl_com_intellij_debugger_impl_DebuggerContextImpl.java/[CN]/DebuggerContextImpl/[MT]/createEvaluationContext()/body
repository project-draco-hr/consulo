{
  DebuggerManagerThreadImpl.assertIsManagerThread();
  StackFrameProxyImpl frameProxy=getFrameProxy();
  ObjectReference objectReference;
  try {
    objectReference=frameProxy != null ? frameProxy.thisObject() : null;
  }
 catch (  EvaluateException e) {
    DebuggerCommandImpl currentCommand=getDebugProcess().getManagerThread().getCurrentCommand();
    if (currentCommand instanceof SuspendContextCommandImpl) {
      final SuspendContextImpl currentCommandContext=((SuspendContextCommandImpl)currentCommand).getSuspendContext();
      final ThreadReferenceProxyImpl commandThread=currentCommandContext.getThread();
      if (commandThread != frameProxy.threadProxy()) {
        LOG.assertTrue(false,"Current Command: " + currentCommand.getClass().getName() + "\nCurrent Command Thread : "+ (commandThread != null ? commandThread.name() : "null")+ "\nThread : "+ frameProxy.threadProxy().name());
      }
    }
    objectReference=null;
  }
  return new EvaluationContextImpl(getSuspendContext(),frameProxy,objectReference);
}
