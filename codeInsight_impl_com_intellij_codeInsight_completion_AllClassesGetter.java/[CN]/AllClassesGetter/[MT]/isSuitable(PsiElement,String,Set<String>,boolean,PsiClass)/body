{
  return ApplicationManager.getApplication().runReadAction(new Computable<Boolean>(){
    public Boolean compute(){
      if (lookingForAnnotations && !psiClass.isAnnotationType())       return false;
      if (JavaCompletionUtil.isInExcludedPackage(psiClass))       return false;
      final String qualifiedName=psiClass.getQualifiedName();
      if (qualifiedName == null || !qualifiedName.startsWith(packagePrefix))       return false;
      if (!myFilter.isAcceptable(psiClass,context))       return false;
      if (!(psiClass instanceof PsiCompiledElement) && !JavaPsiFacade.getInstance(psiClass.getProject()).getResolveHelper().isAccessible(psiClass,context,null))       return false;
      return qnames.add(qualifiedName);
    }
  }
);
}
