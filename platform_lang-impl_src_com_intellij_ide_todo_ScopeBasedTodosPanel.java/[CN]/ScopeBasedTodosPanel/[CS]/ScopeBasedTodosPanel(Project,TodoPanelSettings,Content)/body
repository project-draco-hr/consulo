{
  super(project,settings,false,content);
  myAlarm=new Alarm(Alarm.ThreadToUse.POOLED_THREAD,project);
  final String scopeName=PropertiesComponent.getInstance(project).getValue(SELECTED_SCOPE);
  rebuildModel(project,scopeName);
  myScopeListener=new NamedScopesHolder.ScopeListener(){
    @Override public void scopesChanged(){
      final ScopeWrapper scope=(ScopeWrapper)myScopes.getSelectedItem();
      rebuildModel(project,scope != null ? scope.getName() : null);
    }
  }
;
  myNamedScopeManager=NamedScopeManager.getInstance(project);
  myNamedScopeManager.addScopeListener(myScopeListener);
  myValidationManager=DependencyValidationManager.getInstance(project);
  myValidationManager.addScopeListener(myScopeListener);
  myScopes.setRenderer(new ListCellRendererWrapper<ScopeWrapper>(){
    @Override public void customize(    JList list,    ScopeWrapper value,    int index,    boolean selected,    boolean hasFocus){
      setText(value.getName());
      if (value.isSeparator()) {
        setSeparator();
      }
    }
  }
);
  myScopes.addActionListener(new ActionListener(){
    @Override public void actionPerformed(    ActionEvent e){
      rebuildWithAlarm(ScopeBasedTodosPanel.this.myAlarm);
      final ScopeWrapper selectedItem=(ScopeWrapper)myScopes.getSelectedItem();
      if (selectedItem != null) {
        PropertiesComponent.getInstance(myProject).setValue(SELECTED_SCOPE,selectedItem.getName());
      }
    }
  }
);
  rebuildWithAlarm(myAlarm);
}
