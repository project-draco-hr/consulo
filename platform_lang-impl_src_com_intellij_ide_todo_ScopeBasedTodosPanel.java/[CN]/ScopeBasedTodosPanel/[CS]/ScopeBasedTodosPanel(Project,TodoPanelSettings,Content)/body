{
  super(project,settings,false,content);
  myAlarm=new Alarm(Alarm.ThreadToUse.SHARED_THREAD,project);
  NamedScope[] scopes=DependencyValidationManager.getInstance(project).getScopes();
  scopes=ArrayUtil.mergeArrays(scopes,NamedScopeManager.getInstance(project).getScopes());
  scopes=NonProjectFilesScope.removeFromList(scopes);
  myScopes.setModel(new DefaultComboBoxModel(scopes));
  final String scopeName=PropertiesComponent.getInstance(project).getValue(SELECTED_SCOPE);
  if (scopeName != null) {
    for (    NamedScope scope : scopes) {
      if (Comparing.strEqual(scopeName,scope.getName())) {
        myScopes.setSelectedItem(scope);
        break;
      }
    }
  }
  myScopes.setRenderer(new ListCellRendererWrapper<NamedScope>(myScopes){
    @Override public void customize(    JList list,    NamedScope value,    int index,    boolean selected,    boolean hasFocus){
      setText(value.getName());
    }
  }
);
  myScopes.addActionListener(new ActionListener(){
    @Override public void actionPerformed(    ActionEvent e){
      rebuildWithAlarm(ScopeBasedTodosPanel.this.myAlarm);
      final NamedScope selectedItem=(NamedScope)myScopes.getSelectedItem();
      if (selectedItem != null) {
        PropertiesComponent.getInstance(myProject).setValue(SELECTED_SCOPE,selectedItem.getName());
      }
    }
  }
);
  rebuildWithAlarm(myAlarm);
}
