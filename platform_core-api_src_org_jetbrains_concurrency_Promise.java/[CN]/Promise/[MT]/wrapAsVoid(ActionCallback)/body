{
  final AsyncPromise<Void> promise=new AsyncPromise<Void>();
  asyncResult.doWhenDone(new Runnable(){
    @Override public void run(){
      promise.setResult(null);
    }
  }
).doWhenRejected(new Consumer<String>(){
    @Override public void consume(    String error){
      promise.setError(createError(error == null ? "Internal error" : error));
    }
  }
);
  return promise;
}
