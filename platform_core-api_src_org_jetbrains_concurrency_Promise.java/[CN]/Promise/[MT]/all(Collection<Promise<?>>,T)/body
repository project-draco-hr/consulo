{
  if (promises.isEmpty()) {
    return (Promise<T>)DONE;
  }
  final AsyncPromise<T> totalPromise=new AsyncPromise<T>();
  Consumer done=new CountDownConsumer<T>(promises.size(),totalPromise,totalResult);
  Consumer<Throwable> rejected=new Consumer<Throwable>(){
    @Override public void consume(    Throwable error){
      if (totalPromise.state == AsyncPromise.State.PENDING) {
        totalPromise.setError(error);
      }
    }
  }
;
  for (  Promise<?> promise : promises) {
    promise.done(done);
    promise.rejected(rejected);
  }
  return totalPromise;
}
