{
  if (change == null)   return NoDiffRequest.INSTANCE;
  Pair<Change,DiffRequest> pair=myRequestCache.get(change);
  if (pair != null) {
    Change oldChange=pair.first;
    if (ChangeDiffRequestProducer.isEquals(oldChange,change)) {
      return pair.second;
    }
  }
  if (change.getBeforeRevision() instanceof FakeRevision || change.getAfterRevision() instanceof FakeRevision) {
    return new LoadingDiffRequest(ChangeDiffRequestProducer.getRequestTitle(change));
  }
  return null;
}
