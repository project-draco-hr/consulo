{
  final XmlTag tag=(XmlTag)descriptor.getPsiElement();
  if (tag == null)   return;
  final PsiFile psiFile=tag.getContainingFile();
  if (psiFile == null)   return;
  ReadonlyStatusHandler.getInstance(project).ensureFilesWritable(psiFile.getVirtualFile());
  final StringBuilder builder=new StringBuilder(tag.getText());
  builder.replace(builder.length() - 2,builder.length(),"></" + tag.getLocalName() + ">");
  try {
    final FileType fileType=psiFile.getFileType();
    PsiFile file=PsiFileFactory.getInstance(tag.getProject()).createFileFromText("dummy." + (fileType == StdFileTypes.JSP || tag.getContainingFile().getLanguage() == HTMLLanguage.INSTANCE ? "html" : "xml"),builder.toString());
    tag.replace(((XmlFile)file).getDocument().getRootTag());
  }
 catch (  IncorrectOperationException e) {
    LOG.error(e);
  }
}
