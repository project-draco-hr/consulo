{
  if (file instanceof VirtualFileWindow) {
    final VirtualFileWindow window=(VirtualFileWindow)file;
    file=window.getDelegate();
  }
  if (file != null) {
    final FilePropertyPusher<T> pusher=getFilePropertyPusher();
    final T pushedValue=pusher == null ? null : file.getUserData(pusher.getFileDataKey());
    if (pushedValue != null)     return pushedValue;
  }
synchronized (myMappings) {
    for (VirtualFile cur=file; ; cur=cur.getParent()) {
      final T dialect=myMappings.get(cur);
      if (dialect != null)       return dialect;
      if (cur == null)       break;
    }
  }
  return getDefaultMapping(file);
}
