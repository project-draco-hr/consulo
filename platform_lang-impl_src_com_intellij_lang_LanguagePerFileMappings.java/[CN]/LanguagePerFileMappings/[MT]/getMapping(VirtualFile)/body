{
synchronized (myMappings) {
    for (VirtualFile cur=file; ; cur=cur.getParent()) {
      final T dialect=myMappings.get(cur);
      if (dialect != null)       return dialect;
      if (cur == null)       break;
    }
    return null;
  }
}
