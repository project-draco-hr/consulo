{
  final VirtualFile vFile=LocalFileSystem.getInstance().findFileByIoFile(file);
  final VirtualFile genDir=LocalFileSystem.getInstance().findFileByPath(directoryPath);
  if (vFile == null || genDir == null) {
    return;
  }
  DumbService.getInstance(module.getProject()).waitForSmartMode();
  final Collection<VirtualFile> files=ApplicationManager.getApplication().runReadAction(new Computable<Collection<VirtualFile>>(){
    @Nullable @Override public Collection<VirtualFile> compute(){
      if (module.isDisposed() || module.getProject().isDisposed()) {
        return null;
      }
      return FilenameIndex.getVirtualFilesByName(module.getProject(),file.getName(),module.getModuleScope(false));
    }
  }
);
  if (files == null) {
    return;
  }
  final List<VirtualFile> filesToDelete=new ArrayList<VirtualFile>();
  for (  final VirtualFile f : files) {
    if (!Comparing.equal(f,vFile) && VfsUtilCore.isAncestor(genDir,f,true)) {
      filesToDelete.add(f);
    }
  }
  if (filesToDelete.size() == 0) {
    return;
  }
  ApplicationManager.getApplication().invokeLater(new Runnable(){
    @Override public void run(){
      ApplicationManager.getApplication().runWriteAction(new Runnable(){
        @Override public void run(){
          for (          VirtualFile f : filesToDelete) {
            if (f.isValid() && f.exists()) {
              try {
                f.delete(module.getProject());
              }
 catch (              IOException e) {
                LOG.error(e);
              }
            }
          }
        }
      }
);
    }
  }
);
}
