{
  int start=range.getStartOffset();
  int end=range.getEndOffset();
  Document document=myEditor.getDocument();
  CharSequence text=document.getCharsSequence();
  if (start == end) {
    if (end < document.getTextLength() - 1) {
      end++;
    }
 else     if (start > 0) {
      start--;
    }
  }
  if (end > 0 && end < document.getTextLength() - 1 && text.charAt(end - 1) == '\n') {
    end++;
  }
  return new TextRange(start,end);
}
