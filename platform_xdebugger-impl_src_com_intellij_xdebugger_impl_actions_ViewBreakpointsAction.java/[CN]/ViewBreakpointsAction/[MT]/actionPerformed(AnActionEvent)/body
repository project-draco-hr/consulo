{
  DataContext dataContext=e.getDataContext();
  Project project=PlatformDataKeys.PROJECT.getData(dataContext);
  if (project == null)   return;
  if (myInitialBreakpoint == null) {
    Editor editor=PlatformDataKeys.EDITOR.getData(dataContext);
    if (editor != null) {
      myInitialBreakpoint=XBreakpointUtil.findSelectedBreakpoint(project,editor).second;
    }
  }
  if (Registry.is("debugger.breakpoint.use.breakpoints.popup")) {
    BreakpointsMasterDetailPopupFactory.getInstance(project).createPopup(myInitialBreakpoint).showCenteredInCurrentWindow(project);
  }
 else {
    DialogWrapper dialog=BreakpointsConfigurationDialogFactory.getInstance(project).createDialog(myInitialBreakpoint);
    dialog.show();
  }
  myInitialBreakpoint=null;
}
