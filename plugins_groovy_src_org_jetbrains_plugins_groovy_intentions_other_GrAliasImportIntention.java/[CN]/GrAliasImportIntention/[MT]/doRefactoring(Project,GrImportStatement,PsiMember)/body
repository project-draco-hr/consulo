{
  if (member instanceof GrAccessorMethod && !importStatement.isOnDemand() && !importStatement.getImportedName().equals(member.getName())) {
    member=((GrAccessorMethod)member).getProperty();
  }
  final GroovyFileBase file=(GroovyFileBase)importStatement.getContainingFile();
  final List<UsageInfo> usages=findUsages(member,file);
  GrImportStatement templateImport=createTemplateImport(project,importStatement,member,file);
  if (ApplicationManager.getApplication().isUnitTestMode()) {
    if (!importStatement.isOnDemand()) {
      importStatement.delete();
    }
    updateRefs(usages,member.getName(),templateImport);
  }
 else {
    runTemplate(project,importStatement,member,file,usages,templateImport);
  }
}
