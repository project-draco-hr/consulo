{
  if (member instanceof GrAccessorMethod)   member=((GrAccessorMethod)member).getProperty();
  final GroovyFileBase file=(GroovyFileBase)importStatement.getContainingFile();
  final List<UsageInfo> usages=findUsages(member,file);
  GrImportStatement templateImport=createTemplateImport(project,importStatement,member,file);
  if (ApplicationManager.getApplication().isUnitTestMode()) {
    updateRefs(file,templateImport.getTextRange(),usages,member.getName());
  }
 else {
    runTemplate(project,importStatement,member,file,usages,templateImport);
  }
}
