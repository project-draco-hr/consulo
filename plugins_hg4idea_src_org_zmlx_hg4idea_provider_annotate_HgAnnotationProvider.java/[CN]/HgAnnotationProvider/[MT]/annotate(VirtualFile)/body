{
  VirtualFile vcsRoot=VcsUtil.getVcsRootFor(project,file);
  if (vcsRoot == null) {
    throw new VcsException("vcs root is null");
  }
  HgFile hgFile=new HgFile(vcsRoot,VfsUtil.virtualToIoFile(file));
  HgAnnotateCommand hgAnnotateCommand=new HgAnnotateCommand(project);
  HgLogCommand hgLogCommand=new HgLogCommand(project);
  return new HgAnnotation(hgFile,hgAnnotateCommand.execute(hgFile),hgLogCommand.execute(hgFile,DEFAULT_LIMIT,false));
}
