{
  super.visitReferenceElement(reference);
  if (!reference.isQualified()) {
    return;
  }
  final PsiElement parent=reference.getParent();
  if (parent instanceof PsiMethodCallExpression || parent instanceof PsiAssignmentExpression || parent instanceof PsiVariable) {
    return;
  }
  final PsiElement element=PsiTreeUtil.getParentOfType(reference,PsiImportStatementBase.class,PsiPackageStatement.class,PsiCodeFragment.class);
  if (element != null) {
    return;
  }
  if (m_ignoreJavadoc) {
    final PsiElement containingComment=PsiTreeUtil.getParentOfType(reference,PsiDocComment.class);
    if (containingComment != null) {
      return;
    }
  }
  final PsiElement psiElement=reference.resolve();
  if (!(psiElement instanceof PsiClass)) {
    return;
  }
  final PsiClass aClass=(PsiClass)psiElement;
  final PsiClass outerClass=ClassUtils.getOutermostContainingClass(aClass);
  final String fqName=outerClass.getQualifiedName();
  final String text=reference.getText();
  if (!text.startsWith(fqName)) {
    return;
  }
  final PsiJavaFile javaFile=PsiTreeUtil.getParentOfType(reference,PsiJavaFile.class);
  if (!ImportUtils.nameCanBeImported(fqName,javaFile)) {
    return;
  }
  registerError(reference);
}
