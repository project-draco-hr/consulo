{
  if (start == 0 && end == length())   return this;
  if (myOriginalSequence != null) {
    return myOriginalSequence.subSequence(start,end);
  }
  if (hasDeferredChanges()) {
    return new CharArray(myBufferSize,myDeferredChangesStorage.get(),myArray,myStart + start,myStart + end){
      @NotNull @Override protected DocumentEvent beforeChangedUpdate(      DocumentImpl subj,      int offset,      CharSequence oldString,      CharSequence newString,      boolean wholeTextReplaced){
        return new DocumentEventImpl(subj,offset,oldString,newString,LocalTimeCounter.currentTime(),wholeTextReplaced);
      }
      @Override protected void afterChangedUpdate(      @NotNull DocumentEvent event,      long newModificationStamp){
      }
      @Override public char[] getChars(){
        char[] chars=CharArray.this.getChars();
        char[] result=new char[end - start];
        System.arraycopy(chars,start,result,0,result.length);
        return result;
      }
    }
;
  }
 else {
    return new CharArrayCharSequence(myArray,start,end);
  }
}
