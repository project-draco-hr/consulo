{
  LOG.assertTrue(editor != null);
  LOG.assertTrue(boundClass != null);
  LOG.assertTrue(fieldClassName != null);
  LOG.assertTrue(fieldName != null);
  ApplicationManager.getApplication().assertReadAccessAllowed();
  final Project project=editor.getProject();
  PsiDocumentManager.getInstance(project).commitAllDocuments();
  if (!boundClass.isValid()) {
    return;
  }
  if (!boundClass.isWritable()) {
    if (showErrors) {
      if (!RefactoringMessageUtil.checkReadOnlyStatus(boundClass,project,UIDesignerBundle.message("error.cannot.create.field",fieldClassName))) {
        return;
      }
    }
 else     return;
  }
  final PsiClass fieldClass=PsiManager.getInstance(project).findClass(fieldClassName,GlobalSearchScope.moduleWithDependenciesAndLibrariesScope(editor.getModule()));
  if (fieldClass == null) {
    if (showErrors) {
      Messages.showErrorDialog(editor,UIDesignerBundle.message("error.cannot.create.field.no.class",fieldName,fieldClassName),CommonBundle.getErrorTitle());
    }
    return;
  }
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    public void run(){
      CommandProcessor.getInstance().executeCommand(editor.getProject(),new Runnable(){
        public void run(){
          createField(project,fieldClass,fieldName,boundClass,showErrors,editor);
        }
      }
,UIDesignerBundle.message("command.create.field"),null);
    }
  }
);
}
