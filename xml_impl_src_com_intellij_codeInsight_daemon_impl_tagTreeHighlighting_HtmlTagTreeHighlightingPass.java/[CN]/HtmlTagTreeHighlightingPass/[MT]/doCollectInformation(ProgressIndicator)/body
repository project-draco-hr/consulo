{
  if (ApplicationManager.getApplication().isUnitTestMode()) {
    return;
  }
  if (!WebEditorOptions.getInstance().isTagTreeHighlightingEnabled()) {
    return;
  }
  final int offset=myEditor.getCaretModel().getOffset();
  PsiElement element=null;
  final FileViewProvider viewProvider=myFile.getViewProvider();
  for (  Language language : viewProvider.getLanguages()) {
    if (language instanceof XMLLanguage) {
      element=viewProvider.findElementAt(offset,language);
      if (element != null) {
        break;
      }
    }
  }
  if (element == null) {
    return;
  }
  if (!containsParentTagsWithSameName(element)) {
    return;
  }
  while (element != null) {
    if (element instanceof XmlTag) {
      myPairsToHighlight.add(getTagRanges((XmlTag)element));
    }
    element=element.getParent();
  }
}
