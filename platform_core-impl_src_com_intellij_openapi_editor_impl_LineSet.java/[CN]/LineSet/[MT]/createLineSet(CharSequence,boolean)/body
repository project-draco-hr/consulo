{
  TIntArrayList starts=new TIntArrayList();
  TByteArrayList flags=new TByteArrayList();
  LineTokenizer lineTokenizer=new LineTokenizer(text);
  while (!lineTokenizer.atEnd()) {
    starts.add(lineTokenizer.getOffset());
    flags.add((byte)(lineTokenizer.getLineSeparatorLength() | (markModified ? MODIFIED_MASK : 0)));
    lineTokenizer.advance();
  }
  return new LineSet(starts.toNativeArray(),flags.toNativeArray(),text.length());
}
