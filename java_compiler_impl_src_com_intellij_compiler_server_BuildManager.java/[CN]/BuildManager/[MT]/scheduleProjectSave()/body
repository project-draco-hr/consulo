{
  if (!IS_UNIT_TEST_MODE && !PowerSaveMode.isEnabled()) {
    scheduleTask(myProjectsSaveAlarm,myProjectsSaveInProgress,new Runnable(){
      @Override public void run(){
        boolean shouldSave=false;
        for (        final Project project : getActiveProjects()) {
          if (canStartAutoMake(project)) {
            shouldSave=true;
            break;
          }
        }
        if (shouldSave) {
          final Semaphore semaphore=new Semaphore();
          semaphore.down();
          ApplicationManager.getApplication().invokeLater(new Runnable(){
            @Override public void run(){
              try {
                FileDocumentManager.getInstance().saveAllDocuments();
              }
  finally {
                semaphore.up();
              }
            }
          }
,ModalityState.NON_MODAL);
          semaphore.waitFor();
        }
      }
    }
);
  }
}
