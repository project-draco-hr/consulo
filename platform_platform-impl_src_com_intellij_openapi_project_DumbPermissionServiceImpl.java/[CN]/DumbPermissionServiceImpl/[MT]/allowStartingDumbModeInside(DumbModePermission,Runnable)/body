{
  DumbModePermission prev=myPermission.get();
  if (prev == DumbModePermission.MAY_START_MODAL && permission == DumbModePermission.MAY_START_BACKGROUND) {
    runnable.run();
    return;
  }
  myPermission.set(permission);
  try {
    runnable.run();
  }
  finally {
    if (prev == null) {
      myPermission.remove();
    }
 else {
      myPermission.set(prev);
    }
  }
}
