{
  List<ChangesCacheFile> result=new ArrayList<ChangesCacheFile>();
  final VcsRoot[] vcsRoots=ApplicationManager.getApplication().runReadAction(new Computable<VcsRoot[]>(){
    public VcsRoot[] compute(){
      return myVcsManager.getAllVcsRoots();
    }
  }
);
  for (  VcsRoot root : vcsRoots) {
    final CommittedChangesProvider provider=root.vcs.getCommittedChangesProvider();
    if (provider instanceof CachingCommittedChangesProvider) {
      final RepositoryLocation location=provider.getLocationFor(new FilePathImpl(root.path));
      if (location != null) {
        ChangesCacheFile cacheFile=getCacheFile(root.vcs,root.path,location);
        result.add(cacheFile);
      }
    }
  }
  return result;
}
