{
  return ApplicationManager.getApplication().runReadAction(new Computable<TodoItemData[]>(){
    @Override public TodoItemData[] compute(){
      final PsiTodoSearchHelper helper=PsiTodoSearchHelper.getInstance(myProject);
      PsiFile psiFile=myFile == null ? null : PsiManager.getInstance(myProject).findFile(myFile);
      if (psiFile != null) {
        return TodoForBaseRevision.convertTodo(helper.findTodoItems(psiFile));
      }
      return TodoForBaseRevision.convertTodo(getTodoForText(helper));
    }
  }
);
}
