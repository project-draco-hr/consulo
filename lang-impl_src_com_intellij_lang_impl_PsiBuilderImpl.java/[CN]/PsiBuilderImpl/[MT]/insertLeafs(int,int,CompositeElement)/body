{
  lastIdx=Math.min(lastIdx,myLexemCount);
  while (curToken < lastIdx) {
    final int start=myLexStarts[curToken];
    final int end=myLexEnds[curToken];
    if (start < end || myLexTypes[curToken] instanceof ILeafElementType) {
      final IElementType type=myLexTypes[curToken];
      final LeafElement leaf=createLeaf(type,start,end);
      TreeUtil.addChildren(curToken == myLexemCount - 1 && whitespaceOrComment(type) ? getRoot(curNode) : curNode,leaf);
    }
    curToken++;
  }
  return curToken;
}
