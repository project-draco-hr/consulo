{
  final Presentation presentation=e.getPresentation();
  final Artifact artifact=myArtifactEditor.getArtifact();
  final ParentElementsInfo parentInfo=findParentAndGrandParent(artifact);
  if (parentInfo != null) {
    presentation.setText("Put Into '" + parentInfo.getGrandparentArtifact().getName() + "' and link via manifest");
  }
  boolean enable=parentInfo != null;
  boolean isProvideElements=false;
  for (  PackagingSourceItem item : mySourceItemsTree.getSelectedItems()) {
    isProvideElements|=item.isProvideElements();
    if (!item.getKindOfProducedElements().containsJarFiles()) {
      enable=false;
      break;
    }
  }
  enable&=isProvideElements;
  presentation.setVisible(enable);
  presentation.setEnabled(enable);
}
