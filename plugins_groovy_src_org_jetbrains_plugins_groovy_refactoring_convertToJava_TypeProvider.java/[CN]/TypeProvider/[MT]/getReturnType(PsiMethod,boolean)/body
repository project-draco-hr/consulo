{
  if (forStubs) {
    PsiType returnType=method.getReturnType();
    if (returnType != null)     return returnType;
    return TypesUtil.getJavaLangObject(method);
  }
  if (method instanceof GrMethod) {
    GrTypeElement typeElement=((GrMethod)method).getReturnTypeElementGroovy();
    if (typeElement != null)     return typeElement.getType();
  }
  final PsiType smartReturnType=PsiUtil.getSmartReturnType(method);
  if (smartReturnType != null)   return smartReturnType;
  return TypesUtil.getJavaLangObject(method);
}
