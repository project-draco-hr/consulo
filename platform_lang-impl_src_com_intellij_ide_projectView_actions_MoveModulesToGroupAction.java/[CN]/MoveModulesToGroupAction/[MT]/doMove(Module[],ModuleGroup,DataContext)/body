{
  Project project=modules[0].getProject();
  for (  final Module module : modules) {
    ModifiableModuleModel model=dataContext != null ? LangDataKeys.MODIFIABLE_MODULE_MODEL.getData(dataContext) : null;
    if (model != null) {
      model.setModuleGroupPath(module,group == null ? null : group.getGroupPath());
    }
 else {
      ModuleManagerImpl.getInstanceImpl(project).setModuleGroupPath(module,group == null ? null : group.getGroupPath());
    }
  }
  AbstractProjectViewPane pane=ProjectView.getInstance(project).getCurrentProjectViewPane();
  if (pane != null) {
    pane.updateFromRoot(true);
  }
  if (!ProjectSettingsService.getInstance(project).processModulesMoved(modules,group) && pane != null) {
    if (group != null) {
      pane.selectModuleGroup(group,true);
    }
 else {
      pane.selectModule(modules[0],true);
    }
  }
}
