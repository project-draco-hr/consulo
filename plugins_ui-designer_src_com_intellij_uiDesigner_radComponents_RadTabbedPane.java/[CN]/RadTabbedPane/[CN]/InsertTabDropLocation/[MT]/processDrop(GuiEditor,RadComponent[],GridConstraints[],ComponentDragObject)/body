{
  if (myInsertBeforeId != null) {
    for (int i=0; i < getTabbedPane().getTabCount(); i++) {
      if (getRadComponent(i).getId().equals(myInsertBeforeId)) {
        myInsertIndex=i;
        break;
      }
    }
  }
  if (myInsertIndex > getTabbedPane().getTabCount()) {
    myInsertIndex=getTabbedPane().getTabCount();
  }
  RadComponent componentToAdd=components[0];
  if (componentToAdd instanceof RadContainer) {
    addComponent(componentToAdd,myInsertIndex);
  }
 else {
    Palette palette=Palette.getInstance(editor.getProject());
    RadContainer panel=InsertComponentProcessor.createPanelComponent(editor);
    addComponent(panel);
    panel.getDropLocation(null).processDrop(editor,new RadComponent[]{componentToAdd},null,new ComponentItemDragObject(palette.getPanelItem()));
  }
  getTabbedPane().setSelectedIndex(myInsertIndex);
}
