{
  ToolWindowEP[] beans=Extensions.getExtensions(ToolWindowEP.EP_NAME);
  for (  final ToolWindowEP bean : beans) {
    final Condition condition=bean.getCondition();
    if (condition != null && !condition.value(myProject)) {
      continue;
    }
    ToolWindowAnchor toolWindowAnchor;
    try {
      toolWindowAnchor=ToolWindowAnchor.fromText(bean.anchor);
    }
 catch (    Exception e) {
      LOG.error(e);
      continue;
    }
    JLabel label=new JLabel("Initializing toolwindow...");
    final ToolWindow toolWindow=registerToolWindow(bean.id,label,toolWindowAnchor,myProject);
    if (bean.icon != null) {
      toolWindow.setIcon(IconLoader.getIcon(bean.icon));
    }
    toolWindow.setSplitMode(bean.secondary,null);
    UiNotifyConnector.doWhenFirstShown(label,new Runnable(){
      public void run(){
        ApplicationManager.getApplication().invokeLater(new Runnable(){
          public void run(){
            ToolWindowFactory factory=bean.getToolWindowFactory();
            toolWindow.getContentManager().removeAllContents(false);
            factory.createToolWindowContent(myProject,toolWindow);
          }
        }
);
      }
    }
);
  }
}
