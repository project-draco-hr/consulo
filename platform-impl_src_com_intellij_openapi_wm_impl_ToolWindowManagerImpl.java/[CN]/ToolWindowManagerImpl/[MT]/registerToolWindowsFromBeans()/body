{
  ToolWindowEP[] beans=Extensions.getExtensions(ToolWindowEP.EP_NAME);
  for (  final ToolWindowEP bean : beans) {
    final Condition condition=bean.getCondition();
    if (condition != null && !condition.value(myProject)) {
      continue;
    }
    ToolWindowAnchor toolWindowAnchor;
    try {
      toolWindowAnchor=ToolWindowAnchor.fromText(bean.anchor);
    }
 catch (    Exception e) {
      LOG.error(e);
      continue;
    }
    JLabel label=new JLabel("Initializing toolwindow...");
    final ToolWindowFactory factory=bean.getToolWindowFactory();
    final ToolWindow toolWindow=registerToolWindow(bean.id,label,toolWindowAnchor,myProject,factory instanceof DumbAware);
    if (bean.icon != null) {
      Icon icon=IconLoader.findIcon(bean.icon,factory.getClass());
      if (icon == null) {
        try {
          icon=IconLoader.getIcon(bean.icon);
        }
 catch (        Exception ignored) {
        }
      }
      toolWindow.setIcon(icon);
    }
    toolWindow.setSplitMode(bean.secondary,null);
    UiNotifyConnector.doWhenFirstShown(label,new Runnable(){
      public void run(){
        ApplicationManager.getApplication().invokeLater(new Runnable(){
          public void run(){
            toolWindow.getContentManager().removeAllContents(false);
            factory.createToolWindowContent(myProject,toolWindow);
          }
        }
);
      }
    }
);
  }
}
