{
  AccessToken token=WriteAction.start();
  try {
    final PlatformModifiableModelsProvider provider=new PlatformModifiableModelsProvider();
    final DefaultModulesProvider modulesProvider=new DefaultModulesProvider(project);
    List<DetectedFrameworkDescription> sortedDescriptions=new ArrayList<DetectedFrameworkDescription>();
    for (    DetectedFrameworkDescription description : descriptions) {
      if (description.getUnderlyingType() == null) {
        sortedDescriptions.add(description);
      }
    }
    for (    DetectedFrameworkDescription description : descriptions) {
      if (description.getUnderlyingType() != null) {
        sortedDescriptions.add(description);
      }
    }
    for (    DetectedFrameworkDescription description : sortedDescriptions) {
      description.setupFramework(provider,modulesProvider);
    }
  }
  finally {
    token.finish();
  }
}
