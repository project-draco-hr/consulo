{
  try {
    File file=new File(FileUtil.toSystemDependentName(filePath));
    assertTrue("File " + file.getAbsolutePath() + " doesn't exist",file.exists());
    if (newContent != null) {
      FileUtil.writeToFile(file,newContent);
    }
    long oldTimestamp=FileSystemUtil.lastModified(file);
    long time=System.currentTimeMillis();
    setLastModified(file,time);
    if (FileSystemUtil.lastModified(file) <= oldTimestamp) {
      setLastModified(file,time + TIMESTAMP_ACCURACY);
      long newTimeStamp=FileSystemUtil.lastModified(file);
      assertTrue("Failed to change timestamp for " + file.getAbsolutePath(),newTimeStamp > oldTimestamp);
      long delta;
      while ((delta=newTimeStamp - System.currentTimeMillis()) > 0) {
        try {
          Thread.sleep(delta);
        }
 catch (        InterruptedException ignored) {
        }
      }
    }
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
}
