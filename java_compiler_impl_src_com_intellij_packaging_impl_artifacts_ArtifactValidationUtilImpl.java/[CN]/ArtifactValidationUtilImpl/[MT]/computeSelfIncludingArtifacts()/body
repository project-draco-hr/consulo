{
  final ArtifactManager artifactManager=ArtifactManager.getInstance(myProject);
  Set<Artifact> result=new HashSet<Artifact>();
  final PackagingElementResolvingContext context=artifactManager.getResolvingContext();
  for (  final Artifact artifact : artifactManager.getSortedArtifacts()) {
    if (!ArtifactUtil.processPackagingElements(artifact,ArtifactElementType.ARTIFACT_ELEMENT_TYPE,new PackagingElementProcessor<ArtifactPackagingElement>(){
      @Override public boolean process(      @NotNull ArtifactPackagingElement element,      @NotNull PackagingElementPath path){
        return !artifact.equals(element.findArtifact(context));
      }
    }
,context,true)) {
      result.add(artifact);
    }
  }
  return result;
}
