{
  if (JspPsiUtil.isInJspFile(file)) {
    EditorHighlighter highlighter=null;
    final Document document=PsiDocumentManager.getInstance(file.getProject()).getDocument(file);
    final EditorHighlighter cachedEditorHighlighter;
    boolean alreadyInitializedHighlighter=false;
    if ((cachedEditorHighlighter=EditorHighlighterCache.getEditorHighlighterForCachesBuilding(document)) != null && PlatformIdTableBuilding.checkCanUseCachedEditorHighlighter(file.getText(),cachedEditorHighlighter)) {
      highlighter=cachedEditorHighlighter;
      alreadyInitializedHighlighter=true;
    }
 else {
      final VirtualFile virtualFile=file.getVirtualFile();
      if (virtualFile != null) {
        highlighter=EditorHighlighterFactory.getInstance().createEditorHighlighter(file.getProject(),virtualFile);
      }
    }
    if (highlighter != null) {
      return new LexerEditorHighlighterLexer(highlighter,alreadyInitializedHighlighter);
    }
  }
  return null;
}
