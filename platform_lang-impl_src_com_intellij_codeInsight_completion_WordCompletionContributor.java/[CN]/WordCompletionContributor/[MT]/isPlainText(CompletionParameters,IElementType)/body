{
  if (elementType != PlainTextTokenTypes.PLAIN_TEXT) {
    return false;
  }
  if (ApplicationManager.getApplication().isUnitTestMode()) {
    return true;
  }
  final CompletionProcess completion=CompletionService.getCompletionService().getCurrentCompletion();
  if (completion == null || !completion.isAutopopupCompletion()) {
    return true;
  }
  return parameters.getOriginalFile().getViewProvider().getVirtualFile().isInLocalFileSystem();
}
