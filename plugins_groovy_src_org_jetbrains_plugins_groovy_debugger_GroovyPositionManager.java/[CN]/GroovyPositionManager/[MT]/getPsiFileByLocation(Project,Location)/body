{
  if (location == null)   return null;
  final ReferenceType refType=location.declaringType();
  if (refType == null)   return null;
  final String originalQName=refType.name().replace('/','.');
  int dollar=originalQName.indexOf('$');
  String qName=dollar >= 0 ? originalQName.substring(0,dollar) : originalQName;
  String runtimeName=qName;
  for (  ScriptPositionManagerHelper helper : ScriptPositionManagerHelper.EP_NAME.getExtensions()) {
    if (helper.isAppropriateRuntimeName(runtimeName)) {
      qName=helper.getOriginalScriptName(refType,runtimeName);
      break;
    }
  }
  final GlobalSearchScope searchScope=myDebugProcess.getSearchScope();
  try {
    final List<PsiClass> classes=GroovyShortNamesCache.getGroovyShortNamesCache(project).getClassesByFQName(qName,searchScope);
    PsiClass clazz=classes.size() == 1 ? classes.get(0) : null;
    if (clazz != null)     return clazz.getContainingFile();
  }
 catch (  ProcessCanceledException e) {
    return null;
  }
catch (  IndexNotReadyException e) {
    return null;
  }
  for (  ScriptPositionManagerHelper helper : ScriptPositionManagerHelper.EP_NAME.getExtensions()) {
    if (helper.isAppropriateRuntimeName(runtimeName)) {
      PsiFile file=helper.getExtraScriptIfNotFound(refType,runtimeName,project,searchScope);
      if (file != null)       return file;
    }
  }
  return null;
}
