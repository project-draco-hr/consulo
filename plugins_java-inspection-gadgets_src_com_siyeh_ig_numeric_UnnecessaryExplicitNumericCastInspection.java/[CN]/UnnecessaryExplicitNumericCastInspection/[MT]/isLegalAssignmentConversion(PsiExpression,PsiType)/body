{
  final PsiType operandType=expression.getType();
  if (isLegalWideningConversion(expression,assignmentType)) {
    return true;
  }
 else   if (PsiType.SHORT.equals(assignmentType)) {
    if (PsiType.INT.equals(operandType)) {
      final Object constant=ExpressionUtils.computeConstantExpression(expression);
      if (!(constant instanceof Integer)) {
        return false;
      }
      final int i=((Integer)constant).intValue();
      if (i >= Short.MIN_VALUE && i <= Short.MAX_VALUE) {
        return true;
      }
    }
  }
 else   if (PsiType.CHAR.equals(assignmentType)) {
    if (PsiType.INT.equals(operandType)) {
      final Object constant=ExpressionUtils.computeConstantExpression(expression);
      if (!(constant instanceof Integer)) {
        return false;
      }
      final int i=((Integer)constant).intValue();
      if (i >= Character.MIN_VALUE && i <= Character.MAX_VALUE) {
        return true;
      }
    }
  }
 else   if (PsiType.BYTE.equals(assignmentType)) {
    if (PsiType.INT.equals(operandType)) {
      final Object constant=ExpressionUtils.computeConstantExpression(expression);
      if (!(constant instanceof Integer)) {
        return false;
      }
      final int i=((Integer)constant).intValue();
      if (i >= Byte.MIN_VALUE && i <= Byte.MAX_VALUE) {
        return true;
      }
    }
  }
  return false;
}
