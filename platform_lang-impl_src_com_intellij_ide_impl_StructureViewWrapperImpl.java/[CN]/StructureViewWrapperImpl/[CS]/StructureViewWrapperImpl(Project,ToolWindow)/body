{
  myProject=project;
  myToolWindow=toolWindow;
  myUpdateQueue=new MergingUpdateQueue("StructureView",Registry.intValue("structureView.coalesceTime"),false,myToolWindow.getComponent(),this,myToolWindow.getComponent(),true);
  myUpdateQueue.setRestartTimerOnAdd(true);
  ActionManager.getInstance().addTimerListener(500,new TimerListener(){
    public ModalityState getModalityState(){
      return ModalityState.stateForComponent(myToolWindow.getComponent());
    }
    public void run(){
      checkUpdate();
    }
  }
);
  myToolWindow.getComponent().addHierarchyListener(new HierarchyListener(){
    public void hierarchyChanged(    HierarchyEvent e){
      if ((e.getChangeFlags() & HierarchyEvent.DISPLAYABILITY_CHANGED) != 0) {
        scheduleRebuild();
      }
    }
  }
);
  Disposer.register(myToolWindow.getContentManager(),this);
}
