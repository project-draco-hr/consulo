{
  if (myProject.isDisposed())   return;
  final Component owner=KeyboardFocusManager.getCurrentKeyboardFocusManager().getFocusOwner();
  if (SwingUtilities.isDescendingFrom(myPanel,owner) || JBPopupFactory.getInstance().isPopupActive())   return;
  final DataContext dataContext=DataManager.getInstance().getDataContext(owner);
  if (dataContext.getData(myKey) == this)   return;
  if (PlatformDataKeys.PROJECT.getData(dataContext) != myProject)   return;
  final VirtualFile[] files=PlatformDataKeys.VIRTUAL_FILE_ARRAY.getData(dataContext);
  if (files != null && files.length == 1) {
    setFile(files[0]);
  }
 else {
    setFile(null);
  }
}
