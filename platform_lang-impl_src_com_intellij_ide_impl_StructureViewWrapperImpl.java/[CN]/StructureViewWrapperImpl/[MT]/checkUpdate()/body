{
  if (myProject.isDisposed())   return;
  Window mywindow=SwingUtilities.windowForComponent(myPanel);
  if (mywindow != null && !mywindow.isActive())   return;
  final KeyboardFocusManager focusManager=KeyboardFocusManager.getCurrentKeyboardFocusManager();
  final Window focusWindow=focusManager.getFocusedWindow();
  if (focusWindow == mywindow) {
    final Component owner=focusManager.getFocusOwner();
    if (owner == null || SwingUtilities.isDescendingFrom(owner,myPanel))     return;
    final DataContext dataContext=DataManager.getInstance().getDataContext(owner);
    final FileEditor fileEditor=PlatformDataKeys.FILE_EDITOR.getData(dataContext);
    if (fileEditor != null) {
      if (Arrays.asList(FileEditorManager.getInstance(myProject).getSelectedEditors()).contains(fileEditor)) {
        setFileEditor(fileEditor);
      }
    }
 else {
      setModule(LangDataKeys.MODULE_CONTEXT.getData(dataContext));
    }
  }
}
