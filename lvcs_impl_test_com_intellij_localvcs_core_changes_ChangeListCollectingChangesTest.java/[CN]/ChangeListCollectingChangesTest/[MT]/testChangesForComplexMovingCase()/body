{
  applyAndAdd(cs(new CreateDirectoryChange(1,"d1"),new CreateFileChange(2,"d1/file",null,-1),new CreateDirectoryChange(3,"d1/d11"),new CreateDirectoryChange(4,"d1/d12"),new CreateDirectoryChange(5,"d2")));
  applyAndAdd(cs(new MoveChange("d1/file","d1/d11")));
  applyAndAdd(cs(new MoveChange("d1/d11/file","d1/d12")));
  assertEquals(3,getChangesFor("d1").size());
  assertEquals(3,getChangesFor("d1/d12/file").size());
  assertEquals(3,getChangesFor("d1/d11").size());
  assertEquals(2,getChangesFor("d1/d12").size());
  assertEquals(1,getChangesFor("d2").size());
  applyAndAdd(cs(new MoveChange("d1/d12","d2")));
  assertEquals(4,getChangesFor("d1").size());
  assertEquals(4,getChangesFor("d2/d12/file").size());
  assertEquals(2,getChangesFor("d2").size());
  assertEquals(3,getChangesFor("d2/d12").size());
}
