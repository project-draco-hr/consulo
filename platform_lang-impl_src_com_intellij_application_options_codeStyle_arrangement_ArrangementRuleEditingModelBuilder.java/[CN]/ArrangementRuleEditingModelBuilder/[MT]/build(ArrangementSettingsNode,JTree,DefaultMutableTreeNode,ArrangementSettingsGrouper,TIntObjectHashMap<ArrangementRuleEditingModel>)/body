{
  int initialInsertRow=0;
  for (TreeNode n=root.getParent(); n != null; n=n.getParent()) {
    for (int i=n.getChildCount() - 1; i >= 0; i--) {
      TreeNode child=n.getChildAt(i);
      if (child != root) {
        initialInsertRow+=calculateRowsCount(child);
      }
    }
    initialInsertRow++;
  }
  initialInsertRow+=calculateRowsCount(root);
  if (!tree.isRootVisible()) {
    initialInsertRow--;
  }
  HierarchicalArrangementSettingsNode grouped=grouper.group(setting);
  int rowsCreated=map(root,grouped);
  ArrangementRuleEditingModelImpl model=new ArrangementRuleEditingModelImpl(setting);
  rowMappings.put(initialInsertRow + rowsCreated - 1,model);
}
