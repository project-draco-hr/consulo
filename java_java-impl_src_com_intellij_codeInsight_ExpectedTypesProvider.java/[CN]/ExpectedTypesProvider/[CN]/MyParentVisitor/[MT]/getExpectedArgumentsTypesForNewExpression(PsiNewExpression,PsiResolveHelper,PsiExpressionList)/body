{
  PsiType newType=newExpr.getType();
  if (newType instanceof PsiClassType) {
    JavaResolveResult resolveResult=PsiUtil.resolveGenericsClassInType(newType);
    PsiClass newClass=(PsiClass)resolveResult.getElement();
    final PsiSubstitutor substitutor;
    if (newClass instanceof PsiAnonymousClass) {
      final PsiAnonymousClass anonymous=(PsiAnonymousClass)newClass;
      newClass=anonymous.getBaseClassType().resolve();
      if (newClass == null)       return;
      substitutor=TypeConversionUtil.getSuperClassSubstitutor(newClass,anonymous,PsiSubstitutor.EMPTY);
    }
 else     if (newClass != null) {
      substitutor=resolveResult.getSubstitutor();
    }
 else {
      return;
    }
    getExpectedTypesForConstructorCall(newClass,helper,list,substitutor);
  }
}
