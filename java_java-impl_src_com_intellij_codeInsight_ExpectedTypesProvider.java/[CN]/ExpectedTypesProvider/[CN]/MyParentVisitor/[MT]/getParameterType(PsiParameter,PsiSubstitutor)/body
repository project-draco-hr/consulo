{
  PsiType type=parameter.getType();
  if (parameter.isVarArgs()) {
    type=((PsiArrayType)type).getComponentType();
  }
  PsiType parameterType=substitutor.substitute(type);
  if (parameterType instanceof PsiCapturedWildcardType) {
    parameterType=((PsiCapturedWildcardType)parameterType).getWildcard();
  }
  if (parameterType instanceof PsiWildcardType) {
    final PsiWildcardType psiWildcardType=(PsiWildcardType)parameterType;
    if (psiWildcardType.isExtends()) {
      final PsiType superBound=psiWildcardType.getBound();
      if (superBound != null) {
        parameterType=superBound;
      }
    }
  }
  return parameterType;
}
