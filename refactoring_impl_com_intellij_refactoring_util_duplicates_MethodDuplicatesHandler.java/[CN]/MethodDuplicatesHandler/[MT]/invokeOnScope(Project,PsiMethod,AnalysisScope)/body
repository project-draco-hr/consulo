{
  final int[] dupCount=new int[]{0};
  scope.accept(new PsiRecursiveElementVisitor(){
    @Override public void visitFile(    final PsiFile file){
      final VirtualFile virtualFile=file.getVirtualFile();
      LOG.assertTrue(virtualFile != null);
      if (invokeOnElements(project,file,method)) {
        dupCount[0]++;
      }
    }
  }
);
  final Runnable nothingFoundRunnable=new Runnable(){
    public void run(){
      if (dupCount[0] == 0) {
        final String message=RefactoringBundle.message("idea.has.not.found.any.code.that.can.be.replaced.with.method.call",ApplicationNamesInfo.getInstance().getProductName());
        Messages.showInfoMessage(project,message,REFACTORING_NAME);
      }
    }
  }
;
  if (ApplicationManager.getApplication().isUnitTestMode()) {
    nothingFoundRunnable.run();
  }
 else {
    ApplicationManager.getApplication().invokeLater(nothingFoundRunnable,ModalityState.NON_MODAL);
  }
}
