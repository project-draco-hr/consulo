{
  if (myIsShuttingDown) {
    return;
  }
  if (ShutDownTracker.isShutdownHookRunning()) {
    myIsShuttingDown=true;
    return;
  }
  if (myStartAttemptCount++ > MAX_PROCESS_LAUNCH_ATTEMPT_COUNT) {
    notifyOnFailure(ApplicationBundle.message("watcher.failed.to.start"),null);
    return;
  }
  if (restart) {
    shutdownProcess();
  }
  LOG.info("Starting file watcher: " + myExecutable);
  final Process process=Runtime.getRuntime().exec(new String[]{myExecutable.getAbsolutePath()});
  myProcessHandler=new MyProcessHandler(process);
  myProcessHandler.addProcessListener(new MyProcessAdapter());
  myProcessHandler.startNotify();
  if (restart) {
synchronized (myLock) {
      if (myRecursiveWatchRoots.size() + myFlatWatchRoots.size() > 0) {
        setWatchRoots(myRecursiveWatchRoots,myFlatWatchRoots,true);
      }
    }
  }
}
