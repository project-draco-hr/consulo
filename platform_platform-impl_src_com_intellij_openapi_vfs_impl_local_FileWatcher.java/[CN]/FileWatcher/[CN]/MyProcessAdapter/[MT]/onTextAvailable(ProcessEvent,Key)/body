{
  if (outputType != ProcessOutputTypes.STDOUT)   return;
  final String line=event.getText().trim();
  if (LOG.isDebugEnabled()) {
    LOG.debug(">> " + line);
  }
  if (myLastOp == null) {
    final WatcherOp watcherOp;
    try {
      watcherOp=WatcherOp.valueOf(line);
    }
 catch (    IllegalArgumentException e) {
      final String message="Illegal watcher command: " + line;
      if (ApplicationManager.getApplication().isUnitTestMode())       LOG.debug(message);
 else       LOG.error(message);
      return;
    }
    if (watcherOp == WatcherOp.GIVEUP) {
      notifyOnFailure(ApplicationBundle.message("watcher.gave.up"),null);
      myIsShuttingDown=true;
    }
 else     if (watcherOp == WatcherOp.RESET) {
      reset();
    }
 else {
      myLastOp=watcherOp;
    }
  }
 else   if (myLastOp == WatcherOp.MESSAGE) {
    LOG.warn(line);
    String title=ApplicationBundle.message("watcher.slow.sync");
    NotificationListener listener=NotificationListener.URL_OPENING_LISTENER;
    Notifications.Bus.notify(NOTIFICATION_GROUP.getValue().createNotification(title,line,NotificationType.WARNING,listener));
    myLastOp=null;
  }
 else   if (myLastOp == WatcherOp.REMAP || myLastOp == WatcherOp.UNWATCHEABLE) {
    if ("#".equals(line)) {
      if (myLastOp == WatcherOp.REMAP) {
        processRemap();
      }
 else {
        mySettingRoots.decrementAndGet();
        processUnwatchable();
      }
      myLines.clear();
      myLastOp=null;
    }
 else {
      myLines.add(line);
    }
  }
 else {
    String path=line.replace('\0','\n');
    processChange(path,myLastOp);
    myLastOp=null;
  }
}
