{
  LeafElement whiteSpaceElement=Factory.createSingleLeafElement(ElementType.WHITE_SPACE,whiteSpace.toCharArray(),0,whiteSpace.length(),SharedImplUtil.findCharTableByTree(leafElement),null);
  ASTNode treePrev=getWsCandidate(leafElement);
  if (treePrev == null) {
    if (whiteSpace.length() > 0) {
      ChangeUtil.addChild(leafElement.getTreeParent(),whiteSpaceElement,leafElement);
    }
  }
 else   if (!isSpaceTextElement(treePrev)) {
    ChangeUtil.addChild((CompositeElement)treePrev.getTreeParent(),whiteSpaceElement,(TreeElement)treePrev);
  }
 else   if (!isWhiteSpaceElement(treePrev)) {
    return getWhiteSpaceBefore(leafElement);
  }
 else {
    ChangeUtil.replaceChild((CompositeElement)treePrev.getTreeParent(),(TreeElement)treePrev,whiteSpaceElement);
  }
  return getWhiteSpaceBefore(leafElement);
}
