{
  final ASTNode treeParent=treePrev.getTreeParent();
  if (isTag(treeParent)) {
    final String text;
    final XmlText xmlText;
    if (treePrev.getElementType() == XmlElementType.XML_TEXT) {
      xmlText=(XmlText)treePrev.getPsi();
      text=whiteSpaceElement.getText() + xmlText.getValue();
    }
 else     if (treePrev.getTreePrev().getElementType() == XmlElementType.XML_TEXT) {
      xmlText=(XmlText)treePrev.getTreePrev().getPsi();
      text=xmlText.getValue() + whiteSpaceElement.getText();
    }
 else {
      xmlText=(XmlText)Factory.createCompositeElement(XmlElementType.XML_TEXT,charTable,treeParent.getPsi().getManager());
      treeParent.addChild(xmlText.getNode(),treePrev);
      text=whiteSpaceElement.getText();
    }
    try {
      xmlText.setValue(text);
    }
 catch (    IncorrectOperationException e) {
      LOG.error(e);
    }
  }
 else   treeParent.addChild(whiteSpaceElement,treePrev);
}
