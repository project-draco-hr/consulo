{
  LeafElement whiteSpaceElement=Factory.createSingleLeafElement(whiteSpaceToken,whiteSpace.toCharArray(),0,whiteSpace.length(),SharedImplUtil.findCharTableByTree(leafElement),null);
  ASTNode treePrev=getWsCandidate(leafElement);
  if (treePrev == null) {
    if (whiteSpace.length() > 0) {
      leafElement.getTreeParent().addChild(whiteSpaceElement,leafElement);
    }
  }
 else   if (!isSpaceTextElement(treePrev)) {
    treePrev.getTreeParent().addChild(whiteSpaceElement,treePrev);
  }
 else   if (!isWhiteSpaceElement(treePrev)) {
    return getWhiteSpaceBefore(leafElement);
  }
 else {
    treePrev.getTreeParent().replaceChild(treePrev,whiteSpaceElement);
  }
  return getWhiteSpaceBefore(leafElement);
}
