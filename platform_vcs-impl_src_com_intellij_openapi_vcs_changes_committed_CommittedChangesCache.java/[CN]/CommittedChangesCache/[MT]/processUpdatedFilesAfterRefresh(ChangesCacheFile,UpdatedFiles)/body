{
  refreshCacheAsync(cache,false,new RefreshResultConsumer(){
    @Override public void receivedChanges(    final List<CommittedChangeList> committedChangeLists){
      try {
        debug("Processing updated files after refresh in " + cache.getLocation());
        boolean result=true;
        if (committedChangeLists.size() > 0) {
          result=cache.processUpdatedFiles(updatedFiles,myNewIncomingChanges);
        }
        debug(result ? "Still have unaccounted files" : "No more unaccounted files");
        if (result) {
          cache.refreshIncomingChanges();
          debug("Clearing cached incoming changelists");
          myCachedIncomingChangeLists=null;
        }
        pendingUpdateProcessed();
      }
 catch (      IOException e) {
        LOG.error(e);
      }
catch (      VcsException e) {
        notifyRefreshError(e);
      }
    }
    @Override public void receivedError(    VcsException ex){
      notifyRefreshError(ex);
    }
  }
);
}
