{
  StartupManager.getInstance(myProject).registerPostStartupActivity(new Runnable(){
    public void run(){
      myProject.getMessageBus().connect(myProject).subscribe(FileEditorManagerListener.FILE_EDITOR_MANAGER,new FileEditorManagerListener(){
        @Override public void fileOpened(        FileEditorManager source,        VirtualFile file){
        }
        @Override public void fileClosed(        FileEditorManager source,        VirtualFile file){
        }
        @Override public void selectionChanged(        FileEditorManagerEvent event){
          VirtualFile file=event.getNewFile();
          if (file != null && AndroidDesignerEditorProvider.acceptLayout(myProject,file)) {
            FileEditorProvider provider=EditorHistoryManager.getInstance(myProject).getSelectedProvider(file);
            if (provider != null) {
              MyState.getInstance(myProject).editorTypeId=provider.getEditorTypeId();
            }
          }
        }
      }
);
    }
  }
);
}
