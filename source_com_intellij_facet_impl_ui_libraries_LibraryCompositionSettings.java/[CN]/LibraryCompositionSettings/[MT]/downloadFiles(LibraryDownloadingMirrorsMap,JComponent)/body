{
  if (myDownloadLibraries) {
    RequiredLibrariesInfo requiredLibraries=new RequiredLibrariesInfo(getLibraryInfos());
    VirtualFile[] jars=myAddedJars.toArray(new VirtualFile[myAddedJars.size()]);
    RequiredLibrariesInfo.RequiredClassesNotFoundInfo info=requiredLibraries.checkLibraries(jars);
    if (info != null) {
      LibraryDownloadInfo[] downloadingInfos=LibraryDownloader.getDownloadingInfos(info.getLibraryInfos());
      if (downloadingInfos.length > 0) {
        LibraryDownloader downloader=new LibraryDownloader(downloadingInfos,null,parent,getDirectoryForDownloadedLibrariesPath(),myLibraryName,mirrorsMap);
        VirtualFile[] files=downloader.download();
        if (files.length != downloadingInfos.length) {
          return false;
        }
        myAddedJars.addAll(Arrays.asList(files));
      }
    }
  }
  return true;
}
