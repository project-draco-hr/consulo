{
  if (start < 0) {
    throw new IllegalArgumentException("Wrong start: " + start + "; end="+ end);
  }
 else   if (end > document.getTextLength()) {
    throw new IllegalArgumentException("Wrong end: " + end + "; document length="+ document.getTextLength()+ "; start="+ start);
  }
 else   if (start > end) {
    throw new IllegalArgumentException("start > end: start=" + start + "; end="+ end);
  }
  myDocument=document;
  myStart=start;
  myEnd=end;
  myId=counter.getAndIncrement();
  registerInDocument();
}
