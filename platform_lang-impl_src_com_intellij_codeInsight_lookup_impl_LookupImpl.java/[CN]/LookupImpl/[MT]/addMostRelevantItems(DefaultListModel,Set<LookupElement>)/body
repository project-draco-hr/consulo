{
  for (  final LookupItemWeightComparable comparable : myItemsMap.keySet()) {
    final List<LookupElement> suitable=new SmartList<LookupElement>();
    for (    final LookupElement item : myItemsMap.get(comparable)) {
      if (!firstItems.contains(item) && prefixMatches(item)) {
        suitable.add(item);
      }
    }
    if (firstItems.size() + suitable.size() > MAX_PREFERRED_COUNT)     break;
    for (    final LookupElement item : suitable) {
      firstItems.add(item);
      model.addElement(item);
    }
  }
}
