{
  int offset=myEditor.getSelectionModel().hasSelection() ? myEditor.getSelectionModel().getSelectionStart() : myEditor.getCaretModel().getOffset();
  int start=Math.max(offset - myMinPrefixLength - myAdditionalPrefix.length(),0);
  if (myLookupStartMarker != null) {
    if (myLookupStartMarker.isValid() && myLookupStartMarker.getStartOffset() == start && myLookupStartMarker.getEndOffset() == start) {
      return start;
    }
    myLookupStartMarker.dispose();
  }
  myLookupStartMarker=myEditor.getDocument().createRangeMarker(start,start);
  myLookupStartMarker.setGreedyToLeft(true);
  return start;
}
