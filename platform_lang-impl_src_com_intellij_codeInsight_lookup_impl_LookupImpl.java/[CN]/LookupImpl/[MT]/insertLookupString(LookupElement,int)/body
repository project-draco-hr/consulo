{
  final String lookupString=getCaseCorrectedLookupString(item);
  final Editor hostEditor=getTopLevelEditor();
  hostEditor.getCaretModel().runForEachCaret(new CaretAction(){
    @Override public void perform(    Caret caret){
      EditorModificationUtil.deleteSelectedText(hostEditor);
      final int caretOffset=hostEditor.getCaretModel().getOffset();
      int offset=insertLookupInDocumentWindowIfNeeded(caretOffset,prefix,lookupString);
      hostEditor.getCaretModel().moveToOffset(offset);
      hostEditor.getSelectionModel().removeSelection();
    }
  }
);
  myEditor.getScrollingModel().scrollToCaret(ScrollType.RELATIVE);
}
