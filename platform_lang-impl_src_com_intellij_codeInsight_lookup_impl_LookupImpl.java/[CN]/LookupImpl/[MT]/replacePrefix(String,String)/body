{
  if (!performGuardedChange(new Runnable(){
    public void run(){
      EditorModificationUtil.deleteSelectedText(myEditor);
      int offset=myEditor.getCaretModel().getOffset();
      final int start=offset - presentPrefix.length();
      myEditor.getDocument().replaceString(start,offset,newPrefix);
      Map<LookupElement,PrefixMatcher> newItems=myPresentableModel.retainMatchingItems(newPrefix,LookupImpl.this);
      myMatchers.clear();
      myMatchers.putAll(newItems);
      myAdditionalPrefix="";
      myEditor.getCaretModel().moveToOffset(start + newPrefix.length());
    }
  }
)) {
    return;
  }
  refreshUi(true);
}
