{
  final ToBeMergedDialog dialog=new ToBeMergedDialog(myProject,myNotMerged,myMergeTitle,myMergeChecker);
  dialog.show();
  if (dialog.getExitCode() == DialogWrapper.CANCEL_EXIT_CODE) {
    context.cancelEverything();
    return;
  }
  if (dialog.getExitCode() == ToBeMergedDialog.MERGE_ALL_CODE) {
    insertMergeAll(context);
  }
 else {
    final List<CommittedChangeList> lists=dialog.getSelected();
    if (lists.isEmpty())     return;
    final MergerFactory factory=new ChangeListsMergerFactory(lists);
    context.next(new LocalChangesPrompt(false,lists,myCopyPoint),new MergeTask(factory,myMergeTitle));
  }
}
