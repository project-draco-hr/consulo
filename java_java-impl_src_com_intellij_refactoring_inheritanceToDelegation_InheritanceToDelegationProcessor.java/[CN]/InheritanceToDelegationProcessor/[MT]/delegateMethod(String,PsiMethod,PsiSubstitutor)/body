{
  substitutor=GenerateMembersUtil.correctSubstitutor(method,substitutor);
  PsiMethod methodToAdd=GenerateMembersUtil.substituteGenericMethod(method,substitutor);
  final PsiModifierList modifierList=methodToAdd.getModifierList();
  final NullableNotNullManager manager=NullableNotNullManager.getInstance(myProject);
  modifierList.setModifierProperty(PsiModifier.ABSTRACT,false);
  if (manager.isNullable(method,false)) {
    modifierList.addAfter(myFactory.createAnnotationFromText("@" + manager.getDefaultNullable(),methodToAdd),null);
  }
 else   if (manager.isNotNull(method,false)) {
    modifierList.addAfter(myFactory.createAnnotationFromText("@" + manager.getDefaultNotNull(),methodToAdd),null);
  }
  final String delegationBody=getDelegationBody(methodToAdd,delegationTarget);
  PsiCodeBlock newBody=myFactory.createCodeBlockFromText(delegationBody,method);
  PsiCodeBlock oldBody=methodToAdd.getBody();
  if (oldBody != null) {
    oldBody.replace(newBody);
  }
 else {
    methodToAdd.addBefore(newBody,null);
  }
  if (methodToAdd.getDocComment() != null)   methodToAdd.getDocComment().delete();
  methodToAdd=(PsiMethod)CodeStyleManager.getInstance(myProject).reformat(methodToAdd);
  methodToAdd=(PsiMethod)JavaCodeStyleManager.getInstance(myProject).shortenClassReferences(methodToAdd);
  return methodToAdd;
}
