{
  myFields=myDialog.getSelectedFields();
  if (myFields.length == 0) {
    String message=RefactoringBundle.message("encapsulate.fields.no.fields.selected");
    RefactoringMessageUtil.showErrorMessage(EncapsulateFieldsHandler.REFACTORING_NAME,message,HelpID.ENCAPSULATE_FIELDS,myProject);
    return;
  }
  myClass=myFields[0].getContainingClass();
  super.doRun();
}
