{
  context.getProgressIndicator().setText("Filtering Maven resources...");
  List<ProcessingItem> result=new ArrayList<ProcessingItem>(items.length);
  int count=0;
  for (  ProcessingItem each : items) {
    context.getProgressIndicator().setFraction(((double)count) / items.length);
    context.getProgressIndicator().checkCanceled();
    MyProcessingItem eachItem=(MyProcessingItem)each;
    VirtualFile outputFile=each.getFile();
    VirtualFile sourceFile=eachItem.getSourceFile();
    try {
      if (eachItem.isFiltered()) {
        String resolved=PropertyResolver.resolve(eachItem.getModule(),VfsUtil.loadText(outputFile));
        VfsUtil.saveText(outputFile,resolved);
      }
 else {
        boolean wasFiltered=outputFile.getTimeStamp() != sourceFile.getTimeStamp();
        if (wasFiltered) {
          VfsUtil.saveText(outputFile,VfsUtil.loadText(sourceFile));
        }
      }
      result.add(each);
    }
 catch (    IOException e) {
      context.addMessage(CompilerMessageCategory.ERROR,"Maven: Cannot filter properties",outputFile.getUrl(),-1,-1);
    }
  }
  return result.toArray(new ProcessingItem[result.size()]);
}
