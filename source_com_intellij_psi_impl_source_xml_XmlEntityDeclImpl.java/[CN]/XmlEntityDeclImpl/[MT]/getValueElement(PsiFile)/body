{
  if (isInternalReference()) {
    for (ASTNode e=firstChild; e != null; e=e.getTreeNext()) {
      if (e.getElementType() == ElementType.XML_ATTRIBUTE_VALUE) {
        XmlAttributeValue value=(XmlAttributeValue)SourceTreeToPsiMap.treeElementToPsi(e);
        return value;
      }
    }
  }
 else {
    for (ASTNode e=lastChild; e != null; e=e.getTreePrev()) {
      if (e.getElementType() == ElementType.XML_ATTRIBUTE_VALUE) {
        XmlAttributeValue value=(XmlAttributeValue)SourceTreeToPsiMap.treeElementToPsi(e);
        final XmlFile xmlFile=XmlUtil.findXmlFile(baseFile,value.getValue());
        if (xmlFile != null) {
          return xmlFile;
        }
        return null;
      }
    }
  }
  return null;
}
