{
  final VirtualFile jar=LibrariesHelper.getInstance().findRootByClass(files,detectionClass);
  if (jar != null && jar.getFileSystem() instanceof JarFileSystem) {
    final VirtualFile manifestFile=jar.findFileByRelativePath(JarFile.MANIFEST_NAME);
    if (manifestFile != null) {
      try {
        final InputStream input=manifestFile.getInputStream();
        try {
          return new Manifest(input).getMainAttributes().getValue(Attributes.Name.IMPLEMENTATION_VERSION);
        }
  finally {
          input.close();
        }
      }
 catch (      IOException e) {
        LOG.debug(e);
        return null;
      }
    }
  }
  return null;
}
