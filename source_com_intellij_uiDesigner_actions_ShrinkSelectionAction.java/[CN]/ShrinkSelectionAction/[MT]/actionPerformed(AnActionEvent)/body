{
  final GuiEditor editor=GuiEditorUtil.getEditorFromContext(e.getDataContext());
  final SelectionState selectionState=editor.getSelectionState();
  selectionState.setInsideChange(true);
  try {
    final Stack<ComponentPtr[]> history=selectionState.getSelectionHistory();
    history.pop();
    FormEditingUtil.clearSelection(editor.getRootContainer());
    final ComponentPtr[] ptrs=history.peek();
    for (int i=ptrs.length - 1; i >= 0; i--) {
      final ComponentPtr ptr=ptrs[i];
      ptr.validate();
      if (ptr.isValid()) {
        ptr.getComponent().setSelected(true);
      }
    }
  }
  finally {
    selectionState.setInsideChange(false);
  }
}
