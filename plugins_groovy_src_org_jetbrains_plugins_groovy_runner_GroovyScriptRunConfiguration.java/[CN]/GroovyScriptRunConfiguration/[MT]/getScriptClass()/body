{
  final VirtualFile scriptFile=getScriptFile();
  if (scriptFile == null)   return null;
  final PsiFile file=PsiManager.getInstance(getProject()).findFile(scriptFile);
  if (file instanceof GroovyFile) {
    if (((GroovyFile)file).isScript())     return ((GroovyFile)file).getScriptClass();
    final PsiClass[] classes=((GroovyFile)file).getClasses();
    for (    PsiClass aClass : classes) {
      if (GroovyScriptRunConfigurationProducer.isRunnable(aClass)) {
        return aClass;
      }
    }
  }
  return null;
}
