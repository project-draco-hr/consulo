{
  DefaultActionGroup goBack=new DefaultActionGroup();
  BackAction back=new BackAction();
  goBack.add(back);
  ActionToolbar backToolbar=ActionManager.getInstance().createActionToolbar(ActionPlaces.UNKNOWN,goBack,true);
  backToolbar.getComponent().setBorder(IdeBorderFactory.createEmptyBorder(0));
  backToolbar.setLayoutPolicy(ActionToolbar.NOWRAP_LAYOUT_POLICY);
  myBackButtonPanel.add(backToolbar.getComponent(),BorderLayout.CENTER);
  DefaultActionGroup goForward=new DefaultActionGroup();
  ForwardAction forward=new ForwardAction();
  new ShadowAction(forward,ActionManager.getInstance().getAction("Forward"),getRootPane());
  goForward.add(forward);
  ActionToolbar forwardToolbar=ActionManager.getInstance().createActionToolbar(ActionPlaces.UNKNOWN,goForward,true);
  forwardToolbar.setLayoutPolicy(ActionToolbar.NOWRAP_LAYOUT_POLICY);
  forwardToolbar.getComponent().setBorder(IdeBorderFactory.createEmptyBorder(0));
  myNextButtonPanel.add(forwardToolbar.getComponent(),BorderLayout.CENTER);
  myTabs=new HeaderlessTabbedPane(getDisposable());
  final LabeledTextComponent.TextListener commentsListener=new LabeledTextComponent.TextListener(){
    @Override public void textChanged(    String newText){
      if (myMute) {
        return;
      }
      AbstractMessage message=getSelectedMessage();
      if (message != null) {
        message.setAdditionalInfo(newText);
      }
    }
  }
;
  if (!INTERNAL_MODE) {
    myDetailsTabForm=new DetailsTabForm(null);
    myCommentsTabForm=new CommentsTabForm();
    myCommentsTabForm.addCommentsListener(commentsListener);
    myTabs.addTab(DiagnosticBundle.message("error.comments.tab.title"),myCommentsTabForm.getContentPane());
    myDetailsTabForm.setCommentsAreaVisible(false);
  }
 else {
    final AnAction analyzePlatformAction=ActionManager.getInstance().getAction("AnalyzeStacktraceOnError");
    if (analyzePlatformAction != null) {
      myAnalyzeAction=new AnalyzeAction(analyzePlatformAction);
    }
    myDetailsTabForm=new DetailsTabForm(myAnalyzeAction);
    myDetailsTabForm.setCommentsAreaVisible(true);
    myDetailsTabForm.addCommentsListener(commentsListener);
  }
  myTabs.addTab(DiagnosticBundle.message("error.details.tab.title"),myDetailsTabForm.getContentPane());
  myAttachmentsTabForm=new AttachmentsTabForm();
  myAttachmentsTabForm.addInclusionListener(new ChangeListener(){
    public void stateChanged(    final ChangeEvent e){
      updateAttachmentWarning(getSelectedMessage());
    }
  }
);
  int activeTabIndex=Integer.parseInt(PropertiesComponent.getInstance().getValue(ACTIVE_TAB_OPTION,"0"));
  if (activeTabIndex >= myTabs.getTabCount() || activeTabIndex < 0) {
    activeTabIndex=0;
  }
  myTabs.setSelectedIndex(activeTabIndex);
  myTabs.addChangeListener(new ChangeListener(){
    @Override public void stateChanged(    ChangeEvent e){
      final JComponent c=getPreferredFocusedComponent();
      if (c != null) {
        IdeFocusManager.findInstanceByComponent(myContentPane).requestFocus(c,true);
      }
    }
  }
);
  myTabsPanel.add(myTabs,BorderLayout.CENTER);
  myDisableLink.setHyperlinkText(UIUtil.removeMnemonic(DiagnosticBundle.message("error.list.disable.plugin")));
  myDisableLink.addHyperlinkListener(new HyperlinkListener(){
    @Override public void hyperlinkUpdate(    HyperlinkEvent e){
      if (e.getEventType() == HyperlinkEvent.EventType.ACTIVATED) {
        disablePlugin();
      }
    }
  }
);
  myCredentialsLabel.addHyperlinkListener(new HyperlinkListener(){
    @Override public void hyperlinkUpdate(    HyperlinkEvent e){
      if (e.getEventType() == HyperlinkEvent.EventType.ACTIVATED) {
        new JetBrainsAccountDialog(getRootPane()).show();
        updateCredentialsPane(getSelectedMessage());
      }
    }
  }
);
  myAttachmentWarningLabel.setIcon(UIUtil.getBalloonWarningIcon());
  myAttachmentWarningLabel.addHyperlinkListener(new HyperlinkListener(){
    public void hyperlinkUpdate(    final HyperlinkEvent e){
      if (e.getEventType() == HyperlinkEvent.EventType.ACTIVATED) {
        myTabs.setSelectedIndex(myTabs.indexOfComponent(myAttachmentsTabForm.getContentPane()));
        myAttachmentsTabForm.selectFirstIncludedAttachment();
      }
    }
  }
);
  myDetailsTabForm.addAssigneeListener(new ActionListener(){
    @Override public void actionPerformed(    ActionEvent e){
      if (myMute)       return;
      AbstractMessage message=getSelectedMessage();
      if (message != null) {
        message.setAssigneeId(myDetailsTabForm.getAssigneeId());
      }
    }
  }
);
  return myContentPane;
}
