{
  myMessagePool.setJvmIsShuttingDown();
  LaterInvocator.invokeLater(new Runnable(){
    public void run(){
      final Application app=ApplicationManager.getApplication();
      if (app.isRestartCapable()) {
        app.restart();
      }
 else {
        app.exit();
      }
    }
  }
,ModalityState.NON_MODAL);
  doOKAction();
}
