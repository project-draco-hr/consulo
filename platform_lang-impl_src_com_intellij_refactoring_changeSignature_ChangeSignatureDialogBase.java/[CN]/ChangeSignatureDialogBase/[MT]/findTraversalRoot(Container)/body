{
  Container current=KeyboardFocusManager.getCurrentKeyboardFocusManager().getCurrentFocusCycleRoot();
  Container root;
  if (current == container) {
    root=container;
  }
 else {
    root=container.getFocusCycleRootAncestor();
    if (root == null) {
      root=container;
    }
  }
  if (root != current) {
    KeyboardFocusManager.getCurrentKeyboardFocusManager().setGlobalCurrentFocusCycleRoot(root);
  }
  return root;
}
