{
  final JPanel panel=new JPanel(new GridBagLayout());
  GridBagConstraints gbc=new GridBagConstraints(0,0,1,1,0,1,GridBagConstraints.WEST,GridBagConstraints.HORIZONTAL,new Insets(0,0,0,0),0,0);
  myNamePanel=new JPanel(new BorderLayout(0,2));
  myNameField=new EditorTextField(myMethod.getName());
  final JLabel nameLabel=new JLabel(RefactoringBundle.message("changeSignature.name.prompt"));
  nameLabel.setLabelFor(myNameField);
  myNameField.setEnabled(myMethod.canChangeName());
  if (myMethod.canChangeName()) {
    myNameField.addDocumentListener(mySignatureUpdater);
    myNameField.setPreferredWidth(200);
  }
  myNamePanel.add(nameLabel,BorderLayout.NORTH);
  IJSwingUtilities.adjustComponentsOnMac(nameLabel,myNameField);
  myNamePanel.add(myNameField,BorderLayout.SOUTH);
  createVisibilityPanel();
  if (myMethod.canChangeVisibility() && myVisibilityPanel instanceof ComboBoxVisibilityPanel) {
    ((ComboBoxVisibilityPanel)myVisibilityPanel).registerUpDownActionsFor(myNameField);
    myVisibilityPanel.setBorder(new EmptyBorder(0,0,0,8));
    panel.add(myVisibilityPanel,gbc);
    gbc.gridx++;
  }
  gbc.weightx=1;
  if (myMethod.canChangeReturnType() != MethodDescriptor.ReadWriteOption.None) {
    JPanel typePanel=new JPanel(new BorderLayout(0,2));
    typePanel.setBorder(new EmptyBorder(0,0,0,8));
    final JLabel typeLabel=new JLabel(RefactoringBundle.message("changeSignature.return.type.prompt"));
    myReturnTypeCodeFragment=createReturnTypeCodeFragment();
    final Document document=PsiDocumentManager.getInstance(myProject).getDocument(myReturnTypeCodeFragment);
    myReturnTypeField=createReturnTypeTextField(document);
    ((ComboBoxVisibilityPanel)myVisibilityPanel).registerUpDownActionsFor(myReturnTypeField);
    typeLabel.setLabelFor(myReturnTypeField);
    if (myMethod.canChangeReturnType() == MethodDescriptor.ReadWriteOption.ReadWrite) {
      myReturnTypeField.setPreferredWidth(200);
      myReturnTypeField.addDocumentListener(mySignatureUpdater);
    }
 else {
      myReturnTypeField.setEnabled(false);
    }
    typePanel.add(typeLabel,BorderLayout.NORTH);
    IJSwingUtilities.adjustComponentsOnMac(typeLabel,myReturnTypeField);
    typePanel.add(myReturnTypeField,BorderLayout.SOUTH);
    panel.add(typePanel,gbc);
    gbc.gridx++;
  }
  panel.add(myNamePanel,gbc);
  return panel;
}
