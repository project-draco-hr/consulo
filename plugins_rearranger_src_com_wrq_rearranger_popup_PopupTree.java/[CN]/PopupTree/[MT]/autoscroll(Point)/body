{
  int realrow=getRowForLocation(p.x,p.y);
  if (treeDropTarget != null) {
    treeDropTarget.clearInsertionPoint();
    int row=treeDropTarget.getSrcRow();
    Rectangle r=getRowBounds(row);
    if (realrow < 0) {
      LOG.debug("autscroll: realrow < 0 for [" + p.x + ","+ p.y+ "], trying x="+ r.x);
      p.x=r.x;
      realrow=getRowForLocation(p.x,p.y);
    }
  }
  if (realrow < 0) {
    LOG.debug("autoscroll point=[" + p.x + ","+ p.y+ "] realrow="+ realrow);
    return;
  }
  Rectangle outer=getBounds();
  int newRow=p.y + outer.y <= margin ? realrow < 1 ? 0 : realrow - 1 : realrow < getRowCount() - 1 ? realrow + 1 : realrow;
  LOG.debug("autoscroll point=[" + p.x + ","+ p.y+ "] realrow="+ realrow+ ", newRow="+ newRow);
  scrollRowToVisible(newRow);
  if (treeDropTarget != null) {
    treeDropTarget.computeInsertionPoint();
    treeDropTarget.drawInsertionPoint();
  }
}
