{
  final StringBuilder buf=StringBuilderSpinAllocator.alloc();
  try {
    if (getValue() instanceof ObjectReference) {
      final ObjectReference value=(ObjectReference)getValue();
      final String idLabel=value != null ? getIdLabel(value) : "";
      if (!label.startsWith(idLabel)) {
        buf.append(idLabel);
      }
    }
    if (label == null) {
      buf.append("null");
    }
 else {
      final boolean isQuoted=label.length() > 1 && StringUtil.startsWithChar(label,'\"') && StringUtil.endsWithChar(label,'\"');
      if (isQuoted) {
        label=label.substring(1,label.length() - 1);
        buf.append('"');
      }
      if (label.length() > MAX_DISPLAY_LABEL_LENGTH) {
        label=DebuggerUtils.translateStringValue(label.substring(0,MAX_DISPLAY_LABEL_LENGTH));
        buf.append(label);
        if (!label.endsWith("...")) {
          buf.append("...");
        }
      }
 else {
        buf.append(DebuggerUtils.translateStringValue(label));
      }
      if (isQuoted) {
        buf.append('"');
      }
    }
    return buf.toString();
  }
  finally {
    StringBuilderSpinAllocator.dispose(buf);
  }
}
