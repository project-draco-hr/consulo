{
  TextAttributes attributes=annotation.getEnforcedTextAttributes();
  if (attributes == null) {
    attributes=EditorColorsManager.getInstance().getGlobalScheme().getAttributes(annotation.getTextAttributes());
  }
  HighlightInfo info=new HighlightInfo(attributes,convertType(annotation),fixedRange != null ? fixedRange.getStartOffset() : annotation.getStartOffset(),fixedRange != null ? fixedRange.getEndOffset() : annotation.getEndOffset(),annotation.getMessage(),annotation.getTooltip(),annotation.getSeverity(),annotation.isAfterEndOfLine(),annotation.needsUpdateOnTyping(),annotation.isFileLevelAnnotation());
  info.setGutterIconRenderer(annotation.getGutterIconRenderer());
  List<Annotation.QuickFixInfo> fixes=annotation.getQuickFixes();
  if (fixes != null) {
    for (    final Annotation.QuickFixInfo quickFixInfo : fixes) {
      QuickFixAction.registerQuickFixAction(info,fixedRange != null ? fixedRange : quickFixInfo.textRange,quickFixInfo.quickFix,quickFixInfo.key);
    }
  }
  return info;
}
