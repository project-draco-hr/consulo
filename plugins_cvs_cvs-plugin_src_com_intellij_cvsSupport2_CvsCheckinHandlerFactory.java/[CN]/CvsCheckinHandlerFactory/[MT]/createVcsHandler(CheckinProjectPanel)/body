{
  return new CheckinHandler(){
    @Nullable public RefreshableOnComponent getAfterCheckinConfigurationPanel(    Disposable parentDisposable){
      final Project project=panel.getProject();
      final CvsVcs2 cvs=CvsVcs2.getInstance(project);
      final ProjectLevelVcsManager vcsManager=ProjectLevelVcsManager.getInstance(project);
      final Collection<VirtualFile> roots=panel.getRoots();
      final Collection<FilePath> files=new HashSet<FilePath>();
      for (      VirtualFile root : roots) {
        final VcsRoot vcsRoot=vcsManager.getVcsRootObjectFor(root);
        if (vcsRoot == null || vcsRoot.getVcs() != cvs) {
          continue;
        }
        files.add(VcsContextFactory.SERVICE.getInstance().createFilePathOn(root));
      }
      return new AdditionalOptionsPanel(CvsConfiguration.getInstance(project),files,project);
    }
  }
;
}
