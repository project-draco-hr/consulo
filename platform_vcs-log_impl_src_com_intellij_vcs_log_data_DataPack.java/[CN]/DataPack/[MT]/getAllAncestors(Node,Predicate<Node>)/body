{
  Set<Node> all=new LinkedHashSet<Node>();
  Queue<Node> queue=new ArrayDeque<Node>();
  queue.add(a);
  while (!queue.isEmpty()) {
    Node aNode=queue.remove();
    all.add(aNode);
    if (stop.apply(aNode)) {
      return new ArrayList<Node>(all);
    }
    for (    Edge edge : aNode.getDownEdges()) {
      queue.add(edge.getDownNode());
    }
  }
  return new ArrayList<Node>(all);
}
