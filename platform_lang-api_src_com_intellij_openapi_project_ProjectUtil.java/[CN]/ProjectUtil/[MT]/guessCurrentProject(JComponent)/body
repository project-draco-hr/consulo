{
  Project project=null;
  Project[] openProjects=ProjectManager.getInstance().getOpenProjects();
  if (openProjects.length > 0)   project=openProjects[0];
  if (project == null) {
    DataContext dataContext=component == null ? DataManager.getInstance().getDataContext() : DataManager.getInstance().getDataContext(component);
    project=PlatformDataKeys.PROJECT.getData(dataContext);
  }
  if (project == null) {
    project=ProjectManager.getInstance().getDefaultProject();
  }
  return project;
}
