{
  try {
    String expected;
    if (assertion instanceof ComparisonFailure) {
      expected=(String)EXPECTED_FIELD.get(assertion);
    }
 else {
      Field field=assertion.getClass().getDeclaredField("fExpected");
      field.setAccessible(true);
      expected=(String)field.get(assertion);
    }
    String actual;
    if (assertion instanceof ComparisonFailure) {
      actual=(String)ACTUAL_FIELD.get(assertion);
    }
 else {
      Field field=assertion.getClass().getDeclaredField("fActual");
      field.setAccessible(true);
      actual=(String)field.get(assertion);
    }
    return new ComparisonDetailsExtractor(assertion,expected,actual);
  }
 catch (  Throwable e) {
    return new ExceptionPacketFactory(PoolOfTestStates.FAILED_INDEX,assertion);
  }
}
