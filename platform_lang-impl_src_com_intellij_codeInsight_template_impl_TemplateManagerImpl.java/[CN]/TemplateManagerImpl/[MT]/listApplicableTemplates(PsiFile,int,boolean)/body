{
  Set<TemplateContextType> contextTypes=getApplicableContextTypes(file,offset);
  final ArrayList<TemplateImpl> result=ContainerUtil.newArrayList();
  for (  final TemplateImpl template : TemplateSettings.getInstance().getTemplates()) {
    if (!template.isDeactivated() && (!selectionOnly || template.isSelectionTemplate()) && isApplicable(template,contextTypes)) {
      result.add(template);
    }
  }
  return result;
}
