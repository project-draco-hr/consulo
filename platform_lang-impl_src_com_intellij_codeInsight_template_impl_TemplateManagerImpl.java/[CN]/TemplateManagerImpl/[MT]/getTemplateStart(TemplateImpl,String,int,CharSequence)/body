{
  int templateStart;
  if (argument == null) {
    templateStart=caretOffset - template.getKey().length();
  }
 else {
    int argOffset=getArgumentOffset(caretOffset,argument,text);
    templateStart=argOffset - template.getKey().length();
  }
  return templateStart;
}
