{
  if (isPerformanceTest() || ApplicationManager.getApplication() == null || ApplicationManager.getApplication() instanceof MockApplication) {
    return;
  }
  CompositeException result=new CompositeException();
  final CodeInsightSettings settings=CodeInsightSettings.getInstance();
  try {
    Element newS=new Element("temp");
    settings.writeExternal(newS);
    Assert.assertEquals("Code insight settings damaged",DEFAULT_SETTINGS_EXTERNALIZED,JDOMUtil.writeElement(newS,"\n"));
  }
 catch (  AssertionError error) {
    CodeInsightSettings clean=new CodeInsightSettings();
    Element temp=new Element("temp");
    clean.writeExternal(temp);
    settings.loadState(temp);
    result.add(error);
  }
  CodeStyleSettings codeStyleSettings=getCurrentCodeStyleSettings();
  codeStyleSettings.getIndentOptions(StdFileTypes.JAVA);
  try {
    checkSettingsEqual(myOldCodeStyleSettings,codeStyleSettings,"Code style settings damaged");
  }
 catch (  AssertionError e) {
    result.add(e);
  }
 finally {
    codeStyleSettings.clearCodeStyleSettings();
  }
  myOldCodeStyleSettings=null;
  try {
    InplaceRefactoring.checkCleared();
  }
 catch (  AssertionError e) {
    result.add(e);
  }
  try {
    StartMarkAction.checkCleared();
  }
 catch (  AssertionError e) {
    result.add(e);
  }
  if (!result.isEmpty())   throw result;
}
