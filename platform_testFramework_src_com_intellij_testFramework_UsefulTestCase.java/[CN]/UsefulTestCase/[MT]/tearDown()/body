{
  try {
    Disposer.dispose(myTestRootDisposable);
    cleanupSwingDataStructures();
  }
  finally {
    if (shouldContainTempFiles()) {
      FileUtil.resetCanonicalTempPathCache(ORIGINAL_TEMP_DIR);
      if (ourPathToKeep != null && FileUtil.isAncestor(myTempDir,ourPathToKeep,false)) {
        File[] files=new File(myTempDir).listFiles();
        if (files != null) {
          for (          File file : files) {
            if (!FileUtil.pathsEqual(file.getPath(),ourPathToKeep)) {
              FileUtil.delete(file);
            }
          }
        }
      }
 else {
        FileUtil.delete(new File(myTempDir));
      }
    }
  }
  UIUtil.removeLeakingAppleListeners();
  super.tearDown();
}
