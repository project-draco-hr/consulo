{
  PsiElement element=LangDataKeys.PSI_ELEMENT.getData(dataContext);
  if (element instanceof Property)   return null;
  VirtualFile virtualFile=PlatformDataKeys.VIRTUAL_FILE.getData(dataContext);
  if (virtualFile == null) {
    return null;
  }
  if (virtualFile instanceof ResourceBundleAsVirtualFile) {
    return ((ResourceBundleAsVirtualFile)virtualFile).getResourceBundle();
  }
  Project project=PlatformDataKeys.PROJECT.getData(dataContext);
  if (project != null) {
    final PsiFile psiFile=PsiManager.getInstance(project).findFile(virtualFile);
    if (psiFile instanceof PropertiesFile) {
      final ResourceBundle resourceBundle=((PropertiesFile)psiFile).getResourceBundle();
      if (resourceBundle.getPropertiesFiles(project).size() > 1) {
        return resourceBundle;
      }
    }
  }
  return null;
}
