{
  try {
    final Document document=file.getViewProvider().getDocument();
    PsiToDocumentSynchronizer.DocumentChangeTransaction transaction=((PsiDocumentManagerImpl)PsiDocumentManager.getInstance(file.getProject())).getSynchronizer().getTransaction(document);
    final PsiFileImpl fileImpl=(PsiFileImpl)file;
    final ASTDiffBuilder astDiffBuilder=new ASTDiffBuilder(fileImpl);
    if (transaction == null) {
      final PomModel model=PomManager.getModel(fileImpl.getProject());
      model.runTransaction(new PomTransactionBase(fileImpl,model.getModelAspect(TreeAspect.class)){
        public PomModelEvent runInner(){
          for (          LogEntry entry : myEntries) {
            entry.doActualPsiChange(file,astDiffBuilder);
          }
          fileImpl.subtreeChanged();
          final PomModel model=PomManager.getModel(fileImpl.getProject());
          TreeAspectEvent treeAspectEvent=new TreeAspectEvent(model,astDiffBuilder.getEvent());
          return treeAspectEvent;
        }
      }
);
    }
 else {
      for (      LogEntry entry : myEntries) {
        entry.doActualPsiChange(file,astDiffBuilder);
      }
      fileImpl.subtreeChanged();
    }
  }
 catch (  IncorrectOperationException e) {
    LOG.error(e);
  }
}
