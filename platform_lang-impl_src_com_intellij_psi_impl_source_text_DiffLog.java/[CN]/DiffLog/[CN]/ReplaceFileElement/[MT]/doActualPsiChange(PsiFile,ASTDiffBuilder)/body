{
  PsiFileImpl fileImpl=(PsiFileImpl)file;
  final int oldLength=myOldNode.getTextLength();
  BlockSupportImpl.sendBeforeChildrenChangeEvent(fileImpl);
  if (myOldNode.getFirstChildNode() != null)   myOldNode.rawRemoveAllChildren();
  final ASTNode firstChildNode=myNewNode.getFirstChildNode();
  if (firstChildNode != null)   myOldNode.rawAddChildren((TreeElement)firstChildNode);
  fileImpl.getTreeElement().setCharTable(myNewNode.getCharTable());
  ((PsiManagerEx)file.getManager()).invalidateFile(fileImpl);
  myOldNode.subtreeChanged();
  BlockSupportImpl.sendAfterChildrenChangedEvent(fileImpl,oldLength);
}
