{
  visited.add(module);
  final AndroidFacet facet=AndroidFacet.getInstance(module);
  VirtualFile resDir=facet != null ? AndroidRootUtil.getResourceDir(facet) : null;
  ModuleRootManager manager=ModuleRootManager.getInstance(module);
  for (  VirtualFile sourceRoot : manager.getSourceRoots(includingTests)) {
    if (!Comparing.equal(resDir,sourceRoot)) {
      result.add(sourceRoot);
    }
  }
  for (  OrderEntry entry : manager.getOrderEntries()) {
    if (entry instanceof ModuleOrderEntry) {
      ModuleOrderEntry moduleOrderEntry=(ModuleOrderEntry)entry;
      DependencyScope scope=moduleOrderEntry.getScope();
      if (scope == DependencyScope.COMPILE) {
        Module depModule=moduleOrderEntry.getModule();
        if (depModule != null && !visited.contains(depModule)) {
          fillSourceRoots(depModule,visited,result,false);
        }
      }
    }
  }
}
