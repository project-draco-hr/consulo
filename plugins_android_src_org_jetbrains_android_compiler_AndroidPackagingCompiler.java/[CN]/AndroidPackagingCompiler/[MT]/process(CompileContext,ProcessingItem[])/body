{
  if (!AndroidCompileUtil.isFullBuild(context)) {
    return ProcessingItem.EMPTY_ARRAY;
  }
  context.getProgressIndicator().setText("Building Android package...");
  final List<ProcessingItem> result=new ArrayList<ProcessingItem>();
  for (  ProcessingItem processingItem : items) {
    AptPackagingItem item=(AptPackagingItem)processingItem;
    if (!AndroidCompileUtil.isModuleAffected(context,item.myModule)) {
      continue;
    }
    doProcess(context,item,false);
    if (context.getMessages(CompilerMessageCategory.ERROR).length == 0) {
      doProcess(context,item,true);
    }
    if (context.getMessages(CompilerMessageCategory.ERROR).length == 0) {
      result.add(item);
    }
  }
  return result.toArray(new ProcessingItem[result.size()]);
}
