{
  final Class<?> returnType=method.getReturnType();
  final XmlTag tag=getXmlTag();
  if (DomElement.class.isAssignableFrom(returnType)) {
    final String qname=getSubTagName(method);
    if (qname != null) {
      XmlTag subTag=tag == null ? null : tag.findFirstSubTag(qname);
      final DomElement element=myManager.createDomElement((Class<DomElement>)returnType,subTag,getProxy(),qname);
      myName2Children.put(qname,element);
      myMethod2Children.put(method,element);
      tags.add(subTag);
      return;
    }
  }
  if (tag != null) {
    final Class<? extends DomElement> aClass=extractElementType(method.getGenericReturnType());
    if (aClass != null) {
      final String qname=getSubTagNameForCollection(method);
      if (qname != null) {
        myCollectionChildrenNames.add(qname);
        for (int i=0; i < tag.findSubTags(qname).length; i++) {
          XmlTag subTag=tag.findSubTags(qname)[i];
          if (!tags.contains(subTag)) {
            myManager.createDomElement(aClass,subTag,getProxy(),qname);
            tags.add(subTag);
          }
        }
      }
    }
  }
}
