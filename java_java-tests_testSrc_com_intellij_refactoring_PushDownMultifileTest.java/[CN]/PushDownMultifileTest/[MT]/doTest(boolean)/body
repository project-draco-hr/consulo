{
  try {
    doTest(new PerformAction(){
      @Override public void performAction(      final VirtualFile rootDir,      final VirtualFile rootAfter) throws Exception {
        final PsiClass srcClass=myJavaFacade.findClass("a.A",GlobalSearchScope.allScope(myProject));
        assertTrue("Source class not found",srcClass != null);
        final PsiClass targetClass=myJavaFacade.findClass("b.B",GlobalSearchScope.allScope(myProject));
        assertTrue("Target class not found",targetClass != null);
        final PsiMethod[] methods=srcClass.getMethods();
        assertTrue("No methods found",methods.length > 0);
        final MemberInfo[] membersToMove=new MemberInfo[1];
        final MemberInfo memberInfo=new MemberInfo(methods[0]);
        memberInfo.setChecked(true);
        membersToMove[0]=memberInfo;
        new PushDownProcessor(getProject(),membersToMove,srcClass,new DocCommentPolicy(DocCommentPolicy.ASIS)).run();
      }
    }
);
  }
 catch (  BaseRefactoringProcessor.ConflictsInTestsException e) {
    if (fail) {
      return;
    }
 else {
      throw e;
    }
  }
  if (fail) {
    fail("Conflict was not detected");
  }
}
