{
  if (myBaseDir != null && vcs.getName().equals(mappingList.getVcsFor(myBaseDir)) && vcs.fileIsUnderVcs(new FilePathImpl(myBaseDir))) {
    result.add(myBaseDir);
  }
  final Module[] modules=ApplicationManager.getApplication().runReadAction(new Computable<Module[]>(){
    public Module[] compute(){
      return ModuleManager.getInstance(myProject).getModules();
    }
  }
);
  for (  Module module : modules) {
    final VirtualFile[] files=ModuleRootManager.getInstance(module).getContentRoots();
    for (    VirtualFile file : files) {
      VcsDirectoryMapping mapping=mappingList.getMappingFor(file,module);
      final String mappingVcs=mapping != null ? mapping.getVcs() : null;
      if (vcs.getName().equals(mappingVcs)) {
        result.add(file);
      }
    }
  }
}
