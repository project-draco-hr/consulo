{
  for (  Module module : ModuleManager.getInstance(myProject).getModules()) {
    final VirtualFile[] files=ModuleRootManager.getInstance(module).getContentRoots();
    for (    VirtualFile file : files) {
      final AbstractVcs vcs=ProjectLevelVcsManager.getInstance(myProject).getVcsFor(file);
      if (vcs != null) {
        vcsDirtyScopeManager.getScope(vcs).addDirtyDirRecursively(new FilePathImpl(file));
      }
    }
  }
  final AbstractVcs[] abstractVcses=ProjectLevelVcsManager.getInstance(myProject).getAllActiveVcss();
  for (  AbstractVcs vcs : abstractVcses) {
    final VcsDirtyScopeImpl scope=vcsDirtyScopeManager.getScope(vcs);
    final VirtualFile[] roots=ProjectLevelVcsManager.getInstance(myProject).getRootsUnderVcs(vcs);
    for (    VirtualFile root : roots) {
      if (root.equals(myProject.getBaseDir())) {
        scope.addDirtyFile(new FilePathImpl(root));
      }
 else {
        scope.addDirtyDirRecursively(new FilePathImpl(root));
      }
    }
  }
}
