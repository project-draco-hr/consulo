{
  if (!from.equals(to) && hasDependency(from,to)) {
    final ModifiableRootModel fromModel=ModuleRootManager.getInstance(from).getModifiableModel();
    for (    OrderEntry entry : fromModel.getOrderEntries()) {
      if (entry instanceof ModuleOrderEntry) {
        final ModuleOrderEntry moduleOrderEntry=(ModuleOrderEntry)entry;
        if (to == moduleOrderEntry.getModule()) {
          fromModel.removeOrderEntry(moduleOrderEntry);
        }
      }
    }
    fromModel.commit();
  }
}
