{
  Library userLibrary=null;
  for (  OrderEntry entry : rootManager.getOrderEntries()) {
    if (entry instanceof LibraryOrderEntry) {
      LibraryOrderEntry libraryEntry=(LibraryOrderEntry)entry;
      Library library=libraryEntry.getLibrary();
      if (library != null) {
        String libraryName=libraryEntry.getLibraryName();
        if (libraryName != null && libraryName.startsWith(userLibraryName)) {
          userLibrary=library;
        }
 else {
          if (library.getTable() != null && (!providedOnly || !libraryEntry.getScope().isForProductionRuntime())) {
            result.add(library);
          }
        }
      }
    }
  }
  return userLibrary;
}
