{
  Module m=createModule("a.iml",StdModuleTypes.JAVA);
  VirtualFile libraryRoot=addLibrary(m,DependencyScope.RUNTIME);
  final VirtualFile[] runtimeClasspath=ModuleRootManager.getInstance(m).getFiles(OrderRootType.CLASSES_AND_OUTPUT);
  assertEquals(1,runtimeClasspath.length);
  assertEquals(libraryRoot,runtimeClasspath[0]);
  final VirtualFile[] compilationClasspath=ModuleRootManager.getInstance(m).getFiles(OrderRootType.COMPILATION_CLASSES);
  assertEquals(1,compilationClasspath.length);
  VirtualFile[] production=ModuleRootManager.getInstance(m).getFiles(OrderRootType.PRODUCTION_COMPILATION_CLASSES);
  assertEquals(0,production.length);
  VirtualFile libraryClass=myFixture.createFile("lib/Test.java","public class Test { }");
  assertTrue(m.getModuleWithDependenciesAndLibrariesScope(true).contains(libraryClass));
  assertFalse(m.getModuleWithDependenciesAndLibrariesScope(false).contains(libraryClass));
}
