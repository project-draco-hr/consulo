{
  final DocumentChangeTransaction documentChangeTransaction=myTransactionsMap.get(document);
  if (documentChangeTransaction != null) {
    documentChangeTransaction.replace(offset,0,s);
  }
 else {
    DocumentEx ex=(DocumentEx)document;
    ex.suppressGuardedExceptions();
    try {
      boolean isReadOnly=!ex.isWritable();
      ex.setReadOnly(false);
      ex.insertString(offset,s);
      ex.setReadOnly(isReadOnly);
    }
  finally {
      ex.unSuppressGuardedExceptions();
    }
  }
}
