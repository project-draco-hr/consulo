{
  final DocumentChangeTransaction documentChangeTransaction=getTransaction(document);
  if (documentChangeTransaction != null) {
    documentChangeTransaction.replace(startOffset,endOffset - startOffset,"");
  }
 else {
    DocumentEx ex=(DocumentEx)document;
    ex.suppressGuardedExceptions();
    try {
      boolean isReadOnly=!ex.isWritable();
      ex.setReadOnly(false);
      ex.deleteString(startOffset,endOffset);
      ex.setReadOnly(isReadOnly);
    }
  finally {
      ex.unSuppressGuardedExceptions();
    }
  }
}
