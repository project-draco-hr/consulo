{
  DocumentEx ex=(DocumentEx)document;
  ex.suppressGuardedExceptions();
  try {
    boolean isReadOnly=!document.isWritable();
    ex.setReadOnly(false);
    ex.replaceString(startOffset,endOffset,s);
    ex.setReadOnly(isReadOnly);
  }
  finally {
    ex.unSuppressGuardedExceptions();
  }
}
