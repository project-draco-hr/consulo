{
  List<Object> kidsToExpand=new ArrayList<Object>();
  Object eachElement=element;
  DefaultMutableTreeNode firstVisible;
  while (true) {
    firstVisible=getNodeForElement(eachElement);
    if (firstVisible != null)     break;
    if (eachElement != element || !parentsOnly) {
      kidsToExpand.add(eachElement);
    }
    eachElement=myTreeStructure.getParentElement(eachElement);
    if (eachElement == null) {
      firstVisible=null;
      break;
    }
  }
  if (firstVisible == null) {
    onDone.run();
  }
  processExpand(firstVisible,kidsToExpand,kidsToExpand.size() - 1,onDone);
}
