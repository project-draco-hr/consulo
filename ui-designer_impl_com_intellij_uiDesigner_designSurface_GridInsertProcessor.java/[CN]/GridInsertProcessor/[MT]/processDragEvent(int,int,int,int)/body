{
  final GridInsertLocation insertLocation=getGridInsertLocation(myEditor,x,y,dragColumnDelta,componentCount);
  if (insertLocation.isInsert()) {
    if (isDropInsertAllowed(insertLocation,componentCount)) {
      placeInsertFeedbackPainter(insertLocation,componentCount);
    }
  }
 else   if (insertLocation.getMode() == GridInsertMode.InCell) {
    Point targetPoint=insertLocation.getTargetPoint();
    Rectangle feedbackRect;
    if (insertLocation.getContainer().isGrid()) {
      feedbackRect=getGridFeedbackRect(insertLocation,componentCount);
    }
 else {
      feedbackRect=insertLocation.getContainer().getDropFeedbackRectangle(targetPoint.x,targetPoint.y,componentCount);
    }
    if (feedbackRect != null) {
      final Rectangle rc=SwingUtilities.convertRectangle(insertLocation.getContainer().getDelegee(),feedbackRect,myEditor.getActiveDecorationLayer());
      myEditor.getActiveDecorationLayer().putFeedback(rc);
    }
 else {
      myEditor.getActiveDecorationLayer().removeFeedback();
    }
  }
 else {
    myEditor.getActiveDecorationLayer().removeFeedback();
  }
  return insertLocation;
}
