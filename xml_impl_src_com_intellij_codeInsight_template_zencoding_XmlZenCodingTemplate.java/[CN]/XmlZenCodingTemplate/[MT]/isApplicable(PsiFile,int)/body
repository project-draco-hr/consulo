{
  WebEditorOptions webEditorOptions=WebEditorOptions.getInstance();
  if (!webEditorOptions.isZenCodingEnabled()) {
    return false;
  }
  if (file == null) {
    return false;
  }
  PsiDocumentManager.getInstance(file.getProject()).commitAllDocuments();
  PsiElement element=null;
  if (!InjectedLanguageManager.getInstance(file.getProject()).isInjectedFragment(file)) {
    element=InjectedLanguageUtil.findInjectedElementNoCommit(file,offset);
  }
  if (element == null) {
    element=file.findElementAt(offset > 0 ? offset - 1 : offset);
    if (element == null) {
      element=file;
    }
  }
  if (element.getLanguage() instanceof XMLLanguage) {
    if (PsiTreeUtil.getParentOfType(element,XmlAttributeValue.class) != null) {
      return false;
    }
    if (PsiTreeUtil.getParentOfType(element,XmlComment.class) != null) {
      return false;
    }
    return true;
  }
  return false;
}
