{
  int caretAt=editor.getCaretModel().getOffset();
  XmlZenCodingTemplate template=new XmlZenCodingTemplate();
  if (template.isApplicable(file,caretAt,false)) {
    final CustomTemplateCallback callback=new CustomTemplateCallback(editor,file);
    String key=template.computeTemplateKey(callback);
    if (key != null) {
      int offsetBeforeKey=caretAt - key.length();
      callback.getEditor().getDocument().deleteString(offsetBeforeKey,caretAt);
      template.expand(key,callback,new TemplateInvokationListener(){
        public void finished(        boolean inSeparateEvent){
          callback.finish();
        }
      }
);
      return true;
    }
  }
  return false;
}
