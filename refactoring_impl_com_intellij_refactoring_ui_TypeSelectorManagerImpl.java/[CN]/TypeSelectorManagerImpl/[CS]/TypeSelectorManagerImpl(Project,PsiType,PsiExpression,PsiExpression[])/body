{
  myFactory=PsiManager.getInstance(project).getElementFactory();
  myDefaultType=type;
  myMainOccurence=mainOccurence;
  myOccurrences=occurrences;
  myExpectedTypesProvider=ExpectedTypesProvider.getInstance(project);
  myOccurrenceClassProvider=createOccurrenceClassProvider();
  myTypesForMain=getTypesForMain();
  myTypesForAll=getTypesForAll();
  myIsOneSuggestion=myTypesForMain.length == 1 && myTypesForAll.length == 1 && myTypesForAll[0].equals(myTypesForMain[0]);
  if (myIsOneSuggestion) {
    myTypeSelector=new TypeSelector(myTypesForAll[0]);
  }
 else {
    myTypeSelector=new TypeSelector();
  }
}
