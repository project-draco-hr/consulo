{
  if (statement == null) {
    orig.delete();
    return;
  }
  PsiElement parent=orig.getParent();
  if (parent == null)   return;
  if (statement instanceof PsiBlockStatement && parent instanceof PsiCodeBlock) {
    PsiCodeBlock codeBlock=((PsiBlockStatement)statement).getCodeBlock();
    PsiJavaToken lBrace=codeBlock.getLBrace();
    PsiJavaToken rBrace=codeBlock.getRBrace();
    if (lBrace == null || rBrace == null)     return;
    final PsiElement[] children=codeBlock.getChildren();
    if (children.length > 2) {
      final PsiElement added=parent.addRangeBefore(children[1],children[children.length - 2],orig);
      final CodeStyleManager codeStyleManager=CodeStyleManager.getInstance(orig.getManager());
      codeStyleManager.reformat(added);
    }
    orig.delete();
  }
 else {
    orig.replace(statement);
  }
}
