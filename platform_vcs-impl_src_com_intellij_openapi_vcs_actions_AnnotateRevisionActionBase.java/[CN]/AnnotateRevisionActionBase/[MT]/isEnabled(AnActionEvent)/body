{
  if (e.getProject() == null)   return false;
  VcsFileRevision fileRevision=getFileRevision(e);
  if (fileRevision == null)   return false;
  VirtualFile file=getFile(e);
  if (file == null)   return false;
  AbstractVcs vcs=getVcs(e);
  if (vcs == null)   return false;
  AnnotationProvider provider=vcs.getCachingAnnotationProvider();
  if (provider == null || !provider.isAnnotationValid(fileRevision))   return false;
  final ProjectLevelVcsManagerImpl plVcsManager=(ProjectLevelVcsManagerImpl)ProjectLevelVcsManager.getInstance(vcs.getProject());
  if (plVcsManager.getBackgroundableActionHandler(VcsBackgroundableActions.ANNOTATE).isInProgress(key(file)))   return false;
  return true;
}
