{
  if (processed.add(module)) {
    for (    JpsDependencyElement item : JpsJavaExtensionService.getInstance().getDependencies(module,kind,false)) {
      if (item instanceof JpsModuleSourceDependency) {
        processor.apply(module,kind);
      }
 else       if (item instanceof JpsModuleDependency) {
        final JpsModule dep=((JpsModuleDependency)item).getModule();
        if (dep != null) {
          collectPathsRecursively(dep,kind,processed,processor);
        }
      }
    }
  }
}
