{
  final LinkedHashSet<BuildTarget<?>> dependencies=new LinkedHashSet<BuildTarget<?>>();
  JpsArtifactUtil.processPackagingElements(myArtifact.getRootElement(),new Processor<JpsPackagingElement>(){
    @Override public boolean process(    JpsPackagingElement element){
      if (element instanceof JpsArtifactOutputPackagingElement) {
        JpsArtifact included=((JpsArtifactOutputPackagingElement)element).getArtifactReference().resolve();
        if (included != null && !included.equals(myArtifact)) {
          if (!StringUtil.isEmpty(included.getOutputPath())) {
            dependencies.add(new ArtifactBuildTarget(included));
            return false;
          }
        }
      }
      dependencies.addAll(LayoutElementBuildersRegistry.getInstance().getDependencies(element));
      return true;
    }
  }
);
  return dependencies;
}
