{
  final File linkFile=new File(FileUtil.getTempDirectory(),link);
  assertTrue(link,!linkFile.exists() || linkFile.delete());
  final File parentDir=linkFile.getParentFile();
  assertTrue("link=" + link + ", parent="+ parentDir,parentDir != null && (parentDir.isDirectory() || parentDir.mkdirs()));
  final ProcessBuilder builder=new ProcessBuilder("ln","-s",target,linkFile.getAbsolutePath());
  final Process process=builder.start();
  final int res=process.waitFor();
  assertTrue(builder.command() + ": " + res,res == 0);
  final File targetFile=new File(target);
  assertTrue("target=" + target + ", link="+ linkFile,linkFile.exists() == targetFile.exists() && linkFile.getCanonicalPath().equals(targetFile.getAbsolutePath()) == targetFile.exists());
  return linkFile;
}
