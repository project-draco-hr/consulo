{
  final StateStorageManager storageManager=getStateStorageManager();
  final StateStorageManager.ExternalizationSession session=storageManager.startExternalization();
  final SettingsSavingComponent[] settingsComponents=mySettingsSavingComponents.toArray(new SettingsSavingComponent[mySettingsSavingComponents.size()]);
  for (  SettingsSavingComponent settingsSavingComponent : settingsComponents) {
    settingsSavingComponent.save();
  }
  final String[] names=myComponents.keySet().toArray(new String[myComponents.keySet().size()]);
  for (  String name : names) {
    Object component=myComponents.get(name);
    if (component instanceof JDOMExternalizable) {
      commitJdomExternalizable((JDOMExternalizable)component,session);
    }
 else     if (component instanceof PersistentStateComponent) {
      commitPersistentComponent((PersistentStateComponent<?>)component,session);
    }
  }
  mySaveSession=storageManager.startSave(session);
}
