{
  final String componentName=((BaseComponent)component).getComponentName();
  myComponents.put(componentName,component);
  if (optimizeTestLoading())   return;
  loadJdomDefaults(component,componentName);
  StateStorage stateStorage=getOldStorage(component);
  if (stateStorage == null)   return;
  Element element=null;
  if (!(this instanceof ProjectStoreImpl && ((ProjectStoreImpl)this).getProject().isDefault())) {
    try {
      element=getJdomState(component,componentName,stateStorage);
    }
 catch (    StateStorage.StateStorageException e) {
      LOG.error(e);
    }
  }
  if (element != null) {
    try {
      if (LOG.isDebugEnabled()) {
        LOG.debug("Loading configuration for " + component.getClass());
      }
      component.readExternal(element);
    }
 catch (    InvalidDataException e) {
      throw new InvalidComponentDataException(e);
    }
  }
}
