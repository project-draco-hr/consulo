{
  Element element=new Element("TextWithImports");
  TextWithImportsImpl textImpl=(TextWithImportsImpl)text;
  element.setAttribute("text",textImpl.saveToString());
  element.setAttribute("type",textImpl.getFactory() == TextWithImportsImpl.EXPRESSION_FACTORY ? "expression" : "code fragment");
  return element;
}
