{
  VcsBackgroundTaskWithLocalHistory taskWithLocalHistory=new VcsBackgroundTaskWithLocalHistory<VirtualFile[]>(project,getActionName(activeVcs),BackgroundFromStartOption.getInstance(),Collections.singleton(files),true,SvnBundle.message("action.Subversion.Add.text")){
    @Override protected void process(    VirtualFile[] items) throws VcsException {
      ProjectLevelVcsManager manager=ProjectLevelVcsManager.getInstance(project);
      manager.startBackgroundVcsOperation();
      try {
        SVNWCClient wcClient=activeVcs.createWCClient();
        wcClient.setEventHandler(new AddEventListener(project));
        Collection<SVNException> exceptions=SvnCheckinEnvironment.scheduleUnversionedFilesForAddition(wcClient,Arrays.asList(items),true);
        if (!exceptions.isEmpty()) {
          final Collection<String> messages=new ArrayList<String>(exceptions.size());
          for (          SVNException exception : exceptions) {
            messages.add(exception.getMessage());
          }
          throw new VcsException(messages);
        }
      }
  finally {
        manager.stopBackgroundVcsOperation();
      }
    }
  }
;
  ProgressManager.getInstance().run(taskWithLocalHistory);
}
