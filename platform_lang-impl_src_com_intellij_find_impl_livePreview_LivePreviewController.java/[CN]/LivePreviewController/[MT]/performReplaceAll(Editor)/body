{
  Project project=mySearchResults.getProject();
  if (!ReadonlyStatusHandler.ensureDocumentWritable(project,e.getDocument()))   return;
  if (mySearchResults.getFindModel() != null) {
    final FindModel copy=new FindModel();
    copy.copyFrom(mySearchResults.getFindModel());
    final SelectionModel selectionModel=mySearchResults.getEditor().getSelectionModel();
    final int offset;
    if (!selectionModel.hasSelection() || copy.isGlobal()) {
      copy.setGlobal(true);
      offset=0;
    }
 else {
      offset=selectionModel.getBlockSelectionStarts()[0];
    }
    FindUtil.replace(project,e,offset,copy,this);
  }
}
