{
  if (findResult == null) {
    return null;
  }
  String foundString=editor.getDocument().getText(findResult);
  CharSequence documentText=editor.getDocument().getImmutableCharSequence();
  FindModel currentModel=mySearchResults.getFindModel();
  String stringToReplace=null;
  if (currentModel != null) {
    if (currentModel.isReplaceState()) {
      FindManager findManager=FindManager.getInstance(mySearchResults.getProject());
      try {
        stringToReplace=findManager.getStringToReplace(foundString,currentModel,findResult.getStartOffset(),documentText);
      }
 catch (      FindManager.MalformedReplacementStringException e) {
        return null;
      }
    }
  }
  return stringToReplace;
}
