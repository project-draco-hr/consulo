{
  this.query=query;
  this.collector=collector;
  if (inReadAction) {
    this.processor=new ReadActionProcessor<PsiReference>(){
      @Override public boolean processInReadAction(      PsiReference psiReference){
        return processor.process(psiReference,collector);
      }
    }
;
  }
 else {
    this.processor=new Processor<PsiReference>(){
      @Override public boolean process(      PsiReference psiReference){
        return processor.process(psiReference,collector);
      }
    }
;
  }
}
