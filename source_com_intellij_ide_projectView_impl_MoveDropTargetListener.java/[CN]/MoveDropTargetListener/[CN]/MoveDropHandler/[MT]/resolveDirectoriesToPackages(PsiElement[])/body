{
  final PsiElement[] resolved=new PsiElement[sourceElements.length];
  for (int i=0; i < sourceElements.length; i++) {
    final PsiElement sourceElement=sourceElements[i];
    if (sourceElement instanceof PsiDirectory) {
      final PsiPackage psiPackage=((PsiDirectory)sourceElement).getPackage();
      if (psiPackage == null || psiPackage.getDirectories().length != 1) {
        return null;
      }
      resolved[i]=psiPackage;
    }
 else {
      resolved[i]=sourceElement;
    }
  }
  return resolved;
}
