{
  if (targetElement instanceof PsiDirectory) {
    final PsiDirectory directory=(PsiDirectory)targetElement;
    if (directory.getPackage() != null) {
      int moveType=MoveHandler.getMoveType(sourceElements);
      if (moveType == MoveHandler.CLASSES || moveType == MoveHandler.MOVE_OR_REARRANGE_PACKAGE) {
        final PsiElement[] resolvedElements=resolveDirectoriesToPackages(sourceElements);
        if (resolvedElements != null) {
          new MoveClassesOrPackagesToNewDirectoryDialog((PsiDirectory)targetElement,resolvedElements).show();
          return true;
        }
      }
    }
  }
  return false;
}
