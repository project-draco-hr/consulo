{
  PsiElement[] elements;
  try {
    Object[] objects=(Object[])dtde.getTransferable().getTransferData(AbstractProjectViewPSIPane.FLAVORS[0]);
    elements=new PsiElement[objects.length];
    for (int i=0; i < objects.length; i++) {
      Object object=objects[i];
      if (!isValidDropTarget(object)) {
        elements=null;
        break;
      }
      elements[i]=(PsiElement)object;
    }
  }
 catch (  UnsupportedFlavorException e) {
    elements=null;
  }
catch (  IOException e) {
    elements=null;
  }
  if (elements != null) {
    final Point location=dtde.getLocation();
    final TreePath path=myPane.myTree.getPathForLocation(location.x,location.y);
    if (path != null) {
      DefaultMutableTreeNode node=(DefaultMutableTreeNode)path.getLastPathComponent();
      if (doMove(node,dtde,elements))       return;
      node=(DefaultMutableTreeNode)node.getParent();
      if (node != null && doMove(node,dtde,elements))       return;
    }
  }
  dtde.rejectDrop();
}
