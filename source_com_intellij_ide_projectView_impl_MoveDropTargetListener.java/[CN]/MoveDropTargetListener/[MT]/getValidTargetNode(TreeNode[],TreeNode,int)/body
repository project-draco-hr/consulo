{
  final DropHandler dropHandler=getDropHandler(dropAction);
  TreeNode currentNode=targetNode;
  while (true) {
    if (dropHandler.isValidTarget(sourceNodes,currentNode)) {
      return currentNode;
    }
    if (!dropHandler.shouldDelegateToParent(currentNode))     return null;
    currentNode=currentNode.getParent();
    if (currentNode == null)     return null;
  }
}
