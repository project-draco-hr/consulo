{
  if (TreeUtil.isCollapsedChameleon(this)) {
    AstBufferUtil.toBuffer(this,buffer,0);
    return;
  }
  int offset=0;
  TreeElement cur=this;
  while ((cur=next(cur,cur instanceof CompositeElement && !TreeUtil.isCollapsedChameleon(cur),false)) != null) {
    if (cur instanceof LeafElement || TreeUtil.isCollapsedChameleon(cur)) {
      offset=AstBufferUtil.toBuffer(cur,buffer,offset);
    }
  }
}
