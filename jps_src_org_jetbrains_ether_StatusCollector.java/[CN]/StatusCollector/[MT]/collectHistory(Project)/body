{
  StringBuffer buf=new StringBuffer();
  Map<String,ModuleStatus> moduleHistories=new HashMap<String,ModuleStatus>();
  for (  Library lib : prepare(prj.getLibraries().values(),myLibraryComparator)) {
    libraryToBuffer(buf,lib);
  }
  for (  Module mod : prepare(prj.getModules().values(),myModuleComparator)) {
    moduleHistories.put(mod.getName(),moduleToBuffer(buf,mod));
  }
  return new ProjectSnapshot(buf.toString(),moduleHistories);
}
