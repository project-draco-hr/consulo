{
  final AbstractProjectViewPane viewPane=getCurrentProjectViewPane();
  if (viewPane == null) {
    return null;
  }
  TreePath path=viewPane.getSelectedPath();
  if (path == null) {
    return null;
  }
  path=path.getParentPath();
  if (path == null) {
    return null;
  }
  DefaultMutableTreeNode node=(DefaultMutableTreeNode)path.getLastPathComponent();
  Object userObject=node.getUserObject();
  if (userObject instanceof ProjectViewNode) {
    ProjectViewNode descriptor=(ProjectViewNode)userObject;
    Object element=descriptor.getValue();
    if (element instanceof PsiElement) {
      PsiElement psiElement=(PsiElement)element;
      if (!psiElement.isValid())       return null;
      return psiElement;
    }
 else {
      return null;
    }
  }
  return null;
}
