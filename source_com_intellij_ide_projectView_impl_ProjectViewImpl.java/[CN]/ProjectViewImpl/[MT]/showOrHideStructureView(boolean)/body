{
  boolean hadFocus=IJSwingUtilities.hasFocus2(getComponent());
  myStructurePanel.setVisible(toShow);
  setShowStructure(toShow,myCurrentViewId);
  if (hadFocus) {
    final AbstractProjectViewPane viewPane=getCurrentProjectViewPane();
    if (viewPane != null) {
      viewPane.getComponent().requestFocus();
    }
  }
  if (toShow) {
    VirtualFile[] files=FileEditorManager.getInstance(myProject).getSelectedFiles();
    if (files.length != 0) {
      myStructureViewWrapper.setFileEditor(FileEditorManager.getInstance(myProject).getSelectedEditor(files[0]));
    }
 else {
      myStructureViewWrapper.setFileEditor(null);
    }
  }
}
