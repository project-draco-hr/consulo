{
  boolean hadFocus=IJSwingUtilities.hasFocus2(getComponent());
  myStructurePanel.setVisible(toShow);
  setShowStructure(toShow,myCurrentViewId);
  if (hadFocus) {
    final AbstractProjectViewPane viewPane=getCurrentProjectViewPane();
    if (viewPane != null) {
      viewPane.getComponent().requestFocus();
    }
  }
  if (toShow) {
    VirtualFile[] files=FileEditorManager.getInstance(myProject).getSelectedFiles();
    PsiFile psiFile=files.length != 0 ? PsiManager.getInstance(myProject).findFile(files[0]) : null;
    myStructureViewWrapper.setFileEditor(null);
  }
}
