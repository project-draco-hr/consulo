{
  AbstractProjectViewPane currentPane=getCurrentProjectViewPane();
  PsiElement selectedPsiElement=null;
  if (currentPane != null) {
    currentPane.saveExpandedPaths();
    Object selected=currentPane.getSelectedElement();
    if (selected instanceof PsiElement) {
      selectedPsiElement=(PsiElement)selected;
    }
    if (selected instanceof PackageElement) {
      PsiPackage psiPackage=((PackageElement)selected).getPackage();
      PsiDirectory[] directories=psiPackage.getDirectories();
      selectedPsiElement=directories.length == 0 ? null : directories[0];
    }
    currentPane.dispose();
  }
  myViewContentPanel.removeAll();
  JComponent component=newPane.createComponent();
  myViewContentPanel.setLayout(new BorderLayout());
  myViewContentPanel.add(component,BorderLayout.CENTER);
  myCurrentViewId=newPane.getId();
  myCurrentViewSubId=newPane.getSubId();
  myViewContentPanel.revalidate();
  myViewContentPanel.repaint();
  createToolbarActions();
  newPane.setTreeChangeListener(myTreeChangeListener);
  myAutoScrollToSourceHandler.install(newPane.myTree);
  newPane.getComponentToFocus().requestFocus();
  updateToolWindowTitle();
  showOrHideStructureView(isShowStructure());
  if (selectedPsiElement != null) {
    PsiFile containingFile=selectedPsiElement.getContainingFile();
    VirtualFile virtualFile=containingFile == null ? null : containingFile.getVirtualFile();
    if (selectedPsiElement instanceof PsiDirectory) {
      virtualFile=((PsiDirectory)selectedPsiElement).getVirtualFile();
    }
    newPane.select(selectedPsiElement,virtualFile,true);
  }
}
