{
  if (o1 instanceof PsiDirectoryNode != o2 instanceof PsiDirectoryNode) {
    return o1 instanceof PsiDirectoryNode ? -1 : 1;
  }
  if (o1 instanceof PackageElementNode != o2 instanceof PackageElementNode) {
    return o1 instanceof PackageElementNode ? -1 : 1;
  }
  if (isSortByType() && o1 instanceof ClassTreeNode != o2 instanceof ClassTreeNode) {
    return o1 instanceof ClassTreeNode ? -1 : 1;
  }
  if (isSortByType() && o1 instanceof ClassTreeNode && o2 instanceof ClassTreeNode) {
    final PsiClass aClass1=((ClassTreeNode)o1).getValue();
    final PsiClass aClass2=((ClassTreeNode)o2).getValue();
    int pos1=getClassPosition(aClass1);
    int pos2=getClassPosition(aClass2);
    final int result=pos1 - pos2;
    if (result != 0)     return result;
  }
 else   if (isSortByType() && o1 instanceof AbstractTreeNode && o2 instanceof AbstractTreeNode&& (o1 instanceof PsiFileNode || ((AbstractTreeNode)o1).getValue() instanceof ResourceBundle)&& (o2 instanceof PsiFileNode || ((AbstractTreeNode)o2).getValue() instanceof ResourceBundle)) {
    String type1=o1 instanceof PsiFileNode ? extension(((PsiFileNode)o1).getValue()) : PropertiesFileType.FILE_TYPE.getDefaultExtension();
    String type2=o2 instanceof PsiFileNode ? extension(((PsiFileNode)o2).getValue()) : PropertiesFileType.FILE_TYPE.getDefaultExtension();
    if (type1 != null && type2 != null) {
      int result=type1.compareTo(type2);
      if (result != 0)       return result;
    }
  }
  if (isAbbreviatePackageNames()) {
    if (o1 instanceof PsiDirectoryNode) {
      final PsiDirectory aDirectory1=((PsiDirectoryNode)o1).getValue();
      final PsiDirectory aDirectory2=((PsiDirectoryNode)o2).getValue();
      if (aDirectory1 != null && aDirectory2 != null) {
        final PsiPackage aPackage1=aDirectory1.getPackage();
        final PsiPackage aPackage2=aDirectory2.getPackage();
        if (aPackage1 != null && aPackage2 != null) {
          return aPackage1.getQualifiedName().compareToIgnoreCase(aPackage2.getQualifiedName());
        }
      }
    }
 else     if (o1 instanceof PackageElementNode) {
      final PackageElement packageElement1=((PackageElementNode)o1).getValue();
      final PackageElement packageElement2=((PackageElementNode)o2).getValue();
      if (packageElement1 != null && packageElement2 != null) {
        final PsiPackage aPackage1=packageElement1.getPackage();
        final PsiPackage aPackage2=packageElement2.getPackage();
        if (aPackage1 != null && aPackage2 != null) {
          return aPackage1.getQualifiedName().compareToIgnoreCase(aPackage2.getQualifiedName());
        }
      }
    }
  }
  return AlphaComparator.INSTANCE.compare(o1,o2);
}
