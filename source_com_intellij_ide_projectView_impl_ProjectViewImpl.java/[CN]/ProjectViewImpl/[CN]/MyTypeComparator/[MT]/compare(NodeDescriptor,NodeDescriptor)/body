{
  if (o1 instanceof PsiDirectoryNode != o2 instanceof PsiDirectoryNode) {
    return o1 instanceof PsiDirectoryNode ? -1 : 1;
  }
  if (isSortByType() && o1 instanceof ClassTreeNode != o2 instanceof ClassTreeNode) {
    return o1 instanceof ClassTreeNode ? -1 : 1;
  }
  if (isSortByType() && o1 instanceof ClassTreeNode && o2 instanceof ClassTreeNode) {
    final PsiClass aClass1=((ClassTreeNode)o1).getValue();
    final PsiClass aClass2=((ClassTreeNode)o2).getValue();
    int pos1=getClassPosition(aClass1);
    int pos2=getClassPosition(aClass2);
    final int result=pos1 - pos2;
    if (result != 0)     return result;
  }
 else   if (isSortByType() && o1 instanceof PsiFileNode && o2 instanceof PsiFileNode) {
    final PsiFile file1=((PsiFileNode)o1).getValue();
    final PsiFile file2=((PsiFileNode)o2).getValue();
    String type1=extension(file1);
    String type2=extension(file2);
    if (type1 != null && type2 != null) {
      return type1.compareTo(type2);
    }
  }
  return AlphaComparator.INSTANCE.compare(o1,o2);
}
