{
  final AbstractProjectViewPane viewPane=getCurrentProjectViewPane();
  if (viewPane == null)   return null;
  final Object[] elements=viewPane.getSelectedElements();
  ArrayList<Module> result=new ArrayList<Module>();
  for (int i=0; i < elements.length; i++) {
    Object element=elements[i];
    if (element instanceof Module) {
      result.add((Module)element);
    }
 else     if (element instanceof ModuleGroup) {
      Module[] modules=((ModuleGroup)element).modulesInGroup(myProject);
      result.addAll(Arrays.asList(modules));
    }
  }
  if (result.isEmpty()) {
    return null;
  }
 else {
    return result.toArray(new Module[result.size()]);
  }
}
