{
  final TypeConstraint[] constraints=GroovyExpectedTypesProvider.calculateTypeConstraints(literal);
  final String text=literal.getText();
  final Object value;
  if (text.startsWith("'''") || text.startsWith("\"\"\"")) {
    String string=((String)literal.getValue());
    LOG.assertTrue(string != null);
    string=string.replace("\n","\\n").replace("\r","\\r");
    value=string;
  }
 else {
    value=literal.getValue();
  }
  boolean isChar=false;
  for (  TypeConstraint constraint : constraints) {
    if (constraint instanceof SubtypeConstraint && TypesUtil.unboxPrimitiveTypeWrapper(constraint.getDefaultType()) == PsiType.CHAR) {
      isChar=true;
    }
  }
  if (isChar) {
    builder.append('\'').append(StringUtil.escapeQuotes(String.valueOf(value))).append('\'');
  }
 else   if (value instanceof String) {
    builder.append('"').append(StringUtil.escapeQuotes((String)value)).append('"');
  }
 else {
    builder.append(value);
  }
}
