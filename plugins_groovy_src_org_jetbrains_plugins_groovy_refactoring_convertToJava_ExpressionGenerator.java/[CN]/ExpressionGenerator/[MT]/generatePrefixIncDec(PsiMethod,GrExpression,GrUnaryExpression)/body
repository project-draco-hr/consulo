{
  if (!(operand instanceof GrReferenceExpression))   return false;
  final GrExpression qualifier=((GrReferenceExpression)operand).getQualifier();
  final GroovyResolveResult resolveResult=((GrReferenceExpression)operand).advancedResolve();
  final PsiElement resolved=resolveResult.getElement();
  if (resolved instanceof PsiMethod && GroovyPropertyUtils.isSimplePropertyGetter((PsiMethod)resolved)) {
    final PsiMethod getter=(PsiMethod)resolved;
    final String propertyName=GroovyPropertyUtils.getPropertyNameByGetter(getter);
    final PsiType type;
    if (qualifier == null) {
      type=null;
    }
 else {
      type=qualifier.getType();
      if (type == null)       return false;
    }
    final PsiMethod setter=GroovyPropertyUtils.findPropertySetter(type,propertyName,unary);
    if (setter == null)     return false;
    final ExpressionGenerator generator=new ExpressionGenerator(new StringBuilder(),context);
    if (shouldNotReplaceOperatorWithMethod(operand.getType(),null,unary.getOperationTokenType())) {
      writeSimpleUnary(operand,unary,generator);
    }
 else {
      generator.invokeMethodOn(method,operand,GrExpression.EMPTY_ARRAY,GrNamedArgument.EMPTY_ARRAY,EMPTY_ARRAY,resolveResult.getSubstitutor(),unary);
    }
    final GrExpression fromText=factory.createExpressionFromText(generator.toString(),unary);
    invokeMethodOn(setter,qualifier,new GrExpression[]{fromText},GrNamedArgument.EMPTY_ARRAY,EMPTY_ARRAY,resolveResult.getSubstitutor(),unary);
  }
 else   if (resolved instanceof PsiVariable) {
    boolean wrap=context.analyzedVars.toWrap((PsiVariable)resolved);
    boolean doNeedExpression=PsiUtil.isExpressionUsed(unary);
    StringBuilder curBuilder;
    ExpressionGenerator curGenerator;
    if (doNeedExpression && wrap) {
      curBuilder=new StringBuilder();
      curGenerator=new ExpressionGenerator(curBuilder,context);
    }
 else {
      curBuilder=builder;
      curGenerator=this;
    }
    boolean shouldInsertParentheses=!wrap && doNeedExpression;
    if (shouldInsertParentheses) {
      curBuilder.append('(');
    }
    operand.accept(curGenerator);
    if (wrap) {
      curBuilder.append(".set(");
    }
 else {
      curBuilder.append(" = ");
    }
    if (shouldNotReplaceOperatorWithMethod(operand.getType(),null,unary.getOperationTokenType())) {
      writeSimpleUnary((GrExpression)operand.copy(),unary,curGenerator);
    }
 else {
      curGenerator.invokeMethodOn(method,(GrExpression)operand.copy(),GrExpression.EMPTY_ARRAY,GrNamedArgument.EMPTY_ARRAY,EMPTY_ARRAY,resolveResult.getSubstitutor(),unary);
    }
    if (shouldInsertParentheses) {
      curBuilder.append(')');
    }
    if (wrap) {
      curBuilder.append(')');
      if (doNeedExpression) {
        curBuilder.append(';');
        context.myStatements.add(curBuilder.toString());
        operand.accept(this);
        builder.append(".get()");
      }
    }
  }
  return true;
}
