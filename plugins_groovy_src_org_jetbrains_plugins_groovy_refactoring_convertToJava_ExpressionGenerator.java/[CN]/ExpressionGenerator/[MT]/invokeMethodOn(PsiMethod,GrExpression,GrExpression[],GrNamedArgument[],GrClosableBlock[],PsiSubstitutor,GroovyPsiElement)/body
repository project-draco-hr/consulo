{
  if (method instanceof GrGdkMethod) {
    if (CustomMethodInvocator.invokeMethodOn(this,(GrGdkMethod)method,caller,exprs,namedArgs,closures,substitutor,context))     return;
    GrExpression[] newArgs=new GrExpression[exprs.length + 1];
    System.arraycopy(exprs,0,newArgs,1,exprs.length);
    if (method.hasModifierProperty(PsiModifier.STATIC)) {
      newArgs[0]=factory.createExpressionFromText("null");
    }
 else {
      if (caller == null) {
        caller=factory.createExpressionFromText("this",context);
      }
      newArgs[0]=caller;
    }
    invokeMethodOn(((GrGdkMethod)method).getStaticMethod(),null,newArgs,namedArgs,closures,substitutor,context);
    return;
  }
  if (method.hasModifierProperty(PsiModifier.STATIC) && caller == null) {
    final PsiClass containingClass=method.getContainingClass();
    if (containingClass != null && !PsiTreeUtil.isAncestor(containingClass,context,true)) {
      builder.append(containingClass.getQualifiedName()).append('.');
    }
  }
 else {
    if (caller != null) {
      final boolean castNeeded=isCastNeeded(caller,method,this.context);
      if (castNeeded) {
        builder.append('(');
        final PsiType type=caller.getType();
        builder.append('(');
        writeType(builder,type,context);
        builder.append(')');
      }
      caller.accept(this);
      if (castNeeded) {
        builder.append(')');
      }
      builder.append('.');
    }
  }
  builder.append(method.getName());
  final GrClosureSignature signature=GrClosureSignatureUtil.createSignature(method,substitutor);
  new ArgumentListGenerator(builder,this.context).generate(signature,exprs,namedArgs,closures,context);
}
