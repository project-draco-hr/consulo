{
  final Collection<File> skippedDirectories=new ArrayList<File>();
  for (  Change c : myChangesList) {
    final ContentRevision beforeRevision=c.getBeforeRevision();
    final ContentRevision afterRevision=c.getAfterRevision();
    if (beforeRevision != null && beforeRevision.getFile().isDirectory()) {
      skippedDirectories.add(beforeRevision.getFile().getIOFile());
    }
 else     if (afterRevision != null && afterRevision.getFile().isDirectory()) {
      skippedDirectories.add(afterRevision.getFile().getIOFile());
    }
  }
  final List<VirtualFile> paths=changeListManager.getAffectedFiles();
  for (  VirtualFile virtualFile : paths) {
    if (virtualFile.isDirectory() && (!existedDirs.contains(virtualFile)) && (skippedDirectories.contains(new File(virtualFile.getPath())))) {
      final Change change=changeListManager.getChange(virtualFile);
      if (change != null) {
        changes.add(change);
      }
    }
  }
}
