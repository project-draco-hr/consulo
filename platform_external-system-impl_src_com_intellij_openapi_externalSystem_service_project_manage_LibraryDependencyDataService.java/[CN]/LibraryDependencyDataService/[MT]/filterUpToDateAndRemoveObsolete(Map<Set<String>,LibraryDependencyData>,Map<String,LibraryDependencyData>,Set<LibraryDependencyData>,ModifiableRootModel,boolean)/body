{
  Set<String> moduleLibraryKey=ContainerUtilRt.newHashSet();
  for (  OrderEntry entry : moduleRootModel.getOrderEntries()) {
    if (entry instanceof ModuleLibraryOrderEntryImpl) {
      Library library=((ModuleLibraryOrderEntryImpl)entry).getLibrary();
      if (library == null) {
        LOG.warn("Skipping module-level library entry because it doesn't have backing Library object. Entry: " + entry);
        continue;
      }
      moduleLibraryKey.clear();
      for (      VirtualFile file : library.getFiles(OrderRootType.CLASSES)) {
        moduleLibraryKey.add(ExternalSystemApiUtil.getLocalFileSystemPath(file));
      }
      LibraryDependencyData existing=moduleLibrariesToImport.remove(moduleLibraryKey);
      if (existing == null) {
        moduleRootModel.removeOrderEntry(entry);
      }
 else {
        toImport.remove(existing);
      }
    }
 else     if (entry instanceof LibraryOrderEntry) {
      String libraryName=((LibraryOrderEntry)entry).getLibraryName();
      LibraryDependencyData existing=projectLibrariesToImport.remove(libraryName);
      if (existing != null) {
        toImport.remove(existing);
      }
 else       if (!hasUnresolvedLibraries) {
        moduleRootModel.removeOrderEntry(entry);
      }
    }
  }
}
