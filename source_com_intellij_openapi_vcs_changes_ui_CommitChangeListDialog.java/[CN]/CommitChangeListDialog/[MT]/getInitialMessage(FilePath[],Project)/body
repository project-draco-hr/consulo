{
  if (filesToCheckin != null) {
    for (    FilePath virtualFile : filesToCheckin) {
      AbstractVcs activeVcs=VcsUtil.getVcsFor(project,virtualFile);
      if (activeVcs == null)       continue;
      CheckinEnvironment checkinEnvironment=activeVcs.getCheckinEnvironment();
      if (checkinEnvironment != null) {
        String defaultMessage=checkinEnvironment.getDefaultMessageFor(filesToCheckin);
        if (defaultMessage != null)         return defaultMessage;
      }
    }
  }
  VcsConfiguration config=VcsConfiguration.getInstance(project);
  if (config.SAVE_LAST_COMMIT_MESSAGE || config.ERROR_OCCURED) {
    return config.LAST_COMMIT_MESSAGE;
  }
 else {
    return "";
  }
}
