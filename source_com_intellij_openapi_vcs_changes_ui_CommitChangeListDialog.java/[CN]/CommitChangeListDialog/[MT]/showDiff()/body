{
  final int leadSelectionIndex=myChangesList.getLeadSelectionIndex();
  final Change leadSelection=(Change)myChangesList.getModel().getElementAt(leadSelectionIndex);
  Change[] changes=getSelectedChanges();
  if (changes.length < 2) {
    final Collection<Change> displayedChanges=getCurrentDisplayedChanges();
    changes=displayedChanges.toArray(new Change[displayedChanges.size()]);
  }
  int indexInSelection=Arrays.asList(changes).indexOf(leadSelection);
  if (indexInSelection >= 0) {
    ShowDiffAction.showDiffForChange(changes,indexInSelection,myProject,createAdditionalActions());
  }
 else {
    ShowDiffAction.showDiffForChange(new Change[]{leadSelection},0,myProject,createAdditionalActions());
  }
}
