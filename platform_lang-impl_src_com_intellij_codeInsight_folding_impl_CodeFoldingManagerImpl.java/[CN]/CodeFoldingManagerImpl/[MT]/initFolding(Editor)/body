{
  final Document document=editor.getDocument();
  editor.getFoldingModel().runBatchFoldingOperation(new Runnable(){
    @Override public void run(){
      DocumentFoldingInfo documentFoldingInfo=getDocumentFoldingInfo(document);
      Editor[] editors=EditorFactory.getInstance().getEditors(document,myProject);
      for (      Editor otherEditor : editors) {
        if (otherEditor == editor || !isFoldingsInitializedInEditor(otherEditor))         continue;
        documentFoldingInfo.loadFromEditor(otherEditor);
        break;
      }
      documentFoldingInfo.setToEditor(editor);
      documentFoldingInfo.clear();
      editor.putUserData(FOLDING_STATE_KEY,Boolean.TRUE);
    }
  }
);
}
