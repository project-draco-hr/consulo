{
  LOG.debug("entered finish() on thread " + Thread.currentThread().getName());
  if (!rearrangementOccurred) {
    LOG.debug("no rearrangement occurred, not rearranging document");
    return;
  }
  LOG.debug("rearranging document");
  if (document != null) {
    final Emitter e=new Emitter(psiFile,resultRuleInstances,document);
    e.emitRearrangedDocument();
  }
  LiveRearrangerActionHandler.setInProgress(false);
  LOG.debug("exit finish() on thread " + Thread.currentThread().getName());
}
