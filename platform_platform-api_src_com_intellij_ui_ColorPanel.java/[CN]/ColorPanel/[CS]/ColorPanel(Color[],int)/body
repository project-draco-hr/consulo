{
  myBoxSize=boxSize;
  myFgSelectedColorBox=new ColorBox(null,(myBoxSize + 2) * 2,true);
  myFgSelectedColorBox.setSelectColorAction(new Runnable(){
    public void run(){
      fireActionEvent();
    }
  }
);
  myFgFixedColorBoxes=new ColorBox[16];
  myFixedGridLayout=new GridLayout(2,0,2,2);
  myCustomGridLayout=new GridLayout(2,0,2,2);
  myFgCustomColorBoxes=new ColorBox[8];
  if (colors == null) {
    if (myCustomColors == null) {
      myCustomColors=new Color[]{Color.lightGray,Color.lightGray,Color.lightGray,Color.lightGray,Color.lightGray,Color.lightGray,Color.lightGray,Color.lightGray};
    }
  }
 else {
    myCustomColors=colors;
  }
  JPanel selectedColorPanel=new JPanel(new GridBagLayout());
  selectedColorPanel.setBorder(BorderFactory.createEmptyBorder(4,4,4,4));
  myFgSelectedColorBox.setBorder(BorderFactory.createEtchedBorder());
  selectedColorPanel.add(myFgSelectedColorBox,new GridBagConstraints());
  initializeColorBoxes();
  JPanel fixedColorsPanel=new JPanel(myFixedGridLayout);
  for (int i=0; i < myFgFixedColorBoxes.length; i++) {
    JPanel jpanel2=new JPanel(new BorderLayout());
    jpanel2.setBorder(BorderFactory.createEtchedBorder());
    jpanel2.add(myFgFixedColorBoxes[i],BorderLayout.CENTER);
    fixedColorsPanel.add(jpanel2);
  }
  JPanel customColorsPanel=new JPanel(myCustomGridLayout);
  customColorsPanel.setBorder(BorderFactory.createCompoundBorder(IdeBorderFactory.createBorder(SideBorder.LEFT),BorderFactory.createEmptyBorder(0,2,0,0)));
  for (int k=0; k < myFgCustomColorBoxes.length; k++) {
    JPanel jpanel4=new JPanel(new BorderLayout());
    jpanel4.setBorder(BorderFactory.createEtchedBorder());
    jpanel4.add(myFgCustomColorBoxes[k],BorderLayout.CENTER);
    customColorsPanel.add(jpanel4);
  }
  JPanel allColorsPanel=new JPanel(new GridBagLayout());
  allColorsPanel.setBorder(BorderFactory.createEtchedBorder());
  allColorsPanel.add(fixedColorsPanel,new GridBagConstraints(1,0,1,1,0.1D,0.1D,10,0,new Insets(2,2,2,1),0,0));
  allColorsPanel.add(customColorsPanel,new GridBagConstraints(2,0,1,1,0.1D,0.1D,17,0,new Insets(2,2,2,2),0,0));
  setLayout(new BorderLayout());
  add(selectedColorPanel,BorderLayout.WEST);
  add(allColorsPanel,BorderLayout.CENTER);
}
