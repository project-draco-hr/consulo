{
  final PsiElement expressionParent=elementToReplace.getParent();
  if (expressionParent instanceof PsiParenthesizedExpression) {
    final PsiElement grandParent=expressionParent.getParent();
    if (replacementExpression == null || !(grandParent instanceof PsiExpression) || !ParenthesesUtils.areParenthesesNeeded(replacementExpression,(PsiExpression)grandParent)) {
      appendElementText(element,expressionParent,replacementExpression,out);
      return;
    }
  }
  appendElementText(element,elementToReplace,replacementExpression,out);
}
