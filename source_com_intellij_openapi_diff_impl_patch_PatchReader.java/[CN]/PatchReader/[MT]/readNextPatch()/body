{
  FilePatch curPatch=null;
  while (myLineIndex < myLines.length) {
    String curLine=myLines[myLineIndex];
    if (curLine.startsWith("--- ")) {
      if (curPatch != null) {
        return curPatch;
      }
      curPatch=new FilePatch();
      curPatch.setBeforeName(extractFileName(curLine));
      myLineIndex++;
      curLine=myLines[myLineIndex];
      if (!curLine.startsWith("+++ ")) {
        throw new PatchSyntaxException(myLineIndex,"Second file name expected");
      }
      curPatch.setAfterName(extractFileName(curLine));
      myLineIndex++;
      while (true) {
        PatchHunk hunk=readNextHunk();
        if (hunk == null)         break;
        curPatch.addHunk(hunk);
      }
    }
  }
  return curPatch;
}
