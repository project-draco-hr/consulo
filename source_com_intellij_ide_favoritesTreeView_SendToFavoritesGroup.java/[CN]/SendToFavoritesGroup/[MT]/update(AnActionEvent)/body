{
  Project project=(Project)e.getDataContext().getData(DataConstants.PROJECT);
  final FavoritesViewImpl favoritesView=FavoritesViewImpl.getInstance(project);
  final FavoritesTreeNodeDescriptor[] selectedNodeDescriptors=favoritesView.getCurrentTreeViewPanel().getSelectedNodeDescriptors();
  final String[] allAddActionNamesButThis=favoritesView.getAllAddActionNamesButThis();
  e.getPresentation().setEnabled(e.getPlace().equals(ActionPlaces.FAVORITES_VIEW_POPUP) && selectedNodeDescriptors != null && allAddActionNamesButThis != null);
  removeAll();
  for (int i=0; allAddActionNamesButThis != null && i < allAddActionNamesButThis.length; i++) {
    String addAction=allAddActionNamesButThis[i];
    add(new SendToFavoritesAction(addAction));
  }
  addSeparator();
  add(new SendToNewFavoritesListAction());
}
