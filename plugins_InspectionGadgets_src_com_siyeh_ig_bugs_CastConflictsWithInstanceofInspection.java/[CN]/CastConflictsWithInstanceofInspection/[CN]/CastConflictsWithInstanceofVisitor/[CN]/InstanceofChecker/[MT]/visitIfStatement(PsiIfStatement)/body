{
  final PsiStatement branch=ifStatement.getElseBranch();
  inElse=branch != null && PsiTreeUtil.isAncestor(branch,referenceExpression,true);
  if (inElse) {
    if (branch instanceof PsiBlockStatement) {
      final PsiBlockStatement blockStatement=(PsiBlockStatement)branch;
      if (isVariableAssignedBeforeReference(blockStatement)) {
        return;
      }
    }
  }
 else {
    final PsiStatement thenBranch=ifStatement.getThenBranch();
    if (thenBranch instanceof PsiBlockStatement) {
      final PsiBlockStatement blockStatement=(PsiBlockStatement)thenBranch;
      if (isVariableAssignedBeforeReference(blockStatement)) {
        return;
      }
    }
  }
  PsiExpression condition=ifStatement.getCondition();
  condition=PsiUtil.deparenthesizeExpression(condition);
  if (condition instanceof PsiBinaryExpression) {
    final PsiBinaryExpression binaryExpression=(PsiBinaryExpression)condition;
    visitBinaryExpression(binaryExpression);
  }
 else {
    checkExpression(condition);
  }
}
