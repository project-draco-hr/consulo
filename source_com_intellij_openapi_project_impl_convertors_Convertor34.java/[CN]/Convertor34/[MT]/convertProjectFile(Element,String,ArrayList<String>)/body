{
  Element rootComponent=null;
  List components=root.getChildren("component");
  for (  final Object component1 : components) {
    Element component=(Element)component1;
    if (isProjectRootManager(component))     rootComponent=component;
  }
  if (rootComponent == null)   return;
  Element module=createModule(root);
  final String moduleFilePath=filePath.substring(0,filePath.lastIndexOf('.')) + ".iml";
  Element moduleRootComponent=convertProjectRootManager(rootComponent,conversionProblems);
  module.addContent(moduleRootComponent);
  Document moduleDoc=new Document(module);
  try {
    JDOMUtil.writeDocument(moduleDoc,moduleFilePath,"\n");
  }
 catch (  IOException e) {
    LOG.error(e);
  }
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    public void run(){
      LocalFileSystem.getInstance().refreshAndFindFileByIoFile(new File(moduleFilePath));
    }
  }
);
  rootComponent.setAttribute("name","ProjectRootManager");
  rootComponent.setAttribute("version","4");
  Element moduleManager=new Element("component");
  moduleManager.setAttribute("name","ProjectModuleManager");
  addModule(moduleFilePath,moduleManager);
  String moduleFile=new File(moduleFilePath).getName();
  convertWebApps(moduleManager,root,rootComponent,moduleFile.substring(0,moduleFile.lastIndexOf('.')));
  root.addContent(moduleManager);
}
