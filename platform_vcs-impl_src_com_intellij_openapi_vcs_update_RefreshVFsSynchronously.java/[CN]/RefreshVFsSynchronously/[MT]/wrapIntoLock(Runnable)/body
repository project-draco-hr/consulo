{
  final ProgressIndicator indicator=ProgressManager.getInstance().getProgressIndicator();
  if (indicator != null) {
    indicator.startNonCancelableSection();
    indicator.setText(VcsBundle.message("progress.text.synchronizing.files"));
    indicator.setText2("");
  }
  final Semaphore semaphore=new Semaphore();
  semaphore.down();
  ApplicationManager.getApplication().invokeLater(new Runnable(){
    public void run(){
      try {
        runnable.run();
      }
  finally {
        semaphore.up();
      }
    }
  }
);
  semaphore.waitFor();
}
