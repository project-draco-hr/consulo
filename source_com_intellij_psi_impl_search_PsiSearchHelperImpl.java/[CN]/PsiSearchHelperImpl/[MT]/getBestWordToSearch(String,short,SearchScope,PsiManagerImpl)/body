{
  List<String> words=StringUtil.getWordsIn(text);
  String bestWord=null;
  int nFiles=Integer.MAX_VALUE;
  for (  String word : words) {
    boolean isBetter;
    if (searchScope instanceof GlobalSearchScope) {
      PsiFile[] files=manager.getCacheManager().getFilesWithWord(word,searchContext,(GlobalSearchScope)searchScope);
      isBetter=files.length < nFiles;
    }
 else {
      isBetter=bestWord == null || word.length() > bestWord.length();
    }
    if (isBetter) {
      bestWord=word;
    }
  }
  return bestWord;
}
