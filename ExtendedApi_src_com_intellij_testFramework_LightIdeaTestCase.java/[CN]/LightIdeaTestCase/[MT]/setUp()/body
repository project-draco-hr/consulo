{
  super.setUp();
  assertNull("Previous test " + ourTestCase + " haven't called tearDown(). Probably overriden without super call.",ourTestCase);
  IdeaLogger.ourErrorsOccurred=null;
  initApplication();
  if (ourProject == null || isJDKChanged()) {
    initProject();
  }
  final LocalInspectionTool[] tools=configureLocalInspectionTools();
  for (  LocalInspectionTool tool : tools) {
    myAvailableTools.put(tool.getShortName(),tool);
  }
  DaemonCodeAnalyzerSettings.getInstance().setInspectionProfile(new InspectionProfileImpl("Configurable"){
    public LocalInspectionTool[] getHighlightingLocalInspectionTools(){
      final Collection<LocalInspectionTool> tools=myAvailableTools.values();
      return tools.toArray(new LocalInspectionTool[tools.size()]);
    }
  }
);
  assertFalse(getPsiManager().isDisposed());
  CodeStyleSettingsManager.getInstance(getProject()).setTemporarySettings(new CodeStyleSettings());
}
