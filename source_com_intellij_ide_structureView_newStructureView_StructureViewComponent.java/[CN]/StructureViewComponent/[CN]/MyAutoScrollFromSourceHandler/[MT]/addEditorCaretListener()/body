{
  myEditorCaretListener=new CaretListener(){
    public void caretPositionChanged(    final CaretEvent e){
      Editor editor=e.getEditor();
      FileEditor fileEditor=getFileEditorForEditor(editor);
      scrollToElementAtCaret(fileEditor);
    }
    private FileEditor getFileEditorForEditor(    Editor editor){
      VirtualFile file=FileDocumentManager.getInstance().getFile(editor.getDocument());
      if (file == null)       return null;
      return FileEditorManager.getInstance(myProject).getSelectedEditor(file);
    }
  }
;
  EditorFactory.getInstance().getEventMulticaster().addCaretListener(myEditorCaretListener);
}
