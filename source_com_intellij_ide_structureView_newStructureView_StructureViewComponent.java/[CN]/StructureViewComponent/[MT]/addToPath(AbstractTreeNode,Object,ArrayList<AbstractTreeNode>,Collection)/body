{
  final Object rootValue=rootElement.getValue();
  if (rootValue instanceof TreeElement) {
    Object value=((StructureViewTreeElement)rootValue).getValue();
    if (processedElements.contains(value)) {
      return false;
    }
 else {
      processedElements.add(value);
    }
    if (Comparing.equal(value,element)) {
      result.add(0,rootElement);
      return true;
    }
  }
  Collection<AbstractTreeNode> children=rootElement.getChildren();
  for (Iterator<AbstractTreeNode> iterator=children.iterator(); iterator.hasNext(); ) {
    AbstractTreeNode child=iterator.next();
    if (addToPath(child,element,result,new HashSet())) {
      result.add(0,rootElement);
      return true;
    }
  }
  return false;
}
