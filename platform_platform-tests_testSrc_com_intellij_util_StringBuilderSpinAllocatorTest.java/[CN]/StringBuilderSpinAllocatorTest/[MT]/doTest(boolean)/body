{
  StringBuilder builder;
  int count=warmUp ? 1000 : 1000000;
  System.gc();
  System.runFinalization();
  TimeoutUtil.sleep(1000);
  long start=System.nanoTime();
  for (int i=0; i < count; ++i) {
    builder=new StringBuilder();
    builder.append(myStrings[i & 3]);
    builder.append(builder.toString());
  }
  long regularTime=(System.nanoTime() - start) / 1000;
  System.gc();
  System.runFinalization();
  TimeoutUtil.sleep(1000);
  start=System.nanoTime();
  for (int i=0; i < count; ++i) {
    builder=StringBuilderSpinAllocator.alloc();
    builder.append(myStrings[i & 3]);
    builder.append(builder.toString());
    StringBuilderSpinAllocator.dispose(builder);
  }
  long spinTime=(System.nanoTime() - start) / 1000;
  if (!warmUp) {
    System.out.println("StringBuilder regular allocations took: " + regularTime);
    System.out.println("StringBuilder spin allocations took: " + spinTime);
    assertTrue("regular:" + regularTime + "mks, spin:"+ spinTime+ "mks",spinTime < regularTime);
  }
}
