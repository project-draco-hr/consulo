{
  final Project project=myModel.getProject();
  final DirDiffElement element=myModel.getElementAt(myTable.getSelectedRow());
  if (element == null) {
    clearDiffPanel();
    return;
  }
  if (!force && myCurrentElement != null && (myCurrentElement == element.getSource() || myCurrentElement == element.getTarget())) {
    return;
  }
  clearDiffPanel();
  if (element.getType() == DType.CHANGED) {
    myDiffPanelComponent=element.getSource().getDiffComponent(element.getTarget(),project,myDiffWindow.getWindow());
    if (myDiffPanelComponent != null) {
      myDiffPanel.add(myDiffPanelComponent,BorderLayout.CENTER);
      myCurrentElement=element.getSource();
    }
 else {
      myDiffPanel.add(getErrorLabel(),BorderLayout.CENTER);
      myDiffPanel.revalidate();
      myDiffPanel.repaint();
    }
  }
 else {
    final DiffElement object;
    if (element.getType() == DType.ERROR) {
      object=element.getSource() == null ? element.getTarget() : element.getSource();
    }
 else {
      object=element.isSource() ? element.getSource() : element.getTarget();
    }
    myViewComponent=object.getViewComponent(project,null);
    if (myViewComponent != null) {
      myCurrentElement=object;
      myDiffPanel.add(myViewComponent,BorderLayout.CENTER);
      DataManager.registerDataProvider(myDiffPanel,myCurrentElement.getDataProvider(project));
      myDiffPanel.revalidate();
      myDiffPanel.repaint();
    }
 else {
      myDiffPanel.add(getErrorLabel(),BorderLayout.CENTER);
      myDiffPanel.revalidate();
      myDiffPanel.repaint();
    }
  }
}
