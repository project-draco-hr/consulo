{
  PsiType lType=declaredElement.getType();
  final PsiExpression initializer=declaredElement.getInitializer();
  if (initializer instanceof PsiNewExpression) {
    final PsiNewExpression newExpression=(PsiNewExpression)initializer;
    final PsiJavaCodeReferenceElement classReference=newExpression.getClassOrAnonymousClassReference();
    if (classReference != null) {
      final String text=classReference.getReferenceName();
      if (text != null) {
        final PsiClass psiClass=JavaPsiFacade.getInstance(declaredElement.getProject()).getResolveHelper().resolveReferencedClass(text,initializer);
        final PsiType substitute=substitute(psiClass,lType);
        if (substitute != null) {
          lType=substitute;
        }
      }
    }
  }
  return getComponentTypes(lType);
}
