{
  startNewWorkerThread();
  try {
    process.run();
  }
  finally {
    final WorkerThread thread=(WorkerThread)Thread.currentThread();
    LOG.debug("Switching back to " + thread);
    super.invokeAndWait(new DebuggerCommandImpl(){
      protected void action() throws Exception {
        switchToThread(thread);
      }
      protected void commandCancelled(){
        LOG.debug("Event queue was closed, killing thread");
        thread.interrupt();
      }
    }
,NORMAL_PRIORITY);
  }
}
