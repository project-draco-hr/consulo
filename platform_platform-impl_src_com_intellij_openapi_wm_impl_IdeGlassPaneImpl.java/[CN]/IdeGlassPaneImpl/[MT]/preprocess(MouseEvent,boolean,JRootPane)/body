{
  try {
    final MouseEvent event=convertEvent(e,eventRootPane);
    if (!IdeGlassPaneUtil.canBePreprocessed(e)) {
      return false;
    }
    Component c=SwingUtilities.getDeepestComponentAt(e.getComponent(),e.getX(),e.getY());
    Balloon balloon=JBPopupFactory.getInstance().getParentBalloonFor(c);
    if (balloon != null && myLastRedispatchedEvent != e) {
      if (e.getID() == MouseEvent.MOUSE_PRESSED && IdeTooltipManager.getInstance().hasCurrent() && IdeTooltipManager.getInstance().hideCurrent(event,null,null,false)) {
        SwingUtilities.invokeLater(new Runnable(){
          @Override public void run(){
            myLastRedispatchedEvent=e;
            IdeEventQueue.getInstance().dispatchEvent(e);
          }
        }
);
      }
      return false;
    }
    myLastRedispatchedEvent=null;
    for (    EventListener each : mySortedMouseListeners) {
      if (motion && each instanceof MouseMotionListener) {
        fireMouseMotion((MouseMotionListener)each,event);
      }
 else       if (!motion && each instanceof MouseListener) {
        fireMouseEvent((MouseListener)each,event);
      }
      if (event.isConsumed()) {
        e.consume();
        return true;
      }
    }
    return false;
  }
  finally {
    if (eventRootPane == myRootPane) {
      Cursor cursor;
      if (!myListener2Cursor.isEmpty()) {
        cursor=myListener2Cursor.values().iterator().next();
        final Point point=SwingUtilities.convertPoint(e.getComponent(),e.getPoint(),myRootPane.getContentPane());
        Component target=SwingUtilities.getDeepestComponentAt(myRootPane.getContentPane().getParent(),point.x,point.y);
        if (canProcessCursorFor(target)) {
          target=getCompWithCursor(target);
          restoreLastComponent(target);
          if (target != null) {
            if (myLastCursorComponent != target) {
              myLastCursorComponent=target;
              myLastOriginalCursor=target.getCursor();
            }
            if (cursor != null && !cursor.equals(target.getCursor())) {
              target.setCursor(cursor);
            }
          }
          getRootPane().setCursor(cursor);
        }
      }
 else {
        cursor=Cursor.getDefaultCursor();
        getRootPane().setCursor(cursor);
        restoreLastComponent(null);
        myLastOriginalCursor=null;
        myLastCursorComponent=null;
      }
      myListener2Cursor.clear();
    }
  }
}
