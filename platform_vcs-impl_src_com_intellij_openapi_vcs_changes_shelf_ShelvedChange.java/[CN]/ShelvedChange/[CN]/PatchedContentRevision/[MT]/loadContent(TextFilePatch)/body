{
  if (patch.isNewFile()) {
    return patch.getNewFileText();
  }
  if (patch.isDeletedFile()) {
    return null;
  }
  final GenericPatchApplier applier=new GenericPatchApplier(getBaseContent(),patch.getHunks());
  if (applier.execute()) {
    return applier.getAfter();
  }
  throw new ApplyPatchException("Apply patch conflict");
}
