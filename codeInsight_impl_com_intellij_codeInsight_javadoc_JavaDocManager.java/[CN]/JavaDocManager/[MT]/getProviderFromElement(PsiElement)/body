{
  SmartPsiElementPointer originalElementPointer=element != null ? element.getUserData(ORIGINAL_ELEMENT_KEY) : null;
  PsiElement originalElement=originalElementPointer != null ? originalElementPointer.getElement() : null;
  PsiFile containingFile=originalElement != null ? originalElement.getContainingFile() : element != null ? element.getContainingFile() : null;
  DocumentationProvider originalProvider=containingFile != null ? containingFile.getLanguage().getDocumentationProvider() : null;
  DocumentationProvider elementProvider=element == null ? null : element.getLanguage().getDocumentationProvider();
  if (elementProvider == null || (elementProvider instanceof XmlDocumentationProvider && originalProvider != null)) {
    return originalProvider;
  }
  return elementProvider;
}
