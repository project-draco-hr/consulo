{
  Component parent=UIUtil.findUltimateParent(e.getComponent());
  JRootPane root=null;
  if (parent instanceof JWindow) {
    root=((JWindow)parent).getRootPane();
  }
 else   if (parent instanceof JDialog) {
    root=((JDialog)parent).getRootPane();
  }
 else   if (parent instanceof JFrame) {
    root=((JFrame)parent).getRootPane();
  }
  return root;
}
