{
  final Project project=e.getData(CommonDataKeys.PROJECT);
  if (project == null)   return false;
  if (!ProjectLevelVcsManager.getInstance(project).hasActiveVcss())   return false;
  final List<VirtualFile> unversionedFiles=e.getData(ChangesListView.UNVERSIONED_FILES_DATA_KEY);
  if (unversionedFiles != null && (!unversionedFiles.isEmpty()))   return true;
  final boolean hasChangedOrUnversionedFiles=SelectedFilesHelper.hasChangedOrUnversionedFiles(project,e);
  if (hasChangedOrUnversionedFiles)   return true;
  Change[] changes=e.getData(VcsDataKeys.CHANGES);
  if (changes != null && changes.length > 0) {
    return true;
  }
  final VirtualFile[] files=e.getData(CommonDataKeys.VIRTUAL_FILE_ARRAY);
  return files != null && files.length > 0;
}
