{
  File localRoot=getLocalRootFor(root);
  File adminRoot=getAdminRootFor(root);
  LOG.assertTrue(localRoot != null,getClass().getName());
  LOG.assertTrue(adminRoot != null,getClass().getName());
  return new ClientEnvironment(connection,localRoot,adminRoot,root.getCvsRoot(),createLocalFileReader(),createLocalFileWriter(root.getCvsRootAsString(),mergedFilesCollector,cvsExecutionEnv),myAdminReader,myAdminWriter,getIgnoreFileFilter(),new FileReadOnlyHandler(),CvsApplicationLevelConfiguration.getCharset());
}
