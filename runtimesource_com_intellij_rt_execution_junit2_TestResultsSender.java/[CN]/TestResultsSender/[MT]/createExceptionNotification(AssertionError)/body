{
  if (assertion instanceof KnownException)   return ((KnownException)assertion).getPacketFactory();
  if (assertion instanceof ComparisonFailure || assertion instanceof org.junit.ComparisonFailure) {
    return ComparisonDetailsExtractor.create(assertion);
  }
  return new ExceptionPacketFactory(PoolOfTestStates.FAILED_INDEX,assertion);
}
