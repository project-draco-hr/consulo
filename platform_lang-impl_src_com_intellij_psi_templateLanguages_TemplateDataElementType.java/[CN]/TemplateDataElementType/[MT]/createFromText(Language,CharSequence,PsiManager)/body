{
  @NonNls final LightVirtualFile virtualFile=new LightVirtualFile("foo",createTemplateFakeFileType(language),text,LocalTimeCounter.currentTime());
  FileViewProvider viewProvider=new SingleRootFileViewProvider(manager,virtualFile,false){
    @Override @NotNull public Language getBaseLanguage(){
      return language;
    }
  }
;
  return viewProvider.getPsi(language);
}
