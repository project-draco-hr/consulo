{
  final PsiType castType=expression.getType();
  if (!ClassUtils.isPrimitiveNumericType(castType)) {
    return;
  }
  final PsiExpression operand=expression.getOperand();
  if (operand == null) {
    return;
  }
  final PsiType operandType=operand.getType();
  if (!ClassUtils.isPrimitiveNumericType(operandType)) {
    return;
  }
  if (hasLowerPrecision(operandType,castType)) {
    return;
  }
  final PsiManager manager=expression.getManager();
  final PsiConstantEvaluationHelper evaluationHelper=manager.getConstantEvaluationHelper();
  Object result=evaluationHelper.computeConstantExpression(operand);
  if (result instanceof Character) {
    result=Integer.valueOf(((Character)result).charValue());
  }
  if (result instanceof Number) {
    final Number number=(Number)result;
    if (valueIsContainableType(number,castType)) {
      return;
    }
  }
  final PsiTypeElement castTypeElement=expression.getCastType();
  if (castTypeElement == null) {
    return;
  }
  registerError(castTypeElement,operandType);
}
