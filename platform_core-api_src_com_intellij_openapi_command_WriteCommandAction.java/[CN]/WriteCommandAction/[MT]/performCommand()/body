{
  final RunResult[] results={new RunResult<T>(this)};
  final Ref<Throwable> exception=new Ref<Throwable>();
  CommandProcessor.getInstance().executeCommand(myProject,new Runnable(){
    @Override public void run(){
      if (isGlobalUndoAction())       CommandProcessor.getInstance().markCurrentCommandAsGlobal(myProject);
      exception.set(results[0].run().getThrowable());
      results[0]=null;
    }
  }
,getCommandName(),getGroupID(),getUndoConfirmationPolicy());
  Throwable throwable=exception.get();
  if (throwable != null)   throw throwable;
}
