{
  myProject=project;
  myContextManager=contextManager;
  myChangeListManager=changeListManager;
  myChangeListListener=new ChangeListAdapter(){
    @Override public void changeListAdded(    ChangeList list){
      getOpenChangelists(myActiveTask).add(new ChangeListInfo((LocalChangeList)list));
    }
    @Override public void changeListRemoved(    ChangeList list){
      getOpenChangelists(myActiveTask).remove(new ChangeListInfo((LocalChangeList)list));
    }
    @Override public void defaultListChanged(    ChangeList oldDefaultList,    ChangeList newDefaultList){
      final LocalTask associatedTask=getAssociatedTask((LocalChangeList)newDefaultList);
      if (associatedTask != null) {
        ApplicationManager.getApplication().invokeLater(new Runnable(){
          public void run(){
            associatedTask.setUpdated(new Date());
            activateTask(associatedTask,true,false);
          }
        }
,myProject.getDisposed());
        return;
      }
      final LocalTask task=findTaskByChangelist(newDefaultList);
      if (task != null) {
        ApplicationManager.getApplication().invokeLater(new Runnable(){
          public void run(){
            saveActiveTask();
            doActivate(task,true);
          }
        }
,myProject.getDisposed());
      }
    }
  }
;
}
