{
  TaskRepository first=ContainerUtil.find(getAllRepositories(),new Condition<TaskRepository>(){
    public boolean value(    TaskRepository repository){
      return repository.isConfigured();
    }
  }
);
  if (first == null) {
    myIssueCache.clear();
    if (onComplete != null) {
      onComplete.run();
    }
    return;
  }
  myUpdating=true;
  ApplicationManager.getApplication().executeOnPooledThread(new Runnable(){
    public void run(){
      try {
        List<Task> issues=getIssuesFromRepositories(null,myConfig.updateIssuesCount,0,false);
synchronized (myIssueCache) {
          myIssueCache.clear();
          for (          Task issue : issues) {
            myIssueCache.put(issue.getId(),issue);
          }
        }
synchronized (myTasks) {
          for (Iterator<Map.Entry<String,LocalTaskImpl>> it=myTasks.entrySet().iterator(); it.hasNext(); ) {
            Map.Entry<String,LocalTaskImpl> entry=it.next();
            Task issue=myIssueCache.get(entry.getKey());
            if (issue != null) {
              if (issue.isClosed()) {
                it.remove();
              }
 else {
                entry.getValue().updateFromIssue(issue);
              }
            }
          }
        }
      }
  finally {
        if (onComplete != null) {
          onComplete.run();
        }
        myUpdating=false;
      }
    }
  }
);
}
