{
  if (!ApplicationManager.getApplication().isUnitTestMode()) {
    myCacheRefreshTimer=UIUtil.createNamedTimer("TaskManager refresh",myConfig.updateInterval * 60 * 1000,new ActionListener(){
      public void actionPerformed(      ActionEvent e){
        if (myConfig.updateEnabled && !myUpdating) {
          updateIssues(null);
        }
      }
    }
);
    myCacheRefreshTimer.setInitialDelay(0);
    StartupManager.getInstance(myProject).registerStartupActivity(new Runnable(){
      public void run(){
        myCacheRefreshTimer.start();
      }
    }
);
  }
  LocalTaskImpl defaultTask=myTasks.get(LocalTaskImpl.DEFAULT_TASK_ID);
  if (defaultTask == null) {
    defaultTask=createDefaultTask();
    addTask(defaultTask);
  }
  LocalChangeList defaultList=myChangeListManager.findChangeList(LocalChangeList.DEFAULT_NAME);
  if (defaultList != null) {
    ChangeListInfo listInfo=new ChangeListInfo(defaultList);
    if (!defaultTask.getChangeLists().contains(listInfo)) {
      defaultTask.addChangelist(listInfo);
    }
  }
  for (  LocalTaskImpl localTask : getLocalTasks()) {
    for (Iterator<ChangeListInfo> iterator=localTask.getChangeLists().iterator(); iterator.hasNext(); ) {
      final ChangeListInfo changeListInfo=iterator.next();
      if (myChangeListManager.getChangeList(changeListInfo.id) == null) {
        iterator.remove();
      }
    }
  }
  doActivate(myActiveTask,false);
  myChangeListManager.addChangeListListener(myChangeListListener);
}
