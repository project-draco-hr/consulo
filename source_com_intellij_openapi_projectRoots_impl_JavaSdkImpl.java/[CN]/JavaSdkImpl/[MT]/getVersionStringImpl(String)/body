{
  if (homePath == null || !new File(homePath).exists()) {
    return null;
  }
  final String[] versionString=new String[1];
  try {
    Process process=Runtime.getRuntime().exec(new String[]{homePath + File.separator + "bin"+ File.separator+ "java","-version"});
    VersionParsingThread parsingThread=new VersionParsingThread(process.getErrorStream(),versionString);
    parsingThread.start();
    ReadStreamThread readThread=new ReadStreamThread(process.getInputStream());
    readThread.start();
    try {
      try {
        process.waitFor();
      }
 catch (      InterruptedException e) {
        e.printStackTrace();
        process.destroy();
      }
    }
  finally {
      try {
        parsingThread.join();
      }
 catch (      InterruptedException e) {
        e.printStackTrace();
      }
    }
  }
 catch (  IOException ex) {
    ex.printStackTrace();
  }
  return versionString[0];
}
