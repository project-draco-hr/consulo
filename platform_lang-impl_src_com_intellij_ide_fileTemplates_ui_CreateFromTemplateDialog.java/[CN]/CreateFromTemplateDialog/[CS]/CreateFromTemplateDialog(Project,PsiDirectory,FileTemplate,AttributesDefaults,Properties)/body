{
  super(project,true);
  myDirectory=directory;
  myProject=project;
  myTemplate=template;
  setTitle(IdeBundle.message("title.new.from.template",template.getName()));
  myDefaultProperties=defaultProperties == null ? FileTemplateManager.getInstance().getDefaultProperties() : defaultProperties;
  FileTemplateUtil.fillDefaultProperties(myDefaultProperties,directory);
  boolean mustEnterName=!myTemplate.isTemplateOfType(StdFileTypes.JAVA);
  if (attributesDefaults != null && attributesDefaults.isFixedName()) {
    myDefaultProperties.setProperty(FileTemplate.ATTRIBUTE_NAME,attributesDefaults.getDefaultFileName());
    mustEnterName=false;
  }
  String[] unsetAttributes=null;
  try {
    unsetAttributes=myTemplate.getUnsetAttributes(myDefaultProperties);
  }
 catch (  ParseException e) {
    showErrorDialog(e);
  }
  if (unsetAttributes != null) {
    myAttrPanel=new CreateFromTemplatePanel(unsetAttributes,mustEnterName,attributesDefaults);
    myAttrComponent=myAttrPanel.getComponent();
    init();
  }
 else {
    myAttrPanel=null;
    myAttrComponent=null;
  }
}
