{
  Set<T> result=new HashSet<T>();
  final Set<T> vertices=graph.getVertices();
  boolean anyChanged;
  do {
    anyChanged=false;
    for (    T currentVertex : vertices) {
      if (!result.contains(currentVertex)) {
        if (!initialRelation.value(currentVertex)) {
          Set<T> targets=graph.getTargets(currentVertex);
          for (          T currentTarget : targets) {
            if (result.contains(currentTarget) || initialRelation.value(currentTarget)) {
              result.add(currentVertex);
              anyChanged=true;
              break;
            }
          }
        }
 else {
          result.add(currentVertex);
        }
      }
    }
  }
 while (anyChanged);
  return result;
}
