{
  if (element instanceof PsiMetaBaseOwner) {
    final PsiMetaBaseOwner psiMetaBaseOwner=(PsiMetaBaseOwner)element;
    final PsiMetaDataBase metaData=psiMetaBaseOwner.getMetaData();
    if (metaData != null) {
      return metaData.getName();
    }
  }
  if (element instanceof PsiDirectory) {
    final PsiPackage aPackage=((PsiDirectory)element).getPackage();
    if (aPackage != null)     element=aPackage;
  }
  if (element instanceof PsiPackage) {
    return nonJava ? ((PsiPackage)element).getQualifiedName() : ((PsiPackage)element).getName();
  }
 else   if (element instanceof PsiClass) {
    return nonJava ? ((PsiClass)element).getQualifiedName() : ((PsiClass)element).getName();
  }
 else   if (element instanceof XmlTag) {
    return ((XmlTag)element).getValue().getTrimmedText();
  }
 else   if (element instanceof XmlAttribute) {
    return ((XmlAttribute)element).getValue();
  }
 else   if (element instanceof PsiMember) {
    PsiMember member=(PsiMember)element;
    String name=member.getName();
    if (name == null)     return null;
    if (!nonJava) {
      return name;
    }
    PsiClass containingClass=member.getContainingClass();
    if (containingClass == null || containingClass.getQualifiedName() == null)     return null;
    return containingClass.getQualifiedName() + "." + name;
  }
 else   if (element instanceof PsiNamedElement) {
    return ((PsiNamedElement)element).getName();
  }
 else {
    LOG.error("Unknown element type: " + element);
    return null;
  }
}
