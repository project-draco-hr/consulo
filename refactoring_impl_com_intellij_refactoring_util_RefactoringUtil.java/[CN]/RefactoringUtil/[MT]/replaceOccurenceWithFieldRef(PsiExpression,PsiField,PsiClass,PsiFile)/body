{
  final PsiManager manager=occurrence.getManager();
  final String fieldName=newField.getName();
  final JavaPsiFacade facade=JavaPsiFacade.getInstance(manager.getProject());
  final PsiVariable psiVariable=facade.getResolveHelper().resolveReferencedVariable(fieldName,occurrence);
  final PsiElementFactory factory=facade.getElementFactory();
  final PsiElement element=occurrence.getUserData(ElementToWorkOn.PARENT);
  if (psiVariable != null && psiVariable.equals(newField) || PsiUtil.isAccessible(newField,element != null ? element : occurrence,null)) {
    return IntroduceVariableBase.replace(occurrence,factory.createExpressionFromText(fieldName,null),file);
  }
 else {
    final PsiReferenceExpression ref=(PsiReferenceExpression)factory.createExpressionFromText("this." + fieldName,null);
    if (newField.hasModifierProperty(PsiModifier.STATIC)) {
      ref.setQualifierExpression(factory.createReferenceExpression(destinationClass));
    }
    return IntroduceVariableBase.replace(occurrence,ref,file);
  }
}
