{
  final PsiManager manager=occurrence.getManager();
  final String fieldName=newField.getName();
  final JavaPsiFacade facade=JavaPsiFacade.getInstance(manager.getProject());
  final PsiVariable psiVariable=facade.getResolveHelper().resolveReferencedVariable(fieldName,occurrence);
  final PsiElementFactory factory=facade.getElementFactory();
  if (psiVariable != null && psiVariable.equals(newField)) {
    return occurrence.replace(factory.createExpressionFromText(fieldName,null));
  }
 else {
    final PsiReferenceExpression ref=(PsiReferenceExpression)factory.createExpressionFromText("this." + fieldName,null);
    if (newField.hasModifierProperty(PsiModifier.STATIC)) {
      ref.setQualifierExpression(factory.createReferenceExpression(destinationClass));
    }
    return occurrence.replace(ref);
  }
}
