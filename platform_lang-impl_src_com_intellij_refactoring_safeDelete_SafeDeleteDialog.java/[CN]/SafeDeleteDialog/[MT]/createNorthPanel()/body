{
  final JPanel panel=new JPanel(new GridBagLayout());
  final GridBagConstraints gbc=new GridBagConstraints();
  final String promptKey=isDelete() ? "prompt.delete.elements" : "search.for.usages.and.delete.elements";
  final String warningMessage=DeleteUtil.generateWarningMessage(IdeBundle.message(promptKey),myElements);
  gbc.insets=new Insets(4,8,4,8);
  gbc.weighty=1;
  gbc.weightx=1;
  gbc.gridx=0;
  gbc.gridy=0;
  gbc.gridwidth=2;
  gbc.fill=GridBagConstraints.BOTH;
  gbc.anchor=GridBagConstraints.WEST;
  panel.add(new JLabel(warningMessage),gbc);
  if (isDelete()) {
    gbc.gridy++;
    gbc.gridx=0;
    gbc.weightx=0.0;
    gbc.gridwidth=1;
    gbc.insets=new Insets(4,8,0,8);
    myCbSafeDelete=new JCheckBox(IdeBundle.message("checkbox.safe.delete.with.usage.search"));
    panel.add(myCbSafeDelete,gbc);
    myCbSafeDelete.addActionListener(new ActionListener(){
      @Override public void actionPerformed(      ActionEvent e){
        updateControls(myCbSearchInComments);
        updateControls(myCbSearchTextOccurrences);
      }
    }
);
  }
  gbc.gridy++;
  gbc.gridx=0;
  gbc.weightx=0.0;
  gbc.gridwidth=1;
  myCbSearchInComments=new StateRestoringCheckBox();
  myCbSearchInComments.setText(RefactoringBundle.getSearchInCommentsAndStringsText());
  panel.add(myCbSearchInComments,gbc);
  if (needSearchForTextOccurrences()) {
    gbc.gridx++;
    myCbSearchTextOccurrences=new StateRestoringCheckBox();
    myCbSearchTextOccurrences.setText(RefactoringBundle.getSearchForTextOccurrencesText());
    panel.add(myCbSearchTextOccurrences,gbc);
  }
  final RefactoringSettings refactoringSettings=RefactoringSettings.getInstance();
  if (myCbSafeDelete != null) {
    myCbSafeDelete.setSelected(refactoringSettings.SAFE_DELETE_WHEN_DELETE);
  }
  myCbSearchInComments.setSelected(myDelegate != null ? myDelegate.isToSearchInComments(myElements[0]) : refactoringSettings.SAFE_DELETE_SEARCH_IN_COMMENTS);
  if (myCbSearchTextOccurrences != null) {
    myCbSearchTextOccurrences.setSelected(myDelegate != null ? myDelegate.isToSearchForTextOccurrences(myElements[0]) : refactoringSettings.SAFE_DELETE_SEARCH_IN_NON_JAVA);
  }
  updateControls(myCbSearchTextOccurrences);
  updateControls(myCbSearchInComments);
  return panel;
}
