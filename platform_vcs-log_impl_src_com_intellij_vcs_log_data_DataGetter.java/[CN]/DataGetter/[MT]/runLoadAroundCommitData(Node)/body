{
  int rowIndex=node.getRowIndex();
  List<Node> nodes=new ArrayList<Node>();
  long taskNumber=myCurrentTaskIndex++;
  for (int i=rowIndex - UP_PRELOAD_COUNT; i < rowIndex + DOWN_PRELOAD_COUNT; i++) {
    Node commitNode=getCommitNodeInRow(i);
    if (commitNode != null) {
      nodes.add(commitNode);
      Hash hash=commitNode.getCommitHash();
      if (!myCache.isKeyCached(hash)) {
        myCache.put(hash,(T)new LoadingDetails(hash,taskNumber,commitNode.getBranch().getRepositoryRoot()));
      }
    }
  }
  TaskDescriptor task=new TaskDescriptor(nodes,taskNumber);
  myLoader.addFirst(task);
  return task;
}
