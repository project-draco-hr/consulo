{
  final String fileName=file.getName();
  if (file.getParent().getName().equals(".idea") && fileName.equals("workspace.xml")) {
    ProjectTemplateComponent[] components=project.getComponents(ProjectTemplateComponent.class);
    List<ProjectTemplateComponent> componentList=ContainerUtil.filter(components,new Condition<ProjectTemplateComponent>(){
      @Override public boolean value(      ProjectTemplateComponent component){
        return fileName.equals(component.getStorageFile());
      }
    }
);
    if (!componentList.isEmpty()) {
      Element root=new Element("project");
      for (      final ProjectTemplateComponent component : componentList) {
        final Element element=new Element("component");
        root.addContent(element);
        UIUtil.invokeAndWaitIfNeeded(new Runnable(){
          @Override public void run(){
            try {
              ((JDOMExternalizable)component).writeExternal(element);
            }
 catch (            WriteExternalException ignore) {
              LOG.error(ignore);
            }
          }
        }
);
      }
      return JDOMUtil.writeElement(root);
    }
  }
  return null;
}
