{
  LOG.assertTrue(child.getTreeParent() == myParent);
  int oldOffsetInParent=0;
{
    ASTNode current=child.getTreeParent().getFirstChildNode();
    while (current != child) {
      if (!myChanges.containsKey(current))       oldOffsetInParent+=current.getTextLength();
      current=current.getTreeNext();
    }
  }
  final ASTNode lastChangedElementBeforeChild;
{
    ASTNode current=myParent.getFirstChildNode();
    ASTNode lastChanged=null;
    while (current != child) {
      if (myChanges.containsKey(child))       lastChanged=current;
      current=current.getTreeNext();
    }
    lastChangedElementBeforeChild=lastChanged;
  }
  for (  Pair<ASTNode,Integer> offset : myOffsets) {
    if (offset.getSecond() > oldOffsetInParent)     break;
    final ASTNode changedNode=offset.getFirst();
    if (changedNode == lastChangedElementBeforeChild)     break;
    final ChangeInfo change=getChangeByChild(changedNode);
    oldOffsetInParent+=change.getOldLength();
  }
  return oldOffsetInParent;
}
