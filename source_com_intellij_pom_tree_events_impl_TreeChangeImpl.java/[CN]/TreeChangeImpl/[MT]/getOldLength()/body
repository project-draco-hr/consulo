{
  int oldLength=TreeUtil.getNotCachedLength(myParent);
  for (  final Map.Entry<ASTNode,ChangeInfo> entry : myChanges.entrySet()) {
    final ASTNode key=entry.getKey();
    final ChangeInfo change=entry.getValue();
    final int length=TreeUtil.getNotCachedLength(key);
switch (change.getChangeType()) {
case ChangeInfo.ADD:
      oldLength-=length;
    break;
case ChangeInfo.REMOVED:
  oldLength+=length;
break;
case ChangeInfo.REPLACE:
case ChangeInfo.CONTENTS_CHANGED:
oldLength+=change.getOldLength() - length;
break;
}
}
return oldLength;
}
