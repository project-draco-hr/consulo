{
  LOG.info(commandLine.getCommandLineString());
  OSProcessHandler handler=new OSProcessHandler(commandLine.createProcess(),"");
  final StringBuffer buffer=new StringBuffer();
  final ProcessAdapter listener=new ProcessAdapter(){
    public void onTextAvailable(    final ProcessEvent event,    final Key outputType){
      buffer.append(event.getText());
    }
  }
;
  if (timeout == null || timeout > 0) {
    handler.addProcessListener(listener);
  }
  handler.startNotify();
  try {
    if (timeout != null) {
      if (timeout > 0) {
        handler.waitFor(timeout);
      }
    }
 else {
      handler.waitFor();
    }
  }
 catch (  ProcessCanceledException e) {
    return ExecutionStatus.ERROR;
  }
  if (!handler.isProcessTerminated()) {
    return ExecutionStatus.TIMEOUT;
  }
  if (timeout == null || timeout > 0) {
    handler.removeProcessListener(listener);
    final String message=buffer.toString();
    messageBuilder.append(message);
    LOG.info(message);
  }
  int exitCode=handler.getProcess().exitValue();
  return exitCode == 0 ? ExecutionStatus.SUCCESS : ExecutionStatus.ERROR;
}
