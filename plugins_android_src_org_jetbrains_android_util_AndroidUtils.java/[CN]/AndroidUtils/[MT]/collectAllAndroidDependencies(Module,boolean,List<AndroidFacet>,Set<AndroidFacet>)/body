{
  for (  OrderEntry orderEntry : ModuleRootManager.getInstance(module).getOrderEntries()) {
    if (orderEntry instanceof ModuleOrderEntry) {
      ModuleOrderEntry moduleOrderEntry=(ModuleOrderEntry)orderEntry;
      if (moduleOrderEntry.getScope() == DependencyScope.COMPILE) {
        Module depModule=moduleOrderEntry.getModule();
        if (depModule != null) {
          AndroidFacet depFacet=AndroidFacet.getInstance(depModule);
          if (depFacet != null && (!androidLibrariesOnly || depFacet.getConfiguration().LIBRARY_PROJECT)) {
            if (visited.add(depFacet)) {
              collectAllAndroidDependencies(depModule,androidLibrariesOnly,result,visited);
              result.add(0,depFacet);
            }
          }
        }
      }
    }
  }
}
