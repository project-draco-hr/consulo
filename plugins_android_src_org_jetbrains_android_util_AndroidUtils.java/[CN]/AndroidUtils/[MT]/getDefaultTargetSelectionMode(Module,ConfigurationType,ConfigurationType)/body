{
  final RunManager runManager=RunManager.getInstance(module.getProject());
  RunConfiguration[] configurations=runManager.getConfigurations(type);
  TargetSelectionMode alternative=null;
  if (configurations.length > 0) {
    for (    RunConfiguration configuration : configurations) {
      if (configuration instanceof AndroidRunConfigurationBase) {
        final AndroidRunConfigurationBase runConfig=(AndroidRunConfigurationBase)configuration;
        final TargetSelectionMode targetMode=runConfig.getTargetSelectionMode();
        if (runConfig.getConfigurationModule() == module) {
          return targetMode;
        }
 else {
          alternative=targetMode;
        }
      }
    }
  }
  if (alternative != null) {
    return alternative;
  }
  configurations=runManager.getConfigurations(alternativeType);
  if (configurations.length > 0) {
    for (    RunConfiguration configuration : configurations) {
      if (configuration instanceof AndroidRunConfigurationBase) {
        return ((AndroidRunConfigurationBase)configuration).getTargetSelectionMode();
      }
    }
  }
  return null;
}
