{
  return ApplicationManager.getApplication().runWriteAction(new Computable<AndroidFacet>(){
    @Override public AndroidFacet compute(){
      final ModifiableRootModel model=ModuleRootManager.getInstance(module).getModifiableModel();
      final AndroidFacet facet=addAndroidFacet(model,contentRoot,library);
      model.commit();
      return facet;
    }
  }
);
}
