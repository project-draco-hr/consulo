{
  final PsiElement element=value.getParent();
  if (!(element instanceof XmlAttribute))   return;
  final XmlAttribute attribute=(XmlAttribute)element;
  final XmlTag tag=attribute.getParent();
  if (tag == null)   return;
  final XmlElementDescriptor descriptor=tag.getDescriptor();
  if (descriptor == null)   return;
  final XmlAttributeDescriptor attributeDescriptor=descriptor.getAttributeDescriptor(attribute);
  if (attributeDescriptor == null)   return;
  if (attributeDescriptor.hasIdType()) {
    updateMap(attribute,value,false);
  }
 else {
    final PsiReference[] references=value.getReferences();
    for (    PsiReference r : references) {
      if (r instanceof IdReferenceProvider.GlobalAttributeValueSelfReference) {
        updateMap(attribute,value,r.isSoft());
      }
 else       if (r instanceof SchemaPrefixReference) {
        SchemaPrefix prefix=((SchemaPrefixReference)r).resolve();
        if (prefix != null) {
          myHolder.addUsedPrefix(prefix.getName());
        }
      }
    }
  }
  if (attributeDescriptor.hasIdRefType() && PsiTreeUtil.getChildOfType(value,OuterLanguageElement.class) == null) {
    myHolder.registerIdReference(value);
  }
  super.visitXmlAttributeValue(value);
}
