{
  List<Pair<XmlAttributeValue,Boolean>> list=myId2AttributeListMap.get(id);
  if (list == null) {
    list=new ArrayList<Pair<XmlAttributeValue,Boolean>>();
    myId2AttributeListMap.put(id,list);
  }
 else   if (!soft) {
    List<XmlAttributeValue> notSoft=ContainerUtil.mapNotNull(list,new NullableFunction<Pair<XmlAttributeValue,Boolean>,XmlAttributeValue>(){
      @Override public XmlAttributeValue fun(      Pair<XmlAttributeValue,Boolean> pair){
        return pair.second ? null : pair.first;
      }
    }
);
    if (!notSoft.isEmpty()) {
      myPossiblyDuplicateIds.addAll(notSoft);
      myPossiblyDuplicateIds.add(attributeValue);
    }
  }
  list.add(new Pair<XmlAttributeValue,Boolean>(attributeValue,soft));
}
