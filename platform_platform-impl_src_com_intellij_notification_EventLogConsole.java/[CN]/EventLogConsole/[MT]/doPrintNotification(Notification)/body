{
  if (myLogEditor.isDisposed()) {
    return;
  }
  Document document=myLogEditor.getDocument();
  boolean scroll=document.getTextLength() == myLogEditor.getCaretModel().getOffset();
  append(document,DateFormat.getTimeInstance(DateFormat.MEDIUM).format(notification.getCreationTime()) + " ");
  Pair<String,Boolean> pair=EventLog.formatForLog(notification);
  final NotificationType type=notification.getType();
  TextAttributesKey key=type == NotificationType.ERROR ? ConsoleViewContentType.LOG_ERROR_OUTPUT_KEY : type == NotificationType.INFORMATION ? ConsoleViewContentType.NORMAL_OUTPUT_KEY : ConsoleViewContentType.LOG_WARNING_OUTPUT_KEY;
  int msgStart=document.getTextLength();
  String message=pair.first;
  append(document,message);
  TextAttributes attributes=EditorColorsManager.getInstance().getGlobalScheme().getAttributes(key);
  int layer=HighlighterLayer.CARET_ROW + 1;
  myLogEditor.getMarkupModel().addRangeHighlighter(msgStart,document.getTextLength(),layer,attributes,HighlighterTargetArea.EXACT_RANGE);
  if (pair.second) {
    String s=" ";
    append(document,s);
    final int linkStart=document.getTextLength();
    append(document,"more");
    myHyperlinkSupport.addHyperlink(linkStart,document.getTextLength(),null,new HyperlinkInfo(){
      @Override public void navigate(      Project project){
        Balloon balloon=notification.getBalloon();
        if (balloon != null) {
          balloon.hide();
        }
        Window window=NotificationsManagerImpl.findWindowForBalloon(project);
        if (window != null) {
          Point point=EventLogConsole.this.myLogEditor.visualPositionToXY(EventLogConsole.this.myLogEditor.offsetToVisualPosition(linkStart));
          Point target=SwingUtilities.convertPoint(EventLogConsole.this.myLogEditor.getContentComponent(),point,window);
          balloon=NotificationsManagerImpl.createBalloon(notification,true,true,false);
          balloon.show(new RelativePoint(window,target),Balloon.Position.above);
        }
      }
    }
);
    append(document," ");
  }
  append(document,"\n");
  if (scroll) {
    myLogEditor.getCaretModel().moveToOffset(document.getTextLength());
    myLogEditor.getScrollingModel().scrollToCaret(ScrollType.MAKE_VISIBLE);
  }
  if (notification.isImportant()) {
    highlightNotification(notification,message,document.getLineCount() - 2);
  }
}
