{
  cleanup();
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    public void run(){
      PsiDocumentManager.getInstance(myProject).commitAllDocuments();
    }
  }
);
  LOG.info("Code inspection started");
  Runnable runInspection=new Runnable(){
    public void run(){
      performInspectionsWithProgress(scope);
    }
  }
;
  if (!ProgressManager.getInstance().runProcessWithProgressSynchronously(runInspection,InspectionsBundle.message("inspection.progress.title"),true,myProject)) {
    return;
  }
  InspectionResultsView view=new InspectionResultsView(myProject,getCurrentProfile(),scope);
  if (!view.update()) {
    Messages.showMessageDialog(myProject,InspectionsBundle.message("inspection.no.problems.message"),InspectionsBundle.message("inspection.no.problems.dialog.title"),Messages.getInformationIcon());
  }
 else {
    addView(view);
  }
}
