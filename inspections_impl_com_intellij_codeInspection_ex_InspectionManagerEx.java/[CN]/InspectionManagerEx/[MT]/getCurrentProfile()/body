{
  if (myExternalProfile != null)   return myExternalProfile;
  final InspectionProjectProfileManager inspectionProfileManager=InspectionProjectProfileManager.getInstance(myProject);
  InspectionProfile profile=(InspectionProfile)inspectionProfileManager.getProfile(myCurrentProfileName);
  if (profile == null) {
    if (inspectionProfileManager.useProjectLevelProfileSettings()) {
      profile=(InspectionProfile)InspectionProfileManager.getInstance().getProfile(myCurrentProfileName);
      if (profile != null)       return profile;
    }
    final String[] avaliableProfileNames=inspectionProfileManager.getAvailableProfileNames();
    if (avaliableProfileNames == null || avaliableProfileNames.length == 0) {
      return null;
    }
    myCurrentProfileName=avaliableProfileNames[0];
    profile=(InspectionProfile)inspectionProfileManager.getProfile(myCurrentProfileName);
  }
  return profile;
}
