{
  myFileListener=new FileListener(myVcs,myFileFilter,myFileSystem);
  myFileContentProvider=new FileContentProvider(){
    public VirtualFile[] getCoveredDirectories(){
      return myRootManager.getContentRoots();
    }
    @Nullable public ProvidedContent getProvidedContent(    VirtualFile f){
      Entry e=myVcs.findEntry(f.getPath());
      if (e == null)       return null;
      if (e.getContent().isTooLong())       return null;
      return new EntryProvidedContent(e);
    }
    public VirtualFileListener getVirtualFileListener(){
      return myFileListener;
    }
  }
;
  myFileManager.registerFileContentProvider(myFileContentProvider);
}
