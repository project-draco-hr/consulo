{
  myFileListener=new FileListener(myVcs,myGateway,myFileFilter);
  myFileContentProvider=new FileContentProvider(){
    public VirtualFile[] getCoveredDirectories(){
      return myRootManager.getContentRoots();
    }
    @Nullable public ProvidedContent getProvidedContent(    VirtualFile f){
      return getProvidedContentFor(f);
    }
    public VirtualFileListener getVirtualFileListener(){
      return myFileListener;
    }
  }
;
  myCommandProcessor.addCommandListener(myFileListener);
  myFileManager.addVirtualFileManagerListener(myFileListener);
  myFileManager.registerFileContentProvider(myFileContentProvider);
}
