{
  if (key1 == null) {
    throw new IllegalStateException("DESede engine not initialised!");
  }
  if (encrypt) {
    desFunc(key1,in,inOff,out,outOff);
    desFunc(key2,out,outOff,out,outOff);
    desFunc(key3,out,outOff,out,outOff);
  }
 else {
    desFunc(key3,in,inOff,out,outOff);
    desFunc(key2,out,outOff,out,outOff);
    desFunc(key1,out,outOff,out,outOff);
  }
}
