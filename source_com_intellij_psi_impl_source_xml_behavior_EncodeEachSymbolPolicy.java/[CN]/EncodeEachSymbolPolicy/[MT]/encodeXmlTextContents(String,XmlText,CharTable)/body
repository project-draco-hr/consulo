{
  if (!toCode(displayText))   return super.encodeXmlTextContents(displayText,text,charTableByTree);
  final FileElement dummyParent=new DummyHolder(text.getManager(),null,charTableByTree).getTreeElement();
  int sectionStartOffset=0;
  int offset=0;
  while (offset < displayText.length()) {
    if (toCode(displayText.charAt(offset))) {
      final String plainSection=displayText.substring(sectionStartOffset,offset);
      if (plainSection.length() > 0) {
        TreeUtil.addChildren(dummyParent,(TreeElement)super.encodeXmlTextContents(plainSection,text,charTableByTree));
      }
      TreeUtil.addChildren(dummyParent,createCharEntity(displayText.charAt(offset),dummyParent.getCharTable()));
      sectionStartOffset=offset + 1;
    }
    offset++;
  }
  final String plainSection=displayText.substring(sectionStartOffset,offset);
  if (plainSection.length() > 0) {
    TreeUtil.addChildren(dummyParent,(TreeElement)super.encodeXmlTextContents(plainSection,text,charTableByTree));
  }
  dummyParent.acceptTree(new GeneratedMarkerVisitor());
  return dummyParent.getFirstChildNode();
}
