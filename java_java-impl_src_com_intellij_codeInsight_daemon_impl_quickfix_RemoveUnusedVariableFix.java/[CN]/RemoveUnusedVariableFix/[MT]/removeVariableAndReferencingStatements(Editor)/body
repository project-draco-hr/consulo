{
  final List<PsiElement> references=new ArrayList<PsiElement>();
  final List<PsiElement> sideEffects=new ArrayList<PsiElement>();
  final boolean[] canCopeWithSideEffects={true};
  try {
    PsiElement context=myVariable instanceof PsiField ? ((PsiField)myVariable).getContainingClass() : PsiUtil.getVariableCodeBlock(myVariable,null);
    if (context != null) {
      collectReferences(context,myVariable,references);
    }
    references.add(myVariable);
    for (    PsiElement element : references) {
      canCopeWithSideEffects[0]&=processUsage(element,myVariable,sideEffects,SideEffectWarningDialog.CANCEL);
    }
  }
 catch (  IncorrectOperationException e) {
    LOG.error(e);
  }
  final int deleteMode=showSideEffectsWarning(sideEffects,myVariable,editor,canCopeWithSideEffects[0]);
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    public void run(){
      try {
        deleteReferences(myVariable,references,deleteMode);
      }
 catch (      IncorrectOperationException e) {
        LOG.error(e);
      }
    }
  }
);
}
