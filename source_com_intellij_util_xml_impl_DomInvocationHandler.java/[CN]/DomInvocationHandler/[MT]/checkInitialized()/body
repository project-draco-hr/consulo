{
synchronized (PsiLock.LOCK) {
    if (myInitialized || myInitializing)     return;
    myInitializing=true;
    try {
      final HashSet<XmlTag> usedTags=new HashSet<XmlTag>();
      final XmlTag tag=getXmlTag();
      for (      Map.Entry<Method,Pair<String,Integer>> entry : myMethodsMap.getFixedChildrenEntries()) {
        final Pair<String,Integer> pair=entry.getValue();
        final String qname=pair.getFirst();
        final Integer index=pair.getSecond();
        XmlTag subTag=findSubTag(tag,qname,index);
        final Class aClass=entry.getKey().getReturnType();
        final IndexedElementInvocationHandler handler=new IndexedElementInvocationHandler(aClass,subTag,this,qname,index);
        myManager.createDomElement(aClass,subTag,handler);
        myFixedChildren.put(pair,handler);
        usedTags.add(subTag);
      }
      if (tag != null) {
        for (        Map.Entry<Method,String> entry : myMethodsMap.getCollectionChildrenEntries()) {
          String qname=entry.getValue();
          for (          XmlTag subTag : tag.findSubTags(qname)) {
            if (!usedTags.contains(subTag)) {
              createCollectionElement(myMethodsMap.getCollectionChildrenClass(qname),subTag);
              usedTags.add(subTag);
            }
          }
        }
      }
    }
  finally {
      myInitializing=false;
      myInitialized=true;
    }
  }
}
