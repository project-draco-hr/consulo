{
  final VirtualFile virtualFile=getFile().getVirtualFile();
  if (virtualFile != null && !virtualFile.isWritable()) {
    VirtualFileManager.getInstance().fireReadOnlyModificationAttempt(virtualFile);
    return null;
  }
  checkInitialized(tagName);
  return addCollectionElement(type,addEmptyTag(tagName,index));
}
