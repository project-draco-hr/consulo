{
  final XmlTag tag=getXmlTag();
  final XmlTag[] subTags=tag.findSubTags(tagName);
  if (subTags.length < index) {
    index=subTags.length;
  }
  final boolean changing=myManager.isChanging();
  myManager.setChanging(true);
  try {
    XmlTag newTag=createEmptyTag(tagName);
    if (index == 0) {
      return (XmlTag)tag.add(newTag);
    }
    return (XmlTag)tag.addAfter(newTag,subTags[index - 1]);
  }
  finally {
    myManager.setChanging(changing);
  }
}
