def __init__(self, repo, name=None):
    if isinstance(repo, str):
        u = ui.ui()
        u.setconfig('ui', 'report_untrusted', 'off')
        u.setconfig('ui', 'interactive', 'off')
        self.repo = hg.repository(u, repo)
    else:
        self.repo = repo
    hook.redirect(True)
    self.mtime = (-1)
    self.reponame = name
    self.archives = ('zip', 'gz', 'bz2')
    self.stripecount = 1
    self.templatepath = self.config('web', 'templates')
