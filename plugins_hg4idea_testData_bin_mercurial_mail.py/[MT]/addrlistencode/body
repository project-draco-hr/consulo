def addrlistencode(ui, addrs, charsets=None, display=False):
    'Turns a list of addresses into a list of RFC-2047 compliant headers.\n    A single element of input list may contain multiple addresses, but output\n    always has one address per item'
    if display:
        return [a.strip() for a in addrs if a.strip()]
    result = []
    for (name, addr) in email.Utils.getaddresses(addrs):
        if (name or addr):
            result.append(_addressencode(ui, name, addr, charsets))
    return result
