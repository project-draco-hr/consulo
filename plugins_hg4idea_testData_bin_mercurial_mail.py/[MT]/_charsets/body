def _charsets(ui):
    'Obtains charsets to send mail parts not containing patches.'
    charsets = [cs.lower() for cs in ui.configlist('email', 'charsets')]
    fallbacks = [encoding.fallbackencoding.lower(), encoding.encoding.lower(), 'utf-8']
    for cs in fallbacks:
        if (cs not in charsets):
            charsets.append(cs)
    return [cs for cs in charsets if (not cs.endswith('ascii'))]
