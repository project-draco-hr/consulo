{
  final ClassLoader loader=jdbcClass.getClassLoader();
  Object proxy=Proxy.newProxyInstance(loader,new Class[]{jdbcClass},new InvocationHandler(){
    public Object invoke(    Object proxy,    Method method,    Object[] args) throws Throwable {
      if (method.getDeclaringClass() == Object.class) {
        return method.invoke(remote,args);
      }
 else {
        Method m=ourRemoteToLocalMap.get(Pair.<Class<?>,Class<?>>create(remote.getClass(),jdbcClass)).get(method);
        if (m == null)         throw new NoSuchMethodError(method.getName() + " in " + remote.getClass());
        try {
          Object result=m.invoke(remote,args);
          if (result instanceof Remote) {
            return castToLocal(result,tryFixReturnType(result,method.getReturnType(),loader));
          }
          return result;
        }
 catch (        InvocationTargetException e) {
          Throwable cause=e;
          for (; cause.getCause() != null; cause=cause.getCause())           ;
          if (cause instanceof RuntimeException)           throw cause;
          if (cause instanceof Error)           throw cause;
          if (ArrayUtil.indexOf(method.getExceptionTypes(),cause.getClass()) > -1)           throw cause;
          throw new RuntimeException(cause);
        }
catch (        RuntimeException e) {
          throw e;
        }
catch (        Exception e) {
          throw new RuntimeException(e);
        }
      }
    }
  }
);
  return (T)proxy;
}
