{
  Object result;
  if (value instanceof Remote) {
    if (value instanceof RemoteCastable) {
      result=castToLocal(value,tryFixReturnType(value,methodReturnType,classLoader));
    }
 else {
      result=substituteClassLoader ? substituteClassLoader(value,classLoader) : value;
    }
  }
 else   if (value instanceof Collection) {
    Collection c=(Collection)value;
    if (value instanceof Set) {
      LinkedHashSet set=new LinkedHashSet();
      for (      Object o : c) {
        set.add(handleRemoteResult(o,Object.class,classLoader,substituteClassLoader));
      }
      result=set;
    }
 else {
      result=Arrays.asList((Object[])handleRemoteResult(c.toArray(),Object.class,classLoader,substituteClassLoader));
    }
  }
 else   if (value instanceof Object[]) {
    Object[] array=(Object[])value;
    for (int i=0; i < array.length; i++) {
      array[i]=handleRemoteResult(array[i],Object.class,classLoader,substituteClassLoader);
    }
    result=array;
  }
 else {
    result=value;
  }
  return (T)result;
}
