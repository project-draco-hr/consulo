{
  final FileElement fileElement=TreeUtil.getFileElement(first);
  if (fileElement != null) {
    prepareAndRunChangeAction(new ChangeAction(){
      public void makeChange(      TreeChangeEvent destinationTreeChange){
        remove(destinationTreeChange,first,last);
        repairRemovedElement(fileElement,oldCharTab,first);
      }
    }
,first.getTreeParent());
  }
 else {
    TreeUtil.removeRange(first,last);
  }
}
