{
  final TreeElement element=(TreeElement)original.clone();
  final PsiManager manager=original.getManager();
  final CharTable charTableByTree=SharedImplUtil.findCharTableByTree(original);
  registerLeafsInCharTab(table,element,charTableByTree);
  CompositeElement treeParent=original.getTreeParent();
  new DummyHolder(manager,element,treeParent == null ? null : treeParent.getPsi(),table).getTreeElement();
  encodeInformation(element,original);
  Helper.unindentSubtree(element,original,table);
  TreeUtil.clearCaches(element);
  return element;
}
