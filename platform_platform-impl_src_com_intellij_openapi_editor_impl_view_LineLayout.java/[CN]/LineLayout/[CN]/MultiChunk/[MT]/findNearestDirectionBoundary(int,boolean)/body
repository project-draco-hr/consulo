{
  if (lookForward) {
    byte originLevel=-1;
    for (    BidiRun run : myBidiRunsInLogicalOrder) {
      if (originLevel >= 0) {
        if (run.level != originLevel)         return run.startOffset;
      }
 else       if (run.endOffset > offset) {
        originLevel=run.level;
      }
    }
    return originLevel > 0 ? myBidiRunsInLogicalOrder[myBidiRunsInLogicalOrder.length - 1].endOffset : -1;
  }
 else {
    byte originLevel=-1;
    for (int i=myBidiRunsInLogicalOrder.length - 1; i >= 0; i--) {
      BidiRun run=myBidiRunsInLogicalOrder[i];
      if (originLevel >= 0) {
        if (run.level != originLevel)         return run.endOffset;
      }
 else       if (run.startOffset < offset) {
        originLevel=run.level;
      }
    }
    return originLevel > 0 ? 0 : -1;
  }
}
