{
  String displayValue=getDisplayValue();
  if (displayValue == null || displayIndex < 0 || displayIndex > displayValue.length())   return -1;
  if (myGapDisplayStarts.length == 0)   return displayIndex;
  final int bsResult=Arrays.binarySearch(myGapDisplayStarts,displayIndex);
  final int gapIndex;
  if (bsResult > 0) {
    gapIndex=bsResult - 1;
  }
 else   if (bsResult < -1) {
    gapIndex=-bsResult - 2;
  }
 else {
    gapIndex=-1;
  }
  if (gapIndex < 0)   return displayIndex;
  final int shift=myGapPhysicalStarts[gapIndex] - myGapDisplayStarts[gapIndex];
  return displayIndex + shift;
}
