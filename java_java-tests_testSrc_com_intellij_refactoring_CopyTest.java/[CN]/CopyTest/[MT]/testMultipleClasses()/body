{
  String rootBefore=getRoot();
  PsiTestUtil.removeAllRoots(myModule,JavaSdkImpl.getMockJdk17());
  final VirtualFile root=PsiTestUtil.createTestProjectStructure(myProject,myModule,rootBefore,myFilesToDelete);
  final PsiClass aClass=myJavaFacade.findClass("pack1.Klass");
  assertNotNull(aClass);
  final PsiFile containingFile=aClass.getContainingFile();
  assertTrue(CopyHandler.canCopy(new PsiElement[]{containingFile}));
  assertFalse(CopyHandler.canClone(new PsiElement[]{containingFile}));
  PsiPackage pack2=myJavaFacade.findPackage("pack2");
  final PsiDirectory targetDirectory=pack2.getDirectories()[0];
  CopyHandler.doCopy(new PsiElement[]{containingFile},targetDirectory);
  VirtualFile fileAfter=root.findFileByRelativePath("pack2/Klass.java");
  VirtualFile fileExpected=root.findFileByRelativePath("pack2/Klass.expected.java");
  PlatformTestUtil.assertFilesEqual(fileExpected,fileAfter);
}
