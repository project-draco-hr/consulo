def getfile(self, name, rev):
    if (rev != self.lastrev):
        raise util.Abort(_('internal calling inconsistency'))
    if (not os.path.exists(os.path.join(self.tmppath, name))):
        raise IOError
    (data, mode) = self._getfile(name, rev)
    self.modecache[(name, rev)] = mode
    return data
