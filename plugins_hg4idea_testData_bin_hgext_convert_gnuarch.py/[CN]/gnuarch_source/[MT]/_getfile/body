def _getfile(self, name, rev):
    mode = os.lstat(os.path.join(self.tmppath, name)).st_mode
    if stat.S_ISLNK(mode):
        data = os.readlink(os.path.join(self.tmppath, name))
        mode = ((mode and 'l') or '')
    else:
        data = open(os.path.join(self.tmppath, name), 'rb').read()
        mode = (((mode & 73) and 'x') or '')
    return (data, mode)
