{
  final PsiReference[] references=parent.getReferences();
  for (  final PsiReference reference : references) {
    final PsiElement fileItem=reference.resolve();
    if (fileItem instanceof PsiFileSystemItem) {
      final PsiFileSystemItem item=(PsiFileSystemItem)fileItem;
      if (!item.isDirectory()) {
        final VirtualFile file=item.getVirtualFile();
        if (file != null && supportedExtensions.contains(file.getExtension())) {
          try {
            refresh(file);
            SoftReference<BufferedImage> imageRef=file.getUserData(BUFFERED_IMAGE_REF_KEY);
            if (imageRef != null) {
              return new ImagePreviewComponent(imageRef.get());
            }
          }
 catch (          IOException e) {
          }
        }
      }
    }
  }
  return null;
}
