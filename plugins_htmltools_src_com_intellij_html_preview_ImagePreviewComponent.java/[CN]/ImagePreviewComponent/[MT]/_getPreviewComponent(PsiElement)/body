{
  final PsiReference[] references=parent.getReferences();
  for (  final PsiReference reference : references) {
    if (reference instanceof FileReference) {
      final PsiFileSystemItem item=((FileReference)reference).resolve();
      if (item != null && !item.isDirectory()) {
        final VirtualFile file=item.getVirtualFile();
        if (file != null && supportedExtensions.contains(file.getExtension())) {
          try {
            refresh(file);
            SoftReference<BufferedImage> imageRef=file.getUserData(BUFFERED_IMAGE_REF_KEY);
            if (imageRef != null) {
              return new ImagePreviewComponent(imageRef.get());
            }
          }
 catch (          IOException e) {
          }
        }
      }
    }
  }
  return null;
}
