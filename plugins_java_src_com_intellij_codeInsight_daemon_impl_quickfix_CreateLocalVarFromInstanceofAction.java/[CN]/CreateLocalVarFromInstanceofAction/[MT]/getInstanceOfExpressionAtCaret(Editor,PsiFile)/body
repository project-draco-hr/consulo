{
  int offset=editor.getCaretModel().getOffset();
  PsiElement element=file.findElementAt(offset);
  if (element == null)   return null;
  PsiInstanceOfExpression expression=PsiTreeUtil.getParentOfType(element,PsiInstanceOfExpression.class);
  if (expression != null) {
    return expression;
  }
  PsiStatement statement=PsiTreeUtil.getParentOfType(element,PsiIfStatement.class,PsiWhileStatement.class);
  if (statement instanceof PsiIfStatement) {
    final PsiExpression condition=((PsiIfStatement)statement).getCondition();
    return retrieveInstanceOfFromCondition(editor,element,statement,condition);
  }
 else   if (statement instanceof PsiWhileStatement) {
    final PsiExpression condition=((PsiWhileStatement)statement).getCondition();
    return retrieveInstanceOfFromCondition(editor,element,statement,condition);
  }
  return null;
}
