{
  serverSocket=new ServerSocket(0);
  int port=serverSocket.getLocalPort();
  String name="hg4idea prompt server";
  serverThread=new Thread(name){
    @Override public void run(){
      try {
        boolean _continue=true;
        while (_continue) {
          Socket socket=serverSocket.accept();
          _continue=protocol.handleConnection(socket);
        }
      }
 catch (      SocketException e) {
      }
catch (      IOException e) {
        throw new RuntimeException(e);
      }
    }
  }
;
  serverThread.start();
  return port;
}
