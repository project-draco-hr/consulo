{
  boolean containsReference=false;
  Set<String> resourceTypes=new HashSet<String>();
  Set<AttributeFormat> formats=attr.getFormats();
  for (  AttributeFormat format : formats) {
    if (format == AttributeFormat.Reference) {
      containsReference=true;
    }
    String type=getResourceType(format);
    if (type != null) {
      resourceTypes.add(type);
    }
  }
  String specialResourceType=getSpecialResourceType(attr.getName());
  if (specialResourceType != null) {
    resourceTypes.add(specialResourceType);
  }
  if (containsReference) {
    if (resourceTypes.contains("color"))     resourceTypes.add("drawable");
    if (resourceTypes.size() == 0) {
      resourceTypes.addAll(AndroidResourceUtil.getNames(AndroidResourceUtil.REFERRABLE_RESOURCE_TYPES));
    }
  }
  if (resourceTypes.size() > 0) {
    return new ResourceReferenceConverter(resourceTypes);
  }
  return null;
}
