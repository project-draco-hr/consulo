{
  final Project project=getCurrentProject();
  if (project == null) {
    return null;
  }
  final VirtualFile[] files=FileEditorManager.getInstance(project).getSelectedFiles();
  if (files.length == 0 || !files[0].isValid()) {
    return null;
  }
  final PsiFile file=PsiManager.getInstance(project).findFile(files[0]);
  return file;
}
