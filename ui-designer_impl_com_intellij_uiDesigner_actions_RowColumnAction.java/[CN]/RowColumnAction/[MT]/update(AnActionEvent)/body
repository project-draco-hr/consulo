{
  final Presentation presentation=e.getPresentation();
  CaptionSelection selection=(CaptionSelection)e.getDataContext().getData(CaptionSelection.class.getName());
  if (selection == null) {
    presentation.setEnabled(false);
  }
 else {
    presentation.setEnabled(selection.getContainer() != null);
    if (!selection.isRow()) {
      presentation.setText(myColumnText);
      presentation.setIcon(IconLoader.getIcon(myColumnIcon));
    }
 else {
      presentation.setText(myRowText);
      presentation.setIcon(IconLoader.getIcon(myRowIcon));
    }
  }
}
