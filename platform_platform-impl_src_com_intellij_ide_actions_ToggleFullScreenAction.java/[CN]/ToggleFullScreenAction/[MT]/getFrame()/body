{
  Component focusOwner=IdeFocusManager.getGlobalInstance().getFocusOwner();
  if (focusOwner != null) {
    Window window=focusOwner instanceof JFrame ? (Window)focusOwner : SwingUtilities.getWindowAncestor(focusOwner);
    if (window instanceof IdeFrameEx) {
      return (IdeFrameEx)window;
    }
  }
  return null;
}
