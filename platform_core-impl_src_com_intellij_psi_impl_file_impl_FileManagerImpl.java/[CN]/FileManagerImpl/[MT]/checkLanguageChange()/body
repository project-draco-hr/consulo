{
  Map<VirtualFile,FileViewProvider> fileToPsiFileMap=new THashMap<VirtualFile,FileViewProvider>(myVFileToViewProviderMap);
  Map<VirtualFile,FileViewProvider> originalFileToPsiFileMap=new THashMap<VirtualFile,FileViewProvider>(myVFileToViewProviderMap);
  myVFileToViewProviderMap.clear();
  for (Iterator<VirtualFile> iterator=fileToPsiFileMap.keySet().iterator(); iterator.hasNext(); ) {
    VirtualFile vFile=iterator.next();
    Language language=LanguageUtil.getLanguageForPsi(myManager.getProject(),vFile);
    if (language != null && language != fileToPsiFileMap.get(vFile).getBaseLanguage()) {
      iterator.remove();
    }
  }
  myVFileToViewProviderMap.putAll(fileToPsiFileMap);
  markInvalidations(originalFileToPsiFileMap);
}
