{
  if (viewProvider instanceof SingleRootFileViewProvider) {
    ((SingleRootFileViewProvider)viewProvider).markInvalidated();
  }
  VirtualFile virtualFile=viewProvider.getVirtualFile();
  Document document=FileDocumentManager.getInstance().getCachedDocument(virtualFile);
  if (document != null) {
    ((PsiDocumentManagerBase)PsiDocumentManager.getInstance(myManager.getProject())).associatePsi(document,null);
  }
  virtualFile.putUserData(myPsiHardRefKey,null);
}
