{
  final PsiElement forElement=descriptor.getPsiElement();
  final PsiElement parent=forElement.getParent();
  final String newExpression;
  if (parent instanceof PsiForStatement) {
    final PsiForStatement forStatement=(PsiForStatement)parent;
    newExpression=getCollectionsAddAllText(forStatement);
    if (newExpression == null) {
      return;
    }
    replaceStatementAndShortenClassNames(forStatement,newExpression);
  }
 else {
    final PsiForeachStatement foreachStatement=(PsiForeachStatement)parent;
    newExpression=getCollectionsAddAllText(foreachStatement);
    if (newExpression == null) {
      return;
    }
    replaceStatementAndShortenClassNames(foreachStatement,newExpression);
  }
}
