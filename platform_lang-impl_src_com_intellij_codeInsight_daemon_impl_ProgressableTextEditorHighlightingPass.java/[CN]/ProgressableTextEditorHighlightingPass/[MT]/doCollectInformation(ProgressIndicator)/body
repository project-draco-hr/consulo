{
  myFinished=false;
  if (myFile != null) {
    myHighlightingSession=sessionCreated(myRestrictRange,myFile,myEditor,progress,getColorsScheme(),getId());
  }
  try {
    collectInformationWithProgress(progress);
  }
  finally {
    if (myFile != null) {
      sessionFinished();
    }
  }
}
