{
  JPanel panel=new JPanel(new GridBagLayout());
  GridBagConstraints gbConstraints=new GridBagConstraints();
  gbConstraints.fill=GridBagConstraints.BOTH;
  gbConstraints.weighty=0;
  gbConstraints.gridwidth=2;
  gbConstraints.gridx=0;
  JPanel panel1=new JPanel();
  panel1.setBorder(IdeBorderFactory.createTitledBorder(CodeInsightBundle.message("dialog.edit.template.template.text.title"),false,false));
  panel1.setPreferredSize(new Dimension(500,160));
  panel1.setMinimumSize(new Dimension(500,160));
  panel1.setLayout(new BorderLayout());
  gbConstraints.weightx=1;
  gbConstraints.weighty=1;
  gbConstraints.gridy++;
  panel1.add(myTemplateEditor.getComponent(),BorderLayout.CENTER);
  panel.add(panel1,gbConstraints);
  gbConstraints.weighty=0;
  gbConstraints.gridy++;
  myEditVariablesButton=new JButton(CodeInsightBundle.message("dialog.edit.template.button.edit.variables"));
  myEditVariablesButton.setDefaultCapable(false);
  myEditVariablesButton.setMaximumSize(myEditVariablesButton.getPreferredSize());
  panel.add(myEditVariablesButton,gbConstraints);
  JPanel templateOptionsPanel=createTemplateOptionsPanel();
  JPanel contextPanel=createContextPanel();
  if (myNewTemplate) {
    gbConstraints.weighty=0;
    gbConstraints.gridwidth=1;
    gbConstraints.gridy++;
    panel.add(templateOptionsPanel,gbConstraints);
    gbConstraints.gridx=1;
    panel.add(contextPanel,gbConstraints);
  }
  myKeyField.getDocument().addDocumentListener(new com.intellij.ui.DocumentAdapter(){
    protected void textChanged(    javax.swing.event.DocumentEvent e){
      validateOKButton();
    }
  }
);
  myTemplateEditor.getDocument().addDocumentListener(new DocumentAdapter(){
    public void documentChanged(    DocumentEvent e){
      validateOKButton();
      validateEditVariablesButton();
    }
  }
);
  myEditVariablesButton.addActionListener(new ActionListener(){
    public void actionPerformed(    ActionEvent e){
      editVariables();
    }
  }
);
  return panel;
}
