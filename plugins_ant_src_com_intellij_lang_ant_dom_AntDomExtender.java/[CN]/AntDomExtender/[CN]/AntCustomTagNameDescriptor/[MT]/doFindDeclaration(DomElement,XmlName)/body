{
  if (!(parent instanceof AntDomElement)) {
    return null;
  }
  final AntDomElement parentElement=(AntDomElement)parent;
  final CustomAntElementsRegistry registry=CustomAntElementsRegistry.getInstance(parentElement.getAntProject());
  final AntDomElement declaringElement=registry.findDeclaringElement(parentElement,xmlName);
  if (declaringElement == null) {
    return null;
  }
  DomTarget target=DomTarget.getTarget(declaringElement);
  if (target == null && declaringElement instanceof AntDomTypeDef) {
    final AntDomTypeDef typedef=(AntDomTypeDef)declaringElement;
    final GenericAttributeValue<PsiFileSystemItem> resource=typedef.getResource();
    if (resource != null) {
      target=DomTarget.getTarget(declaringElement,resource);
    }
    if (target == null) {
      final GenericAttributeValue<PsiFileSystemItem> file=typedef.getFile();
      if (file != null) {
        target=DomTarget.getTarget(declaringElement,file);
      }
    }
  }
  return target;
}
