{
  final UISessionManager.UIContext context=ourLocal.get();
  if (context == null) {
    throw new IllegalArgumentException("Call must be wrapped inside UI thread");
  }
  final AutoBean<UIServerEvent> bean=UISessionManager.ourEventFactory.serverEvent();
  final UIServerEvent event=bean.as();
  event.setType(type);
  event.setSessionId(context.getId());
  consumer.consume(event);
  context.send(bean);
}
