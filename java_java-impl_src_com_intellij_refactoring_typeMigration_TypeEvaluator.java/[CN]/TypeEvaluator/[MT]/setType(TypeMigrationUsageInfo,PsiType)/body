{
  final LinkedList<PsiType> t=myTypeMap.get(usageInfo);
  final PsiElement element=usageInfo.getElement();
  if (type instanceof PsiEllipsisType && !(element instanceof PsiParameter && ((PsiParameter)element).getDeclarationScope() instanceof PsiMethod)) {
    type=((PsiEllipsisType)type).toArrayType();
  }
  if (t != null) {
    if (!t.getFirst().equals(type)) {
      if (element instanceof PsiVariable || element instanceof PsiMethod) {
        return false;
      }
      t.addFirst(type);
      return true;
    }
  }
 else {
    final LinkedList<PsiType> e=new LinkedList<PsiType>();
    e.addFirst(type);
    myTypeMap.put(usageInfo,e);
    return true;
  }
  return false;
}
