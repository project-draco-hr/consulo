{
  final PsiClass psiClass=JavaDirectoryService.getInstance().getClasses(getPackageDirectory("com/package1"))[0];
  final VirtualFile virtualFile=psiClass.getContainingFile().getVirtualFile();
  final FileEditorManager fileEditorManager=FileEditorManager.getInstance(myProject);
  FileEditor[] fileEditors=fileEditorManager.openFile(virtualFile,false);
  final FileEditor fileEditor=fileEditors[0];
  try {
    final StructureViewComponent structureViewComponent=(StructureViewComponent)fileEditor.getStructureViewBuilder().createStructureView(fileEditor,myProject);
    checkAction.testClassStructure(structureViewComponent);
    Disposer.dispose(structureViewComponent);
  }
  finally {
    fileEditorManager.closeFile(virtualFile);
  }
}
