{
  return new JavaElementVisitor(){
    @Override public void visitClass(    PsiClass clazz){
      if (log.isDebugEnabled())       log.debug("checkClass: clazz=" + clazz);
      final PsiIdentifier nameIdentifier=clazz.getNameIdentifier();
      if (nameIdentifier == null || clazz.getName() == null) {
        return;
      }
      if (excludeException && InheritanceUtil.isInheritor(clazz,CommonClassNames.JAVA_LANG_THROWABLE)) {
        return;
      }
      if (excludeDeprecated && clazz.isDeprecated()) {
        return;
      }
      if (excludeEnum && clazz.isEnum()) {
        return;
      }
      if (excludeAbstract && clazz.hasModifierProperty(PsiModifier.ABSTRACT)) {
        return;
      }
      if (excludeTestCode && TestFrameworks.getInstance().isTestClass(clazz)) {
        return;
      }
      if (excludeInnerClasses && clazz.getContainingClass() != null) {
        return;
      }
      if (StringUtil.isNotEmpty(excludeClassNames)) {
        String name=clazz.getName();
        if (name != null && name.matches(excludeClassNames)) {
          return;
        }
      }
      PsiField[] fields=clazz.getFields();
      if (fields.length == 0) {
        return;
      }
      fields=GenerateToStringUtils.filterAvailableFields(clazz,GenerateToStringContext.getConfig().getFilterPattern());
      PsiMethod[] methods=null;
      if (GenerateToStringContext.getConfig().isEnableMethods()) {
        methods=GenerateToStringUtils.filterAvailableMethods(clazz,GenerateToStringContext.getConfig().getFilterPattern());
      }
      if (Math.max(fields.length,methods == null ? 0 : methods.length) == 0) {
        return;
      }
      final PsiMethod[] toStringMethods=clazz.findMethodsByName("toString",false);
      for (      PsiMethod method : toStringMethods) {
        final PsiParameterList parameterList=method.getParameterList();
        if (parameterList.getParametersCount() == 0) {
          return;
        }
      }
      final PsiMethod[] superMethods=clazz.findMethodsByName("toString",true);
      for (      PsiMethod method : superMethods) {
        final PsiParameterList parameterList=method.getParameterList();
        if (parameterList.getParametersCount() != 0) {
          continue;
        }
        if (method.hasModifierProperty(PsiModifier.FINAL)) {
          return;
        }
      }
      holder.registerProblem(nameIdentifier,"Class '" + clazz.getName() + "' does not override 'toString()' method",ProblemHighlightType.GENERIC_ERROR_OR_WARNING,GenerateToStringQuickFix.getInstance());
    }
  }
;
}
