{
  LogicalPosition bracePosition=myEditor.offsetToLogicalPosition(lbraceStart);
  Point braceLocation=myEditor.logicalPositionToXY(bracePosition);
  final int y=braceLocation.y;
  myAlarm.addRequest(new Runnable(){
    public void run(){
      if (!myEditor.getComponent().isShowing())       return;
      Rectangle viewRect=myEditor.getScrollingModel().getVisibleArea();
      if (y < viewRect.y) {
        final int[] start=new int[]{lbraceStart};
        if (!(myPsiFile instanceof PsiPlainTextFile)) {
          PsiDocumentManager.getInstance(myProject).commitAllDocuments();
          start[0]=getCodeContructStart(lbraceStart);
        }
        TextRange range=new TextRange(start[0],lbraceEnd);
        int line1=myDocument.getLineNumber(range.getStartOffset());
        int line2=myDocument.getLineNumber(range.getEndOffset());
        line1=Math.max(line1,line2 - 5);
        range=new TextRange(myDocument.getLineStartOffset(line1),range.getEndOffset());
        EditorFragmentComponent.showEditorFragmentHint(myEditor,range,true);
      }
    }
  }
,300);
}
