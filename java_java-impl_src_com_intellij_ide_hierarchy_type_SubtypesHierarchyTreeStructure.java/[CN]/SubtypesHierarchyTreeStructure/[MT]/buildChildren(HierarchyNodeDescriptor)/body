{
  final PsiClass psiClass=((TypeHierarchyNodeDescriptor)descriptor).getPsiClass();
  if ("java.lang.Object".equals(psiClass.getQualifiedName())) {
    return new Object[]{IdeBundle.message("node.hierarchy.java.lang.object")};
  }
  if (psiClass instanceof PsiAnonymousClass)   return ArrayUtil.EMPTY_OBJECT_ARRAY;
  if (psiClass.hasModifierProperty(PsiModifier.FINAL))   return ArrayUtil.EMPTY_OBJECT_ARRAY;
  final List<PsiClass> classes=new ArrayList<PsiClass>(ClassInheritorsSearch.search(psiClass,psiClass.getUseScope().intersectWith(getSearchScope(myCurrentScopeType,psiClass)),false).findAll());
  final HierarchyNodeDescriptor[] descriptors=new HierarchyNodeDescriptor[classes.size()];
  for (int i=0; i < classes.size(); i++) {
    descriptors[i]=new TypeHierarchyNodeDescriptor(myProject,descriptor,classes.get(i),false);
  }
  return descriptors;
}
