{
  myChannelFactory=new NioClientSocketChannelFactory(Executors.newCachedThreadPool(),Executors.newCachedThreadPool());
  myPipelineFactory=new ChannelPipelineFactory(){
    public ChannelPipeline getPipeline() throws Exception {
      return Channels.pipeline(new ProtobufVarint32FrameDecoder(),new ProtobufDecoder(JpsRemoteProto.Message.getDefaultInstance()),new ProtobufVarint32LengthFieldPrepender(),new ProtobufEncoder(),new JpsClientMessageHandler(){
        protected JpsServerResponseHandler getHandler(        JpsRemoteProto.Message message){
          final JpsRemoteProto.Message.UUID messageUuid=message.getMessageUuid();
          return myResponseHandlers.remove(new UUID(messageUuid.getMostSigBits(),messageUuid.getLeastSigBits()));
        }
      }
);
    }
  }
;
}
