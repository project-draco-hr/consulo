{
  final Semaphore semaphore=new Semaphore();
  semaphore.down();
  final AtomicReference<T> reference=new AtomicReference<T>();
  ApplicationManager.getApplication().executeOnPooledThread(new Runnable(){
    @Override public void run(){
      try {
        reference.set(runImpl());
      }
  finally {
        semaphore.up();
      }
    }
  }
);
  semaphore.waitFor();
  return reference.get();
}
