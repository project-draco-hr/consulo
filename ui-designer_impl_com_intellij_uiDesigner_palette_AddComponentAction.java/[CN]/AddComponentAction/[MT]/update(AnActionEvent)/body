{
  Project project=(Project)e.getDataContext().getData(DataConstants.PROJECT);
  PsiFile psiFile=(PsiFile)e.getDataContext().getData(DataConstants.PSI_FILE);
  if (psiFile != null && project != null) {
    e.getPresentation().setVisible(findElementToAdd(psiFile) != null);
  }
 else {
    e.getPresentation().setVisible(true);
    GroupItem groupItem=(GroupItem)e.getDataContext().getData(GroupItem.class.getName());
    e.getPresentation().setEnabled(project != null && (groupItem == null || !groupItem.isReadOnly()));
  }
}
