{
  List<Integer> lines2Reformat=new ArrayList<Integer>();
  if (range1.isValid()) {
    lines2Reformat.add(document.getLineNumber(range1.getStartOffset()));
    lines2Reformat.add(document.getLineNumber(range1.getEndOffset()));
  }
  if (range2.isValid()) {
    lines2Reformat.add(document.getLineNumber(range2.getStartOffset()));
    lines2Reformat.add(document.getLineNumber(range2.getEndOffset()));
  }
  Collections.sort(lines2Reformat);
  final CodeStyleManager codeStyleManager=CodeStyleManager.getInstance(project);
  for (  final Integer lineNumber : lines2Reformat) {
    if (lineNumber < document.getLineCount()) {
      codeStyleManager.adjustLineIndent(document,document.getLineStartOffset(lineNumber));
    }
  }
}
