{
  final Ref<GitBranchesWidget> widget=new Ref<GitBranchesWidget>();
  UIUtil.invokeAndWaitIfNeeded(new Runnable(){
    @Override public void run(){
      StatusBar statusBar=WindowManager.getInstance().getStatusBar(project);
      if (statusBar != null) {
        final GitBranchesWidget w=new GitBranchesWidget(project,configurations);
        statusBar.addWidget(w,"after " + (SystemInfo.isMac ? "Encoding" : "InsertOverwrite"),project);
        widget.set(w);
      }
    }
  }
);
  return new Runnable(){
    @Override public void run(){
      if (widget.get() != null) {
        UIUtil.invokeLaterIfNeeded(new Runnable(){
          @Override public void run(){
            Disposer.dispose(widget.get());
          }
        }
);
      }
    }
  }
;
}
