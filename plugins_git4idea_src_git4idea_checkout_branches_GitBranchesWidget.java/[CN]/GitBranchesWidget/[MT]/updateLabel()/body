{
  cancelPopup();
  final GitBranchConfigurations.SpecialStatus status=myConfigurations.getSpecialStatus();
  String text;
  myPopupEnabled=false;
  Color color=Color.RED;
  String tooltip;
switch (status) {
case CHECKOUT_IN_PROGRESS:
    text="Checkout...";
  color=Color.BLUE;
tooltip="A checkout operation is in progress.";
break;
case MERGING:
text="Merging...";
tooltip="Merge is in progress in some vcs roots.";
break;
case REBASING:
tooltip="Rebase is in progress in some vcs roots.";
text="Rebasing...";
break;
case NON_GIT:
tooltip="No valid vcs roots are configuration for the project.";
text="Non-Git project";
break;
case NORMAL:
GitBranchConfiguration current;
try {
current=myConfigurations.getCurrentConfiguration();
}
 catch (VcsException e) {
current=null;
}
if (current == null) {
tooltip="The branch configurations are not yet detected.";
text="Detecting...";
}
 else {
myPopupEnabled=true;
text=current.getName();
tooltip="<html>The Git branch configuration <b>" + text + "</b> is selected.<br/>Click to select other configuration.</html>";
color=myDefaultForeground;
}
break;
default :
tooltip="Unknown status: " + status;
text="Unknown status: " + status;
}
if (!SystemInfo.isMac) {
setForeground(color);
}
setToolTipText(tooltip);
setText(text);
invalidate();
}
