{
  FragmentSide targetSide=original.otherSide();
  RangeMarker originalRangeMarker=getRangeMarker(original);
  RangeMarker rangeMarker=getRangeMarker(targetSide);
  if (originalRangeMarker != null && rangeMarker != null) {
    TextRange textRange=modifyDocument(getProject(),originalRangeMarker,rangeMarker);
    if (textRange != null && isValid()) {
      updateTargetRangeMarker(targetSide,textRange);
    }
    onApplied();
  }
}
