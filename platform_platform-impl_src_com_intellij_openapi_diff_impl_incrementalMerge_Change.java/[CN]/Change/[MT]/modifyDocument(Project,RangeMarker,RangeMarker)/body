{
  Document document=target.getDocument();
  if (!ReadonlyStatusHandler.ensureDocumentWritable(project,document)) {
    return null;
  }
  if (DocumentUtil.isEmpty(original)) {
    int offset=target.getStartOffset();
    document.deleteString(offset,target.getEndOffset());
  }
  String text=DocumentUtil.getText(original);
  int startOffset=target.getStartOffset();
  if (DocumentUtil.isEmpty(target)) {
    document.insertString(startOffset,text);
  }
 else {
    document.replaceString(startOffset,target.getEndOffset(),text);
  }
  return new TextRange(startOffset,startOffset + text.length());
}
