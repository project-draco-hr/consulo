{
  if (!USE_PROJECT_PROFILE) {
    return myApplicationProfileManager.getRootProfile();
  }
  if (myProjectProfile == null || myProfiles.isEmpty()) {
    setProjectProfile(PROJECT_DEFAULT_PROFILE_NAME);
    final Profile projectProfile=myApplicationProfileManager.createProfile();
    projectProfile.copyFrom(myApplicationProfileManager.getRootProfile());
    projectProfile.setProjectLevel(true);
    projectProfile.setName(PROJECT_DEFAULT_PROFILE_NAME);
    myProfiles.put(PROJECT_DEFAULT_PROFILE_NAME,projectProfile);
  }
 else   if (!myProfiles.containsKey(myProjectProfile)) {
    setProjectProfile(myProfiles.keySet().iterator().next());
  }
  final Profile profile=myProfiles.get(myProjectProfile);
  profile.setProfileManager(this);
  return profile;
}
