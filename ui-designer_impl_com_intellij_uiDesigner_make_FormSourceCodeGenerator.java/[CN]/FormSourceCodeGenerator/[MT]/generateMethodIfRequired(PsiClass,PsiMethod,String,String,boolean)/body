{
  PsiElementFactory elementFactory=PsiManager.getInstance(myProject).getElementFactory();
  PsiMethod newMethod=null;
  PsiMethod[] oldMethods=aClass.findMethodsByName(methodName,false);
  if (!condition) {
    for (    PsiMethod oldMethod : oldMethods) {
      oldMethod.delete();
    }
  }
 else {
    newMethod=elementFactory.createMethodFromText(methodText,aClass);
    if (oldMethods.length > 0) {
      oldMethods[0].replace(newMethod);
    }
 else {
      aClass.addAfter(newMethod,anchor);
    }
  }
  if (newMethod != null) {
    CodeStyleManager csm=CodeStyleManager.getInstance(myProject);
    newMethod=(PsiMethod)csm.reformat(newMethod);
    csm.shortenClassReferences(newMethod);
  }
}
