{
  final File[] files=dir.listFiles();
  for (int i=0; i < files.length; i++) {
    File file=files[i];
    final String name=file.getName();
    if (name.endsWith(".class")) {
      final String path=file.getPath();
      log("Adding @NotNull assertions to " + path);
      try {
        final FileInputStream inputStream=new FileInputStream(file);
        ClassReader reader=new ClassReader(inputStream);
        ClassWriter writer=new ClassWriter(true);
        final NotNullVerifyingInstrumenter instrumenter=new NotNullVerifyingInstrumenter(writer);
        reader.accept(instrumenter,false);
        if (instrumenter.isModification()) {
          new FileOutputStream(path).write(writer.toByteArray());
        }
      }
 catch (      IOException e) {
        log("Failed to instrument @NotNull assertion: " + e.getMessage());
      }
    }
 else     if (file.isDirectory()) {
      instrumentNotNull(file);
    }
  }
}
