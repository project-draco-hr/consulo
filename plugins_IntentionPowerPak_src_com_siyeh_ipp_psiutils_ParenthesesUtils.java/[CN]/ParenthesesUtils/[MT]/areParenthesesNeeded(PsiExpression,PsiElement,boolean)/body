{
  if (parentExpression instanceof PsiBinaryExpression) {
    final PsiBinaryExpression parentBinaryExpression=(PsiBinaryExpression)parentExpression;
    if (expression instanceof PsiBinaryExpression) {
      final PsiBinaryExpression childBinaryExpression=(PsiBinaryExpression)expression;
      final IElementType childOperator=childBinaryExpression.getOperationTokenType();
      final IElementType parentOperator=parentBinaryExpression.getOperationTokenType();
      if (ignoreClarifyingParentheses && !childOperator.equals(parentOperator)) {
        return true;
      }
      final PsiType parentType=parentBinaryExpression.getType();
      if (parentType == null) {
        return true;
      }
      final PsiType childType=childBinaryExpression.getType();
      if (!parentType.equals(childType)) {
        return true;
      }
      if (PsiTreeUtil.isAncestor(parentBinaryExpression.getROperand(),expression,false)) {
        if (!isCommutativeBinaryOperator(childOperator)) {
          return true;
        }
      }
      return false;
    }
 else     if (expression instanceof PsiConditionalExpression) {
      if (PsiTreeUtil.isAncestor(parentBinaryExpression.getROperand(),expression,false)) {
        return true;
      }
    }
  }
  return false;
}
