{
  PsiManager manager=expr.getManager();
  PsiElementFactory factory=JavaPsiFacade.getInstance(manager.getProject()).getElementFactory();
  CodeStyleManager codeStyleManager=CodeStyleManager.getInstance(project);
  PsiPrefixExpression prefixExpr=(PsiPrefixExpression)factory.createExpressionFromText("!(a)",null);
  prefixExpr=(PsiPrefixExpression)codeStyleManager.reformat(prefixExpr);
  ((PsiParenthesizedExpression)prefixExpr.getOperand()).getExpression().replace(expr);
  expr=(PsiExpression)IntroduceVariableBase.replace(expr,prefixExpr,project);
  int offset=expr.getTextRange().getEndOffset();
  return new TextRange(offset,offset);
}
