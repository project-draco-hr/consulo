{
  final HgUpdateToDialog dialog=new HgUpdateToDialog(project);
  dialog.setRoots(repos,branchesForRepos,tagsForRepos);
  dialog.show();
  if (dialog.isOK()) {
    FileDocumentManager.getInstance().saveAllDocuments();
    String updateToValue=dialog.isBranchSelected() ? dialog.getBranch().getName() : dialog.isTagSelected() ? dialog.getTag().getName() : dialog.getRevision();
    new Task.Backgroundable(project,HgVcsMessages.message("action.hg4idea.updateTo.description",updateToValue)){
      @Override public void run(      @NotNull ProgressIndicator indicator){
        updateTo(dialog,project);
        markDirtyAndHandleErrors(project,dialog.getRepository());
      }
    }
.queue();
  }
}
