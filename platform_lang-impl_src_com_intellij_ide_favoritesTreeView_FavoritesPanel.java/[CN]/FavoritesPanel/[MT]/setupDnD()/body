{
  DnDSupport.createBuilder(myTree).setBeanProvider(new Function<DnDActionInfo,DnDDragStartBean>(){
    @Override public DnDDragStartBean fun(    DnDActionInfo dnDActionInfo){
      return new DnDDragStartBean("");
    }
  }
).setTargetChecker(new DnDTargetChecker(){
    @Override public boolean update(    DnDEvent event){
      final Point p=event.getPoint();
      FavoritesListNode node=findFavoritesListNode(p);
      if (node != null) {
        TreePath pathToList=myTree.getPathForLocation(p.x,p.y);
        while (pathToList != null) {
          final Object pathObj=pathToList.getLastPathComponent();
          if (pathObj instanceof DefaultMutableTreeNode) {
            final Object userObject=((DefaultMutableTreeNode)pathObj).getUserObject();
            if (userObject instanceof FavoritesTreeNodeDescriptor) {
              if (((FavoritesTreeNodeDescriptor)userObject).getElement() == node) {
                break;
              }
            }
          }
          pathToList=pathToList.getParentPath();
        }
        if (pathToList != null) {
          Rectangle bounds=myTree.getPathBounds(pathToList);
          if (bounds != null) {
            event.setHighlighting(new RelativeRectangle(myTree,bounds),DnDEvent.DropTargetHighlightingType.RECTANGLE);
          }
        }
        event.setDropPossible(true,null);
        return true;
      }
      event.setDropPossible(false,null);
      return false;
    }
  }
).setDropHandler(new DnDDropHandler(){
    @Override public void drop(    DnDEvent event){
      final Object obj=event.getAttachedObject();
      if (obj instanceof TransferableWrapper) {
        final PsiElement[] elements=((TransferableWrapper)obj).getPsiElements();
        final FavoritesListNode node=findFavoritesListNode(event.getPoint());
        if (elements != null && elements.length > 0 && node != null) {
          FavoritesManager.getInstance(myProject).addRoots(node.getValue(),null,elements);
        }
      }
    }
  }
).setDisposableParent(myProject).install();
}
