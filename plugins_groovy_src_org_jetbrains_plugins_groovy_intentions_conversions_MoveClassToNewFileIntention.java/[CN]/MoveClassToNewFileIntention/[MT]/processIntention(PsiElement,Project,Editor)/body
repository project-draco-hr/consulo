{
  final GrTypeDefinition psiClass=(GrTypeDefinition)element;
  final String name=psiClass.getName();
  final PsiFile file=psiClass.getContainingFile();
  final String fileExtension=FileUtil.getExtension(file.getName());
  final String newFileName=name + "." + fileExtension;
  final PsiDirectory dir=file.getParent();
  if (dir != null) {
    if (dir.findFile(newFileName) != null) {
      if (!ApplicationManager.getApplication().isUnitTestMode()) {
        CommonRefactoringUtil.showErrorHint(project,editor,GroovyIntentionsBundle.message("file.exists",newFileName,dir.getName()),getFamilyName(),null);
      }
      return;
    }
  }
  final GroovyFile newFile=(GroovyFile)GroovyTemplatesFactory.createFromTemplate(dir,name,newFileName,"GroovyClass.groovy");
  final GrTypeDefinition template=newFile.getTypeDefinitions()[0];
  final PsiElement newClass=template.replace(psiClass);
  psiClass.delete();
  CreateClassActionBase.putCursor(project,newClass.getContainingFile(),newClass.getNavigationElement());
}
