{
  super(project,true);
  myLastRunSettings=new LastRunReformatCodeOptionsProvider(PropertiesComponent.getInstance());
  boolean canTargetVcsChanges=FormatChangedTextUtil.hasChanges(files,project);
  myOnlyChangedText.setEnabled(canTargetVcsChanges);
  myOnlyChangedText.setSelected(canTargetVcsChanges && myLastRunSettings.getLastTextRangeType() == VCS_CHANGED_TEXT);
  myOptimizeImports.setSelected(myLastRunSettings.getLastOptimizeImports());
  myRearrangeEntriesCb.setSelected(myLastRunSettings.getLastRearrangeCode());
  setTitle(CodeInsightBundle.message("dialog.reformat.files.title"));
  init();
}
