{
  VirtualFile file=content.getVirtualFile();
  boolean isValid=file.isValid();
  Iterator<Pair<CacheUpdater,Collection<VirtualFile>>> it=myUpdatersWithFiles.iterator();
  while (it.hasNext()) {
    Pair<CacheUpdater,Collection<VirtualFile>> eachPair=it.next();
    CacheUpdater eachUpdater=eachPair.first;
    Collection<VirtualFile> eachFiles=eachPair.second;
    if (!eachFiles.contains(file))     continue;
    try {
      if (isValid && !Boolean.TRUE.equals(file.getUserData(FAILED_TO_INDEX))) {
        eachUpdater.processFile(content);
      }
    }
 catch (    ProcessCanceledException e) {
      throw e;
    }
catch (    Throwable e) {
      LOG.error("Error while indexing " + file.getPresentableUrl() + "\n"+ "To reindex this file IDEA has to be restarted",e);
      file.putUserData(FAILED_TO_INDEX,Boolean.TRUE);
    }
    eachFiles.remove(file);
    if (eachFiles.isEmpty()) {
      try {
        eachUpdater.updatingDone();
      }
 catch (      ProcessCanceledException e) {
        throw e;
      }
catch (      Throwable e) {
        LOG.error(e);
      }
      it.remove();
    }
  }
}
