{
  List<CacheUpdater> processedUpdaters=new ArrayList<CacheUpdater>();
  myFilesToUpdate=new LinkedHashSet<VirtualFile>();
  try {
    int jobsCount=0;
    for (    CacheUpdater each : updaters) {
      indicator.checkCanceled();
      try {
        jobsCount+=each.getNumberOfPendingUpdateJobs();
        List<VirtualFile> updaterFiles=Arrays.asList(each.queryNeededFiles());
        processedUpdaters.add(each);
        myFilesToUpdate.addAll(updaterFiles);
        myUpdatersWithFiles.add(Pair.create(each,(Collection<VirtualFile>)new THashSet<VirtualFile>(updaterFiles)));
      }
 catch (      ProcessCanceledException e) {
        throw e;
      }
catch (      Throwable e) {
        LOG.error(e);
      }
    }
    myJobsToDo=jobsCount;
  }
 catch (  ProcessCanceledException e) {
    for (    CacheUpdater each : processedUpdaters) {
      each.canceled();
    }
    throw e;
  }
}
