{
  final DataContext dataContext=e.getDataContext();
  Project project=PlatformDataKeys.PROJECT.getData(dataContext);
  final FavoritesManager favoritesManager=FavoritesManager.getInstance(project);
  FavoritesTreeNodeDescriptor[] roots=FavoritesTreeViewPanel.CONTEXT_FAVORITES_ROOTS_DATA_KEY.getData(dataContext);
  String listName=null;
  if (roots == null)   return;
  for (  FavoritesTreeNodeDescriptor root : roots) {
    final AbstractTreeNode element=root.getElement();
    if (element instanceof FavoritesListNode) {
      listName=null;
      break;
    }
    final NodeDescriptor parent=root.getParentDescriptor();
    if (!(parent instanceof FavoritesTreeNodeDescriptor)) {
      listName=null;
      break;
    }
    String name=((FavoritesListNode)parent.getElement()).getName();
    if (listName == null) {
      listName=name;
    }
    if (!StringUtil.equals(listName,name)) {
      listName=null;
      break;
    }
  }
  doSend(favoritesManager,roots,listName);
}
