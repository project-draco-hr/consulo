{
  final DfaValue dfaValue;
  if (myType != null && (myType instanceof PsiClassType || myType.getArrayDimensions() > 0)) {
    dfaValue=myIsNotNull ? myFactory.getNotNullFactory().create(myType) : myFactory.getTypeFactory().create(myType,myIsNullable);
  }
 else   if (myMethodType == MethodType.UNBOXING) {
    dfaValue=myFactory.getBoxedFactory().createUnboxed(oldValue);
  }
 else   if (myMethodType == MethodType.BOXING) {
    dfaValue=myFactory.getBoxedFactory().createBoxed(oldValue);
  }
 else   if (myMethodType == MethodType.CAST) {
    if (oldValue instanceof DfaConstValue) {
      final DfaConstValue constValue=(DfaConstValue)oldValue;
      Object o=constValue.getValue();
      if (o instanceof Double || o instanceof Float) {
        double dbVal=o instanceof Double ? ((Double)o).doubleValue() : ((Float)o).doubleValue();
        if (Math.floor(dbVal) == dbVal)         o=TypeConversionUtil.computeCastTo(o,PsiType.LONG);
      }
 else {
        o=TypeConversionUtil.computeCastTo(o,PsiType.LONG);
      }
      dfaValue=myFactory.getConstFactory().createFromValue(o,myType);
    }
 else {
      dfaValue=oldValue;
    }
  }
 else {
    dfaValue=DfaUnknownValue.getInstance();
  }
  state.push(dfaValue);
}
