{
  IJSwingUtilities.invoke(new Runnable(){
    public void run(){
      PsiDocumentManager.getInstance(getProject()).commitAllDocuments();
      String message=text;
      VirtualFile file=null;
      int lineIndex=0;
      if (reference != null) {
        String className=DebuggerUtilsEx.signatureToName(reference.signature());
        GlobalSearchScope scope=GlobalSearchScope.allScope(getProject());
        PsiClass cls=PsiManager.getInstance(getProject()).findClass(className,scope);
        if (cls != null) {
          file=cls.getContainingFile().getVirtualFile();
          lineIndex=StringUtil.offsetToLineNumber(cls.getContainingFile().getText(),cls.getTextOffset());
        }
        message="Class " + DebuggerUtilsEx.signatureToName(reference.signature()) + " : "+ text;
      }
      addMessage(category,new String[]{message},file,lineIndex + 1,1);
    }
  }
);
}
