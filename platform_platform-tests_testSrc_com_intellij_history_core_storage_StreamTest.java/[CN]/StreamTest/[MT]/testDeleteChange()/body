{
  DirectoryEntry dir=new DirectoryEntry("dir");
  dir.addChild(new FileEntry("file",new StoredContent(333),-1,false));
  dir.addChild(new DirectoryEntry("subDir"));
  Change c=new DeleteChange(nextId(),"entry",dir);
  StreamUtil.writeChange(os,c);
  Change read=StreamUtil.readChange(is);
  assertEquals(DeleteChange.class,read.getClass());
  DeleteChange result=(DeleteChange)read;
  assertEquals("entry",result.getPath());
  Entry e=result.getDeletedEntry();
  assertEquals(DirectoryEntry.class,e.getClass());
  assertEquals("dir",e.getName());
  assertEquals(2,e.getChildren().size());
  assertEquals("dir/file",e.getChildren().get(0).getPath());
  assertEquals("dir/subDir",e.getChildren().get(1).getPath());
}
