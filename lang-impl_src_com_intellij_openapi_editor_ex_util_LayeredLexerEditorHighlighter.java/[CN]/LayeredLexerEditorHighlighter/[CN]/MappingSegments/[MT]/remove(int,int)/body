{
  Map<Mapper,Integer> mins=new FactoryMap<Mapper,Integer>(){
    @Override protected Integer create(    final Mapper key){
      return Integer.MAX_VALUE;
    }
  }
;
  Map<Mapper,Integer> maxs=new FactoryMap<Mapper,Integer>(){
    @Override protected Integer create(    final Mapper key){
      return 0;
    }
  }
;
  for (int i=startIndex; i < endIndex; i++) {
    final MappedRange range=myRanges[i];
    if (range != null && range.range.isValid()) {
      mins.put(range.mapper,Math.min(mins.get(range.mapper).intValue(),range.range.getStartOffset()));
      maxs.put(range.mapper,Math.max(maxs.get(range.mapper).intValue(),range.range.getEndOffset()));
    }
    myRanges[i]=null;
  }
  for (  final Mapper mapper : maxs.keySet()) {
    mapper.doc.deleteString(mins.get(mapper).intValue(),maxs.get(mapper).intValue());
  }
  myRanges=remove(myRanges,startIndex,endIndex);
  super.remove(startIndex,endIndex);
}
