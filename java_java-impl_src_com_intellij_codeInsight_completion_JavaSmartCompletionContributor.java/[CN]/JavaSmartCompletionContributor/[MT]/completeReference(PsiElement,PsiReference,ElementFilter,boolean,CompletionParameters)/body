{
  if (reference instanceof PsiMultiReference) {
    reference=ContainerUtil.findInstance(((PsiMultiReference)reference).getReferences(),PsiJavaReference.class);
  }
  if (reference instanceof PsiJavaReference) {
    final PsiJavaReference javaReference=(PsiJavaReference)reference;
    return JavaCompletionUtil.processJavaReference(element,javaReference,new ElementFilter(){
      public boolean isAcceptable(      Object element,      PsiElement context){
        return filter.isAcceptable(element,context);
      }
      public boolean isClassAcceptable(      Class hintClass){
        if (acceptClasses) {
          return ReflectionCache.isAssignable(PsiClass.class,hintClass);
        }
        return ReflectionCache.isAssignable(PsiVariable.class,hintClass) || ReflectionCache.isAssignable(PsiMethod.class,hintClass) || ReflectionCache.isAssignable(PsiExpression.class,hintClass)|| ReflectionCache.isAssignable(Template.class,hintClass)|| ReflectionCache.isAssignable(CandidateInfo.class,hintClass)|| ReflectionCache.isAssignable(PsiKeyword.class,hintClass);
      }
    }
,true,null,parameters);
  }
  return Collections.emptySet();
}
