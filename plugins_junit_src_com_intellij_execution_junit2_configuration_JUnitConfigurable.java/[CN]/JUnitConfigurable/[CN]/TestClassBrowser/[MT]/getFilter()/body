{
  final ConfigurationModuleSelector moduleSelector=getModuleSelector();
  final Module module=moduleSelector.getModule();
  if (module == null) {
    throw NoFilterException.moduleDoesntExist(moduleSelector);
  }
  final TreeClassChooser.ClassFilterWithScope classFilter;
  try {
    final JUnitConfiguration configurationCopy=new JUnitConfiguration(ExecutionBundle.message("default.junit.configuration.name"),getProject(),JUnitConfigurationType.getInstance().getConfigurationFactories()[0]);
    applyEditorTo(configurationCopy);
    classFilter=TestClassFilter.create(configurationCopy.getTestObject().getSourceScope(),configurationCopy.getConfigurationModule().getModule());
  }
 catch (  JUnitUtil.NoJUnitException e) {
    throw NoFilterException.noJUnitInModule(module);
  }
  return classFilter;
}
