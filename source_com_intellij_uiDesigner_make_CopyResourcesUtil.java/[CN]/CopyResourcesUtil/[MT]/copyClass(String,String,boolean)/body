{
  final File targetDir=new File(targetPath).getAbsoluteFile();
  final File file=new File(targetDir,className + ".class");
  FileUtil.createParentDirs(file);
  if (deleteOnExit) {
    for (File f=file; f != null && !f.equals(targetDir); f=f.getParentFile()) {
      f.deleteOnExit();
    }
  }
  final String resourceName="/" + className + ".class";
  final InputStream stream=PreviewFormAction.class.getResourceAsStream(resourceName);
  if (stream == null) {
    throw new IOException("cannot load " + resourceName);
  }
  try {
    final FileOutputStream outputStream=new FileOutputStream(file);
    try {
      FileUtil.copy(stream,outputStream);
    }
  finally {
      outputStream.close();
    }
  }
  finally {
    stream.close();
  }
  return file;
}
