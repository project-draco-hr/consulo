{
  PsiFile file=element.getContainingFile();
  if (file instanceof PsiFileImpl && file.isPhysical() && file.getViewProvider().getVirtualFile() instanceof LightVirtualFile)   return true;
  if (element instanceof PsiDirectoryContainer) {
    PsiDirectory[] dirs=((PsiDirectoryContainer)element).getDirectories();
    for (    PsiDirectory dir : dirs) {
      if (!isInProject(dir))       return false;
    }
    return true;
  }
  VirtualFile virtualFile=null;
  if (file != null) {
    virtualFile=file.getViewProvider().getVirtualFile();
  }
 else   if (element instanceof PsiFileSystemItem) {
    virtualFile=((PsiFileSystemItem)element).getVirtualFile();
  }
  if (virtualFile != null) {
    Module module=myProjectFileIndex.getModuleForFile(virtualFile);
    return module != null;
  }
  return false;
}
