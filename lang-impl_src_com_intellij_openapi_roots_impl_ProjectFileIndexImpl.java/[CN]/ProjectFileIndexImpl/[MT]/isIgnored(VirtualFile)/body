{
  if (myFileTypeManager.isFileIgnored(file.getName()))   return true;
  VirtualFile dir=file.isDirectory() ? file : file.getParent();
  if (dir == null)   return false;
  DirectoryInfo info=myDirectoryIndex.getInfoForDirectory(dir);
  if (info != null)   return false;
  if (myDirectoryIndex.isProjectExcludeRoot(dir))   return true;
  VirtualFile parent=dir.getParent();
  while (true) {
    if (parent == null)     return false;
    DirectoryInfo parentInfo=myDirectoryIndex.getInfoForDirectory(parent);
    if (parentInfo != null)     return true;
    if (myDirectoryIndex.isProjectExcludeRoot(parent))     return true;
    parent=parent.getParent();
  }
}
