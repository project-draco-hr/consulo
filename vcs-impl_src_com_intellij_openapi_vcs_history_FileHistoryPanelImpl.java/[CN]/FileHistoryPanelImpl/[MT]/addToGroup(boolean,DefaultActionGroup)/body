{
  if (popup) {
    result.add(ActionManager.getInstance().getAction(IdeActions.ACTION_EDIT_SOURCE));
  }
  final MyDiffAction diffAction=new MyDiffAction();
  result.add(diffAction);
  if (!popup) {
    diffAction.registerCustomShortcutSet(new CustomShortcutSet(new Shortcut[]{CommonShortcuts.getDiff().getShortcuts()[0],CommonShortcuts.DOUBLE_CLICK_1.getShortcuts()[0]}),myDualView.getFlatView());
    diffAction.registerCustomShortcutSet(new CustomShortcutSet(new Shortcut[]{CommonShortcuts.getDiff().getShortcuts()[0],CommonShortcuts.DOUBLE_CLICK_1.getShortcuts()[0]}),myDualView.getTreeView());
  }
 else {
    diffAction.registerCustomShortcutSet(CommonShortcuts.getDiff(),this);
  }
  result.add(new CreatePatchFromChangesAction(){
    public void update(    final AnActionEvent e){
      e.getPresentation().setVisible(true);
      final int selectionSize=getSelection().size();
      e.getPresentation().setEnabled((selectionSize > 0) && (selectionSize < 3));
    }
  }
);
  result.add(new MyGetVersionAction());
  result.add(new MyAnnotateAction());
  AnAction[] additionalActions=getHistoryProvider().getAdditionalActions(this);
  if (additionalActions != null) {
    for (    AnAction additionalAction : additionalActions) {
      result.add(additionalAction);
    }
  }
  result.add(new AnAction(VcsBundle.message("action.name.refresh"),VcsBundle.message("action.desctiption.refresh"),IconLoader.getIcon("/actions/sync.png")){
    public void actionPerformed(    AnActionEvent e){
      refresh();
    }
  }
);
  if (!popup && supportsTree()) {
    result.add(new MyShowAsTreeAction());
  }
  return result;
}
