{
  VcsFileRevision firstSelectedRevision=getFirstSelectedRevision();
  if (DataConstants.NAVIGATABLE.equals(dataId)) {
    List selectedItems=getSelection();
    if (selectedItems.size() != 1)     return null;
    if (!myHistorySession.isContentAvailable(firstSelectedRevision)) {
      return null;
    }
    VirtualFile virtualFileForRevision=createVirtualFileForRevision(firstSelectedRevision);
    if (virtualFileForRevision != null) {
      return new OpenFileDescriptor(myProject,virtualFileForRevision);
    }
 else {
      return null;
    }
  }
 else   if (DataConstants.PROJECT.equals(dataId)) {
    return myProject;
  }
 else   if (VcsDataConstants.VCS_FILE_REVISION.equals(dataId)) {
    return firstSelectedRevision;
  }
 else   if (VcsDataConstants.VCS_FILE_REVISIONS.equals(dataId)) {
    return getSelectedRevisions();
  }
 else   if (VcsDataKeys.CHANGES.getName().equals(dataId)) {
    final VcsFileRevision[] revisions=getSelectedRevisions();
    if (revisions.length > 0) {
      for (      VcsFileRevision revision : revisions) {
        if (!myHistorySession.isContentAvailable(revision)) {
          return null;
        }
      }
      Arrays.sort(revisions,new Comparator<VcsFileRevision>(){
        public int compare(        final VcsFileRevision o1,        final VcsFileRevision o2){
          return o1.getRevisionNumber().compareTo(o2.getRevisionNumber());
        }
      }
);
      final ContentRevision startRevision=new LoadedContentRevision(myFilePath,revisions[0]);
      final ContentRevision endRevision=(revisions.length == 1) ? new CurrentContentRevision(myFilePath) : new LoadedContentRevision(myFilePath,revisions[revisions.length - 1]);
      return new Change[]{new Change(startRevision,endRevision)};
    }
    return null;
  }
 else   if (VcsDataConstants.VCS_VIRTUAL_FILE.equals(dataId)) {
    if (firstSelectedRevision == null)     return null;
    return createVirtualFileForRevision(firstSelectedRevision);
  }
 else   if (VcsDataConstants.FILE_PATH.equals(dataId)) {
    return myFilePath;
  }
 else   if (VcsDataConstants.IO_FILE.equals(dataId)) {
    return myFilePath.getIOFile();
  }
 else   if (DataConstants.VIRTUAL_FILE.equals(dataId)) {
    if (getVirtualFile() == null)     return null;
    if (getVirtualFile().isValid()) {
      return getVirtualFile();
    }
 else {
      return null;
    }
  }
 else   if (VcsDataConstants.FILE_HISTORY_PANEL.equals(dataId)) {
    return this;
  }
 else {
    return super.getData(dataId);
  }
}
