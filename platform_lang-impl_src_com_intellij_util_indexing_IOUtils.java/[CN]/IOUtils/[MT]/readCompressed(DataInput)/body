{
  int size=DataInputOutputUtil.readINT(in);
  byte[] bytes=new byte[Math.abs(size)];
  in.readFully(bytes);
  if (size >= 0) {
    return bytes;
  }
 else {
    if (!ourCanUseSnappy)     throw new IOException("Can not read compressed data");
    return Snappy.uncompress(bytes);
  }
}
