{
  myCurrentViewType=typeName;
  final PsiElement element=mySmartPsiElementPointer.getElement();
  if (!(isApplicableElement(element))) {
    return;
  }
  if (myContent != null) {
    if (element instanceof PsiNamedElement) {
      myContent.setDisplayName(MessageFormat.format(typeName,((PsiNamedElement)element).getName()));
    }
  }
  myCardLayout.show(myTreePanel,typeName);
  if (!myBuilders.containsKey(typeName)) {
    try {
      setWaitCursor();
      final JTree tree=myType2TreeMap.get(typeName);
      final DefaultTreeModel model=new DefaultTreeModel(new DefaultMutableTreeNode(""));
      tree.setModel(model);
      PsiDocumentManager.getInstance(myProject).commitAllDocuments();
      final HierarchyTreeStructure structure=createHierarchyTreeStructure(typeName,element);
      if (structure == null)       return;
      final Comparator<NodeDescriptor> comparator=getComparator();
      final HierarchyTreeBuilder builder=new HierarchyTreeBuilder(myProject,tree,model,structure,comparator);
      myBuilders.put(typeName,builder);
      final HierarchyNodeDescriptor baseDescriptor=structure.getBaseDescriptor();
      builder.expand(baseDescriptor,null);
    }
  finally {
      restoreCursor();
    }
  }
  getCurrentTree().requestFocus();
}
