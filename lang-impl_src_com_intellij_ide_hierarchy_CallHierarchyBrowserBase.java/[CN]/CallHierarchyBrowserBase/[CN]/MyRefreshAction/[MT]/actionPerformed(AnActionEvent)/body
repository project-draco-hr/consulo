{
  if (!isValidBase())   return;
  final Object[] storedInfo=new Object[1];
  if (myCurrentViewType != null) {
    final HierarchyTreeBuilder builder=myBuilders.get(myCurrentViewType);
    storedInfo[0]=builder.storeExpandedAndSelectedInfo();
  }
  final PsiElement base=mySmartPsiElementPointer.getElement();
  final String[] name=new String[]{myCurrentViewType};
  dispose();
  setHierarchyBase(base);
  validate();
  ApplicationManager.getApplication().invokeLater(new Runnable(){
    public void run(){
      changeView(name[0]);
      if (storedInfo != null) {
        final HierarchyTreeBuilder builder=myBuilders.get(myCurrentViewType);
        builder.restoreExpandedAndSelectedInfo(storedInfo[0]);
      }
    }
  }
);
}
