{
  int end=children[children.length - 1].getTextRange().getEndOffset();
  for (int i=0; i < children.length; i++) {
    PsiElement child=children[i];
    if (child instanceof PsiJavaToken) {
      PsiJavaToken token=(PsiJavaToken)child;
      if (token.getTokenType() == JavaTokenType.RBRACE) {
        int j=i - 1;
        while (children[j] instanceof PsiWhiteSpace && children[j].getTextRange().getStartOffset() > startOffset) {
          j--;
        }
        end=children[j].getTextRange().getEndOffset();
      }
    }
  }
  return end;
}
