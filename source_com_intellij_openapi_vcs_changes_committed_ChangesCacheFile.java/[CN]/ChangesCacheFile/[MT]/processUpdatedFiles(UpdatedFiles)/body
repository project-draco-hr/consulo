{
  openStreams();
  try {
    final long length=myIndexStream.length();
    long totalCount=length / INDEX_ENTRY_SIZE;
    IndexEntry e=new IndexEntry();
    for (int i=0; i < totalCount; i++) {
      myIndexStream.seek(length - (i + 1) * INDEX_ENTRY_SIZE);
      readIndexEntry(e);
      if (e.completelyDownloaded)       break;
      myIndexStream.seek(length - (i + 1) * INDEX_ENTRY_SIZE);
      writeIndexEntry(e.number,e.date,e.offset,true);
    }
  }
  finally {
    closeStreams();
  }
}
