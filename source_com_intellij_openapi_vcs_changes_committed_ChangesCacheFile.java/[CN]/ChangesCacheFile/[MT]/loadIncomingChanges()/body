{
  final List<CommittedChangeList> result=new ArrayList<CommittedChangeList>();
  int offset=0;
  openStreams();
  try {
    while (true) {
      IndexEntry[] entries=readLastIndexEntries(offset,1);
      if (entries.length == 0) {
        break;
      }
      if (!entries[0].completelyDownloaded) {
        result.add(loadChangeListAt(entries[0].offset));
        if (result.size() == myIncomingCount)         break;
      }
      offset++;
    }
    LOG.info("Loaded " + result.size() + " incoming changelists");
    return result;
  }
  finally {
    closeStreams();
  }
}
