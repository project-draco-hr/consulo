{
  final TestProxy test=event.getSource();
  if (!test.isLeaf())   return;
  final int stateMagnitude=test.getState().getMagnitude();
  if (test.getState().isFinal()) {
    if (!test.getInfo().shouldRun())     newTestAppeared();
    if (getValue() >= getMaximum()) {
      @NonNls final String message="State changed: " + test + " state: "+ stateMagnitude+ " Max: "+ getMaximum()+ " Value: "+ getValue();
      LOG.error(message);
    }
    if (test.getState().isDefect())     myProblemsCounter++;
    setValue(getValue() + 1);
  }
  setCurrentState(stateMagnitude == PoolOfTestStates.RUNNING_INDEX ? test : null);
}
