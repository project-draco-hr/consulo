{
  prepareExternal(false,true);
  final File sourceDir=new File(myWorkingCopyDir.getPath(),"source");
  final File externalFile=new File(sourceDir,"external/t11.txt");
  final VirtualFile externalVf=LocalFileSystem.getInstance().refreshAndFindFileByIoFile(externalFile);
  Assert.assertNotNull(externalVf);
  editFileInCommand(externalVf,"some new content");
  VcsDirtyScopeManager.getInstance(myProject).markEverythingDirty();
  clManager.ensureUpToDate(false);
  final Change change=clManager.getChange(externalVf);
  Assert.assertNotNull(change);
  Assert.assertEquals(FileStatus.MODIFIED,change.getFileStatus());
}
