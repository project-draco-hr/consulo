{
  prepareExternal();
  final File sourceFile=new File(myWorkingCopyDir.getPath(),"source" + File.separator + "s1.txt");
  final File externalFile=new File(myWorkingCopyDir.getPath(),"source" + File.separator + "external"+ File.separator+ "t12.txt");
  final LocalFileSystem lfs=LocalFileSystem.getInstance();
  final VirtualFile vf1=lfs.refreshAndFindFileByIoFile(sourceFile);
  final VirtualFile vf2=lfs.refreshAndFindFileByIoFile(externalFile);
  Assert.assertNotNull(vf1);
  Assert.assertNotNull(vf2);
  editFileInCommand(myProject,vf1,"test externals 123" + System.currentTimeMillis());
  editFileInCommand(myProject,vf2,"test externals 123" + System.currentTimeMillis());
  VcsDirtyScopeManager.getInstance(myProject).markEverythingDirty();
  clManager.ensureUpToDate(false);
  final Change change1=clManager.getChange(vf1);
  final Change change2=clManager.getChange(vf2);
  Assert.assertNotNull(change1);
  Assert.assertNotNull(change2);
  Assert.assertNotNull(change1.getBeforeRevision());
  Assert.assertNotNull(change2.getBeforeRevision());
  Assert.assertNotNull(change1.getAfterRevision());
  Assert.assertNotNull(change2.getAfterRevision());
}
