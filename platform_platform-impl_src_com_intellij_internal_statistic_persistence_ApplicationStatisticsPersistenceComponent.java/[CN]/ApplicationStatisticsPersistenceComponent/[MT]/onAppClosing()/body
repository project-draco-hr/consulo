{
  final MessageBus messageBus=ApplicationManager.getApplication().getMessageBus();
  messageBus.connect().subscribe(AppLifecycleListener.TOPIC,new AppLifecycleListener(){
    @Override public void appFrameCreated(    String[] commandLineArgs,    @NotNull Ref<Boolean> willOpenProject){
    }
    @Override public void appStarting(    Project projectFromCommandLine){
    }
    @Override public void projectFrameClosed(){
    }
    @Override public void projectOpenFailed(){
    }
    @Override public void welcomeScreenDisplayed(){
    }
    @Override public void appClosing(){
      for (      Project project : ProjectManager.getInstance().getOpenProjects()) {
        if (project.isInitialized()) {
          doPersistProjectUsages(project);
        }
      }
      persistOnClosing=false;
    }
  }
);
}
