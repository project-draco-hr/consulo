{
  ThreadLocal<SortedMap<MessageBusImpl,Integer>> ref=getRootBus().myWaitingBuses;
  SortedMap<MessageBusImpl,Integer> map=ref.get();
  if (map == null) {
    ref.set(map=new TreeMap<MessageBusImpl,Integer>(MESSAGE_BUS_COMPARATOR));
  }
  Integer countObject=map.get(this);
  int count=countObject == null ? 0 : countObject;
  int newCount=count + delta;
  if (newCount > 0) {
    map.put(this,newCount);
  }
 else   if (newCount == 0) {
    map.remove(this);
  }
 else {
    LOG.error("Negative job count: " + this);
  }
}
