{
  checkNotDisposed();
  final Topic topic=message.getTopic();
  final List<MessageBusConnectionImpl> topicSubscribers=mySubscribers.get(topic);
  if (topicSubscribers != null) {
    Queue<DeliveryJob> queue=myMessageQueue.get();
    for (    MessageBusConnectionImpl subscriber : topicSubscribers) {
      queue.offer(new DeliveryJob(subscriber,message));
      subscriber.scheduleMessageDelivery(message);
    }
  }
  Topic.BroadcastDirection direction=topic.getBroadcastDirection();
  if (direction == Topic.BroadcastDirection.TO_CHILDREN) {
    for (    MessageBusImpl childBus : myChildBuses) {
      childBus.postMessage(message);
    }
  }
  if (direction == Topic.BroadcastDirection.TO_PARENT && myParentBus != null) {
    myParentBus.postMessage(message);
  }
}
