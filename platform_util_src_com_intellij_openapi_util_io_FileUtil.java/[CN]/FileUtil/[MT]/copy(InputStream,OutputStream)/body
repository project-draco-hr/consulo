{
  if (USE_FILE_CHANNELS && inputStream instanceof FileInputStream && outputStream instanceof FileOutputStream) {
    final FileChannel fromChannel=((FileInputStream)inputStream).getChannel();
    try {
      final FileChannel toChannel=((FileOutputStream)outputStream).getChannel();
      try {
        fromChannel.transferTo(0,Long.MAX_VALUE,toChannel);
      }
  finally {
        toChannel.close();
      }
    }
  finally {
      fromChannel.close();
    }
  }
 else {
    final byte[] buffer=BUFFER.get();
    while (true) {
      int read=inputStream.read(buffer);
      if (read < 0)       break;
      outputStream.write(buffer,0,read);
    }
  }
}
