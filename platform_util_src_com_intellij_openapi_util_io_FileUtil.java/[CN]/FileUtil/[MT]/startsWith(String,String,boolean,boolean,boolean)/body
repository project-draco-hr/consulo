{
  final int pathLength=path.length();
  final int prefixLength=prefix.length();
  if (prefixLength == 0)   return pathLength == 0 ? ThreeState.YES : ThreeState.UNSURE;
  if (prefixLength > pathLength)   return ThreeState.NO;
  if (!path.regionMatches(!caseSensitive,0,prefix,0,prefixLength))   return ThreeState.NO;
  if (pathLength == prefixLength) {
    return strict ? ThreeState.NO : ThreeState.YES;
  }
  char lastPrefixChar=prefix.charAt(prefixLength - 1);
  int slashOrSeparatorIdx=prefixLength;
  if (lastPrefixChar == '/' || lastPrefixChar == File.separatorChar) {
    slashOrSeparatorIdx=prefixLength - 1;
  }
  char next1=path.charAt(slashOrSeparatorIdx);
  if (next1 == '/' || next1 == File.separatorChar) {
    if (!checkImmediateParent)     return ThreeState.YES;
    if (slashOrSeparatorIdx == pathLength - 1)     return ThreeState.YES;
    int idxNext=path.indexOf(next1,slashOrSeparatorIdx + 1);
    idxNext=idxNext == -1 ? path.indexOf(next1 == '/' ? '\\' : '/',slashOrSeparatorIdx + 1) : idxNext;
    return idxNext == -1 ? ThreeState.YES : ThreeState.UNSURE;
  }
 else {
    return ThreeState.NO;
  }
}
