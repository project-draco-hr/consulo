{
  ByteArrayOutputStream buffer=new ByteArrayOutputStream();
  final byte[] bytes=BUFFER.get();
  while (maxLength > 0) {
    int n=stream.read(bytes,0,Math.min(maxLength,bytes.length));
    if (n <= 0)     break;
    buffer.write(bytes,0,n);
    maxLength-=n;
  }
  buffer.close();
  return buffer.toByteArray();
}
