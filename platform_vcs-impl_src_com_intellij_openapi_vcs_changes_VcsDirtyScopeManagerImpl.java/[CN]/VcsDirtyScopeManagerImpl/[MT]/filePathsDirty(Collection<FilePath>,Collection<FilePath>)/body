{
  final ArrayList<FilePathUnderVcs> filesConverted=filesDirty == null ? null : new ArrayList<FilePathUnderVcs>(filesDirty.size());
  final ArrayList<FilePathUnderVcs> dirsConverted=dirsRecursivelyDirty == null ? null : new ArrayList<FilePathUnderVcs>(dirsRecursivelyDirty.size());
  ApplicationManager.getApplication().runReadAction(new Runnable(){
    public void run(){
      convertPaths(filesDirty,filesConverted);
      convertPaths(dirsRecursivelyDirty,dirsConverted);
    }
  }
);
  final boolean haveStuff=filesConverted != null && !filesConverted.isEmpty() || dirsConverted != null && !dirsConverted.isEmpty();
  if (!haveStuff)   return false;
  return takeDirt(new Consumer<DirtBuilder>(){
    public void consume(    final DirtBuilder dirt){
      if (filesConverted != null) {
        for (        FilePathUnderVcs root : filesConverted) {
          dirt.addDirtyFile(root);
        }
      }
      if (dirsConverted != null) {
        for (        FilePathUnderVcs root : dirsConverted) {
          dirt.addDirtyDirRecursively(root);
        }
      }
    }
  }
);
}
