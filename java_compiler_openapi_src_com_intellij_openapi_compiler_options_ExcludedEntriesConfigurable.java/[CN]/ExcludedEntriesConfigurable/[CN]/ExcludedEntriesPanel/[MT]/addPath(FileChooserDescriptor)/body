{
  int selected=myExcludedTable.getSelectedRow() + 1;
  if (selected < 0) {
    selected=myExcludeEntryDescriptions.size();
  }
  int savedSelected=selected;
  VirtualFile[] chosen=FileChooser.chooseFiles(myProject,descriptor);
  for (  final VirtualFile chosenFile : chosen) {
    if (isFileExcluded(chosenFile)) {
      continue;
    }
    ExcludeEntryDescription description;
    if (chosenFile.isDirectory()) {
      description=new ExcludeEntryDescription(chosenFile,true,false,myProject);
    }
 else {
      description=new ExcludeEntryDescription(chosenFile,false,true,myProject);
    }
    myExcludeEntryDescriptions.add(selected,description);
    selected++;
  }
  if (selected > savedSelected) {
    AbstractTableModel model=(AbstractTableModel)myExcludedTable.getModel();
    model.fireTableRowsInserted(savedSelected,selected - 1);
    myExcludedTable.setRowSelectionInterval(savedSelected,selected - 1);
  }
}
