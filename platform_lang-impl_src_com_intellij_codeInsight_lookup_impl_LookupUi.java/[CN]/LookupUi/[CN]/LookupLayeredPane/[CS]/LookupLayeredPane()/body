{
  add(mainPanel,0,0);
  add(myIconPanel,42,0);
  add(mySortingLabel,10,0);
  setLayout(new AbstractLayoutManager(){
    @Override public Dimension preferredLayoutSize(    @Nullable Container parent){
      int maxCellWidth=myLookup.myLookupTextWidth + myLookup.myCellRenderer.getIconIndent();
      int scrollBarWidth=myScrollPane.getPreferredSize().width - myScrollPane.getViewport().getPreferredSize().width;
      int listWidth=Math.min(scrollBarWidth + maxCellWidth,UISettings.getInstance().MAX_LOOKUP_WIDTH2);
      Dimension adSize=myAdvertiser.getAdComponent().getPreferredSize();
      int panelHeight=myList.getPreferredScrollableViewportSize().height + adSize.height;
      if (myList.getModel().getSize() > myList.getVisibleRowCount() && myList.getVisibleRowCount() >= 5) {
        panelHeight-=myList.getFixedCellHeight() / 2;
      }
      return new Dimension(Math.max(listWidth,adSize.width),Math.min(panelHeight,myMaximumHeight));
    }
    @Override public void layoutContainer(    Container parent){
      Dimension size=getSize();
      mainPanel.setSize(size);
      mainPanel.validate();
      if (!myLookup.myResizePending) {
        Dimension preferredSize=preferredLayoutSize(null);
        if (preferredSize.width != size.width) {
          UISettings.getInstance().MAX_LOOKUP_WIDTH2=Math.max(500,size.width);
        }
        int listHeight=myList.getLastVisibleIndex() - myList.getFirstVisibleIndex() + 1;
        if (listHeight != myList.getModel().getSize() && listHeight != myList.getVisibleRowCount() && preferredSize.height != size.height) {
          UISettings.getInstance().MAX_LOOKUP_LIST_HEIGHT=Math.max(5,listHeight);
        }
      }
      myList.setFixedCellWidth(myScrollPane.getViewport().getWidth());
      layoutStatusIcons();
      layoutHint();
    }
  }
);
}
