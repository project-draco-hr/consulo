{
  myProject=project;
  myFile=file;
  myFileEditorManagerAdapter=new FileEditorManagerAdapter(){
    public void selectionChanged(    FileEditorManagerEvent event){
      if (PerspectiveFileEditor.this.equals(event.getOldEditor())) {
        deselectNotify();
        if (event.getNewEditor() instanceof TextEditor) {
          setSelectionInTextEditor((TextEditor)event.getNewEditor(),getSelectedDomElement());
        }
      }
 else       if (PerspectiveFileEditor.this.equals(event.getNewEditor())) {
        selectNotify();
        if (event.getOldEditor() instanceof TextEditor) {
          setSelectedDomElement(getSelectedDomElementFromTextEditor((TextEditor)event.getOldEditor()));
        }
 else         if (event.getOldEditor() instanceof PerspectiveFileEditor) {
          setSelectedDomElement(((PerspectiveFileEditor)event.getOldEditor()).getSelectedDomElement());
        }
      }
    }
  }
;
  FileEditorManager.getInstance(myProject).addFileEditorManagerListener(myFileEditorManagerAdapter);
  startListeningDocuments();
}
