{
  PsiElement element1=o1 instanceof PsiElement ? (PsiElement)o1 : null;
  PsiElement element2=o2 instanceof PsiElement ? (PsiElement)o2 : null;
  if (element1 == null)   return element2 == null ? 0 : 1;
  if (element2 == null)   return -1;
  final WeighingComparable<PsiElement,ProximityWeighingLocation> proximity1=getProximity(element1,getContext());
  final WeighingComparable<PsiElement,ProximityWeighingLocation> proximity2=getProximity(element2,getContext());
  if (proximity1 == null || proximity2 == null) {
    return 0;
  }
  if (!proximity1.equals(proximity2)) {
    return proximity1.compareTo(proximity2);
  }
  StatisticsManager statisticsManager=StatisticsManager.getInstance();
  int count1=statisticsManager.getMemberUseCount(element1);
  int count2=statisticsManager.getMemberUseCount(element2);
  return count2 - count1;
}
