{
  moveMembersToBase();
  moveFieldInitializations();
  for (  UsageInfo usage : usages) {
    PsiElement element=usage.getElement();
    if (element instanceof PsiReferenceExpression) {
      PsiExpression qualifierExpression=((PsiReferenceExpression)element).getQualifierExpression();
      if (qualifierExpression instanceof PsiReferenceExpression && ((PsiReferenceExpression)qualifierExpression).resolve() == mySourceClass) {
        ((PsiReferenceExpression)qualifierExpression).bindToElement(myTargetSuperClass);
      }
    }
  }
  final Runnable replaceMethodDuplicatesRunnable=new Runnable(){
    @Override public void run(){
      processMethodsDuplicates();
    }
  }
;
  if (ApplicationManager.getApplication().isUnitTestMode()) {
    replaceMethodDuplicatesRunnable.run();
  }
 else {
    ApplicationManager.getApplication().invokeLater(replaceMethodDuplicatesRunnable);
  }
}
