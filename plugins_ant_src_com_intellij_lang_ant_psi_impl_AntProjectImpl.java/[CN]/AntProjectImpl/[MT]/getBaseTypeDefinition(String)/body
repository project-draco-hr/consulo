{
  if (myTypeDefinitions != null)   return myTypeDefinitions.get(taskClassName);
  myTypeDefinitions=new HashMap<String,AntTypeDefinition>();
  final Hashtable ht=myProject.getTaskDefinitions();
  if (ht == null)   return null;
  final Enumeration tasks=ht.keys();
  while (tasks.hasMoreElements()) {
    final String taskName=(String)tasks.nextElement();
    final Class taskClass=(Class)ht.get(taskName);
    final IntrospectionHelper helper=getHelperExceptionSafe(taskClass);
    if (helper == null)     continue;
    final HashMap<String,AntAttributeType> attributes=new HashMap<String,AntAttributeType>();
    final Enumeration attrEnum=helper.getAttributes();
    while (attrEnum.hasMoreElements()) {
      String attr=(String)attrEnum.nextElement();
      final Class attrClass=helper.getAttributeType(attr);
      if (int.class.equals(attrClass)) {
        attributes.put(attr,AntAttributeType.INTEGER);
      }
 else       if (boolean.class.equals(attrClass)) {
        attributes.put(attr,AntAttributeType.BOOLEAN);
      }
 else {
        attributes.put(attr,AntAttributeType.STRING);
      }
    }
    final HashMap<AntTypeId,String> nestedDefinitions=new HashMap<AntTypeId,String>();
    final Enumeration nestedEnum=helper.getNestedElements();
    while (nestedEnum.hasMoreElements()) {
      final String nestedElement=(String)nestedEnum.nextElement();
      final String className=((Class)helper.getNestedElementMap().get(nestedElement)).getName();
      nestedDefinitions.put(new AntTypeId(nestedElement),className);
    }
    AntTypeDefinition def=new AntTypeDefinitionImpl(new AntTypeId(taskName,getSourceElement().getNamespace()),taskClass.getName(),true,attributes,nestedDefinitions);
    myTypeDefinitions.put(def.getClassName(),def);
  }
  return myTypeDefinitions.get(taskClassName);
}
