{
  if (SystemInfo.isMac) {
    if (new File("/usr/libexec/java_home").exists()) {
      try {
        final Process exec=Runtime.getRuntime().exec("/usr/libexec/java_home");
        final BufferedReader input=new BufferedReader(new InputStreamReader(exec.getInputStream()));
        try {
          final String path=input.readLine();
          if (new File(path).exists())           return path;
        }
  finally {
          input.close();
        }
      }
 catch (      IOException ignore) {
      }
    }
    return "/System/Library/Frameworks/JavaVM.framework/Versions/";
  }
  if (SystemInfo.isLinux) {
    final String[] homes={"/usr/java","/opt/java","/usr/lib/jvm/"};
    for (    String home : homes) {
      if (new File(home).isDirectory()) {
        return home;
      }
    }
  }
  if (SystemInfo.isSolaris) {
    return "/usr/jdk/";
  }
  return null;
}
