{
  InspectionProfileImpl inspectionProfile=null;
  if (psiRoot != null) {
    final Pair<String,Boolean> inspectionProfilePair=HighlightingSettingsPerFile.getInstance(psiRoot.getProject()).getInspectionProfile(psiRoot);
    if (inspectionProfilePair != null && inspectionProfilePair.second) {
      inspectionProfile=InspectionProfileManager.getInstance().getProfile(inspectionProfilePair.first);
    }
  }
  return inspectionProfile != null ? inspectionProfile : getInspectionProfile();
}
