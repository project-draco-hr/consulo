{
  FindSettings.getInstance().setDefaultScopeName(myScopeChooserCombo.getSelectedScopeName());
  final PsiType rootType=getRootType();
  final PsiType migrationType=CanonicalTypes.createTypeWrapper(getMigrationType()).getType(myRoot,myRoot.getManager());
  if (Comparing.equal(rootType,migrationType)) {
    close(DialogWrapper.OK_EXIT_CODE);
    return;
  }
  if (myRules == null) {
    myRules=new TypeMigrationRules(rootType);
    myRules.setMigrationRootType(migrationType);
    myRules.setBoundScope(myScopeChooserCombo.getSelectedScope());
  }
  invokeRefactoring(new TypeMigrationProcessor(myProject,myRoot,myRules));
}
