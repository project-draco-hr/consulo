{
  updateChangedFiles();
  Collection<VirtualFile> virtualFiles=myPropertiesMap.get(key);
  if (virtualFiles == null || virtualFiles.size() == 0)   return Collections.emptyList();
  Collection<Property> result=new ArrayList<Property>(virtualFiles.size());
  PsiManager psiManager=PsiManager.getInstance(myProject);
  for (  VirtualFile file : virtualFiles) {
    PsiFile psiFile=psiManager.findFile(file);
    if (!(psiFile instanceof PropertiesFile)) {
      virtualFiles.remove(file);
      continue;
    }
    List<Property> properties=((PropertiesFile)psiFile).findPropertiesByKey(key);
    result.addAll(properties);
  }
  return result;
}
