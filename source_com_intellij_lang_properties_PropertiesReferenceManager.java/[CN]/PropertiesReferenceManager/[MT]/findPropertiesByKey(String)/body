{
  updateChangedFiles();
  List<Property> result;
  Collection<VirtualFile> virtualFiles=myPropertiesMap.get(key);
  if (virtualFiles == null || virtualFiles.isEmpty())   return Collections.emptyList();
  result=new ArrayList<Property>(virtualFiles.size());
  for (Iterator<VirtualFile> iterator=virtualFiles.iterator(); iterator.hasNext(); ) {
    VirtualFile virtualFile=iterator.next();
    if (!virtualFile.isValid()) {
      iterator.remove();
      continue;
    }
    PsiFile psiFile=myPsiManager.findFile(virtualFile);
    if (!(psiFile instanceof PropertiesFile)) {
      iterator.remove();
      continue;
    }
    List<Property> properties=((PropertiesFile)psiFile).findPropertiesByKey(key);
    result.addAll(properties);
  }
  return result;
}
