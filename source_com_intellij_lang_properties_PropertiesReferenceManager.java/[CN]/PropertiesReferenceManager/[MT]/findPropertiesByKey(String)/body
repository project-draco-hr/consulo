{
  updateChangedFiles();
  Collection<VirtualFile> virtualFiles=myPropertiesMap.get(key);
  if (virtualFiles == null || virtualFiles.size() == 0)   return Collections.emptyList();
  Collection<Property> result=new ArrayList<Property>(virtualFiles.size());
  PsiManager psiManager=PsiManager.getInstance(myProject);
  for (Iterator<VirtualFile> iterator=virtualFiles.iterator(); iterator.hasNext(); ) {
    VirtualFile virtualFile=iterator.next();
    if (!virtualFile.isValid()) {
      iterator.remove();
      continue;
    }
    PsiFile psiFile=psiManager.findFile(virtualFile);
    if (!(psiFile instanceof PropertiesFile)) {
      iterator.remove();
      continue;
    }
    List<Property> properties=((PropertiesFile)psiFile).findPropertiesByKey(key);
    result.addAll(properties);
  }
  return result;
}
