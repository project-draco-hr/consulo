{
  if (child.getElementType() == ElementType.JSP_XML_TEXT) {
    final ASTNode javaElement=JspTextBlock.findJavaElementAt(child);
    if (javaElement != null) {
      return new JspTextBlock(child,null,null,myXmlFormattingPolicy,javaElement);
    }
  }
  if (child.getElementType() == getTagType() || child.getElementType() == ElementType.XML_TAG) {
    return new XmlTagBlock(child,wrap,alignment,myXmlFormattingPolicy,indent != null ? indent : getFormatter().getNoneIndent());
  }
 else   if (child.getElementType() == ElementType.JSP_SCRIPTLET_END) {
    return new XmlBlock(child,wrap,alignment,myXmlFormattingPolicy,getFormatter().getNoneIndent());
  }
 else {
    return new XmlBlock(child,wrap,alignment,myXmlFormattingPolicy,indent);
  }
}
