{
  final Language myLanguage=myNode.getPsi().getLanguage();
  final Language childLanguage=child.getPsi().getLanguage();
  if (useMyFormatter(myLanguage,childLanguage)) {
    if (child.getElementType() == ElementType.JSP_XML_TEXT) {
      final ASTNode javaElement=JspTextBlock.findJavaElementAt(child);
      if (javaElement != null) {
        return new JspTextBlock(child,null,null,myXmlFormattingPolicy,javaElement);
      }
    }
    if (child.getElementType() == getTagType() || child.getElementType() == ElementType.XML_TAG) {
      return new XmlTagBlock(child,wrap,alignment,myXmlFormattingPolicy,indent != null ? indent : getFormatter().getNoneIndent());
    }
 else     if (child.getElementType() == ElementType.JSP_SCRIPTLET_END) {
      return new XmlBlock(child,wrap,alignment,myXmlFormattingPolicy,getFormatter().getNoneIndent());
    }
 else {
      return new XmlBlock(child,wrap,alignment,myXmlFormattingPolicy,indent);
    }
  }
 else {
    final FormattingModel childModel=childLanguage.getFormattingModelBuilder().createModel(child.getPsi(),myXmlFormattingPolicy.getSettings());
    return new AnotherLanguageBlockWrapper(child,myXmlFormattingPolicy,childModel.getRootBlock());
  }
}
