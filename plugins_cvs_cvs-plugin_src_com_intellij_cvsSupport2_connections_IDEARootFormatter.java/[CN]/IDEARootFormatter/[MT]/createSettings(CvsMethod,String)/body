{
  if (method == null) {
    throw new CvsRootException(CvsBundle.message("message.error.missing.cvs.root",cvsRootAsString));
  }
  if (method.equals(CvsMethod.LOCAL_METHOD)) {
    return new LocalConnectionSettings(cvsRootAsString,myCvsRootConfiguration);
  }
 else   if (method.equals(CvsMethod.PSERVER_METHOD)) {
    return new PServerCvsSettings(myCvsRootConfiguration);
  }
 else   if (method.equals(CvsMethod.EXT_METHOD)) {
    return new ExtConnectionCvsSettings(myCvsRootConfiguration);
  }
 else   if (method.equals(CvsMethod.SSH_METHOD)) {
    return new SshConnectionSettings(myCvsRootConfiguration);
  }
  throw new CvsRootException(CvsBundle.message("exception.text.unsupported.method",method,cvsRootAsString));
}
