{
  IElementType type=child.getElementType();
  if (type == XmlElementType.XML_TEXT) {
    final PsiElement parent=child.getPsi().getParent();
    if (parent instanceof XmlTag && ((XmlTag)parent).getSubTags().length == 0) {
      if (buildInjectedPsiBlocks(result,child,wrap,alignment,indent))       return child;
    }
    return createXmlTextBlocks(result,child,wrap,alignment);
  }
 else   if (type == XmlElementType.XML_COMMENT) {
    if (buildInjectedPsiBlocks(result,child,wrap,alignment,indent))     return child;
    return super.processChild(result,child,wrap,alignment,indent);
  }
 else {
    return super.processChild(result,child,wrap,alignment,indent);
  }
}
