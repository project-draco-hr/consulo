{
  SimpleTextAttributes attributes=SimpleTextAttributes.fromTextAttributes(EditorColorsManager.getInstance().getGlobalScheme().getAttributes(DefaultLanguageHighlighterColors.STRING));
  SimpleTextAttributes escapeAttributes=null;
  StringBuilder builder=new StringBuilder().append('"');
  for (int i=0, n=Math.min(value.length(),maxLength); i < n; i++) {
    char ch=value.charAt(i);
    if (ch == '\\' || ch == '\"' || ch == '\b' || ch == '\t' || ch == '\n' || ch == '\f' || ch == '\r') {
      if (builder.length() > 0) {
        text.append(builder.toString(),attributes);
        builder.setLength(0);
      }
      if (escapeAttributes == null) {
        TextAttributes fromHighlighter=EditorColorsManager.getInstance().getGlobalScheme().getAttributes(DefaultLanguageHighlighterColors.VALID_STRING_ESCAPE);
        if (fromHighlighter != null) {
          escapeAttributes=SimpleTextAttributes.fromTextAttributes(fromHighlighter);
        }
 else {
          escapeAttributes=new SimpleTextAttributes(SimpleTextAttributes.STYLE_BOLD,JBColor.GRAY);
        }
      }
      if (ch != '\\' && ch != '\"') {
        text.append("\\",escapeAttributes);
      }
      String string;
switch (ch) {
case '\b':
        string="b";
      break;
case '\t':
    string="t";
  break;
case '\n':
string="n";
break;
case '\f':
string="f";
break;
case '\r':
string="r";
break;
default :
string=String.valueOf(ch);
break;
}
text.append(string,escapeAttributes);
}
 else {
builder.append(ch);
}
}
if (builder.length() > 0) {
text.append(builder.append('"').toString(),attributes);
}
}
