{
  if (params.length != 1)   return null;
  final Result result=params[0].calculateResult(context);
  if (result == null)   return null;
  Project project=context.getProject();
  PsiDocumentManager.getInstance(project).commitAllDocuments();
  PsiExpression expr=MacroUtil.resultToPsiExpression(result,context);
  if (expr == null)   return null;
  PsiType[] types=GuessManager.getInstance(project).guessContainerElementType(expr,new TextRange(context.getTemplateStartOffset(),context.getTemplateEndOffset()));
  for (int i=0; i < types.length; i++) {
    PsiType type=types[i];
    if (type instanceof PsiWildcardType) {
      if (((PsiWildcardType)type).isExtends()) {
        types[i]=((PsiWildcardType)type).getBound();
      }
 else {
        types[i]=PsiType.getJavaLangObject(expr.getManager(),expr.getResolveScope());
      }
    }
  }
  return types;
}
