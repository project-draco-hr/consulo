{
  PackagingMethod method=element.getPackagingMethod();
  PackagingTreeNode parent;
  String path=element.getURI();
  path=fixPath(element,method,path);
  if (method == PackagingMethod.JAR_AND_COPY_FILE) {
    parent=PackagingTreeNodeFactory.getOrCreateArchiveNode(path,root,owner);
  }
 else   if (method == PackagingMethod.JAR_AND_COPY_FILE_AND_LINK_VIA_MANIFEST) {
    parent=PackagingTreeNodeFactory.getOrCreateArchiveNode(path,root.getParent(),owner);
  }
 else   if (method == PackagingMethod.COPY_FILES_AND_LINK_VIA_MANIFEST) {
    parent=PackagingTreeNodeFactory.getOrCreateDirectoryNode(path,root.getParent(),owner);
  }
 else {
    parent=PackagingTreeNodeFactory.getOrCreateDirectoryNode(path,root,owner);
  }
  return parent;
}
