{
  for (  PsiElement child : directory.getChildren()) {
    if (child instanceof PsiFile) {
      VirtualFile virtualFile=((PsiFile)child).getVirtualFile();
      if (virtualFile != null) {
        iterator.processFile(virtualFile);
      }
    }
 else     if (myFindModel.isWithSubdirectories() && child instanceof PsiDirectory) {
      addFilesUnderDirectory((PsiDirectory)child,iterator);
    }
  }
}
