{
  final PsiVariable refVariable=findPreviousVariable();
  if (refVariable == null)   return;
  if (!CodeInsightUtil.preparePsiElementsForWrite(myVariable,refVariable))   return;
  final PsiExpression initializer=myVariable.getInitializer();
  if (initializer == null) {
    myVariable.delete();
    return;
  }
  PsiUtil.setModifierProperty(refVariable,PsiModifier.FINAL,false);
  final PsiElementFactory factory=JavaPsiFacade.getInstance(myVariable.getProject()).getElementFactory();
  final PsiElement statement=factory.createStatementFromText(myVariable.getName() + " = " + initializer.getText()+ ";",null);
  myVariable.getParent().replace(statement);
}
