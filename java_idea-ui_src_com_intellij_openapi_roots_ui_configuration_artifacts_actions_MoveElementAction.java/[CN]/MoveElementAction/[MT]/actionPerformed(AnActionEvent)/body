{
  final PackagingElementNode<?> node=myLayoutTreeComponent.getSelection().getNodeIfSingle();
  if (node == null)   return;
  final CompositePackagingElementNode parent=node.getParentNode();
  if (parent == null)   return;
  final PackagingElement<?> element=node.getElementIfSingle();
  final CompositePackagingElement<?> parentElement=parent.getElementIfSingle();
  if (parentElement == null || element == null)   return;
  if (myLayoutTreeComponent.checkCanRemove(Collections.singletonList(node)) && myLayoutTreeComponent.checkCanAdd(null,parentElement,parent)) {
    myLayoutTreeComponent.ensureRootIsWritable();
    final int index=parentElement.getChildren().indexOf(element);
    final PackagingElement<?> moved=parentElement.moveChild(index,myDirection);
    if (moved != null) {
      myLayoutTreeComponent.updateAndSelect(parent,Collections.singletonList(moved));
    }
  }
}
