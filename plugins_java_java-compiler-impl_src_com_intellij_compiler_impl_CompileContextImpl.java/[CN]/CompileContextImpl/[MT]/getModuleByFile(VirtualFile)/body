{
  final Module module=myProjectFileIndex.getModuleForFile(file);
  if (module != null) {
    LOG.assertTrue(!module.isDisposed());
    return module;
  }
  for (  final VirtualFile root : myRootToModuleMap.keySet()) {
    if (VfsUtil.isAncestor(root,file,false)) {
      final Module mod=myRootToModuleMap.get(root);
      if (mod != null) {
        LOG.assertTrue(!mod.isDisposed());
      }
      return mod;
    }
  }
  return null;
}
