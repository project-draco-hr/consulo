{
  super.setUp();
  myCurrentState=ModalityState.NON_MODAL;
  final ModalityStateEx any=new ModalityStateEx();
  Extensions.registerAreaClass("IDEA_PROJECT",null);
  ApplicationManager.setApplication(new MockApplication(getTestRootDisposable()){
    @NotNull @Override public ModalityState getCurrentModalityState(){
      return myCurrentState;
    }
    @Override public ModalityState getAnyModalityState(){
      return any;
    }
  }
,getTestRootDisposable());
  myMonitor=new UiActivityMonitorImpl();
  myMonitor.setActive(true);
  disposeOnTearDown(myMonitor);
}
