{
  super.update(e);
  final Project project=e.getData(CommonDataKeys.PROJECT);
  final Presentation presentation=e.getPresentation();
  if (presentation.isEnabled()) {
    final Module module=e.getData(LangDataKeys.MODULE);
    if (module != null && ModuleUtilCore.getExtension(module,JavaModuleExtensionImpl.class) != null) {
      final IdeView view=e.getData(LangDataKeys.IDE_VIEW);
      if (view != null) {
        final ProjectFileIndex projectFileIndex=ProjectRootManager.getInstance(project).getFileIndex();
        final PsiDirectory[] dirs=view.getDirectories();
        for (        final PsiDirectory dir : dirs) {
          if (projectFileIndex.isInSourceContent(dir.getVirtualFile()) && JavaDirectoryService.getInstance().getPackage(dir) != null) {
            return;
          }
        }
      }
    }
    presentation.setEnabled(false);
    presentation.setVisible(false);
  }
}
