{
  final Element root=super.saveToXml(targetRoot,configFile);
  if (!isMacroLoggingEnabled()) {
    return root;
  }
  VirtualFile projectFile=getProjectFile();
  if (projectFile != null && projectFile.equals(configFile)) {
    final String[] usedMacros=getUsedMacroNames();
    Arrays.sort(usedMacros,ourStringComparator);
    final Element allMacrosElement=new Element(USED_MACROS_ELEMENT_NAME);
    root.addContent(allMacrosElement);
    for (int idx=0; idx < usedMacros.length; idx++) {
      final String usedMacro=usedMacros[idx];
      final Element macroElem=new Element(ELEMENT_MACRO);
      allMacrosElement.addContent(macroElem);
      macroElem.setAttribute(ATTRIBUTE_NAME,usedMacro);
    }
  }
  return root;
}
