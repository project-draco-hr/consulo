{
  if (value == null || value.indexOf('$') < 0) {
    return value;
  }
synchronized (PsiLock.LOCK) {
    if (value != null) {
      if (myComputingAttrValue == null || !myComputingAttrValue.contains(value)) {
        try {
          if (myComputingAttrValue == null) {
            myComputingAttrValue=new StringSetHolder();
          }
          final AntConfigurationBase antConfig=AntConfigurationBase.getInstance(getProject());
          myComputingAttrValue.add(value);
          try {
            final Set<Pair<PsiElement,String>> set=PsiElementWithValueSetSpinAllocator.alloc();
            try {
              return computeAttributeValue(value,set,antConfig);
            }
  finally {
              PsiElementWithValueSetSpinAllocator.dispose(set);
            }
          }
 catch (          SpinAllocator.AllocatorExhaustedException e) {
            return computeAttributeValue(value,new HashSet<Pair<PsiElement,String>>(),antConfig);
          }
        }
  finally {
          myComputingAttrValue.remove(value);
          if (myComputingAttrValue.size() == 0) {
            myComputingAttrValue.dispose();
            myComputingAttrValue=null;
          }
        }
      }
    }
    return null;
  }
}
