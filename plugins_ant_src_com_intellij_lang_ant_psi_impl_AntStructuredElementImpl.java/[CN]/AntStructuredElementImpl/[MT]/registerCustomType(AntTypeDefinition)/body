{
synchronized (PsiLock.LOCK) {
    if (myDefinition != null) {
      if (!myDefinitionCloned) {
        myDefinition=new AntTypeDefinitionImpl((AntTypeDefinitionImpl)myDefinition);
        myDefinitionCloned=true;
      }
      myDefinition.registerNestedType(def.getTypeId(),def.getClassName());
    }
    getAntFile().registerCustomType(def);
  }
}
