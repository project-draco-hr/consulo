{
synchronized (PsiLock.LOCK) {
    if (myDefinition != null && myDefinitionCloned) {
      final AntTypeId typeId=def.getTypeId();
      final String registeredClassName=myDefinition.getNestedClassName(typeId);
      if (registeredClassName != null && registeredClassName.equals(def.getClassName())) {
        myDefinition.unregisterNestedType(typeId);
      }
    }
    getAntFile().unregisterCustomType(def);
  }
}
