{
  if (element instanceof GrCodeReferenceElement && startInElement <= currOffset && currOffset <= endInElement) {
    result.add((GrCodeReferenceElement)element);
  }
  PsiElement first=element.getFirstChild();
  if (first != null) {
    for (PsiElement run=first; run != null; run=run.getNextSibling()) {
      currOffset=collectReferences(run,currOffset,startInElement,endInElement,result);
      if (currOffset > endInElement)       break;
    }
    return currOffset;
  }
  return currOffset+=element.getTextLength();
}
