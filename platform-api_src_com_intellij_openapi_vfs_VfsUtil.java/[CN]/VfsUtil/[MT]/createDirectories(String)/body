{
  final String path=FileUtil.toSystemIndependentName(dir);
  final Ref<IOException> err=new Ref<IOException>();
  VirtualFile result=ApplicationManager.getApplication().runWriteAction(new Computable<VirtualFile>(){
    public VirtualFile compute(){
      try {
        return createDirectoryIfMissing(path);
      }
 catch (      IOException e) {
        err.set(e);
        return null;
      }
    }
  }
);
  if (!err.isNull())   throw err.get();
  return result;
}
