{
  if (equals(scope))   return this;
  if (scope instanceof DirectoryScope) {
    DirectoryScope other=(DirectoryScope)scope;
    VirtualFile otherDirectory=other.myDirectory;
    if (myWithSubdirectories && VfsUtilCore.isAncestor(myDirectory,otherDirectory,false))     return this;
    if (other.myWithSubdirectories && VfsUtilCore.isAncestor(otherDirectory,myDirectory,false))     return other;
    BitSet newWithSubdirectories=new BitSet();
    newWithSubdirectories.set(0,myWithSubdirectories);
    newWithSubdirectories.set(1,other.myWithSubdirectories);
    return new DirectoriesScope(getProject(),new VirtualFile[]{myDirectory,otherDirectory},newWithSubdirectories);
  }
  return super.uniteWith(scope);
}
