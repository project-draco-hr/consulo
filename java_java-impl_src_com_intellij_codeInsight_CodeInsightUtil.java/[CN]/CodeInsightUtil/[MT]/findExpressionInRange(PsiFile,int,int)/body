{
  if (!file.getViewProvider().getLanguages().contains(StdLanguages.JAVA))   return null;
  PsiElement element2=file.getViewProvider().findElementAt(endOffset - 1,StdLanguages.JAVA);
  if (element2 instanceof PsiJavaToken) {
    final PsiJavaToken token=(PsiJavaToken)element2;
    final IElementType tokenType=token.getTokenType();
    if (tokenType.equals(JavaTokenType.SEMICOLON)) {
      endOffset=element2.getTextRange().getStartOffset();
    }
  }
  final PsiExpression expression=findElementInRange(file,startOffset,endOffset,PsiExpression.class);
  if (expression instanceof PsiReferenceExpression && expression.getParent() instanceof PsiMethodCallExpression)   return null;
  return expression;
}
