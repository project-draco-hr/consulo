{
  super(project);
  myBus=bus;
  EditorEventMulticaster multicaster=EditorFactory.getInstance().getEventMulticaster();
  multicaster.addDocumentListener(new MyDocumentListener(),myProject);
  multicaster.addEditorMouseListener(new MyEditorMouseListener(),myProject);
  documentManager.addListener(new PsiDocumentManager.Listener(){
    @Override public void documentCreated(    @NotNull final Document document,    PsiFile psiFile){
      final VirtualFile file=FileDocumentManager.getInstance().getFile(document);
      if (file == null)       return;
      for (      final Bookmark bookmark : myBookmarks) {
        if (Comparing.equal(bookmark.getFile(),file)) {
          UIUtil.invokeLaterIfNeeded(new Runnable(){
            @Override public void run(){
              if (myProject.isDisposed())               return;
              bookmark.createHighlighter((MarkupModelEx)DocumentMarkupModel.forDocument(document,myProject,true));
            }
          }
);
        }
      }
    }
    @Override public void fileCreated(    @NotNull PsiFile file,    @NotNull Document document){
    }
  }
);
}
