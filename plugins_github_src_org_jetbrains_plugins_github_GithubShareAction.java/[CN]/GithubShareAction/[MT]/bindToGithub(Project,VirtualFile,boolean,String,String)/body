{
  LOG.info("Binding local project with GitHub");
  if (!gitDetected) {
    LOG.info("No git detected, creating empty git repo");
    final GitLineHandler h=new GitLineHandler(project,root,GitCommand.INIT);
    h.setNoSSH(true);
    GitHandlerUtil.doSynchronously(h,GitBundle.getString("initializing.title"),h.printableCommandLine());
    if (!h.errors().isEmpty()) {
      GitUIUtil.showOperationErrors(project,h.errors(),"git init");
      LOG.info("Failed to create empty git repo: " + h.errors());
      return;
    }
    final ProgressManager manager=ProgressManager.getInstance();
    manager.runProcessWithProgressSynchronously(new Runnable(){
      @Override public void run(){
        GitInit.refreshAndConfigureVcsMappings(project,root,"");
      }
    }
,"Committing",false,project);
  }
  if (!performFirstCommitIfRequired(project,root)) {
    return;
  }
  LOG.info("Adding GitHub as a remote host");
  final GitSimpleHandler addRemoteHandler=new GitSimpleHandler(project,root,GitCommand.REMOTE);
  addRemoteHandler.setNoSSH(true);
  addRemoteHandler.setSilent(true);
  addRemoteHandler.addParameters("add","origin","git@github.com:" + login + "/"+ name+ ".git");
  try {
    addRemoteHandler.run();
    if (addRemoteHandler.getExitCode() != 0) {
      Messages.showErrorDialog("Failed to add GitHub repository as remote","Failed to add GitHub repository as remote");
      return;
    }
  }
 catch (  VcsException e) {
    Messages.showErrorDialog(e.getMessage(),"Failed to add GitHub repository as remote");
    LOG.info("Failed to add GitHub as remote: " + e.getMessage());
    return;
  }
  final ArrayList<VcsException> errors=new ArrayList<VcsException>();
  new Task.Backgroundable(project,"Pushing to GitHub",false){
    @Override public void run(    @NotNull ProgressIndicator indicator){
      final GitLineHandler gitPushHandler=new GitLineHandler(project,root,GitCommand.PUSH);
      gitPushHandler.addParameters("-u","origin","master");
      GitPushUtils.trackPushRejectedAsError(gitPushHandler,"Rejected push (" + root.getPresentableUrl() + "): ");
      errors.addAll(GitHandlerUtil.doSynchronouslyWithExceptions(gitPushHandler));
      if (!errors.isEmpty()) {
        ApplicationManager.getApplication().invokeLater(new Runnable(){
          @Override public void run(){
            GitUIUtil.showOperationErrors(project,errors,GitBundle.getString("push.active.pushing"));
          }
        }
);
      }
 else {
        RefreshAction.doRefresh(project);
        Notifications.Bus.notify(new Notification("github","Success","Successfully created project ''" + name + "'' on github",NotificationType.INFORMATION));
      }
    }
  }
.queue();
}
