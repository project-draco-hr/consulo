{
  LOG.info("Binding local project with GitHub");
  if (!gitDetected) {
    LOG.info("No git detected, creating empty git repo");
    final GitLineHandler h=new GitLineHandler(project,root,GitCommand.INIT);
    GitHandlerUtil.doSynchronously(h,GitBundle.getString("initializing.title"),h.printableCommandLine());
    if (!h.errors().isEmpty()) {
      GitUIUtil.showOperationErrors(project,h.errors(),"git init");
      LOG.info("Failed to create empty git repo: " + h.errors());
      return;
    }
    final ProgressManager manager=ProgressManager.getInstance();
    manager.runProcessWithProgressSynchronously(new Runnable(){
      @Override public void run(){
        GitInit.refreshAndConfigureVcsMappings(project,root,"");
      }
    }
,"Committing",false,project);
  }
  if (!performFirstCommitIfRequired(project,root)) {
    return;
  }
  GitRepositoryManager repositoryManager=ServiceManager.getService(project,GitRepositoryManager.class);
  final GitRepository repository=repositoryManager.getRepositoryForRoot(root);
  LOG.assertTrue(repository != null,"GitRepository is null for root " + root);
  LOG.info("Adding GitHub as a remote host");
  final GitSimpleHandler addRemoteHandler=new GitSimpleHandler(project,root,GitCommand.REMOTE);
  addRemoteHandler.setSilent(true);
  final String remoteUrl=GithubApiUtil.getGitHost() + "/" + login+ "/"+ name+ ".git";
  addRemoteHandler.addParameters("add","origin",remoteUrl);
  try {
    addRemoteHandler.run();
    repository.update();
    if (addRemoteHandler.getExitCode() != 0) {
      Messages.showErrorDialog("Failed to add GitHub repository as remote","Failed to add GitHub repository as remote");
      return;
    }
  }
 catch (  VcsException e) {
    Messages.showErrorDialog(e.getMessage(),"Failed to add GitHub repository as remote");
    LOG.info("Failed to add GitHub as remote: " + e.getMessage());
    return;
  }
  new Task.Backgroundable(project,"Pushing to GitHub",false){
    @Override public void run(    @NotNull ProgressIndicator indicator){
      Git git=ServiceManager.getService(Git.class);
      GitCommandResult result=git.push(repository,"origin",remoteUrl,"refs/heads/master:refs/heads/master");
      if (result.success()) {
        Notificator.getInstance(project).notify(new Notification(GithubUtil.GITHUB_NOTIFICATION_GROUP,"Success","Successfully created project '" + name + "' on GitHub",NotificationType.INFORMATION));
      }
 else {
        showPushError(project,"Push failed: <br/>" + result.getErrorOutputAsHtmlString());
      }
    }
  }
.queue();
}
