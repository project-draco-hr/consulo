{
  PsiCodeFragment codeFragment=(PsiCodeFragment)value;
  final EditorTextField editorTextField;
  if (codeFragment != null) {
    Document document=PsiDocumentManager.getInstance(myProject).getDocument(codeFragment);
    editorTextField=new EditorTextField(document,myProject,myFileType){
      protected boolean shouldHaveBorder(){
        return false;
      }
    }
;
  }
 else {
    editorTextField=new EditorTextField("",myProject,myFileType){
      protected boolean shouldHaveBorder(){
        return false;
      }
    }
;
  }
  if (!table.isShowing()) {
    editorTextField.ensureWillComputePreferredSize();
  }
  editorTextField.putClientProperty("JComboBox.isTableCellEditor",Boolean.TRUE);
  ListSelectionModel selModel=table.getSelectionModel();
  final Color color=(selModel.getMaxSelectionIndex() - selModel.getMinSelectionIndex()) == 0 ? table.getSelectionBackground() : table.getForeground();
  final Color cellBg=UIUtil.getTableCellBackground(table,row);
  editorTextField.setBorder(BorderFactory.createLineBorder(hasFocus ? color : cellBg));
  editorTextField.setBackground(cellBg);
  return editorTextField;
}
