{
  e.getPresentation().setVisible(false);
  VirtualFile virtualFile=e.getData(PlatformDataKeys.VIRTUAL_FILE);
  VirtualFile[] files=e.getData(PlatformDataKeys.VIRTUAL_FILE_ARRAY);
  if (files != null && files.length > 1) {
    virtualFile=null;
  }
  if (virtualFile == null || virtualFile.isDirectory())   return;
  Project project=e.getData(PlatformDataKeys.PROJECT);
  if (project == null)   return;
  final FileViewProvider provider=PsiManager.getInstance(project).findViewProvider(virtualFile);
  if (provider instanceof ConfigurableTemplateLanguageFileViewProvider) {
    final TemplateLanguageFileViewProvider viewProvider=(TemplateLanguageFileViewProvider)provider;
    e.getPresentation().setText(LangBundle.message("quickfix.change.template.data.language.text",viewProvider.getTemplateDataLanguage().getDisplayName()));
    e.getPresentation().setEnabled(true);
    e.getPresentation().setVisible(true);
  }
}
