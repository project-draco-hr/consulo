{
  if (filePath.isNonLocal()) {
    return null;
  }
  final VirtualFile validParent=ApplicationManager.getApplication().runReadAction(new Computable<VirtualFile>(){
    public VirtualFile compute(){
      return ChangesUtil.findValidParent(filePath);
    }
  }
);
  if (validParent == null) {
    return null;
  }
  final boolean take=isFileInIndex(filePath,validParent);
  if (take) {
    return myVcsManager.getVcsFor(validParent);
  }
  return null;
}
