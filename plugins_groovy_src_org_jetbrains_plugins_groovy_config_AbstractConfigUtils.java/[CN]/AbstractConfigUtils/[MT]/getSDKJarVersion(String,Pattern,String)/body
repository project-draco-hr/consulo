{
  try {
    File[] jars=GroovyUtils.getFilesInDirectoryByPattern(jarPath,jarPattern);
    if (jars.length != 1) {
      return null;
    }
    JarFile jarFile=new JarFile(jars[0]);
    try {
      JarEntry jarEntry=jarFile.getJarEntry(manifestPath);
      if (jarEntry == null) {
        return null;
      }
      final InputStream inputStream=jarFile.getInputStream(jarEntry);
      Manifest manifest;
      try {
        manifest=new Manifest(inputStream);
      }
  finally {
        inputStream.close();
      }
      final String version=manifest.getMainAttributes().getValue(Attributes.Name.IMPLEMENTATION_VERSION);
      if (version != null) {
        return version;
      }
      final Matcher matcher=jarPattern.matcher(jars[0].getName());
      if (matcher.matches() && matcher.groupCount() == 1) {
        return matcher.group(1);
      }
      return null;
    }
  finally {
      jarFile.close();
    }
  }
 catch (  Exception e) {
    return null;
  }
}
