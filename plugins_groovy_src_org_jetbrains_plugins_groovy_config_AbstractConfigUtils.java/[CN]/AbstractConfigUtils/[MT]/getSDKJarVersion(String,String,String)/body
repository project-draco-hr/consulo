{
  try {
    File[] jars=GroovyUtils.getFilesInDirectoryByPattern(jarPath,jarRegex);
    if (jars.length != 1) {
      return null;
    }
    JarFile jarFile=new JarFile(jars[0]);
    JarEntry jarEntry=jarFile.getJarEntry(manifestPath);
    if (jarEntry == null) {
      return null;
    }
    Manifest manifest=new Manifest(jarFile.getInputStream(jarEntry));
    final String version=manifest.getMainAttributes().getValue(Attributes.Name.IMPLEMENTATION_VERSION);
    if (version != null) {
      return version;
    }
    final Matcher matcher=Pattern.compile(jarRegex).matcher(jars[0].getName());
    if (matcher.matches() && matcher.groupCount() == 1) {
      return matcher.group(1);
    }
    return null;
  }
 catch (  Exception e) {
    return null;
  }
}
