{
  myModel=model;
  myConfigurable=configurable;
  VerticalFlowLayout layout=new VerticalFlowLayout();
  layout.setVerticalFill(true);
  myMainPanel=new JPanel(layout);
  myModel.registerOptionsComponent(provider,this);
  final JComponent component=myConfigurable.createComponent();
  if (component != null) {
    myMainPanel.add(component);
  }
  final boolean addSeparator=component != null;
  myLibraryOptionsPanelWrapper=new JPanel(new BorderLayout());
  myMainPanel.add(myLibraryOptionsPanelWrapper);
  if (myConfigurable instanceof OldFrameworkSupportProviderWrapper.FrameworkSupportConfigurableWrapper) {
    ((OldFrameworkSupportProviderWrapper.FrameworkSupportConfigurableWrapper)myConfigurable).getConfigurable().addListener(new FrameworkSupportConfigurableListener(){
      public void frameworkVersionChanged(){
        updateLibrariesPanel();
      }
    }
);
  }
  model.addFrameworkListener(new FrameworkSupportModelAdapter(){
    @Override public void wizardStepUpdated(){
      updateLibrariesPanel();
    }
  }
,parentDisposable);
  final CustomLibraryDescription description=myConfigurable.createLibraryDescription();
  if (description != null) {
    myLibraryOptionsPanel=new LibraryOptionsPanel(description,myModel.getBaseDirectoryForLibrariesPath(),myConfigurable.getLibraryVersionFilter(),container,!myConfigurable.isOnlyLibraryAdded());
    Disposer.register(myConfigurable,myLibraryOptionsPanel);
    if (addSeparator) {
      JComponent separator1=SeparatorFactory.createSeparator("Libraries",null);
      separator1.setBorder(IdeBorderFactory.createEmptyBorder(5,0,5,5));
      myLibraryOptionsPanelWrapper.add(BorderLayout.NORTH,separator1);
    }
    myLibraryOptionsPanelWrapper.add(BorderLayout.CENTER,myLibraryOptionsPanel.getMainPanel());
    myLibraryOptionsPanelWrapper.setVisible(myConfigurable.isVisible());
  }
}
