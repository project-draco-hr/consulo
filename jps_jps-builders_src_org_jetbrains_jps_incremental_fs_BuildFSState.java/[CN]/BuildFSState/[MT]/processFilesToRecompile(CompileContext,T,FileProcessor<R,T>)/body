{
  final Map<BuildRootDescriptor,Set<File>> data=getSourcesToRecompile(context,target);
  BuildRootIndex rootIndex=context.getProjectDescriptor().getBuildRootIndex();
  final CompileScope scope=context.getScope();
synchronized (data) {
    for (    Map.Entry<BuildRootDescriptor,Set<File>> entry : data.entrySet()) {
      R root=(R)entry.getKey();
      FileFilter filter=rootIndex.getRootFilter(root);
      for (      File file : entry.getValue()) {
        if (!scope.isAffected(target,file) || !filter.accept(file)) {
          continue;
        }
        if (!processor.apply(target,file,root)) {
          return false;
        }
      }
    }
  }
  return true;
}
