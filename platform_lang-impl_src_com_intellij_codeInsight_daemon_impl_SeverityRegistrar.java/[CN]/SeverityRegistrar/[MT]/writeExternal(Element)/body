{
  List<HighlightSeverity> list=getOrderAsList();
  for (  HighlightSeverity s : list) {
    Element info=new Element(INFO);
    String severity=s.toString();
    final SeverityBasedTextAttributes infoType=ourMap.get(severity);
    if (infoType != null) {
      infoType.writeExternal(info);
      final Color color=ourRendererColors.get(severity);
      if (color != null) {
        info.setAttribute(COLOR,Integer.toString(color.getRGB() & 0xFFFFFF,16));
      }
      element.addContent(info);
    }
  }
  if (myReadOrder != null && !myReadOrder.isEmpty()) {
    myReadOrder.writeExternal(element);
  }
 else   if (!getDefaultOrder().equals(list)) {
    final JDOMExternalizableStringList ext=new JDOMExternalizableStringList(Collections.nCopies(myOrder.size(),""));
    myOrder.forEachEntry(new TObjectIntProcedure<HighlightSeverity>(){
      @Override public boolean execute(      HighlightSeverity orderSeverity,      int oIdx){
        ext.set(oIdx,orderSeverity.toString());
        return true;
      }
    }
);
    ext.writeExternal(element);
  }
}
