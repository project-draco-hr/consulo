{
  if (parentOfType != null && parentOfType.getTextLength() > MAX_SCOPE_SIZE_TO_SEARCH_UNRESOLVED)   return ArrayUtil.EMPTY_STRING_ARRAY;
  final Set<String> unresolvedRefs=new LinkedHashSet<String>();
  if (parentOfType != null) {
    parentOfType.accept(new JavaRecursiveElementWalkingVisitor(){
      @Override public void visitReferenceExpression(      PsiReferenceExpression reference){
        final PsiElement parent=reference.getParent();
        if (parent instanceof PsiReference)         return;
        if (referenceOnMethod && parent instanceof PsiMethodCallExpression && reference == ((PsiMethodCallExpression)parent).getMethodExpression()) {
          if (reference.resolve() == null) {
            ContainerUtil.addIfNotNull(unresolvedRefs,reference.getReferenceName());
          }
        }
 else         if (!referenceOnMethod && !(parent instanceof PsiMethodCallExpression) && reference.resolve() == null) {
          ContainerUtil.addIfNotNull(unresolvedRefs,reference.getReferenceName());
        }
      }
    }
);
  }
  return ArrayUtil.toStringArray(unresolvedRefs);
}
