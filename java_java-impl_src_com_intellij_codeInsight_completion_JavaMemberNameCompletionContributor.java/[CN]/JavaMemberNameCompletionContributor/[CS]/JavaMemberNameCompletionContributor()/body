{
  extend(CompletionType.BASIC,psiElement(PsiIdentifier.class).andNot(INSIDE_TYPE_PARAMS_PATTERN).withParent(or(psiElement(PsiLocalVariable.class),psiElement(PsiParameter.class))),new CompletionProvider<CompletionParameters>(){
    public void addCompletions(    @NotNull final CompletionParameters parameters,    final ProcessingContext matchingContext,    @NotNull final CompletionResultSet result){
      final Set<LookupElement> lookupSet=new THashSet<LookupElement>();
      completeLocalVariableName(lookupSet,result.getPrefixMatcher(),(PsiVariable)parameters.getPosition().getParent(),parameters.getInvocationCount() >= 1);
      for (      final LookupElement item : lookupSet) {
        if (item instanceof LookupItem) {
          ((LookupItem)item).setAutoCompletionPolicy(AutoCompletionPolicy.GIVE_CHANCE_TO_OVERWRITE);
        }
        result.addElement(item);
      }
    }
  }
);
  extend(CompletionType.BASIC,psiElement(PsiIdentifier.class).withParent(PsiField.class).andNot(INSIDE_TYPE_PARAMS_PATTERN),new CompletionProvider<CompletionParameters>(){
    public void addCompletions(    @NotNull final CompletionParameters parameters,    final ProcessingContext matchingContext,    @NotNull final CompletionResultSet result){
      final Set<LookupElement> lookupSet=new THashSet<LookupElement>();
      final PsiField variable=(PsiField)parameters.getPosition().getParent();
      completeMethodName(lookupSet,variable,result.getPrefixMatcher());
      completeFieldName(lookupSet,variable,result.getPrefixMatcher(),parameters.getInvocationCount() >= 1);
      for (      final LookupElement item : lookupSet) {
        result.addElement(item);
      }
    }
  }
);
  extend(CompletionType.BASIC,PsiJavaPatterns.psiElement().nameIdentifierOf(PsiJavaPatterns.psiMethod().withParent(PsiClass.class)),new CompletionProvider<CompletionParameters>(){
    public void addCompletions(    @NotNull final CompletionParameters parameters,    final ProcessingContext matchingContext,    @NotNull final CompletionResultSet result){
      final Set<LookupElement> lookupSet=new THashSet<LookupElement>();
      completeMethodName(lookupSet,parameters.getPosition().getParent(),result.getPrefixMatcher());
      for (      final LookupElement item : lookupSet) {
        result.addElement(item);
      }
    }
  }
);
}
