{
  if (myShifted == null || myBase == null) {
    myResult=null;
    return;
  }
  if (stringEqual(myShifted,myBase)) {
    myResult=".";
    myRename=false;
    return;
  }
  final String[] baseParts=split(myBase);
  final String[] shiftedParts=split(myShifted);
  myRename=checkRename(baseParts,shiftedParts);
  int cnt=0;
  while (true) {
    if ((baseParts.length <= cnt) || (shiftedParts.length <= cnt)) {
      return;
    }
    if (!stringEqual(baseParts[cnt],shiftedParts[cnt])) {
      break;
    }
    ++cnt;
  }
  final int stepsUp=baseParts.length - cnt - 1;
  if ((!myRename) && (stepsUp > ourNumOfAllowedStepsAbove) && ((shiftedParts.length - cnt) <= ourAllowedStepsDown)) {
    myResult=myShifted;
    return;
  }
  final StringBuilder sb=new StringBuilder();
  for (int i=0; i < stepsUp; i++) {
    sb.append("../");
  }
  for (int i=cnt; i < shiftedParts.length; i++) {
    final String shiftedPart=shiftedParts[i];
    sb.append(shiftedPart);
    if (i < (shiftedParts.length - 1)) {
      sb.append('/');
    }
  }
  myResult=sb.toString();
}
