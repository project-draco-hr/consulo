{
  final CodeFragmentFactory factory=ApplicationManager.getApplication().runReadAction(new Computable<CodeFragmentFactory>(){
    public CodeFragmentFactory compute(){
      final List<CodeFragmentFactory> codeFragmentFactories=getCodeFragmentFactories(psiContext);
      return codeFragmentFactories.get(0);
    }
  }
);
  return factory != null ? new CodeFragmentFactoryContextWrapper(factory) : null;
}
