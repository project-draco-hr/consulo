{
  super(table);
  final ListSelectionListener selectionListener=new ListSelectionListener(){
    @Override public void valueChanged(    ListSelectionEvent e){
      if (e.getValueIsAdjusting())       return;
      updateSelection(table);
    }
  }
;
  table.getSelectionModel().addListSelectionListener(selectionListener);
  table.getColumnModel().getSelectionModel().addListSelectionListener(selectionListener);
  table.addPropertyChangeListener("selectionModel",new PropertyChangeListener(){
    @Override public void propertyChange(    PropertyChangeEvent evt){
      if (evt.getOldValue() != null) {
        ((ListSelectionModel)evt.getOldValue()).removeListSelectionListener(selectionListener);
      }
      if (evt.getNewValue() != null) {
        ((ListSelectionModel)evt.getNewValue()).addListSelectionListener(selectionListener);
      }
    }
  }
);
  table.addPropertyChangeListener("columnModel",new PropertyChangeListener(){
    @Override public void propertyChange(    PropertyChangeEvent evt){
      if (evt.getOldValue() != null) {
        ((TableColumnModel)evt.getOldValue()).getSelectionModel().removeListSelectionListener(selectionListener);
      }
      if (evt.getNewValue() != null) {
        ((TableColumnModel)evt.getNewValue()).getSelectionModel().addListSelectionListener(selectionListener);
      }
    }
  }
);
  final TableModelListener modelListener=new TableModelListener(){
    @Override public void tableChanged(    TableModelEvent e){
      updateSelection(table);
    }
  }
;
  if (table.getModel() != null)   table.getModel().addTableModelListener(modelListener);
  table.addPropertyChangeListener("model",new PropertyChangeListener(){
    @Override public void propertyChange(    PropertyChangeEvent evt){
      updateSelection(table);
      if (evt.getOldValue() != null) {
        ((TableModel)evt.getOldValue()).removeTableModelListener(modelListener);
      }
      if (evt.getNewValue() != null) {
        ((TableModel)evt.getNewValue()).addTableModelListener(modelListener);
      }
    }
  }
);
}
