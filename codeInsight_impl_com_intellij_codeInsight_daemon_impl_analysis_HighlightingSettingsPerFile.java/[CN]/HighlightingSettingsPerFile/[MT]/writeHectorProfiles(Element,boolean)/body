{
  for (  Map.Entry<VirtualFile,Pair<String,Boolean>> entry : myProfileSettings.entrySet()) {
    final Pair<String,Boolean> value=entry.getValue();
    if (value != null && (!activeOnly || value.second.booleanValue())) {
      final String name=value.first;
      final Element child=new Element(PROFILES_TAG);
      final VirtualFile vFile=entry.getKey();
      if (vFile == null || !vFile.isValid())       continue;
      child.setAttribute(FILE_ATT,vFile.getUrl());
      child.setAttribute(PROFILE_NAME_ATT,name);
      child.setAttribute(IS_ACTIVE_ATT,value.second.toString());
      element.addContent(child);
    }
  }
}
