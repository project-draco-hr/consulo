{
  return new WriteAction<Artifact>(){
    protected void run(    final Result<Artifact> result){
      final ModifiableArtifactModel model=createModifiableModel();
      final ModifiableArtifact artifact=model.addArtifact(name,type);
      if (root != null) {
        artifact.setRootElement(root);
      }
      model.commit();
      result.setResult(artifact);
    }
  }
.execute().getResultObject();
}
