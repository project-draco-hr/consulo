{
  scope.accept(new JavaRecursiveElementWalkingVisitor(){
    @Override public void visitReferenceExpression(    PsiReferenceExpression expression){
      if (expression.getQualifierExpression() == null) {
        PsiElement refElement=expression.resolve();
        if (refElement instanceof PsiVariable && !(refElement instanceof PsiField)) {
          PsiVariable var=(PsiVariable)refElement;
          final PsiClass containingClass=PsiTreeUtil.getParentOfType(var,PsiClass.class);
          if (PsiTreeUtil.isAncestor(containingClass,myAnonClass,true)) {
            saveVariable(variableInfoMap,var,expression);
          }
        }
      }
      super.visitReferenceExpression(expression);
    }
  }
);
}
