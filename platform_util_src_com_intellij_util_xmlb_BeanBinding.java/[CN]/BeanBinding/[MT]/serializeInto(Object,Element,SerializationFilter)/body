{
  for (  Binding binding : myPropertyBindings.keySet()) {
    Accessor accessor=myPropertyBindings.get(binding);
    if (!filter.accepts(accessor,o)) {
      continue;
    }
    Property property=accessor.getAnnotation(Property.class);
    if (property != null && property.filter() != SerializationFilter.class) {
      try {
        if (!ReflectionUtil.newInstance(property.filter()).accepts(accessor,o)) {
          continue;
        }
      }
 catch (      RuntimeException e) {
        throw new XmlSerializationException(e);
      }
    }
    if (element == null) {
      element=new Element(myTagName);
    }
    Object node=binding.serialize(o,element,filter);
    if (node != null) {
      if (node instanceof org.jdom.Attribute) {
        element.setAttribute((org.jdom.Attribute)node);
      }
 else {
        JDOMUtil.addContent(element,node);
      }
    }
  }
  return element;
}
