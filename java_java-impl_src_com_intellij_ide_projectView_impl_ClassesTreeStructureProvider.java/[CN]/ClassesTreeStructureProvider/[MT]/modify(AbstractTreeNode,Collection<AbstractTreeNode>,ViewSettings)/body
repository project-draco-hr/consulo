{
  ArrayList<AbstractTreeNode> result=new ArrayList<AbstractTreeNode>();
  for (  final AbstractTreeNode child : children) {
    Object o=child.getValue();
    if (o instanceof PsiClassOwner) {
      final ViewSettings settings1=((ProjectViewNode)parent).getSettings();
      final PsiClassOwner classOwner=(PsiClassOwner)o;
      if (classOwner instanceof PsiCompiledElement) {
        final PsiElement sourceElement=classOwner.getNavigationElement();
        if (sourceElement instanceof PsiFile) {
          PsiFile sourceFile=(PsiFile)sourceElement;
          if (classOwner.getManager().areElementsEquivalent(classOwner.getContainingDirectory(),sourceFile.getContainingDirectory())) {
            continue;
          }
        }
      }
      PsiClass[] classes=classOwner.getClasses();
      final VirtualFile file=classOwner.getVirtualFile();
      if (fileInRoots(file)) {
        if (classes.length == 1 && !(classes[0] instanceof SyntheticElement)) {
          result.add(new ClassTreeNode(myProject,classes[0],settings1));
        }
 else {
          result.add(new PsiClassOwnerTreeNode(classOwner,settings1));
        }
        continue;
      }
    }
    result.add(child);
  }
  return result;
}
