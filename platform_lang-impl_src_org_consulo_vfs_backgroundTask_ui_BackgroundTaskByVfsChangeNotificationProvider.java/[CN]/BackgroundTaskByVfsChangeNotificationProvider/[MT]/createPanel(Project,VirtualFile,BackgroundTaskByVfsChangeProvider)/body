{
  final BackgroundTaskByVfsChangeManager backgroundTaskManager=BackgroundTaskByVfsChangeManager.getInstance(project);
  final BackgroundTaskByVfsChangeTask task=backgroundTaskManager.getTask(virtualFile);
  final EditorNotificationPanel panel=new EditorNotificationPanel(){
    @Override public Color getBackground(){
      return JBColor.LIGHT_GRAY;
    }
  }
;
  panel.setText(changeProvider.getName() + ": background task on vfs change is available for this file.");
  panel.createActionLabel("Configure",new Runnable(){
    @Override public void run(){
      if (task != null) {
        BackgroundTaskByVfsParametersImpl parameters=new BackgroundTaskByVfsParametersImpl(project);
        parameters.set(task.getParameters());
        BackgroundTaskByVfsChangeDialog dialog=new BackgroundTaskByVfsChangeDialog(project,parameters);
        boolean b=dialog.showAndGet();
        if (b) {
          task.getParameters().set(parameters);
          updateNotify(task);
        }
      }
 else {
        BackgroundTaskByVfsParametersImpl parameters=new BackgroundTaskByVfsParametersImpl(project);
        changeProvider.setDefaultParameters(project,virtualFile,parameters);
        BackgroundTaskByVfsChangeDialog dialog=new BackgroundTaskByVfsChangeDialog(project,parameters);
        boolean b=dialog.showAndGet();
        if (b) {
          updateNotify(backgroundTaskManager.registerTask(virtualFile,changeProvider,parameters));
        }
      }
    }
  }
);
  if (task != null) {
    panel.createActionLabel("Cancel",new Runnable(){
      @Override public void run(){
        backgroundTaskManager.cancelTask(task);
        updateNotify(task);
      }
    }
);
  }
  return panel;
}
