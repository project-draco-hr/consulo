{
  CvsApplicationLevelConfiguration config=CvsApplicationLevelConfiguration.getInstance();
  KeywordSubstitutionWrapper substitution=KeywordSubstitutionWrapper.getValue(config.CHECKOUT_KEYWORD_SUBSTITUTION);
  File root;
  String directory;
  if (useAlternativecheckoutDir && targetLocation.getParentFile() == null) {
    root=targetLocation;
    directory=getModuleRootName(moduleName);
  }
 else   if (useAlternativecheckoutDir) {
    root=targetLocation.getParentFile();
    directory=targetLocation.getName();
  }
 else {
    root=targetLocation;
    directory=null;
  }
  return new CheckoutProjectOperation(moduleName,env,makeNewFilesReadOnly,root,directory,config.CHECKOUT_PRUNE_EMPTY_DIRECTORIES,substitution == null ? null : substitution.getSubstitution());
}
