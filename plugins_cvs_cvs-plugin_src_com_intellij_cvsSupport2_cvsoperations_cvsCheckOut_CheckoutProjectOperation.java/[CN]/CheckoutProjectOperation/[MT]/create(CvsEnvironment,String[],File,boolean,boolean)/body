{
  final CvsApplicationLevelConfiguration config=CvsApplicationLevelConfiguration.getInstance();
  final KeywordSubstitutionWrapper substitution=KeywordSubstitutionWrapper.getValue(config.CHECKOUT_KEYWORD_SUBSTITUTION);
  final File root;
  final String directory;
  if (useAlternativeCheckoutDir && targetLocation.getParentFile() == null) {
    root=targetLocation;
    directory=getModuleRootName(moduleName);
  }
 else   if (useAlternativeCheckoutDir) {
    root=targetLocation.getParentFile();
    directory=targetLocation.getName();
  }
 else {
    root=targetLocation;
    directory=null;
  }
  return new CheckoutProjectOperation(moduleName,env,makeNewFilesReadOnly,root,directory,config.CHECKOUT_PRUNE_EMPTY_DIRECTORIES,substitution == null ? null : substitution.getSubstitution());
}
