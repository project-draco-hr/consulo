{
  return IconDeferrer.getInstance().defer(file.getIcon(),new FileIconKey(file,project,flags),new Function<FileIconKey,Icon>(){
    public Icon fun(    final FileIconKey fileIconKey){
      Icon providersIcon=getProvidersIcon(file,flags,project);
      Icon icon=providersIcon == null ? file.getIcon() : providersIcon;
      for (      FileIconPatcher patcher : getPatchers()) {
        icon=patcher.patchIcon(icon,file,flags,project);
      }
      return icon;
    }
  }
);
}
