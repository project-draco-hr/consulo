{
  myAnonClass.accept(new JavaRecursiveElementWalkingVisitor(){
    @Override public void visitReferenceElement(    PsiJavaCodeReferenceElement reference){
      super.visitReferenceElement(reference);
      final PsiElement resolved=reference.resolve();
      if (resolved instanceof PsiTypeParameter) {
        final PsiTypeParameterListOwner owner=((PsiTypeParameter)resolved).getOwner();
        if (!PsiTreeUtil.isAncestor(myAnonClass,owner,false)) {
          myTypeParametersToCreate.add((PsiTypeParameter)resolved);
        }
      }
    }
  }
);
}
