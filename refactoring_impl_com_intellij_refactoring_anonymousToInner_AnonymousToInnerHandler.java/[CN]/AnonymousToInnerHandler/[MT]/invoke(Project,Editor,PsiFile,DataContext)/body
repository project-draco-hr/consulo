{
  if (!CommonRefactoringUtil.checkReadOnlyStatus(project,file))   return;
  final int offset=editor.getCaretModel().getOffset();
  editor.getScrollingModel().scrollToCaret(ScrollType.MAKE_VISIBLE);
  final PsiAnonymousClass anonymousClass=findAnonymousClass(file,offset);
  if (anonymousClass == null) {
    CommonRefactoringUtil.showErrorMessage(REFACTORING_NAME,RefactoringBundle.getCannotRefactorMessage(RefactoringBundle.message("error.wrong.caret.position.anonymous")),HelpID.ANONYMOUS_TO_INNER,project);
    return;
  }
  invoke(project,anonymousClass);
}
