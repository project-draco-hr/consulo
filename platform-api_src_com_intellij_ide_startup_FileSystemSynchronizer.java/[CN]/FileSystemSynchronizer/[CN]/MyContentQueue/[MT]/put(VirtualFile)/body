{
  ProgressIndicator indicator=ProgressManager.getInstance().getProgressIndicator();
  FileContent content;
synchronized (this) {
    content=new FileContent(file);
    if (file.isValid()) {
      try {
        if (content.getPhysicalLength() < SIZE_THRESHOLD) {
          while (totalSize > SIZE_THRESHOLD) {
            if (indicator != null)             indicator.checkCanceled();
            wait(300);
          }
          totalSize+=content.getPhysicalBytes().length;
        }
      }
 catch (      IOException e) {
        content.setEmptyContent();
      }
catch (      ProcessCanceledException e) {
        throw e;
      }
catch (      Throwable e) {
        LOG.error(e);
      }
    }
 else {
      content.setEmptyContent();
    }
  }
  put(content);
}
