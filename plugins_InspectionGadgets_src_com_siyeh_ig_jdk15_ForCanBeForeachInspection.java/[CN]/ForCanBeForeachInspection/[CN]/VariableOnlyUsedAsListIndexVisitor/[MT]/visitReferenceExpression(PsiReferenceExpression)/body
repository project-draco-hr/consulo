{
  if (!indexVariableUsedOnlyAsIndex) {
    return;
  }
  super.visitReferenceExpression(ref);
  final PsiElement element=ref.resolve();
  if (indexVariable.equals(element) && !isListIndexExpression(ref,collection)) {
    indexVariableUsedOnlyAsIndex=false;
  }
  if (collection.equals(element) && !isListReferenceInIndexExpression(ref,collection)) {
    indexVariableUsedOnlyAsIndex=false;
  }
}
