{
  myElementUpdate.clear();
  final boolean[] wasInterrupted=new boolean[1];
  myElementUpdateHook=new ElementUpdateHook(){
    public void onElementAction(    String action,    Object element){
      if (wasInterrupted[0]) {
        if (myCancelRequest == null) {
          myCancelRequest=new AssertionError("Not supposed to be update after interruption request: action=" + action + " element="+ element+ " interruptAction="+ interruptAction+ " interruptElement="+ interruptElement);
        }
      }
 else {
        if (element.equals(interruptElement) && action.equals(interruptAction)) {
          wasInterrupted[0]=true;
switch (interruption) {
case throwProcessCancelled:
            throw new ProcessCanceledException();
case invokeCancel:
          getBuilder().cancelUpdate();
        break;
    }
  }
}
}
}
;
action.run();
}
