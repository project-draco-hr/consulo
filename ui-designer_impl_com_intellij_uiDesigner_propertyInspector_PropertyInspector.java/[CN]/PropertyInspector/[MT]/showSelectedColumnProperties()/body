{
  if (myColumnPropertiesPanel != null && IJSwingUtilities.hasFocus(myColumnPropertiesPanel.getComponent())) {
    return true;
  }
  if (myEditor == null)   return false;
  GridCaptionPanel panel=myEditor.getFocusedCaptionPanel();
  if (panel == null)   return false;
  RadContainer container=panel.getSelectedContainer();
  if (container == null)   return false;
  final int[] selection=panel.getSelectedCells(null);
  myPropertiesPanelContainer=container;
  final RowColumnPropertiesPanel propertiesPanel=container.getGridLayoutManager().getRowColumnPropertiesPanel(container,panel.isRow(),selection);
  if (propertiesPanel == null)   return false;
  if (!Comparing.equal(propertiesPanel,myColumnPropertiesPanel)) {
    if (myColumnPropertiesPanel != null) {
      remove(myColumnPropertiesPanel.getComponent());
      myColumnPropertiesPanel.removeChangeListener(myColumnPropertiesChangeListener);
    }
    myColumnPropertiesPanel=propertiesPanel;
    myColumnPropertiesPanel.addChangeListener(myColumnPropertiesChangeListener);
    add(myColumnPropertiesPanel.getComponent(),COLUMN_CARD);
  }
  final CardLayout cardLayout=(CardLayout)getLayout();
  cardLayout.show(this,COLUMN_CARD);
  return true;
}
