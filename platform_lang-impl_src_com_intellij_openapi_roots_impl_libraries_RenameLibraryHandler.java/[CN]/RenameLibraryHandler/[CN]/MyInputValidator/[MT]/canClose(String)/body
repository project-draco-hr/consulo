{
  final String oldName=myLibrary.getName();
  final Library.ModifiableModel modifiableModel=renameLibrary(inputString);
  if (modifiableModel == null)   return false;
  final Ref<Boolean> success=Ref.create(Boolean.TRUE);
  CommandProcessor.getInstance().executeCommand(myProject,new Runnable(){
    public void run(){
      UndoableAction action=new BasicUndoableAction(){
        public void undo() throws UnexpectedUndoException {
          final Library.ModifiableModel modifiableModel=renameLibrary(oldName);
          if (modifiableModel != null) {
            modifiableModel.commit();
          }
        }
        @Override public void redo() throws UnexpectedUndoException {
          final Library.ModifiableModel modifiableModel=renameLibrary(inputString);
          if (modifiableModel != null) {
            modifiableModel.commit();
          }
        }
      }
;
      UndoManager.getInstance(myProject).undoableActionPerformed(action);
      ApplicationManager.getApplication().runWriteAction(new Runnable(){
        public void run(){
          modifiableModel.commit();
        }
      }
);
    }
  }
,IdeBundle.message("command.renaming.module",oldName),null);
  return success.get().booleanValue();
}
