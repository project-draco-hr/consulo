{
  myDiffUpdater.contentRemoved(source);
  final EditorEx editor=source.getEditor();
  if (source.getSide() == FragmentSide.SIDE1 && editor != null) {
    editor.setVerticalScrollbarOrientation(EditorEx.VERTICAL_SCROLLBAR_LEFT);
  }
  DiffSideView viewSide=getSideView(source.getSide());
  viewSide.setEditorSource(source);
  myScrollSupport.dispose();
  if (editor == null) {
    if (!myDisposed) {
      rediff();
    }
    return;
  }
  PopupHandler.installUnknownPopupHandler(editor.getContentComponent(),new MergeActionGroup(this,source.getSide()),ActionManager.getInstance());
  myDiffUpdater.contentAdded(source);
  editor.getSettings().setLineNumbersShown(true);
  editor.getSettings().setFoldingOutlineShown(false);
  ((FoldingModelEx)editor.getFoldingModel()).setFoldingEnabled(false);
  ((EditorMarkupModel)editor.getMarkupModel()).setErrorStripeVisible(true);
  Editor editor1=getEditor(FragmentSide.SIDE1);
  Editor editor2=getEditor(FragmentSide.SIDE2);
  if (editor1 != null && editor2 != null) {
    myScrollSupport.install(new EditingSides[]{this});
  }
  final VisibleAreaListener visibleAreaListener=mySplitter.getVisibleAreaListener();
  final ScrollingModel scrollingModel=editor.getScrollingModel();
  scrollingModel.addVisibleAreaListener(visibleAreaListener);
  myFontSizeSynchronizer.synchronize(editor);
  source.addDisposable(new Disposable(){
    public void dispose(){
      myFontSizeSynchronizer.stopSynchronize(editor);
    }
  }
);
  source.addDisposable(new Disposable(){
    public void dispose(){
      scrollingModel.removeVisibleAreaListener(visibleAreaListener);
    }
  }
);
}
