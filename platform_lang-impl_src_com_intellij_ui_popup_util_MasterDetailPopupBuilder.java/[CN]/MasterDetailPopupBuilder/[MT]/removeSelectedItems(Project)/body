{
  if (myChooserComponent instanceof JList) {
    final JList list=(JList)myChooserComponent;
    int index=list.getSelectedIndex();
    if (index == -1 || index >= list.getModel().getSize()) {
      return;
    }
    Object[] values=list.getSelectedValues();
    for (    Object value : values) {
      ItemWrapper item=(ItemWrapper)value;
      DefaultListModel model=list.getModel() instanceof DefaultListModel ? (DefaultListModel)list.getModel() : (DefaultListModel)((FilteringListModel)list.getModel()).getOriginalModel();
      if (item.allowedToRemove()) {
        model.removeElement(item);
        if (model.getSize() > 0) {
          if (model.getSize() == index) {
            list.setSelectedIndex(model.getSize() - 1);
          }
 else           if (model.getSize() > index) {
            list.setSelectedIndex(index);
          }
        }
 else {
          list.clearSelection();
        }
        item.removed(project);
      }
    }
  }
 else {
    final Object[] items=getSelectedItems();
    for (    Object item : items) {
      ((ItemWrapper)item).removed(project);
    }
  }
}
