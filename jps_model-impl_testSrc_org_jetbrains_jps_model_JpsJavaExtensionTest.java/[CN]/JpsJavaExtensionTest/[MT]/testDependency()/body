{
  final JpsModel model=myModel.createModifiableModel(new TestJpsEventDispatcher());
  final JpsModule module=model.getProject().addModule("m",JpsJavaModuleType.INSTANCE);
  final JpsLibrary library=model.getProject().addLibrary("l",JpsJavaLibraryType.INSTANCE);
  final JpsLibraryDependency dependency=module.getDependenciesList().addLibraryDependency(library);
  JpsJavaExtensionService.getInstance().getOrCreateDependencyExtension(dependency).setScope(JpsJavaDependencyScope.TEST);
  JpsJavaExtensionService.getInstance().getOrCreateDependencyExtension(dependency).setExported(true);
  model.commit();
  final JpsDependencyElement dep=assertOneElement(assertOneElement(myModel.getProject().getModules()).getDependenciesList().getDependencies());
  final JpsJavaDependencyExtension extension=dep.getContainer().getChild(JpsJavaExtensionService.getInstance().getDependencyExtensionKind());
  assertTrue(extension.isExported());
  assertSame(JpsJavaDependencyScope.TEST,extension.getScope());
}
