{
  int endOffset=getEndOffset();
  if (myTargetArea == HighlighterTargetArea.EXACT_RANGE)   return endOffset;
  int textLength=getDocument().getTextLength();
  if (endOffset == textLength)   return endOffset;
  return Math.min(textLength,getDocument().getLineEndOffset(getDocument().getLineNumber(endOffset)) + 1);
}
