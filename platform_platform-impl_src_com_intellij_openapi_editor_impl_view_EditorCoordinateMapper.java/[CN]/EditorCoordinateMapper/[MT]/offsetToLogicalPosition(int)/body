{
  int textLength=myDocument.getTextLength();
  if (offset <= 0 || textLength == 0) {
    return new LogicalPosition(0,0);
  }
  offset=Math.min(offset,textLength);
  int line=myDocument.getLineNumber(offset);
  offset=Math.min(offset,myDocument.getLineEndOffset(line));
  int column=0;
  CharSequence text=myDocument.getImmutableCharSequence();
  int tabSize=myView.getTabSize();
  for (int i=myDocument.getLineStartOffset(line); i < offset; i++) {
    if (text.charAt(i) == '\t') {
      column=(column / tabSize + 1) * tabSize;
    }
 else {
      column++;
    }
  }
  return new LogicalPosition(line,column);
}
