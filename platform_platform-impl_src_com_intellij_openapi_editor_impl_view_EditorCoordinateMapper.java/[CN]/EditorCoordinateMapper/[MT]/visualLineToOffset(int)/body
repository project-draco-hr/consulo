{
  int start=0;
  int end=myDocument.getTextLength();
  int current=0;
  while (start <= end) {
    current=(start + end) / 2;
    int line=offsetToVisualLine(current,false);
    if (line < visualLine) {
      start=current + 1;
    }
 else     if (line > visualLine) {
      end=current - 1;
    }
 else {
      break;
    }
  }
  return visualLineStartOffset(current,true);
}
