{
  if (length == 0) {
    file.createNewFile();
    return;
  }
  final OutputStream fileOutputStream=new FileOutputStream(file);
  try {
    final byte[] chunk=new byte[BUFFER_SIZE];
    int size=length;
    while (size > 0) {
      final int bytesToRead=Math.min(size,chunk.length);
      final int bytesRead=inputStream.read(chunk,0,bytesToRead);
      if (bytesRead < 0) {
        break;
      }
      size-=bytesRead;
      fileOutputStream.write(chunk,0,bytesRead);
    }
  }
  finally {
    try {
      fileOutputStream.close();
    }
 catch (    IOException ex) {
    }
  }
}
