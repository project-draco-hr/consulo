{
  String fileName=newName + "." + extractExtension(templateName);
  PsiFile file=GroovyTemplatesFactory.createFromTemplate(directory,newName,fileName,templateName);
  if (file instanceof GroovyFile)   return (GroovyFile)file;
  final String description=file.getFileType().getDescription();
  throw new IncorrectOperationException(GroovyBundle.message("groovy.file.extension.is.not.mapped.to.groovy.file.type",description));
}
