{
  final HashSet<String> seenNames=new HashSet<String>();
  for (  VirtualFile folder : folderPaths) {
    progressIndicator.setText2("Scanning folder: " + folder.getPath());
    final PsiManager manager=PsiManager.getInstance(project);
    processFolder(seenNames,manager,folder);
  }
  if (seenNames.isEmpty()) {
    LOG.info("  No new words was found.");
    return;
  }
  final StringBuilder builder=new StringBuilder();
  final ArrayList<String> names=new ArrayList<String>(seenNames);
  Collections.sort(names);
  for (  String name : names) {
    if (builder.length() > 0) {
      builder.append("\n");
    }
    builder.append(name);
  }
  try {
    final File dictionaryFile=new File(outFile);
    FileUtil.createIfDoesntExist(dictionaryFile);
    final FileWriter writer=new FileWriter(dictionaryFile.getPath());
    try {
      writer.write(builder.toString());
    }
  finally {
      writer.close();
    }
  }
 catch (  IOException e) {
    LOG.error(e);
  }
}
