{
  SimpleTextAttributes textAttributes=null;
  if (value instanceof DefaultMutableTreeNode) {
    DefaultMutableTreeNode node=(DefaultMutableTreeNode)value;
    Object userObject=node.getUserObject();
    if (userObject instanceof NodeDescriptor) {
      NodeDescriptor descriptor=(NodeDescriptor)userObject;
      if (expanded) {
        setIcon(descriptor.getOpenIcon());
      }
 else {
        setIcon(descriptor.getClosedIcon());
      }
      textAttributes=getTextAttributes(descriptor);
    }
  }
  String text=tree.convertValueToText(value instanceof AbstractTreeNode ? ((AbstractTreeNode)value).toString() : value,selected,expanded,leaf,row,hasFocus);
  if (text == null)   text="";
  append(text,textAttributes == null ? SimpleTextAttributes.REGULAR_ATTRIBUTES : textAttributes);
  if (value instanceof DefaultMutableTreeNode) {
    DefaultMutableTreeNode node=(DefaultMutableTreeNode)value;
    Object userObject=node.getUserObject();
    if (userObject instanceof AbstractTreeNode) {
      AbstractTreeNode treeNode=((AbstractTreeNode)userObject);
      String locationString=treeNode.getPresentation().getLocationString();
      if (locationString != null && locationString.length() > 0) {
        append(" (" + locationString + ")",SimpleTextAttributes.GRAY_ATTRIBUTES);
      }
    }
  }
}
