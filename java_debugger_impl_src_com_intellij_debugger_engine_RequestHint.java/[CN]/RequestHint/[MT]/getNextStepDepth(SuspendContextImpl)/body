{
  try {
    if ((myDepth == StepRequest.STEP_OVER || myDepth == StepRequest.STEP_INTO) && myPosition != null) {
      final Integer resultDepth=ApplicationManager.getApplication().runReadAction(new Computable<Integer>(){
        public Integer compute(){
          final SourcePosition locationPosition=ContextUtil.getSourcePosition(context);
          if (locationPosition == null) {
            return null;
          }
          int frameCount=-1;
          final ThreadReferenceProxyImpl contextThread=context.getThread();
          if (contextThread != null) {
            try {
              frameCount=contextThread.frameCount();
            }
 catch (            EvaluateException e) {
            }
          }
          final boolean filesEqual=myPosition.getFile().equals(locationPosition.getFile());
          if (filesEqual && myPosition.getLine() == locationPosition.getLine() && myFrameCount == frameCount) {
            return myDepth;
          }
          if (myDepth == StepRequest.STEP_INTO) {
            if (filesEqual && myFrameCount == frameCount && myPosition.getLine() != locationPosition.getLine()) {
              return STOP;
            }
          }
          return null;
        }
      }
);
      if (resultDepth != null) {
        return resultDepth.intValue();
      }
    }
    if (myDepth == StepRequest.STEP_INTO) {
      final DebuggerSettings settings=DebuggerSettings.getInstance();
      final StackFrameProxyImpl frameProxy=context.getFrameProxy();
      if (settings.SKIP_SYNTHETIC_METHODS && frameProxy != null) {
        final Location location=frameProxy.location();
        final Method method=location.method();
        if (method != null) {
          if (myVirtualMachineProxy.canGetSyntheticAttribute() ? method.isSynthetic() : method.name().indexOf('$') >= 0) {
            return myDepth;
          }
        }
      }
      if (!myIgnoreFilters) {
        if (settings.SKIP_GETTERS) {
          boolean isGetter=ApplicationManager.getApplication().runReadAction(new Computable<Boolean>(){
            public Boolean compute(){
              final PsiMethod psiMethod=PsiTreeUtil.getParentOfType(PositionUtil.getContextElement(context),PsiMethod.class);
              return (psiMethod != null && DebuggerUtils.isSimpleGetter(psiMethod)) ? Boolean.TRUE : Boolean.FALSE;
            }
          }
).booleanValue();
          if (isGetter) {
            return StepRequest.STEP_OUT;
          }
        }
        if (frameProxy != null) {
          if (settings.SKIP_CONSTRUCTORS) {
            final Location location=frameProxy.location();
            final Method method=location.method();
            if (method != null && method.isConstructor()) {
              return StepRequest.STEP_OUT;
            }
          }
          if (settings.SKIP_CLASSLOADERS) {
            final Location location=frameProxy.location();
            if (DebuggerUtilsEx.isAssignableFrom("java.lang.ClassLoader",location.declaringType())) {
              return StepRequest.STEP_OUT;
            }
          }
        }
      }
      if (myTargetMethodSignature != null) {
        if (!myTargetMethodSignature.shouldStopAtLocation(context)) {
          return StepRequest.STEP_OUT;
        }
      }
    }
  }
 catch (  VMDisconnectedException e) {
  }
catch (  EvaluateException e) {
    LOG.error(e);
  }
  return STOP;
}
