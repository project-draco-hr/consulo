{
  List<String> namesList=new ArrayList<String>();
  boolean overflow=getNamesByPattern(myCheckboxState,myCancelled,namesList,pattern);
  if (myCancelled[0]) {
    throw new ProcessCanceledException();
  }
  Collections.sort(namesList,new MatchesComparator(pattern));
  All:   for (int i=0; i < namesList.size(); i++) {
    if (myCancelled[0]) {
      throw new ProcessCanceledException();
    }
    final String name=namesList.get(i);
    final Object[] elements=myModel.getElementsByName(name,myCheckboxState);
    for (    final Object element : elements) {
      elementsArray.add(element);
      if (elementsArray.size() >= myMaximumListSizeLimit) {
        overflow=true;
        break All;
      }
    }
  }
  if (overflow) {
    elementsArray.add(OUR_EXTRA_ELEMENT);
  }
}
