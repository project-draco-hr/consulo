{
  LookupItem item=activeLookup.getCurrentItem();
  if (item == null)   return null;
  Object o=item.getObject();
  if (o instanceof PsiClass || o instanceof PsiPackage || o instanceof PsiMethod|| o instanceof PsiVariable|| o instanceof PsiFile) {
    PsiElement element=(PsiElement)o;
    if (!(element instanceof PsiPackage)) {
      PsiFile file=element.getContainingFile();
      if (file == null)       return null;
      if (file.getOriginalFile() != null)       file=file.getOriginalFile();
      if (file == null)       return null;
      if (file.getVirtualFile() == null)       return null;
    }
    return element;
  }
 else {
    return null;
  }
}
