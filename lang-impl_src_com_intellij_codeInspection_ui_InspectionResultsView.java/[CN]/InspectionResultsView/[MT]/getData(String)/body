{
  if (dataId.equals(DataConstants.HELP_ID))   return HELP_ID;
  if (dataId.equals(DataConstantsEx.INSPECTION_VIEW))   return this;
  if (myTree == null)   return null;
  TreePath[] paths=myTree.getSelectionPaths();
  if (paths == null)   return null;
  if (paths.length > 1) {
    if (DataConstants.PSI_ELEMENT_ARRAY.equals(dataId)) {
      return collectPsiElements();
    }
 else {
      return null;
    }
  }
  TreePath path=paths[0];
  InspectionTreeNode selectedNode=(InspectionTreeNode)path.getLastPathComponent();
  if (selectedNode instanceof RefElementNode) {
    final RefElementNode refElementNode=(RefElementNode)selectedNode;
    RefEntity refElement=refElementNode.getElement();
    final RefEntity item;
    if (refElement instanceof RefImplicitConstructor) {
      item=((RefImplicitConstructor)refElement).getOwnerClass();
    }
 else {
      item=refElement;
    }
    if (item == null || !item.isValid())     return null;
    PsiElement psiElement=item instanceof RefElement ? ((RefElement)item).getElement() : null;
    if (psiElement == null)     return null;
    final CommonProblemDescriptor problem=refElementNode.getProblem();
    if (problem != null) {
      if (problem instanceof ProblemDescriptor) {
        psiElement=((ProblemDescriptor)problem).getPsiElement();
        if (psiElement == null)         return null;
      }
 else {
        return null;
      }
    }
    if (DataConstants.NAVIGATABLE.equals(dataId)) {
      return getSelectedNavigatable(problem,psiElement);
    }
 else     if (DataConstants.PSI_ELEMENT.equals(dataId)) {
      return psiElement;
    }
  }
 else   if (selectedNode instanceof ProblemDescriptionNode && DataConstants.NAVIGATABLE.equals(dataId)) {
    return getSelectedNavigatable(((ProblemDescriptionNode)selectedNode).getDescriptor());
  }
  return null;
}
