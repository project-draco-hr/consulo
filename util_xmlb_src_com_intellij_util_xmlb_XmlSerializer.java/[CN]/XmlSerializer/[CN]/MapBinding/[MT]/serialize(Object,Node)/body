{
  Map map=(Map)o;
  Document ownerDocument=getOwnerDocument(context);
  Element m=ownerDocument.createElement(MAP);
  for (  Object k : map.keySet()) {
    Object v=map.get(k);
    Element entry=ownerDocument.createElement(ENTRY);
    m.appendChild(entry);
    Node kNode=getValueBinding(k).serialize(k,entry);
    Node vNode=getValueBinding(v).serialize(v,entry);
    if (kNode instanceof Text) {
      Text text=(Text)kNode;
      entry.setAttribute(KEY,text.getWholeText());
    }
 else {
      Element key=ownerDocument.createElement(KEY);
      entry.appendChild(key);
      key.appendChild(kNode);
    }
    if (vNode instanceof Text) {
      Text text=(Text)vNode;
      entry.setAttribute(VALUE,text.getWholeText());
    }
 else {
      Element value=ownerDocument.createElement(VALUE);
      entry.appendChild(value);
      value.appendChild(vNode);
    }
  }
  return m;
}
