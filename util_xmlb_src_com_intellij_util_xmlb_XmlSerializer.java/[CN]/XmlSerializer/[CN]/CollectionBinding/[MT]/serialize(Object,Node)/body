{
  Collection collection=(Collection)o;
  Document ownerDocument=getOwnerDocument(context);
  Element c=ownerDocument.createElement(COLLECTION);
  for (  Object e : collection) {
    Node node=getValueBinding(e).serialize(e,c);
    if (node instanceof Text) {
      Text text=(Text)node;
      Element option=ownerDocument.createElement(OPTION);
      c.appendChild(option);
      option.setAttribute(VALUE,text.getWholeText());
    }
 else {
      c.appendChild(node);
    }
  }
  return c;
}
