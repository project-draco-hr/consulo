{
  if (alreadyComputedIds != null && alreadyComputedIds.contains(dataId))   return null;
  try {
    Object data=provider.getData(dataId);
    if (data != null)     return validated(data,dataId,provider);
    GetDataRule dataRule=getDataRule(dataId);
    if (dataRule != null) {
      final Set<String> ids=alreadyComputedIds == null ? new THashSet<String>() : alreadyComputedIds;
      ids.add(dataId);
      data=dataRule.getData(new DataProvider(){
        @Override public Object getData(        String dataId){
          return getDataFromProvider(provider,dataId,ids);
        }
      }
);
      if (data != null)       return validated(data,dataId,provider);
    }
    return null;
  }
  finally {
    if (alreadyComputedIds != null)     alreadyComputedIds.remove(dataId);
  }
}
