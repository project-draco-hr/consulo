{
  int offset=editor.getCaretModel().getOffset();
  PsiElement element=file.findElementAt(offset);
  if (element == null)   return false;
  PsiClass psiClass=PsiTreeUtil.getParentOfType(element,PsiClass.class);
  if (psiClass == null || psiClass.isAnnotationType() || psiClass.isEnum())   return false;
  PsiJavaToken lBrace=psiClass.getLBrace();
  if (lBrace == null)   return false;
  if (element.getTextOffset() >= lBrace.getTextOffset())   return false;
  if (!psiClass.isInterface() && !psiClass.hasModifierProperty(PsiModifier.ABSTRACT))   return false;
  myText="Implement " + (psiClass.isInterface() ? "Interface" : "Abstract Class");
  return true;
}
