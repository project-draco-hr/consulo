{
  IElementType tokenType=token.getNode().getElementType();
  if (tokenType == mREGEX_CONTENT || tokenType == mREGEX_LITERAL) {
    return StringUtil.escapeSlashes(s);
  }
  String chars;
  if (tokenType == mGSTRING_CONTENT || tokenType == mGSTRING_LITERAL) {
    if (token.getText().contains("\"\"\"")) {
      chars="$";
    }
 else {
      chars="\"$";
    }
  }
 else   if (tokenType == mSTRING_LITERAL && !token.getText().contains("'''")) {
    chars="'";
  }
 else {
    chars="";
  }
  StringBuilder buffer=new StringBuilder();
  StringUtil.escapeStringCharacters(s.length(),s,chars,escapeSlashes,buffer);
  return buffer.toString();
}
