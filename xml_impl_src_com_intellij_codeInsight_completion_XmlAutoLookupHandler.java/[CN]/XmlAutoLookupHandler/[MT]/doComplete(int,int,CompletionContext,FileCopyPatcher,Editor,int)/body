{
  PsiFile file=context.file;
  int offset=context.getStartOffset();
  PsiElement lastElement=InjectedLanguageUtil.findElementAtNoCommit(file,offset - 1);
  if (lastElement == null)   return;
  final Ref<Boolean> isRelevantLanguage=new Ref<Boolean>();
  final Ref<Boolean> isAnt=new Ref<Boolean>();
  String text=lastElement.getText();
  final int len=context.getStartOffset() - lastElement.getTextRange().getStartOffset();
  if (len < text.length()) {
    text=text.substring(0,len);
  }
  if (text.equals("<") && isLanguageRelevant(lastElement,file,isRelevantLanguage,isAnt) || text.equals(" ") && isLanguageRelevant(lastElement,file,isRelevantLanguage,isAnt) || text.endsWith("${") && isLanguageRelevant(lastElement,file,isRelevantLanguage,isAnt) && isAnt.get().booleanValue() || text.endsWith("@{") && isLanguageRelevant(lastElement,file,isRelevantLanguage,isAnt) && isAnt.get().booleanValue() || text.endsWith("</") && isLanguageRelevant(lastElement,file,isRelevantLanguage,isAnt)) {
    super.doComplete(offset1,offset2,context,dummyIdentifier,editor,invocationCount);
  }
}
