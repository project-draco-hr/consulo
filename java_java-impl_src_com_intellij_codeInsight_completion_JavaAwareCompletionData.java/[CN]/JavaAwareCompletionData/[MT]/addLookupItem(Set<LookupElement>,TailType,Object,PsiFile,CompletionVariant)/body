{
  if (completion instanceof LookupElement && !(completion instanceof LookupItem)) {
    set.add((LookupElement)completion);
    return;
  }
  LookupItem ret=LookupItemUtil.objectToLookupItem(completion);
  if (ret == null)   return;
  final InsertHandler insertHandler=variant.getInsertHandler();
  if (insertHandler != null && ret.getInsertHandler() == null) {
    ret.setInsertHandler(insertHandler);
    ret.setTailType(TailType.UNKNOWN);
  }
 else   if (tailType != TailType.NONE) {
    ret.setTailType(tailType);
  }
  final Map<Object,Object> itemProperties=variant.getItemProperties();
  for (  final Object key : itemProperties.keySet()) {
    ret.setAttribute(key,itemProperties.get(key));
  }
  set.add(ret);
}
