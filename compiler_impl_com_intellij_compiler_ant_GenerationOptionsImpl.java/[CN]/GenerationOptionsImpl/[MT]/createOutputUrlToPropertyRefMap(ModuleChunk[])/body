{
  final Map<String,String> map=new HashMap<String,String>();
  for (  final ModuleChunk chunk : chunks) {
    final String outputPathRef=BuildProperties.propertyRef(BuildProperties.getOutputPathProperty(chunk.getName()));
    final String testsOutputPathRef=BuildProperties.propertyRef(BuildProperties.getOutputPathForTestsProperty(chunk.getName()));
    final Module[] modules=chunk.getModules();
    for (    final Module module : modules) {
      final String outputPathUrl=CompilerModuleExtension.getInstance(module).getCompilerOutputUrl();
      if (outputPathUrl != null) {
        map.put(outputPathUrl,outputPathRef);
      }
      final String outputPathForTestsUrl=CompilerModuleExtension.getInstance(module).getCompilerOutputUrlForTests();
      if (outputPathForTestsUrl != null) {
        if (outputPathUrl == null || !outputPathForTestsUrl.equals(outputPathUrl)) {
          map.put(outputPathForTestsUrl,testsOutputPathRef);
        }
      }
    }
  }
  return map;
}
