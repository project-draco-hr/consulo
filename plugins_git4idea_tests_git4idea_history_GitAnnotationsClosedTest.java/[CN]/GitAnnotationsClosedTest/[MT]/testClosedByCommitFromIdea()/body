{
  annotateFirst(first);
  editFileInCommand(myProject,first,"1\n2+\n3-ttt\n");
  Assert.assertFalse(myFirstClosed);
  myVcsDirtyScopeManager.markEverythingDirty();
  myChangeListManager.ensureUpToDate(false);
  final Change change=myChangeListManager.getChange(first);
  Assert.assertNotNull(change);
  myVcs.getCheckinEnvironment().commit(Collections.singletonList(change),"***");
  myVcsDirtyScopeManager.fileDirty(first);
  myChangeListManager.ensureUpToDate(false);
  myChangeListManager.ensureUpToDate(false);
  sleep(100);
  Assert.assertTrue(myFirstClosed);
}
