{
  final PsiElement psiElement=reference.getElement();
  final Project project=psiElement.getProject();
  final JavaPsiFacade facade=JavaPsiFacade.getInstance(project);
  final ProjectFileIndex fileIndex=ProjectRootManager.getInstance(project).getFileIndex();
  for (  PsiClass aClass : classes) {
    if (!facade.getResolveHelper().isAccessible(aClass,psiElement,aClass))     continue;
    PsiFile psiFile=aClass.getContainingFile();
    if (psiFile == null)     continue;
    VirtualFile virtualFile=psiFile.getVirtualFile();
    if (virtualFile == null)     continue;
    final Module classModule=fileIndex.getModuleForFile(virtualFile);
    if (classModule != null && classModule != currentModule && !ModuleRootManager.getInstance(currentModule).isDependsOn(classModule)) {
      myModules.add(classModule);
    }
  }
  myCurrentModule=currentModule;
  myClassVFile=classVFile;
  myClasses=classes;
  myReference=reference;
}
