{
  return new FutureTask<Boolean>(new Callable<Boolean>(){
    @Override public Boolean call() throws Exception {
      Collection<TextRange> ranges=processChangedTextOnly ? FormatChangedTextUtil.getChangedTextRanges(myProject,file) : getRangesToFormat(file);
      RearrangeCommand rearranger=new RearrangeCommand(myProject,file,COMMAND_NAME,ranges);
      if (rearranger.couldRearrange()) {
        rearranger.run();
      }
      return true;
    }
  }
);
}
