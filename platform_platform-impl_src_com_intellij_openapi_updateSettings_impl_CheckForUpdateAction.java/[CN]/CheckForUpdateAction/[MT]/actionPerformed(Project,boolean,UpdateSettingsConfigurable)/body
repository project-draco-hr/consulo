{
  ProgressManager.getInstance().run(new Task.Backgroundable(project,"Checking for updates",false){
    @Override public void run(    @NotNull ProgressIndicator indicator){
      final CheckForUpdateResult result=UpdateChecker.checkForUpdates();
      final List<PluginDownloader> updatedPlugins=UpdateChecker.updatePlugins(true,settingsConfigurable);
      ApplicationManager.getApplication().invokeLater(new Runnable(){
        @Override public void run(){
          if (result.getState() == UpdateStrategy.State.CONNECTION_ERROR) {
            UpdateChecker.showConnectionErrorDialog();
            return;
          }
          if (result.hasNewBuildInSelectedChannel()) {
            UpdateSettings.getInstance().LAST_TIME_CHECKED=System.currentTimeMillis();
            UpdateChecker.showUpdateInfoDialog(enableLink,result.getUpdatedChannel(),updatedPlugins);
          }
 else {
            UpdateChecker.showNoUpdatesDialog(enableLink,updatedPlugins,true);
          }
        }
      }
);
    }
  }
);
}
