{
  final Runnable command=new Runnable(){
    public void run(){
      Document document=myEditor.getDocument();
      if (document.getMarkupModel(myProject) == null)       return;
      StringBuffer buffer=new StringBuffer();
      for (Iterator each=myLines.iterator(); each.hasNext(); ) {
        Line line=(Line)each.next();
        buffer.append(line.getValue());
      }
      int endBefore=document.getTextLength();
      int endBeforeLine=endBefore;
      document.insertString(endBefore,buffer.toString());
      for (Iterator each=myLines.iterator(); each.hasNext(); ) {
        Line line=(Line)each.next();
        myEditor.getMarkupModel().addRangeHighlighter(endBeforeLine,endBeforeLine + line.getValue().length(),HighlighterLayer.ADDITIONAL_SYNTAX,line.getAttributes(),HighlighterTargetArea.EXACT_RANGE);
        endBeforeLine+=line.getValue().length();
      }
      shiftCursorToTheEndOfDocument();
    }
  }
;
  return new Runnable(){
    public void run(){
      CommandProcessor.getInstance().executeCommand(myProject,command,"",null);
    }
  }
;
}
