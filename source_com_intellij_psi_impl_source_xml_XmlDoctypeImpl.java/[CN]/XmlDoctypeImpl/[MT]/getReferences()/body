{
  final XmlElement dtdUrlElement=getDtdUrlElement();
  final PsiElement docTypePublic=findChildByRoleAsPsiElement(ChildRole.XML_DOCTYPE_PUBLIC);
  PsiReference uriRefs[]=null;
  if (dtdUrlElement != null) {
    final String uri=extractValue(dtdUrlElement);
    uriRefs=new PsiReference[1];
    uriRefs[0]=new PsiReference(){
      public PsiElement getElement(){
        return XmlDoctypeImpl.this;
      }
      public TextRange getRangeInElement(){
        return new TextRange(dtdUrlElement.getTextRange().getStartOffset() - getTextRange().getStartOffset() + 1,dtdUrlElement.getTextRange().getEndOffset() - getTextRange().getStartOffset() - 1);
      }
      public PsiElement resolve(){
        return XmlUtil.findXmlFile(XmlUtil.getContainingFile(XmlDoctypeImpl.this),uri);
      }
      public String getCanonicalText(){
        return uri;
      }
      public PsiElement handleElementRename(      String newElementName) throws IncorrectOperationException {
        throw new IncorrectOperationException();
      }
      public PsiElement bindToElement(      PsiElement element) throws IncorrectOperationException {
        throw new IncorrectOperationException();
      }
      public boolean isReferenceTo(      PsiElement element){
        return element == dtdUrlElement;
      }
      public Object[] getVariants(){
        final URIReferenceProvider uriReferenceProvider=((URIReferenceProvider)ReferenceProvidersRegistry.getInstance(getProject()).getProviderByType(ReferenceProvidersRegistry.URI_PROVIDER));
        final PsiReference[] referencesByElement=(docTypePublic != null) ? uriReferenceProvider.getUrlReference(dtdUrlElement) : PsiReference.EMPTY_ARRAY;
        if (referencesByElement.length > 0)         return referencesByElement[0].getVariants();
        return null;
      }
      public boolean isSoft(){
        return false;
      }
    }
;
  }
  final PsiReference[] referencesFromProviders=ResolveUtil.getReferencesFromProviders(this);
  return ArrayUtil.mergeArrays(uriRefs != null ? uriRefs : PsiReference.EMPTY_ARRAY,referencesFromProviders,PsiReference.class);
}
