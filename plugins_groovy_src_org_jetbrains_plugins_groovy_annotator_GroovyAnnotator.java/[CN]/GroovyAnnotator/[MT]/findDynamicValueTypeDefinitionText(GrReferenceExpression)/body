{
  String dynamicValueTypeDefinitionText=null;
  if (refExpr.isQualified()) {
    GrExpression qualifier=refExpr.getQualifierExpression();
    PsiType type=qualifier.getType();
    if (type != null) {
      dynamicValueTypeDefinitionText=type.getCanonicalText();
    }
  }
 else {
    PsiElement refParent=refExpr.getParent();
    while (refParent != null && !(refParent instanceof GroovyFileBase)) {
      refParent=refParent.getParent();
    }
    if (refParent == null)     return null;
    PsiClass scriptClass=((GroovyFileBase)refParent).getScriptClass();
    if (scriptClass != null) {
      dynamicValueTypeDefinitionText=scriptClass.getQualifiedName();
    }
  }
  return dynamicValueTypeDefinitionText;
}
