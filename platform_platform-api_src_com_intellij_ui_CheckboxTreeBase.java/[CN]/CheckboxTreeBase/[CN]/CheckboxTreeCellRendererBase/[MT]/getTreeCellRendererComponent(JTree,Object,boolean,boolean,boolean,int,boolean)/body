{
  invalidate();
  if (value instanceof CheckedTreeNode) {
    CheckedTreeNode node=(CheckedTreeNode)value;
    NodeState state=getNodeStatus(node);
    myCheckbox.setVisible(true);
    myCheckbox.setSelected(state != NodeState.CLEAR);
    myCheckbox.setEnabled(node.isEnabled() && state != NodeState.PARTIAL);
    myCheckbox.setBackground(null);
    setBackground(null);
  }
 else {
    myCheckbox.setVisible(false);
  }
  myTextRenderer.getTreeCellRendererComponent(tree,value,selected,expanded,leaf,row,hasFocus);
  if (UIUtil.isUnderGTKLookAndFeel()) {
    final Color background=selected ? UIUtil.getTreeSelectionBackground() : UIUtil.getTreeTextBackground();
    UIUtil.changeBackGround(this,background);
  }
 else   if (UIUtil.isUnderNimbusLookAndFeel()) {
    UIUtil.changeBackGround(this,UIUtil.TRANSPARENT_COLOR);
  }
  customizeRenderer(tree,value,selected,expanded,leaf,row,hasFocus);
  revalidate();
  return this;
}
