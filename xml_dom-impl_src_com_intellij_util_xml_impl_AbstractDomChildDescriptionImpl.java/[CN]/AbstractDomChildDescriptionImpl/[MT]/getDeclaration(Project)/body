{
  final DomAnchor anchor=getUserData(DomExtension.KEY_DECLARATION);
  if (anchor != null) {
    final DomElement declaration=anchor.retrieveDomElement();
    if (declaration != null) {
      final DomTarget target=DomTarget.getTarget(declaration);
      if (target != null) {
        return PomService.convertToPsi(target);
      }
      return declaration.getXmlElement();
    }
    return anchor.getContainingFile();
  }
  final SmartPsiElementPointer<?> pointer=getUserData(DomExtensionImpl.DECLARING_ELEMENT_KEY);
  if (pointer != null) {
    final PsiElement element=pointer.getElement();
    if (element != null) {
      return element;
    }
  }
  return PomService.convertToPsi(project,this);
}
