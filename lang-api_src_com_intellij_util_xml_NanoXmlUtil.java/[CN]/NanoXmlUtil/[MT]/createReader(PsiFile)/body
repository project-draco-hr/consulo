{
  final VirtualFile virtualFile=psiFile.getVirtualFile();
  if (virtualFile == null) {
    return new MyXMLReader(new StringReader(psiFile.getText()));
  }
  final Document document=FileDocumentManager.getInstance().getCachedDocument(virtualFile);
  if (document != null) {
    return new MyXMLReader(new CharSequenceReader(document.getCharsSequence()));
  }
 else {
    return new MyXMLReader(virtualFile.getInputStream());
  }
}
