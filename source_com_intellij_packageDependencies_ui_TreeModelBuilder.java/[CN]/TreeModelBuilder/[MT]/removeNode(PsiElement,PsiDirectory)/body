{
  boolean isMarked=false;
  if (element instanceof PsiFile) {
    isMarked=myMarker.isMarked((PsiFile)element);
  }
 else   if (element instanceof PsiDirectory) {
    final PsiDirectory psiDirectory=(PsiDirectory)element;
    final PsiFile[] psiFiles=psiDirectory.getFiles();
    for (    PsiFile psiFile : psiFiles) {
      isMarked|=myMarker.isMarked(psiFile);
    }
  }
  if (!isMarked)   return null;
  final PackageDependenciesNode dirNode=getModuleDirNode(parent,myFileIndex.getModuleForFile(parent.getVirtualFile()),ScopeType.SOURCE,null);
  if (dirNode != null) {
    final PackageDependenciesNode fileNode=findNodeForPsiElement(dirNode,element);
    if (fileNode != null) {
      dirNode.remove(fileNode);
    }
  }
  return dirNode;
}
