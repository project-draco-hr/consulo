{
  VirtualFile virtualFile=myElementInfo.getVirtualFile();
  if (virtualFile != null && virtualFile.isValid()) {
    PsiFile psiFile=PsiManager.getInstance(getProject()).findFile(virtualFile);
    if (psiFile != null)     return psiFile;
  }
  final Document doc=myElementInfo.getDocumentToSynchronize();
  if (doc == null) {
    final E resolved=getElement();
    return resolved != null ? resolved.getContainingFile() : null;
  }
  return PsiDocumentManager.getInstance(getProject()).getPsiFile(doc);
}
