{
  context.getLoggingManager().getArtifactBuilderLogger().fileCopied(filePath);
  processEntries(new EntryProcessor(){
    @Override public void process(    @Nullable InputStream inputStream,    @NotNull String relativePath) throws IOException {
      final String fullOutputPath=FileUtil.toSystemDependentName(PathUtil.appendToPath(outputPath,relativePath));
      final File outputFile=new File(fullOutputPath);
      FileUtil.createParentDirs(outputFile);
      if (inputStream == null) {
        outputFile.mkdir();
      }
 else {
        String fullSourcePath=filePath + JarPathUtil.JAR_SEPARATOR + relativePath;
        if (outSrcMapping.getState(fullOutputPath) == null) {
          final BufferedInputStream from=new BufferedInputStream(inputStream);
          final BufferedOutputStream to=new BufferedOutputStream(new FileOutputStream(outputFile));
          try {
            FileUtil.copy(from,to);
          }
  finally {
            from.close();
            to.close();
          }
          srcOutMapping.appendData(filePath,Collections.singletonList(fullOutputPath));
        }
        outSrcMapping.appendData(fullOutputPath,Collections.singletonList(new ArtifactOutputToSourceMapping.SourcePathAndRootIndex(fullSourcePath,rootIndex)));
      }
    }
  }
);
}
