{
  final VirtualFile[] files=FileChooser.chooseFiles(e.getData(PlatformDataKeys.PROJECT),FileChooserDescriptorFactory.createSingleFolderDescriptor());
  if (files.length > 0) {
    final List<IntentionActionMetaData> list=IntentionManagerSettings.getInstance().getMetaData();
    final File root=VfsUtil.virtualToIoFile(files[0]);
    Element el=new Element("root");
    Map<String,Element> categoryMap=new HashMap<String,Element>();
    for (    IntentionActionMetaData metaData : list) {
      try {
        Element metadataElement=new Element("intention");
        metadataElement.setAttribute("family",metaData.getFamily());
        metadataElement.setAttribute("description",metaData.getDescription().getText());
        String key=StringUtil.join(metaData.myCategory,".");
        Element element=getCategoryElement(categoryMap,el,metaData,key,metaData.myCategory.length - 1);
        element.addContent(metadataElement);
      }
 catch (      IOException e1) {
        e1.printStackTrace();
      }
    }
    try {
      JDOMUtil.writeDocument(new Document(el),new File(root,"intentions.xml"),"\n");
    }
 catch (    IOException e1) {
      e1.printStackTrace();
    }
  }
}
