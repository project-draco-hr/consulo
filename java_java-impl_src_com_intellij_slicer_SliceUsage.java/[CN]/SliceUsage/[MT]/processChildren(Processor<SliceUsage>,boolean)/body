{
  final PsiElement element=getElement();
  ProgressIndicator indicator=ProgressManager.getInstance().getProgressIndicator();
  indicator.checkCanceled();
  final Processor<SliceUsage> uniqueProcessor=new CommonProcessors.UniqueProcessor<SliceUsage>(processor,new TObjectHashingStrategy<SliceUsage>(){
    public int computeHashCode(    final SliceUsage object){
      return object.getUsageInfo().hashCode();
    }
    public boolean equals(    final SliceUsage o1,    final SliceUsage o2){
      return o1.getUsageInfo().equals(o2.getUsageInfo());
    }
  }
);
  ApplicationManager.getApplication().runReadAction(new Runnable(){
    public void run(){
      if (dataFlowToThis) {
        SliceUtil.processUsagesFlownDownTo(element,uniqueProcessor,SliceUsage.this,mySubstitutor);
      }
 else {
        SliceFUtil.processUsagesFlownFromThe(element,uniqueProcessor,SliceUsage.this);
      }
    }
  }
);
}
