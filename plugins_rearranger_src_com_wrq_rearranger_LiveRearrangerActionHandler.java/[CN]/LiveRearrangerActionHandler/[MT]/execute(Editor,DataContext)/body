{
  if (editor == null) {
    return;
  }
  final Project project=(Project)context.getData(DataConstants.PROJECT);
  LOG.debug("project=" + project);
  LOG.debug("editor=" + editor);
  final Document document=editor.getDocument();
  final CaretModel caret=editor.getCaretModel();
  int cursorOffset=caret.getOffset();
  final PsiFile psiFile=getFile(editor,context);
  if (!psiFile.getName().endsWith(".java")) {
    LOG.debug("not a .java file -- skipping " + psiFile.getName());
    return;
  }
  if (!RearrangerActionHandler.isFileWritable(psiFile)) {
    LOG.debug("not a writable .java file -- skipping " + psiFile.getName());
    return;
  }
  LOG.debug("inProgress=" + inProgress);
  if (!useDialog) {
    if (inProgress) {
      return;
    }
    setInProgress(true);
  }
  buildLiveRearrangerData(project,document,psiFile,cursorOffset);
}
