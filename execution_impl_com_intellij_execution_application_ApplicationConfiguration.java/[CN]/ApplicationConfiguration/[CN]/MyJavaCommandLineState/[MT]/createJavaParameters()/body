{
  final JavaParameters params=new JavaParameters();
  JavaParametersUtil.configureModule(getConfigurationModule(),params,JavaParameters.JDK_AND_CLASSES_AND_TESTS,ALTERNATIVE_JRE_PATH_ENABLED ? ALTERNATIVE_JRE_PATH : null);
  JavaParametersUtil.configureConfiguration(params,ApplicationConfiguration.this);
  params.setMainClass(MAIN_CLASS_NAME);
  for (  RunConfigurationExtension ext : Extensions.getExtensions(RunConfigurationExtension.EP_NAME)) {
    ext.updateJavaParameters(ApplicationConfiguration.this,params);
  }
  if (isCoverageEnabled()) {
    final String coverageFileName=getCoverageFilePath();
    final long lastCoverageTime=System.currentTimeMillis();
    String name=getName();
    if (name == null)     name=getGeneratedName();
    final CoverageDataManager coverageDataManager=CoverageDataManager.getInstance(getProject());
    myCurrentCoverageSuite=coverageDataManager.addCoverageSuite(name,new DefaultCoverageFileProvider(coverageFileName),getCoveragePatterns(),lastCoverageTime,!isMergeWithPreviousResults());
    ApplicationConfiguration.this.appendCoverageArgument(params);
  }
  return params;
}
