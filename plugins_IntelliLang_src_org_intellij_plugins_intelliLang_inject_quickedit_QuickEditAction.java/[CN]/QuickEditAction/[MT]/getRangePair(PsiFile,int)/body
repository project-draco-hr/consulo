{
  final PsiLanguageInjectionHost host=PsiTreeUtil.getParentOfType(file.findElementAt(offset),PsiLanguageInjectionHost.class,false);
  if (host == null)   return null;
  final List<Pair<PsiElement,TextRange>> injections=InjectedLanguageUtil.getInjectedPsiFiles(host);
  if (injections == null || injections.isEmpty())   return null;
  final int offsetInElement=offset - host.getTextRange().getStartOffset();
  return ContainerUtil.find(injections,new Condition<Pair<PsiElement,TextRange>>(){
    public boolean value(    final Pair<PsiElement,TextRange> pair){
      return pair.second.contains(offsetInElement);
    }
  }
);
}
