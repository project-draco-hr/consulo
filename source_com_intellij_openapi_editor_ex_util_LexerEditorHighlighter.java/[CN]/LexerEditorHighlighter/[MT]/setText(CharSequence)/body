{
  int startOffset=0;
  char[] chars=CharArrayUtil.fromSequence(text);
  myLexer.start(chars,startOffset,text.length());
  int i=0;
  mySegments.removeAll();
  while (myLexer.getTokenType() != null) {
    int data=packData(myLexer.getTokenType(),myLexer.getState());
    mySegments.setElementAt(i,myLexer.getTokenStart(),myLexer.getTokenEnd(),data);
    i++;
    myLexer.advance();
  }
  checkUpdateCorrect(text.length());
  if (myEditor != null) {
    ((EditorEx)myEditor).repaint(0,text.length());
  }
}
