{
  f1=new TestVirtualFile("allowed",null,-1);
  f2=new TestVirtualFile("filtered",null,-1);
  expect(tm.isFileIgnored("allowed")).andReturn(false);
  expect(tm.isFileIgnored("filtered")).andReturn(true);
  expect(tm.getFileTypeByFile((VirtualFile)anyObject())).andStubReturn(nonBinary);
  replay(tm);
  FileFilter f=new FileFilter(fi,tm);
  assertTrue(f.isAllowed(f1));
  assertFalse(f.isAllowed(f2));
}
