{
  Set<Object> variants=new THashSet<Object>();
  List<PropertiesFile> propertiesFileList=getPropertiesFiles();
  if (propertiesFileList == null) {
    PsiManager psiManager=myElement.getManager();
    ProjectFileIndex fileIndex=ProjectRootManager.getInstance(psiManager.getProject()).getFileIndex();
    for (    VirtualFile file : PropertiesFilesManager.getInstance().getAllPropertiesFiles()) {
      if (!file.isValid())       continue;
      if (!fileIndex.isInContent(file))       continue;
      PsiFile psiFile=psiManager.findFile(file);
      if (!(psiFile instanceof PropertiesFile))       continue;
      PropertiesFile propertiesFile=(PropertiesFile)psiFile;
      addVariantsFromFile(propertiesFile,variants);
    }
  }
 else {
    for (    PropertiesFile propFile : propertiesFileList) {
      addVariantsFromFile(propFile,variants);
    }
  }
  return variants.toArray(new Object[variants.size()]);
}
