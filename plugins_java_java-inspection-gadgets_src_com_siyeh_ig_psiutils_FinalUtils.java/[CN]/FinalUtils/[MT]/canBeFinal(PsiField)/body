{
  PsiClass containingClass=field.getContainingClass();
  if (containingClass == null) {
    return false;
  }
  final boolean fieldIsStatic=field.hasModifierProperty(PsiModifier.STATIC);
  final PsiField[] fields=containingClass.getFields();
  final DefiniteAssignmentVisitor visitor=new DefiniteAssignmentVisitor(field);
  if (field.hasInitializer()) {
    visitor.setDefiniteAssignment(true,false);
  }
  for (  PsiField aField : fields) {
    final PsiExpression initializer=aField.getInitializer();
    if (initializer != null) {
      initializer.accept(visitor);
      if (!visitor.isFinalCandidate()) {
        return false;
      }
    }
  }
  final PsiClassInitializer[] initializers=containingClass.getInitializers();
  for (  PsiClassInitializer initializer : initializers) {
    initializer.accept(visitor);
    if (!visitor.isFinalCandidate()) {
      return false;
    }
  }
  if (!fieldIsStatic) {
    final boolean da=visitor.isDefinitelyAssigned();
    final boolean du=visitor.isDefinitelyUnassigned();
    final PsiMethod[] constructors=containingClass.getConstructors();
    for (    PsiMethod constructor : constructors) {
      final PsiCodeBlock body=constructor.getBody();
      if (body != null) {
        visitor.setDefiniteAssignment(da,du);
        body.accept(visitor);
      }
      if (!visitor.isDefinitelyAssigned()) {
        return false;
      }
      if (!visitor.isFinalCandidate()) {
        return false;
      }
    }
  }
  if (!visitor.isDefinitelyAssigned()) {
    return false;
  }
  if (!visitor.isFinalCandidate()) {
    return false;
  }
  checkMembers(fieldIsStatic,containingClass,null,visitor);
  if (!visitor.isFinalCandidate()) {
    return false;
  }
  PsiClass aClass=containingClass.getContainingClass();
  while (aClass != null) {
    visitor.setSkipClass(containingClass);
    aClass.accept(visitor);
    if (!visitor.isFinalCandidate()) {
      return false;
    }
    containingClass=aClass;
    aClass=containingClass.getContainingClass();
  }
  return true;
}
