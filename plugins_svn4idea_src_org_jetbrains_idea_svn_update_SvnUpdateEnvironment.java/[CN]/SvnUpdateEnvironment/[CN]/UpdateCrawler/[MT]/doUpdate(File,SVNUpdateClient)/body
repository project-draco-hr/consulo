{
  final long rev;
  final SvnConfiguration configuration=SvnConfiguration.getInstance(myVcs.getProject());
  final UpdateRootInfo rootInfo=configuration.getUpdateRootInfo(root,myVcs);
  if (rootInfo != null) {
    final SVNURL url=rootInfo.getUrl();
    if (url != null && url.equals(getSourceUrl(root))) {
      if (rootInfo.isUpdateToRevision()) {
        rev=client.doUpdate(root,rootInfo.getRevision(),configuration.UPDATE_RECURSIVELY);
      }
 else {
        rev=client.doUpdate(root,SVNRevision.HEAD,configuration.UPDATE_RECURSIVELY);
      }
    }
 else     if (url != null) {
      rev=client.doSwitch(root,url,rootInfo.getRevision(),configuration.UPDATE_RECURSIVELY);
    }
 else {
      rev=client.doUpdate(root,SVNRevision.HEAD,configuration.UPDATE_RECURSIVELY);
    }
  }
 else {
    rev=client.doUpdate(root,SVNRevision.HEAD,configuration.UPDATE_RECURSIVELY);
  }
  return rev;
}
