{
  final String name=settings.getName();
  final PsiType type=settings.getSelectedType();
  final String modifier=settings.getVisibilityModifier();
  final GrExpression initializer;
  if (settings.initializeIn() == FIELD_DECLARATION) {
    if (settings.removeLocalVar()) {
      initializer=extractVarInitializer(context);
    }
 else {
      initializer=context.getExpression();
    }
  }
 else {
    initializer=null;
  }
  final GrVariableDeclaration fieldDeclaration=GroovyPsiElementFactory.getInstance(context.getProject()).createFieldDeclaration(EMPTY_STRING_ARRAY,name,initializer,type);
  fieldDeclaration.getModifierList().setModifierProperty(modifier,true);
  if (settings.isStatic()) {
    fieldDeclaration.getModifierList().setModifierProperty(PsiModifier.STATIC,true);
  }
  if (settings.declareFinal()) {
    fieldDeclaration.getModifierList().setModifierProperty(PsiModifier.FINAL,true);
  }
  return fieldDeclaration;
}
