{
  if (!element.isWritable()) {
    if (element instanceof PsiDirectory) {
      throw new IncorrectOperationException(PsiBundle.message("cannot.modify.a.read.only.directory",((PsiDirectory)element).getVirtualFile().getPresentableUrl()));
    }
 else {
      PsiFile file=element.getContainingFile();
      if (file == null) {
        throw new IncorrectOperationException();
      }
      final VirtualFile virtualFile=file.getVirtualFile();
      if (virtualFile == null) {
        throw new IncorrectOperationException();
      }
      throw new IncorrectOperationException(PsiBundle.message("cannot.modify.a.read.only.file",virtualFile.getPresentableUrl()));
    }
  }
}
