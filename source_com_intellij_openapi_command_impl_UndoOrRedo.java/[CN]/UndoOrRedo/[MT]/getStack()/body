{
  if (myEditor == null) {
    return getStackHolder().getGlobalStack();
  }
 else {
    long recentDocumentTimeStamp=-1;
    LinkedList<UndoableGroup> result=null;
    Document[] documents=TextEditorProvider.getDocuments(myEditor);
    for (int i=0; i < documents.length; i++) {
      Document document=documents[i];
      LinkedList<UndoableGroup> stack=getStackHolder().getStack(document);
      if (!stack.isEmpty()) {
        long modificationStamp=document.getModificationStamp();
        if (recentDocumentTimeStamp < modificationStamp) {
          result=stack;
          recentDocumentTimeStamp=modificationStamp;
        }
      }
    }
    if (result != null) {
      return result;
    }
 else {
      throw new RuntimeException("Cannot find stack");
    }
  }
}
