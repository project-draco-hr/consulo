{
  if (!(psiElement instanceof PsiForStatement)) {
    return false;
  }
  PsiForStatement forStatement=(PsiForStatement)psiElement;
  final PsiExpression condition=forStatement.getCondition();
  if (forStatement.getUpdate() != null || condition == null) {
    return false;
  }
  final TextRange range=condition.getTextRange();
  final Document document=editor.getDocument();
  final CharSequence text=document.getCharsSequence();
  for (int i=range.getEndOffset() - 1, max=forStatement.getTextRange().getEndOffset(); i < max; i++) {
    if (text.charAt(i) == ';') {
      return false;
    }
  }
  String toInsert=";";
  final Project project=editor.getProject();
  if (project != null && CodeStyleSettingsManager.getSettings(project).SPACE_AFTER_SEMICOLON) {
    toInsert+=" ";
  }
  document.insertString(range.getEndOffset(),toInsert);
  return true;
}
