{
  int targetOffset=Math.min(offset,myTextComponent.getText().length());
  int currentPosition=myTextComponent.getCaretPosition();
  if (targetOffset != currentPosition) {
    if (targetOffset == myTextComponent.getCaret().getMark()) {
      myTextComponent.setCaretPosition(currentPosition);
      myTextComponent.moveCaretPosition(targetOffset);
    }
 else {
      myTextComponent.setCaretPosition(targetOffset);
    }
  }
}
