{
  final DataContext dataContext=event.getDataContext();
  final HierarchyBrowserBaseEx browser=(HierarchyBrowserBaseEx)dataContext.getData(myBrowserDataKey);
  if (browser == null)   return;
  final PsiElement selectedElement=browser.getSelectedElement();
  if (selectedElement == null || !browser.isApplicableElement(selectedElement))   return;
  final String currentViewType=browser.myCurrentViewType;
  Disposer.dispose(browser);
  browser.setHierarchyBase(selectedElement);
  browser.validate();
  ApplicationManager.getApplication().invokeLater(new Runnable(){
    @Override public void run(){
      browser.changeView(correctViewType(browser,currentViewType));
    }
  }
);
}
