{
  final DataContext dataContext=event.getDataContext();
  final HierarchyBrowserBaseEx browser=(HierarchyBrowserBaseEx)dataContext.getData(myBrowserDataKey);
  if (browser == null)   return;
  final PsiElement selectedElement=browser.getSelectedElement();
  if (selectedElement == null || !browser.isApplicableElement(selectedElement))   return;
  final String currentViewType=browser.myCurrentViewType;
  Disposer.dispose(browser);
  final HierarchyProvider provider=BrowseHierarchyActionBase.findProvider(myProviderLanguageExtension,selectedElement,selectedElement.getContainingFile(),event.getDataContext());
  final HierarchyBrowser newBrowser=BrowseHierarchyActionBase.createAndAddToPanel(selectedElement.getProject(),provider,selectedElement);
  ApplicationManager.getApplication().invokeLater(new Runnable(){
    @Override public void run(){
      ((HierarchyBrowserBaseEx)newBrowser).changeView(correctViewType(browser,currentViewType));
    }
  }
);
}
