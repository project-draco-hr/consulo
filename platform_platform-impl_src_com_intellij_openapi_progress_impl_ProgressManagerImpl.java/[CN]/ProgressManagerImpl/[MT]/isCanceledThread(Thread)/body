{
  try {
    Field th=Thread.class.getDeclaredField("threadLocals");
    th.setAccessible(true);
    Object tLocalMap=th.get(thread);
    if (tLocalMap == null)     return null;
    Method getEntry=tLocalMap.getClass().getDeclaredMethod("getEntry",ThreadLocal.class);
    getEntry.setAccessible(true);
    Object entry=getEntry.invoke(tLocalMap,myThreadIndicator);
    if (entry == null)     return null;
    Field value=entry.getClass().getDeclaredField("value");
    value.setAccessible(true);
    ProgressIndicator indicator=(ProgressIndicator)value.get(entry);
    if (indicator == null)     return null;
    return String.valueOf(indicator.isCanceled());
  }
 catch (  Exception e) {
    throw new RuntimeException(e);
  }
}
