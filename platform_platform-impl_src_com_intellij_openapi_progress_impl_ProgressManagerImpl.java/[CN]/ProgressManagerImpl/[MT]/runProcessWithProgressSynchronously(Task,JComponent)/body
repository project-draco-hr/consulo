{
  final long start=System.currentTimeMillis();
  final boolean result=((ApplicationEx)ApplicationManager.getApplication()).runProcessWithProgressSynchronously(new TaskContainer(task){
    @Override public void run(){
      new TaskRunnable(task,ProgressManager.getInstance().getProgressIndicator()).run();
    }
  }
,task.getTitle(),task.isCancellable(),task.getProject(),parentComponent,task.getCancelText());
  if (result) {
    final long end=System.currentTimeMillis();
    final Task.NotificationInfo notificationInfo=task.notifyFinished();
    long time=end - start;
    if (notificationInfo != null && time > 5000) {
      final JFrame frame=WindowManager.getInstance().getFrame(task.getProject());
      if (!frame.hasFocus()) {
        systemNotify(notificationInfo);
      }
    }
    task.onSuccess();
  }
 else {
    task.onCancel();
  }
  return result;
}
