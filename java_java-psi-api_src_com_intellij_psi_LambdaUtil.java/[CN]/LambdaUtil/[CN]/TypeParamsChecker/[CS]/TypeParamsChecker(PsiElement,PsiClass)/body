{
  myClass=aClass;
  PsiElement parent=expression != null ? expression.getParent() : null;
  while (parent instanceof PsiParenthesizedExpression) {
    parent=parent.getParent();
  }
  if (parent instanceof PsiExpressionList) {
    final PsiElement gParent=parent.getParent();
    if (gParent instanceof PsiCall) {
      final Map<PsiElement,Pair<PsiMethod,PsiSubstitutor>> map=MethodCandidateInfo.CURRENT_CANDIDATE.get();
      if (map != null) {
        final Pair<PsiMethod,PsiSubstitutor> pair=map.get(parent);
        myMethod=pair != null ? pair.first : null;
      }
 else {
        myMethod=null;
      }
      if (myMethod == null) {
        myMethod=((PsiCall)gParent).resolveMethod();
      }
      if (myMethod != null && PsiTreeUtil.isAncestor(myMethod,expression,false)) {
        myMethod=null;
      }
    }
  }
}
