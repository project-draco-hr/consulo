{
  final boolean[] result=new boolean[1];
  try {
    ProgressManager.getInstance().runProcessWithProgressSynchronously(new Runnable(){
      public void run(){
        ProgressIndicator pi=ProgressManager.getInstance().getProgressIndicator();
        pi.setText(pluginNode.getName());
        try {
          result[0]=PluginInstaller.prepareToInstall(pluginNode);
        }
 catch (        ZipException e) {
          ApplicationManager.getApplication().invokeLater(new Runnable(){
            public void run(){
              Messages.showErrorDialog(IdeBundle.message("error.plugin.zip.problems",pluginNode.getName()),IdeBundle.message("title.installing.plugin"));
            }
          }
);
        }
catch (        IOException e) {
          throw new RuntimeException(e);
        }
      }
    }
,IdeBundle.message("progress.download.plugin",pluginNode.getName()),true,null);
  }
 catch (  RuntimeException e) {
    if (e.getCause() != null && e.getCause() instanceof IOException)     throw (IOException)e.getCause();
 else     throw e;
  }
  return result[0];
}
