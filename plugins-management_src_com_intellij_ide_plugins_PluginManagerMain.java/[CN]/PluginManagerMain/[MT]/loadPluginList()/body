{
  StatusProcess statusProcess=new StatusProcess();
  do {
    boolean canceled=ApplicationManager.getApplication().runProcessWithProgressSynchronously(statusProcess,IdeBundle.message("progress.downloading.list.of.plugins"),true,null);
    if (canceled && statusProcess.getException() != null) {
      if (statusProcess.getException() instanceof IOException) {
        if (!IOExceptionDialog.showErrorDialog((IOException)statusProcess.getException(),IdeBundle.message("title.plugin.manager"),IdeBundle.message("error.could.not.download.list.of.plugins"))) {
          break;
        }
      }
 else       throw new RuntimeException(statusProcess.getException());
    }
 else {
      break;
    }
    statusProcess.removeOldException();
  }
 while (true);
  return statusProcess.getRoot();
}
