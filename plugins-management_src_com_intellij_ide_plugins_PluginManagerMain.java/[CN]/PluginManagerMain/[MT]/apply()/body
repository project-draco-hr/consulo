{
  setRequireShutdown(true);
  for (int i=0; i < installedPluginTable.getRowCount(); i++) {
    final IdeaPluginDescriptorImpl pluginDescriptor=(IdeaPluginDescriptorImpl)installedPluginsModel.getObjectAt(i);
    pluginDescriptor.setEnabled(((Boolean)installedPluginsModel.getValueAt(i,InstalledPluginsTableModel.getCheckboxColumn())).booleanValue());
  }
  try {
    final ArrayList<String> ids=new ArrayList<String>();
    for (int i=0; i < installedPluginTable.getRowCount(); i++) {
      final IdeaPluginDescriptorImpl pluginDescriptor=(IdeaPluginDescriptorImpl)installedPluginsModel.getObjectAt(i);
      if (!pluginDescriptor.isEnabled()) {
        ids.add(pluginDescriptor.getPluginId().getIdString());
      }
    }
    PluginManager.saveDisabledPlugins(ids,false);
  }
 catch (  IOException e) {
    LOG.error(e);
  }
}
