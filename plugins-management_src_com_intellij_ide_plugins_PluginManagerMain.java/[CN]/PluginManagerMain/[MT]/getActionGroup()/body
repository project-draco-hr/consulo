{
  if (actionGroup == null) {
    actionGroup=new DefaultActionGroup();
    final String installTitle=IdeBundle.message("action.download.and.install.plugin");
    final String updateMessage=IdeBundle.message("action.update.plugin");
    AnAction installPluginAction=new AnAction(installTitle,installTitle,IconLoader.getIcon("/actions/install.png")){
      public void update(      AnActionEvent e){
        Presentation presentation=e.getPresentation();
        boolean enabled=false;
        Object pluginObject=pluginTable.getSelectedObject();
        if (pluginObject instanceof PluginNode) {
          int status=PluginManagerColumnInfo.getRealNodeState((PluginNode)pluginObject);
          enabled=(status != PluginNode.STATUS_DOWNLOADED);
          presentation.setText(installTitle);
        }
 else         if (pluginObject instanceof IdeaPluginDescriptorImpl) {
          presentation.setText(updateMessage);
          presentation.setDescription(updateMessage);
          PluginId id=((IdeaPluginDescriptorImpl)pluginObject).getPluginId();
          enabled=PluginsTableModel.hasNewerVersion(id);
        }
        presentation.setEnabled(enabled);
      }
      public void actionPerformed(      AnActionEvent e){
        do {
          try {
            final Object selectedObject=pluginTable.getSelectedObject();
            final boolean isUpdate=(selectedObject instanceof IdeaPluginDescriptorImpl);
            PluginNode pluginNode=null;
            if (selectedObject instanceof PluginNode) {
              pluginNode=(PluginNode)selectedObject;
            }
 else             if (selectedObject instanceof IdeaPluginDescriptorImpl) {
              final IdeaPluginDescriptor pluginDescriptor=(IdeaPluginDescriptor)selectedObject;
              pluginNode=new PluginNode(pluginDescriptor.getPluginId());
              pluginNode.setName(pluginDescriptor.getName());
              pluginNode.setDepends(Arrays.asList(pluginDescriptor.getDependentPluginIds()));
              pluginNode.setSize("-1");
            }
            final String message=isUpdate ? updateMessage : installTitle;
            if (Messages.showYesNoDialog(main,(isUpdate ? IdeBundle.message("prompt.update.plugin",pluginNode.getName()) : IdeBundle.message("prompt.download.and.install.plugin",pluginNode.getName())),message,Messages.getQuestionIcon()) == 0) {
              if (downloadPlugin(pluginNode)) {
                requireShutdown=true;
                pluginTable.updateUI();
              }
            }
            break;
          }
 catch (          IOException e1) {
            if (!IOExceptionDialog.showErrorDialog(e1,installTitle,IdeBundle.message("error.plugin.download.failed"))) {
              break;
            }
 else {
              LOG.error(e1);
            }
          }
        }
 while (true);
      }
    }
;
    actionGroup.add(installPluginAction);
    AnAction uninstallPluginAction=new AnAction(IdeBundle.message("action.uninstall.plugin"),IdeBundle.message("action.uninstall.plugin"),IconLoader.getIcon("/actions/uninstall.png")){
      public void update(      AnActionEvent e){
        Presentation presentation=e.getPresentation();
        Object descr=pluginTable.getSelectedObject();
        boolean enabled=(descr instanceof IdeaPluginDescriptorImpl) && !((IdeaPluginDescriptorImpl)descr).isDeleted();
        presentation.setEnabled(enabled);
      }
      public void actionPerformed(      AnActionEvent e){
        String message;
        IdeaPluginDescriptorImpl pluginDescriptor=(IdeaPluginDescriptorImpl)pluginTable.getSelectedObject();
        ArrayList<IdeaPluginDescriptorImpl> dependant=genericModel.dependent(pluginDescriptor);
        if (dependant.size() == 0)         message=IdeBundle.message("prompt.uninstall.plugin",pluginDescriptor.getName());
 else         message=MessageFormat.format(IdeBundle.message("several.plugins.depend.on.0.continue.to.remove"),pluginDescriptor.getName());
        if (Messages.showYesNoDialog(main,message,IdeBundle.message("title.plugin.uninstall"),Messages.getQuestionIcon()) == 0) {
          PluginId pluginId=pluginDescriptor.getPluginId();
          pluginDescriptor.setDeleted(true);
          try {
            PluginInstaller.prepareToUninstall(pluginId);
            requireShutdown=true;
            pluginTable.updateUI();
          }
 catch (          IOException e1) {
            LOG.equals(e1);
          }
        }
      }
    }
;
    actionGroup.add(uninstallPluginAction);
  }
  return actionGroup;
}
