{
  if (nameSuggestionContext != null && nameSuggestionContext.getContainingFile() != elementToRename.getContainingFile())   return false;
  if (!(elementToRename instanceof PsiLocalVariable) && !(elementToRename instanceof PsiParameter)) {
    return false;
  }
  SearchScope useScope=PsiSearchHelper.SERVICE.getInstance(elementToRename.getProject()).getUseScope(elementToRename);
  if (!(useScope instanceof LocalSearchScope))   return false;
  PsiElement[] scopeElements=((LocalSearchScope)useScope).getScope();
  if (scopeElements.length > 1 && !isElementWithComment(scopeElements) && !isResourceVariable(scopeElements)) {
    return false;
  }
  PsiFile containingFile=elementToRename.getContainingFile();
  return PsiTreeUtil.isAncestor(containingFile,scopeElements[0],false);
}
