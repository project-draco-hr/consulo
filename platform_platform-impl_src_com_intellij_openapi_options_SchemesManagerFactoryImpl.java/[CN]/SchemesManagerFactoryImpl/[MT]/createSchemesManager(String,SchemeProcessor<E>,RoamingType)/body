{
  final Application application=ApplicationManager.getApplication();
  if (!(application instanceof ApplicationEx2))   return null;
  String baseDirPath=((ApplicationEx2)application).getStateStore().getStateStorageManager().expandMacros(fileSpec);
  StreamProvider provider=((ApplicationEx2)ApplicationManager.getApplication()).getStateStore().getStateStorageManager().getStreamProvider();
  SchemesManagerImpl<T,E> manager=new SchemesManagerImpl<T,E>(fileSpec,processor,roamingType,provider,new File(baseDirPath));
  myRegisteredManagers.add(manager);
  return manager;
}
