{
  final PsiBuilder builder=new PsiBuilderImpl(new MyTestLexer(),WHITESPACE_SET,COMMENT_SET,text);
  final PsiBuilder.Marker rootMarker=builder.mark();
  parser.parse(builder);
  rootMarker.done(ROOT);
  final FlyweightCapableTreeStructure<LighterASTNode> lightTree=builder.getLightTree();
  final String lightExpected=expected.replaceAll("PsiErrorElement:.*\n","PsiErrorElement\n");
  assertEquals(lightExpected,DebugUtil.lightTreeToString(lightTree,text,false));
  final ASTNode root=builder.getTreeBuilt();
  assertEquals(expected,DebugUtil.nodeTreeToString(root,false));
}
