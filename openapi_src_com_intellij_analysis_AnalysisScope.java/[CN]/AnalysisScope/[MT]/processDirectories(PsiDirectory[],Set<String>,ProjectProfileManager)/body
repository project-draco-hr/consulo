{
  for (  final PsiDirectory directory : psiDirectories) {
    final PsiFile[] psiFiles=ApplicationManager.getApplication().runReadAction(new Computable<PsiFile[]>(){
      public PsiFile[] compute(){
        return directory.getFiles();
      }
    }
);
    for (    PsiFile file : psiFiles) {
      result.add(profileManager.getProfileName(file));
    }
    processDirectories(ApplicationManager.getApplication().runReadAction(new Computable<PsiDirectory[]>(){
      public PsiDirectory[] compute(){
        return directory.getSubdirectories();
      }
    }
),result,profileManager);
  }
}
