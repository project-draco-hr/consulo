{
  final boolean[] accepted=new boolean[]{true};
  ApplicationManager.getApplication().runReadAction(new Runnable(){
    public void run(){
      final PsiFile psiFile=psiManager.findFile(fileOrDir);
      if (psiFile == null) {
        return;
      }
      psiFile.accept(visitor);
      final ProgressIndicator indicator=ProgressManager.getInstance().getProgressIndicator();
      accepted[0]=indicator == null || !indicator.isCanceled();
    }
  }
);
  return accepted[0];
}
