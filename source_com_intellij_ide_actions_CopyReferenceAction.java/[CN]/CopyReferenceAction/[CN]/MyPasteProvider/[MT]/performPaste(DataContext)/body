{
  final Project project=(Project)dataContext.getData(DataConstants.PROJECT);
  final Editor editor=(Editor)dataContext.getData(DataConstants.EDITOR);
  if (project == null || editor == null)   return;
  final String fqn=getCopiedFqn();
  PsiMember member=CopyReferenceAction.fqnToMember(project,fqn);
  insert(fqn,(PsiNamedElement)member,editor);
  if (editor.getSelectionModel().hasSelection()) {
    ApplicationManager.getApplication().runWriteAction(new Runnable(){
      public void run(){
        EditorModificationUtil.deleteSelectedText(editor);
      }
    }
);
  }
}
