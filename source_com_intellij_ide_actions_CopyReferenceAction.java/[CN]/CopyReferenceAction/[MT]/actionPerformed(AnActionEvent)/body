{
  DataContext dataContext=e.getDataContext();
  Editor editor=(Editor)dataContext.getData(DataConstants.EDITOR);
  Project project=(Project)dataContext.getData(DataConstants.PROJECT);
  PsiFile file=PsiDocumentManager.getInstance(project).getPsiFile(editor.getDocument());
  PsiElement element=file.findElementAt(editor.getCaretModel().getOffset());
  PsiMember member=PsiTreeUtil.getParentOfType(element,PsiMember.class);
  String fqn;
  fqn=elementToFqn(member);
  PropertiesComponent.getInstance(project).setValue("REFERENCE_FQN",fqn);
  final StatusBarEx statusBar=(StatusBarEx)WindowManager.getInstance().getStatusBar(project);
  statusBar.setInfo("Reference to '" + fqn + "' has been copied.");
  HighlightManager highlightManager=HighlightManager.getInstance(project);
  EditorColorsManager manager=EditorColorsManager.getInstance();
  TextAttributes attributes=manager.getGlobalScheme().getAttributes(EditorColors.SEARCH_RESULT_ATTRIBUTES);
  PsiIdentifier nameIdentifier=member instanceof PsiClass ? ((PsiClass)member).getNameIdentifier() : member instanceof PsiVariable ? ((PsiVariable)member).getNameIdentifier() : ((PsiMethod)member).getNameIdentifier();
  highlightManager.addOccurrenceHighlights(editor,new PsiElement[]{nameIdentifier},attributes,true,null);
}
