{
  Map<AbstractVcs,List<VirtualFile>> vcsToFileMap=new HashMap<AbstractVcs,List<VirtualFile>>();
  for (int i=0; i < files.length; i++) {
    VirtualFile file=files[i];
    AbstractVcs activeVcs=ProjectLevelVcsManager.getInstance(myProject).getVcsFor(file);
    if (activeVcs == null)     continue;
    if (!vcsToFileMap.containsKey(activeVcs))     vcsToFileMap.put(activeVcs,new ArrayList<VirtualFile>());
    vcsToFileMap.get(activeVcs).add(file);
  }
  for (Iterator<AbstractVcs> iterator=vcsToFileMap.keySet().iterator(); iterator.hasNext(); ) {
    AbstractVcs abstractVcs=iterator.next();
    doCheckinFiles(abstractVcs,vcsToFileMap.get(abstractVcs),checkinParameters);
  }
}
