{
  if (externally && myMap.containsKey(key)) {
    myModified.add(key);
  }
  RangeMarker old=myMap.get(key);
  if (old != null)   old.dispose();
  final RangeMarker marker=myDocument.createRangeMarker(offset,offset);
  marker.setGreedyToRight(key.isMoveableToRight());
  myMap.put(key,marker);
}
