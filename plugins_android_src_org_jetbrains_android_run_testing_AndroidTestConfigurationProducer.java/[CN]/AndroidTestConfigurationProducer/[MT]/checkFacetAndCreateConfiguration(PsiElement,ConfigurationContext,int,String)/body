{
  Module module=context.getModule();
  if (module == null || AndroidFacet.getInstance(module) == null) {
    return null;
  }
  mySourceElement=element;
  RunnerAndConfigurationSettings settings=cloneTemplateConfiguration(element.getProject(),context);
  AndroidTestRunConfiguration configuration=(AndroidTestRunConfiguration)settings.getConfiguration();
  configuration.TESTING_TYPE=testingType;
  configuration.setName(JavaExecutionUtil.getPresentableClassName(configurationName,configuration.getConfigurationModule()));
  setupConfigurationModule(context,configuration);
  final TargetSelectionMode targetSelectionMode=AndroidUtils.getDefaultTargetSelectionMode(module,AndroidTestRunConfigurationType.getInstance(),AndroidRunConfigurationType.getInstance());
  if (targetSelectionMode != null) {
    configuration.setTargetSelectionMode(targetSelectionMode);
  }
  return settings;
}
