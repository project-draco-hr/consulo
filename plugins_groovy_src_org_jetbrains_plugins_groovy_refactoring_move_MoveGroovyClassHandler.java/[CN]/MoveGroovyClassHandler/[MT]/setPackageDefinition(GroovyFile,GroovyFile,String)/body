{
  String modifiersText=null;
  final GrPackageDefinition packageDefinition=file.getPackageDefinition();
  if (packageDefinition != null) {
    final PsiModifierList modifierList=packageDefinition.getModifierList();
    if (modifierList != null) {
      modifiersText=modifierList.getText().trim();
    }
  }
  if (modifiersText != null && modifiersText.length() > 0) {
    final GroovyPsiElementFactory factory=GroovyPsiElementFactory.getInstance(file.getProject());
    final GrPackageDefinition newPackageDefinition=(GrPackageDefinition)factory.createTopElementFromText(modifiersText + " package " + newPackageName);
    newFile.setPackage(newPackageDefinition);
  }
 else {
    newFile.setPackageName(newPackageName);
  }
}
