{
  final boolean forceUseNio2=SystemProperties.getBooleanProperty(FORCE_USE_NIO2_KEY,false);
  final String quickTestPath=SystemInfo.isWindows ? "C:\\" : "/";
  if (!forceUseNio2 && (SystemInfo.isLinux || SystemInfo.isMac || SystemInfo.isSolaris|| SystemInfo.isFreeBSD)) {
    try {
      final Mediator mediator=new JnaUnixMediatorImpl();
      mediator.getAttributes(quickTestPath);
      return mediator;
    }
 catch (    Throwable t) {
      LOG.warn(t);
    }
  }
  if (SystemInfo.isJavaVersionAtLeast("1.7") && !"1.7.0-ea".equals(SystemInfo.JAVA_VERSION)) {
    try {
      final Mediator mediator=new Nio2MediatorImpl();
      mediator.getAttributes(quickTestPath);
      return mediator;
    }
 catch (    Throwable t) {
      LOG.warn(t);
    }
  }
  return new StandardMediatorImpl();
}
