{
  Memory buffer=new Memory(256);
  int res=SystemInfo.isLinux ? myLibC.__lxstat64(0,path,buffer) : myLibC.lstat(path,buffer);
  if (res != 0)   return null;
  int mode=(SystemInfo.isLinux ? buffer.getInt(myOffsets[OFF_MODE]) : buffer.getShort(myOffsets[OFF_MODE])) & LibC.S_MASK;
  boolean isSymlink=(mode & LibC.S_IFLNK) == LibC.S_IFLNK;
  if (isSymlink) {
    res=SystemInfo.isLinux ? myLibC.__xstat64(0,path,buffer) : myLibC.stat(path,buffer);
    if (res != 0) {
      return FileAttributes.BROKEN_SYMLINK;
    }
    mode=(SystemInfo.isLinux ? buffer.getInt(myOffsets[OFF_MODE]) : buffer.getShort(myOffsets[OFF_MODE])) & LibC.S_MASK;
  }
  boolean isDirectory=(mode & LibC.S_IFDIR) == LibC.S_IFDIR;
  boolean isSpecial=!isDirectory && (mode & LibC.S_IFREG) == 0;
  long size=buffer.getLong(myOffsets[OFF_SIZE]);
  long mTime1=SystemInfo.is32Bit ? buffer.getInt(myOffsets[OFF_TIME]) : buffer.getLong(myOffsets[OFF_TIME]);
  long mTime2=myCoarseTs ? 0 : SystemInfo.is32Bit ? buffer.getInt(myOffsets[OFF_TIME] + 4) : buffer.getLong(myOffsets[OFF_TIME] + 8);
  long mTime=mTime1 * 1000 + mTime2 / 1000000;
  boolean writable=ownFile(buffer) ? (mode & LibC.WRITE_MASK) != 0 : myLibC.access(path,LibC.W_OK) == 0;
  return new FileAttributes(isDirectory,isSpecial,isSymlink,false,size,mTime,writable);
}
