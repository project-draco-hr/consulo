{
  try {
    final Object pathObj=myGetPath.invoke(myDefaultFileSystem,path,ArrayUtil.EMPTY_STRING_ARRAY);
    Map attributes=(Map)myReadAttributes.invoke(null,pathObj,mySchema,myNoFollowLinkOptions);
    final boolean isSymbolicLink=(Boolean)attributes.get("isSymbolicLink");
    if (isSymbolicLink) {
      try {
        attributes=(Map)myReadAttributes.invoke(null,pathObj,mySchema,myLinkOptions);
      }
 catch (      InvocationTargetException e) {
        final Throwable cause=e.getCause();
        if (cause != null && "java.nio.file.NoSuchFileException".equals(cause.getClass().getName())) {
          return FileAttributes.BROKEN_SYMLINK;
        }
      }
    }
    final boolean isDirectory=(Boolean)attributes.get("isDirectory");
    final boolean isOther=(Boolean)attributes.get("isOther");
    final long size=(Long)attributes.get("size");
    final long lastModified=(Long)myToMillis.invoke(attributes.get("lastModifiedTime"));
    if (SystemInfo.isWindows) {
      final boolean isHidden=(Boolean)attributes.get("hidden");
      final boolean isWritable=!(Boolean)attributes.get("readonly");
      return new FileAttributes(isDirectory,isOther,isSymbolicLink,isHidden,size,lastModified,isWritable);
    }
 else {
      final int permissions=decodePermissions(attributes.get("permissions"));
      return new FileAttributes(isDirectory,isOther,isSymbolicLink,size,lastModified,permissions);
    }
  }
 catch (  InvocationTargetException e) {
    final Throwable cause=e.getCause();
    if (cause != null && ("java.nio.file.NoSuchFileException".equals(cause.getClass().getName()) || "java.nio.file.InvalidPathException".equals(cause.getClass().getName()))) {
      LOG.debug(cause);
      return null;
    }
    throw e;
  }
}
