{
  if (SystemInfo.isUnix) {
    Object sourcePath=myGetPath.invoke(myDefaultFileSystem,source,ArrayUtil.EMPTY_STRING_ARRAY);
    Object targetPath=myGetPath.invoke(myDefaultFileSystem,target,ArrayUtil.EMPTY_STRING_ARRAY);
    Collection sourcePermissions=getPermissions(sourcePath);
    Collection targetPermissions=getPermissions(targetPath);
    if (sourcePermissions != null && targetPermissions != null) {
      if (onlyPermissionsToExecute) {
        Collection<Object> permissionsToSet=ContainerUtil.newHashSet();
        for (        Object permission : targetPermissions) {
          if (!permission.toString().endsWith("_EXECUTE")) {
            permissionsToSet.add(permission);
          }
        }
        for (        Object permission : sourcePermissions) {
          if (permission.toString().endsWith("_EXECUTE")) {
            permissionsToSet.add(permission);
          }
        }
        mySetAttribute.invoke(null,targetPath,"posix:permissions",permissionsToSet,myLinkOptions);
      }
 else {
        mySetAttribute.invoke(null,targetPath,"posix:permissions",sourcePermissions,myLinkOptions);
      }
      return true;
    }
  }
  return false;
}
