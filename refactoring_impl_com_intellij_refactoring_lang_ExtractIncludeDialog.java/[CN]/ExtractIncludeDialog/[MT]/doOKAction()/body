{
  final Project project=myCurrentDirectory.getProject();
  final String directoryName=myTargetDirectoryField.getText().replace(File.separatorChar,'/');
  final String targetFileName=getTargetFileName();
  if (isFileExist(directoryName,targetFileName)) {
    Messages.showErrorDialog(project,RefactoringBundle.message("file.already.exist",targetFileName),RefactoringBundle.message("file.already.exist.title"));
    return;
  }
  CommandProcessor.getInstance().executeCommand(project,new Runnable(){
    public void run(){
      final Runnable action=new Runnable(){
        public void run(){
          try {
            PsiDirectory targetDirectory=DirectoryUtil.mkdirs(PsiManager.getInstance(project),directoryName);
            targetDirectory.checkCreateFile(targetFileName);
            final String webPath=ExtractJspIncludeFileHandler.getWebPath(myCurrentDirectory,targetDirectory);
            myTargetDirectory=webPath == null ? null : targetDirectory;
          }
 catch (          IncorrectOperationException e) {
            CommonRefactoringUtil.showErrorMessage(REFACTORING_NAME,e.getMessage(),null,project);
          }
        }
      }
;
      ApplicationManager.getApplication().runWriteAction(action);
    }
  }
,RefactoringBundle.message("create.directory"),null);
  if (myTargetDirectory == null)   return;
  super.doOKAction();
}
