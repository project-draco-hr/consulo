{
  if (psiElement instanceof PsiFile) {
    return DiffContent.fromFile(psiElement.getProject(),((PsiFile)psiElement).getVirtualFile());
  }
 else   if (psiElement instanceof PsiDirectory) {
    return DiffContent.fromFile(psiElement.getProject(),((PsiDirectory)psiElement).getVirtualFile());
  }
  PsiFile containingFile=psiElement.getContainingFile();
  if (containingFile == null) {
    String text=psiElement.getText();
    return text != null ? new SimpleContent(text) : null;
  }
  DiffContent wholeFileContent=DiffContent.fromFile(psiElement.getProject(),containingFile.getVirtualFile());
  if (wholeFileContent == null || wholeFileContent.getDocument() == null)   return null;
  Project project=psiElement.getProject();
  return new FragmentContent(wholeFileContent,psiElement.getTextRange(),project);
}
