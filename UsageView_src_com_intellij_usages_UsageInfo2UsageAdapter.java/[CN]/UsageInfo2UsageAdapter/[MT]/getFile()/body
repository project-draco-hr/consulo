{
  if (isValid()) {
    return getElement().getContainingFile().getVirtualFile();
  }
 else   if (markersValid() && myRangeMarkers.size() > 0) {
    final Document doc=myRangeMarkers.get(0).getDocument();
    return FileDocumentManager.getInstance().getFile(doc);
  }
  return null;
}
