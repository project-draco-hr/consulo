{
  final PsiElement element=getElement();
  final PsiFile containingFile=element == null ? null : element.getContainingFile();
  final PsiElement oElement=o.getElement();
  final PsiFile oContainingFile=oElement == null ? null : oElement.getContainingFile();
  if (containingFile == null && oContainingFile == null || !Comparing.equal(containingFile,oContainingFile)) {
    return 0;
  }
  return getRangeMarker().getStartOffset() - o.getRangeMarker().getStartOffset();
}
