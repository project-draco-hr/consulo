{
  if (markersValid()) {
    return new OpenFileDescriptor(getProject(),getFile(),myRangeMarkers.size() > 0 ? getRangeMarker().getStartOffset() : myOffset);
  }
 else   if (getFile().isValid()) {
    final Document doc=FileDocumentManager.getInstance().getDocument(getFile());
    if (doc != null) {
      int line=Math.max(0,Math.min(myLineNumber,doc.getLineCount()));
      return new OpenFileDescriptor(getProject(),getFile(),line,0);
    }
  }
  return null;
}
