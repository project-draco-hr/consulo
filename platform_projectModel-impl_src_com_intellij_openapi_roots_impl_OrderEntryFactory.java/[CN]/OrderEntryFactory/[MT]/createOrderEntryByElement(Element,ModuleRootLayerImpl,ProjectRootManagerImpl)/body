{
  LOG.assertTrue(ORDER_ENTRY_ELEMENT_NAME.equals(element.getName()));
  final String type=element.getAttributeValue(ORDER_ENTRY_TYPE_ATTR);
  if (type == null) {
    throw new InvalidDataException();
  }
  if (ModuleSourceOrderEntryImpl.ENTRY_TYPE.equals(type)) {
    return new ModuleSourceOrderEntryImpl(element,rootModel);
  }
 else   if (ModuleExtensionWithSdkOrderEntryImpl.ENTRY_TYPE.equals(type)) {
    return new ModuleExtensionWithSdkOrderEntryImpl(element,rootModel);
  }
 else   if (LibraryOrderEntryImpl.ENTRY_TYPE.equals(type)) {
    return new LibraryOrderEntryImpl(element,rootModel,projectRootManager);
  }
 else   if (ModuleLibraryOrderEntryImpl.ENTRY_TYPE.equals(type)) {
    return new ModuleLibraryOrderEntryImpl(element,rootModel);
  }
 else   if (ModuleOrderEntryImpl.ENTRY_TYPE.equals(type)) {
    return new ModuleOrderEntryImpl(element,rootModel);
  }
 else {
    LOG.warn("Unknown order entry type:" + type);
    return null;
  }
}
