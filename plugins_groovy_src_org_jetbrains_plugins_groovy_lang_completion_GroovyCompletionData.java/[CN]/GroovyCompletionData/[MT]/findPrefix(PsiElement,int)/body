{
  if (insertedElement == null)   return "";
  final String text=insertedElement.getText();
  final int offsetInElement=offset - insertedElement.getTextRange().getStartOffset();
  int start=offsetInElement - 1;
  while (start >= 0) {
    final char c=text.charAt(start);
    if (!Character.isJavaIdentifierPart(c) && c != '\'')     break;
    --start;
  }
  return text.substring(start + 1,offsetInElement).trim();
}
