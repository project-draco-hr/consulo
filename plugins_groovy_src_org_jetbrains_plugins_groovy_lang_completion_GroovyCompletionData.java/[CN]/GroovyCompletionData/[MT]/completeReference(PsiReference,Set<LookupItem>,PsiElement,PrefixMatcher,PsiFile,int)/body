{
  final CompletionVariant[] variants=findVariants(position,file);
  ApplicationManager.getApplication().runReadAction(new Runnable(){
    public void run(){
      boolean hasApplicableVariants=false;
      for (      CompletionVariant variant : variants) {
        if (variant.hasReferenceFilter()) {
          variant.addReferenceCompletions(reference,position,set,matcher,file,GroovyCompletionData.this);
          hasApplicableVariants=true;
        }
      }
      if (!hasApplicableVariants) {
        ourReferenceVariant.addReferenceCompletions(reference,position,set,matcher,file,GroovyCompletionData.this);
      }
    }
  }
);
}
