{
  PsiElement currentContext=expression;
  while (true) {
    final PsiTryStatement tryStatement=PsiTreeUtil.getParentOfType(currentContext,PsiTryStatement.class,true,PsiMember.class);
    if (tryStatement == null) {
      break;
    }
    if (resourceIsClosedInFinally(tryStatement,boundVariable)) {
      return true;
    }
    currentContext=tryStatement;
  }
  currentContext=PsiTreeUtil.getParentOfType(expression,PsiStatement.class,false,PsiMember.class);
  if (currentContext == null)   return false;
  currentContext=currentContext.getNextSibling();
  while (currentContext != null) {
    if (currentContext instanceof PsiTryStatement) {
      if (resourceIsClosedInFinally((PsiTryStatement)currentContext,boundVariable)) {
        return true;
      }
    }
    Set<PsiType> thrown=ExceptionUtils.calculateExceptionsThrown(currentContext);
    if (!thrown.isEmpty())     return false;
    currentContext=currentContext.getNextSibling();
  }
  return false;
}
