{
  final File tempFile=FileUtil.createTempFile("launcher","");
  final InputStream stream=CreateLauncherScriptAction.class.getClassLoader().getResourceAsStream("launcher.py");
  @SuppressWarnings("IOResourceOpenedButNotSafelyClosed") String launcherContents=FileUtil.loadTextAndClose(new InputStreamReader(stream));
  launcherContents=launcherContents.replace("$CONFIG_PATH$",PathManager.getConfigPath());
  String homePath=PathManager.getHomePath();
  if (SystemInfo.isMac) {
    launcherContents=launcherContents.replace("$RUN_PATH$",homePath);
  }
 else {
    String productName=ApplicationNamesInfo.getInstance().getProductName().toLowerCase();
    launcherContents=launcherContents.replace("$RUN_PATH$",homePath + "/bin/" + productName+ ".sh");
  }
  FileUtil.writeToFile(tempFile,launcherContents.getBytes(CharsetToolkit.UTF8_CHARSET));
  if (!tempFile.setExecutable(true)) {
    throw new IOException("Failed to mark the launcher script as executable");
  }
  return tempFile;
}
