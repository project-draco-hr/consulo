{
  MultiMap<ProjectStructureDetector,DetectedProjectRoot> roots=new MultiMap<ProjectStructureDetector,DetectedProjectRoot>();
  final List<DetectedRootData> selectedElements=myDetectedRootsChooser.getMarkedElements();
  for (  final DetectedRootData rootData : selectedElements) {
    for (    ProjectStructureDetector detector : rootData.getSelectedDetectors()) {
      roots.putValue(detector,rootData.getSelectedRoot());
    }
  }
  myBuilder.setProjectRoots(roots);
  for (  ProjectStructureDetector detector : roots.keySet()) {
    detector.setupProjectStructure(roots.get(detector),myBuilder.getProjectDescriptor(detector),myBuilder);
  }
  updateSelectedTypes();
}
