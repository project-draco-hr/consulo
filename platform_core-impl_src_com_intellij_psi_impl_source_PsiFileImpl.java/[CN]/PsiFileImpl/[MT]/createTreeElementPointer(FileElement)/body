{
  if (isKeepTreeElementByHardReference()) {
    return treeElement;
  }
  return myManager.isBatchFilesProcessingMode() ? new PatchedWeakReference<FileElement>(treeElement) : new SoftReference<FileElement>(treeElement);
}
