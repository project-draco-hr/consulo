{
  boolean wasInModel=oldValue != null && myInModel;
  myInModel=myFileDescription != null && (changedRoot == null || myFileDescription.getDomModelDependentFiles(changedRoot).contains(myXmlFile));
  if (fireEvents && oldValue != null && myLastResult != null) {
    if (oldValue.equals(myLastResult))     events.add(new ElementChangedEvent(myLastResult));
 else     if (!myInModel && wasInModel)     events.add(new ElementChangedEvent(oldValue));
 else     if (myInModel && !wasInModel)     events.add(new ElementChangedEvent(myLastResult));
  }
}
