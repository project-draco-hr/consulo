{
  if (myComputing || myDomManager.getProject().isDisposed())   return Collections.emptyList();
  myComputing=true;
  try {
    if (!myXmlFile.isValid()) {
      if (fireEvents && myLastResult != null) {
        myDomManager.getFileDescriptions().get(myFileDescription).remove(myLastResult);
        return Arrays.<DomEvent>asList(new ElementUndefinedEvent(myLastResult));
      }
      return Collections.emptyList();
    }
    final Module module=ModuleUtil.findModuleForPsiElement(myXmlFile);
    final NullableLazyValue<String> rootTagName=new NullableLazyValue<String>(){
      protected String compute(){
        return getRootTagName();
      }
    }
;
    if (myLastResult != null && myFileDescription.getRootTagName().equals(rootTagName.getValue()) && myFileDescription.isMyFile(myXmlFile,module)) {
      List<DomEvent> list=new SmartList<DomEvent>();
      setInModel(changedRoot,list,myLastResult,fireEvents);
      return list;
    }
    myModCount++;
    final XmlFile originalFile=(XmlFile)myXmlFile.getOriginalFile();
    final DomFileDescription<T> description=originalFile != null ? myDomManager.getOrCreateCachedValueProvider(originalFile).getFileDescription() : findFileDescription(rootTagName,module);
    return saveResult(description,fireEvents,changedRoot);
  }
  finally {
    myComputing=false;
  }
}
