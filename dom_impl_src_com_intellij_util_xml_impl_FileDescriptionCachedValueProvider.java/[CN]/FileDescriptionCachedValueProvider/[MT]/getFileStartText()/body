{
  final Document document=PsiDocumentManager.getInstance(myXmlFile.getProject()).getCachedDocument(myXmlFile);
  if (document != null) {
    return getSubsequence(document.getCharsSequence());
  }
  final VirtualFile virtualFile=myXmlFile.getVirtualFile();
  if (virtualFile != null) {
    final long l=virtualFile.getLength();
    if (l > LIMIT) {
      BufferedReader reader=null;
      try {
        reader=new BufferedReader(new InputStreamReader(virtualFile.getInputStream()));
        final char[] buf=new char[START];
        final int i=reader.read(buf,0,START);
        if (i <= 0)         return null;
        return new CharArrayCharSequence(buf,0,i);
      }
 catch (      IOException e) {
        LOG.error(e);
      }
 finally {
        if (reader != null) {
          try {
            reader.close();
          }
 catch (          IOException e) {
            LOG.error(e);
          }
        }
      }
    }
  }
  return null;
}
