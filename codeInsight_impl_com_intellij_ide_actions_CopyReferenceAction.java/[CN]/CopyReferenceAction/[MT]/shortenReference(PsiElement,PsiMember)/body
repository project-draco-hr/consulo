{
  while (element.getParent() instanceof PsiJavaCodeReferenceElement) {
    element=element.getParent();
    if (element == null)     return;
  }
  if (element instanceof PsiJavaCodeReferenceElement && elementToInsert != null) {
    try {
      element=((PsiJavaCodeReferenceElement)element).bindToElement(elementToInsert);
    }
 catch (    IncorrectOperationException e) {
    }
  }
  final JavaCodeStyleManager codeStyleManagerEx=JavaCodeStyleManager.getInstance(element.getProject());
  codeStyleManagerEx.shortenClassReferences(element,JavaCodeStyleManager.UNCOMPLETE_CODE);
}
