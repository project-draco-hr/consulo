{
  final VirtualFile virtualFile=file.getVirtualFile();
  if (virtualFile == null) {
    return file.getName();
  }
  final Project project=file.getManager().getProject();
  final LogicalRoot logicalRoot=LogicalRootsManager.getLogicalRootsManager(project).findLogicalRoot(virtualFile);
  if (logicalRoot != null) {
    return "/" + FileUtil.getRelativePath(VfsUtil.virtualToIoFile(logicalRoot.getVirtualFile()),VfsUtil.virtualToIoFile(virtualFile));
  }
  final VirtualFile contentRoot=ProjectRootManager.getInstance(project).getFileIndex().getContentRootForFile(virtualFile);
  if (contentRoot != null) {
    return "/" + FileUtil.getRelativePath(VfsUtil.virtualToIoFile(contentRoot),VfsUtil.virtualToIoFile(virtualFile));
  }
  return virtualFile.getPath();
}
