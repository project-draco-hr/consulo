{
  final VirtualFile virtualFile=file.getVirtualFile();
  if (virtualFile == null) {
    return file.getName();
  }
  final Project project=file.getManager().getProject();
  final WebModuleProperties webModuleProperties=(WebModuleProperties)WebUtil.getWebModuleProperties(file);
  if (webModuleProperties != null) {
    final WebRoot webRoot=WebUtil.findParentWebRoot(virtualFile,webModuleProperties.getWebRoots(true));
    if (webRoot != null && webRoot.getFile() != null) {
      return "/" + FileUtil.getRelativePath(VfsUtil.virtualToIoFile(webRoot.getFile()),VfsUtil.virtualToIoFile(virtualFile));
    }
  }
  final VirtualFile sourceRoot=ProjectRootManager.getInstance(project).getFileIndex().getSourceRootForFile(virtualFile);
  if (sourceRoot != null) {
    return "/" + FileUtil.getRelativePath(VfsUtil.virtualToIoFile(sourceRoot),VfsUtil.virtualToIoFile(virtualFile));
  }
  final VirtualFile contentRoot=ProjectRootManager.getInstance(project).getFileIndex().getContentRootForFile(virtualFile);
  if (contentRoot != null) {
    return "/" + FileUtil.getRelativePath(VfsUtil.virtualToIoFile(contentRoot),VfsUtil.virtualToIoFile(virtualFile));
  }
  return virtualFile.getPath();
}
