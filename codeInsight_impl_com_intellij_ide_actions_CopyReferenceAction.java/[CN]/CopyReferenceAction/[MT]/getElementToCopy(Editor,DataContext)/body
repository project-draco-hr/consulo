{
  PsiElement element=null;
  if (editor != null) {
    PsiReference reference=TargetElementUtil.findReference(editor,editor.getCaretModel().getOffset());
    if (reference != null) {
      element=reference.getElement();
    }
  }
  if (element == null) {
    element=(PsiElement)dataContext.getData(DataConstants.PSI_ELEMENT);
  }
  if (element != null && !(element instanceof PsiMember) && element.getParent() instanceof PsiMember) {
    element=element.getParent();
  }
  return element;
}
