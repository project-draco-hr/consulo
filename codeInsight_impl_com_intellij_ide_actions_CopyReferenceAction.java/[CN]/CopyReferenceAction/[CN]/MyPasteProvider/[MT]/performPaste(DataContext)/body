{
  final Project project=(Project)dataContext.getData(DataConstants.PROJECT);
  final Editor editor=(Editor)dataContext.getData(DataConstants.EDITOR);
  if (project == null || editor == null)   return;
  final String fqn=getCopiedFqn();
  PsiNamedElement element=CopyReferenceAction.fqnToElement(project,fqn);
  insert(fqn,element,editor);
  if (editor.getSelectionModel().hasSelection()) {
    ApplicationManager.getApplication().runWriteAction(new Runnable(){
      public void run(){
        EditorModificationUtil.deleteSelectedText(editor);
      }
    }
);
  }
}
