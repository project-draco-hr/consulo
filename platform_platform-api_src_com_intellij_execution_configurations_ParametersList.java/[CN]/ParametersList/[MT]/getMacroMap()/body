{
  if (myMacroMap == null) {
    myMacroMap=new LinkedHashMap<String,String>();
    final Application application=ApplicationManager.getApplication();
    if (application != null) {
      final PathMacros pathMacros=PathMacros.getInstance();
      if (pathMacros != null) {
        for (        String name : pathMacros.getUserMacroNames()) {
          final String value=pathMacros.getValue(name);
          if (value != null) {
            myMacroMap.put("${" + name + "}",value);
          }
        }
      }
      final Map<String,String> env=EnvironmentUtil.getEnvironmentProperties();
      for (      String name : env.keySet()) {
        final String key="${" + name + "}";
        if (!myMacroMap.containsKey(key)) {
          myMacroMap.put(key,env.get(name));
        }
      }
    }
  }
  return myMacroMap;
}
