{
  if (myMacroMap == null) {
    myMacroMap=new LinkedHashMap<String,String>();
    final Application application=ApplicationManager.getApplication();
    if (application != null) {
      application.runReadAction(new Runnable(){
        public void run(){
          final PathMacros pathMacros=PathMacros.getInstance();
          final Set<String> names=pathMacros.getAllMacroNames();
          for (          String name : names) {
            myMacroMap.put("${" + name + "}",pathMacros.getValue(name));
          }
        }
      }
);
      final Map<String,String> env=EnvironmentUtil.getEnviromentProperties();
      for (      String name : env.keySet()) {
        final String key="${" + name + "}";
        if (!myMacroMap.containsKey(key)) {
          myMacroMap.put(key,env.get(name));
        }
      }
    }
  }
  return myMacroMap;
}
