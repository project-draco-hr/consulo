{
  int targetLogicalLine=myDocument.getLineNumber(myOffset);
  if (targetLogicalLine == context.logicalLine) {
    context.logicalColumn+=myRepresentationHelper.toVisualColumnSymbolsNumber(myDocument.getCharsSequence(),context.offset,myOffset,context.x);
    return context.build();
  }
  context.logicalLine=targetLogicalLine;
  int i=CharArrayUtil.shiftBackwardUntil(myDocument.getCharsSequence(),myOffset - 1,"\n");
  if (i >= context.offset) {
    context.logicalColumn=myRepresentationHelper.toVisualColumnSymbolsNumber(myDocument.getCharsSequence(),i + 1,myOffset,0);
  }
 else {
    context.logicalColumn=myRepresentationHelper.toVisualColumnSymbolsNumber(myDocument.getCharsSequence(),context.offset,myOffset,context.x);
  }
  context.onNewLine();
  return context.build();
}
