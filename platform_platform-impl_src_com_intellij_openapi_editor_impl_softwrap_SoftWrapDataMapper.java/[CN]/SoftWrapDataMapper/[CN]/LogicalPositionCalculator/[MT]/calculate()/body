{
  FoldingProvider foldRegions=new FoldingProvider();
  SoftWrapsProvider softWraps=new SoftWrapsProvider();
  FoldRegion foldRegion=foldRegions.get();
  TextChange softWrap=softWraps.get();
  LogicalPosition result=null;
  while (true) {
    if (foldRegion == null && softWrap == null || strategy.exceeds(context)) {
      return strategy.build(context);
    }
    if (foldRegion != null && softWrap != null) {
      if (softWrap.getStart() <= foldRegion.getStartOffset()) {
        result=process(softWrap);
        softWrap=softWraps.get();
      }
 else {
        result=process(foldRegion);
        foldRegion=foldRegions.get();
      }
    }
 else {
      if (foldRegion != null) {
        result=process(foldRegion);
        foldRegion=foldRegions.get();
      }
      if (softWrap != null) {
        result=process(softWrap);
        softWrap=softWraps.get();
      }
    }
    if (result != null) {
      return result;
    }
  }
}
