{
  final PathMacroManager pathMacroManager=PathMacroManager.getInstance(getComponentManager());
  final XmlElementStorage storage=new XmlElementStorage(pathMacroManager){
    @Nullable protected Element getRootElement() throws StateStorageException {
      return myElement;
    }
    public void save() throws StateStorageException {
      if (myElement != null) {
        myProjectManager.setDefaultProjectRootElement(JDOMUtil.convertFromDOM(myElement));
      }
    }
    public boolean needsSave() throws StateStorageException {
      return true;
    }
    public List<VirtualFile> getAllStorageFiles(){
      return Collections.emptyList();
    }
  }
;
  return new StateStorageManager(pathMacroManager,"project"){
    @Override public synchronized StateStorage getStateStorage(    final Storage storageSpec){
      return storage;
    }
    @Override @Nullable public StateStorage getFileStateStorage(    final String fileName){
      return storage;
    }
    @Override public synchronized void save() throws StateStorage.StateStorageException, IOException {
      super.save();
      storage.save();
    }
  }
;
}
