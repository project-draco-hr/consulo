{
  final Set<VcsRoot> roots=new HashSet<VcsRoot>();
  if (depth > MAXIMUM_SCAN_DEPTH) {
    return roots;
  }
  if (myProject.isDisposed() || !dir.isDirectory()) {
    return roots;
  }
  List<AbstractVcs> vcsList=getVcsListFor(dir);
  for (  AbstractVcs vcs : vcsList) {
    roots.add(new VcsRoot(vcs,dir));
  }
  for (  VirtualFile child : dir.getChildren()) {
    roots.addAll(scanForRootsInsideDir(child,depth + 1));
  }
  return roots;
}
