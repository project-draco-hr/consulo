{
  if (startDir == null) {
    return new VcsRootDetectInfo(Collections.<VcsRoot>emptyList(),false,false);
  }
  final Set<VcsRoot> roots=scanForRootsInsideDir(startDir);
  roots.addAll(scanForRootsInContentRoots());
  for (  VcsRoot root : roots) {
    if (startDir.equals(root.getPath())) {
      return new VcsRootDetectInfo(roots,true,false);
    }
  }
  List<VcsRoot> rootsAbove=scanForSingleRootAboveDir(startDir);
  if (!rootsAbove.isEmpty()) {
    roots.addAll(rootsAbove);
    return new VcsRootDetectInfo(roots,true,true);
  }
  return new VcsRootDetectInfo(roots,false,false);
}
