{
  final VirtualFile selectedFile=getSelectedFile();
  if (selectedFile == null) {
    return;
  }
  final ContentEntryEditor contentEntryEditor=myEntryTreeEditor.getContentEntryEditor();
  final SourceFolder sourceFolder=contentEntryEditor.getSourceFolder(selectedFile);
  if (isSelected) {
    if (sourceFolder == null) {
      contentEntryEditor.addSourceFolder(selectedFile,myEditTestSources);
    }
 else {
      if (myEditTestSources ? !sourceFolder.isTestSource() : sourceFolder.isTestSource()) {
        contentEntryEditor.removeSourceFolder(sourceFolder);
        contentEntryEditor.addSourceFolder(selectedFile,myEditTestSources);
      }
    }
  }
 else {
    if (sourceFolder != null) {
      contentEntryEditor.removeSourceFolder(sourceFolder);
    }
  }
}
