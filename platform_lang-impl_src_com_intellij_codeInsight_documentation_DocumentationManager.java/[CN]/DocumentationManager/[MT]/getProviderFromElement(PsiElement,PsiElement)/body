{
  if (element != null && !element.isValid()) {
    element=null;
  }
  if (originalElement != null && !originalElement.isValid()) {
    originalElement=null;
  }
  if (originalElement == null) {
    originalElement=getOriginalElement(element);
  }
  PsiFile containingFile=originalElement != null ? originalElement.getContainingFile() : element != null ? element.getContainingFile() : null;
  Set<DocumentationProvider> result=new LinkedHashSet<DocumentationProvider>();
  final Language containingFileLanguage=containingFile != null ? containingFile.getLanguage() : null;
  DocumentationProvider originalProvider=containingFile != null ? LanguageDocumentation.INSTANCE.forLanguage(containingFileLanguage) : null;
  final Language elementLanguage=element != null ? element.getLanguage() : null;
  DocumentationProvider elementProvider=element == null || elementLanguage.is(containingFileLanguage) ? null : LanguageDocumentation.INSTANCE.forLanguage(elementLanguage);
  result.add(elementProvider);
  result.add(originalProvider);
  if (containingFile != null) {
    final Language baseLanguage=containingFile.getViewProvider().getBaseLanguage();
    if (!baseLanguage.is(containingFileLanguage)) {
      result.add(LanguageDocumentation.INSTANCE.forLanguage(baseLanguage));
    }
  }
 else   if (element instanceof PsiDirectory) {
    final Set<Language> langs=new HashSet<Language>();
    for (    PsiFile file : ((PsiDirectory)element).getFiles()) {
      final Language baseLanguage=file.getViewProvider().getBaseLanguage();
      if (!langs.contains(baseLanguage)) {
        langs.add(baseLanguage);
        result.add(LanguageDocumentation.INSTANCE.forLanguage(baseLanguage));
      }
    }
  }
  return CompositeDocumentationProvider.wrapProviders(result);
}
