{
  final Lookup activeLookup=LookupManager.getInstance(myProject).getActiveLookup();
  if (activeLookup != null) {
    LookupElement item=activeLookup.getCurrentItem();
    if (item != null) {
      int offset=editor.getCaretModel().getOffset();
      if (offset > 0 && offset == editor.getDocument().getTextLength())       offset--;
      final PsiElement contextElement=file == null ? null : file.findElementAt(offset);
      final PsiReference ref=TargetElementUtilBase.findReference(editor,offset);
      final DocumentationProvider documentationProvider=getProviderFromElement(file);
      return documentationProvider.getDocumentationElementForLookupItem(PsiManager.getInstance(myProject),item.getObject(),ref != null ? ref.getElement() : contextElement);
    }
  }
  return null;
}
