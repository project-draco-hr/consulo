{
  String path=PathManagerEx.getTestDataPath() + BASE_PATH + "/"+ getTestName(true);
  VirtualFile root=LocalFileSystem.getInstance().findFileByIoFile(new File(path));
  loadAllModulesUnder(root);
  ModuleManager moduleManager=ModuleManager.getInstance(getProject());
  final Module java4=moduleManager.findModuleByName("java4");
  Module java5=moduleManager.findModuleByName("java5");
  final ModuleRootManager rootManager4=ModuleRootManager.getInstance(java4);
  final ModuleRootManager rootManager5=ModuleRootManager.getInstance(java5);
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    @Override public void run(){
      final ModifiableRootModel rootModel4=rootManager4.getModifiableModel();
      rootModel4.setSdk(JavaSdkImpl.getMockJdk17("java 1.4"));
      rootModel4.commit();
      final ModifiableRootModel rootModel5=rootManager5.getModifiableModel();
      rootModel5.setSdk(JavaSdkImpl.getMockJdk17("java 1.5"));
      rootModel5.addModuleOrderEntry(java4);
      rootModel5.commit();
    }
  }
);
  configureByExistingFile(root.findFileByRelativePath("moduleJava5/com/Java5.java"));
  Collection<HighlightInfo> infos=highlightErrors();
  assertEmpty(infos);
}
