{
  final DockableGrid dockableGrid=(DockableGrid)dockable;
  final RunnerContentUi prev=dockableGrid.getRunnerUi();
  if (prev == this) {
    for (    TabInfo info : myTabs.getTabs()) {
      info.setHidden(false);
    }
    return;
  }
  saveUiState();
  final List<Content> contents=dockableGrid.getContents();
  final boolean wasRestoring=myOriginal != null && myOriginal.isStateBeingRestored();
  setStateIsBeingRestored(true,this);
  try {
    final Point point=dropTarget != null ? dropTarget.getPoint(myComponent) : null;
    boolean hadGrid=!myTabs.shouldAddToGlobal(point);
    for (    Content content : contents) {
      final View view=getStateFor(content);
      if (view.isMinimizedInGrid())       continue;
      prev.myManager.removeContent(content,false);
      myManager.removeContent(content,false);
      if (hadGrid && contents.size() == 1 && !wasRestoring) {
        view.assignTab(getTabFor(getSelectedGrid()));
        view.setPlaceInGrid(myLayoutSettings.getDefaultGridPlace(content));
      }
 else       if (contents.size() == 1 && !wasRestoring) {
        view.assignTab(null);
        view.setPlaceInGrid(myLayoutSettings.getDefaultGridPlace(content));
      }
      view.setWindow(myWindow);
      myManager.addContent(content);
    }
  }
  finally {
    setStateIsBeingRestored(false,this);
  }
  saveUiState();
  updateTabsUI(true);
}
