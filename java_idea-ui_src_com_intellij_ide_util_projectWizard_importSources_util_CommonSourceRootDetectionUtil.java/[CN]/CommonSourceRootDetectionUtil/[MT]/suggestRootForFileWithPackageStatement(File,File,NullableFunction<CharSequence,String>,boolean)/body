{
  if (!file.isFile())   return null;
  final CharSequence chars;
  try {
    chars=new CharArrayCharSequence(FileUtil.loadFileText(file));
  }
 catch (  IOException e) {
    return null;
  }
  String packageName=packageNameFetcher.fun(chars);
  if (packageName != null) {
    File root=file.getParentFile();
    int index=packageName.length();
    while (index > 0) {
      int index1=packageName.lastIndexOf('.',index - 1);
      String token=packageName.substring(index1 + 1,index);
      String dirName=root.getName();
      final boolean equalsToToken=SystemInfo.isFileSystemCaseSensitive ? dirName.equals(token) : dirName.equalsIgnoreCase(token);
      if (!equalsToToken || root.equals(topmostPossibleRoot)) {
        String packagePrefix=packageName.substring(0,index);
        if (!packagePrefixSupported && packagePrefix.length() > 0) {
          return null;
        }
        return Pair.create(root,packagePrefix);
      }
      String parent=root.getParent();
      if (parent == null) {
        return null;
      }
      root=new File(parent);
      index=index1;
    }
    return Pair.create(root,"");
  }
  return null;
}
