{
  final LibraryCompositionSettings settings=myPanel.apply();
  if (settings != null && settings.downloadFiles(myPanel.getMainPanel())) {
    if (myModifiableRootModel == null) {
      final ModifiableRootModel model=ModuleRootManager.getInstance(myModule).getModifiableModel();
      new WriteAction(){
        protected void run(        final Result result){
          addLibraries(model,settings);
          model.commit();
        }
      }
.execute();
    }
 else {
      addLibraries(myModifiableRootModel,settings);
    }
    super.doOKAction();
  }
}
