{
  if (!(type instanceof PsiClassType))   return null;
  PsiClassType classType=(PsiClassType)type;
  PsiClassType.ClassResolveResult result=classType.resolveGenerics();
  PsiClass clazz=result.getElement();
  if (clazz == null)   return null;
  JavaPsiFacade facade=JavaPsiFacade.getInstance(project);
  PsiClass collectionClass=facade.findClass("java.util.Collection",((PsiClassType)type).getResolveScope());
  if (collectionClass == null || collectionClass.getTypeParameters().length != 1)   return null;
  PsiSubstitutor substitutor=TypeConversionUtil.getClassSubstitutor(collectionClass,clazz,result.getSubstitutor());
  if (substitutor == null)   return null;
  PsiType componentType=substitutor.substitute(collectionClass.getTypeParameters()[0]);
  return componentType instanceof PsiIntersectionType ? null : componentType;
}
