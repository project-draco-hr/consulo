{
  JavaRunConfigurationModule configurationModule=getConfigurationModule();
  configurationModule.checkForWarning();
  Module module=configurationModule.getModule();
  if (module == null)   return;
  AndroidFacet facet=AndroidFacet.getInstance(module);
  if (facet == null) {
    throw new RuntimeConfigurationError(AndroidBundle.message("android.no.facet.error"));
  }
  if (facet.getConfiguration().LIBRARY_PROJECT) {
    throw new RuntimeConfigurationError(AndroidBundle.message("android.cannot.run.library.project.error"));
  }
  if (facet.getConfiguration().getAndroidPlatform() == null) {
    throw new RuntimeConfigurationError(AndroidBundle.message("select.platform.error"));
  }
  if (facet.getManifest() == null) {
    throw new RuntimeConfigurationError(AndroidBundle.message("android.manifest.not.found.error"));
  }
  if (PREFERRED_AVD.length() > 0) {
    AvdManager avdManager=facet.getAvdManagerSilently();
    if (avdManager == null) {
      throw new RuntimeConfigurationError(AndroidBundle.message("avd.cannot.be.loaded.error"));
    }
    AvdInfo avdInfo=avdManager.getAvd(PREFERRED_AVD,false);
    if (avdInfo == null) {
      throw new RuntimeConfigurationError(AndroidBundle.message("avd.not.found.error",PREFERRED_AVD));
    }
    if (!facet.isCompatibleAvd(avdInfo)) {
      throw new RuntimeConfigurationError(AndroidBundle.message("avd.not.compatible.error",PREFERRED_AVD));
    }
    if (avdInfo.getStatus() != AvdInfo.AvdStatus.OK) {
      throw new RuntimeConfigurationError(AndroidBundle.message("avd.not.valid.error",PREFERRED_AVD));
    }
  }
  checkConfiguration(facet);
}
