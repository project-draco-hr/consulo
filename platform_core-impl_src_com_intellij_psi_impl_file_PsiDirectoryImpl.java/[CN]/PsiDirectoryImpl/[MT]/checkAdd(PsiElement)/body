{
  CheckUtil.checkWritable(this);
  if (element instanceof PsiDirectory) {
    String name=((PsiDirectory)element).getName();
    PsiDirectory[] subpackages=getSubdirectories();
    for (    PsiDirectory dir : subpackages) {
      if (Comparing.strEqual(dir.getName(),name)) {
        throw new IncorrectOperationException(VfsBundle.message("dir.already.exists.error",dir.getVirtualFile().getPresentableUrl()));
      }
    }
  }
 else   if (element instanceof PsiFile) {
    String name=((PsiFile)element).getName();
    PsiFile[] files=getFiles();
    for (    PsiFile file : files) {
      if (Comparing.strEqual(file.getName(),name,SystemInfo.isFileSystemCaseSensitive)) {
        throw new IncorrectOperationException(VfsBundle.message("file.already.exists.error",file.getVirtualFile().getPresentableUrl()));
      }
    }
  }
 else {
    for (    PsiDirectoryMethodProxy proxy : PsiDirectoryMethodProxy.EP_NAME.getExtensions()) {
      if (proxy.checkAdd(this,element)) {
        return;
      }
    }
    throw new IncorrectOperationException("Element is not file or directory " + element);
  }
}
