{
  if (isInternalReference()) {
    for (ASTNode e=getFirstChildNode(); e != null; e=e.getTreeNext()) {
      if (e.getElementType() == XmlElementType.XML_ATTRIBUTE_VALUE) {
        return (XmlAttributeValue)SourceTreeToPsiMap.treeElementToPsi(e);
      }
    }
  }
 else {
    for (ASTNode e=getLastChildNode(); e != null; e=e.getTreePrev()) {
      if (e.getElementType() == XmlElementType.XML_ATTRIBUTE_VALUE) {
        return (XmlAttributeValue)SourceTreeToPsiMap.treeElementToPsi(e);
      }
    }
  }
  return null;
}
