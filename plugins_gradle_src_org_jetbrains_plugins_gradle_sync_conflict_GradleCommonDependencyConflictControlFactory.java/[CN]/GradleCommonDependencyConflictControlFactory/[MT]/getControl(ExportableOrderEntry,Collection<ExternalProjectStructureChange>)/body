{
  final ProjectEntityId id=EntityIdMapper.mapEntityToId(dependency);
  final Ref<DependencyScopeChange> scopeChangeRef=new Ref<DependencyScopeChange>();
  final Ref<DependencyExportedChange> exportedChangeRef=new Ref<DependencyExportedChange>();
  ExternalProjectStructureChangeVisitor visitor=new ExternalProjectStructureChangeVisitorAdapter(){
    @Override public void visit(    @NotNull DependencyScopeChange change){
      if (id.equals(change.getEntityId())) {
        scopeChangeRef.set(change);
      }
    }
    @Override public void visit(    @NotNull DependencyExportedChange change){
      if (id.equals(change.getEntityId())) {
        exportedChangeRef.set(change);
      }
    }
  }
;
  for (  ExternalProjectStructureChange change : changes) {
    if (scopeChangeRef.get() != null && exportedChangeRef.get() != null) {
      break;
    }
    change.invite(visitor);
  }
  final DependencyScopeChange scopeChange=scopeChangeRef.get();
  final DependencyExportedChange exportedChange=exportedChangeRef.get();
  if (scopeChange == null && exportedChange == null) {
    return null;
  }
  MatrixControlBuilder builder=GradleUtil.getConflictChangeBuilder();
  if (scopeChange != null) {
    builder.addRow(ExternalSystemBundle.message("gradle.sync.change.dependency.scope.text"),scopeChange.getExternalValue(),scopeChange.getIdeValue());
  }
  if (exportedChange != null) {
    builder.addRow(ExternalSystemBundle.message("gradle.sync.change.dependency.exported.text"),exportedChange.getExternalValue(),exportedChange.getIdeValue());
  }
  return builder.build();
}
