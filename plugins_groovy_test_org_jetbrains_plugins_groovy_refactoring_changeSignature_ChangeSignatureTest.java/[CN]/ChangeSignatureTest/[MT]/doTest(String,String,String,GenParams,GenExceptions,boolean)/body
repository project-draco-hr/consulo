{
  myFixture.configureByFile(getTestName(false) + ".groovy");
  final PsiElement targetElement=TargetElementUtilBase.findTargetElement(myFixture.getEditor(),TargetElementUtilBase.ELEMENT_NAME_ACCEPTED);
  assertTrue("<caret> is not on method name",targetElement instanceof GrMethod);
  GrMethod method=(GrMethod)targetElement;
  final PsiElementFactory factory=JavaPsiFacade.getInstance(getProject()).getElementFactory();
  PsiType newType=newReturnType != null ? factory.createTypeFromText(newReturnType,method) : method.getReturnType();
  GrChangeInfoImpl changeInfo=new GrChangeInfoImpl(method,newVisibility,CanonicalTypes.createTypeWrapper(newType),newName != null ? newName : method.getName(),Arrays.asList(genParams.genParams(method)));
  new GrChangeSignatureProcessor(getProject(),changeInfo).run();
  myFixture.checkResultByFile(getTestName(false) + "_after.groovy");
}
