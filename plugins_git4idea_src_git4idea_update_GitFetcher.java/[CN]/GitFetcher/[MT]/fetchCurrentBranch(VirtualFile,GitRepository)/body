{
  GitBranch currentBranch=repository.getCurrentBranch();
  if (currentBranch == null) {
    String message="Current branch can't be null here. \nRepository: " + repository;
    LOG.error(message);
    return GitFetchResult.error(new Exception(message));
  }
  GitBranchTrackInfo trackInfo=GitBranchUtil.getTrackInfoForBranch(repository,currentBranch);
  if (trackInfo == null) {
    String message="Tracked info is null for branch " + currentBranch + "\n Repository: "+ repository;
    LOG.error(message);
    return GitFetchResult.error(new Exception(message));
  }
  GitRemote remote=trackInfo.getRemote();
  String url=remote.getFirstUrl();
  if (url == null) {
    String message="URL is null for remote " + remote.getName();
    LOG.error(message);
    return GitFetchResult.error(new Exception(message));
  }
  String remoteBranch=trackInfo.getRemoteBranch();
  if (GitHttpAdapter.shouldUseJGit(url)) {
    return GitHttpAdapter.fetch(repository,remote,url,remoteBranch);
  }
  return fetchNatively(root,remote,remoteBranch);
}
