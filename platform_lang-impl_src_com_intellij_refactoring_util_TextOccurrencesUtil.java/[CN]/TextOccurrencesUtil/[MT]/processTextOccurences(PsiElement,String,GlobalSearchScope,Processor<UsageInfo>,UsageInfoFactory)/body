{
  PsiSearchHelper helper=ApplicationManager.getApplication().runReadAction(new Computable<PsiSearchHelper>(){
    @Override public PsiSearchHelper compute(){
      return PsiSearchHelper.SERVICE.getInstance(element.getProject());
    }
  }
);
  return helper.processUsagesInNonJavaFiles(element,stringToSearch,new PsiNonJavaFileReferenceProcessor(){
    @Override public boolean process(    PsiFile psiFile,    int startOffset,    int endOffset){
      UsageInfo usageInfo=factory.createUsageInfo(psiFile,startOffset,endOffset);
      return usageInfo == null || processor.process(usageInfo);
    }
  }
,searchScope);
}
