{
  if (searchInStringsAndComments || searchInNonJavaFiles) {
    UsageInfoFactory factory=createUsageInfoFactory(element,newQName);
    if (searchInStringsAndComments) {
      addUsagesInStringsAndComments(element,stringToSearch,results,factory);
    }
    if (searchInNonJavaFiles) {
      GlobalSearchScope projectScope=GlobalSearchScope.projectScope(element.getProject());
      addTextOccurences(element,stringToSearch,projectScope,results,factory);
    }
  }
}
