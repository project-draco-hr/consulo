{
  ApplicationManager.getApplication().runReadAction(new Runnable(){
    public void run(){
      final VirtualFile vcsRoot=myVcsManager.getVcsRootFor(newcomer);
      myAffectedContentRoots.add(vcsRoot);
      THashSet<FilePath> dirsByRoot=myDirtyDirectoriesRecursively.get(vcsRoot);
      if (dirsByRoot != null) {
        for (        FilePath oldBoy : dirsByRoot) {
          if (newcomer.isUnder(oldBoy,false)) {
            return;
          }
        }
      }
      if (newcomer.isDirectory()) {
        final List<FilePath> files=new ArrayList<FilePath>(myDirtyFiles);
        for (        FilePath oldBoy : files) {
          if (!oldBoy.isDirectory() && oldBoy.getVirtualFileParent() == newcomer.getVirtualFile()) {
            myDirtyFiles.remove(oldBoy);
          }
        }
      }
 else       if (myDirtyFiles.size() > 0) {
        VirtualFile parent=newcomer.getVirtualFileParent();
        if (parent != null && myDirtyFiles.contains(new FilePathImpl(parent))) {
          return;
        }
      }
      myDirtyFiles.add(newcomer);
    }
  }
);
}
