{
  return new FacetDetector<PsiFile,C>(detector.getId() + "-psi"){
    public C detectFacet(    final PsiFile source,    final Collection<C> existentFacetConfigurations){
      VirtualFile virtualFile=source.getVirtualFile();
      return virtualFile != null ? detector.detectFacet(virtualFile,existentFacetConfigurations) : null;
    }
    public void beforeFacetAdded(    @NotNull final Facet facet,    final FacetModel facetModel,    @NotNull final ModifiableRootModel modifiableRootModel){
      detector.beforeFacetAdded(facet,facetModel,modifiableRootModel);
    }
    public void afterFacetAdded(    @NotNull final Facet facet){
      detector.afterFacetAdded(facet);
    }
  }
;
}
