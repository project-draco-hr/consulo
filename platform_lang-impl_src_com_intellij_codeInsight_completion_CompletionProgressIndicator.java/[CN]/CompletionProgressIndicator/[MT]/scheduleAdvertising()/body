{
  ApplicationManager.getApplication().executeOnPooledThread(new Runnable(){
    public void run(){
      if (myEditor.isDisposed())       return;
      for (      final CompletionContributor contributor : CompletionContributor.forParameters(myParameters)) {
        if (myLookup.getAdvertisementText() != null)         return;
        if (!myLookup.isCalculating() && !myLookup.isVisible())         return;
        String s=ApplicationManager.getApplication().runReadAction(new Computable<String>(){
          public String compute(){
            return contributor.advertise(myParameters);
          }
        }
);
        if (myLookup.getAdvertisementText() != null)         return;
        if (s != null) {
          myLookup.setAdvertisementText(s);
          ApplicationManager.getApplication().invokeLater(new Runnable(){
            public void run(){
              if (myEditor.isDisposed() || myEditor.getComponent().getRootPane() == null) {
                return;
              }
              updateLookup();
            }
          }
,myQueue.getModalityState());
          return;
        }
      }
    }
  }
);
}
