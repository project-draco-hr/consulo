{
  if (!isRunning())   return;
  ProgressManager.checkCanceled();
  final boolean unitTestMode=ApplicationManager.getApplication().isUnitTestMode();
  if (!unitTestMode) {
    LOG.assertTrue(!ApplicationManager.getApplication().isDispatchThread());
  }
  LOG.assertTrue(myParameters.getPosition().isValid());
  myItemSorters.put(item.getLookupElement(),(CompletionSorterImpl)item.getSorter());
  myLookup.addItem(item.getLookupElement(),item.getPrefixMatcher());
  myCount++;
  if (myCount == 1) {
    addWatchedPrefix(myParameters.getOffset() - item.getPrefixMatcher().getPrefix().length(),StandardPatterns.string().withLength(2));
    new Alarm(Alarm.ThreadToUse.SHARED_THREAD,this).addRequest(new Runnable(){
      @Override public void run(){
        myFreezeSemaphore.up();
      }
    }
,300);
  }
  myQueue.queue(myUpdate);
}
