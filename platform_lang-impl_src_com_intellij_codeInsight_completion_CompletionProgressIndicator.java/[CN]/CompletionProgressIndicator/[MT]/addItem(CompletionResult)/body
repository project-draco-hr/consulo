{
  if (!isRunning())   return;
  ProgressManager.checkCanceled();
  final boolean unitTestMode=ApplicationManager.getApplication().isUnitTestMode();
  if (!unitTestMode) {
    LOG.assertTrue(!ApplicationManager.getApplication().isDispatchThread());
  }
  LOG.assertTrue(myParameters.getPosition().isValid());
  myItemSorters.put(item.getLookupElement(),(CompletionSorterImpl)item.getSorter());
  myLookup.addItem(item.getLookupElement(),item.getPrefixMatcher());
  myCount++;
  if (myCount == 1 && !ApplicationManager.getApplication().isUnitTestMode()) {
    ApplicationManager.getApplication().executeOnPooledThread(new Runnable(){
      public void run(){
        try {
          Thread.sleep(300);
        }
 catch (        InterruptedException e) {
          LOG.error(e);
        }
        myFreezeSemaphore.up();
      }
    }
);
  }
  myQueue.queue(myUpdate);
}
