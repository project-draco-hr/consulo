{
  if (!isRunning())   return;
  ProgressManager.checkCanceled();
  final boolean unitTestMode=ApplicationManager.getApplication().isUnitTestMode();
  if (!unitTestMode) {
    LOG.assertTrue(!ApplicationManager.getApplication().isDispatchThread());
  }
  LOG.assertTrue(myParameters.getPosition().isValid());
  LookupElement delegate=item.getDelegate();
  myItemSorters.put(delegate,item.getSorter());
  myLookup.addItem(delegate);
  myCount++;
  if (unitTestMode)   return;
  if (myCount == 1) {
    ApplicationManager.getApplication().executeOnPooledThread(new Runnable(){
      public void run(){
        try {
          Thread.sleep(300);
        }
 catch (        InterruptedException e) {
          LOG.error(e);
        }
        myFreezeSemaphore.up();
      }
    }
);
  }
  myQueue.queue(myUpdate);
}
