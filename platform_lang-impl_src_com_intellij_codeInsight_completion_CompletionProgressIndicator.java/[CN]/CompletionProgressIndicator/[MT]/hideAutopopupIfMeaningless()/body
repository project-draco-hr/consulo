{
  if (!myLookup.isLookupDisposed() && isAutopopupCompletion() && !myLookup.isSelectionTouched()&& !myLookup.isCalculating()) {
    myLookup.refreshUi(true);
    final List<LookupElement> items=myLookup.getItems();
    for (    LookupElement item : items) {
      if (!myLookup.itemPattern(item).equals(item.getLookupString())) {
        return false;
      }
      if (item.isValid()) {
        final LookupElementPresentation presentation=new LookupElementPresentation();
        item.renderElement(presentation);
        if (StringUtil.isNotEmpty(presentation.getTailText())) {
          return false;
        }
      }
    }
    myLookup.hideLookup(false);
    LOG.assertTrue(CompletionServiceImpl.getCompletionService().getCurrentCompletion() == null);
    CompletionServiceImpl.setCompletionPhase(new CompletionPhase.EmptyAutoPopup(this));
    return true;
  }
  return false;
}
