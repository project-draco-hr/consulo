{
  LOG.assertTrue(!isAutopopupCompletion());
  if (ApplicationManager.getApplication().isUnitTestMode() || !myHandler.invokedExplicitly) {
    CompletionServiceImpl.setCompletionPhase(CompletionPhase.NoCompletion);
    return;
  }
  for (  final CompletionContributor contributor : CompletionContributor.forParameters(getParameters())) {
    final String text=contributor.handleEmptyLookup(getParameters(),getEditor());
    if (StringUtil.isNotEmpty(text)) {
      LightweightHint hint=showErrorHint(getProject(),getEditor(),text);
      CompletionServiceImpl.setCompletionPhase(awaitSecondInvocation ? new CompletionPhase.NoSuggestionsHint(hint,this) : CompletionPhase.NoCompletion);
      return;
    }
  }
  CompletionServiceImpl.setCompletionPhase(CompletionPhase.NoCompletion);
}
