{
  String classifier=null;
  String extension=null;
  if (artifactType != null) {
    Pair<String,String> result=project.getClassifierAndExtension(artifact,artifactType);
    classifier=result.first;
    extension=result.second;
  }
  String newPath=artifact.getPathForExtraArtifact(classifier,extension);
  String newUrl=VirtualFileManager.constructUrl(JarFileSystem.PROTOCOL,newPath) + JarFileSystem.JAR_SEPARATOR;
  for (  String url : library.getUrls(type)) {
    if (newUrl.equals(url))     return;
    if (clearAll || isRepositoryUrl(artifact,url,classifier,extension)) {
      library.removeRoot(url,type);
    }
  }
  library.addRoot(newUrl,type);
}
