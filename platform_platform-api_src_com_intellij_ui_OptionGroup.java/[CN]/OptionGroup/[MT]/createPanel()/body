{
  JPanel panel=new JPanel();
  panel.setLayout(new GridBagLayout());
  for (int i=0; i < myOptions.size(); i++) {
    int leftInset=Boolean.TRUE.equals(myIsShifted.get(i)) ? 15 : 5;
    Object option=myOptions.get(i);
    if (option instanceof JComponent) {
      JComponent component=(JComponent)option;
      int verticalInset=component instanceof JLabel || component instanceof JTextField ? 2 : 0;
      panel.add(component,new GridBagConstraints(0,i,GridBagConstraints.REMAINDER,1,1,0,GridBagConstraints.WEST,getFill(component),new Insets(verticalInset,leftInset,verticalInset,5),0,0));
    }
 else {
      Pair pair=(Pair)option;
      JComponent firstComponent=(JComponent)pair.first;
      int verticalInset=firstComponent instanceof JLabel || firstComponent instanceof JTextField ? 1 : 0;
      panel.add(firstComponent,new GridBagConstraints(0,i,1,1,1,0,GridBagConstraints.WEST,getFill(firstComponent),new Insets(verticalInset,leftInset,verticalInset,5),0,0));
      JComponent secondComponent=(JComponent)pair.second;
      verticalInset=secondComponent instanceof JLabel || secondComponent instanceof JTextField ? 2 : 0;
      panel.add(secondComponent,new GridBagConstraints(1,i,1,1,1,0,GridBagConstraints.EAST,GridBagConstraints.HORIZONTAL,new Insets(verticalInset,5,verticalInset,5),0,0));
    }
  }
  JPanel p=new JPanel();
  p.setPreferredSize(new Dimension(0,0));
  panel.add(p,new GridBagConstraints(0,myOptions.size(),GridBagConstraints.REMAINDER,1,0,1,GridBagConstraints.NORTH,GridBagConstraints.NONE,new Insets(0,0,0,0),0,0));
  if (myTitle != null) {
    IdeaTitledBorder titledBorder=IdeBorderFactory.createTitledBorder(myTitle,true);
    panel.setBorder(titledBorder);
    titledBorder.acceptMinimumSize(panel);
  }
  return panel;
}
