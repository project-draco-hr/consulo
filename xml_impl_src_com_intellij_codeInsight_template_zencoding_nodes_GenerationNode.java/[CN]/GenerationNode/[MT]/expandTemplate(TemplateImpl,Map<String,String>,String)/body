{
  LiveTemplateBuilder builder=new LiveTemplateBuilder();
  if (predefinedVarValues == null && surroundedText == null) {
    return new TemplateInvokation(template,predefinedVarValues);
  }
  int offset=builder.insertTemplate(0,template,predefinedVarValues);
  if (surroundedText != null) {
    builder.insertText(offset,surroundedText);
  }
  if (offset < builder.length()) {
    builder.insertVariableSegment(offset,TemplateImpl.END);
  }
  return new TemplateInvokation(builder.buildTemplate(),builder.getPredefinedValues());
}
