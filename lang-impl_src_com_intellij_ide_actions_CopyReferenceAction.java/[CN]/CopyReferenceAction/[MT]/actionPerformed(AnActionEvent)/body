{
  DataContext dataContext=e.getDataContext();
  Editor editor=PlatformDataKeys.EDITOR.getData(dataContext);
  Project project=PlatformDataKeys.PROJECT.getData(dataContext);
  PsiElement element=getElementToCopy(editor,dataContext);
  if (!doCopy(element,project))   return;
  HighlightManager highlightManager=HighlightManager.getInstance(project);
  EditorColorsManager manager=EditorColorsManager.getInstance();
  TextAttributes attributes=manager.getGlobalScheme().getAttributes(EditorColors.SEARCH_RESULT_ATTRIBUTES);
  if (editor != null) {
    PsiElement toHighlight=HighlightUsagesHandler.getNameIdentifier(element);
    if (toHighlight == null)     toHighlight=element;
    highlightManager.addOccurrenceHighlights(editor,new PsiElement[]{toHighlight},attributes,true,null);
  }
}
