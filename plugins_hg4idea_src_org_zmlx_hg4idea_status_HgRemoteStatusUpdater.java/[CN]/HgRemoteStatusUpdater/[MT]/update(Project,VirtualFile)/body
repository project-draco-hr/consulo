{
  if (!isCheckingEnabled() || myUpdateStarted.get()) {
    return;
  }
  myUpdateStarted.set(true);
  ApplicationManager.getApplication().invokeLater(new Runnable(){
    public void run(){
      new Task.Backgroundable(project,getProgressTitle(),true){
        public void run(        @NotNull ProgressIndicator indicator){
          if (project.isDisposed())           return;
          final VirtualFile[] roots=root != null ? new VirtualFile[]{root} : ProjectLevelVcsManager.getInstance(project).getRootsUnderVcs(myVcs);
          if (myProjectSettings.isCheckIncomingOutgoing()) {
            updateChangesetStatus(project,roots,myIncomingStatus,true);
            updateChangesetStatus(project,roots,myOutgoingStatus,false);
          }
          project.getMessageBus().syncPublisher(HgVcs.STATUS_TOPIC).update(project,null);
          indicator.stop();
          myUpdateStarted.set(false);
        }
      }
.queue();
    }
  }
);
}
