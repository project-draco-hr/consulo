{
  if (!isCheckingEnabled() || myUpdateStarted.get()) {
    return;
  }
  myUpdateStarted.set(true);
  ApplicationManager.getApplication().invokeLater(new Runnable(){
    public void run(){
      new Task.Backgroundable(project,getProgressTitle(),true){
        public void run(        @NotNull ProgressIndicator indicator){
          if (project.isDisposed())           return;
          VirtualFile[] roots=ProjectLevelVcsManager.getInstance(project).getRootsUnderVcs(myVcs);
          if (myProjectSettings.isCheckIncoming()) {
            updateChangesetStatus(project,roots,myIncomingStatus,true);
          }
          if (myProjectSettings.isCheckOutgoing()) {
            updateChangesetStatus(project,roots,myOutgoingStatus,false);
          }
          project.getMessageBus().syncPublisher(HgVcs.STATUS_TOPIC).update(project);
          indicator.stop();
          myUpdateStarted.set(false);
        }
      }
.queue();
    }
  }
);
}
