{
  int offset=editor.getCaretModel().getOffset();
  while (offset > 1 && Character.isJavaIdentifierPart(charsSequence.charAt(offset - 1)))   offset--;
  final CompletionData data=new CompletionData();
  int endOffset=offset;
  data.startOffset=offset;
  while (charsSequence.length() > endOffset && Character.isJavaIdentifierPart(charsSequence.charAt(endOffset)) && endOffset < editor.getDocument().getTextLength()) {
    if (endOffset == editor.getCaretModel().getOffset()) {
      data.myPrefix=charsSequence.subSequence(offset,endOffset).toString();
    }
    endOffset++;
  }
  data.myWordUnderCursor=charsSequence.subSequence(offset,endOffset).toString();
  if (data.myPrefix == null)   data.myPrefix=data.myWordUnderCursor;
  return data;
}
