{
  PsiElement child=null;
  if (lastParent != null && lastParent.getParent() == thisElement) {
    child=lastParent.getPrevSibling();
    if (child == null)     return true;
  }
  if (child == null) {
    child=thisElement.getLastChild();
  }
  while (child != null) {
    if (!processScope(child,processor,substitutor,null,place))     return false;
    child=child.getPrevSibling();
  }
  return true;
}
