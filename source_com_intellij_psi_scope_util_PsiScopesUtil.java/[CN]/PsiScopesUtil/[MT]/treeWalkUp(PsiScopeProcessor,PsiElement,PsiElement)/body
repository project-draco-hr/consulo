{
  PsiElement prevParent=entrance;
  PsiElement scope=entrance;
  PsiSubstitutor substitutor=PsiSubstitutor.EMPTY;
  while (scope != null) {
    if (scope instanceof PsiClass) {
      processor.handleEvent(PsiScopeProcessor.Event.SET_CURRENT_FILE_CONTEXT,scope);
    }
    if (!processScope(scope,processor,substitutor,prevParent,entrance))     return false;
    if (scope instanceof PsiModifierListOwner && !(scope instanceof PsiParameter)) {
      PsiModifierList modifierList=((PsiModifierListOwner)scope).getModifierList();
      if (modifierList != null && modifierList.hasModifierProperty(PsiModifier.STATIC)) {
        processor.handleEvent(PsiScopeProcessor.Event.START_STATIC,null);
      }
    }
    if (scope == maxScope)     break;
    prevParent=scope;
    scope=prevParent.getContext();
    processor.handleEvent(PsiScopeProcessor.Event.CHANGE_LEVEL,null);
  }
  return true;
}
