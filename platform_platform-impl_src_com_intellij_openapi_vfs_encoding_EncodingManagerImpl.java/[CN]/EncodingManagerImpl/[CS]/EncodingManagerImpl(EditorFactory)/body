{
  editorFactory.getEventMulticaster().addDocumentListener(new DocumentAdapter(){
    @Override public void documentChanged(    DocumentEvent e){
      Document document=e.getDocument();
      if (isEditorOpenedFor(document)) {
        queueUpdateEncodingFromContent(document);
      }
    }
  }
,this);
  editorFactory.addEditorFactoryListener(new EditorFactoryAdapter(){
    @Override public void editorCreated(    @NotNull EditorFactoryEvent event){
      queueUpdateEncodingFromContent(event.getEditor().getDocument());
    }
  }
,this);
}
