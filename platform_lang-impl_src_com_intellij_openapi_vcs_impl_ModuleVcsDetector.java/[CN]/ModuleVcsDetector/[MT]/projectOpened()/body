{
  if (ApplicationManager.getApplication().isUnitTestMode())   return;
  final StartupManager manager=StartupManager.getInstance(myProject);
  manager.registerStartupActivity(new Runnable(){
    public void run(){
      if (myVcsManager.needAutodetectMappings()) {
        autoDetectVcsMappings(true);
      }
      myVcsManager.updateActiveVcss();
    }
  }
);
  manager.registerPostStartupActivity(new Runnable(){
    public void run(){
      if (myMessageBus != null) {
        myConnection=myMessageBus.connect();
        final MyModulesListener listener=new MyModulesListener();
        myConnection.subscribe(ProjectTopics.MODULES,listener);
        myConnection.subscribe(ProjectTopics.PROJECT_ROOTS,listener);
      }
    }
  }
);
}
