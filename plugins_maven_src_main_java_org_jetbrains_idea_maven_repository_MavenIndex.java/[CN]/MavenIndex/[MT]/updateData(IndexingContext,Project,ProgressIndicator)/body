{
  progress.setText2("Updating caches...");
  Set<String> groupIds=new HashSet<String>();
  Set<String> artifactIds=new HashSet<String>();
  Set<String> versions=new HashSet<String>();
  Map<String,Set<String>> artifactIdsMap=new HashMap<String,Set<String>>();
  Map<String,Set<String>> versionsMap=new HashMap<String,Set<String>>();
  doUpdateIndexData(context,project,groupIds,artifactIds,versions,artifactIdsMap,versionsMap,progress);
  IndexData oldData;
  String oldDataDir;
synchronized (this) {
    oldData=myData;
    oldDataDir=myDataDir;
  }
  String newDataDir=findAvailableDataDir();
  IndexData newData=openData(newDataDir);
  progress.setText2("Saving caches...");
  for (  String each : groupIds)   newData.groupIds.add(each);
  for (  String each : artifactIds)   newData.artifactIds.add(each);
  for (  String each : versions)   newData.versions.add(each);
  for (  Map.Entry<String,Set<String>> each : artifactIdsMap.entrySet()) {
    newData.artifactIdsMap.put(each.getKey(),each.getValue());
  }
  for (  Map.Entry<String,Set<String>> each : versionsMap.entrySet()) {
    newData.versionsMap.put(each.getKey(),each.getValue());
  }
  newData.flush();
synchronized (this) {
    myData=newData;
    myDataDir=newDataDir;
    oldData.close();
    FileUtil.delete(getDataDir(oldDataDir));
  }
}
