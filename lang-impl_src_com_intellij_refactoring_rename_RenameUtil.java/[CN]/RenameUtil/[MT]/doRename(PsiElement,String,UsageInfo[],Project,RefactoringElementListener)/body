{
  try {
    for (    RenamePsiElementProcessor processor : Extensions.getExtensions(RenamePsiElementProcessor.EP_NAME)) {
      if (processor.canProcessElement(element)) {
        processor.renameElement(element,newName,usages,listener);
        return;
      }
    }
    doRenameGenericNamedElement(element,newName,usages,listener);
  }
 catch (  final IncorrectOperationException e) {
    if (ApplicationManager.getApplication().isUnitTestMode()) {
      throw new RuntimeException(e);
    }
    ApplicationManager.getApplication().invokeLater(new Runnable(){
      public void run(){
        CommonRefactoringUtil.showErrorMessage(RefactoringBundle.message("rename.title"),e.getMessage(),null,project);
      }
    }
);
  }
}
