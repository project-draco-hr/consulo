{
  try {
    setStatus(ConnectionStatus.WAITING_FOR_CONNECTION,null);
    LOG.debug("waiting for connection on port " + myPort);
    final Socket socket=myServerSocket.accept();
    try {
      setStatus(ConnectionStatus.CONNECTED,null);
      LOG.debug("connected");
      final OutputStream outputStream=socket.getOutputStream();
      final InputStream inputStream=socket.getInputStream();
      myResponseProcessor.startReading(myExternalizerFactory.createResponseReader(inputStream));
      processRequests(myExternalizerFactory.createRequestWriter(outputStream));
    }
  finally {
      socket.close();
    }
  }
  finally {
    myServerSocket.close();
  }
}
