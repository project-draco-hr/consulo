{
  if (id == parentId) {
    LOG.error("Cyclic parent-child relations for file: " + file);
    return;
  }
  String name=file.getName();
  if (name.length() > 0 && namesEqual(delegate,name,FSRecords.getName(id)))   return;
  if (name.length() == 0) {
    if (areChildrenLoaded(id))     return;
  }
  FSRecords.setParent(id,parentId);
  FSRecords.setName(id,name);
  FSRecords.setTimestamp(id,delegate.getTimeStamp(file));
  FSRecords.setFlags(id,(delegate.isDirectory(file) ? IS_DIRECTORY_FLAG : 0) | (delegate.isWritable(file) ? 0 : IS_READ_ONLY),true);
  FSRecords.setLength(id,-1L);
}
