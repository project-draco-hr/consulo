{
  if (id == parentId) {
    LOG.error("Cyclic parent-child relations for file: " + file);
    return;
  }
  String name=file.getName();
  if (name.length() > 0 && namesEqual(delegate,name,FSRecords.getName(id)))   return;
  if (name.length() == 0) {
    if (areChildrenLoaded(id))     return;
  }
  FSRecords.setParent(id,parentId);
  FSRecords.setName(id,name);
  delegate=replaceWithNativeFS(delegate);
  FSRecords.setTimestamp(id,delegate.getTimeStamp(file));
  boolean directory=delegate.isDirectory(file);
  FSRecords.setLength(id,directory ? -1L : delegate.getLength(file));
  FSRecords.setFlags(id,(directory ? IS_DIRECTORY_FLAG : 0) | (delegate.isWritable(file) ? 0 : IS_READ_ONLY) | (delegate.isSymLink(file) ? IS_SYMLINK : 0)| (delegate.isSpecialFile(file) ? IS_SPECIAL : 0),true);
}
