{
  String name=file.getName();
  if (!name.isEmpty() && namesEqual(delegate,name,FSRecords.getName(id)))   return false;
  if (name.isEmpty()) {
    if (areChildrenLoaded(id))     return false;
  }
  FSRecords.setParent(id,parentId);
  FSRecords.setName(id,name);
  delegate=replaceWithNativeFS(delegate);
  FSRecords.setTimestamp(id,delegate.getTimeStamp(file));
  boolean isDir=(attributes & FileUtil.BA_DIRECTORY) != 0;
  FSRecords.setLength(id,isDir ? -1L : delegate.getLength(file));
  boolean isSpecial=(attributes & (FileUtil.BA_REGULAR | FileUtil.BA_DIRECTORY | FileUtil.BA_EXISTS)) == FileUtil.BA_EXISTS;
  FSRecords.setFlags(id,(isDir ? IS_DIRECTORY_FLAG : 0) | (delegate.isWritable(file) ? 0 : IS_READ_ONLY) | (delegate.isSymLink(file) ? IS_SYMLINK : 0)| (isSpecial ? IS_SPECIAL : 0),true);
  return true;
}
