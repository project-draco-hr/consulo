{
  final VirtualFile canonicalFile=file.getCanonicalFile();
  if (canonicalFile == null) {
    throw new IOException("Broken link: " + file);
  }
  return canonicalFile;
}
