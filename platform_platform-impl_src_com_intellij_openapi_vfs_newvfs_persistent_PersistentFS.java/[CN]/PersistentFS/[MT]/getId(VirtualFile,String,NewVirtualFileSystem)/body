{
  final int parentId=getFileId(parent);
  final int[] children=FSRecords.list(parentId);
  for (  final int childId : children) {
    if (namesEqual(delegate,childName,FSRecords.getName(childId)))     return childId;
  }
  VirtualFile fake=new FakeVirtualFile(parent,childName);
  int attributes=delegate.getBooleanAttributes(fake,NewVirtualFileSystem.BA_EXISTS | NewVirtualFileSystem.BA_DIRECTORY);
  if ((attributes & NewVirtualFileSystem.BA_EXISTS) != 0) {
    boolean isDir=(attributes & NewVirtualFileSystem.BA_DIRECTORY) != 0;
    int child=createAndCopyRecord(delegate,fake,parentId,isDir);
    FSRecords.updateList(parentId,ArrayUtil.append(children,child));
    return child;
  }
  return 0;
}
