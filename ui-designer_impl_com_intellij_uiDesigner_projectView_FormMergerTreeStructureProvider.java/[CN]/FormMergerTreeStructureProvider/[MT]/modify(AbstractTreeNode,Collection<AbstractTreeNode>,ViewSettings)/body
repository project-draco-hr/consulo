{
  if (parent.getValue() instanceof Form)   return children;
  boolean formsFound=false;
  for (  AbstractTreeNode node : children) {
    if (node.getValue() instanceof PsiFile) {
      PsiFile file=(PsiFile)node.getValue();
      if (file.getFileType() == StdFileTypes.GUI_DESIGNER_FORM) {
        formsFound=true;
        break;
      }
    }
  }
  if (!formsFound)   return children;
  ArrayList<AbstractTreeNode> result=new ArrayList<AbstractTreeNode>();
  ProjectViewNode[] copy=children.toArray(new ProjectViewNode[children.size()]);
  for (  ProjectViewNode element : copy) {
    if (element.getValue() instanceof PsiClass) {
      PsiClass aClass=((PsiClass)element.getValue());
      final String qName=aClass.getQualifiedName();
      if (qName == null)       continue;
      PsiFile[] forms=aClass.getManager().getSearchHelper().findFormsBoundToClass(qName);
      Collection<BasePsiNode<? extends PsiElement>> formNodes=findFormsIn(children,forms);
      if (formNodes.size() > 0) {
        Collection<PsiFile> formFiles=convertToFiles(formNodes);
        Collection<BasePsiNode<? extends PsiElement>> subNodes=new ArrayList<BasePsiNode<? extends PsiElement>>(formNodes);
        subNodes.add((BasePsiNode<? extends PsiElement>)element);
        result.add(new FormNode(myProject,new Form(aClass,formFiles),settings,subNodes));
        children.remove(element);
        children.removeAll(formNodes);
      }
    }
  }
  result.addAll(children);
  return result;
}
