{
  final FileViewProvider provider=((PsiManagerEx)manager).getFileManager().findViewProvider(file);
  ClsFileImpl psiFile=null;
  if (provider != null) {
    final PsiFile psi=provider.getPsi(provider.getBaseLanguage());
    if (psi instanceof PsiCompiledFile) {
      psiFile=(ClsFileImpl)psi;
    }
  }
  if (psiFile == null) {
    psiFile=new ClsFileImpl((PsiManagerImpl)manager,new ClassFileViewProvider(manager,file),true);
  }
  final StringBuilder buffer=new StringBuilder();
  psiFile.appendMirrorText(0,buffer);
  return buffer.toString();
}
