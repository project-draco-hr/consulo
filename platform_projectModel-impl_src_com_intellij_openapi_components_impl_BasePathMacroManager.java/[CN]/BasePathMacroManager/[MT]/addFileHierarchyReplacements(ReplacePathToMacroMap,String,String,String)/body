{
  if (path == null)   return;
  String macro="$" + macroName + "$";
  path=StringUtil.trimEnd(FileUtil.toSystemIndependentName(path),"/");
  boolean overwrite=true;
  while (StringUtil.isNotEmpty(path) && path.contains("/")) {
    result.addReplacement(path,macro,overwrite);
    if (path.equals(stopAt)) {
      break;
    }
    macro+="/..";
    overwrite=false;
    path=StringUtil.getPackageName(path,'/');
  }
}
