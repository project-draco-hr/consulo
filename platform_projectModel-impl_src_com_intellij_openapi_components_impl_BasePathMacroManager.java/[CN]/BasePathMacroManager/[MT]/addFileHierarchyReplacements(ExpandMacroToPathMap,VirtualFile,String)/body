{
  if (f == null)   return;
  addFileHierarchyReplacements(result,f.getParent(),macro + "/..");
  final String path=FileUtil.toSystemIndependentName(f.getCanonicalPath());
  if (StringUtil.endsWithChar(path,'/')) {
    result.put(macro + "/",path);
    result.put(macro,path.substring(0,path.length() - 1));
  }
 else {
    result.put(macro,path);
  }
}
