{
  super.processMouseMotionEvent(e);
  if (MouseEvent.MOUSE_DRAGGED == e.getID()) {
    final Point newPoint=e.getPoint();
    SwingUtilities.convertPointToScreen(newPoint,this);
    final Rectangle screenBounds=WindowManagerEx.getInstanceEx().getScreenBounds();
    newPoint.x=Math.min(Math.max(newPoint.x,screenBounds.x),screenBounds.width);
    newPoint.y=Math.min(Math.max(newPoint.y,screenBounds.y),screenBounds.height);
    final Rectangle oldBounds=FloatingDecorator.this.getBounds();
    final Rectangle newBounds=new Rectangle(oldBounds);
    if ((myMotionMask & ANCHOR_TOP) > 0) {
      newPoint.y=Math.min(newPoint.y,oldBounds.y + oldBounds.height - 2 * DIVIDER_WIDTH);
      if (newPoint.y < screenBounds.y + DIVIDER_WIDTH) {
        newPoint.y=screenBounds.y;
      }
      final Point offset=new Point(newPoint.x - myLastPoint.x,newPoint.y - myLastPoint.y);
      newBounds.y=oldBounds.y + offset.y;
      newBounds.height=oldBounds.height - offset.y;
    }
    if ((myMotionMask & ANCHOR_LEFT) > 0) {
      newPoint.x=Math.min(newPoint.x,oldBounds.x + oldBounds.width - 2 * DIVIDER_WIDTH);
      if (newPoint.x < screenBounds.x + DIVIDER_WIDTH) {
        newPoint.x=screenBounds.x;
      }
      final Point offset=new Point(newPoint.x - myLastPoint.x,newPoint.y - myLastPoint.y);
      newBounds.x=oldBounds.x + offset.x;
      newBounds.width=oldBounds.width - offset.x;
    }
    if ((myMotionMask & ANCHOR_BOTTOM) > 0) {
      newPoint.y=Math.max(newPoint.y,oldBounds.y + 2 * DIVIDER_WIDTH);
      if (newPoint.y > screenBounds.height - DIVIDER_WIDTH) {
        newPoint.y=screenBounds.height;
      }
      final Point offset=new Point(newPoint.x - myLastPoint.x,newPoint.y - myLastPoint.y);
      newBounds.height=oldBounds.height + offset.y;
    }
    if ((myMotionMask & ANCHOR_RIGHT) > 0) {
      newPoint.x=Math.max(newPoint.x,oldBounds.x + 2 * DIVIDER_WIDTH);
      if (newPoint.x > screenBounds.width - DIVIDER_WIDTH) {
        newPoint.x=screenBounds.width;
      }
      final Point offset=new Point(newPoint.x - myLastPoint.x,newPoint.y - myLastPoint.y);
      newBounds.width=oldBounds.width + offset.x;
    }
    FloatingDecorator.this.getPeer().setBounds(newBounds.x,newBounds.y,newBounds.width,newBounds.height);
    myLastPoint=newPoint;
  }
 else   if (e.getID() == MouseEvent.MOUSE_MOVED) {
    if (!myDragging) {
      setMotionMask(e.getPoint());
    }
  }
}
