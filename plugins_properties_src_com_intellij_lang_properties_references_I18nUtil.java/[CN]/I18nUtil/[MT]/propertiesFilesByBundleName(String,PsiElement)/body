{
  PsiFile containingFile=context.getContainingFile();
  PsiElement containingFileContext=InjectedLanguageManager.getInstance(containingFile.getProject()).getInjectionHost(containingFile);
  if (containingFileContext != null)   containingFile=containingFileContext.getContainingFile();
  VirtualFile virtualFile=containingFile.getVirtualFile();
  if (virtualFile == null) {
    virtualFile=containingFile.getOriginalFile().getVirtualFile();
  }
  if (virtualFile != null) {
    Project project=containingFile.getProject();
    final Module module=ProjectRootManager.getInstance(project).getFileIndex().getModuleForFile(virtualFile);
    if (module != null) {
      PropertiesReferenceManager refManager=PropertiesReferenceManager.getInstance(project);
      return refManager.findPropertiesFiles(module,resourceBundleName);
    }
  }
  return Collections.emptyList();
}
