{
  PsiFile containingFile=context.getContainingFile();
  PsiElement containingFileContext=containingFile.getContext();
  if (containingFileContext != null)   containingFile=containingFileContext.getContainingFile();
  VirtualFile virtualFile=containingFile.getVirtualFile();
  if (virtualFile == null) {
    final PsiFile originalFile=containingFile.getOriginalFile();
    if (originalFile != null) {
      virtualFile=originalFile.getVirtualFile();
    }
  }
  if (virtualFile != null) {
    final Module module=ProjectRootManager.getInstance(context.getProject()).getFileIndex().getModuleForFile(virtualFile);
    if (module != null) {
      PropertiesReferenceManager refManager=context.getProject().getComponent(PropertiesReferenceManager.class);
      return refManager.findPropertiesFiles(module,resourceBundleName);
    }
  }
  return Collections.emptyList();
}
