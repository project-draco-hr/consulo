{
  if (tag.getUserData(DO_NOT_VALIDATE_KEY) != null) {
    return;
  }
  final XmlAttribute[] attributes=tag.getAttributes();
  final boolean jspDirective=tag instanceof JspDirective;
  ProgressManager progressManager=ProgressManager.getInstance();
  for (  XmlAttribute tagAttribute : attributes) {
    progressManager.checkCanceled();
    if (attribute != tagAttribute && Comparing.strEqual(attribute.getName(),tagAttribute.getName())) {
      final String localName=attribute.getLocalName();
      if (jspDirective && IMPORT_ATTR_NAME.equals(localName))       continue;
      HighlightInfo highlightInfo=HighlightInfo.createHighlightInfo(getTagProblemInfoType(tag),XmlChildRole.ATTRIBUTE_NAME_FINDER.findChild(SourceTreeToPsiMap.psiElementToTree(attribute)),XmlErrorMessages.message("duplicate.attribute",localName));
      addToResults(highlightInfo);
      IntentionAction intentionAction=new RemoveAttributeIntentionFix(localName,attribute);
      QuickFixAction.registerQuickFixAction(highlightInfo,intentionAction);
    }
  }
}
