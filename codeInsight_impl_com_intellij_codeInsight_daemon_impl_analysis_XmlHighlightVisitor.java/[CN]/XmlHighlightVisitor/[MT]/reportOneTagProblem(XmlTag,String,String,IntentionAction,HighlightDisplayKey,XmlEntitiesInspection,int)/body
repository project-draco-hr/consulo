{
  boolean htmlTag=false;
  if (tag instanceof HtmlTag) {
    htmlTag=true;
    if (isAdditionallyDeclared(inspection.getAdditionalEntries(type),name))     return;
  }
  final InspectionProfile profile=InspectionProjectProfileManager.getInstance(tag.getProject()).getInspectionProfile(tag);
  final IntentionAction intentionAction=inspection.getIntentionAction(tag,name,type);
  if (htmlTag && profile.isToolEnabled(key)) {
    addElementsForTagWithManyQuickFixes(tag,localizedMessage,profile.getErrorLevel(key) == HighlightDisplayLevel.ERROR ? HighlightInfoType.ERROR : HighlightInfoType.WARNING,intentionAction,new EditInspectionToolsSettingsAction(key),basicIntention);
  }
 else   if (!htmlTag) {
    addElementsForTag(tag,localizedMessage,HighlightInfoType.WRONG_REF,basicIntention);
  }
}
