{
  if (ourDoJaxpTesting)   return;
  if (!checkTagIsClosed(tag))   return;
  if (!(tag.getParent() instanceof XmlTag)) {
    checkRootTag(tag);
  }
  if (myResult == null) {
    checkTagByDescriptor(tag);
  }
  if (myResult == null) {
    checkUnboundNamespacePrefix(tag,tag,tag.getNamespacePrefix());
  }
  if (myResult == null) {
    if (tag.getUserData(DO_NOT_VALIDATE_KEY) == null) {
      final XmlElementDescriptor descriptor=tag.getDescriptor();
      if (tag instanceof HtmlTag && (descriptor instanceof AnyXmlElementDescriptor || descriptor == null)) {
        final String name=tag.getName();
        XmlEntitiesInspection inspection=getInspectionProfile(tag,HtmlStyleLocalInspection.SHORT_NAME);
        reportOneTagProblem(tag,name,XmlErrorMessages.message("unknown.html.tag",name),null,HighlightDisplayKey.find(HtmlStyleLocalInspection.SHORT_NAME),inspection,XmlEntitiesInspection.UNKNOWN_TAG);
        return;
      }
      checkReferences(tag,QuickFixProvider.NULL);
    }
  }
}
