{
  final PsiElement parent=value.getParent();
  if (!(parent instanceof XmlAttribute)) {
    checkReferences(value,QuickFixProvider.NULL);
    return;
  }
  XmlAttribute attribute=(XmlAttribute)parent;
  if (value.getUserData(DO_NOT_VALIDATE_KEY) != null) {
    return;
  }
  XmlTag tag=attribute.getParent();
  XmlElementDescriptor elementDescriptor=tag.getDescriptor();
  if (elementDescriptor == null)   return;
  XmlAttributeDescriptor attributeDescriptor=elementDescriptor.getAttributeDescriptor(attribute);
  if (attributeDescriptor == null)   return;
  String error=attributeDescriptor.validateValue(value,attribute.getValue());
  if (error != null) {
    addToResults(HighlightInfo.createHighlightInfo(getTagProblemInfoType(tag),value,error));
    return;
  }
  PsiReference[] refs=null;
  final RefCountHolder refCountHolder=myRefCountHolder;
  if (refCountHolder != null) {
    if (attributeDescriptor.hasIdType()) {
      if (doAddValueWithIdType(value,attribute,tag,refCountHolder,false))       return;
    }
 else {
      refs=value.getReferences();
      for (      PsiReference r : refs) {
        if (r instanceof IdReferenceProvider.GlobalAttributeValueSelfReference) {
          if (doAddValueWithIdType(value,attribute,tag,refCountHolder,r.isSoft()))           return;
        }
      }
    }
  }
  if (refs == null)   refs=value.getReferences();
  QuickFixProvider quickFixProvider=attributeDescriptor instanceof QuickFixProvider ? (QuickFixProvider)attributeDescriptor : QuickFixProvider.NULL;
  doCheckRefs(value,quickFixProvider,refs);
}
