{
  final MyDialogWrapper dialogWrapper=new MyDialogWrapper(parent);
  if (selection != null) {
    ApplicationManager.getApplication().invokeLater(new Runnable(){
      public void run(){
        for (        final Library library : selection) {
          selectLibrary(library,expandSelectedItems);
        }
      }
    }
,ModalityState.stateForComponent(dialogWrapper.getContentPane()));
  }
  dialogWrapper.show();
  return dialogWrapper.isOK() ? dialogWrapper.getSelectedLibraries() : null;
}
