{
  if (isUnboxingInBinaryExpressionApplicable(lType,rType,operation)) {
    if (rType instanceof PsiClassType) {
      rResult=new UnBoxingEvaluator(rResult);
    }
    if (lType instanceof PsiClassType) {
      lResult=new UnBoxingEvaluator(lResult);
    }
  }
  if (isBinaryNumericPromotionApplicable(lType,rType,operation)) {
    PsiType _lType=lType;
    final PsiPrimitiveType unboxedLType=PsiPrimitiveType.getUnboxedType(lType);
    if (unboxedLType != null) {
      _lType=unboxedLType;
    }
    PsiType _rType=rType;
    final PsiPrimitiveType unboxedRType=PsiPrimitiveType.getUnboxedType(rType);
    if (unboxedRType != null) {
      _rType=unboxedRType;
    }
    if (PsiType.DOUBLE.equals(_lType)) {
      if (TypeConversionUtil.areTypesConvertible(_rType,PsiType.DOUBLE)) {
        rResult=new TypeCastEvaluator(rResult,PsiType.DOUBLE.getCanonicalText(),true);
      }
    }
 else     if (PsiType.DOUBLE.equals(_rType)) {
      if (TypeConversionUtil.areTypesConvertible(_lType,PsiType.DOUBLE)) {
        lResult=new TypeCastEvaluator(lResult,PsiType.DOUBLE.getCanonicalText(),true);
      }
    }
 else     if (PsiType.FLOAT.equals(_lType)) {
      if (TypeConversionUtil.areTypesConvertible(_rType,PsiType.FLOAT)) {
        rResult=new TypeCastEvaluator(rResult,PsiType.FLOAT.getCanonicalText(),true);
      }
    }
 else     if (PsiType.FLOAT.equals(_rType)) {
      if (TypeConversionUtil.areTypesConvertible(_lType,PsiType.FLOAT)) {
        lResult=new TypeCastEvaluator(lResult,PsiType.FLOAT.getCanonicalText(),true);
      }
    }
 else     if (PsiType.LONG.equals(_lType)) {
      if (TypeConversionUtil.areTypesConvertible(_rType,PsiType.LONG)) {
        rResult=new TypeCastEvaluator(rResult,PsiType.LONG.getCanonicalText(),true);
      }
    }
 else     if (PsiType.LONG.equals(_rType)) {
      if (TypeConversionUtil.areTypesConvertible(_lType,PsiType.LONG)) {
        lResult=new TypeCastEvaluator(lResult,PsiType.LONG.getCanonicalText(),true);
      }
    }
 else {
      if (!PsiType.INT.equals(_lType) && TypeConversionUtil.areTypesConvertible(_lType,PsiType.INT)) {
        lResult=new TypeCastEvaluator(lResult,PsiType.INT.getCanonicalText(),true);
      }
      if (!PsiType.INT.equals(_rType) && TypeConversionUtil.areTypesConvertible(_rType,PsiType.INT)) {
        rResult=new TypeCastEvaluator(rResult,PsiType.INT.getCanonicalText(),true);
      }
    }
  }
  return new BinaryExpressionEvaluator(lResult,rResult,operation,expressionExpectedType.getCanonicalText());
}
