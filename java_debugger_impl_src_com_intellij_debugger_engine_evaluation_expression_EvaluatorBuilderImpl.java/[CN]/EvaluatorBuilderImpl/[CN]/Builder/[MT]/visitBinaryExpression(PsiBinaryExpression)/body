{
  if (LOG.isDebugEnabled()) {
    LOG.debug("visitBinaryExpression " + expression);
  }
  final PsiExpression lOperand=expression.getLOperand();
  lOperand.accept(this);
  Evaluator lResult=myResult;
  final PsiExpression rOperand=expression.getROperand();
  if (rOperand == null) {
    throw new EvaluateRuntimeException(EvaluateExceptionUtil.createEvaluateException(DebuggerBundle.message("evaluation.error.invalid.expression",expression.getText())));
  }
  rOperand.accept(this);
  IElementType opType=expression.getOperationSign().getTokenType();
  PsiType type=expression.getType();
  if (type == null) {
    throw new EvaluateRuntimeException(EvaluateExceptionUtil.createEvaluateException(DebuggerBundle.message("evaluation.error.unknown.expression.type",expression.getText())));
  }
  final PsiType lType=lOperand.getType();
  final PsiType rType=rOperand.getType();
  if (TypeConversionUtil.boxingConversionApplicable(lType,rType)) {
    if (lType instanceof PsiPrimitiveType) {
      myResult=new UnBoxingEvaluator(myResult);
    }
 else     if (rType instanceof PsiPrimitiveType) {
      lResult=new UnBoxingEvaluator(lResult);
    }
  }
  myResult=new BinaryExpressionEvaluator(lResult,myResult,opType,type.getCanonicalText());
}
