{
  if (virtualFile.isDirectory())   return false;
  final FileDocumentManager fdm=FileDocumentManager.getInstance();
  final Document editorDocument=fdm.getCachedDocument(virtualFile);
  if (editorDocument != null && editorDocument.getModificationStamp() != virtualFile.getModificationStamp()) {
    return fdm.isDocumentUnsaved(editorDocument);
  }
  return false;
}
