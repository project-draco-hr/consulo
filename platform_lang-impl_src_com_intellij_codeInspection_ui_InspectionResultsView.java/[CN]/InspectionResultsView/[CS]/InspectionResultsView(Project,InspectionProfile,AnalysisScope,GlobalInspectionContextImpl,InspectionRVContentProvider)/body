{
  setLayout(new BorderLayout());
  myProject=project;
  myInspectionProfile=inspectionProfile;
  myScope=scope;
  myGlobalInspectionContext=globalInspectionContext;
  myProvider=provider;
  myTree=new InspectionTree(project);
  initTreeListeners();
  myOccurenceNavigator=initOccurenceNavigator();
  myBrowser=new Browser(this);
  mySplitter=new Splitter(false,AnalysisUIOptions.getInstance(myProject).SPLITTER_PROPORTION);
  mySplitter.setFirstComponent(ScrollPaneFactory.createScrollPane(myTree,SideBorder.LEFT | SideBorder.RIGHT));
  mySplitter.setSecondComponent(myBrowser);
  mySplitter.addPropertyChangeListener(new PropertyChangeListener(){
    public void propertyChange(    PropertyChangeEvent evt){
      if (Splitter.PROP_PROPORTION.equals(evt.getPropertyName())) {
        myGlobalInspectionContext.setSplitterProportion(((Float)evt.getNewValue()).floatValue());
      }
    }
  }
);
  add(mySplitter,BorderLayout.CENTER);
  myBrowser.addClickListener(new Browser.ClickListener(){
    public void referenceClicked(    final Browser.ClickEvent e){
      if (e.getEventType() == Browser.ClickEvent.REF_ELEMENT) {
        final RefElement refElement=e.getClickedElement();
        final OpenFileDescriptor descriptor=getOpenFileDescriptor(refElement);
        if (descriptor != null) {
          FileEditorManager.getInstance(project).openTextEditor(descriptor,false);
        }
      }
 else       if (e.getEventType() == Browser.ClickEvent.FILE_OFFSET) {
        final VirtualFile file=e.getFile();
        final OpenFileDescriptor descriptor=new OpenFileDescriptor(project,file,e.getStartOffset());
        final Editor editor=FileEditorManager.getInstance(project).openTextEditor(descriptor,true);
        if (editor != null) {
          final TextAttributes selectionAttributes=EditorColorsManager.getInstance().getGlobalScheme().getAttributes(EditorColors.SEARCH_RESULT_ATTRIBUTES);
          HighlightManager.getInstance(project).addRangeHighlight(editor,e.getStartOffset(),e.getEndOffset(),selectionAttributes,true,null);
        }
      }
    }
  }
);
  createActionsToolbar();
}
