{
  runManager.registerStepBeforeRun(ANT,new Function<RunConfiguration,String>(){
    public String fun(    final RunConfiguration runConfiguration){
      ExecuteBeforeRunEvent event=findExecuteBeforeRunEvent(runConfiguration);
      Pair<AntBuildFile,String> selectedTarget=myEventToTargetMap.get(event);
      final TargetChooserDialog dlg=new TargetChooserDialog(project,selectedTarget,AntConfigurationImpl.this);
      dlg.show();
      if (dlg.isOK()) {
        selectedTarget=dlg.getSelectedTarget();
        if (event == null) {
          event=new ExecuteBeforeRunEvent(runConfiguration.getType(),runConfiguration.getName());
        }
        if (selectedTarget != null) {
          myEventToTargetMap.put(event,selectedTarget);
        }
 else {
          myEventToTargetMap.remove(event);
        }
      }
      final String targetName=selectedTarget != null ? selectedTarget.getSecond() : null;
      return getPresentableDescription(targetName);
    }
  }
,new Function<RunConfiguration,String>(){
    public String fun(    final RunConfiguration runConfiguration){
      final ExecuteBeforeRunEvent event=findExecuteBeforeRunEvent(runConfiguration);
      final AntBuildTarget buildTarget=getTargetForEvent(event);
      return buildTarget != null ? getPresentableDescription(buildTarget.getName()) : "";
    }
  }
);
}
