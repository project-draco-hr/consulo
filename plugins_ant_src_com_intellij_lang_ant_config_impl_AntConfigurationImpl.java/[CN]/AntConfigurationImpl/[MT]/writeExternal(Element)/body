{
  getProperties().writeExternal(parentNode);
  final ActionRunner.InterruptibleRunnable action=new ActionRunner.InterruptibleRunnable(){
    public void run() throws WriteExternalException {
      for (      final AntBuildFile buildFile : getBuildFiles()) {
        Element element=new Element(BUILD_FILE);
        element.setAttribute(URL,buildFile.getVirtualFile().getUrl());
        ((AntBuildFileBase)buildFile).writeProperties(element);
        saveEvents(element,buildFile);
        parentNode.addContent(element);
      }
    }
  }
;
  try {
    ActionRunner.runInsideReadAction(action);
  }
 catch (  WriteExternalException e) {
    LOG.error(e);
    throw e;
  }
catch (  RuntimeException e) {
    LOG.error(e);
    throw e;
  }
catch (  Exception e) {
    LOG.error(e);
  }
}
