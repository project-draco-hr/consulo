{
  for (  final Object o : parentNode.getChildren(BUILD_FILE)) {
    final Element element=(Element)o;
    final String url=element.getAttributeValue(URL);
    VirtualFile file=VirtualFileManager.getInstance().findFileByUrl(url);
    if (file == null)     continue;
    PsiFile psiFile=myPsiManager.findFile(file);
    if (psiFile != null) {
      AntSupport.markFileAsAntFile(file,psiFile.getViewProvider(),true);
      psiFile=AntSupport.getAntFile(psiFile);
    }
    if (!(psiFile instanceof AntFile))     continue;
    AntBuildFileBase buildFile=new AntBuildFileImpl((AntFile)psiFile,this);
    buildFile.readProperties(element);
    myBuildFiles.add(buildFile);
    for (    final Object o1 : element.getChildren(EXECUTE_ON_ELEMENT)) {
      Element e=(Element)o1;
      String eventId=e.getAttributeValue(EVENT_ELEMENT);
      ExecutionEvent event=null;
      String targetName=e.getAttributeValue(TARGET_ELEMENT);
      if (ExecuteBeforeCompilationEvent.TYPE_ID.equals(eventId)) {
        event=ExecuteBeforeCompilationEvent.getInstance();
      }
 else       if (ExecuteAfterCompilationEvent.TYPE_ID.equals(eventId)) {
        event=ExecuteAfterCompilationEvent.getInstance();
      }
 else       if (ExecuteBeforeRunEvent.TYPE_ID.equals(eventId)) {
        event=new ExecuteBeforeRunEvent();
      }
 else       if (ExecuteCompositeTargetEvent.TYPE_ID.equals(eventId)) {
        try {
          event=new ExecuteCompositeTargetEvent(targetName);
        }
 catch (        WrongNameFormatException e1) {
          LOG.info(e1);
          event=null;
        }
      }
      if (event != null) {
        event.readExternal(e);
        setTargetForEvent(buildFile,targetName,event);
      }
    }
  }
}
