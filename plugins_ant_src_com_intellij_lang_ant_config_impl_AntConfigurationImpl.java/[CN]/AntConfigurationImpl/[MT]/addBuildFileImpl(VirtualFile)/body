{
  PsiFile xmlFile=myPsiManager.findFile(file);
  if (!(xmlFile instanceof XmlFile)) {
    throw new AntNoFileException("the file is not an xml file",file);
  }
  AntSupport.markFileAsAntFile(file,xmlFile.getProject(),true);
  if (!AntDomFileDescription.isAntFile(((XmlFile)xmlFile))) {
    throw new AntNoFileException("the file is not recognized as an ANT file",file);
  }
  final AntBuildFileImpl buildFile=new AntBuildFileImpl((XmlFile)xmlFile,this);
  xmlFile.putCopyableUserData(AntBuildFile.ANT_BUILD_FILE_KEY,buildFile);
synchronized (myBuildFiles) {
    myBuildFilesArray=null;
    myBuildFiles.add(buildFile);
  }
  return buildFile;
}
