{
  List<Element> events=null;
synchronized (myEventToTargetMap) {
    for (    final ExecutionEvent event : myEventToTargetMap.keySet()) {
      final Pair<AntBuildFile,String> pair=myEventToTargetMap.get(event);
      if (!buildFile.equals(pair.first)) {
        continue;
      }
      Element eventElement=new Element(EXECUTE_ON_ELEMENT);
      eventElement.setAttribute(EVENT_ELEMENT,event.getTypeId());
      eventElement.setAttribute(TARGET_ELEMENT,pair.second);
      event.writeExternal(eventElement);
      if (events == null) {
        events=new ArrayList<Element>();
      }
      events.add(eventElement);
    }
  }
  if (events != null) {
    Collections.sort(events,EventElementComparator.INSTANCE);
    for (    Element eventElement : events) {
      element.addContent(eventElement);
    }
  }
}
