{
  super(project);
  getProperties().registerProperty(DEFAULT_ANT,AntReference.EXTERNALIZER);
  getProperties().rememberKey(INSTANCE);
  getProperties().rememberKey(DEFAULT_JDK_NAME);
  INSTANCE.set(getProperties(),this);
  myAntWorkspaceConfiguration=antWorkspaceConfiguration;
  myPsiManager=PsiManager.getInstance(project);
  myStartupManager=StartupManager.getInstance(project);
  addAntConfigurationListener(new AntConfigurationListener(){
    public void configurationLoaded(){
      restartDaemon();
    }
    public void buildFileChanged(    final AntBuildFile buildFile){
      restartDaemon();
    }
    public void buildFileAdded(    final AntBuildFile buildFile){
      restartDaemon();
    }
    public void buildFileRemoved(    final AntBuildFile buildFile){
      restartDaemon();
    }
    private void restartDaemon(){
      if (ApplicationManager.getApplication().isDispatchThread()) {
        daemon.restart();
      }
 else {
        SwingUtilities.invokeLater(new Runnable(){
          public void run(){
            daemon.restart();
          }
        }
);
      }
    }
  }
);
}
