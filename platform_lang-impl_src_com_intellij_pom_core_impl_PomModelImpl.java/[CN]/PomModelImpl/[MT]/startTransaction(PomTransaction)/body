{
  final ProgressIndicator progressIndicator=ProgressManager.getInstance().getProgressIndicator();
  if (progressIndicator != null)   progressIndicator.startNonCancelableSection();
  final PsiDocumentManagerImpl manager=(PsiDocumentManagerImpl)PsiDocumentManager.getInstance(myProject);
  final PsiToDocumentSynchronizer synchronizer=manager.getSynchronizer();
  final PsiElement changeScope=transaction.getChangeScope();
  BlockSupportImpl.sendBeforeChildrenChangeEvent((PsiManagerImpl)PsiManager.getInstance(myProject),transaction.getChangeScope(),true);
  LOG.assertTrue(changeScope != null);
  final PsiFile containingFileByTree=getContainingFileByTree(changeScope);
  Document document=containingFileByTree == null ? null : manager.getCachedDocument(containingFileByTree);
  if (document != null) {
    synchronizer.startTransaction(myProject,document,transaction.getChangeScope());
  }
}
