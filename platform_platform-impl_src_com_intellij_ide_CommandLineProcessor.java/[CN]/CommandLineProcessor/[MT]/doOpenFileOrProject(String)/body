{
  final VirtualFile virtualFile=LocalFileSystem.getInstance().refreshAndFindFileByPath(name);
  if (virtualFile == null) {
    Messages.showErrorDialog("Cannot find file '" + name + "'","Cannot find file");
    return null;
  }
  ProjectOpenProcessor provider=ProjectOpenProcessor.getImportProvider(virtualFile);
  if (provider instanceof PlatformProjectOpenProcessor && !virtualFile.isDirectory()) {
    provider=null;
  }
  if (provider != null || name.endsWith(ProjectFileType.DOT_DEFAULT_EXTENSION) || new File(name,Project.DIRECTORY_STORE_FOLDER).exists()) {
    final Project result=ProjectUtil.openOrImport(name,null,true);
    if (result == null) {
      Messages.showErrorDialog("Cannot open project '" + name + "'","Cannot open project");
    }
    return result;
  }
 else {
    return doOpenFile(virtualFile,-1);
  }
}
