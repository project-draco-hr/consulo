{
  final Project[] projects=ProjectManager.getInstance().getOpenProjects();
  if (projects.length == 0) {
    return PlatformProjectOpenProcessor.doOpenProject(virtualFile,null,false,line,null);
  }
 else {
    Project project=findBestProject(virtualFile,projects);
    if (line == -1) {
      new OpenFileDescriptor(project,virtualFile).navigate(true);
    }
 else {
      new OpenFileDescriptor(project,virtualFile,line - 1,0).navigate(true);
    }
    return project;
  }
}
