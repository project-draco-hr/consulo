{
  BasicAction.saveAll();
  final GithubSettings settings=GithubSettings.getInstance();
  if (!GithubUtil.testConnection(settings.getLogin(),settings.getPassword())) {
    final GithubLoginDialog dialog=new GithubLoginDialog(project);
    dialog.show();
    if (!dialog.isOK()) {
      return;
    }
  }
  final List<RepositoryInfo> availableRepos=GithubUtil.getAvailableRepos(settings.getLogin(),settings.getPassword());
  Collections.sort(availableRepos,new Comparator<RepositoryInfo>(){
    @Override public int compare(    final RepositoryInfo r1,    final RepositoryInfo r2){
      return r1.getName().compareTo(r2.getName());
    }
  }
);
  final GithubCloneProjectDialog checkoutDialog=new GithubCloneProjectDialog(project,availableRepos);
  final File work=new File(System.getProperty("user.home"),"work");
  if (work.exists() && work.isDirectory()) {
    checkoutDialog.setSelectedPath(work.getPath());
  }
  checkoutDialog.show();
  if (!checkoutDialog.isOK()) {
    return;
  }
  final RepositoryInfo selectedRepository=checkoutDialog.getSelectedRepository();
  final String selectedPath=checkoutDialog.getSelectedPath();
  final VirtualFile selectedPathFile=LocalFileSystem.getInstance().findFileByPath(selectedPath);
  final String projectName=checkoutDialog.getProjectName();
  final String checkoutUrl="git@github.com:" + settings.getLogin() + "/"+ selectedRepository.getName()+ ".git";
  GitCheckoutProvider.checkout(project,listener,selectedPathFile,checkoutUrl,projectName,"master",selectedPath);
}
