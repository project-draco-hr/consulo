{
  if (ApplicationManager.getApplication().isUnitTestMode())   return null;
  if (new PsiMatcherImpl(keyword).dot(PsiMatcherImpl.hasText(PsiModifier.PUBLIC)).parent(PsiMatcherImpl.hasClass(PsiModifierList.class)).parent(PsiMatcherImpl.hasClass(PsiClass.class)).parent(PsiMatcherImpl.hasClass(PsiJavaFile.class)).getElement() == null) {
    return null;
  }
  PsiClass aClass=(PsiClass)keyword.getParent().getParent();
  PsiJavaFile file=(PsiJavaFile)aClass.getContainingFile();
  VirtualFile virtualFile=file.getVirtualFile();
  HighlightInfo errorResult=null;
  if (virtualFile != null && !aClass.getName().equals(virtualFile.getNameWithoutExtension()) && aClass.getNameIdentifier() != null) {
    String message=MessageFormat.format("Class ''{0}'' is public, should be declared in a file named ''{0}.java''",new Object[]{aClass.getName()});
    errorResult=HighlightInfo.createHighlightInfo(HighlightInfoType.ERROR,aClass.getNameIdentifier(),message);
    QuickFixAction.registerQuickFixAction(errorResult,new ModifierFix(psiModifierList,PsiModifier.PUBLIC,false),null);
    PsiClass[] classes=file.getClasses();
    if (classes.length > 1) {
      QuickFixAction.registerQuickFixAction(errorResult,new MoveClassToSeparateFileFix(aClass),null);
    }
    for (    PsiClass otherClass : classes) {
      if (!otherClass.getManager().areElementsEquivalent(otherClass,aClass) && otherClass.hasModifierProperty(PsiModifier.PUBLIC) && otherClass.getName().equals(virtualFile.getNameWithoutExtension())) {
        return errorResult;
      }
    }
    QuickFixAction.registerQuickFixAction(errorResult,new RenameFileFix(aClass.getName()),null);
    QuickFixAction.registerQuickFixAction(errorResult,new RenamePublicClassFix(aClass),null);
  }
  return errorResult;
}
