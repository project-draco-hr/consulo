{
  Runnable fix=new Runnable(){
    public void run(){
      DictionarySuggestionProvider provider=findProvider();
      if (provider != null) {
        provider.setActive(true);
      }
      HashMap<String,Object> map=new HashMap<String,Object>();
      PsiElement psiElement=descriptor.getPsiElement();
      map.put(LangDataKeys.PSI_ELEMENT.getName(),psiElement);
      map.put(LangDataKeys.EDITOR.getName(),InjectedLanguageUtil.openEditorFor(psiElement.getContainingFile(),project));
      DataContext dataContext=SimpleDataContext.getSimpleContext(map,DataManager.getInstance().getDataContext());
      AnAction action=new RenameElementAction();
      AnActionEvent event=new AnActionEvent(null,dataContext,"",action.getTemplatePresentation(),ActionManager.getInstance(),0);
      action.actionPerformed(event);
      if (provider != null) {
        provider.setActive(false);
      }
    }
  }
;
  if (ApplicationManager.getApplication().isUnitTestMode())   fix.run();
 else   SwingUtilities.invokeLater(fix);
}
