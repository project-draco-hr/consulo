{
  final DebugProcessImpl debugProcess=suspendContext.getDebugProcess();
  myDepth=depth;
  myTargetMethodSignature=smartStepFilter;
  myVirtualMachineProxy=debugProcess.getVirtualMachineProxy();
  try {
    myFrameCount=stepThread.frameCount();
    ApplicationManager.getApplication().runReadAction(new Runnable(){
      public void run(){
        myPosition=ContextUtil.getSourcePosition(new StackFrameContext(){
          public StackFrameProxy getFrameProxy(){
            try {
              return stepThread.frame(0);
            }
 catch (            EvaluateException e) {
              if (LOG.isDebugEnabled()) {
                LOG.debug(e);
              }
              return null;
            }
          }
          public DebugProcess getDebugProcess(){
            return suspendContext.getDebugProcess();
          }
        }
);
      }
    }
);
  }
 catch (  Exception e) {
    myPosition=null;
  }
}
