{
  if (FileDocumentManager.getInstance().isFileModified(virtualFile) || ChooseFileEncodingAction.checkCanReload(virtualFile).second != null) {
    return;
  }
  if (!isGoodCharset(file.getProject(),virtualFile,text,charset)) {
    descriptors.add(manager.createProblemDescriptor(file,"File was loaded in the wrong encoding: '" + charset + "'",RELOAD_ENCODING_FIX,ProblemHighlightType.GENERIC_ERROR,isOnTheFly));
  }
}
