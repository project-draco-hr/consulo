{
  final MapReduceIndex<K,V,FileContent> index;
  if (extension instanceof CustomImplementationFileBasedIndexExtension) {
    final UpdatableIndex<K,V,FileContent> custom=((CustomImplementationFileBasedIndexExtension<K,V,FileContent>)extension).createIndexImplementation(extension,storage);
    if (!(custom instanceof MapReduceIndex)) {
      return custom;
    }
    index=(MapReduceIndex<K,V,FileContent>)custom;
  }
 else {
    index=new MapReduceIndex<K,V,FileContent>(extension,storage);
  }
  return index;
}
