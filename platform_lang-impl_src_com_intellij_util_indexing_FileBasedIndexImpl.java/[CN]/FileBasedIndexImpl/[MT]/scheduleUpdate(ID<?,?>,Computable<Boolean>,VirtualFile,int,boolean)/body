{
  if (myNotRequiringContentIndices.contains(indexId) && !Registry.is("idea.concurrent.scanning.files.to.index")) {
    myContentlessIndicesUpdateQueue.submit(new Computable<Boolean>(){
      @Override public Boolean compute(){
        return FileBasedIndexImpl.this.updateWithBufferingEnabled(update);
      }
    }
,new Runnable(){
      @Override public void run(){
        FileBasedIndexImpl.this.indexedStampUpdate(indexId,file,inputId,hasContent);
      }
    }
);
  }
 else {
    if (updateWithBufferingEnabled(update)) {
      AccessToken accessToken=ReadAction.start();
      try {
        indexedStampUpdate(indexId,file,inputId,hasContent);
      }
  finally {
        accessToken.finish();
      }
    }
  }
}
