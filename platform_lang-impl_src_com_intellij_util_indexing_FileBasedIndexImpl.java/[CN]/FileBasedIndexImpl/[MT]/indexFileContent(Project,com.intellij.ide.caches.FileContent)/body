{
  VirtualFile file=content.getVirtualFile();
  final int fileId=Math.abs(getIdMaskingNonIdBasedFile(file));
  try {
    if (!file.isValid() || isTooLarge(file)) {
      removeDataFromIndicesForFile(fileId);
      if (file instanceof DeletedVirtualFileStub && ((DeletedVirtualFileStub)file).isResurrected()) {
        doIndexFileContent(project,new com.intellij.ide.caches.FileContent(((DeletedVirtualFileStub)file).getOriginalFile()));
      }
    }
 else {
      doIndexFileContent(project,content);
    }
  }
  finally {
    IndexingStamp.flushCache(fileId);
  }
  myChangedFilesCollector.myFilesToUpdate.remove(fileId);
}
