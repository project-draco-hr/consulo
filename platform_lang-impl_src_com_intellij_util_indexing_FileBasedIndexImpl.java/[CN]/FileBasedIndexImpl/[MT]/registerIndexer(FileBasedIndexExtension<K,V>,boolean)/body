{
  final ID<K,V> name=extension.getName();
  final int version=extension.getVersion();
  final File versionFile=IndexInfrastructure.getVersionFile(name);
  final boolean versionFileExisted=versionFile.exists();
  boolean versionChanged=false;
  if (isCurrentVersionCorrupted || IndexInfrastructure.versionDiffers(versionFile,version)) {
    if (!isCurrentVersionCorrupted && versionFileExisted) {
      versionChanged=true;
      LOG.info("Version has changed for index " + name + ". The index will be rebuilt.");
    }
    FileUtil.delete(IndexInfrastructure.getIndexRootDir(name));
    IndexInfrastructure.rewriteVersion(versionFile,version);
  }
  compactIndex(extension,version,versionFile);
  return versionChanged;
}
