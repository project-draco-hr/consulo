{
  final VirtualFile file=fileContent.getVirtualFile();
  if (myFilesToUpdate.contains(file)) {
    if (file.isValid()) {
      int fileId=getIdMaskingNonIdBasedFile(file);
      try {
        if (isTooLarge(file)) {
          List<ID<?,?>> nontrivialFileIndexedStates=IndexingStamp.getNontrivialFileIndexedStates(fileId);
          removeFileDataFromIndices(ContainerUtil.intersection(nontrivialFileIndexedStates,myRequiringContentIndices),Math.abs(fileId));
        }
 else {
          doIndexFileContent(project,fileContent);
        }
      }
  finally {
        IndexingStamp.flushCache(file);
      }
    }
    myFilesToUpdate.remove(file);
    return true;
  }
  return false;
}
