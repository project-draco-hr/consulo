{
  if (!(file instanceof DeletedVirtualFileStub)) {
    IndexableFileSet setForFile=getIndexableSetForFile(file);
    if (setForFile == null) {
      return;
    }
  }
  final int fileId=Math.abs(getIdMaskingNonIdBasedFile(file));
  final VirtualFile previousVirtualFile=myFilesToUpdate.put(fileId,file);
  if (previousVirtualFile instanceof DeletedVirtualFileStub && !previousVirtualFile.equals(file)) {
    assert((DeletedVirtualFileStub)previousVirtualFile).getOriginalFile().equals(file);
    ((DeletedVirtualFileStub)previousVirtualFile).setResurrected(true);
    myFilesToUpdate.put(fileId,previousVirtualFile);
  }
}
