{
  if (LOG.isDebugEnabled()) {
    LOG.debug("offset=" + offset);
    LOG.debug("textlength=" + text.length());
    LOG.debug(model.toString());
  }
  while (true) {
    FindResult result=doFindString(text,offset,model);
    if (!model.isWholeWordsOnly()) {
      return result;
    }
    if (!result.isStringFound()) {
      return result;
    }
    if (isWholeWord(text,result.getStartOffset(),result.getEndOffset())) {
      return result;
    }
    if (model.isForward())     offset=result.getStartOffset() + 1;
 else     offset=result.getEndOffset() - 1;
  }
}
