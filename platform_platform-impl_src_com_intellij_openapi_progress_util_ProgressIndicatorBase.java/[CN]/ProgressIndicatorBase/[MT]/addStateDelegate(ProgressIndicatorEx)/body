{
  delegate.initStateFrom(this);
  CopyOnWriteArrayList<ProgressIndicatorEx> stateDelegates=myStateDelegates;
  if (stateDelegates == null) {
synchronized (this) {
      stateDelegates=myStateDelegates;
      if (stateDelegates == null) {
        myStateDelegates=stateDelegates=ContainerUtil.createEmptyCOWList();
      }
    }
  }
  stateDelegates.addIfAbsent(delegate);
}
