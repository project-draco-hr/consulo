{
  visitReferenceElement(expression);
  if (!myHolder.hasErrorResults()) {
    visitExpression(expression);
    if (myHolder.hasErrorResults())     return;
  }
  JavaResolveResult result;
  try {
    result=expression.advancedResolve(false);
  }
 catch (  IndexNotReadyException e) {
    return;
  }
  PsiElement resolved=result.getElement();
  if (resolved instanceof PsiVariable && resolved.getContainingFile() == expression.getContainingFile()) {
    if (!myHolder.hasErrorResults()) {
      try {
        myHolder.add(HighlightControlFlowUtil.checkVariableInitializedBeforeUsage(expression,(PsiVariable)resolved,myUninitializedVarProblems));
      }
 catch (      IndexNotReadyException ignored) {
      }
    }
    PsiVariable variable=(PsiVariable)resolved;
    boolean isFinal=variable.hasModifierProperty(PsiModifier.FINAL);
    if (isFinal && !variable.hasInitializer()) {
      if (!myHolder.hasErrorResults()) {
        myHolder.add(HighlightControlFlowUtil.checkFinalVariableMightAlreadyHaveBeenAssignedTo(variable,expression,myFinalVarProblems));
      }
      if (!myHolder.hasErrorResults())       myHolder.add(HighlightControlFlowUtil.checkFinalVariableInitializedInLoop(expression,resolved));
    }
  }
  if (!myHolder.hasErrorResults())   myHolder.add(HighlightUtil.checkExpressionRequired(expression));
  if (!myHolder.hasErrorResults() && resolved instanceof PsiField) {
    try {
      myHolder.add(HighlightUtil.checkIllegalForwardReferenceToField(expression,(PsiField)resolved));
    }
 catch (    IndexNotReadyException ignored) {
    }
  }
  if (!myHolder.hasErrorResults())   myHolder.add(HighlightMethodUtil.checkConstructorCallMustBeFirstStatement(expression));
  if (!myHolder.hasErrorResults())   myHolder.add(GenericsHighlightUtil.checkAccessStaticFieldFromEnumConstructor(expression,result));
  if (!myHolder.hasErrorResults())   myHolder.add(HighlightUtil.checkClassReferenceAfterQualifier(expression,resolved));
}
