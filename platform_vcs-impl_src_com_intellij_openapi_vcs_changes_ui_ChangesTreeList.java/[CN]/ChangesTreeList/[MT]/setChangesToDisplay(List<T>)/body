{
  final List<T> sortedChanges=new ArrayList<T>(changes);
  Collections.sort(sortedChanges,new Comparator<T>(){
    public int compare(    final T o1,    final T o2){
      return TreeModelBuilder.getPathForObject(o1).getName().compareToIgnoreCase(TreeModelBuilder.getPathForObject(o2).getName());
    }
  }
);
  myList.setModel(new AbstractListModel(){
    @Override public int getSize(){
      return sortedChanges.size();
    }
    @Override public Object getElementAt(    int index){
      return sortedChanges.get(index);
    }
  }
);
  final DefaultTreeModel model=buildTreeModel(changes,myChangeDecorator);
  myTree.setModel(model);
  final Runnable runnable=new Runnable(){
    public void run(){
      if (myProject.isDisposed())       return;
      TreeUtil.expandAll(myTree);
      int listSelection=0;
      int scrollRow=0;
      if (myIncludedChanges.size() > 0) {
        int count=0;
        for (        T change : changes) {
          if (myIncludedChanges.contains(change)) {
            listSelection=count;
            break;
          }
          count++;
        }
        ChangesBrowserNode root=(ChangesBrowserNode)model.getRoot();
        Enumeration enumeration=root.depthFirstEnumeration();
        while (enumeration.hasMoreElements()) {
          ChangesBrowserNode node=(ChangesBrowserNode)enumeration.nextElement();
          final CheckboxTree.NodeState state=getNodeStatus(node);
          if (node != root && state == CheckboxTree.NodeState.CLEAR) {
            myTree.collapsePath(new TreePath(node.getPath()));
          }
        }
        enumeration=root.depthFirstEnumeration();
        while (enumeration.hasMoreElements()) {
          ChangesBrowserNode node=(ChangesBrowserNode)enumeration.nextElement();
          final CheckboxTree.NodeState state=getNodeStatus(node);
          if (state == CheckboxTree.NodeState.FULL && node.isLeaf()) {
            scrollRow=myTree.getRowForPath(new TreePath(node.getPath()));
            break;
          }
        }
      }
      if (changes.size() > 0) {
        myList.setSelectedIndex(listSelection);
        myList.ensureIndexIsVisible(listSelection);
        myTree.setSelectionRow(scrollRow);
        TreeUtil.showRowCentered(myTree,scrollRow,false);
      }
    }
  }
;
  if (ApplicationManager.getApplication().isDispatchThread()) {
    runnable.run();
  }
 else {
    SwingUtilities.invokeLater(runnable);
  }
}
