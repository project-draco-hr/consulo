{
  final PsiJavaCodeReferenceElement nameRef=annotation.getNameReferenceElement();
  if (nameRef == null)   return null;
  PsiClass aClass=(PsiClass)nameRef.resolve();
  if (aClass != null && aClass.isAnnotationType()) {
    Set<String> names=new HashSet<String>();
    PsiNameValuePair[] attributes=annotation.getParameterList().getAttributes();
    for (int i=0; i < attributes.length; i++) {
      PsiNameValuePair attribute=attributes[i];
      if (attribute.getName() != null) {
        names.add(attribute.getName());
      }
 else {
        names.add(PsiAnnotation.DEFAULT_REFERENCED_METHOD_NAME);
      }
    }
    PsiMethod[] annotationMethods=aClass.getMethods();
    List<String> missed=new ArrayList<String>();
    for (int i=0; i < annotationMethods.length; i++) {
      PsiMethod method=annotationMethods[i];
      if (method instanceof PsiAnnotationMethod) {
        PsiAnnotationMethod annotationMethod=(PsiAnnotationMethod)method;
        if (annotationMethod.getDefaultValue() == null) {
          if (!names.contains(annotationMethod.getName())) {
            missed.add(annotationMethod.getName());
          }
        }
      }
    }
    if (missed.size() > 0) {
      StringBuffer buff=new StringBuffer("'" + missed.get(0) + "'");
      for (int i=1; i < missed.size(); i++) {
        buff.append(", ");
        buff.append("'" + missed.get(i) + "'");
      }
      String description=MessageFormat.format(MISSING_ATTRIBUTES,new Object[]{buff});
      return HighlightInfo.createHighlightInfo(HighlightInfoType.ERROR,annotation.getNameReferenceElement(),description);
    }
  }
  return null;
}
