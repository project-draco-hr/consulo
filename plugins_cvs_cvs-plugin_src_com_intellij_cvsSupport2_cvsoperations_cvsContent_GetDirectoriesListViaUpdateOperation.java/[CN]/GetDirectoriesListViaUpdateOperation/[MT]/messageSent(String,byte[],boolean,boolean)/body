{
  if (myStreamingListener != null) {
    myStreamingDirectoryContentListener.messageSent(message);
    final long timePassed=System.currentTimeMillis() - timeStamp;
    final DirectoryContent streamingContent=myStreamingDirectoryContentListener.getDirectoryContent();
    final int size=streamingContent.getTotalSize();
    if (timePassed > 25L && size > 0) {
      myStreamingListener.consume(streamingContent);
      myStreamingDirectoryContentListener=new DirectoryContentListener();
      timeStamp=System.currentTimeMillis();
    }
  }
 else {
    myDirectoryContentListener.messageSent(message);
  }
}
