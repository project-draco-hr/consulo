{
  final Map<String,String> macroMap=getMacroMap();
  final Set set=macroMap.keySet();
  for (Iterator i=set.iterator(); i.hasNext(); ) {
    final String from=(String)i.next();
    final String to=macroMap.get(from);
    text=StringUtil.replace(text,from,to,true);
  }
  return text;
}
