{
  DebuggerTreeNodeImpl selectedNode=getSelectedNode(e.getDataContext());
  if (selectedNode != null) {
    NodeDescriptorImpl descriptor=selectedNode.getDescriptor();
    if (descriptor instanceof StackFrameDescriptorImpl) {
      if (selectedNode.getNextSibling() != null) {
        StackFrameDescriptorImpl frameDescriptor=((StackFrameDescriptorImpl)descriptor);
        return frameDescriptor.getStackFrame();
      }
      return null;
    }
 else     if (descriptor instanceof ThreadDescriptorImpl || descriptor instanceof ThreadGroupDescriptorImpl) {
      return null;
    }
  }
  DebuggerContextImpl debuggerContext=DebuggerAction.getDebuggerContext(e.getDataContext());
  StackFrameProxyImpl frameProxy=debuggerContext.getFrameProxy();
  if (frameProxy == null || frameProxy.isBottom()) {
    return null;
  }
  return frameProxy;
}
