{
  JavaCommandLineState state=new JavaCommandLineState(env){
    protected JavaParameters createJavaParameters() throws ExecutionException {
      return MavenExternalParameters.createJavaParameters(env.getProject(),mySettings.myRunnerParameters,mySettings.myGeneralSettings,mySettings.myRunnerSettings);
    }
    @NotNull @Override protected OSProcessHandler startProcess() throws ExecutionException {
      OSProcessHandler result=super.startProcess();
      result.addProcessListener(new ProcessAdapter(){
        @Override public void processTerminated(        ProcessEvent event){
          updateProjectsFolders();
        }
      }
);
      return result;
    }
  }
;
  state.setConsoleBuilder(MavenConsoleImpl.createConsoleBuilder(getProject()));
  return state;
}
