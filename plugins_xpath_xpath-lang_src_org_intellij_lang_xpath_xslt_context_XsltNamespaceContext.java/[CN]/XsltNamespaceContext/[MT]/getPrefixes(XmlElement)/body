{
  final XmlTag tag=PsiTreeUtil.getParentOfType(context,XmlTag.class);
  if (tag != null) {
    final HashSet<String> allPrefixes=new HashSet<String>();
    final String[] uris=tag.knownNamespaces();
    for (    String uri : uris) {
      for (XmlTag p=tag; p != null; p=p.getParentTag()) {
        final Set<Map.Entry<String,String>> localPrefixes=p.getLocalNamespaceDeclarations().entrySet();
        for (        Map.Entry<String,String> entry : localPrefixes) {
          final String prefix=entry.getKey();
          if (prefix.length() > 0 && entry.getValue().equals(uri)) {
            if (!allPrefixes.contains(prefix)) {
              allPrefixes.add(prefix);
            }
          }
        }
      }
    }
    return allPrefixes;
  }
 else {
    return Collections.emptySet();
  }
}
