{
  if (myItemPreferencePolicy == null) {
    return -1;
  }
  int prefItemIndex=-1;
  for (int i=0; i < items.length; i++) {
    LookupElement item=(LookupElement)items[i];
    final Object obj=item.getObject();
    if (obj instanceof PsiElement && !((PsiElement)obj).isValid())     continue;
    if (prefItemIndex == -1) {
      prefItemIndex=i;
    }
 else {
      int d=myItemPreferencePolicy.compare(item,(LookupElement)items[prefItemIndex]);
      if (d < 0) {
        prefItemIndex=i;
      }
    }
    if (isExactPrefixItem(item)) {
      break;
    }
  }
  return prefItemIndex;
}
