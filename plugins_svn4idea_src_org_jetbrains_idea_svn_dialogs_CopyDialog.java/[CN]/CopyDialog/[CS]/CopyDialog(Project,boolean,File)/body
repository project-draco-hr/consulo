{
  super(project,canBeParent);
  mySrcFile=file;
  myProject=project;
  setResizable(true);
  setTitle(SvnBundle.message("dialog.title.branch"));
  getHelpAction().setEnabled(true);
  myProjectButton.setIcon(IconLoader.getIcon("/nodes/ideaProject.png"));
  myBranchTagBaseComboBox.setPreferredSize(new Dimension(myBranchTagBaseComboBox.getPreferredSize().width,myWorkingCopyField.getPreferredSize().height));
  myWorkingCopyField.addBrowseFolderListener("Select Working Copy Location","Select Location to Copy From:",project,new FileChooserDescriptor(false,true,false,false,false,false));
  myWorkingCopyField.getTextField().getDocument().addDocumentListener(new DocumentAdapter(){
    protected void textChanged(    final DocumentEvent e){
      updateControls();
    }
  }
);
  myRepositoryField.addActionListener(new ActionListener(){
    public void actionPerformed(    final ActionEvent e){
      SelectLocationDialog dlg=new SelectLocationDialog(project,myRepositoryField.getText());
      dlg.show();
      if (dlg.isOK()) {
        myRepositoryField.setText(dlg.getSelectedURL());
      }
    }
  }
);
  myRepositoryField.getTextField().getDocument().addDocumentListener(new DocumentAdapter(){
    protected void textChanged(    final DocumentEvent e){
      updateToURL();
    }
  }
);
  myToURLText.addActionListener(new ActionListener(){
    public void actionPerformed(    final ActionEvent e){
      String url=myToURLText.getText();
      String dstName=SVNPathUtil.tail(mySrcURL);
      dstName=SVNEncodingUtil.uriDecode(dstName);
      SelectLocationDialog dialog=new SelectLocationDialog(myProject,SVNPathUtil.removeTail(url),SvnBundle.message("label.copy.select.location.dialog.copy.as"),dstName,false);
      dialog.show();
      if (dialog.isOK()) {
        url=dialog.getSelectedURL();
        String name=dialog.getDestinationName();
        url=SVNPathUtil.append(url,name);
        myToURLText.setText(url);
      }
    }
  }
);
  myRevisionPanel.setProject(myProject);
  myRevisionPanel.setUrlProvider(new SvnRevisionPanel.UrlProvider(){
    public String getUrl(){
      return mySrcURL;
    }
  }
);
  mySrcVirtualFile=LocalFileSystem.getInstance().findFileByIoFile(file);
  mySrcVirtualFile=ProjectLevelVcsManager.getInstance(project).getVcsRootFor(mySrcVirtualFile);
  updateBranchTagBases();
  myRevisionPanel.addChangeListener(new ChangeListener(){
    public void stateChanged(    final ChangeEvent e){
      getOKAction().setEnabled(isOKActionEnabled());
    }
  }
);
  init();
  ActionListener listener=new ActionListener(){
    public void actionPerformed(    ActionEvent e){
      updateControls();
    }
  }
;
  myWorkingCopyRadioButton.addActionListener(listener);
  myRepositoryRadioButton.addActionListener(listener);
  myBranchOrTagRadioButton.addActionListener(listener);
  myAnyLocationRadioButton.addActionListener(listener);
  updateControls();
  myBranchTextField.getDocument().addDocumentListener(new DocumentAdapter(){
    protected void textChanged(    final DocumentEvent e){
      updateToURL();
    }
  }
);
  updateToURL();
  myProjectButton.addActionListener(new ActionListener(){
    public void actionPerformed(    ActionEvent e){
      myRepositoryField.setText(myBranchConfiguration.getBaseUrl(mySrcURL));
    }
  }
);
  myBranchTagBaseComboBox.addActionListener(new ActionListener(){
    public void actionPerformed(    ActionEvent e){
      BranchConfigurationDialog.configureBranches(project,mySrcVirtualFile);
      updateBranchTagBases();
    }
  }
);
  myBranchTagBaseComboBox.getComboBox().addActionListener(new ActionListener(){
    public void actionPerformed(    ActionEvent e){
      updateToURL();
    }
  }
);
}
