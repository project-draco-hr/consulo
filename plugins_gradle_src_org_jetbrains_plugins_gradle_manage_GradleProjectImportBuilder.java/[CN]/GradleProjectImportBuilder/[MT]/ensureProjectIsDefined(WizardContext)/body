{
  File projectFile=getProjectFile();
  if (projectFile == null) {
    throw new ConfigurationException(ExternalSystemBundle.message("gradle.import.text.error.project.undefined"));
  }
  if (projectFile.isDirectory()) {
    throw new ConfigurationException(ExternalSystemBundle.message("gradle.import.text.error.directory.instead.file"));
  }
  final Ref<String> errorReason=new Ref<String>();
  final Ref<String> errorDetails=new Ref<String>();
  try {
    final Project project=getProject(wizardContext);
    myGradleProject=GradleUtil.refreshProject(project,projectFile.getAbsolutePath(),errorReason,errorDetails,false,true);
  }
 catch (  IllegalArgumentException e) {
    throw new ConfigurationException(e.getMessage(),ExternalSystemBundle.message("gradle.import.text.error.cannot.parse.project"));
  }
  if (myGradleProject == null) {
    final String details=errorDetails.get();
    if (!StringUtil.isEmpty(details)) {
      GradleLog.LOG.warn(details);
    }
    String errorMessage;
    String reason=errorReason.get();
    if (reason == null) {
      errorMessage=ExternalSystemBundle.message("gradle.import.text.error.resolve.generic.without.reason",projectFile.getPath());
    }
 else {
      errorMessage=ExternalSystemBundle.message("gradle.import.text.error.resolve.with.reason",reason);
    }
    throw new ConfigurationException(errorMessage,ExternalSystemBundle.message("gradle.import.title.error.resolve.generic"));
  }
}
