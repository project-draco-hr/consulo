{
  CharSequence text=myText();
  if (text == null)   return;
  if (TreeUtil.getFileElement(this) == null) {
    LOG.error("Chameleons must not be parsed till they're in file tree: " + this);
  }
  ApplicationManager.getApplication().assertReadAccessAllowed();
  ILazyParseableElementType type=(ILazyParseableElementType)getElementType();
  ASTNode parsedNode=type.parseContents(this);
  if (parsedNode == null && text.length() > 0) {
    CharSequence diagText=ApplicationManager.getApplication().isInternal() ? text : "";
    LOG.error("No parse for a non-empty string: " + diagText + "; type="+ LogUtil.objectAndClass(type));
  }
synchronized (lock) {
    if (myText == null)     return;
    if (rawFirstChild() != null) {
      LOG.error("Reentrant parsing?");
    }
    myText=null;
    if (parsedNode == null)     return;
    super.rawAddChildrenWithoutNotifications((TreeElement)parsedNode);
    if (!(parsedNode instanceof CompositeElement))     return;
  }
  ((CompositeElement)parsedNode).createAllChildrenPsiIfNecessary();
}
