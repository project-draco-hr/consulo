{
  ASTNode parsedNode;
synchronized (lock) {
    if (myText == null)     return;
    if (rawFirstChild() != null) {
      LOG.error("Reentrant parsing?");
    }
    if (TreeUtil.getFileElement(this) == null) {
      LOG.error("Chameleons must not be parsed till they're in file tree: " + this);
    }
    ApplicationManager.getApplication().assertReadAccessAllowed();
    ILazyParseableElementType type=(ILazyParseableElementType)getElementType();
    parsedNode=type.parseContents(this);
    if (parsedNode == null && myText.length() > 0) {
      if (ApplicationManager.getApplication().isInternal() && !ApplicationManager.getApplication().isUnitTestMode()) {
        LOG.error("No parse for a non-empty string: " + myText + "; type="+ LogUtil.objectAndClass(type));
      }
 else {
        LOG.error("No parse for a non-empty string: type=" + LogUtil.objectAndClass(type));
      }
    }
    myText=null;
    if (parsedNode == null)     return;
    rawAddChildrenWithoutNotifications((TreeElement)parsedNode);
    if (!(parsedNode instanceof CompositeElement))     return;
  }
  ((CompositeElement)parsedNode).createAllChildrenPsiIfNecessary();
}
