{
  Icon icon=originalIcon;
  VirtualFile currentRoot=null;
  for (  ContentFolder contentFolder : entry.getFolders()) {
    final VirtualFile contentPath=contentFolder.getFile();
    if (file.equals(contentPath)) {
      icon=contentFolder.getType().getIcon();
    }
 else     if (contentPath != null && VfsUtilCore.isAncestor(contentPath,file,true)) {
      if (currentRoot != null && VfsUtilCore.isAncestor(contentPath,currentRoot,false)) {
        continue;
      }
      icon=contentFolder.getType().getChildDirectoryIcon();
      currentRoot=contentPath;
    }
  }
  return icon;
}
