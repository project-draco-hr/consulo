{
  filePath=canonicalize(filePath);
  ProjectImpl project=createProject(filePath,false,false,false);
  final ConfigurationFile[] files=project.getConfigurationFiles();
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    public void run(){
      for (      ConfigurationFile file : files) {
        LocalFileSystem.getInstance().refreshAndFindFileByPath(file.getFilePath().replace(File.separatorChar,'/'));
      }
    }
  }
);
  final boolean macrosOk=checkMacros(project,getDefinedMacros());
  if (!macrosOk) {
    throw new IOException(ProjectBundle.message("project.load.undefined.path.variables.error"));
  }
  project.loadSavedConfiguration();
  project.init();
  return project;
}
