{
  try {
    String canonicalPath=new File(filePath).getCanonicalPath();
    if (canonicalPath != null) {
      filePath=canonicalPath;
    }
  }
 catch (  IOException e) {
  }
  ProjectImpl project=createProject(filePath,false,false,false);
  final String[] paths=project.getConfigurationFilePaths();
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    public void run(){
      for (int i=0; i < paths.length; i++) {
        LocalFileSystem.getInstance().refreshAndFindFileByPath(paths[i].replace(File.separatorChar,'/'));
      }
    }
  }
);
  final boolean macrosOk=checkMacros(project,getDefinedMacros());
  if (!macrosOk) {
    throw new IOException("There are undefined path variables in project file");
  }
  project.loadSavedConfiguration();
  project.init();
  return project;
}
