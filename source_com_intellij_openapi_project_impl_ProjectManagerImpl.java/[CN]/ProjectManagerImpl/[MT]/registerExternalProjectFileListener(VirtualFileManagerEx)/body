{
  virtualFileManager.addVirtualFileManagerListener(new VirtualFileManagerListener(){
    public void beforeRefreshStart(    boolean asynchonous){
      myIsInRefresh=true;
    }
    public void afterRefreshFinish(    boolean asynchonous){
      myIsInRefresh=false;
      askToReloadProjectIfConfigFilesChangedExternally();
    }
  }
);
  virtualFileManager.addVirtualFileListener(new VirtualFileAdapter(){
    public void contentsChanged(    VirtualFileEvent event){
      if (event.isFromRefresh() && myIsInRefresh) {
        saveChangedProjectFile(event.getFile());
      }
    }
  }
);
}
