{
  Project project=(Project)e.getDataContext().getData(DataConstants.PROJECT);
  Window window=null;
  Component focusedComponent=WindowManagerEx.getInstanceEx().getFocusedComponent(project);
  if (focusedComponent != null) {
    if (focusedComponent instanceof Window) {
      window=(Window)focusedComponent;
    }
 else {
      window=SwingUtilities.getWindowAncestor(focusedComponent);
    }
  }
  if (window == null) {
    window=KeyboardFocusManager.getCurrentKeyboardFocusManager().getFocusedWindow();
  }
  Rectangle r;
  if (window != null) {
    r=window.getBounds();
  }
 else {
    r=WindowManagerEx.getInstanceEx().getScreenBounds();
  }
  return r;
}
