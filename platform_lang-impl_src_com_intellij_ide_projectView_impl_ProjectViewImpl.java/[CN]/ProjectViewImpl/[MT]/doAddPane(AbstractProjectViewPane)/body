{
  int index;
  final ContentManager manager=myContentManager;
  for (index=0; index < manager.getContentCount(); index++) {
    Content content=manager.getContent(index);
    String id=content.getUserData(ID_KEY);
    AbstractProjectViewPane pane=myId2Pane.get(id);
    int comp=PANE_WEIGHT_COMPARATOR.compare(pane,newPane);
    if (comp == 0) {
      System.out.println("here");
    }
    LOG.assertTrue(comp != 0);
    if (comp > 0) {
      break;
    }
  }
  final String id=newPane.getId();
  myId2Pane.put(id,newPane);
  String[] subIds=newPane.getSubIds();
  subIds=subIds.length == 0 ? new String[]{null} : subIds;
  boolean first=true;
  for (  String subId : subIds) {
    final String title=subId != null ? newPane.getPresentableSubIdName(subId) : newPane.getTitle();
    final Content content=myContentManager.getFactory().createContent(getComponent(),title,false);
    content.setTabName(title);
    content.putUserData(ID_KEY,id);
    content.putUserData(SUB_ID_KEY,subId);
    content.putUserData(ToolWindow.SHOW_CONTENT_ICON,Boolean.TRUE);
    content.setIcon(newPane.getIcon());
    content.setPopupIcon(subId != null ? BULLET_ICON : newPane.getIcon());
    content.setPreferredFocusedComponent(new Computable<JComponent>(){
      public JComponent compute(){
        final AbstractProjectViewPane current=getCurrentProjectViewPane();
        return current != null ? current.getComponentToFocus() : null;
      }
    }
);
    content.setBusyObject(this);
    if (first && subId != null) {
      content.setSeparator(newPane.getTitle());
    }
    manager.addContent(content,index++);
    first=false;
  }
  Disposer.register(this,newPane);
}
