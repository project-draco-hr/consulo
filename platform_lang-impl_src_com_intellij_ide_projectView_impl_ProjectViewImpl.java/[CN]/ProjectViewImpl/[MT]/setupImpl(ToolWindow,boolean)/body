{
  myActionGroup=new DefaultActionGroup();
  myAutoScrollFromSourceHandler.install();
  if (toolWindow != null) {
    myContentManager=toolWindow.getContentManager();
    if (!ApplicationManager.getApplication().isUnitTestMode()) {
      toolWindow.setContentUiType(ToolWindowContentUiType.getInstance("combo"),null);
      ((ToolWindowEx)toolWindow).setAdditionalGearActions(myActionGroup);
      toolWindow.getComponent().putClientProperty(ToolWindowContentUi.HIDE_ID_LABEL,"true");
    }
  }
 else {
    final ContentFactory contentFactory=ServiceManager.getService(ContentFactory.class);
    myContentManager=contentFactory.createContentManager(false,myProject);
  }
  GuiUtils.replaceJSplitPaneWithIDEASplitter(myPanel);
  SwingUtilities.invokeLater(new Runnable(){
    @Override public void run(){
      splitterProportions.restoreSplitterProportions(myPanel);
    }
  }
);
  if (loadPaneExtensions) {
    ensurePanesLoaded();
  }
  isInitialized=true;
  doAddUninitializedPanes();
  myContentManager.addContentManagerListener(new ContentManagerAdapter(){
    @Override public void selectionChanged(    ContentManagerEvent event){
      if (event.getOperation() == ContentManagerEvent.ContentOperation.add) {
        viewSelectionChanged();
      }
    }
  }
);
}
