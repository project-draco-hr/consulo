{
  ToolWindowManager toolWindowManager=ToolWindowManager.getInstance(myProject);
  ToolWindow toolWindow=toolWindowManager == null ? null : toolWindowManager.getToolWindow(ToolWindowId.PROJECT_VIEW);
  if (toolWindow == null)   return;
  String title=null;
  final AbstractProjectViewPane pane=getCurrentProjectViewPane();
  if (pane != null) {
    final DefaultMutableTreeNode selectedNode=pane.getSelectedNode();
    if (selectedNode != null) {
      final Object o=selectedNode.getUserObject();
      if (o instanceof ProjectViewNode) {
        title=((ProjectViewNode)o).getTitle();
      }
    }
  }
  if (title == null) {
    final PsiElement element=(PsiElement)myDataProvider.getData(LangDataKeys.PSI_ELEMENT.getName());
    if (element != null) {
      PsiFile file=element.getContainingFile();
      if (file != null) {
        title=FileUtil.getLocationRelativeToUserHome(file.getVirtualFile().getPresentableUrl());
      }
 else       if (element instanceof PsiDirectory) {
        title=PsiDirectoryFactory.getInstance(myProject).getQualifiedName((PsiDirectory)element,true);
      }
 else {
        title=element.toString();
      }
    }
 else {
      title="";
      if (myProject != null) {
        title=FileUtil.getLocationRelativeToUserHome(myProject.getPresentableUrl());
      }
    }
  }
  toolWindow.setTitle(title);
}
