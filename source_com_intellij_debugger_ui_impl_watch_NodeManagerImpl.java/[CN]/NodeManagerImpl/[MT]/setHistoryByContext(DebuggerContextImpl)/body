{
  final DebugProcessImpl debugProcess=context.getDebugProcess();
  debugProcess.getDescriptorHistoryManager().storeHistory(new DescriptorHistory(createHistoryTree(),myBreakpoints));
  DescriptorHistory history=debugProcess.getDescriptorHistoryManager().restoreHistory(context);
  setHistoryTree(history.getDescriptorTree());
  List<Pair<Breakpoint,Event>> eventDescriptors=DebuggerUtilsEx.getEventDescriptors(context.getSuspendContext());
  myBreakpoints=CollectUtil.COLLECT.toList(eventDescriptors,new Convertor<Pair<Breakpoint,Event>,Breakpoint>(){
    public Breakpoint convert(    Pair<Breakpoint,Event> o){
      return o.getFirst();
    }
  }
);
}
