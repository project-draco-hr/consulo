{
  ListUtil.addRemoveListener(myDeleteButton,myMacrosList);
  myMacrosList.setSelectionMode(ListSelectionModel.SINGLE_SELECTION);
  myMacroActionsList.setSelectionMode(ListSelectionModel.SINGLE_SELECTION);
  myRenameButton.setEnabled(false);
  myDeleteButton.setEnabled(false);
  myExcludeActionButton.setEnabled(false);
  myMacrosList.getSelectionModel().addListSelectionListener(new ListSelectionListener(){
    public void valueChanged(    ListSelectionEvent e){
      final int selIndex=myMacrosList.getSelectedIndex();
      if (selIndex == -1) {
        ((DefaultListModel)myMacroActionsList.getModel()).removeAllElements();
        myExcludeActionButton.setEnabled(false);
        myRenameButton.setEnabled(false);
      }
 else {
        myRenameButton.setEnabled(true);
        initActionList((ActionMacro)myMacrosModel.getElementAt(selIndex));
      }
    }
  }
);
  myMacroActionsList.getSelectionModel().addListSelectionListener(new ListSelectionListener(){
    public void valueChanged(    ListSelectionEvent e){
      final int selIdx=myMacroActionsList.getSelectedIndex();
      myExcludeActionButton.setEnabled(selIdx != -1);
    }
  }
);
  myExcludeActionButton.addActionListener(new ActionListener(){
    public void actionPerformed(    ActionEvent e){
      final int selIndex=myMacrosList.getSelectedIndex();
      if (selIndex != -1) {
        final ActionMacro macro=(ActionMacro)myMacrosModel.getElementAt(selIndex);
        macro.deleteAction(myMacroActionsList.getSelectedIndex());
      }
      ListUtil.removeSelectedItems(myMacroActionsList);
    }
  }
);
  myRenameButton.addActionListener(new ActionListener(){
    public void actionPerformed(    ActionEvent e){
      final int selIndex=myMacrosList.getSelectedIndex();
      if (selIndex == -1)       return;
      final ActionMacro macro=(ActionMacro)myMacrosModel.getElementAt(selIndex);
      final String newName=Messages.showInputDialog(myPanel,IdeBundle.message("prompt.enter.new.name"),IdeBundle.message("title.rename.macro"),Messages.getQuestionIcon(),macro.getName(),null);
      if (newName != null) {
        macro.setName(newName);
        myMacrosList.repaint();
      }
    }
  }
);
}
