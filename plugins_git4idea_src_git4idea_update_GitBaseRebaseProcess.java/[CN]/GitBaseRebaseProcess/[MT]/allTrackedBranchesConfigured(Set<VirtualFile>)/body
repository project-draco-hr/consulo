{
  for (  VirtualFile root : roots) {
    try {
      final GitBranch branch=GitBranch.current(myProject,root);
      if (branch == null) {
        GitUIUtil.notifyImportantError(myProject,"Can't update: no current branch","You are in 'detached HEAD' state, which means that you're not on any branch.<br/>" + "Checkout a branch to make update possible.");
        return false;
      }
      final String value=branch.getTrackedRemoteName(myProject,root);
      if (value == null || value.length() == 0) {
        final String branchName=branch.getName();
        GitUIUtil.notifyImportantError(myProject,"Can't update: no tracked branch","No tracked branch configured for branch " + branchName + "<br/>To make your branch track a remote branch call, for example,<br/>"+ "<code>git branch --set-upstream "+ branchName+ " origin/"+ branchName+ "</code>");
        return false;
      }
    }
 catch (    VcsException e) {
      GitUIUtil.notifyImportantError(myProject,"Can't update: error identifying tracked branch",e.getLocalizedMessage());
      return false;
    }
  }
  return true;
}
