{
  String prepend="";
  File file=new File(fileName);
  if (file.exists()) {
    int result=Messages.showDialog(project,"File " + fileName + " already exists\nDo you want overwrite it or to append?","Warning",new String[]{"Overwrite","Append","Cancel"},0,Messages.getWarningIcon());
    if (result != 1 && result != 0) {
      return;
    }
    if (result == 1) {
      char[] buf=new char[(int)file.length()];
      try {
        FileReader reader=new FileReader(fileName);
        try {
          reader.read(buf,0,(int)file.length());
          prepend=new String(buf) + System.getProperty("line.separator");
        }
  finally {
          reader.close();
        }
      }
 catch (      IOException e) {
      }
    }
  }
  try {
    FileWriter writer=new FileWriter(fileName);
    try {
      writer.write(prepend + textToExport);
    }
  finally {
      writer.close();
    }
  }
 catch (  IOException e) {
    Messages.showMessageDialog(project,"Error writing to file: " + fileName,"Error",Messages.getErrorIcon());
  }
}
