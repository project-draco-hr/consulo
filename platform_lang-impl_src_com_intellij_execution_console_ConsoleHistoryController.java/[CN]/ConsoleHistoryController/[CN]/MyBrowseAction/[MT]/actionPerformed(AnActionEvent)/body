{
  String s1=KeymapUtil.getFirstKeyboardShortcutText(myHistoryNext);
  String s2=KeymapUtil.getFirstKeyboardShortcutText(myHistoryPrev);
  String title=myConsole.getTitle() + " History" + (StringUtil.isNotEmpty(s1) && StringUtil.isNotEmpty(s2) ? " (" + s1 + " and "+ s2+ " while in editor)" : "");
  final ContentChooser<String> chooser=new ContentChooser<String>(myConsole.getProject(),title,true,true){
    @Override protected void removeContentAt(    String content){
      getModel().removeFromHistory(content);
    }
    @Override protected String getStringRepresentationFor(    String content){
      return content;
    }
    @Override protected List<String> getContents(){
      List<String> entries=getModel().getEntries();
      Collections.reverse(entries);
      return entries;
    }
    @Override protected Editor createIdeaEditor(    String text){
      PsiFile consoleFile=myConsole.getFile();
      Language language=consoleFile.getLanguage();
      Project project=consoleFile.getProject();
      PsiFile psiFile=PsiFileFactory.getInstance(project).createFileFromText("a." + consoleFile.getFileType().getDefaultExtension(),language,StringUtil.convertLineSeparators(new String(text)),false,true);
      VirtualFile virtualFile=psiFile.getViewProvider().getVirtualFile();
      if (virtualFile instanceof LightVirtualFile)       ((LightVirtualFile)virtualFile).setWritable(false);
      Document document=FileDocumentManager.getInstance().getDocument(virtualFile);
      EditorFactory editorFactory=EditorFactory.getInstance();
      EditorEx editor=(EditorEx)editorFactory.createViewer(document,project);
      editor.getSettings().setFoldingOutlineShown(false);
      editor.getSettings().setLineMarkerAreaShown(false);
      editor.getSettings().setIndentGuidesShown(false);
      SyntaxHighlighter highlighter=SyntaxHighlighterFactory.getSyntaxHighlighter(language,project,psiFile.getViewProvider().getVirtualFile());
      editor.setHighlighter(new LexerEditorHighlighter(highlighter,editor.getColorsScheme()));
      return editor;
    }
  }
;
  chooser.setContentIcon(null);
  chooser.setSplitterOrientation(false);
  chooser.setSelectedIndex(Math.max(0,getModel().getHistorySize() - getModel().getCurrentIndex() - 1));
  if (chooser.showAndGet() && myConsole.getCurrentEditor().getComponent().isShowing()) {
    setConsoleText(chooser.getSelectedText(),false,true);
  }
}
