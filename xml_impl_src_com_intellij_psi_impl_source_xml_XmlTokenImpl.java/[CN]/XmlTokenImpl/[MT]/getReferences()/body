{
  final IElementType elementType=getElementType();
  if (elementType == XmlTokenType.XML_DATA_CHARACTERS || elementType == XmlTokenType.XML_CHAR_ENTITY_REF || (elementType == XmlTokenType.XML_TAG_CHARACTERS && getParent() instanceof XmlProcessingInstruction)) {
    return ReferenceProvidersRegistry.getReferencesFromProviders(this,XmlToken.class);
  }
 else   if (elementType == XmlTokenType.XML_NAME) {
    if (getParent() instanceof PsiErrorElement) {
      final PsiElement element=getPrevSibling();
      if (element instanceof XmlToken && ((XmlToken)element).getTokenType() == XmlTokenType.XML_END_TAG_START) {
        return new PsiReference[]{TagNameReference.createTagNameReference(this,getNode(),false)};
      }
    }
    return ReferenceProvidersRegistry.getReferencesFromProviders(this,XmlToken.class);
  }
  return super.getReferences();
}
