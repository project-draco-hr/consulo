{
  final int offset=editor.getCaretModel().getOffset();
  final PsiLanguageInjectionHost host=PsiTreeUtil.getParentOfType(file.findElementAt(offset),PsiLanguageInjectionHost.class,false,true);
  if (host == null) {
    return null;
  }
  if (host instanceof PsiLiteralExpression) {
    final PsiType type=((PsiLiteralExpression)host).getType();
    return type == null || !type.equalsToText("java.lang.String") ? null : host;
  }
 else   if (host instanceof XmlAttributeValue) {
    final PsiElement p=host.getParent();
    if (p instanceof XmlAttribute) {
      final String s=((XmlAttribute)p).getName();
      return s.equals("xmlns") || s.startsWith("xmlns:") ? null : host;
    }
  }
 else   if (host instanceof XmlText) {
    final XmlTag tag=((XmlText)host).getParentTag();
    return tag == null || tag.getValue().getTextElements().length > 1 || tag.getSubTags().length > 0 ? null : host;
  }
  return null;
}
