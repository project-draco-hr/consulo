{
  final PsiLanguageInjectionHost host=findInjectionHost(editor,file);
  if (host == null)   return false;
  final List<Pair<PsiElement,TextRange>> injectedPsi=InjectedLanguageManager.getInstance(project).getInjectedPsiFiles(host);
  if (injectedPsi == null || injectedPsi.isEmpty()) {
    return !InjectedReferencesContributor.isInjected(file.findReferenceAt(editor.getCaretModel().getOffset()));
  }
  return true;
}
