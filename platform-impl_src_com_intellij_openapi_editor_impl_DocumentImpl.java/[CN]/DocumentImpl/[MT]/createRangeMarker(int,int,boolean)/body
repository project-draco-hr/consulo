{
  ApplicationManagerEx.getApplicationEx().assertReadAccessToDocumentsAllowed();
  if (!(0 <= startOffset && startOffset <= endOffset && endOffset <= getTextLength())) {
    LOG.error("Incorrect offsets startOffset=" + startOffset + ", endOffset="+ endOffset+ ", text length="+ getTextLength());
  }
  if (surviveOnExternalChange) {
    return new PersistentRangeMarker(this,startOffset,endOffset);
  }
 else {
    return new RangeMarkerImpl(this,startOffset,endOffset);
  }
}
