{
  if (location.getCompletionType() != CompletionType.CLASS_NAME && item instanceof MutableLookupElement) {
    final Object o=((MutableLookupElement)item).getObject();
    if (o instanceof PsiElement) {
      return PsiProximityComparator.getProximity((PsiElement)o,location.getCompletionParameters().getPosition());
    }
  }
  return null;
}
