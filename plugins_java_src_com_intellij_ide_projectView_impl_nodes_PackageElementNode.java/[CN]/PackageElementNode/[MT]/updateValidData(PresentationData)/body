{
  final PackageElement value=getValue();
  final PsiPackage aPackage=value.getPackage();
  if (!getSettings().isFlattenPackages() && getSettings().isHideEmptyMiddlePackages() && PackageUtil.isPackageEmpty(aPackage,value.getModule(),true,isLibraryElement())) {
    setValue(null);
    return;
  }
  PsiPackage parentPackage;
  Object parentValue=getParentValue();
  if (parentValue instanceof PackageElement) {
    parentPackage=((PackageElement)parentValue).getPackage();
  }
 else {
    parentPackage=null;
  }
  String qName=aPackage.getQualifiedName();
  String name=TreeViewUtil.getNodeName(getSettings(),aPackage,parentPackage,qName,showFQName(aPackage));
  presentation.setPresentableText(name);
  presentation.setIcon(PlatformIcons.PACKAGE_ICON);
  for (  ProjectViewNodeDecorator decorator : Extensions.getExtensions(ProjectViewNodeDecorator.EP_NAME,myProject)) {
    decorator.decorate(this,presentation);
  }
}
