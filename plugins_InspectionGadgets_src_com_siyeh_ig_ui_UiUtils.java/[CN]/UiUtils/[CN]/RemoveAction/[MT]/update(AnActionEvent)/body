{
  EventQueue.invokeLater(new Runnable(){
    @Override public void run(){
      final ListSelectionModel selectionModel=table.getSelectionModel();
      final int minIndex=selectionModel.getMinSelectionIndex();
      final int maxIndex=selectionModel.getMaxSelectionIndex();
      if (minIndex == -1 || maxIndex == -1) {
        e.getPresentation().setEnabled(false);
      }
 else {
        e.getPresentation().setEnabled(true);
      }
    }
  }
);
}
