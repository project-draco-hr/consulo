{
  Set<PsiElement> unique=new LinkedHashSet<PsiElement>(Arrays.asList(targetElements));
  for (  PsiElement elt : targetElements) {
    PsiFile psiFile=elt.getContainingFile().getOriginalFile();
    if (psiFile.getVirtualFile() == null)     unique.remove(elt);
  }
  for (int i=1; i < targetElements.length; i++) {
    if (PsiTreeUtil.isAncestor(targetElements[i],targetElements[0],true)) {
      unique.remove(targetElements[0]);
      break;
    }
  }
  return PsiUtilBase.toPsiElementArray(unique);
}
