{
  TreePath[] selectionPaths=getSelectionPaths();
  if (selectionPaths != null) {
    final InspectionTool selectedTool=getSelectedTool();
    if (selectedTool == null)     return EMPTY_ELEMENTS_ARRAY;
    List<RefEntity> result=new ArrayList<RefEntity>();
    for (    TreePath selectionPath : selectionPaths) {
      final InspectionTreeNode node=(InspectionTreeNode)selectionPath.getLastPathComponent();
      addElementsInNode(node,result);
    }
    return result.toArray(new RefEntity[result.size()]);
  }
  return EMPTY_ELEMENTS_ARRAY;
}
