{
  final Color color=UIManager.getColor("Table.focusCellBackground");
  UIManager.put("Table.focusCellBackground",table.getSelectionBackground());
  Component component=super.getTableCellRendererComponent(table,value,isSelected,hasFocus,row,column);
  setText(getItemText((T)value));
  if (component instanceof JLabel) {
    ((JLabel)component).setBorder(noFocusBorder);
  }
  UIManager.put("Table.focusCellBackground",color);
  final MyTableModel model=(MyTableModel)table.getModel();
  component.setEnabled(ElementsChooser.this.isEnabled() && (myColorUnmarkedElements ? model.isElementMarked(row) : true));
  ElementProperties properties=myElementToPropertiesMap.get(value);
  if (properties != null) {
    if (component instanceof JLabel) {
      ((JLabel)component).setIcon(properties.getIcon());
    }
    component.setForeground(properties.getColor());
  }
 else {
    if (component instanceof JLabel) {
      ((JLabel)component).setIcon(null);
    }
    component.setForeground(UIManager.getColor("Table.cellForeground"));
  }
  return component;
}
